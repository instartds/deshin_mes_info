<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ppl120skrvServiceImpl">
   	<select id="ppl120skrvServiceImpl.selectList0" parameterType="Map" resultType="rMap">
		--ppl120skrv.Cppl120skrv SetPpl120[fnPpl120QStd] QUERY02
		DECLARE @DAY		NVARCHAR(20)
		SET @DAY = right('END_OF_MONTH',2)
		
		SELECT CAL_DATE
		     , HOLY_TYPE
		  FROM BCM400T WITH (NOLOCK)
		 WHERE COMP_CODE = N'MASTER'
		   AND CAL_DATE &gt;= CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'
		   AND CAL_DATE &lt;= CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
		   AND CAL_TYPE  = '1'
	</select>
	
	<select id="ppl120skrvServiceImpl.selectList1" parameterType="Map" resultType="rMap">
		--ppl120skrv.Cppl120skrv [fnPpl120QStd] QUERY01
        SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED 
        SELECT 
               X.DIV_CODE
             , X.ITEM_CODE
             , X.ITEM_NAME
             , X.SPEC
             , X.WORK_SHOP_CODE
             , (
             	SUM(X.DAY1_Q) + SUM(X.DAY2_Q) + SUM(X.DAY3_Q) + SUM(X.DAY4_Q) + SUM(X.DAY5_Q)
              + SUM(X.DAY6_Q) + SUM(X.DAY7_Q) + SUM(X.DAY8_Q) + SUM(X.DAY9_Q) + SUM(X.DAY10_Q)
              + SUM(X.DAY11_Q) + SUM(X.DAY12_Q) + SUM(X.DAY13_Q) + SUM(X.DAY14_Q) + SUM(X.DAY15_Q)
              + SUM(X.DAY16_Q) + SUM(X.DAY17_Q) + SUM(X.DAY18_Q) + SUM(X.DAY19_Q) + SUM(X.DAY20_Q)
              + SUM(X.DAY21_Q) + SUM(X.DAY22_Q) + SUM(X.DAY23_Q) + SUM(X.DAY24_Q) + SUM(X.DAY25_Q)
              + SUM(X.DAY26_Q) + SUM(X.DAY27_Q) + SUM(X.DAY28_Q) + SUM(X.DAY29_Q) + SUM(X.DAY30_Q) + SUM(X.DAY31_Q)
               ) AS TOT_Q
             , SUM(X.DAY1_Q) DAY1_Q
             , SUM(X.DAY2_Q) DAY2_Q
             , SUM(X.DAY3_Q) DAY3_Q
             , SUM(X.DAy4_Q) DAY4_Q
             , SUM(X.DAY5_Q) DAY5_Q
             , SUM(X.DAY6_Q) DAY6_Q
             , SUM(X.DAY7_Q) DAY7_Q
             , SUM(X.DAY8_Q) DAY8_Q
             , SUM(X.DAy9_Q) DAY9_Q
             , SUM(X.DAY10_Q) DAY10_Q
             , SUM(X.DAY11_Q) DAY11_Q
             , SUM(X.DAY12_Q) DAY12_Q
             , SUM(X.DAY13_Q) DAY13_Q
             , SUM(X.DAy14_Q) DAY14_Q
             , SUM(X.DAY15_Q) DAY15_Q
             , SUM(X.DAY16_Q) DAY16_Q
             , SUM(X.DAY17_Q) DAY17_Q
             , SUM(X.DAY18_Q) DAY18_Q
             , SUM(X.DAy19_Q) DAY19_Q
             , SUM(X.DAY20_Q) DAY20_Q
             , SUM(X.DAY21_Q) DAY21_Q
             , SUM(X.DAY22_Q) DAY22_Q
             , SUM(X.DAY23_Q) DAY23_Q
             , SUM(X.DAy24_Q) DAY24_Q
             , SUM(X.DAY25_Q) DAY25_Q
             , SUM(X.DAY26_Q) DAY26_Q
             , SUM(X.DAY27_Q) DAY27_Q
             , SUM(X.DAY28_Q) DAY28_Q
             , SUM(X.DAY29_Q) DAY29_Q
			 , SUM(X.DAY30_Q) DAY30_Q
			 , SUM(X.DAY31_Q) DAY31_Q
      
          FROM (SELECT A.DIV_CODE
                     , A.ITEM_CODE
                     , uniLITE.fnItemNameComp(#{S_COMP_CODE}, #{S_USER_ID},A.ITEM_CODE) AS ITEM_NAME
                     , B.SPEC
                     , A.WORK_SHOP_CODE
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 1 THEN A.WK_PLAN_Q ELSE 0 END) DAY1_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 2 THEN A.WK_PLAN_Q ELSE 0 END) DAY2_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 3 THEN A.WK_PLAN_Q ELSE 0 END) DAY3_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 4 THEN A.WK_PLAN_Q ELSE 0 END) DAY4_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 5 THEN A.WK_PLAN_Q ELSE 0 END) DAY5_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 6 THEN A.WK_PLAN_Q ELSE 0 END) DAY6_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 7 THEN A.WK_PLAN_Q ELSE 0 END) DAY7_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 8 THEN A.WK_PLAN_Q ELSE 0 END) DAY8_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 9 THEN A.WK_PLAN_Q ELSE 0 END) DAY9_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 10 THEN A.WK_PLAN_Q ELSE 0 END) DAY10_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 11 THEN A.WK_PLAN_Q ELSE 0 END) DAY11_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 12 THEN A.WK_PLAN_Q ELSE 0 END) DAY12_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 13 THEN A.WK_PLAN_Q ELSE 0 END) DAY13_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 14 THEN A.WK_PLAN_Q ELSE 0 END) DAY14_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 15 THEN A.WK_PLAN_Q ELSE 0 END) DAY15_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 16 THEN A.WK_PLAN_Q ELSE 0 END) DAY16_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 17 THEN A.WK_PLAN_Q ELSE 0 END) DAY17_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 18 THEN A.WK_PLAN_Q ELSE 0 END) DAY18_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 19 THEN A.WK_PLAN_Q ELSE 0 END) DAY19_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 20 THEN A.WK_PLAN_Q ELSE 0 END) DAY20_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 21 THEN A.WK_PLAN_Q ELSE 0 END) DAY21_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 22 THEN A.WK_PLAN_Q ELSE 0 END) DAY22_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 23 THEN A.WK_PLAN_Q ELSE 0 END) DAY23_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 24 THEN A.WK_PLAN_Q ELSE 0 END) DAY24_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 25 THEN A.WK_PLAN_Q ELSE 0 END) DAY25_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 26 THEN A.WK_PLAN_Q ELSE 0 END) DAY26_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 27 THEN A.WK_PLAN_Q ELSE 0 END) DAY27_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 28 THEN A.WK_PLAN_Q ELSE 0 END) DAY28_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 29 THEN A.WK_PLAN_Q ELSE 0 END) DAY29_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 30 THEN A.WK_PLAN_Q ELSE 0 END) DAY30_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 31 THEN A.WK_PLAN_Q ELSE 0 END) DAY31_Q
                  FROM             PPL100T  A
                       LEFT JOIN   BPR100T  B WITH (NOLOCK) ON B.COMP_CODE        = A.COMP_CODE                                                  
                                                            AND B.ITEM_CODE       = A.ITEM_CODE
                       LEFT JOIN   BPR200T  C WITH (NOLOCK) ON C.COMP_CODE        = A.COMP_CODE
                                                            AND C.DIV_CODE        = A.DIV_CODE
                                                            AND C.ITEM_CODE       = A.ITEM_CODE

                 WHERE A.COMP_CODE = #{S_COMP_CODE}
                   AND B.COMP_CODE = #{S_COMP_CODE}
                   AND A.ITEM_CODE = B.ITEM_CODE
                   AND A.DIV_CODE  = #{DIV_CODE}
                   AND A.PRODT_PLAN_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
                   							 AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
	    <if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
                   AND A.WORK_SHOP_CODE LIKE #{WORK_SHOP_CODE}
	    </if>
		<if test="@foren.Ognl@isNotEmpty(ITEM_CODE)">
                   AND A.WORK_SHOP_CODE LIKE #{ITEM_CODE}
	    </if>
	    <if test="@foren.Ognl@isNotEmpty(ITEM_ACCOUNT)">
                   AND A.WORK_SHOP_CODE LIKE #{ITEM_ACCOUNT}
	    </if>
        
                 GROUP BY A.DIV_CODE, A.ITEM_CODE, B.ITEM_NAME, B.SPEC, A.WORK_SHOP_CODE) X
         GROUP BY X.DIV_CODE, X.ITEM_CODE, X.ITEM_NAME, X.SPEC, X.WORK_SHOP_CODE
         ORDER BY X.DIV_CODE, X.ITEM_CODE, X.WORK_SHOP_CODE
	</select>
	
	<select id="ppl120skrvServiceImpl.selectList2" parameterType="Map" resultType="rMap">
  		--ppl120skrv.Cppl120skrv [fnPpl120QStd] QUERY02
        SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED 
        SELECT 
               X.DIV_CODE
             , X.WORK_SHOP_CODE
             , X.ITEM_CODE
             , X.ITEM_NAME
             , X.SPEC
             , (
             	SUM(X.DAY1_Q) + SUM(X.DAY2_Q) + SUM(X.DAY3_Q) + SUM(X.DAY4_Q) + SUM(X.DAY5_Q)
              + SUM(X.DAY6_Q) + SUM(X.DAY7_Q) + SUM(X.DAY8_Q) + SUM(X.DAY9_Q) + SUM(X.DAY10_Q)
              + SUM(X.DAY11_Q) + SUM(X.DAY12_Q) + SUM(X.DAY13_Q) + SUM(X.DAY14_Q) + SUM(X.DAY15_Q)
              + SUM(X.DAY16_Q) + SUM(X.DAY17_Q) + SUM(X.DAY18_Q) + SUM(X.DAY19_Q) + SUM(X.DAY20_Q)
              + SUM(X.DAY21_Q) + SUM(X.DAY22_Q) + SUM(X.DAY23_Q) + SUM(X.DAY24_Q) + SUM(X.DAY25_Q)
              + SUM(X.DAY26_Q) + SUM(X.DAY27_Q) + SUM(X.DAY28_Q) + SUM(X.DAY29_Q) + SUM(X.DAY30_Q) + SUM(X.DAY31_Q)
               ) AS TOT_Q
             , SUM(X.DAY1_Q) DAY1_Q
             , SUM(X.DAY2_Q) DAY2_Q
             , SUM(X.DAY3_Q) DAY3_Q
             , SUM(X.DAy4_Q) DAY4_Q
             , SUM(X.DAY5_Q) DAY5_Q
             , SUM(X.DAY6_Q) DAY6_Q
             , SUM(X.DAY7_Q) DAY7_Q
             , SUM(X.DAY8_Q) DAY8_Q
             , SUM(X.DAy9_Q) DAY9_Q
             , SUM(X.DAY10_Q) DAY10_Q
             , SUM(X.DAY11_Q) DAY11_Q
             , SUM(X.DAY12_Q) DAY12_Q
             , SUM(X.DAY13_Q) DAY13_Q
             , SUM(X.DAy14_Q) DAY14_Q
             , SUM(X.DAY15_Q) DAY15_Q
             , SUM(X.DAY16_Q) DAY16_Q
             , SUM(X.DAY17_Q) DAY17_Q
             , SUM(X.DAY18_Q) DAY18_Q
             , SUM(X.DAy19_Q) DAY19_Q
             , SUM(X.DAY20_Q) DAY20_Q
             , SUM(X.DAY21_Q) DAY21_Q
             , SUM(X.DAY22_Q) DAY22_Q
             , SUM(X.DAY23_Q) DAY23_Q
             , SUM(X.DAy24_Q) DAY24_Q
             , SUM(X.DAY25_Q) DAY25_Q
             , SUM(X.DAY26_Q) DAY26_Q
             , SUM(X.DAY27_Q) DAY27_Q
             , SUM(X.DAY28_Q) DAY28_Q
             , SUM(X.DAY29_Q) DAY29_Q
			 , SUM(X.DAY30_Q) DAY30_Q
			 , SUM(X.DAY31_Q) DAY31_Q
      
          FROM (SELECT A.DIV_CODE
                     , A.WORK_SHOP_CODE
                     , A.ITEM_CODE
                     , uniLITE.fnItemNameComp(#{S_COMP_CODE}, #{S_USER_ID},A.ITEM_CODE) AS ITEM_NAME
                     , B.SPEC
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 1 THEN A.WK_PLAN_Q ELSE 0 END) DAY1_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 2 THEN A.WK_PLAN_Q ELSE 0 END) DAY2_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 3 THEN A.WK_PLAN_Q ELSE 0 END) DAY3_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 4 THEN A.WK_PLAN_Q ELSE 0 END) DAY4_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 5 THEN A.WK_PLAN_Q ELSE 0 END) DAY5_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 6 THEN A.WK_PLAN_Q ELSE 0 END) DAY6_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 7 THEN A.WK_PLAN_Q ELSE 0 END) DAY7_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 8 THEN A.WK_PLAN_Q ELSE 0 END) DAY8_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 9 THEN A.WK_PLAN_Q ELSE 0 END) DAY9_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 10 THEN A.WK_PLAN_Q ELSE 0 END) DAY10_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 11 THEN A.WK_PLAN_Q ELSE 0 END) DAY11_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 12 THEN A.WK_PLAN_Q ELSE 0 END) DAY12_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 13 THEN A.WK_PLAN_Q ELSE 0 END) DAY13_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 14 THEN A.WK_PLAN_Q ELSE 0 END) DAY14_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 15 THEN A.WK_PLAN_Q ELSE 0 END) DAY15_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 16 THEN A.WK_PLAN_Q ELSE 0 END) DAY16_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 17 THEN A.WK_PLAN_Q ELSE 0 END) DAY17_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 18 THEN A.WK_PLAN_Q ELSE 0 END) DAY18_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 19 THEN A.WK_PLAN_Q ELSE 0 END) DAY19_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 20 THEN A.WK_PLAN_Q ELSE 0 END) DAY20_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 21 THEN A.WK_PLAN_Q ELSE 0 END) DAY21_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 22 THEN A.WK_PLAN_Q ELSE 0 END) DAY22_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 23 THEN A.WK_PLAN_Q ELSE 0 END) DAY23_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 24 THEN A.WK_PLAN_Q ELSE 0 END) DAY24_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 25 THEN A.WK_PLAN_Q ELSE 0 END) DAY25_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 26 THEN A.WK_PLAN_Q ELSE 0 END) DAY26_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 27 THEN A.WK_PLAN_Q ELSE 0 END) DAY27_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 28 THEN A.WK_PLAN_Q ELSE 0 END) DAY28_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 29 THEN A.WK_PLAN_Q ELSE 0 END) DAY29_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 30 THEN A.WK_PLAN_Q ELSE 0 END) DAY30_Q
                     , SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 7, 2) = 31 THEN A.WK_PLAN_Q ELSE 0 END) DAY31_Q
                  FROM             PPL100T  A
                       LEFT JOIN   BPR100T  B WITH (NOLOCK) ON B.COMP_CODE        = A.COMP_CODE                                                  
                                                            AND B.ITEM_CODE       = A.ITEM_CODE
                       LEFT JOIN   BPR200T  C WITH (NOLOCK) ON C.COMP_CODE        = A.COMP_CODE
                                                            AND C.DIV_CODE        = A.DIV_CODE
                                                            AND C.ITEM_CODE       = A.ITEM_CODE

                 WHERE A.COMP_CODE = #{S_COMP_CODE}
                   AND B.COMP_CODE = #{S_COMP_CODE}
                   AND A.ITEM_CODE = B.ITEM_CODE
                   AND A.DIV_CODE  = #{DIV_CODE}
                   AND A.PRODT_PLAN_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
                   							 AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
	    <if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
                   AND A.WORK_SHOP_CODE LIKE #{WORK_SHOP_CODE}
	    </if>
		<if test="@foren.Ognl@isNotEmpty(ITEM_CODE)">
                   AND A.WORK_SHOP_CODE LIKE #{ITEM_CODE}
	    </if>
	    <if test="@foren.Ognl@isNotEmpty(ITEM_ACCOUNT)">
                   AND A.WORK_SHOP_CODE LIKE #{ITEM_ACCOUNT}
	    </if>
        
                 GROUP BY A.DIV_CODE, A.WORK_SHOP_CODE, A.ITEM_CODE, B.ITEM_NAME, B.SPEC) X
         GROUP BY X.DIV_CODE, X.WORK_SHOP_CODE, X.ITEM_CODE, X.ITEM_NAME, X.SPEC
         ORDER BY X.DIV_CODE, X.WORK_SHOP_CODE, X.ITEM_CODE 	
	</select>
   	<select id="ppl120skrvServiceImpl.selectList3" parameterType="Map" resultType="rMap">
   	     SELECT                      DIV_CODE, CASE WHEN WORKSHOP = 'A' THEN '1.전기' WHEN WORKSHOP = 'B' THEN '2.등기구' WHEN WORKSHOP = 'C' THEN '3.판금' WHEN WORKSHOP = 'D' THEN '4.TR' WHEN WORKSHOP = 'E' THEN '5.가공' Else '6.기타' END AS WORKSHOP,
                  ITEM_CODE ITEM, ITEM_NAME, GUBUN, ITEM_CODE,
                  ISNULL((WK_PLAN_Q1 + WK_PLAN_Q2 + WK_PLAN_Q3 + WK_PLAN_Q4 + WK_PLAN_Q5 + WK_PLAN_Q6 + WK_PLAN_Q7 + WK_PLAN_Q8 + WK_PLAN_Q8 + WK_PLAN_Q10 + WK_PLAN_Q11 + WK_PLAN_Q12),0) AS T_WK_PLAN_Q,
                      ISNULL((WK_PLAN_A1 + WK_PLAN_A2 + WK_PLAN_A3 + WK_PLAN_A4 + WK_PLAN_A5 + WK_PLAN_A6 + WK_PLAN_A7 + WK_PLAN_A8 + WK_PLAN_A9 + WK_PLAN_A10 + WK_PLAN_A11 + WK_PLAN_A12),0)  AS T_WK_PLAN_A,
                      ISNULL((PL_A1 + PL_A2 +PL_A3 +PL_A4 +PL_A5 +PL_A6 +PL_A7 +PL_A8 +PL_A9 +PL_A10 +PL_A11 +PL_A12),0) AS T_PL_A,
                      (PRICE_A1 + PRICE_A2 + PRICE_A3 + PRICE_A4 + PRICE_A5 + PRICE_A6 + PRICE_A7 + PRICE_A8 + PRICE_A9 + PRICE_A10 + PRICE_A11 + PRICE_A12) AS T_PRICE_A,
                WK_PLAN_Q1, WK_PLAN_A1, PL_A1, PRICE_A1,
                WK_PLAN_Q2, WK_PLAN_A2, PL_A2, PRICE_A2,
                WK_PLAN_Q3, WK_PLAN_A3, PL_A3, PRICE_A3,
                WK_PLAN_Q4, WK_PLAN_A4, PL_A4, PRICE_A4,
                WK_PLAN_Q5, WK_PLAN_A5, PL_A5, PRICE_A5,
                WK_PLAN_Q6, WK_PLAN_A6, PL_A6, PRICE_A6,
                WK_PLAN_Q7, WK_PLAN_A7, PL_A7, PRICE_A7,
                WK_PLAN_Q8, WK_PLAN_A8, PL_A8, PRICE_A8,
                WK_PLAN_Q9, WK_PLAN_A9, PL_A9, PRICE_A9,
                WK_PLAN_Q10, WK_PLAN_A10, PL_A10, PRICE_A10,
                WK_PLAN_Q11, WK_PLAN_A11, PL_A11, PRICE_A11,
                WK_PLAN_Q12 , WK_PLAN_A12, PL_A12, PRICE_A12,
                     I_FORWARD1,  I_WEEKDAY1_1,  I_WEEKDAY1_2,  I_WEEKDAY1_3,  I_WEEKDAY1_4, I_WEEKDAY1_5,
                      I_FORWARD2,  I_WEEKDAY2_1,  I_WEEKDAY2_2,  I_WEEKDAY2_3,  I_WEEKDAY2_4, I_WEEKDAY2_5,
                      I_FORWARD3,  I_WEEKDAY3_1,  I_WEEKDAY3_2,  I_WEEKDAY3_3,  I_WEEKDAY3_4, I_WEEKDAY3_5,
                      I_FORWARD4,  I_WEEKDAY4_1,  I_WEEKDAY4_2,  I_WEEKDAY4_3,  I_WEEKDAY4_4, I_WEEKDAY4_5,
                      I_FORWARD5,  I_WEEKDAY5_1,  I_WEEKDAY5_2,  I_WEEKDAY5_3,  I_WEEKDAY5_4, I_WEEKDAY5_5,
                      I_FORWARD6,  I_WEEKDAY6_1,  I_WEEKDAY6_2,  I_WEEKDAY6_3,  I_WEEKDAY6_4, I_WEEKDAY6_5,
                      I_FORWARD7,  I_WEEKDAY7_1,  I_WEEKDAY7_2,  I_WEEKDAY7_3,  I_WEEKDAY7_4, I_WEEKDAY7_5,
                      I_FORWARD8,  I_WEEKDAY8_1,  I_WEEKDAY8_2,  I_WEEKDAY8_3,  I_WEEKDAY8_4, I_WEEKDAY8_5,
                      I_FORWARD9,  I_WEEKDAY9_1,  I_WEEKDAY9_2,  I_WEEKDAY9_3,  I_WEEKDAY9_4, I_WEEKDAY9_5,
                      I_FORWARD10,  I_WEEKDAY10_1, I_WEEKDAY10_2,  I_WEEKDAY10_3,  I_WEEKDAY10_4, I_WEEKDAY10_5,
                      I_FORWARD11,  I_WEEKDAY11_1, I_WEEKDAY11_2,  I_WEEKDAY11_3,  I_WEEKDAY11_4, I_WEEKDAY11_5,
                      I_FORWARD12 , I_WEEKDAY12_1, I_WEEKDAY12_2,  I_WEEKDAY12_3,  I_WEEKDAY12_4, I_WEEKDAY12_5,
                     CI_FORWARD1,  CI_WEEKDAY1_1,  CI_WEEKDAY1_2,  CI_WEEKDAY1_3,  CI_WEEKDAY1_4, CI_WEEKDAY1_5,
                      CI_FORWARD2,  CI_WEEKDAY2_1,  CI_WEEKDAY2_2,  CI_WEEKDAY2_3,  CI_WEEKDAY2_4, CI_WEEKDAY2_5,
                      CI_FORWARD3,  CI_WEEKDAY3_1,  CI_WEEKDAY3_2,  CI_WEEKDAY3_3,  CI_WEEKDAY3_4, CI_WEEKDAY3_5,
                      CI_FORWARD4,  CI_WEEKDAY4_1,  CI_WEEKDAY4_2,  CI_WEEKDAY4_3,  CI_WEEKDAY4_4, CI_WEEKDAY4_5,
                      CI_FORWARD5,  CI_WEEKDAY5_1,  CI_WEEKDAY5_2,  CI_WEEKDAY5_3,  CI_WEEKDAY5_4, CI_WEEKDAY5_5,
                      CI_FORWARD6,  CI_WEEKDAY6_1,  CI_WEEKDAY6_2,  CI_WEEKDAY6_3,  CI_WEEKDAY6_4, CI_WEEKDAY6_5,
                      CI_FORWARD7,  CI_WEEKDAY7_1,  CI_WEEKDAY7_2,  CI_WEEKDAY7_3,  CI_WEEKDAY7_4, CI_WEEKDAY7_5,
                      CI_FORWARD8,  CI_WEEKDAY8_1,  CI_WEEKDAY8_2,  CI_WEEKDAY8_3,  CI_WEEKDAY8_4, CI_WEEKDAY8_5,
                      CI_FORWARD9,  CI_WEEKDAY9_1,  CI_WEEKDAY9_2,  CI_WEEKDAY9_3,  CI_WEEKDAY9_4, CI_WEEKDAY9_5,
                      CI_FORWARD10,  CI_WEEKDAY10_1, CI_WEEKDAY10_2,  CI_WEEKDAY10_3,  CI_WEEKDAY10_4, CI_WEEKDAY10_5,
                      CI_FORWARD11,  CI_WEEKDAY11_1, CI_WEEKDAY11_2,  CI_WEEKDAY11_3,  CI_WEEKDAY11_4, CI_WEEKDAY11_5,
                      CI_FORWARD12 , CI_WEEKDAY12_1, CI_WEEKDAY12_2,  CI_WEEKDAY12_3,  CI_WEEKDAY12_4, CI_WEEKDAY12_5,
                     O_WEEKDAY1_1, O_WEEKDAY1_2, O_WEEKDAY1_3, O_WEEKDAY1_4, O_WEEKDAY1_5,
                     O_WEEKDAY2_1, O_WEEKDAY2_2, O_WEEKDAY2_3, O_WEEKDAY2_4, O_WEEKDAY2_5,
                      O_WEEKDAY3_1, O_WEEKDAY3_2, O_WEEKDAY3_3, O_WEEKDAY3_4, O_WEEKDAY3_5,
                      O_WEEKDAY4_1, O_WEEKDAY4_2, O_WEEKDAY4_3, O_WEEKDAY4_4, O_WEEKDAY4_5,
                      O_WEEKDAY5_1, O_WEEKDAY5_2, O_WEEKDAY5_3, O_WEEKDAY5_4, O_WEEKDAY5_5,
                      O_WEEKDAY6_1, O_WEEKDAY6_2, O_WEEKDAY6_3, O_WEEKDAY6_4, O_WEEKDAY6_5,
                      O_WEEKDAY7_1, O_WEEKDAY7_2, O_WEEKDAY7_3, O_WEEKDAY7_4, O_WEEKDAY7_5,
                      O_WEEKDAY8_1, O_WEEKDAY8_2, O_WEEKDAY8_3, O_WEEKDAY8_4, O_WEEKDAY8_5,
                      O_WEEKDAY9_1, O_WEEKDAY9_2, O_WEEKDAY9_3, O_WEEKDAY9_4, O_WEEKDAY9_5,
                      O_WEEKDAY10_1, O_WEEKDAY10_2, O_WEEKDAY10_3, O_WEEKDAY10_4, O_WEEKDAY10_5,
                      O_WEEKDAY11_1, O_WEEKDAY11_2, O_WEEKDAY11_3, O_WEEKDAY11_4, O_WEEKDAY11_5,
                      O_WEEKDAY12_1, O_WEEKDAY12_2, O_WEEKDAY12_3, O_WEEKDAY12_4, O_WEEKDAY12_5
     From
              (
             SELECT  TT.DIV_CODE, ISNULL((SELECT ITEM_MAKER_PN FROM BPR100T WHERE ITEM_CODE = TT.ITEM_CODE),'') WORKSHOP,  ITEM_NAME, GUBUN, TT.ITEM_CODE,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'01' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q1,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'02' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q2,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'03' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q3,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'04' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q4,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'05' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q5,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'06' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q6,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'07' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q7,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'08' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q8,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'09' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q9,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'10' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q10,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'11' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q11,
                             MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'12' THEN WK_PLAN_Q ELSE 0 END) WK_PLAN_Q12,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'01' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A1,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'02' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A2,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'03' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A3,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'04' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A4,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'05' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A5,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'06' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A6,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'07' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A7,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'08' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A8,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'09' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A9,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'10' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A10,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'11' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A11,
                             ISNULL(((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'12' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6),0) AS WK_PLAN_A12,
                             ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'01' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A1,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'02' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A2,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'03' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A3,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'04' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A4,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'05' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A5,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'06' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A6,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'07' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A7,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'08' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A8,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'09' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A9,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'10' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A10,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'11' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A11,
                            ISNULL((MAX(CASE WHEN PRODT_PLAN_MONTH =  RIGHT(#{FR_DATE},2)+'12' THEN WK_PLAN_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})),0) AS PL_A12,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'01' THEN PRICE_A ELSE 0 END) PRICE_A1,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'02' THEN PRICE_A ELSE 0 END) PRICE_A2,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'03' THEN PRICE_A ELSE 0 END) PRICE_A3,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'04' THEN PRICE_A ELSE 0 END) PRICE_A4,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'05' THEN PRICE_A ELSE 0 END) PRICE_A5,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'06' THEN PRICE_A ELSE 0 END) PRICE_A6,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'07' THEN PRICE_A ELSE 0 END) PRICE_A7,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'08' THEN PRICE_A ELSE 0 END) PRICE_A8,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'09' THEN PRICE_A ELSE 0 END) PRICE_A9,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'10' THEN PRICE_A ELSE 0 END) PRICE_A10,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'11' THEN PRICE_A ELSE 0 END) PRICE_A11,
                            MAX(CASE WHEN LC_MONTH =  RIGHT(#{FR_DATE},2)+'12' THEN PRICE_A ELSE 0 END) PRICE_A12,
                            0 I_FORWARD1, 0 I_WEEKDAY1_1, 0 I_WEEKDAY1_2, 0 I_WEEKDAY1_3, 0 I_WEEKDAY1_4, 0 I_WEEKDAY1_5,
                            0 I_FORWARD2, 0 I_WEEKDAY2_1, 0 I_WEEKDAY2_2, 0 I_WEEKDAY2_3, 0 I_WEEKDAY2_4, 0 I_WEEKDAY2_5,
                            0 I_FORWARD3, 0 I_WEEKDAY3_1, 0 I_WEEKDAY3_2, 0 I_WEEKDAY3_3, 0 I_WEEKDAY3_4, 0 I_WEEKDAY3_5,
                            0 I_FORWARD4, 0 I_WEEKDAY4_1, 0 I_WEEKDAY4_2, 0 I_WEEKDAY4_3, 0 I_WEEKDAY4_4, 0 I_WEEKDAY4_5,
                            0 I_FORWARD5, 0 I_WEEKDAY5_1, 0 I_WEEKDAY5_2, 0 I_WEEKDAY5_3, 0 I_WEEKDAY5_4, 0 I_WEEKDAY5_5,
                           0 I_FORWARD6, 0 I_WEEKDAY6_1, 0 I_WEEKDAY6_2, 0 I_WEEKDAY6_3, 0 I_WEEKDAY6_4, 0 I_WEEKDAY6_5,
                            0 I_FORWARD7, 0 I_WEEKDAY7_1, 0 I_WEEKDAY7_2, 0 I_WEEKDAY7_3, 0 I_WEEKDAY7_4, 0 I_WEEKDAY7_5,
                           0 I_FORWARD8, 0 I_WEEKDAY8_1, 0 I_WEEKDAY8_2, 0 I_WEEKDAY8_3, 0 I_WEEKDAY8_4, 0 I_WEEKDAY8_5,
                            0 I_FORWARD9, 0 I_WEEKDAY9_1, 0 I_WEEKDAY9_2, 0 I_WEEKDAY9_3, 0 I_WEEKDAY9_4, 0 I_WEEKDAY9_5,
                            0 I_FORWARD10, 0 I_WEEKDAY10_1, 0 I_WEEKDAY10_2, 0 I_WEEKDAY10_3, 0 I_WEEKDAY10_4, 0 I_WEEKDAY10_5,
                           0 I_FORWARD11, 0 I_WEEKDAY11_1, 0 I_WEEKDAY11_2, 0 I_WEEKDAY11_3, 0 I_WEEKDAY11_4, 0 I_WEEKDAY11_5,
                           0 I_FORWARD12, 0 I_WEEKDAY12_1, 0 I_WEEKDAY12_2, 0 I_WEEKDAY12_3, 0 I_WEEKDAY12_4, 0 I_WEEKDAY12_5,
          0 CI_FORWARD1, 0 CI_WEEKDAY1_1, 0 CI_WEEKDAY1_2, 0 CI_WEEKDAY1_3, 0 CI_WEEKDAY1_4, 0 CI_WEEKDAY1_5,
                          0 CI_FORWARD2, 0 CI_WEEKDAY2_1, 0 CI_WEEKDAY2_2, 0 CI_WEEKDAY2_3, 0 CI_WEEKDAY2_4, 0 CI_WEEKDAY2_5,
                          0 CI_FORWARD3, 0 CI_WEEKDAY3_1, 0 CI_WEEKDAY3_2, 0 CI_WEEKDAY3_3, 0 CI_WEEKDAY3_4, 0 CI_WEEKDAY3_5,
                          0 CI_FORWARD4, 0 CI_WEEKDAY4_1, 0 CI_WEEKDAY4_2, 0 CI_WEEKDAY4_3, 0 CI_WEEKDAY4_4, 0 CI_WEEKDAY4_5,
                          0 CI_FORWARD5, 0 CI_WEEKDAY5_1, 0 CI_WEEKDAY5_2, 0 CI_WEEKDAY5_3, 0 CI_WEEKDAY5_4, 0 CI_WEEKDAY5_5,
                          0 CI_FORWARD6, 0 CI_WEEKDAY6_1, 0 CI_WEEKDAY6_2, 0 CI_WEEKDAY6_3, 0 CI_WEEKDAY6_4, 0 CI_WEEKDAY6_5,
                          0 CI_FORWARD7, 0 CI_WEEKDAY7_1, 0 CI_WEEKDAY7_2, 0 CI_WEEKDAY7_3, 0 CI_WEEKDAY7_4, 0 CI_WEEKDAY7_5,
                          0 CI_FORWARD8, 0 CI_WEEKDAY8_1, 0 CI_WEEKDAY8_2, 0 CI_WEEKDAY8_3, 0 CI_WEEKDAY8_4, 0 CI_WEEKDAY8_5,
                          0 CI_FORWARD9, 0 CI_WEEKDAY9_1, 0 CI_WEEKDAY9_2, 0 CI_WEEKDAY9_3, 0 CI_WEEKDAY9_4, 0 CI_WEEKDAY9_5,
                          0 CI_FORWARD10, 0 CI_WEEKDAY10_1, 0 CI_WEEKDAY10_2, 0 CI_WEEKDAY10_3, 0 CI_WEEKDAY10_4, 0 CI_WEEKDAY10_5,
                         0 CI_FORWARD11, 0 CI_WEEKDAY11_1, 0 CI_WEEKDAY11_2, 0 CI_WEEKDAY11_3, 0 CI_WEEKDAY11_4, 0 CI_WEEKDAY11_5,
                         0 CI_FORWARD12, 0 CI_WEEKDAY12_1, 0 CI_WEEKDAY12_2, 0 CI_WEEKDAY12_3, 0 CI_WEEKDAY12_4, 0 CI_WEEKDAY12_5
     From
                 (
                         SELECT DIV_CODE, GUBUN, A.ITEM_CODE, ITEM_NAME, WK_PLAN_Q, PRODT_PLAN_MONTH, LC_MONTH, ISNULL(PRICE_A,0) PRICE_A
                         From
                        (
                                SELECT  DIV_CODE, (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '11'  AND COMP_CODE = #{S_COMP_CODE}) AS GUBUN, A.ITEM_CODE, ITEM_NAME,
                                        SUBSTRING(A.PRODT_PLAN_DATE,3,4) PRODT_PLAN_MONTH, SUM(ISNULL(WK_PLAN_Q,0)) WK_PLAN_Q
                                FROM PPL100T A, BPR100T B
                                Where A.ITEM_CODE = B.ITEM_CODE
                                AND A.COMP_CODE = B.COMP_CODE
                                AND A.COMP_CODE = #{S_COMP_CODE}
                                AND SUBSTRING(A.PRODT_PLAN_DATE,1,4) =  #{FR_DATE}
                                GROUP BY A.DIV_CODE, A.ITEM_CODE, ITEM_NAME, SPEC, SUBSTRING(A.PRODT_PLAN_DATE,3,4)
						)A left join 
                            (
								SELECT SUM(PRICE_A) PRICE_A, RECEIPT_TYPE, LC_MONTH
                                From
                                (
                                    SELECT CASE WHEN CONTROL_STATUS = '9' THEN ISNULL(SUM(INSTOCK_Q * ORDER_P),0)  ELSE ISNULL(SUM(ORDER_O),0) END PRICE_A, RECEIPT_TYPE, LC_MONTH
                                    From
                                    (
                                                SELECT  ITEM_CODE,  ORDER_Q,  ORDER_P,  ORDER_O,  INSTOCK_Q,
                                                       CONTROL_STATUS, RECEIPT_TYPE, SUBSTRING(LC_NUM,3,4) LC_MONTH
                                               FROM MPO100T A, MPO200T B
                                               Where A.ORDER_NUM = B.ORDER_NUM
                                               AND A.COMP_CODE = B.COMP_CODE
                                               AND A.COMP_CODE = #{S_COMP_CODE}
                                   )AA
                                   GROUP BY RECEIPT_TYPE, CONTROL_STATUS, LC_MONTH
                              )AAA
                               GROUP BY RECEIPT_TYPE,  LC_MONTH
                   )B on A.ITEM_CODE = B.RECEIPT_TYPE
           )TT
           GROUP BY DIV_CODE, GUBUN, ITEM_CODE, ITEM_NAME
  )BB,
             (SELECT 
                 O_WEEKDAY1_1, O_WEEKDAY1_2,  O_WEEKDAY1_3, O_WEEKDAY1_4, O_WEEKDAY1_5,
                 O_WEEKDAY2_1, O_WEEKDAY2_2,  O_WEEKDAY2_3, O_WEEKDAY2_4, O_WEEKDAY2_5,
                 O_WEEKDAY3_1, O_WEEKDAY3_2,  O_WEEKDAY3_3, O_WEEKDAY3_4, O_WEEKDAY3_5,
                 O_WEEKDAY4_1, O_WEEKDAY4_2,  O_WEEKDAY4_3, O_WEEKDAY4_4, O_WEEKDAY4_5,
                 O_WEEKDAY5_1, O_WEEKDAY5_2,  O_WEEKDAY5_3, O_WEEKDAY5_4, O_WEEKDAY5_5,
                 O_WEEKDAY6_1, O_WEEKDAY6_2,  O_WEEKDAY6_3, O_WEEKDAY6_4, O_WEEKDAY6_5,
                 O_WEEKDAY7_1, O_WEEKDAY7_2,  O_WEEKDAY7_3, O_WEEKDAY7_4, O_WEEKDAY7_5,
                 O_WEEKDAY8_1, O_WEEKDAY8_2,  O_WEEKDAY8_3, O_WEEKDAY8_4, O_WEEKDAY8_5,
                 O_WEEKDAY9_1, O_WEEKDAY9_2,  O_WEEKDAY9_3, O_WEEKDAY9_4, O_WEEKDAY9_5,
                 O_WEEKDAY10_1, O_WEEKDAY10_2,  O_WEEKDAY10_3, O_WEEKDAY10_4, O_WEEKDAY10_5,
                 O_WEEKDAY11_1, O_WEEKDAY11_2,  O_WEEKDAY11_3, O_WEEKDAY11_4, O_WEEKDAY11_5,
                 O_WEEKDAY12_1 , O_WEEKDAY12_2, O_WEEKDAY12_3, O_WEEKDAY12_4, O_WEEKDAY12_5
         From
        
    (SELECT SUM(O_WEEKDAY1_1) O_WEEKDAY1_1, SUM(O_WEEKDAY1_2) O_WEEKDAY1_2, SUM(O_WEEKDAY1_3) O_WEEKDAY1_3, SUM(O_WEEKDAY1_4) O_WEEKDAY1_4, SUM(O_WEEKDAY1_5) O_WEEKDAY1_5,
       SUM(O_WEEKDAY2_1) O_WEEKDAY2_1, SUM(O_WEEKDAY2_2) O_WEEKDAY2_2, SUM(O_WEEKDAY2_3) O_WEEKDAY2_3, SUM(O_WEEKDAY2_4) O_WEEKDAY2_4, SUM(O_WEEKDAY2_5) O_WEEKDAY2_5,
       SUM(O_WEEKDAY3_1) O_WEEKDAY3_1, SUM(O_WEEKDAY3_2) O_WEEKDAY3_2, SUM(O_WEEKDAY3_3) O_WEEKDAY3_3, SUM(O_WEEKDAY3_4) O_WEEKDAY3_4, SUM(O_WEEKDAY3_5) O_WEEKDAY3_5,
       SUM(O_WEEKDAY4_1) O_WEEKDAY4_1, SUM(O_WEEKDAY4_2) O_WEEKDAY4_2, SUM(O_WEEKDAY4_3) O_WEEKDAY4_3, SUM(O_WEEKDAY4_4) O_WEEKDAY4_4, SUM(O_WEEKDAY4_5) O_WEEKDAY4_5,
       SUM(O_WEEKDAY5_1) O_WEEKDAY5_1, SUM(O_WEEKDAY5_2) O_WEEKDAY5_2, SUM(O_WEEKDAY5_3) O_WEEKDAY5_3, SUM(O_WEEKDAY5_4) O_WEEKDAY5_4, SUM(O_WEEKDAY5_5) O_WEEKDAY5_5,
       SUM(O_WEEKDAY6_1) O_WEEKDAY6_1, SUM(O_WEEKDAY6_2) O_WEEKDAY6_2, SUM(O_WEEKDAY6_3) O_WEEKDAY6_3, SUM(O_WEEKDAY6_4) O_WEEKDAY6_4, SUM(O_WEEKDAY6_5) O_WEEKDAY6_5,
       SUM(O_WEEKDAY7_1) O_WEEKDAY7_1, SUM(O_WEEKDAY7_2) O_WEEKDAY7_2, SUM(O_WEEKDAY7_3) O_WEEKDAY7_3, SUM(O_WEEKDAY7_4) O_WEEKDAY7_4, SUM(O_WEEKDAY7_5) O_WEEKDAY7_5,
        SUM(O_WEEKDAY8_1) O_WEEKDAY8_1, SUM(O_WEEKDAY8_2) O_WEEKDAY8_2, SUM(O_WEEKDAY8_3) O_WEEKDAY8_3, SUM(O_WEEKDAY8_4) O_WEEKDAY8_4, SUM(O_WEEKDAY8_5) O_WEEKDAY8_5,
       SUM(O_WEEKDAY9_1) O_WEEKDAY9_1, SUM(O_WEEKDAY9_2) O_WEEKDAY9_2, SUM(O_WEEKDAY9_3) O_WEEKDAY9_3, SUM(O_WEEKDAY9_4) O_WEEKDAY9_4, SUM(O_WEEKDAY9_5) O_WEEKDAY9_5,
        SUM(O_WEEKDAY10_1) O_WEEKDAY10_1, SUM(O_WEEKDAY10_2)O_WEEKDAY10_2, SUM(O_WEEKDAY10_3) O_WEEKDAY10_3, SUM(O_WEEKDAY10_4) O_WEEKDAY10_4, SUM(O_WEEKDAY10_5) O_WEEKDAY10_5,
        SUM(O_WEEKDAY11_1) O_WEEKDAY11_1, SUM(O_WEEKDAY11_2) O_WEEKDAY11_2, SUM(O_WEEKDAY11_3) O_WEEKDAY11_3, SUM(O_WEEKDAY11_4) O_WEEKDAY11_4, SUM(O_WEEKDAY11_5) O_WEEKDAY11_5,
        SUM(O_WEEKDAY12_1) O_WEEKDAY12_1, SUM(O_WEEKDAY12_2) O_WEEKDAY12_2, SUM(O_WEEKDAY12_3) O_WEEKDAY12_3, SUM(O_WEEKDAY12_4) O_WEEKDAY12_4, SUM(O_WEEKDAY12_5) O_WEEKDAY12_5
    From
     (
                         SELECT  ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY1_1,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY1_2,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY1_3,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY1_4,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY1_5,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY2_1,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY2_2,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY2_3,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY2_4,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY2_5,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY3_1,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY3_2,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY3_3,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY3_4,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY3_5,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY4_1,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY4_2,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY4_3,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY4_4,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY4_5,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY5_1,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY5_2,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY5_3,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY5_4,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY5_5,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY6_1,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY6_2,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY6_3,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY6_4,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY6_5,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY7_1,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY7_2,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY7_3,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY7_4,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY7_5,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY8_1,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY8_2,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY8_3,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY8_4,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY8_5,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY9_1,
                                 ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY9_2,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY9_3,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY9_4,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY9_5,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY10_1,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY10_2,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY10_3,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY10_4,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY10_5,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY11_1,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY11_2,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY11_3,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY11_4,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY11_5,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 1 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY12_1,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 2 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY12_2,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 3 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY12_3,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 4 THEN ORDER_O ELSE 0 END),0) O_WEEKDAY12_4,
                                ISNULL(SUM(CASE WHEN ORDER_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN ORDER_O ELSE 0 END),0) O_WEEKDAY12_5
                   From
       (
           SELECT SUM(ORDER_O) ORDER_O, ORDER_DATE1, WEEK_DAY
           From
           (
                           SELECT CASE WHEN CONTROL_STATUS = '9' THEN ISNULL(SUM(INSTOCK_Q * ORDER_P),0)  ELSE ISNULL(SUM(ORDER_O),0) END ORDER_O,
                   (convert(int, DATENAME (ww, ORDER_DATE)) -  convert(int, DATENAME (ww ,   substring(convert(char, ORDER_DATE,112),1,6) +'01'  )) + 1) WEEK_DAY,
                   SUBSTRING(CONVERT(VARCHAR(30), ORDER_DATE, 112),3,4) ORDER_DATE1
                         FROM MPO100T A, MPO200T B
                         Where A.ORDER_NUM = B.ORDER_NUM
                         AND A.COMP_CODE = B.COMP_CODE
                         AND A.COMP_CODE = #{S_COMP_CODE}
                         GROUP BY ORDER_DATE, CONTROL_STATUS
           )AA
           GROUP BY ORDER_DATE1, WEEK_DAY
      )AA
      GROUP BY ORDER_DATE1
   )BBB
  )ZZ
  )ZZZ
  Union All
  SELECT DIV_CODE, CASE WHEN WORKSHOP = 'A' THEN '1.전기' WHEN WORKSHOP = 'B' THEN '2.등기구' WHEN WORKSHOP = 'C' THEN '3.판금' WHEN WORKSHOP = 'D' THEN '4.TR' WHEN WORKSHOP = 'E' THEN '5.가공' Else '6.기타' END AS WORKSHOP,
                    ITEM_CODE ITEM, SPEC AS ITEM_NAME,  GUBUN,
               CONVERT(VARCHAR(20), ISNULL((SELECT SUM(GOOD_STOCK_Q) FROM BIV100T WHERE ITEM_CODE = TT.ITEM_CODE GROUP BY ITEM_CODE),0)) AS ITEM_CODE,
               SUM((WK_PLAN_Q1 + WK_PLAN_Q2 + WK_PLAN_Q3 + WK_PLAN_Q4 + WK_PLAN_Q5 + WK_PLAN_Q6 +  WK_PLAN_Q7 + WK_PLAN_Q8 + WK_PLAN_Q8 + WK_PLAN_Q10 + WK_PLAN_Q11 + WK_PLAN_Q12)) AS T_WK_PLAN_Q,
               SUM((WK_PLAN_A1 + WK_PLAN_A2 + WK_PLAN_A3 + WK_PLAN_A4 + WK_PLAN_A5 + WK_PLAN_A6 + WK_PLAN_A7 + WK_PLAN_A8 + WK_PLAN_A9 + WK_PLAN_A10 + WK_PLAN_A11 + WK_PLAN_A12))  AS T_WK_PLAN_A,
               SUM((PL_A1 + PL_A2 +PL_A3 +PL_A4 +PL_A5 +PL_A6 +PL_A7 +PL_A8 +PL_A9 +PL_A10 +PL_A11 +PL_A12)) AS T_PL_A,SUM((PRICE_A1 + PRICE_A2 + PRICE_A3 + PRICE_A4 + PRICE_A5 + PRICE_A6 + PRICE_A7 + PRICE_A8 + PRICE_A9 + PRICE_A10 + PRICE_A11 + PRICE_A12)) AS T_PRICE_A,
            SUM(WK_PLAN_Q1), SUM(WK_PLAN_A1), SUM(PL_A1), SUM(PRICE_A1),
            SUM(WK_PLAN_Q2), SUM(WK_PLAN_A2),  SUM(PL_A2), SUM(PRICE_A2),
            SUM(WK_PLAN_Q3),  SUM(WK_PLAN_A3), SUM(PL_A3), SUM(PRICE_A3),
            SUM(WK_PLAN_Q4), SUM(WK_PLAN_A4), SUM(PL_A4), SUM(PRICE_A4),
            SUM(WK_PLAN_Q5), SUM(WK_PLAN_A5),  SUM(PL_A5), SUM(PRICE_A5),
            SUM(WK_PLAN_Q6),  SUM(WK_PLAN_A6), SUM(PL_A6), SUM(PRICE_A6),
            SUM(WK_PLAN_Q7), SUM(WK_PLAN_A7), SUM(PL_A7), SUM(PRICE_A7),
            SUM(WK_PLAN_Q8), SUM(WK_PLAN_A8),  SUM(PL_A8), SUM(PRICE_A8),
            SUM(WK_PLAN_Q9),  SUM(WK_PLAN_A9), SUM(PL_A9), SUM(PRICE_A9),
            SUM(WK_PLAN_Q10), SUM(WK_PLAN_A10), SUM(PL_A10), SUM(PRICE_A10),
            SUM(WK_PLAN_Q11), SUM(WK_PLAN_A11),  SUM(PL_A11), SUM(PRICE_A11),
            SUM(WK_PLAN_Q12),  SUM(WK_PLAN_A12), SUM(PL_A12), SUM(PRICE_A12),
               SUM(I_FORWARD1) I_FORWARD1, SUM(I_WEEKDAY1_1) I_WEEKDAY1_1, SUM(I_WEEKDAY1_2) I_WEEKDAY1_2, SUM(I_WEEKDAY1_3) I_WEEKDAY1_3, SUM(I_WEEKDAY1_4) I_WEEKDAY1_4, SUM(I_WEEKDAY1_5) I_WEEKDAY1_5,
               SUM(I_FORWARD2) I_FORWARD2, SUM(I_WEEKDAY2_1) I_WEEKDAY2_1, SUM(I_WEEKDAY2_2) I_WEEKDAY2_2, SUM(I_WEEKDAY2_3) I_WEEKDAY2_3, SUM(I_WEEKDAY2_4) I_WEEKDAY2_4, SUM(I_WEEKDAY2_5) I_WEEKDAY2_5,
               SUM(I_FORWARD3) I_FORWARD3, SUM(I_WEEKDAY3_1) I_WEEKDAY3_1, SUM(I_WEEKDAY3_2) I_WEEKDAY3_2, SUM(I_WEEKDAY3_3) I_WEEKDAY3_3, SUM(I_WEEKDAY3_4) I_WEEKDAY3_4, SUM(I_WEEKDAY3_5) I_WEEKDAY3_5,
               SUM(I_FORWARD4) I_FORWARD4, SUM(I_WEEKDAY4_1) I_WEEKDAY4_1, SUM(I_WEEKDAY4_2) I_WEEKDAY4_2, SUM(I_WEEKDAY4_3) I_WEEKDAY4_3, SUM(I_WEEKDAY4_4) I_WEEKDAY4_4, SUM(I_WEEKDAY4_5) I_WEEKDAY4_5,
               SUM(I_FORWARD5) I_FORWARD5, SUM(I_WEEKDAY5_1) I_WEEKDAY5_1, SUM(I_WEEKDAY5_2) I_WEEKDAY5_2, SUM(I_WEEKDAY5_3) I_WEEKDAY5_3, SUM(I_WEEKDAY5_4) I_WEEKDAY5_4, SUM(I_WEEKDAY5_5) I_WEEKDAY5_5,
               SUM(I_FORWARD6) I_FORWARD6, SUM(I_WEEKDAY6_1) I_WEEKDAY6_1, SUM(I_WEEKDAY6_2) I_WEEKDAY6_2, SUM(I_WEEKDAY6_3) I_WEEKDAY6_3, SUM(I_WEEKDAY6_4) I_WEEKDAY6_4, SUM(I_WEEKDAY6_5) I_WEEKDAY6_5,
               SUM(I_FORWARD7) I_FORWARD7, SUM(I_WEEKDAY7_1) I_WEEKDAY7_1, SUM(I_WEEKDAY7_2) I_WEEKDAY7_2, SUM(I_WEEKDAY7_3) I_WEEKDAY7_3, SUM(I_WEEKDAY7_4) I_WEEKDAY7_4, SUM(I_WEEKDAY7_5) I_WEEKDAY7_5,
               SUM(I_FORWARD8) I_FORWARD8, SUM(I_WEEKDAY8_1) I_WEEKDAY8_1, SUM(I_WEEKDAY8_2) I_WEEKDAY8_2, SUM(I_WEEKDAY8_3) I_WEEKDAY8_3, SUM(I_WEEKDAY8_4) I_WEEKDAY8_4, SUM(I_WEEKDAY8_5) I_WEEKDAY8_5,
               SUM(I_FORWARD9) I_FORWARD9, SUM(I_WEEKDAY9_1) I_WEEKDAY9_1, SUM(I_WEEKDAY9_2) I_WEEKDAY9_2, SUM(I_WEEKDAY9_3) I_WEEKDAY9_3, SUM(I_WEEKDAY9_4) I_WEEKDAY9_4, SUM(I_WEEKDAY9_5) I_WEEKDAY9_5,
               SUM(I_FORWARD10) I_FORWARD10, SUM(I_WEEKDAY10_1) I_WEEKDAY10_1, SUM(I_WEEKDAY10_2) I_WEEKDAY10_2, SUM(I_WEEKDAY10_3) I_WEEKDAY10_3, SUM(I_WEEKDAY10_4) I_WEEKDAY10_4, SUM(I_WEEKDAY10_5) I_WEEKDAY10_5,
               SUM(I_FORWARD11) I_FORWARD11, SUM(I_WEEKDAY11_1) I_WEEKDAY11_1, SUM(I_WEEKDAY11_2) I_WEEKDAY11_2, SUM(I_WEEKDAY11_3) I_WEEKDAY11_3, SUM(I_WEEKDAY11_4) I_WEEKDAY11_4, SUM(I_WEEKDAY11_5) I_WEEKDAY11_5,
               SUM(I_FORWARD12) I_FORWARD12, SUM(I_WEEKDAY12_1) I_WEEKDAY12_1, SUM(I_WEEKDAY12_2) I_WEEKDAY12_2, SUM(I_WEEKDAY12_3) I_WEEKDAY12_3, SUM(I_WEEKDAY12_4) I_WEEKDAY12_4, SUM(I_WEEKDAY12_5) I_WEEKDAY12_5,
    SUM(CI_FORWARD1) CI_FORWARD1, SUM(CI_WEEKDAY1_1) CI_WEEKDAY1_1, SUM(CI_WEEKDAY1_2) CI_WEEKDAY1_2, SUM(CI_WEEKDAY1_3) CI_WEEKDAY1_3, SUM(CI_WEEKDAY1_4) CI_WEEKDAY1_4, SUM(CI_WEEKDAY1_5) CI_WEEKDAY1_5,
                SUM(CI_FORWARD2) CI_FORWARD2, SUM(CI_WEEKDAY2_1) CI_WEEKDAY2_1, SUM(CI_WEEKDAY2_2) CI_WEEKDAY2_2, SUM(CI_WEEKDAY2_3) CI_WEEKDAY2_3, SUM(CI_WEEKDAY2_4) CI_WEEKDAY2_4, SUM(CI_WEEKDAY2_5) CI_WEEKDAY2_5,
                SUM(CI_FORWARD3) CI_FORWARD3, SUM(CI_WEEKDAY3_1) CI_WEEKDAY3_1, SUM(CI_WEEKDAY3_2) CI_WEEKDAY3_2, SUM(CI_WEEKDAY3_3) CI_WEEKDAY3_3, SUM(CI_WEEKDAY3_4) CI_WEEKDAY3_4, SUM(CI_WEEKDAY3_5) CI_WEEKDAY3_5,
                SUM(CI_FORWARD4) CI_FORWARD4, SUM(CI_WEEKDAY4_1) CI_WEEKDAY4_1, SUM(CI_WEEKDAY4_2) CI_WEEKDAY4_2, SUM(CI_WEEKDAY4_3) CI_WEEKDAY4_3, SUM(CI_WEEKDAY4_4) CI_WEEKDAY4_4, SUM(CI_WEEKDAY4_5) CI_WEEKDAY4_5,
                SUM(CI_FORWARD5) CI_FORWARD5, SUM(CI_WEEKDAY5_1) CI_WEEKDAY5_1, SUM(CI_WEEKDAY5_2) CI_WEEKDAY5_2, SUM(CI_WEEKDAY5_3) CI_WEEKDAY5_3, SUM(CI_WEEKDAY5_4) CI_WEEKDAY5_4, SUM(CI_WEEKDAY5_5) CI_WEEKDAY5_5,
                SUM(CI_FORWARD6) CI_FORWARD6, SUM(CI_WEEKDAY6_1) CI_WEEKDAY6_1, SUM(CI_WEEKDAY6_2) CI_WEEKDAY6_2, SUM(CI_WEEKDAY6_3) CI_WEEKDAY6_3, SUM(CI_WEEKDAY6_4) CI_WEEKDAY6_4, SUM(CI_WEEKDAY6_5) CI_WEEKDAY6_5,
                SUM(CI_FORWARD7) CI_FORWARD7, SUM(CI_WEEKDAY7_1) CI_WEEKDAY7_1, SUM(CI_WEEKDAY7_2) CI_WEEKDAY7_2, SUM(CI_WEEKDAY7_3) CI_WEEKDAY7_3, SUM(CI_WEEKDAY7_4) CI_WEEKDAY7_4, SUM(CI_WEEKDAY7_5) CI_WEEKDAY7_5,
                SUM(CI_FORWARD8) CI_FORWARD8, SUM(CI_WEEKDAY8_1) CI_WEEKDAY8_1, SUM(CI_WEEKDAY8_2) CI_WEEKDAY8_2, SUM(CI_WEEKDAY8_3) CI_WEEKDAY8_3, SUM(CI_WEEKDAY8_4) CI_WEEKDAY8_4, SUM(CI_WEEKDAY8_5) CI_WEEKDAY8_5,
                SUM(CI_FORWARD9) CI_FORWARD9, SUM(CI_WEEKDAY9_1) CI_WEEKDAY9_1, SUM(CI_WEEKDAY9_2) CI_WEEKDAY9_2, SUM(CI_WEEKDAY9_3) CI_WEEKDAY9_3, SUM(CI_WEEKDAY9_4) CI_WEEKDAY9_4, SUM(CI_WEEKDAY9_5) CI_WEEKDAY9_5,
                SUM(CI_FORWARD10) CI_FORWARD10, SUM(CI_WEEKDAY10_1) CI_WEEKDAY10_1, SUM(CI_WEEKDAY10_2) CI_WEEKDAY10_2, SUM(CI_WEEKDAY10_3) CI_WEEKDAY10_3, SUM(CI_WEEKDAY10_4) CI_WEEKDAY10_4, SUM(CI_WEEKDAY10_5) CI_WEEKDAY10_5,
                SUM(CI_FORWARD11) CI_FORWARD11, SUM(CI_WEEKDAY11_1) CI_WEEKDAY11_1, SUM(CI_WEEKDAY11_2) CI_WEEKDAY11_2, SUM(CI_WEEKDAY11_3) CI_WEEKDAY11_3, SUM(CI_WEEKDAY11_4) CI_WEEKDAY11_4, SUM(CI_WEEKDAY11_5) CI_WEEKDAY11_5,
                SUM(CI_FORWARD12) CI_FORWARD12, SUM(CI_WEEKDAY12_1) CI_WEEKDAY12_1, SUM(CI_WEEKDAY12_2) CI_WEEKDAY12_2, SUM(CI_WEEKDAY12_3) CI_WEEKDAY12_3, SUM(CI_WEEKDAY12_4) CI_WEEKDAY12_4, SUM(CI_WEEKDAY12_5) CI_WEEKDAY12_5,
   0 O_WEEKDAY1_1, 0 O_WEEKDAY1_2, 0 O_WEEKDAY1_3, 0 O_WEEKDAY1_4, 0 O_WEEKDAY1_5,
             0 O_WEEKDAY2_1, 0 O_WEEKDAY2_2, 0 O_WEEKDAY2_3, 0 O_WEEKDAY2_4, 0 O_WEEKDAY2_5,
             0 O_WEEKDAY3_1, 0 O_WEEKDAY3_2, 0 O_WEEKDAY3_3, 0 O_WEEKDAY3_4, 0 O_WEEKDAY3_5,
            0 O_WEEKDAY4_1, 0 O_WEEKDAY4_2, 0 O_WEEKDAY4_3, 0 O_WEEKDAY4_4, 0 O_WEEKDAY4_5,
            0 O_WEEKDAY5_1, 0 O_WEEKDAY5_2, 0 O_WEEKDAY5_3, 0 O_WEEKDAY5_4, 0 O_WEEKDAY5_5,
            0 O_WEEKDAY6_1, 0 O_WEEKDAY6_2, 0 O_WEEKDAY6_3, 0 O_WEEKDAY6_4, 0 O_WEEKDAY6_5,
            0 O_WEEKDAY7_1, 0 O_WEEKDAY7_2, 0 O_WEEKDAY7_3, 0 O_WEEKDAY7_4, 0 O_WEEKDAY7_5,
            0 O_WEEKDAY8_1, 0 O_WEEKDAY8_2, 0 O_WEEKDAY8_3, 0 O_WEEKDAY8_4, 0 O_WEEKDAY8_5,
            0 O_WEEKDAY9_1, 0 O_WEEKDAY9_2, 0 O_WEEKDAY9_3, 0 O_WEEKDAY9_4, 0 O_WEEKDAY9_5,
            0 O_WEEKDAY10_1, 0 O_WEEKDAY10_2, 0 O_WEEKDAY10_3, 0 O_WEEKDAY10_4, 0 O_WEEKDAY10_5,
            0 O_WEEKDAY11_1, 0 O_WEEKDAY11_2, 0 O_WEEKDAY11_3, 0 O_WEEKDAY11_4, 0 O_WEEKDAY11_5,
            0 O_WEEKDAY12_1, 0 O_WEEKDAY12_2, 0 O_WEEKDAY12_3, 0 O_WEEKDAY12_4, 0 O_WEEKDAY12_5
  From
   (
   SELECT  ISNULL((SELECT ITEM_MAKER_PN FROM BPR100T WHERE ITEM_CODE = A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE}),'') WORKSHOP,
			A.DIV_CODE, A.ITEM_CODE, ITEM_NAME, C.SPEC,
                       (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
                 ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'01' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q1,
                 ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'02' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q2,
                 ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'03' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q3,
                 ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'04' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q4,
                 ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'05' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q5,
                ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'06' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q6,
                ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'07' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q7,
                ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'08' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q8,
                ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'09' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q9,
                ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'10' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q10,
                ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'11' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q11,
                ISNULL(SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'12' THEN B.PRODT_Q ELSE 0 END),0) WK_PLAN_Q12,
                      ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'01' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A1,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'02' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A2,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'03' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A3,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'04' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A4,
                    ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'05' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A5,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'06' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A6,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'07' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A7,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'08' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A8,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'09' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A9,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'10' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A10,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'11' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A11,
                     ((SUM(CASE WHEN SubString(B.PRODT_DATE, 3, 4) =  RIGHT(#{FR_DATE},2)+'12' THEN B.PRODT_Q ELSE 0 END) * (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE})) * 1.6) AS WK_PLAN_A12,
                     0 PL_A1,  0 PL_A2,  0 PL_A3,  0 PL_A4,  0 PL_A5,  0 PL_A6,  0 PL_A7,  0 PL_A8,  0 PL_A9,  0 PL_A10,   0 PL_A11,  0 PL_A12,
                     0 PRICE_A1,  0 PRICE_A2, 0 PRICE_A3, 0 PRICE_A4, 0 PRICE_A5, 0 PRICE_A6, 0 PRICE_A7, 0 PRICE_A8, 0 PRICE_A9, 0 PRICE_A10, 0 PRICE_A11, 0 PRICE_A12,
                     0 I_FORWARD1, 0 I_WEEKDAY1_1, 0 I_WEEKDAY1_2, 0 I_WEEKDAY1_3, 0 I_WEEKDAY1_4,  0 I_WEEKDAY1_5,
                     0 I_FORWARD2, 0 I_WEEKDAY2_1, 0 I_WEEKDAY2_2, 0 I_WEEKDAY2_3, 0 I_WEEKDAY2_4,  0 I_WEEKDAY2_5,
                     0 I_FORWARD3, 0 I_WEEKDAY3_1, 0 I_WEEKDAY3_2, 0 I_WEEKDAY3_3, 0 I_WEEKDAY3_4,  0 I_WEEKDAY3_5,
                     0 I_FORWARD4, 0 I_WEEKDAY4_1, 0 I_WEEKDAY4_2, 0 I_WEEKDAY4_3, 0 I_WEEKDAY4_4,  0 I_WEEKDAY4_5,
                     0 I_FORWARD5, 0 I_WEEKDAY5_1, 0 I_WEEKDAY5_2, 0 I_WEEKDAY5_3, 0 I_WEEKDAY5_4,  0 I_WEEKDAY5_5,
                     0 I_FORWARD6, 0 I_WEEKDAY6_1, 0 I_WEEKDAY6_2, 0 I_WEEKDAY6_3, 0 I_WEEKDAY6_4,  0 I_WEEKDAY6_5,
                     0 I_FORWARD7, 0 I_WEEKDAY7_1, 0 I_WEEKDAY7_2, 0 I_WEEKDAY7_3, 0 I_WEEKDAY7_4,  0 I_WEEKDAY7_5,
                     0 I_FORWARD8, 0 I_WEEKDAY8_1, 0 I_WEEKDAY8_2, 0 I_WEEKDAY8_3, 0 I_WEEKDAY8_4,  0 I_WEEKDAY8_5,
                     0 I_FORWARD9, 0 I_WEEKDAY9_1, 0 I_WEEKDAY9_2, 0 I_WEEKDAY9_3, 0 I_WEEKDAY9_4,  0 I_WEEKDAY9_5,
                     0 I_FORWARD10, 0 I_WEEKDAY10_1, 0 I_WEEKDAY10_2, 0 I_WEEKDAY10_3, 0 I_WEEKDAY10_4,  0 I_WEEKDAY10_5,
                     0 I_FORWARD11, 0 I_WEEKDAY11_1, 0 I_WEEKDAY11_2, 0 I_WEEKDAY11_3, 0 I_WEEKDAY11_4,  0 I_WEEKDAY11_5,
                     0 I_FORWARD12, 0 I_WEEKDAY12_1, 0 I_WEEKDAY12_2, 0 I_WEEKDAY12_3, 0 I_WEEKDAY12_4,  0 I_WEEKDAY12_5,
					 0 CI_FORWARD1, 0 CI_WEEKDAY1_1, 0 CI_WEEKDAY1_2, 0 CI_WEEKDAY1_3, 0 CI_WEEKDAY1_4,  0 CI_WEEKDAY1_5,
                     0 CI_FORWARD2, 0 CI_WEEKDAY2_1, 0 CI_WEEKDAY2_2, 0 CI_WEEKDAY2_3, 0 CI_WEEKDAY2_4,  0 CI_WEEKDAY2_5,
                     0 CI_FORWARD3, 0 CI_WEEKDAY3_1, 0 CI_WEEKDAY3_2, 0 CI_WEEKDAY3_3, 0 CI_WEEKDAY3_4,  0 CI_WEEKDAY3_5,
                     0 CI_FORWARD4, 0 CI_WEEKDAY4_1, 0 CI_WEEKDAY4_2, 0 CI_WEEKDAY4_3, 0 CI_WEEKDAY4_4,  0 CI_WEEKDAY4_5,
                     0 CI_FORWARD5, 0 CI_WEEKDAY5_1, 0 CI_WEEKDAY5_2, 0 CI_WEEKDAY5_3, 0 CI_WEEKDAY5_4,  0 CI_WEEKDAY5_5,
                     0 CI_FORWARD6, 0 CI_WEEKDAY6_1, 0 CI_WEEKDAY6_2, 0 CI_WEEKDAY6_3, 0 CI_WEEKDAY6_4,  0 CI_WEEKDAY6_5,
                     0 CI_FORWARD7, 0 CI_WEEKDAY7_1, 0 CI_WEEKDAY7_2, 0 CI_WEEKDAY7_3, 0 CI_WEEKDAY7_4,  0 CI_WEEKDAY7_5,
                     0 CI_FORWARD8, 0 CI_WEEKDAY8_1, 0 CI_WEEKDAY8_2, 0 CI_WEEKDAY8_3, 0 CI_WEEKDAY8_4,  0 CI_WEEKDAY8_5,
                     0 CI_FORWARD9, 0 CI_WEEKDAY9_1, 0 CI_WEEKDAY9_2, 0 CI_WEEKDAY9_3, 0 CI_WEEKDAY9_4,  0 CI_WEEKDAY9_5,
                     0 CI_FORWARD10, 0 CI_WEEKDAY10_1, 0 CI_WEEKDAY10_2, 0 CI_WEEKDAY10_3, 0 CI_WEEKDAY10_4,  0 CI_WEEKDAY10_5,
                     0 CI_FORWARD11, 0 CI_WEEKDAY11_1, 0 CI_WEEKDAY11_2, 0 CI_WEEKDAY11_3, 0 CI_WEEKDAY11_4,  0 CI_WEEKDAY11_5,
                     0 CI_FORWARD12, 0 CI_WEEKDAY12_1, 0 CI_WEEKDAY12_2, 0 CI_WEEKDAY12_3, 0 CI_WEEKDAY12_4,  0 CI_WEEKDAY12_5
             From
             (
                 SELECT  DISTINCT COMP_CODE,DIV_CODE, ITEM_CODE, WORK_SHOP_CODE, PROJECT_NO FROM PPL100T WHERE DIV_CODE = #{DIV_CODE} AND COMP_CODE = #{S_COMP_CODE}
                         AND   SUBSTRING(PRODT_PLAN_DATE,1,4) =  #{FR_DATE}
                 ) A, PMR110T B, BPR100T C
             Where A.DIV_CODE = B.DIV_CODE And A.WORK_SHOP_CODE = B.WORK_SHOP_CODE
            AND    A.ITEM_CODE = B.ITEM_CODE AND    A.ITEM_CODE = C.ITEM_CODE  AND    A.DIV_CODE = #{DIV_CODE}
            AND A.COMP_CODE = B.COMP_CODE
            AND A.COMP_CODE = C.COMP_CODE
            AND A.COMP_CODE = #{S_COMP_CODE}
             GROUP BY A.DIV_CODE, A.ITEM_CODE, A.WORK_SHOP_CODE, C.STOCK_UNIT, C.SPEC, C.ITEM_NAME
     Union All
    SELECT  ISNULL((SELECT ITEM_MAKER_PN FROM BPR100T WHERE ITEM_CODE = CC.ITEM_CODE AND COMP_CODE = #{S_COMP_CODE}),'') WORKSHOP,
        DIV_CODE, ITEM_CODE, ITEM_NAME, SPEC,   GUBUN,
                        WK_PLAN_Q1,  WK_PLAN_Q2,   WK_PLAN_Q3,   WK_PLAN_Q4,   WK_PLAN_Q5,  WK_PLAN_Q6,   WK_PLAN_Q7,   WK_PLAN_Q8,   WK_PLAN_Q9,   WK_PLAN_Q10,   WK_PLAN_Q11,  WK_PLAN_Q12,
                        WK_PLAN_A1,  WK_PLAN_A2, WK_PLAN_A3,  WK_PLAN_A4,  WK_PLAN_A5,  WK_PLAN_A6,   WK_PLAN_A7,  WK_PLAN_A8,  WK_PLAN_A9,  WK_PLAN_A10,  WK_PLAN_A11,  WK_PLAN_A12,
                        PL_A1, PL_A2, PL_A3, PL_A4, PL_A5, PL_A6, PL_A7, PL_A8, PL_A9, PL_A10, PL_A11, PL_A12,
                        PRICE_A1, PRICE_A2, PRICE_A3, PRICE_A4, PRICE_A5, PRICE_A6, PRICE_A7, PRICE_A8, PRICE_A9, PRICE_A10, PRICE_A11, PRICE_A12,
                        I_FORWARD1, I_WEEKDAY1_1, I_WEEKDAY1_2, I_WEEKDAY1_3, I_WEEKDAY1_4, I_WEEKDAY1_5,
                        I_FORWARD2, I_WEEKDAY2_1, I_WEEKDAY2_2, I_WEEKDAY2_3, I_WEEKDAY2_4, I_WEEKDAY2_5,
                        I_FORWARD3, I_WEEKDAY3_1, I_WEEKDAY3_2, I_WEEKDAY3_3, I_WEEKDAY3_4, I_WEEKDAY3_5,
                        I_FORWARD4, I_WEEKDAY4_1, I_WEEKDAY4_2, I_WEEKDAY4_3, I_WEEKDAY4_4, I_WEEKDAY4_5,
                        I_FORWARD5, I_WEEKDAY5_1, I_WEEKDAY5_2, I_WEEKDAY5_3, I_WEEKDAY5_4, I_WEEKDAY5_5,
                        I_FORWARD6, I_WEEKDAY6_1, I_WEEKDAY6_2, I_WEEKDAY6_3, I_WEEKDAY6_4, I_WEEKDAY6_5,
                        I_FORWARD7, I_WEEKDAY7_1, I_WEEKDAY7_2 ,I_WEEKDAY7_3, I_WEEKDAY7_4, I_WEEKDAY7_5,
                        I_FORWARD8, I_WEEKDAY8_1, I_WEEKDAY8_2, I_WEEKDAY8_3, I_WEEKDAY8_4, I_WEEKDAY8_5,
                        I_FORWARD9, I_WEEKDAY9_1, I_WEEKDAY9_2, I_WEEKDAY9_3, I_WEEKDAY9_4, I_WEEKDAY9_5,
                        I_FORWARD10, I_WEEKDAY10_1, I_WEEKDAY10_2, I_WEEKDAY10_3, I_WEEKDAY10_4, I_WEEKDAY10_5,
                        I_FORWARD11, I_WEEKDAY11_1, I_WEEKDAY11_2, I_WEEKDAY11_3, I_WEEKDAY11_4, I_WEEKDAY11_5,
                        I_FORWARD12, I_WEEKDAY12_1, I_WEEKDAY12_2, I_WEEKDAY12_3, I_WEEKDAY12_4, I_WEEKDAY12_5,
       CI_FORWARD1, CI_WEEKDAY1_1, CI_WEEKDAY1_2, CI_WEEKDAY1_3, CI_WEEKDAY1_4, CI_WEEKDAY1_5,
                       CI_FORWARD2, CI_WEEKDAY2_1, CI_WEEKDAY2_2, CI_WEEKDAY2_3, CI_WEEKDAY2_4, CI_WEEKDAY2_5,
                       CI_FORWARD3, CI_WEEKDAY3_1, CI_WEEKDAY3_2, CI_WEEKDAY3_3, CI_WEEKDAY3_4, CI_WEEKDAY3_5,
                       CI_FORWARD4, CI_WEEKDAY4_1, CI_WEEKDAY4_2, CI_WEEKDAY4_3, CI_WEEKDAY4_4, CI_WEEKDAY4_5,
                       CI_FORWARD5, CI_WEEKDAY5_1, CI_WEEKDAY5_2, CI_WEEKDAY5_3, CI_WEEKDAY5_4, CI_WEEKDAY5_5,
                      CI_FORWARD6, CI_WEEKDAY6_1, CI_WEEKDAY6_2, CI_WEEKDAY6_3, CI_WEEKDAY6_4, CI_WEEKDAY6_5,
                      CI_FORWARD7, CI_WEEKDAY7_1, CI_WEEKDAY7_2, CI_WEEKDAY7_3, CI_WEEKDAY7_4, CI_WEEKDAY7_5,
                      CI_FORWARD8, CI_WEEKDAY8_1, CI_WEEKDAY8_2, CI_WEEKDAY8_3, CI_WEEKDAY8_4, CI_WEEKDAY8_5,
                      CI_FORWARD9, CI_WEEKDAY9_1, CI_WEEKDAY9_2, CI_WEEKDAY9_3, CI_WEEKDAY9_4, CI_WEEKDAY9_5,
                      CI_FORWARD10, CI_WEEKDAY10_1, CI_WEEKDAY10_2, CI_WEEKDAY10_3, CI_WEEKDAY10_4, CI_WEEKDAY10_5,
                      CI_FORWARD11, CI_WEEKDAY11_1, CI_WEEKDAY11_2, CI_WEEKDAY11_3, CI_WEEKDAY11_4, CI_WEEKDAY11_5,
                      CI_FORWARD12 , CI_WEEKDAY12_1, CI_WEEKDAY12_2, CI_WEEKDAY12_3, CI_WEEKDAY12_4, CI_WEEKDAY12_5
  From
              (
          SELECT  DIV_CODE, ITEM_CODE, ITEM_NAME, SPEC,
                             GUBUN, WK_PLAN_Q1, WK_PLAN_Q2, WK_PLAN_Q3, WK_PLAN_Q4, WK_PLAN_Q5, WK_PLAN_Q6,
                             WK_PLAN_Q7, WK_PLAN_Q8, WK_PLAN_Q9, WK_PLAN_Q10, WK_PLAN_Q11, WK_PLAN_Q12,
                             WK_PLAN_A1, WK_PLAN_A2, WK_PLAN_A3, WK_PLAN_A4, WK_PLAN_A5, WK_PLAN_A6,
                             WK_PLAN_A7, WK_PLAN_A8, WK_PLAN_A9, WK_PLAN_A10, WK_PLAN_A11, WK_PLAN_A12,
                             PL_A1, PL_A2, PL_A3, PL_A4, PL_A5, PL_A6, PL_A7, PL_A8, PL_A9, PL_A10, PL_A11, PL_A12,
                             ISNULL(PRICE_A1,0) PRICE_A1, ISNULL(PRICE_A2,0) PRICE_A2, ISNULL(PRICE_A3,0) PRICE_A3, ISNULL(PRICE_A4,0) PRICE_A4, ISNULL(PRICE_A5,0) PRICE_A5, ISNULL(PRICE_A6,0) PRICE_A6,
                             ISNULL(PRICE_A7,0) PRICE_A7, ISNULL(PRICE_A8,0) PRICE_A8, ISNULL(PRICE_A9,0) PRICE_A9, ISNULL(PRICE_A10,0) PRICE_A10, ISNULL(PRICE_A11,0) PRICE_A11,  ISNULL(PRICE_A12,0) PRICE_A12
                From
            (
                            SELECT  DISTINCT  A.DIV_CODE, A.ITEM_CODE, ITEM_NAME, SPEC,  (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
                                0 WK_PLAN_Q1,  0 WK_PLAN_Q2,  0 WK_PLAN_Q3,  0 WK_PLAN_Q4,  0 WK_PLAN_Q5, 0 WK_PLAN_Q6,  0 WK_PLAN_Q7,  0 WK_PLAN_Q8,  0 WK_PLAN_Q9,  0 WK_PLAN_Q10,  0 WK_PLAN_Q11, 0 WK_PLAN_Q12,
                                0 WK_PLAN_A1, 0 WK_PLAN_A2, 0 WK_PLAN_A3, 0 WK_PLAN_A4, 0 WK_PLAN_A5, 0 WK_PLAN_A6,  0 WK_PLAN_A7, 0 WK_PLAN_A8, 0 WK_PLAN_A9, 0 WK_PLAN_A10, 0 WK_PLAN_A11, 0 WK_PLAN_A12,
                                ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1101' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                            (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A1,
                                ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1102' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                            (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A2,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1103' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A3,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1104' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A4,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1105' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A5,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1106' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A6,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1107' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A7,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1108' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A8,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1109' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A9,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1110' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A10,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1111' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A11,
                               ISNULL(CASE WHEN (SUM(CASE WHEN SubString(A.PRODT_PLAN_DATE, 3, 4) =  '1112' THEN A.WK_PLAN_Q ELSE 0 END)) = 0 THEN 0 ELSE
                                           (SELECT (ISNULL(PL_COST,0) + ISNULL(PL_AMOUNT,0)) FROM BPL100T WHERE  PROD_ITEM_CODE=A.ITEM_CODE) END,0) PL_A12
                       From
                      (
                              SELECT DISTINCT COMP_CODE,DIV_CODE, ITEM_CODE,  WORK_SHOP_CODE, ORDER_NUM, PRODT_Q, PRODT_PLAN_DATE, WK_PLAN_Q
                             FROM PPL100T WHERE DIV_CODE = #{DIV_CODE}
                             AND COMP_CODE = #{S_COMP_CODE}
                             AND  SUBSTRING(PRODT_PLAN_DATE,1,4) =   #{FR_DATE}
                     )A, BPR100T B
                     Where A.ITEM_CODE = B.ITEM_CODE
                     AND A.COMP_CODE = B.COMP_CODE
                     AND A.COMP_CODE = #{S_COMP_CODE}
                     GROUP BY DIV_CODE,  A.ITEM_CODE, ITEM_NAME, SPEC)AA left join 
                (SELECT RECEIPT_TYPE,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'01' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1101'  THEN INOUT_O ELSE 0 END) PRICE_A1,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'02' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1102'  THEN INOUT_O ELSE 0 END) PRICE_A2,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'03' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1103'  THEN INOUT_O ELSE 0 END) PRICE_A3,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'04' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1104'  THEN INOUT_O ELSE 0 END) PRICE_A4,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'05' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1105'  THEN INOUT_O ELSE 0 END) PRICE_A5,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'06' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1106'  THEN INOUT_O ELSE 0 END) PRICE_A6,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'07' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1107'  THEN INOUT_O ELSE 0 END) PRICE_A7,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'08' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1108'  THEN INOUT_O ELSE 0 END) PRICE_A8,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'09' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1109'  THEN INOUT_O ELSE 0 END) PRICE_A9,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'10' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1110'  THEN INOUT_O ELSE 0 END) PRICE_A10,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'11' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1111'  THEN INOUT_O ELSE 0 END) PRICE_A11,
                             SUM(CASE WHEN SUBSTRING(LC_NUM,3,4) = RIGHT(#{FR_DATE},2)+'12' AND SUBSTRING(UPDATE_DB_TIME,3,4) = '1112'  THEN INOUT_O ELSE 0 END) PRICE_A12
                 From
                 (
                            SELECT SUM(A.RECEIPT_Q * ORDER_P) INOUT_O, LC_NUM, RECEIPT_TYPE,  CONVERT(VARCHAR(30), A.RECEIPT_DATE, 112)  UPDATE_DB_TIME
                            FROM QMS100t A, MPO200T B, MPO100T C
                           Where A.ORDER_NUM = B.ORDER_NUM And A.ORDER_NUM = C.ORDER_NUM And B.ORDER_NUM = C.ORDER_NUM
                          And A.ITEM_CODE = B.ITEM_CODE
                          AND  A.COMP_CODE = B.COMP_CODE AND  A.COMP_CODE = C.COMP_CODE
                          AND A.COMP_CODE = #{S_COMP_CODE}
                           GROUP BY LC_NUM, RECEIPT_TYPE, A.RECEIPT_DATE
                 )AA
                 GROUP BY RECEIPT_TYPE
         )BB on AA.ITEM_CODE = BB.RECEIPT_TYPE
     )CC,
     (
         SELECT  ISNULL(SUM(I_FORWARD1),0) I_FORWARD1, ISNULL(SUM(I_WEEKDAY1_1),0) I_WEEKDAY1_1, ISNULL(SUM(I_WEEKDAY1_2),0) I_WEEKDAY1_2, ISNULL(SUM(I_WEEKDAY1_3),0) I_WEEKDAY1_3, ISNULL(SUM(I_WEEKDAY1_4),0) I_WEEKDAY1_4, ISNULL(SUM(I_WEEKDAY1_5),0) I_WEEKDAY1_5,
                         ISNULL(SUM(I_FORWARD2),0) I_FORWARD2, ISNULL(SUM(I_WEEKDAY2_1),0) I_WEEKDAY2_1, ISNULL(SUM(I_WEEKDAY2_2),0) I_WEEKDAY2_2, ISNULL(SUM(I_WEEKDAY2_3),0) I_WEEKDAY2_3, ISNULL(SUM(I_WEEKDAY2_4),0) I_WEEKDAY2_4, ISNULL(SUM(I_WEEKDAY2_5),0) I_WEEKDAY2_5,
                         ISNULL(SUM(I_FORWARD3),0) I_FORWARD3, ISNULL(SUM(I_WEEKDAY3_1),0) I_WEEKDAY3_1, ISNULL(SUM(I_WEEKDAY3_2),0) I_WEEKDAY3_2, ISNULL(SUM(I_WEEKDAY3_3),0) I_WEEKDAY3_3, ISNULL(SUM(I_WEEKDAY3_4),0) I_WEEKDAY3_4, ISNULL(SUM(I_WEEKDAY3_5),0) I_WEEKDAY3_5,
                        ISNULL(SUM(I_FORWARD4),0) I_FORWARD4, ISNULL(SUM(I_WEEKDAY4_1),0) I_WEEKDAY4_1, ISNULL(SUM(I_WEEKDAY4_2),0) I_WEEKDAY4_2, ISNULL(SUM(I_WEEKDAY4_3),0) I_WEEKDAY4_3, ISNULL(SUM(I_WEEKDAY4_4),0) I_WEEKDAY4_4, ISNULL(SUM(I_WEEKDAY4_5),0) I_WEEKDAY4_5,
                    ISNULL(SUM(I_FORWARD5),0) I_FORWARD5, ISNULL(SUM(I_WEEKDAY5_1),0) I_WEEKDAY5_1, ISNULL(SUM(I_WEEKDAY5_2),0) I_WEEKDAY5_2, ISNULL(SUM(I_WEEKDAY5_3),0) I_WEEKDAY5_3, ISNULL(SUM(I_WEEKDAY5_4),0) I_WEEKDAY5_4, ISNULL(SUM(I_WEEKDAY5_5),0) I_WEEKDAY5_5,
                    ISNULL(SUM(I_FORWARD6),0) I_FORWARD6, ISNULL(SUM(I_WEEKDAY6_1),0) I_WEEKDAY6_1, ISNULL(SUM(I_WEEKDAY6_2),0) I_WEEKDAY6_2, ISNULL(SUM(I_WEEKDAY6_3),0) I_WEEKDAY6_3, ISNULL(SUM(I_WEEKDAY6_4),0) I_WEEKDAY6_4, ISNULL(SUM(I_WEEKDAY6_5),0) I_WEEKDAY6_5,
                    ISNULL(SUM(I_FORWARD7),0) I_FORWARD7, ISNULL(SUM(I_WEEKDAY7_1),0) I_WEEKDAY7_1, ISNULL(SUM(I_WEEKDAY7_2),0) I_WEEKDAY7_2, ISNULL(SUM(I_WEEKDAY7_3),0) I_WEEKDAY7_3, ISNULL(SUM(I_WEEKDAY7_4),0) I_WEEKDAY7_4, ISNULL(SUM(I_WEEKDAY7_5),0) I_WEEKDAY7_5,
                    ISNULL(SUM(I_FORWARD8),0) I_FORWARD8, ISNULL(SUM(I_WEEKDAY8_1),0) I_WEEKDAY8_1, ISNULL(SUM(I_WEEKDAY8_2),0) I_WEEKDAY8_2, ISNULL(SUM(I_WEEKDAY8_3),0) I_WEEKDAY8_3, ISNULL(SUM(I_WEEKDAY8_4),0) I_WEEKDAY8_4, ISNULL(SUM(I_WEEKDAY8_5),0) I_WEEKDAY8_5,
                    ISNULL(SUM(I_FORWARD9),0) I_FORWARD9, ISNULL(SUM(I_WEEKDAY9_1),0) I_WEEKDAY9_1, ISNULL(SUM(I_WEEKDAY9_2),0) I_WEEKDAY9_2, ISNULL(SUM(I_WEEKDAY9_3),0) I_WEEKDAY9_3, ISNULL(SUM(I_WEEKDAY9_4),0) I_WEEKDAY9_4, ISNULL(SUM(I_WEEKDAY9_5),0) I_WEEKDAY9_5,
                    ISNULL(SUM(I_FORWARD10),0) I_FORWARD10, ISNULL(SUM(I_WEEKDAY10_1),0) I_WEEKDAY10_1, ISNULL(SUM(I_WEEKDAY10_2),0) I_WEEKDAY10_2, ISNULL(SUM(I_WEEKDAY10_3),0) I_WEEKDAY10_3, ISNULL(SUM(I_WEEKDAY10_4),0) I_WEEKDAY10_4, ISNULL(SUM(I_WEEKDAY10_5),0) I_WEEKDAY10_5,
                    ISNULL(SUM(I_FORWARD11),0) I_FORWARD11, ISNULL(SUM(I_WEEKDAY11_1),0) I_WEEKDAY11_1, ISNULL(SUM(I_WEEKDAY11_2),0) I_WEEKDAY11_2, ISNULL(SUM(I_WEEKDAY11_3),0) I_WEEKDAY11_3, ISNULL(SUM(I_WEEKDAY11_4),0) I_WEEKDAY11_4, ISNULL(SUM(I_WEEKDAY11_5),0) I_WEEKDAY11_5,
                    ISNULL(SUM(I_FORWARD12),0) I_FORWARD12, ISNULL(SUM(I_WEEKDAY12_1),0) I_WEEKDAY12_1, ISNULL(SUM(I_WEEKDAY12_2),0) I_WEEKDAY12_2, ISNULL(SUM(I_WEEKDAY12_3),0) I_WEEKDAY12_3, ISNULL(SUM(I_WEEKDAY12_4),0) I_WEEKDAY12_4, ISNULL(SUM(I_WEEKDAY12_5),0) I_WEEKDAY12_5,
       ISNULL(SUM(CI_FORWARD1),0) CI_FORWARD1, ISNULL(SUM(CI_WEEKDAY1_1),0) CI_WEEKDAY1_1, ISNULL(SUM(CI_WEEKDAY1_2),0) CI_WEEKDAY1_2, ISNULL(SUM(CI_WEEKDAY1_3),0) CI_WEEKDAY1_3, ISNULL(SUM(CI_WEEKDAY1_4),0) CI_WEEKDAY1_4, ISNULL(SUM(CI_WEEKDAY1_5),0) CI_WEEKDAY1_5,
                       ISNULL(SUM(CI_FORWARD2),0) CI_FORWARD2, ISNULL(SUM(CI_WEEKDAY2_1),0) CI_WEEKDAY2_1, ISNULL(SUM(CI_WEEKDAY2_2),0) CI_WEEKDAY2_2, ISNULL(SUM(CI_WEEKDAY2_3),0) CI_WEEKDAY2_3, ISNULL(SUM(CI_WEEKDAY2_4),0) CI_WEEKDAY2_4, ISNULL(SUM(CI_WEEKDAY2_5),0) CI_WEEKDAY2_5,
                       ISNULL(SUM(CI_FORWARD3),0) CI_FORWARD3, ISNULL(SUM(CI_WEEKDAY3_1),0) CI_WEEKDAY3_1, ISNULL(SUM(CI_WEEKDAY3_2),0) CI_WEEKDAY3_2, ISNULL(SUM(CI_WEEKDAY3_3),0) CI_WEEKDAY3_3, ISNULL(SUM(CI_WEEKDAY3_4),0) CI_WEEKDAY3_4, ISNULL(SUM(CI_WEEKDAY3_5),0) CI_WEEKDAY3_5,
                       ISNULL(SUM(CI_FORWARD4),0) CI_FORWARD4, ISNULL(SUM(CI_WEEKDAY4_1),0) CI_WEEKDAY4_1, ISNULL(SUM(CI_WEEKDAY4_2),0) CI_WEEKDAY4_2, ISNULL(SUM(CI_WEEKDAY4_3),0) CI_WEEKDAY4_3, ISNULL(SUM(CI_WEEKDAY4_4),0) CI_WEEKDAY4_4, ISNULL(SUM(CI_WEEKDAY4_5),0) CI_WEEKDAY4_5,
                   ISNULL(SUM(CI_FORWARD5),0) CI_FORWARD5, ISNULL(SUM(CI_WEEKDAY5_1),0) CI_WEEKDAY5_1, ISNULL(SUM(CI_WEEKDAY5_2),0) CI_WEEKDAY5_2, ISNULL(SUM(CI_WEEKDAY5_3),0) CI_WEEKDAY5_3, ISNULL(SUM(CI_WEEKDAY5_4),0) CI_WEEKDAY5_4, ISNULL(SUM(CI_WEEKDAY5_5),0) CI_WEEKDAY5_5,
                   ISNULL(SUM(CI_FORWARD6),0) CI_FORWARD6, ISNULL(SUM(CI_WEEKDAY6_1),0) CI_WEEKDAY6_1, ISNULL(SUM(CI_WEEKDAY6_2),0) CI_WEEKDAY6_2, ISNULL(SUM(CI_WEEKDAY6_3),0) CI_WEEKDAY6_3, ISNULL(SUM(CI_WEEKDAY6_4),0) CI_WEEKDAY6_4, ISNULL(SUM(CI_WEEKDAY6_5),0) CI_WEEKDAY6_5,
                   ISNULL(SUM(CI_FORWARD7),0) CI_FORWARD7, ISNULL(SUM(CI_WEEKDAY7_1),0) CI_WEEKDAY7_1, ISNULL(SUM(CI_WEEKDAY7_2),0) CI_WEEKDAY7_2, ISNULL(SUM(CI_WEEKDAY7_3),0) CI_WEEKDAY7_3, ISNULL(SUM(CI_WEEKDAY7_4),0) CI_WEEKDAY7_4, ISNULL(SUM(CI_WEEKDAY7_5),0) CI_WEEKDAY7_5,
                   ISNULL(SUM(CI_FORWARD8),0) CI_FORWARD8, ISNULL(SUM(CI_WEEKDAY8_1),0) CI_WEEKDAY8_1, ISNULL(SUM(CI_WEEKDAY8_2),0) CI_WEEKDAY8_2, ISNULL(SUM(CI_WEEKDAY8_3),0) CI_WEEKDAY8_3, ISNULL(SUM(CI_WEEKDAY8_4),0) CI_WEEKDAY8_4, ISNULL(SUM(CI_WEEKDAY8_5),0) CI_WEEKDAY8_5,
                   ISNULL(SUM(CI_FORWARD9),0) CI_FORWARD9, ISNULL(SUM(CI_WEEKDAY9_1),0) CI_WEEKDAY9_1, ISNULL(SUM(CI_WEEKDAY9_2),0) CI_WEEKDAY9_2, ISNULL(SUM(CI_WEEKDAY9_3),0) CI_WEEKDAY9_3, ISNULL(SUM(CI_WEEKDAY9_4),0) CI_WEEKDAY9_4, ISNULL(SUM(CI_WEEKDAY9_5),0) CI_WEEKDAY9_5,
                   ISNULL(SUM(CI_FORWARD10),0) CI_FORWARD10, ISNULL(SUM(CI_WEEKDAY10_1),0) CI_WEEKDAY10_1, ISNULL(SUM(CI_WEEKDAY10_2),0) CI_WEEKDAY10_2, ISNULL(SUM(CI_WEEKDAY10_3),0) CI_WEEKDAY10_3, ISNULL(SUM(CI_WEEKDAY10_4),0) CI_WEEKDAY10_4, ISNULL(SUM(CI_WEEKDAY10_5),0) CI_WEEKDAY10_5,
                   ISNULL(SUM(CI_FORWARD11),0) CI_FORWARD11, ISNULL(SUM(CI_WEEKDAY11_1),0) CI_WEEKDAY11_1, ISNULL(SUM(CI_WEEKDAY11_2),0) CI_WEEKDAY11_2, ISNULL(SUM(CI_WEEKDAY11_3),0) CI_WEEKDAY11_3, ISNULL(SUM(CI_WEEKDAY11_4),0) CI_WEEKDAY11_4, ISNULL(SUM(CI_WEEKDAY11_5),0) CI_WEEKDAY11_5,
                   ISNULL(SUM(CI_FORWARD12),0) CI_FORWARD12, ISNULL(SUM(CI_WEEKDAY12_1),0) CI_WEEKDAY12_1, ISNULL(SUM(CI_WEEKDAY12_2),0) CI_WEEKDAY12_2, ISNULL(SUM(CI_WEEKDAY12_3),0) CI_WEEKDAY12_3, ISNULL(SUM(CI_WEEKDAY12_4),0) CI_WEEKDAY12_4, ISNULL(SUM(CI_WEEKDAY12_5),0) CI_WEEKDAY12_5
      From
      (
                  SELECT  WEEK_DAY,  RCV_DATE1,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD1,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY1_1,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY1_2,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY1_3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY1_4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY1_5,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD2,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY2_1,
                            ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY2_2,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY2_3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY2_4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY2_5,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY3_1,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY3_2,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY3_3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY3_4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY3_5,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY4_1,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY4_2,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY4_3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY4_4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY4_5,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD5,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY5_1,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY5_2,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY5_3,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY5_4,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY5_5,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD6,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY6_1,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY6_2,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06'AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY6_3,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY6_4,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY6_5,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD7,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY7_1,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY7_2,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY7_3,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY7_4,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY7_5,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD8,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY8_1,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY8_2,
                              ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY8_3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY8_4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY8_5,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD9,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY9_1,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY9_2,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY9_3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY9_4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY9_5,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD10,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY10_1,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY10_2,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY10_3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY10_4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY10_5,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD11,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY11_1,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY11_2,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY11_3,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY11_4,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY11_5,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 0 THEN INOUT_O ELSE 0 END),0) I_FORWARD12,
                             ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 1 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY12_1,
                            ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 2 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY12_2,
                            ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 3 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY12_3,
                           ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 4 THEN INOUT_O ELSE 0 END),0) I_WEEKDAY12_4,
                           ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) THEN INOUT_O ELSE 0 END),0) I_WEEKDAY12_5,
                          ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD1,
                          ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY1_1,
                          ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY1_2,
                          ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY1_3,
                          ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY1_4,
                          ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'01' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY1_5,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD2,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY2_1,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY2_2,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY2_3,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY2_4,
                   ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'02' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY2_5,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD3,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY3_1,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY3_2,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY3_3,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY3_4,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'03' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY3_5,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD4,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY4_1,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY4_2,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY4_3,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY4_4,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'04' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY4_5,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD5,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY5_1,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY5_2,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY5_3,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY5_4,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'05' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY5_5,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD6,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY6_1,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY6_2,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY6_3,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY6_4,
                       ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'06' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY6_5,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD7,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY7_1,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY7_2,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY7_3,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY7_4,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'07' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY7_5,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD8,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY8_1,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY8_2,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY8_3,
                      ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY8_4,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'08' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY8_5,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD9,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY9_1,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY9_2,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY9_3,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY9_4,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'09' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY9_5,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD10,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY10_1,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY10_2,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY10_3,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY10_4,
                    ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'10' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY10_5,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD11,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY11_1,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY11_2,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY11_3,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY11_4,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'11' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY11_5,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 0 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_FORWARD12,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 1 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY12_1,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 2 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY12_2,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 3 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY12_3,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND WEEK_DAY = 4 AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY12_4,
                     ISNULL(SUM(CASE WHEN RCV_DATE1 = RIGHT(#{FR_DATE},2)+'12' AND (WEEK_DAY = 5 OR WEEK_DAY = 6) AND REMARK = '현금' THEN INOUT_O ELSE 0 END),0) CI_WEEKDAY12_5
             From
             (
                 SELECT  SUM(INOUT_O) INOUT_O,  LC_NUM,
                         (CASE WHEN LC_NUM1 = RCV_DATE1 THEN  WEEK_DAY ELSE 0 END) WEEK_DAY, LC_NUM1,  RCV_DATE1, REMARK
                     From
                     (
                             SELECT  SUM(A.RECEIPT_Q * ORDER_P) INOUT_O, LC_NUM, RECEIPT_TYPE,  CONVERT(VARCHAR(30), A.RECEIPT_DATE, 112)  UPDATE_DB_TIME,
                                         (convert(int, DATENAME (ww, A.RECEIPT_DATE)) -  convert(int, DATENAME (ww ,   substring(convert(char, A.RECEIPT_DATE,112),1,6) +'01'  )) + 1) WEEK_DAY,
                                 SUBSTRING(LC_NUM,3,4) LC_NUM1,
                (CASE WHEN B.REMARK = '현금' THEN (SUM(A.RECEIPT_Q * ORDER_P)) ELSE 0 END) C_INOUT_O,
                                SUBSTRING(CONVERT(VARCHAR(30), A.RECEIPT_DATE, 112),3,4) RCV_DATE1,
            (CASE WHEN B.REMARK = '현금' THEN B.REMARK ELSE '' END ) REMARK
                            FROM QMS100T A, MPO200T B, MPO100T C
                            Where A.ORDER_NUM = B.ORDER_NUM And A.ORDER_NUM = C.ORDER_NUM
                            
                        And B.ORDER_NUM = C.ORDER_NUM And A.ORDER_NUM = B.ORDER_NUM
                        AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE = C.COMP_CODE
                        AND A.COMP_CODE = #{S_COMP_CODE}
                        And A.ITEM_CODE = B.ITEM_CODE 
                            GROUP BY LC_NUM, RECEIPT_TYPE, A.RECEIPT_DATE, B.REMARK
                )AA
                 WHERE SUBSTRING(RCV_DATE1,1,2) = RIGHT(#{FR_DATE},2)+''
                 GROUP BY LC_NUM,  WEEK_DAY, LC_NUM1,  RCV_DATE1, REMARK
    )TT
            GROUP BY WEEK_DAY,  RCV_DATE1
  )ZZ
   )DD
  )TT
  GROUP BY DIV_CODE, ITEM_CODE, ITEM_NAME, SPEC, GUBUN, WORKSHOP
 ORDER BY WORKSHOP, ITEM, GUBUN
   	</select>
</mapper>
