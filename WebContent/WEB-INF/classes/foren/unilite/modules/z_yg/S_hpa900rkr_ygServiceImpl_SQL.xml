<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="s_hpa900rkr_ygServiceImpl">


    
    <update id="s_hpa900rkr_ygServiceImpl.createTable" parameterType="Map">
       --s_hpa900rkr_ygServiceImpl.createTable
       IF EXISTS (SELECT * FROM SYSOBJECTS WHERE ID = OBJECT_ID('HAT200PH_MASTER')) DROP TABLE HAT200PH_MASTER

       IF EXISTS (SELECT * FROM SYSOBJECTS WHERE ID = OBJECT_ID('HPA900PH_MASTER')) DROP TABLE HPA900PH_MASTER

       IF EXISTS (SELECT * FROM SYSOBJECTS WHERE ID = OBJECT_ID('HBO800PH_MASTER')) DROP TABLE HBO800PH_MASTER

         
       --s_hpa900rkr_ygServiceImpl.createTable[fnHpa900PB] Create HAT200PH_MASTER
       CREATE TABLE HAT200PH_MASTER
       (                                                    
           SEQ              NUMERIC(3)      NOT NULL,       
           SUB_CODE         NVARCHAR(50)    NULL,           
           CODE_NAME        NVARCHAR(50)    NULL            
                                                            
           CONSTRAINT Hat200PH_MASTER_IDX00 PRIMARY KEY CLUSTERED  
           (                                                
                   SEQ                                      
           )                                                
       )                                                    
    
       --s_hpa900rkr_ygServiceImpl.createTable[fnHpa900PB] Create HPA900PH_MASTER
       CREATE TABLE HPA900PH_MASTER
       (                                                    
           SEQ              NUMERIC(3)      NOT NULL,       
           SUB_CODE         NVARCHAR(50)    NULL,           
           CODE_NAME        NVARCHAR(50)    NULL            
                                                            
           CONSTRAINT Hpa900PH_MASTER_IDX00 PRIMARY KEY CLUSTERED  
           (                                                
                   SEQ                                      
           )                                                
       )                                                    
    
     --s_hpa900rkr_ygServiceImpl.createTable [fnHpa900PB] Create HBO800PH_MASTER
       CREATE TABLE HBO800PH_MASTER
       (                                                    
           W_SEQ            NUMERIC(3)      NOT NULL,       
           WAGES_CODE       NVARCHAR(50)    NULL,           
           WAGES_NAME       NVARCHAR(50)    NULL,           
           WAGES_SEQ        NUMERIC(2)      NULL            
                                                            
           CONSTRAINT HBO800PH_MASTER_IDX00 PRIMARY KEY CLUSTERED  
           (                                                
                   W_SEQ                                    
           )                                                
       )                                                    

    </update>
    
    
    <select id="s_hpa900rkr_ygServiceImpl.selectWages1" parameterType="Map" resultType="rMap">
        --s_hpa900rkr_ygServiceImpl.selectWages11
        SELECT ROW_NUMBER() OVER(ORDER BY SUB_CODE ASC) AS SEQ 
             , SUB_CODE                
             , CODE_NAME               
          FROM BSA100T                 
         WHERE COMP_CODE = #{S_COMP_CODE}
           AND MAIN_CODE = 'H033'      
           AND USE_YN    = 'Y'         
           AND SUB_CODE != '$'         
         ORDER BY REF_CODE2, SUB_CODE  
                    
    </select>
    
    <update id="s_hpa900rkr_ygServiceImpl.insertWages1" parameterType="Map">
        --s_hpa900rkr_ygServiceImpl.insertWages1 - [HAT200PH_MASTER]
        INSERT INTO HAT200PH_MASTER
                  ( SEQ                                 
                  , SUB_CODE                            
                  , CODE_NAME )                         
        VALUES    ( #{SEQ}                      
                  , #{SUB_CODE}
                  , #{CODE_NAME} )  
                    
    </update>
    
    <select id="s_hpa900rkr_ygServiceImpl.selectWages2" parameterType="Map" resultType="rMap">
        --s_hpa900rkr_ygServiceImpl.selectWages2
        SELECT ROW_NUMBER() OVER(ORDER BY SUB_CODE ASC) AS SEQ
             , B.SUB_CODE AS SUB_CODE                            
             , B.CODE_NAME                                       
          FROM             BSA100T B
                INNER JOIN HPA400T A ON B.COMP_CODE = A.COMP_CODE
                                    AND B.SUB_CODE  = A.DED_CODE  
         WHERE B.COMP_CODE      = #{S_COMP_CODE}
           AND A.PAY_YYYYMM &gt;= #{DATE_FR}
           AND A.PAY_YYYYMM &lt;= #{DATE_TO}
           AND A.SUPP_TYPE      = #{SUPP_TYPE}
           AND B.MAIN_CODE      = N'H034'                              
           AND B.SUB_CODE      != N'$'                                 
         GROUP BY B.SUB_CODE, B.CODE_NAME, REF_CODE2             
         ORDER BY REF_CODE2, SUB_CODE                            
                    
    </select>
    
    <update id="s_hpa900rkr_ygServiceImpl.insertWages2" parameterType="Map">
        --s_hpa900rkr_ygServiceImpl.insertWages2 - [HPA900PH_MASTER]
        INSERT INTO HPA900PH_MASTER
                  ( SEQ                                 
                  , SUB_CODE                            
                  , CODE_NAME)                          
        VALUES    ( #{SEQ}                       
                  , #{SUB_CODE}    
                  , #{CODE_NAME} )  
                    
    </update>
    
    
    <select id="s_hpa900rkr_ygServiceImpl.selectWages3" parameterType="Map" resultType="rMap">
        --s_hpa900rkr_ygServiceImpl.selectWages3
        SELECT ROW_NUMBER() OVER(ORDER BY B.WAGES_CODE ASC) AS W_SEQ
             , B.WAGES_CODE                                                                
             , B.WAGES_NAME                                                                
             , B.WAGES_SEQ                                                                 
          FROM            HBS300T B 
               INNER JOIN HPA300T A ON B.COMP_CODE = A.COMP_CODE
                                   AND B.WAGES_CODE = A.WAGES_CODE                         
         WHERE B.COMP_CODE      = #{S_COMP_CODE}
           AND A.PAY_YYYYMM &gt;= #{DATE_FR}                  
           AND A.PAY_YYYYMM &lt;= #{DATE_TO}
           AND A.SUPP_TYPE      = #{SUPP_TYPE}                                     
           AND B.CODE_TYPE      = '1'                                         
         GROUP BY B.WAGES_CODE,  B.WAGES_NAME,  B.WAGES_SEQ                                
         ORDER BY B.WAGES_SEQ,   B.WAGES_CODE                                              
                    
    </select>
    
    
    <update id="s_hpa900rkr_ygServiceImpl.insertWages3" parameterType="Map">
        --s_hpa900rkr_ygServiceImpl.insertWages3 - [HBO800PH_MASTER]
        INSERT INTO HBO800PH_MASTER
                  ( W_SEQ                                 
                  , WAGES_CODE                            
                  , WAGES_NAME                            
                  , WAGES_SEQ)                            
         VALUES   ( #{W_SEQ}                      
                  , #{WAGES_CODE}
                  , #{WAGES_NAME}
                  , #{WAGES_SEQ} )    
                    
    </update>
    
    
    
    
	<select id="s_hpa900rkr_ygServiceImpl.getCostPoolName" parameterType="Map" resultType="rMap">
		SELECT ISNULL(REF_CODE2, '') AS REF_CODE2
		  FROM BSA100T WITH (NOLOCK)
		 WHERE COMP_CODE	= #{S_COMP_CODE}
		   AND MAIN_CODE	= N'H175'
		   AND SUB_CODE		= N'10'
		   AND REF_CODE1	= N'Y'
	</select>
    
	<select id="s_hpa900rkr_ygServiceImpl.selectSubListPrint5"  parameterType="Map" resultType="rMap">
		--s_hpa900rkr_ygServiceImpl.selectSubListPrint5 [fnHpa900PB] strGubun P                                                        
      SELECT MAX(CASE WHEN B.W_SEQ = 1  THEN B.WAGES_NAME   ELSE '' END) AS '1'         
           , MAX(CASE WHEN B.W_SEQ = 2  THEN B.WAGES_NAME   ELSE '' END) AS '2'         
           , MAX(CASE WHEN B.W_SEQ = 3  THEN B.WAGES_NAME   ELSE '' END) AS '3'         
           , MAX(CASE WHEN B.W_SEQ = 4  THEN B.WAGES_NAME   ELSE '' END) AS '4'         
           , MAX(CASE WHEN B.W_SEQ = 5  THEN B.WAGES_NAME   ELSE '' END) AS '5'         
           , MAX(CASE WHEN B.W_SEQ = 6  THEN B.WAGES_NAME   ELSE '' END) AS '6'         
           , MAX(CASE WHEN B.W_SEQ = 7  THEN B.WAGES_NAME   ELSE '' END) AS '7'         
           , MAX(CASE WHEN B.W_SEQ = 8  THEN B.WAGES_NAME   ELSE '' END) AS '8'         
           , MAX(CASE WHEN B.W_SEQ = 9  THEN B.WAGES_NAME   ELSE '' END) AS '9'         
           , MAX(CASE WHEN B.W_SEQ = 10 THEN B.WAGES_NAME   ELSE '' END) AS '10'        
           , MAX(CASE WHEN B.W_SEQ = 11 THEN B.WAGES_NAME   ELSE '' END) AS '11'        
           , MAX(CASE WHEN B.W_SEQ = 12 THEN B.WAGES_NAME   ELSE '' END) AS '12'        
           , MAX(CASE WHEN B.W_SEQ = 13 THEN B.WAGES_NAME   ELSE '' END) AS '13'        
           , MAX(CASE WHEN B.W_SEQ = 14 THEN B.WAGES_NAME   ELSE '' END) AS '14'        
           , MAX(CASE WHEN B.W_SEQ = 15 THEN B.WAGES_NAME   ELSE '' END) AS '15'        
           , MAX(CASE WHEN B.W_SEQ &gt;= 16                                                
                           THEN 'z' + uniLITE.fnGetTxt('H0042')                         
                           ELSE (CASE WHEN B.W_SEQ = 16 THEN B.WAGES_NAME ELSE '' END)  
                  END) AS '16'                                                          
           , MAX(CASE WHEN A.SEQ = 1    THEN A.CODE_NAME    ELSE '' END) AS '17'        
           , MAX(CASE WHEN A.SEQ = 2    THEN A.CODE_NAME    ELSE '' END) AS '18'        
           , MAX(CASE WHEN A.SEQ = 3    THEN A.CODE_NAME    ELSE '' END) AS '19'        
           , MAX(CASE WHEN A.SEQ = 4    THEN A.CODE_NAME    ELSE '' END) AS '20'        
           , MAX(CASE WHEN A.SEQ = 5    THEN A.CODE_NAME    ELSE '' END) AS '21'        
           , MAX(CASE WHEN A.SEQ = 6    THEN A.CODE_NAME    ELSE '' END) AS '22'        
           , MAX(CASE WHEN A.SEQ = 7    THEN A.CODE_NAME    ELSE '' END) AS '23'        
           , MAX(CASE WHEN A.SEQ = 8    THEN A.CODE_NAME    ELSE '' END) AS '24'        
           , MAX(CASE WHEN A.SEQ = 9    THEN A.CODE_NAME    ELSE '' END) AS '25'        
           , MAX(CASE WHEN A.SEQ = 10   THEN A.CODE_NAME    ELSE '' END) AS '26'        
           , MAX(CASE WHEN A.SEQ = 11   THEN A.CODE_NAME    ELSE '' END) AS '26_1'      
           , MAX(CASE WHEN A.SEQ = 12   THEN A.CODE_NAME    ELSE '' END) AS '26_2'      
           , MAX(CASE WHEN A.SEQ = 13   THEN A.CODE_NAME    ELSE '' END) AS '26_3'      
           , MAX(CASE WHEN A.SEQ = 14   THEN A.CODE_NAME    ELSE '' END) AS '26_4'      
           , MAX(CASE WHEN A.SEQ = 15   THEN A.CODE_NAME    ELSE '' END) AS '26_5'      
           , MAX(CASE WHEN A.SEQ &gt;= 16                                                  
                           THEN 'z' + uniLITE.fnGetTxt('H0043')                         
                           ELSE (CASE WHEN A.SEQ = 16 THEN A.CODE_NAME ELSE '' END)     
                  END) AS '27'                                                          
           , MAX(CASE WHEN C.SEQ = 1    THEN C.CODE_NAME    ELSE '' END) AS '28'        
           , MAX(CASE WHEN C.SEQ = 2    THEN C.CODE_NAME    ELSE '' END) AS '29'        
           , MAX(CASE WHEN C.SEQ = 3    THEN C.CODE_NAME    ELSE '' END) AS '30'        
           , MAX(CASE WHEN C.SEQ = 4    THEN C.CODE_NAME    ELSE '' END) AS '31'        
           , MAX(CASE WHEN C.SEQ = 5    THEN C.CODE_NAME    ELSE '' END) AS '32'        
           , MAX(CASE WHEN C.SEQ = 6    THEN C.CODE_NAME    ELSE '' END) AS '33'        
           , MAX(CASE WHEN C.SEQ = 7    THEN C.CODE_NAME    ELSE '' END) AS '34'        
           , MAX(CASE WHEN C.SEQ = 8    THEN C.CODE_NAME    ELSE '' END) AS '35'        
           , MAX(CASE WHEN C.SEQ = 9    THEN C.CODE_NAME    ELSE '' END) AS '36'        
           , MAX(CASE WHEN C.SEQ = 10   THEN C.CODE_NAME    ELSE '' END) AS '37'        
           , MAX(CASE WHEN C.SEQ = 11   THEN C.CODE_NAME    ELSE '' END) AS '38'        
           , MAX(CASE WHEN C.SEQ = 12   THEN C.CODE_NAME    ELSE '' END) AS '39'        
           , MAX(CASE WHEN C.SEQ = 13   THEN C.CODE_NAME    ELSE '' END) AS '40'        
           , MAX(CASE WHEN C.SEQ = 14   THEN C.CODE_NAME    ELSE '' END) AS '41'        
           , MAX(CASE WHEN C.SEQ = 15   THEN C.CODE_NAME    ELSE '' END) AS '42'        
        FROM HPA900PH_MASTER A, HBO800PH_MASTER B, HAT200PH_MASTER C 
	</select>
	
	
	<select id="s_hpa900rkr_ygServiceImpl.selectListPrint5"  parameterType="Map" resultType="rMap">
      --s_hpa900rkr_ygServiceImpl.selectListPrint5
    SELECT M1.PAY_YYYYMM 
         , M1.SUPP_TYPE 
         , M1.POST_CODE
         , '' AS  PAY_GRADE1    
         , M1.DIV_CODE             
         , M1.DEPT_CODE AS DEPT_CODE
         , M1.DEPT_NAME AS DEPT_NAME
         , '' AS TREE_CODE
         , M1.PAY_CODE 
         , M1.PAY_PROV_FLAG
         , M1.PERSON_NUMB       
         , M0.NAME    
         , unilite.fnCipherDecrypt(M0.REPRE_NUM, 'RR') REPRE_NUM 
         , M0.JOIN_DATE
         , M0.RETR_DATE
         , (CASE WHEN M0.PAY_CODE != '3' 
                      THEN ISNULL(M4.WORK_DAY,0) 
                      ELSE ISNULL(M4.WORK_TIME, 0) 
             END) AS WORK_DAY
         , ISNULL(M4.TOT_DAY,0) AS TOT_DAY
         , M4.WORK_DAY AS R_WORK_DAY
         , M4.WORK_TIME
         
         , (SELECT EXTEND_WORK_YN
              FROM HBS400T
             WHERE COMP_CODE = #{S_COMP_CODE}) AS EXTEND_WORK_YN
             
         , CASE (SELECT EXTEND_WORK_YN
                   FROM HBS400T
                  WHERE COMP_CODE = #{S_COMP_CODE}) WHEN 'Y' THEN M4.EXTEND_WORK_TIME 
                                                          ELSE 0 
                                                          END AS EXTEND_WORK_TIME
         , (SELECT DIV_NAME
              FROM BOR120T WITH(NOLOCK)
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND DIV_CODE  = M1.DIV_CODE) AS DIV_NAME
         , (SELECT CODE_NAME
              FROM BSA100T 
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND MAIN_CODE = 'H005' 
               AND SUB_CODE  = M1.POST_CODE) AS POST_NM
         , '' AS GRADE
         , '' AS PAY_GRADE2
         , (SELECT CODE_NAME 
              FROM BSA100T 
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND MAIN_CODE = 'H011' 
               AND SUB_CODE  = M1.PAY_GUBUN) AS PAY_GUBUN
         , M0.SPOUSE
         , M0.SUPP_AGED_NUM
         , M0.CHILD_20_NUM
         , M0.DEFORM_NUM
         , M0.AGED_NUM
         , ISNULL(M1.SUPP_TOTAL_I,0) AS SUPP_TOTAL_I 
         , ISNULL(M1.DED_TOTAL_I,0) AS DED_TOTAL_I
         , ISNULL(M1.REAL_AMOUNT_I,0) AS REAL_AMOUNT_I 
         , unilite.fnCipherDecrypt(M0.BANK_ACCOUNT1, 'RB') BANK_ACCOUNT1 
         , ISNULL(M2.S1,0) AS S1         , ISNULL(M2.S2,0) AS S2         , ISNULL(M2.S3,0) AS S3
         , ISNULL(M2.S4,0) AS S4         , ISNULL(M2.S5,0) AS S5         , ISNULL(M2.S6,0) AS S6
         , ISNULL(M2.S7,0) AS S7         , ISNULL(M2.S8,0) AS S8         , ISNULL(M2.S9,0) AS S9
         , ISNULL(M2.S10,0) AS S10       , ISNULL(M2.S11,0) AS S11       , ISNULL(M2.S12,0) AS S12
         , ISNULL(M2.S13,0) AS S13       , ISNULL(M2.S14,0) AS S14       , ISNULL(M2.S15,0) AS S15
         , ISNULL(M2.S16,0) AS S16       , ISNULL(M3.G17,0) AS G17       , ISNULL(M3.G18,0) AS G18
         , ISNULL(M3.G19,0) AS G19       , ISNULL(M3.G20,0) AS G20       , ISNULL(M3.G21,0) AS G21
         , ISNULL(M3.G22,0) AS G22       , ISNULL(M3.G23,0) AS G23       , ISNULL(M3.G24,0) AS G24
         , ISNULL(M3.G25,0) AS G25       , ISNULL(M3.G26,0) AS G26       , ISNULL(M3.G26_1,0) AS G26_1 
         , ISNULL(M3.G26_2,0) AS G26_2   , ISNULL(M3.G26_3,0) AS G26_3   , ISNULL(M3.G26_4,0) AS G26_4
         , ISNULL(M3.G26_5,0) AS G26_5   , ISNULL(M3.G27,0) AS G27       , ISNULL(M5.H10,0) AS H10
         , ISNULL(M5.H11,0) AS H11       , ISNULL(M5.H12,0) AS H12       , ISNULL(M5.H13,0) AS H13
         , ISNULL(M5.H14,0) AS H14       , ISNULL(M5.H15,0) AS H15       , ISNULL(M5.H16,0) AS H16
         , ISNULL(M5.H17,0) AS H17       , ISNULL(M5.H18,0) AS H18       , ISNULL(M5.H19,0) AS H19 
         , ISNULL(M5.H20,0) AS H20       , ISNULL(M5.H21,0) AS H21       , ISNULL(M5.H22,0) AS H22
         , ISNULL(M5.H23,0) AS H23       , ISNULL(M5.H24,0) AS H24
         , HM2.HH1      , HM2.HH2        , HM2.HH3
         , HM2.HH4      , HM2.HH5        , HM2.HH6
         , HM2.HH7      , HM2.HH8        , HM2.HH9
         , HM2.HH10     , HM2.HH11       , HM2.HH12
         , HM2.HH13     , HM2.HH14       , HM2.HH15
         , HM2.HH16     , HM3.HH17       , HM3.HH18
         , HM3.HH19     , HM3.HH20       , HM3.HH21
         , HM3.HH22     , HM3.HH23       , HM3.HH24
         , HM3.HH25     , HM3.HH26       , HM3.HH26_1
         , HM3.HH26_2   , HM3.HH26_3     , HM3.HH26_4
         , HM3.HH26_5   , HM3.HH27       , HM4.HH28
         , HM4.HH29     , HM4.HH30       , HM4.HH31
         , HM4.HH32     , HM4.HH33       , HM4.HH34
         , HM4.HH35     , HM4.HH36       , HM4.HH37
         , HM4.HH38     , HM4.HH39       , HM4.HH40
         , HM4.HH41     , HM4.HH42        
         , ISNULL(D.LIMIT_PAY_SUPP_I, 0) AS NON_TAX_TOT
         ,ISNULL((SELECT CUSTOM_NAME 
                    FROM BCM100T 
                   WHERE COMP_CODE = #{S_COMP_CODE}
                     AND CUSTOM_TYPE = '4' 
                     AND CUSTOM_CODE = M0.BANK_CODE1),'') AS BANK_NAME
         , (SELECT YEAR_NUM 
              FROM HAT700T 
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND SUBSTRING(DUTY_YYYYMMDDFR_USE, 1, 6) &lt;= M1.PAY_YYYYMM
               AND SUBSTRING(DUTY_YYYYMMDDTO_USE, 1, 6) &gt;= M1.PAY_YYYYMM
               AND PERSON_NUMB = M0.PERSON_NUMB) AS YEAR_NUM
         , (SELECT YEAR_USE 
              FROM HAT700T 
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND SUBSTRING(DUTY_YYYYMMDDFR_USE, 1, 6) &lt;= M1.PAY_YYYYMM
               AND SUBSTRING(DUTY_YYYYMMDDTO_USE, 1, 6) &gt;= M1.PAY_YYYYMM
               AND PERSON_NUMB = M0.PERSON_NUMB) AS YEAR_USE
         , (SELECT YEAR_PROV 
              FROM HAT700T 
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND SUBSTRING(DUTY_YYYYMMDDFR_USE, 1, 6) &lt;= M1.PAY_YYYYMM
               AND SUBSTRING(DUTY_YYYYMMDDTO_USE, 1, 6) &gt;= M1.PAY_YYYYMM
               AND PERSON_NUMB = M0.PERSON_NUMB) AS YEAR_PROV
         , (SELECT MONTH_NUM 
              FROM HAT700T 
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND SUBSTRING(DUTY_YYYYMMDDFR_USE, 1, 6) &lt;= M1.PAY_YYYYMM
               AND SUBSTRING(DUTY_YYYYMMDDTO_USE, 1, 6) &gt;= M1.PAY_YYYYMM
               AND PERSON_NUMB = M0.PERSON_NUMB) AS MONTH_NUM 
         , (SELECT MONTH_USE 
              FROM HAT700T 
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND SUBSTRING(DUTY_YYYYMMDDFR_USE, 1, 6) &lt;= M1.PAY_YYYYMM
               AND SUBSTRING(DUTY_YYYYMMDDTO_USE, 1, 6) &gt;= M1.PAY_YYYYMM
               AND PERSON_NUMB = M0.PERSON_NUMB) AS MONTH_USE 
         , (SELECT MONTH_PROV 
              FROM HAT700T 
             WHERE COMP_CODE = #{S_COMP_CODE}
               AND SUBSTRING(DUTY_YYYYMMDDFR_USE, 1, 6) &lt;= M1.PAY_YYYYMM
               AND SUBSTRING(DUTY_YYYYMMDDTO_USE, 1, 6) &gt;= M1.PAY_YYYYMM
               AND PERSON_NUMB = M0.PERSON_NUMB) AS MONTH_PROV 
         , ISNULL(M4.SAT_DAY  , 0) AS SAT_DAY
         , ISNULL(M4.SUN_DAY  , 0) AS SUN_DAY
         , ISNULL(M4.WEEK_GIVE, 0) AS WEEK_GIVE
      FROM            HUM100T M0 WITH (NOLOCK)
           INNER JOIN HPA600T M1 WITH (NOLOCK) ON M1.COMP_CODE   = M0.COMP_CODE
                                              AND M1.PERSON_NUMB = M0.PERSON_NUMB
           LEFT  JOIN (SELECT A.COMP_CODE
                            , A.PAY_YYYYMM
                            , A.SUPP_TYPE
                            , A.PERSON_NUMB
                            , SUM(ISNULL(A.LIMIT_PAY_SUPP_I, 0)) AS LIMIT_PAY_SUPP_I
                         FROM            HPA800T A WITH (NOLOCK)
                        GROUP BY A.COMP_CODE, A.PAY_YYYYMM, A.SUPP_TYPE, A.PERSON_NUMB
                      )       D                ON D.COMP_CODE    = M1.COMP_CODE
                                              AND D.PAY_YYYYMM   = M1.PAY_YYYYMM
                                              AND D.SUPP_TYPE    = M1.SUPP_TYPE
                                              AND D.PERSON_NUMB  = M1.PERSON_NUMB
           LEFT  JOIN BSA100T B1 WITH (NOLOCK) ON B1.COMP_CODE   = M0.COMP_CODE
                                              AND B1.MAIN_CODE   = 'H024'
                                              AND B1.SUB_CODE    = M0.EMPLOY_TYPE
           LEFT  JOIN BSA100T B2 WITH (NOLOCK) ON B2.COMP_CODE   = M0.COMP_CODE
                                              AND B2.MAIN_CODE   = 'H181'
                                              AND B2.SUB_CODE    = ISNULL(B1.REF_CODE1, '')
           LEFT  JOIN HAT300T M4 WITH (NOLOCK) ON M4.COMP_CODE   = M1.COMP_CODE
                                              AND M4.PERSON_NUMB = M1.PERSON_NUMB
                                              AND M4.DUTY_YYYYMM = M1.PAY_YYYYMM
           INNER JOIN (SELECT T1.PERSON_NUMB
                            , MAX(CASE WHEN T4.C1 != ''  THEN T4.C1   ELSE '' END) AS 'HH1'
                            , MAX(CASE WHEN T4.C2 != ''  THEN T4.C2   ELSE '' END) AS 'HH2'
                            , MAX(CASE WHEN T4.C3 != ''  THEN T4.C3   ELSE '' END) AS 'HH3'
                            , MAX(CASE WHEN T4.C4 != ''  THEN T4.C4   ELSE '' END) AS 'HH4'
                            , MAX(CASE WHEN T4.C5 != ''  THEN T4.C5   ELSE '' END) AS 'HH5'
                            , MAX(CASE WHEN T4.C6 != ''  THEN T4.C6   ELSE '' END) AS 'HH6'
                            , MAX(CASE WHEN T4.C7 != ''  THEN T4.C7   ELSE '' END) AS 'HH7'
                            , MAX(CASE WHEN T4.C8 != ''  THEN T4.C8   ELSE '' END) AS 'HH8'
                            , MAX(CASE WHEN T4.C9 != ''  THEN T4.C9   ELSE '' END) AS 'HH9'
                            , MAX(CASE WHEN T4.C10 != '' THEN T4.C10  ELSE '' END) AS 'HH10'
                            , MAX(CASE WHEN T4.C11 != '' THEN T4.C11  ELSE '' END) AS 'HH11'
                            , MAX(CASE WHEN T4.C12 != '' THEN T4.C12  ELSE '' END) AS 'HH12'
                            , MAX(CASE WHEN T4.C13 != '' THEN T4.C13  ELSE '' END) AS 'HH13'
                            , MAX(CASE WHEN T4.C14 != '' THEN T4.C14  ELSE '' END) AS 'HH14'
                            , MAX(CASE WHEN T4.C15 != '' THEN T4.C15  ELSE '' END) AS 'HH15'
                            , MAX(CASE WHEN T4.C16 != '' THEN T4.C16  ELSE '' END) AS 'HH16'
                            , T1.COMP_CODE
                         FROM (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
                                    , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
                                    , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
                                    , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
                                    , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
                                    , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
                                    , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
                                    , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
                                    , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
                                    , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
                                    , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
                                    , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
                                    , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
                                    , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
                                    , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
                                                , MAX(CASE WHEN W_SEQ &gt;= 16 
                                                    THEN 'zzz'
                                                    ELSE (CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) 
                                           END) AS 'C16'
                                 FROM HBO800PH_MASTER) T4
                            , HPA600T T1 WITH (NOLOCK)
                        WHERE T1.COMP_CODE      = #{S_COMP_CODE}
                          AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
                          AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
                          AND T1.SUPP_TYPE      = #{SUPP_TYPE}
                        GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM2 ON HM2.COMP_CODE   = M1.COMP_CODE
                                                                  AND HM2.PERSON_NUMB = M1.PERSON_NUMB
           INNER JOIN (SELECT T1.PERSON_NUMB
                            , MAX(CASE WHEN T4.C17 != ''    THEN T4.C17   ELSE '' END) AS 'HH17'
                            , MAX(CASE WHEN T4.C18 != ''    THEN T4.C18   ELSE '' END) AS 'HH18'
                            , MAX(CASE WHEN T4.C19 != ''    THEN T4.C19   ELSE '' END) AS 'HH19'
                            , MAX(CASE WHEN T4.C20 != ''    THEN T4.C20   ELSE '' END) AS 'HH20'
                            , MAX(CASE WHEN T4.C21 != ''    THEN T4.C21   ELSE '' END) AS 'HH21'
                            , MAX(CASE WHEN T4.C22 != ''    THEN T4.C22   ELSE '' END) AS 'HH22'
                            , MAX(CASE WHEN T4.C23 != ''    THEN T4.C23   ELSE '' END) AS 'HH23'
                            , MAX(CASE WHEN T4.C24 != ''    THEN T4.C24   ELSE '' END) AS 'HH24'
                            , MAX(CASE WHEN T4.C25 != ''    THEN T4.C25   ELSE '' END) AS 'HH25'
                            , MAX(CASE WHEN T4.C26 != ''    THEN T4.C26   ELSE '' END) AS 'HH26' 
                            , MAX(CASE WHEN T4.C26_1 != ''  THEN T4.C26_1 ELSE '' END) AS 'HH26_1'
                            , MAX(CASE WHEN T4.C26_2 != ''  THEN T4.C26_2 ELSE '' END) AS 'HH26_2'
                            , MAX(CASE WHEN T4.C26_3 != ''  THEN T4.C26_3 ELSE '' END) AS 'HH26_3'
                            , MAX(CASE WHEN T4.C26_4 != ''  THEN T4.C26_4 ELSE '' END) AS 'HH26_4'
                            , MAX(CASE WHEN T4.C26_5 != ''  THEN T4.C26_5 ELSE '' END) AS 'HH26_5'
                            , MAX(CASE WHEN T4.C27 != ''    THEN T4.C27   ELSE '' END) AS 'HH27'
                            , T1.COMP_CODE
                         FROM (SELECT MAX(CASE WHEN A.SEQ = 1 THEN A.SUB_CODE ELSE '' END) 'C17'
                                    , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
                                    , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
                                    , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
                                    , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
                                    , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C22' 
                                    , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C23' 
                                    , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C24' 
                                    , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C25' 
                                    , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C26' 
                                    , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C26_1' 
                                    , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'C26_2' 
                                    , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'C26_3' 
                                    , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'C26_4' 
                                    , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'C26_5' 
                                    , MAX(CASE WHEN A.SEQ &gt;= 16 
                                                    THEN 'zz' 
                                                    ELSE (CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) 
                                           END) AS 'C27'
                                 FROM HPA900PH_MASTER A ) T4
                            , HPA600T T1 WITH (NOLOCK)
                        WHERE T1.COMP_CODE      = #{S_COMP_CODE}
                          AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
                          AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
                          AND T1.SUPP_TYPE      = #{SUPP_TYPE}
                        GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM3 ON HM3.COMP_CODE   = M1.COMP_CODE
                                                                  AND HM3.PERSON_NUMB = M1.PERSON_NUMB
           LEFT  JOIN (SELECT T1.PERSON_NUMB
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C1  THEN T1.AMOUNT_I ELSE 0 END) AS 'S1'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C2  THEN T1.AMOUNT_I ELSE 0 END) AS 'S2'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C3  THEN T1.AMOUNT_I ELSE 0 END) AS 'S3'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C4  THEN T1.AMOUNT_I ELSE 0 END) AS 'S4'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C5  THEN T1.AMOUNT_I ELSE 0 END) AS 'S5'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C6  THEN T1.AMOUNT_I ELSE 0 END) AS 'S6'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C7  THEN T1.AMOUNT_I ELSE 0 END) AS 'S7'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C8  THEN T1.AMOUNT_I ELSE 0 END) AS 'S8'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C9  THEN T1.AMOUNT_I ELSE 0 END) AS 'S9'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C10 THEN T1.AMOUNT_I ELSE 0 END) AS 'S10'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C11 THEN T1.AMOUNT_I ELSE 0 END) AS 'S11'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C12 THEN T1.AMOUNT_I ELSE 0 END) AS 'S12'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C13 THEN T1.AMOUNT_I ELSE 0 END) AS 'S13'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C14 THEN T1.AMOUNT_I ELSE 0 END) AS 'S14'
                            , SUM(CASE WHEN T1.WAGES_CODE = T4.C15 THEN T1.AMOUNT_I ELSE 0 END) AS 'S15'
                            , MAX(CASE WHEN T4.C16 = 'zzz' 
                                            THEN ISNULL(T5.ETC_AMT,0)
                                            ELSE (CASE WHEN T1.WAGES_CODE = T4.C16 THEN T1.AMOUNT_I ELSE 0 END) 
                                   END) AS 'S16'
                            , T1.COMP_CODE
                            , T1.PAY_YYYYMM
                         FROM HPA300T T1 WITH (NOLOCK)
                              LEFT JOIN (SELECT PERSON_NUMB
                                              , SUM(AMOUNT_I) AS ETC_AMT 
                                              , COMP_CODE
                                              , PAY_YYYYMM
                                           FROM HPA300T  T1 WITH (NOLOCK)
                                          WHERE COMP_CODE      = #{S_COMP_CODE}
                                            AND PAY_YYYYMM &gt;= #{DATE_FR}
                                            AND PAY_YYYYMM &lt;= #{DATE_TO}
                                            AND SUPP_TYPE      = #{SUPP_TYPE}
                                            AND WAGES_CODE IN (SELECT WAGES_CODE 
                                                                 FROM HBO800PH_MASTER
                                                                WHERE W_SEQ &gt;= 16 )
                                                                GROUP BY PERSON_NUMB, COMP_CODE, PAY_YYYYMM) T5 ON T5.COMP_CODE   = T1.COMP_CODE
                                                                                                               AND T5.PERSON_NUMB = T1.PERSON_NUMB
                                                                                                               AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
                            , (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
                                    , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
                                    , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
                                    , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
                                    , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
                                    , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
                                    , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
                                    , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
                                    , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
                                    , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
                                    , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
                                    , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
                                    , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
                                    , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
                                    , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
                                    , MAX(CASE WHEN W_SEQ &gt;= 16 THEN 'zzz' 
                                                                    ELSE '' 
                                           END) AS 'C16'
                                 FROM HBO800PH_MASTER) T4
                        WHERE T1.COMP_CODE        = #{S_COMP_CODE}
                          AND T1.PAY_YYYYMM   &gt;= #{DATE_FR}
                          AND T1.PAY_YYYYMM   &lt;= #{DATE_TO}
                          AND T1.SUPP_TYPE        = #{SUPP_TYPE}
                        GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M2 ON M2.COMP_CODE   = M1.COMP_CODE
                                                                                AND M2.PERSON_NUMB = M1.PERSON_NUMB 
                                                                                AND M2.PAY_YYYYMM  = M1.PAY_YYYYMM
           LEFT  JOIN (SELECT T1.PERSON_NUMB
                            , SUM(CASE WHEN T1.DED_CODE = T4.C17   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G17'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C18   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G18'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C19   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G19'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C20   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G20'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C21   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G21'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C22   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G22'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C23   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G23'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C24   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G24'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C25   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G25'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C26   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C26_1 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_1'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C26_2 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_2'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C26_3 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_3'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C26_4 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_4'
                            , SUM(CASE WHEN T1.DED_CODE = T4.C26_5 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_5'
                            , MAX(CASE WHEN T4.C27 = 'zz' 
                                            THEN ISNULL(T5.ETC_AMT,0)
                                            ELSE (CASE WHEN T1.DED_CODE = T4.C27 THEN T1.DED_AMOUNT_I ELSE 0 END) 
                                   END) AS 'G27'
                            , T1.COMP_CODE
                            , T1.PAY_YYYYMM
                         FROM HPA400T T1 WITH (NOLOCK)
                              LEFT JOIN (SELECT PERSON_NUMB
                                              , SUM(DED_AMOUNT_I) AS ETC_AMT 
                                              , COMP_CODE
                                              , PAY_YYYYMM
                                           FROM HPA400T  T1 WITH (NOLOCK)
                                          WHERE COMP_CODE      = #{S_COMP_CODE}
                                            AND PAY_YYYYMM &gt;= #{DATE_FR}
                                            AND PAY_YYYYMM &lt;= #{DATE_TO}
                                            AND SUPP_TYPE      = #{SUPP_TYPE} 
                                            AND DED_CODE IN (SELECT SUB_CODE 
                                                               FROM HPA900PH_MASTER
                                                              WHERE SEQ &gt;= 16 )
                                                              GROUP BY PERSON_NUMB, COMP_CODE, PAY_YYYYMM) T5 ON T5.COMP_CODE   = T1.COMP_CODE
                                                                                                             AND T5.PERSON_NUMB = T1.PERSON_NUMB
                                                                                                             AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
                            , (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'C17' 
                                    , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
                                    , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
                                    , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
                                    , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
                                    , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C22' 
                                    , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C23' 
                                    , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C24' 
                                    , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C25' 
                                    , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C26' 
                                    , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C26_1' 
                                    , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'C26_2' 
                                    , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'C26_3' 
                                    , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'C26_4' 
                                    , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'C26_5' 
                                    , MAX(CASE WHEN A.SEQ &gt;= 16 THEN 'zz' 
                                                               ELSE (CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) 
                                           END) AS 'C27'
                                 FROM HPA900PH_MASTER A) T4
                        WHERE T1.COMP_CODE      = #{S_COMP_CODE}
                          AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
                          AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
                          AND T1.SUPP_TYPE      = #{SUPP_TYPE}
                        GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M3 ON M3.COMP_CODE   = M1.COMP_CODE
                                                                                AND M3.PERSON_NUMB = M1.PERSON_NUMB
                                                                                AND M3.PAY_YYYYMM  = M1.PAY_YYYYMM
           LEFT  JOIN (SELECT A.PERSON_NUMB
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '1'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H10'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '2'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H11'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '3'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H12'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '4'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H13'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '5'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H14'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '6'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H15'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '7'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H16'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '8'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H17'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '9'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H18'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '10'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H19'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '11'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H20'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '12'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H21'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '13'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H22'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '14'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H23'
                            , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '15'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H24'
                            , A.COMP_CODE
                            , A.DUTY_YYYYMM
                         FROM HAT200T A, HAT200PH_MASTER B
                        WHERE A.COMP_CODE       = #{S_COMP_CODE}
                          AND A.DUTY_CODE       = B.SUB_CODE
                          AND A.DUTY_YYYYMM &gt;= #{DATE_FR}
                          AND A.DUTY_YYYYMM &lt;= #{DATE_TO}
                        GROUP BY A.PERSON_NUMB, A.COMP_CODE, A.DUTY_YYYYMM) M5 ON M5.COMP_CODE   = M1.COMP_CODE
                                                                              AND M5.PERSON_NUMB = M1.PERSON_NUMB
                                                                              AND M5.DUTY_YYYYMM = M1.PAY_YYYYMM
           LEFT  JOIN (SELECT A.COMP_CODE
                            , A.PAY_YYYYMM
                            , A.SUPP_TYPE
                            , A.PERSON_NUMB
                            , SUM(CASE WHEN A.NONTAX_CODE IN ('O01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 연장근로 비과세
                                       ELSE 0
                                  END)               AS TAX_EXEMPTION1_I
                            , SUM(CASE WHEN A.NONTAX_CODE IN ('P01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 식대비과세
                                       ELSE 0
                                  END)               AS TAX_EXEMPTION2_I
                            , SUM(CASE WHEN A.NONTAX_CODE IN ('M01', 'M02', 'M03')  -- 국외근로 비과세
                                            THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
                                       ELSE 0
                                  END)               AS TAX_EXEMPTION4_I
                            , SUM(CASE WHEN A.NONTAX_CODE IN ('Q01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 자녀양육비비과세
                                       ELSE 0
                                  END)               AS TAX_EXEMPTION5_I
                            , SUM(CASE WHEN A.NONTAX_CODE IN ('H06', 'H07', 'H08', 'H09', 'H10')  -- 연구활동비과세
                                            THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
                                       ELSE 0
                                  END)               AS TAX_EXEMPTION6_I
                            , SUM(CASE WHEN A.NONTAX_CODE NOT IN ('O01', 'P01', 'M01', 'M02', 'M03', 'Q01', 'H06', 'H07', 'H08', 'H09', 'H10')  -- 기타비과세
                                            THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
                                       ELSE 0
                                  END)               AS TAX_EXEMPTION3_I
                         FROM            HPA800T A WITH (NOLOCK)
                        GROUP BY A.COMP_CODE, A.PAY_YYYYMM, A.SUPP_TYPE, A.PERSON_NUMB
                      ) M6                      ON M6.COMP_CODE   = M1.COMP_CODE
                                               AND M6.PAY_YYYYMM  = M1.PAY_YYYYMM
                                               AND M6.SUPP_TYPE   = M1.SUPP_TYPE
                                               AND M6.PERSON_NUMB = M1.PERSON_NUMB
         , (SELECT MAX(CASE WHEN SEQ = 1  THEN CODE_NAME ELSE '' END) AS HH28
                 , MAX(CASE WHEN SEQ = 2  THEN CODE_NAME ELSE '' END) AS HH29
                 , MAX(CASE WHEN SEQ = 3  THEN CODE_NAME ELSE '' END) AS HH30
                 , MAX(CASE WHEN SEQ = 4  THEN CODE_NAME ELSE '' END) AS HH31
                 , MAX(CASE WHEN SEQ = 5  THEN CODE_NAME ELSE '' END) AS HH32
                 , MAX(CASE WHEN SEQ = 6  THEN CODE_NAME ELSE '' END) AS HH33
                 , MAX(CASE WHEN SEQ = 7  THEN CODE_NAME ELSE '' END) AS HH34
                 , MAX(CASE WHEN SEQ = 8  THEN CODE_NAME ELSE '' END) AS HH35
                 , MAX(CASE WHEN SEQ = 9  THEN CODE_NAME ELSE '' END) AS HH36
                 , MAX(CASE WHEN SEQ = 10 THEN CODE_NAME ELSE '' END) AS HH37
                 , MAX(CASE WHEN SEQ = 11 THEN CODE_NAME ELSE '' END) AS HH38
                 , MAX(CASE WHEN SEQ = 12 THEN CODE_NAME ELSE '' END) AS HH39
                 , MAX(CASE WHEN SEQ = 13 THEN CODE_NAME ELSE '' END) AS HH40
                 , MAX(CASE WHEN SEQ = 14 THEN CODE_NAME ELSE '' END) AS HH41
                 , MAX(CASE WHEN SEQ = 15 THEN CODE_NAME ELSE '' END) AS HH42
              FROM HAT200PH_MASTER) HM4
     WHERE M1.COMP_CODE       = #{S_COMP_CODE}
       AND M1.PAY_YYYYMM  &gt;= #{DATE_FR}
       AND M1.PAY_YYYYMM  &lt;= #{DATE_TO}
       AND M1.SUPP_TYPE       = #{SUPP_TYPE}
       
       <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
        AND M1.DIV_CODE = #{DIV_CODE}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">
        AND M1.PERSON_NUMB = #{PERSON_NUMB}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(DEPT_CODE_FR)">
        AND M1.DEPT_CODE &gt;= #{DEPT_CODE_FR}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(DEPT_CODE_TO)">
        AND M1.DEPT_CODE &lt;= #{DEPT_CODE_TO}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(PAY_CODE)">
        AND M1.PAY_CODE = #{PAY_CODE}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(SUPP_DATE)">
        AND M1.SUPP_DATE = #{SUPP_DATE}
       </if> 
       
       <if test="@foren.Ognl@isNotEmpty(PAY_PROV_FLAG)">
        AND M1.PAY_PROV_FLAG = #{PAY_PROV_FLAG}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">
        AND M1.PAY_GUBUN = #{PAY_GUBUN}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(EMPLOY_TYPE)">
        AND M0.EMPLOY_TYPE = #{EMPLOY_TYPE}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(PERSON_GROUP)">
        AND B2.SUB_CODE = #{PERSON_GROUP}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(COST_KIND)">
        AND M1.COST_KIND = #{COST_KIND}
       </if>
       
       <if test="@foren.Ognl@isNotEmpty(AFFIL_CODE)">
        AND M0.AFFIL_CODE = #{AFFIL_CODE}
       </if>
       
       <if test="SUPP_TOTAL_I == &quot;N&quot;">
        AND M1.SUPP_TOTAL_I != 0
       </if>

       
     ORDER BY M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE, M0.NAME, M1.PERSON_NUMB
	</select>
	
    
    
    
    
    
    
    
    
    
    
    
    
	<select id="s_hpa900rkr_ygServiceImpl.selectListForPrint4"  parameterType="Map" resultType="rMap">
		--s_hpa900rkr_ygServiceImpl.selectListForPrint4 [fnHpa900p2] strtype 1 
        SELECT M1.PAY_YYYYMM 
             , M1.SUPP_TYPE 
             , M1.POST_CODE
             , '' AS  PAY_GRADE1    
             , M1.DIV_CODE             
             , M1.DEPT_CODE AS DEPT_CODE
             , M1.DEPT_NAME AS DEPT_NAME
             , '' AS TREE_CODE
             , M1.PAY_CODE 
             , M1.PAY_PROV_FLAG
             , M1.PERSON_NUMB       
             , M0.NAME    
             , unilite.fnCipherDecrypt(M0.REPRE_NUM, 'RR') REPRE_NUM 
             , M0.JOIN_DATE
             , M0.RETR_DATE
             , (CASE WHEN M0.PAY_CODE != '3' 
                          THEN ISNULL(M4.WORK_DAY,0) 
                          ELSE ISNULL(M4.WORK_TIME, 0) 
                 END) AS WORK_DAY
             , ISNULL(M4.TOT_DAY,0) AS TOT_DAY
             , M4.WORK_DAY AS R_WORK_DAY
             , M4.WORK_TIME
             , (SELECT EXTEND_WORK_YN
                  FROM HBS400T
                 WHERE COMP_CODE = #{S_COMP_CODE}) AS EXTEND_WORK_YN
             , CASE (SELECT EXTEND_WORK_YN
                       FROM HBS400T
                      WHERE COMP_CODE = #{S_COMP_CODE}) WHEN 'Y' THEN M4.EXTEND_WORK_TIME 
                                                              ELSE 0 
                                                              END EXTEND_WORK_TIME
             , (SELECT DIV_NAME
                  FROM BOR120T WITH(NOLOCK)
                 WHERE COMP_CODE = #{S_COMP_CODE}
                   AND DIV_CODE  = M1.DIV_CODE) AS DIV_NAME
        	<if test="STRTYPE == 3 or STRTYPE == 4">
             , uniLITE.fnGetUserDateComp(M1.COMP_CODE, M1.SUPP_DATE) AS SUPP_DATE 
        	</if>
             , (SELECT CODE_NAME
                  FROM BSA100T 
                 WHERE COMP_CODE = #{S_COMP_CODE}
                   AND MAIN_CODE = 'H005' 
                   AND SUB_CODE  = M1.POST_CODE) AS POST_NM
             , '' AS GRADE
             , '' AS PAY_GRADE2
             , (SELECT CODE_NAME 
                  FROM BSA100T 
                 WHERE COMP_CODE = #{S_COMP_CODE}
                   AND MAIN_CODE = 'H011' 
                   AND SUB_CODE  = M1.PAY_GUBUN) AS PAY_GUBUN
             , M0.SPOUSE
             , M0.SUPP_AGED_NUM
             , M0.CHILD_20_NUM
             , M0.DEFORM_NUM
             , M0.AGED_NUM
             , ISNULL(M1.SUPP_TOTAL_I,0) AS SUPP_TOTAL_I 
             , ISNULL(M1.DED_TOTAL_I,0) AS DED_TOTAL_I
             , ISNULL(M1.REAL_AMOUNT_I,0) AS REAL_AMOUNT_I 
             , unilite.fnCipherDecrypt(M0.BANK_ACCOUNT1, 'RB') BANK_ACCOUNT1 
             , ISNULL(M2.S1,0) AS S1         , ISNULL(M2.S2,0) AS S2         , ISNULL(M2.S3,0) AS S3
             , ISNULL(M2.S4,0) AS S4         , ISNULL(M2.S5,0) AS S5         , ISNULL(M2.S6,0) AS S6
             , ISNULL(M2.S7,0) AS S7         , ISNULL(M2.S8,0) AS S8         , ISNULL(M2.S9,0) AS S9
             , ISNULL(M2.S10,0) AS S10       , ISNULL(M2.S11,0) AS S11       , ISNULL(M2.S12,0) AS S12
          
             , ISNULL(M3.G13,0) AS G13       , ISNULL(M3.G14,0) AS G14       , ISNULL(M3.G15,0) AS G15
             , ISNULL(M3.G16,0) AS G16       , ISNULL(M3.G17,0) AS G17       , ISNULL(M3.G18,0) AS G18
             , ISNULL(M3.G19,0) AS G19       , ISNULL(M3.G20,0) AS G20       , ISNULL(M3.G21,0) AS G21
             , ISNULL(M3.G22,0) AS G22       , ISNULL(M3.G23,0) AS G23       , ISNULL(M3.G24,0) AS G24 
          FROM            HUM100T M0 WITH (NOLOCK)
               INNER JOIN HPA600T M1 WITH (NOLOCK) ON M1.COMP_CODE   = M0.COMP_CODE
                                                  AND M1.PERSON_NUMB = M0.PERSON_NUMB
               LEFT  JOIN BSA100T B1 WITH (NOLOCK) ON B1.COMP_CODE   = M0.COMP_CODE
                                                  AND B1.MAIN_CODE   = 'H024'
                                                  AND B1.SUB_CODE    = M0.EMPLOY_TYPE
               LEFT  JOIN BSA100T B2 WITH (NOLOCK) ON B2.COMP_CODE   = M0.COMP_CODE
                                                  AND B2.MAIN_CODE   = 'H181'
                                                  AND B2.SUB_CODE    = ISNULL(B1.REF_CODE1, '')
               LEFT  JOIN HAT300T M4 WITH (NOLOCK) ON M4.COMP_CODE   = M1.COMP_CODE
                                                  AND M4.PERSON_NUMB = M1.PERSON_NUMB
                                                  AND M4.DUTY_YYYYMM = M1.PAY_YYYYMM
               INNER JOIN (SELECT T1.PERSON_NUMB
                                , MAX(CASE WHEN T4.C1!= ''  THEN T4.C1   ELSE '' END) AS 'HH1'
                                , MAX(CASE WHEN T4.C2!= ''  THEN T4.C2   ELSE '' END) AS 'HH2'
                                , MAX(CASE WHEN T4.C3!= ''  THEN T4.C3   ELSE '' END) AS 'HH3'
                                , MAX(CASE WHEN T4.C4!= ''  THEN T4.C4   ELSE '' END) AS 'HH4'
                                , MAX(CASE WHEN T4.C5!= ''  THEN T4.C5   ELSE '' END) AS 'HH5'
                                , MAX(CASE WHEN T4.C6!= ''  THEN T4.C6   ELSE '' END) AS 'HH6'
                                , MAX(CASE WHEN T4.C7!= ''  THEN T4.C7   ELSE '' END) AS 'HH7'
                                , MAX(CASE WHEN T4.C8!= ''  THEN T4.C8   ELSE '' END) AS 'HH8'
                                , MAX(CASE WHEN T4.C9!= ''  THEN T4.C9   ELSE '' END) AS 'HH9'
                                , MAX(CASE WHEN T4.C10!= '' THEN T4.C10  ELSE '' END) AS 'HH10'
                                , MAX(CASE WHEN T4.C11!= '' THEN T4.C11  ELSE '' END) AS 'HH11'
                                , MAX(CASE WHEN T4.C12!= '' THEN T4.C12  ELSE '' END) AS 'HH12'               
                                , T1.COMP_CODE
                             FROM (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
                                        , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
                                        , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
                                        , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
                                        , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
                                        , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
                                        , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
                                        , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
                                        , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
                                        , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
                                        , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
                                        , MAX(CASE WHEN W_SEQ &gt;= 12 
                                            THEN 'zzz'
                                            ELSE (CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) 
                                   END) AS 'C12'
                                     FROM HBO800PH_${S_COMP_CODE}) T4
                                , HPA600T T1 WITH (NOLOCK)
                            WHERE T1.COMP_CODE    = #{S_COMP_CODE}
                              AND T1.PAY_YYYYMM  &gt;= #{DATE_FR}  
                              AND T1.PAY_YYYYMM  &lt;= #{DATE_TO} 
                              AND T1.SUPP_TYPE    = #{SUPP_TYPE} 
                            GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM2 ON HM2.COMP_CODE   = M1.COMP_CODE
                                                                                     AND HM2.PERSON_NUMB = M1.PERSON_NUMB
               INNER JOIN (SELECT T1.PERSON_NUMB
                                , MAX(CASE WHEN T4.C13!= ''  THEN T4.C13   ELSE '' END) AS 'HH13'
                                , MAX(CASE WHEN T4.C14!= ''  THEN T4.C14   ELSE '' END) AS 'HH14'
                                , MAX(CASE WHEN T4.C15!= ''  THEN T4.C15   ELSE '' END) AS 'HH15'
                                , MAX(CASE WHEN T4.C16!= ''  THEN T4.C16   ELSE '' END) AS 'HH16'
                                , MAX(CASE WHEN T4.C17!= ''  THEN T4.C17   ELSE '' END) AS 'HH17'
                                , MAX(CASE WHEN T4.C18!= ''  THEN T4.C18   ELSE '' END) AS 'HH18'
                                , MAX(CASE WHEN T4.C19!= ''  THEN T4.C19   ELSE '' END) AS 'HH19'
                                , MAX(CASE WHEN T4.C20!= ''  THEN T4.C20   ELSE '' END) AS 'HH20'
                                , MAX(CASE WHEN T4.C21!= ''  THEN T4.C21   ELSE '' END) AS 'HH21'
                                , MAX(CASE WHEN T4.C22!= ''  THEN T4.C22   ELSE '' END) AS 'HH22' 
                                , MAX(CASE WHEN T4.C23!= ''  THEN T4.C23   ELSE '' END) AS 'HH23'
                                , MAX(CASE WHEN T4.C24!= ''  THEN T4.C24   ELSE '' END) AS 'HH24'
                                , T1.COMP_CODE
                             FROM (SELECT MAX(CASE WHEN A.SEQ = 1 THEN A.SUB_CODE ELSE '' END) 'C13'
                                        , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C14' 
                                        , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C15' 
                                        , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C16' 
                                        , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C17' 
                                        , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
                                        , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
                                        , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
                                        , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
                                        , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C22' 
                                        , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C23' 
                                        , MAX(CASE WHEN A.SEQ &gt;= 12 
                                                        THEN 'zz' 
                                                        ELSE (CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) 
                                               END) AS 'C24'
                                        
                                    FROM HPA900PH_${S_COMP_CODE} A ) T4
                                , HPA600T T1 WITH (NOLOCK) 
                            WHERE T1.COMP_CODE    = #{S_COMP_CODE}
                              AND T1.PAY_YYYYMM  &gt;= #{DATE_FR}  
                              AND T1.PAY_YYYYMM  &lt;= #{DATE_TO} 
                              AND T1.SUPP_TYPE    = #{SUPP_TYPE} 
                            GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM3 ON HM3.COMP_CODE   = M1.COMP_CODE
                                                                      AND HM3.PERSON_NUMB = M1.PERSON_NUMB
               LEFT  JOIN (SELECT T1.PERSON_NUMB
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C1  THEN T1.AMOUNT_I ELSE 0 END) AS 'S1'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C2  THEN T1.AMOUNT_I ELSE 0 END) AS 'S2'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C3  THEN T1.AMOUNT_I ELSE 0 END) AS 'S3'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C4  THEN T1.AMOUNT_I ELSE 0 END) AS 'S4'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C5  THEN T1.AMOUNT_I ELSE 0 END) AS 'S5'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C6  THEN T1.AMOUNT_I ELSE 0 END) AS 'S6'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C7  THEN T1.AMOUNT_I ELSE 0 END) AS 'S7'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C8  THEN T1.AMOUNT_I ELSE 0 END) AS 'S8'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C9  THEN T1.AMOUNT_I ELSE 0 END) AS 'S9'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C10 THEN T1.AMOUNT_I ELSE 0 END) AS 'S10'
                                , SUM(CASE WHEN T1.WAGES_CODE = T4.C11 THEN T1.AMOUNT_I ELSE 0 END) AS 'S11'
                                , MAX(CASE WHEN T4.C12 = 'zzz' 
                                                THEN ISNULL(T5.ETC_AMT,0)
                                                ELSE (CASE WHEN T1.WAGES_CODE = T4.C12 THEN T1.AMOUNT_I ELSE 0 END) 
                                       END) AS 'S12'
                                , T1.COMP_CODE, T1.PAY_YYYYMM
                             FROM HPA300T T1 WITH (NOLOCK)
                                  LEFT JOIN (SELECT PERSON_NUMB
                                                  , SUM(AMOUNT_I) AS ETC_AMT 
                                                  , COMP_CODE 
                                               FROM HPA300T WITH (NOLOCK)
                                              WHERE COMP_CODE    = #{S_COMP_CODE}
                                                AND PAY_YYYYMM  &gt;= #{DATE_FR}  
                                                AND PAY_YYYYMM  &lt;= #{DATE_TO} 
                                                AND SUPP_TYPE    = #{SUPP_TYPE} 
                                                AND WAGES_CODE IN (SELECT WAGES_CODE 
                                                                     FROM HBO800PH_${S_COMP_CODE}
                                                                    WHERE W_SEQ &gt;= 12 )
                                                                    GROUP BY PERSON_NUMB, COMP_CODE) T5 ON T5.COMP_CODE   = T1.COMP_CODE
                                                                                                       AND T5.PERSON_NUMB = T1.PERSON_NUMB
                                , (SELECT MAX(CASE WHEN W_SEQ = 1   THEN WAGES_CODE ELSE '' END) AS 'C1'
                                        , MAX(CASE WHEN W_SEQ = 2   THEN WAGES_CODE ELSE '' END) AS 'C2'
                                        , MAX(CASE WHEN W_SEQ = 3   THEN WAGES_CODE ELSE '' END) AS 'C3'
                                        , MAX(CASE WHEN W_SEQ = 4   THEN WAGES_CODE ELSE '' END) AS 'C4'
                                        , MAX(CASE WHEN W_SEQ = 5   THEN WAGES_CODE ELSE '' END) AS 'C5'
                                        , MAX(CASE WHEN W_SEQ = 6   THEN WAGES_CODE ELSE '' END) AS 'C6'
                                        , MAX(CASE WHEN W_SEQ = 7   THEN WAGES_CODE ELSE '' END) AS 'C7'
                                        , MAX(CASE WHEN W_SEQ = 8   THEN WAGES_CODE ELSE '' END) AS 'C8'
                                        , MAX(CASE WHEN W_SEQ = 9   THEN WAGES_CODE ELSE '' END) AS 'C9'
                                        , MAX(CASE WHEN W_SEQ = 10  THEN WAGES_CODE ELSE '' END) AS 'C10'
                                        , MAX(CASE WHEN W_SEQ = 11  THEN WAGES_CODE ELSE '' END) AS 'C11'
                                        , MAX(CASE WHEN W_SEQ &gt;= 12 THEN 'zzz' 
                                                                        ELSE '' 
                                               END) AS 'C12'
                                     FROM HBO800PH_${S_COMP_CODE} ) T4
                            WHERE T1.COMP_CODE    = #{S_COMP_CODE}
                              AND T1.PAY_YYYYMM  &gt;= #{DATE_FR}  
                              AND T1.PAY_YYYYMM  &lt;= #{DATE_TO} 
                              AND T1.SUPP_TYPE    = #{SUPP_TYPE} 
                            GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M2 ON M2.COMP_CODE   = M1.COMP_CODE
                                                                     AND M2.PERSON_NUMB = M1.PERSON_NUMB 
                                                                     AND M2.PAY_YYYYMM  = M1.PAY_YYYYMM
               LEFT  JOIN (SELECT T1.PERSON_NUMB
                                , SUM(CASE WHEN T1.DED_CODE = T4.C13  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G13'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C14  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G14'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C15  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G15'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C16  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G16'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C17  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G17'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C18  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G18'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C19  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G19'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C20  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G20'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C21  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G21'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C22  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G22'
                                , SUM(CASE WHEN T1.DED_CODE = T4.C23  THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G23'
                                , MAX(CASE WHEN T4.C24 = 'zz' 
                                                THEN ISNULL(T5.ETC_AMT,0)
                                                ELSE (CASE WHEN T1.DED_CODE = T4.C24 THEN T1.DED_AMOUNT_I ELSE 0 END) 
                                       END) AS 'G24'
                                
                                , T1.COMP_CODE
                             FROM HPA400T T1 WITH (NOLOCK)
                                  LEFT JOIN (SELECT PERSON_NUMB
                                                  , SUM(DED_AMOUNT_I) AS ETC_AMT 
                                                  , COMP_CODE
                                               FROM HPA400T WITH (NOLOCK)
                                              WHERE COMP_CODE    = #{S_COMP_CODE}
                                                AND PAY_YYYYMM  &gt;= #{DATE_FR}  
                                                AND PAY_YYYYMM  &lt;= #{DATE_TO} 
                                                AND SUPP_TYPE    = #{SUPP_TYPE} 
                                                AND DED_CODE IN (SELECT SUB_CODE 
                                                                   FROM HPA900PH_${S_COMP_CODE}
                                                                  WHERE SEQ &gt;= 12 )
                                                                  GROUP BY PERSON_NUMB, COMP_CODE) T5 ON T5.COMP_CODE   = T1.COMP_CODE
                                                                                                     AND T5.PERSON_NUMB = T1.PERSON_NUMB
                                , (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'C13' 
                                        , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C14' 
                                        , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C15' 
                                        , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C16' 
                                        , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C17' 
                                        , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
                                        , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
                                        , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
                                        , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
                                        , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C22' 
                                        , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C23' 
                                        , MAX(CASE WHEN A.SEQ &gt;= 12 THEN 'zz' 
                                                                   ELSE (CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) 
                                               END) AS 'C24'
                                        
                                     FROM HPA900PH_${S_COMP_CODE} A ) T4
                            WHERE T1.COMP_CODE    = #{S_COMP_CODE}
                              AND T1.PAY_YYYYMM  &gt;= #{DATE_FR}  
                              AND T1.PAY_YYYYMM  &lt;= #{DATE_TO} 
                              AND T1.SUPP_TYPE    = #{SUPP_TYPE} 
                            GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) M3 ON M3.COMP_CODE   = M1.COMP_CODE
                                                                     AND M3.PERSON_NUMB = M1.PERSON_NUMB
         WHERE M1.COMP_CODE    = #{S_COMP_CODE}
           AND M1.PAY_YYYYMM  &gt;= #{DATE_FR}  
           AND M1.PAY_YYYYMM  &lt;= #{DATE_TO} 
           AND M1.SUPP_TYPE    = #{SUPP_TYPE} 
        <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
            AND M1.DIV_CODE   = #{DIV_CODE}
		</if>
		<if test="@foren.Ognl@isNotEmpty(DEPT_FR)">
            AND M1.DEPT_CODE &gt;= #{DEPT_FR}
		</if>   
		<if test="@foren.Ognl@isNotEmpty(DEPT_TO)">
	         AND M1.DEPT_CODE &lt;= #{DEPT_TO}
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(PAY_CODE)">
         AND M1.PAY_CODE   = #{PAY_CODE}
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(PAY_DAY_FLAG)">
         AND M1.PAY_PROV_FLAG = #{PAY_DAY_FLAG}
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">
         AND M1.PERSON_NUMB = #{PERSON_NUMB}
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">
         AND M1.PAY_GUBUN   = #{PAY_GUBUN}
		</if>
   
		<if test="STRTYPE != 5 and STRTYPE != 6 and TAX_DIV_CODE != 'on' ">
         AND M1.SUPP_TOTAL_I != 0
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(SUPP_DATE)">
         AND M1.SUPP_DATE   = #{SUPP_DATE}
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(EMPLOY_TYPE)">
         AND M0.EMPLOY_TYPE  = #{EMPLOY_TYPE}
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(PERSON_GROUP)">
         AND B2.SUB_CODE  = #{PERSON_GROUP}
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(COST_KIND)">
         AND M1.COST_KIND  = #{COST_KIND}
		</if>
   
		<if test="@foren.Ognl@isNotEmpty(AFFIL_CODE)">
         AND M0.AFFIL_CODE  = #{AFFIL_CODE}
		</if>
		<choose>
			<when test=" STRTYPE == 2 ">
				GROUP BY M1.DEPT_CODE,M1.PAY_YYYYMM
			</when>
			<otherwise>
				<choose>
					<when test=" STRTYPE == 3 || STRTYPE == 4">
					ORDER BY M1.DIV_CODE, M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE,  M1.PERSON_NUMB
					</when>
					<otherwise>
						ORDER BY M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE,M0.NAME,  M1.PERSON_NUMB
					</otherwise>
				</choose>
			</otherwise>
		</choose>
	</select>
	
	<select id="s_hpa900rkr_ygServiceImpl.selectColumns" parameterType="loginVO" resultType="rMap">
		--s_hpa900rkr_ygServiceImpl.selectColumns[공제코드를 위한 temp table생성을 위해 기존 table 삭제]
			IF EXISTS(SELECT '1' AS S                  
							, TABLE_NAME                
						FROM INFORMATION_SCHEMA.TABLES 
						WHERE TABLE_NAME = 'HPA900PH_${compCode}' )
				DROP TABLE HPA900PH_${compCode}			
		--지급코드를 위한 temp table
			IF EXISTS(	SELECT '2' AS S                  
							 , TABLE_NAME                
						  FROM INFORMATION_SCHEMA.TABLES 
						 WHERE TABLE_NAME = 'HBO800PH_${compCode}')
		       DROP TABLE HBO800PH_${compCode}

		--hpa955skr.Chpa955skr[fnHpa955QStd]query02-1
			SELECT IDENTITY(INT,1,1) AS SEQ  
			     , SUB_CODE                  
			     , CODE_NAME                 
			  INTO HPA900PH_${compCode}
			  FROM BSA100T                   
			 WHERE COMP_CODE = '${compCode}'
			   AND MAIN_CODE = 'H034'        
			   AND USE_YN    = 'Y'           
			   AND SUB_CODE != '$'           
			 ORDER BY REF_CODE2, SUB_CODE    
		
		--hpa955skr.Chpa955skr[fnHpa955QStd]query03-1
			SELECT IDENTITY(INT,1,1) AS W_SEQ 
			     , WAGES_CODE                 
			     , WAGES_NAME                 
			     , WAGES_SEQ                  
			  INTO HBO800PH_${compCode}
			  FROM HBS300T                    
			 WHERE COMP_CODE = '${compCode}'
			   AND CODE_TYPE = '1'            
			   AND USE_YN = 'Y'               
			 ORDER BY WAGES_SEQ, WAGES_CODE   

		BEGIN
		SET NOCOUNT ON
			SET ARITHABORT ON
		
			DECLARE @HBO800PH_COUNT	INTEGER
			DECLARE @HPA900PH_COUNT INTEGER
			
			SET @HBO800PH_COUNT = (select count(W_SEQ) from HBO800PH_${compCode})
			SET @HPA900PH_COUNT = (select count(SEQ) from HPA900PH_${compCode})
			
			CREATE TABLE #hpa995skr_Temp
			(
				W_SEQ         INT,
				WAGES_NAME    NVARCHAR(30)
			)
			
			INSERT INTO #hpa995skr_Temp			
			SELECT W_SEQ, WAGES_NAME from HBO800PH_${compCode}
			
			WHILE @HBO800PH_COUNT &lt; 40
				BEGIN
				INSERT INTO #hpa995skr_Temp
				VALUES (@HBO800PH_COUNT +1, '')
				SET @HBO800PH_COUNT = @HBO800PH_COUNT + 1
			END
			
			INSERT INTO #hpa995skr_Temp			
			SELECT SEQ + 40 as SEQ, CODE_NAME from HPA900PH_${compCode}
			
			WHILE @HPA900PH_COUNT &lt; 20
				BEGIN
				INSERT INTO #hpa995skr_Temp
				VALUES (@HPA900PH_COUNT +41, '')
				SET @HPA900PH_COUNT = @HPA900PH_COUNT + 1
			END
		
			SELECT WAGES_NAME from #hpa995skr_Temp
			
			DROP table #hpa995skr_Temp
		
		END

	</select>

	<select id="s_hpa900rkr_ygServiceImpl.selectColumns2" parameterType="Map" resultType="rMap">		
	--s_hpa900rkr_ygServiceImpl.selectColumns2 [QUERY 01]
		--공제코드를 위한 temp table
		IF EXISTS(SELECT '1' AS S                  
						, TABLE_NAME                
					FROM INFORMATION_SCHEMA.TABLES 
					WHERE TABLE_NAME = 'HPA900PH_${S_COMP_CODE}' )
			DROP TABLE HPA900PH_${S_COMP_CODE}					
		--지급코드를 위한 temp table
		IF EXISTS(	SELECT '2' AS S                  
						 , TABLE_NAME                
					  FROM INFORMATION_SCHEMA.TABLES 
					 WHERE TABLE_NAME = 'HBO800PH_${S_COMP_CODE}')
	       DROP TABLE HBO800PH_${S_COMP_CODE}
	
	--s_hpa900rkr_ygServiceImpl.selectColumns2 [QUERY 03] (급여데이터 목록 임시테이블에 저장)
	   	 SELECT IDENTITY(INT,1,1) AS SEQ          
	   	      , S.SUB_CODE                        
	   	      , S.CODE_NAME                       
	   	   INTO HPA900PH_${S_COMP_CODE}
	   	   FROM BSA100T S INNER JOIN HPA400T C      
	   	                     ON C.COMP_CODE = S.COMP_CODE
	   	                    AND C.DED_CODE  = S.SUB_CODE
	   	 WHERE C.COMP_CODE   = #{S_COMP_CODE}
	   	   AND C.PAY_YYYYMM &gt;= #{DATE_FR} 
	   	   AND C.PAY_YYYYMM &lt;= #{DATE_TO}
	   	   AND S.MAIN_CODE   = 'H034'
	   	   AND S.SUB_CODE   != '$'  
	   	 GROUP BY S.COMP_CODE, S.SUB_CODE, S.CODE_NAME, S.REF_CODE2
	   	 ORDER BY S.REF_CODE2, S.SUB_CODE 
		
	--s_hpa900rkr_ygServiceImpl.selectColumns2 [QUERY 05] (급여데이터 목록 임시테이블에 저장)
		SELECT IDENTITY(INT,1,1) AS W_SEQ   
		     , S.WAGES_CODE                 
		     , S.WAGES_NAME                 
		     , S.WAGES_SEQ                  
		  INTO HBO800PH_${S_COMP_CODE}
		  FROM HBS300T S INNER JOIN HPA300T A 
		                    ON S.COMP_CODE  = A.COMP_CODE
		                   AND S.WAGES_CODE = A.WAGES_CODE
		 WHERE S.COMP_CODE   = #{S_COMP_CODE}
		   AND S.CODE_TYPE   = '1'              
		   AND A.SUPP_TYPE   = '1'              
		   AND A.PAY_YYYYMM &gt;= #{DATE_FR} 
		   AND A.PAY_YYYYMM &lt;= #{DATE_TO}
		 GROUP BY S.WAGES_CODE, S.WAGES_NAME, S.WAGES_SEQ 
		 ORDER BY S.WAGES_SEQ, S.WAGES_CODE 

		BEGIN
		SET NOCOUNT ON
			SET ARITHABORT ON
		
			DECLARE @HBO800PH_COUNT	INTEGER
			DECLARE @HPA900PH_COUNT INTEGER
			
			SET @HBO800PH_COUNT = (select count(W_SEQ) from HBO800PH_${S_COMP_CODE})
			SET @HPA900PH_COUNT = (select count(SEQ) from HPA900PH_${S_COMP_CODE})
			
			CREATE TABLE #HPA955_Temp
			(
				W_SEQ         INT,
				WAGES_NAME    NVARCHAR(30)
			)
			
			INSERT INTO #HPA955_Temp			
			SELECT W_SEQ, WAGES_NAME from HBO800PH_${S_COMP_CODE}
			
			WHILE @HBO800PH_COUNT &lt; 40
				BEGIN
				INSERT INTO #HPA955_Temp
				VALUES (@HBO800PH_COUNT +1, '')
				SET @HBO800PH_COUNT = @HBO800PH_COUNT + 1
			END
			
			INSERT INTO #HPA955_Temp			
			select SEQ + 40 as SEQ, CODE_NAME from HPA900PH_${S_COMP_CODE}
			
			WHILE @HPA900PH_COUNT &lt; 20
				BEGIN
				INSERT INTO #HPA955_Temp
				VALUES (@HPA900PH_COUNT +41, '')
				SET @HPA900PH_COUNT = @HPA900PH_COUNT + 1
			END
		
			select WAGES_NAME from #HPA955_Temp
			
			DROP table #HPA955_Temp
		
		END
	</select>

	<select id="s_hpa900rkr_ygServiceImpl.selectList" parameterType="Map" resultType="rMap">		
	/* s_hpa900rkr_ygServiceImpl.selectList */
		IF EXISTS (SELECT TOP 1 1 FROM tempdb..sysobjects WHERE id=object_id('tempdb..#HPA955SKR_160405'))
	        DROP TABLE #HPA955SKR_160405
		
		<choose>
			<when test="rdoSelect2 == &quot;dept&quot;">
			/* 급여내역 INSERT */
				SELECT '1'								AS GUBUN
					 , M1.COMP_CODE						AS COMP_CODE
					 , uniLITE.fnGetUserDateComp(M1.COMP_CODE, M1.PAY_YYYYMM) AS PAY_YYYYMM
					 , M1.SUPP_TYPE						AS SUPP_TYPE
	                 , (SELECT CODE_NAME 
	                      FROM BSA100T
	                     WHERE COMP_CODE = 'MASTER'
	                       AND MAIN_CODE = 'H032'
	                       AND SUB_CODE = M1.SUPP_TYPE) AS SUPP_NAME
	                 , M1.DIV_CODE
	                 , M1.DEPT_CODE
	                 , M1.DEPT_NAME
	                 , COUNT(M1.PERSON_NUMB) 			AS PERSON_CNT
	                 , SUM(M1.SUPP_TOTAL_I) 			AS SUPP_TOTAL_I
	                 , SUM(M1.DED_TOTAL_I) 				AS DED_TOTAL_I
	                 , SUM(M1.REAL_AMOUNT_I) 			AS REAL_AMOUNT_I
	                 , SUM(M1.BUSI_SHARE_I) 			AS BUSI_SHARE_I
	                 , SUM(M1.WORKER_COMPEN_I) 			AS WORKER_COMPEN_I
	                 , SUM(M2.S1)	AS S1       , SUM(M2.S2)  AS S2       , SUM(M2.S3)  AS S3
	                 , SUM(M2.S4)	AS S4       , SUM(M2.S5)  AS S5       , SUM(M2.S6)  AS S6
	                 , SUM(M2.S7)	AS S7       , SUM(M2.S8)  AS S8       , SUM(M2.S9)  AS S9
	                 , SUM(M2.S10)	AS S10      , SUM(M2.S11) AS S11      , SUM(M2.S12) AS S12
	                 , SUM(M2.S13)	AS S13      , SUM(M2.S14) AS S14      , SUM(M2.S15) AS S15
	                 , SUM(M2.S16)	AS S16      , SUM(M2.S17) AS S17      , SUM(M2.S18) AS S18
	                 , SUM(M2.S19)	AS S19      , SUM(M2.S20) AS S20
	                 , SUM(M2.S21)	AS S21      , SUM(M2.S22) AS S22      , SUM(M2.S23) AS S23
	                 , SUM(M2.S24)	AS S24      , SUM(M2.S25) AS S25      , SUM(M2.S26) AS S26
	                 , SUM(M2.S27)	AS S27      , SUM(M2.S28) AS S28      , SUM(M2.S29) AS S29
	                 , SUM(M2.S30)  AS S30      , SUM(M2.S31) AS S31      , SUM(M2.S32) AS S32
	                 , SUM(M2.S33)  AS S33      , SUM(M2.S34) AS S34      , SUM(M2.S35) AS S35
	                 , SUM(M2.S36)  AS S36      , SUM(M2.S37) AS S37      , SUM(M2.S38) AS S38
	                 , SUM(M2.S39)  AS S39      , SUM(M2.S20) AS S40
					 , ISNULL(SUM(M3.D1), 0) AS D1
					 , ISNULL(SUM(M3.D2), 0) AS D2
					 , ISNULL(SUM(M3.D3), 0) AS D3
					 , ISNULL(SUM(M3.D4), 0) AS D4
					 , ISNULL(SUM(M3.D5), 0) AS D5
					 , ISNULL(SUM(M3.D6), 0) AS D6
					 , ISNULL(SUM(M3.D7), 0) AS D7
					 , ISNULL(SUM(M3.D8), 0) AS D8
					 , ISNULL(SUM(M3.D9), 0) AS D9
					 , ISNULL(SUM(M3.D10), 0) AS D10
					 , ISNULL(SUM(M3.D11), 0) AS D11
					 , ISNULL(SUM(M3.D12), 0) AS D12
					 , ISNULL(SUM(M3.D13), 0) AS D13
					 , ISNULL(SUM(M3.D14), 0) AS D14
					 , ISNULL(SUM(M3.D15), 0) AS D15
					 , ISNULL(SUM(M3.D16), 0) AS D16
					 , ISNULL(SUM(M3.D17), 0) AS D17
					 , ISNULL(SUM(M3.D18), 0) AS D18
					 , ISNULL(SUM(M3.D19), 0) AS D19
					 , ISNULL(SUM(M3.D20), 0) AS D20
				  INTO #HPA955SKR_160405
	              FROM HUM100T M0
	                   INNER JOIN HPA600T M1 ON M1.COMP_CODE    = M0.COMP_CODE
	                                        AND M1.PERSON_NUMB  = M0.PERSON_NUMB
				       INNER JOIN BSA100T Z  ON M1.COMP_CODE  = Z.COMP_CODE
				                            AND Z.MAIN_CODE     = 'H024'
				                            AND M1.EMPLOY_TYPE  = Z.SUB_CODE
	                   LEFT  JOIN (SELECT T1.PERSON_NUMB, T1.PAY_YYYYMM, T1.SUPP_TYPE
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C1  THEN T1.AMOUNT_I ELSE 0 END) AS 'S1'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C2  THEN T1.AMOUNT_I ELSE 0 END) AS 'S2'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C3  THEN T1.AMOUNT_I ELSE 0 END) AS 'S3'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C4  THEN T1.AMOUNT_I ELSE 0 END) AS 'S4'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C5  THEN T1.AMOUNT_I ELSE 0 END) AS 'S5'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C6  THEN T1.AMOUNT_I ELSE 0 END) AS 'S6'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C7  THEN T1.AMOUNT_I ELSE 0 END) AS 'S7'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C8  THEN T1.AMOUNT_I ELSE 0 END) AS 'S8'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C9  THEN T1.AMOUNT_I ELSE 0 END) AS 'S9'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C10 THEN T1.AMOUNT_I ELSE 0 END) AS 'S10'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C11 THEN T1.AMOUNT_I ELSE 0 END) AS 'S11'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C12 THEN T1.AMOUNT_I ELSE 0 END) AS 'S12'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C13 THEN T1.AMOUNT_I ELSE 0 END) AS 'S13'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C14 THEN T1.AMOUNT_I ELSE 0 END) AS 'S14'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C15 THEN T1.AMOUNT_I ELSE 0 END) AS 'S15'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C16 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C17 THEN T1.AMOUNT_I ELSE 0 END) AS 'S17'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C18 THEN T1.AMOUNT_I ELSE 0 END) AS 'S18'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C19 THEN T1.AMOUNT_I ELSE 0 END) AS 'S19'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C20 THEN T1.AMOUNT_I ELSE 0 END) AS 'S20'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C21 THEN T1.AMOUNT_I ELSE 0 END) AS 'S21'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C22 THEN T1.AMOUNT_I ELSE 0 END) AS 'S22'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C23 THEN T1.AMOUNT_I ELSE 0 END) AS 'S23'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C24 THEN T1.AMOUNT_I ELSE 0 END) AS 'S24'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C25 THEN T1.AMOUNT_I ELSE 0 END) AS 'S25'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C26 THEN T1.AMOUNT_I ELSE 0 END) AS 'S26'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C27 THEN T1.AMOUNT_I ELSE 0 END) AS 'S27'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C28 THEN T1.AMOUNT_I ELSE 0 END) AS 'S28'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C29 THEN T1.AMOUNT_I ELSE 0 END) AS 'S29'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C30 THEN T1.AMOUNT_I ELSE 0 END) AS 'S30'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C31 THEN T1.AMOUNT_I ELSE 0 END) AS 'S31'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C32 THEN T1.AMOUNT_I ELSE 0 END) AS 'S32'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C33 THEN T1.AMOUNT_I ELSE 0 END) AS 'S33'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C35 THEN T1.AMOUNT_I ELSE 0 END) AS 'S34'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C35 THEN T1.AMOUNT_I ELSE 0 END) AS 'S35'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C36 THEN T1.AMOUNT_I ELSE 0 END) AS 'S36'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C37 THEN T1.AMOUNT_I ELSE 0 END) AS 'S37'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C38 THEN T1.AMOUNT_I ELSE 0 END) AS 'S38'
									    , SUM(CASE WHEN T1.WAGES_CODE = T4.C39 THEN T1.AMOUNT_I ELSE 0 END) AS 'S39'
									    , MAX(CASE WHEN T4.C40 = 'zzz' THEN ISNULL(T5.ETC_AMT,0)
									                    ELSE (CASE WHEN T1.WAGES_CODE = T4.C40 THEN T1.AMOUNT_I ELSE 0 END) 
									           END) AS 'S40'
									    , T1.COMP_CODE
	                                 FROM HPA300T T1
	                                      LEFT JOIN (SELECT PERSON_NUMB
	                                                      , PAY_YYYYMM
	                                                      , SUPP_TYPE
	                                                      , SUM(AMOUNT_I) AS ETC_AMT
	                                                      , COMP_CODE
	                                                   FROM HPA300T
	                                                  WHERE COMP_CODE = #{S_COMP_CODE}
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">
	                                                    AND SUPP_TYPE = #{SUPP_TYPE}
				</if>
	                                                    AND PAY_YYYYMM  &gt;= #{DATE_FR}
	                                                    AND PAY_YYYYMM  &lt;= #{DATE_TO}
	                                                    AND WAGES_CODE IN (SELECT WAGES_CODE FROM HBO800PH_${S_COMP_CODE} WHERE W_SEQ &gt;= 20 )
	                                                  GROUP BY PERSON_NUMB, PAY_YYYYMM, SUPP_TYPE, COMP_CODE) T5 ON T5.COMP_CODE   = T1.COMP_CODE
	                                                                                                            AND T5.PERSON_NUMB = T1.PERSON_NUMB
	                                                                                                            AND T5.SUPP_TYPE   = T1.SUPP_TYPE
	                                                                                                            AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
	                                    , (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
	                                            , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
	                                            , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
	                                            , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
	                                            , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
	                                            , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
	                                            , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
	                                            , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
	                                            , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
	                                            , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
	                                            , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
	                                            , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
	                                            , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
	                                            , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
	                                            , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
	                                            , MAX(CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) AS 'C16'
	                                            , MAX(CASE WHEN W_SEQ = 17 THEN WAGES_CODE ELSE '' END) AS 'C17'
	                                            , MAX(CASE WHEN W_SEQ = 18 THEN WAGES_CODE ELSE '' END) AS 'C18'
	                                            , MAX(CASE WHEN W_SEQ = 19 THEN WAGES_CODE ELSE '' END) AS 'C19'
											    , MAX(CASE WHEN W_SEQ = 20 THEN WAGES_CODE ELSE '' END) AS 'C20'
											    , MAX(CASE WHEN W_SEQ = 21 THEN WAGES_CODE ELSE '' END) AS 'C21'
											    , MAX(CASE WHEN W_SEQ = 22 THEN WAGES_CODE ELSE '' END) AS 'C22'
											    , MAX(CASE WHEN W_SEQ = 23 THEN WAGES_CODE ELSE '' END) AS 'C23'
											    , MAX(CASE WHEN W_SEQ = 24 THEN WAGES_CODE ELSE '' END) AS 'C24'
											    , MAX(CASE WHEN W_SEQ = 25 THEN WAGES_CODE ELSE '' END) AS 'C25'
											    , MAX(CASE WHEN W_SEQ = 26 THEN WAGES_CODE ELSE '' END) AS 'C26'
											    , MAX(CASE WHEN W_SEQ = 27 THEN WAGES_CODE ELSE '' END) AS 'C27'
											    , MAX(CASE WHEN W_SEQ = 28 THEN WAGES_CODE ELSE '' END) AS 'C28'
											    , MAX(CASE WHEN W_SEQ = 29 THEN WAGES_CODE ELSE '' END) AS 'C29'
											    , MAX(CASE WHEN W_SEQ = 30 THEN WAGES_CODE ELSE '' END) AS 'C30'
											    , MAX(CASE WHEN W_SEQ = 31 THEN WAGES_CODE ELSE '' END) AS 'C31'
											    , MAX(CASE WHEN W_SEQ = 32 THEN WAGES_CODE ELSE '' END) AS 'C32'
											    , MAX(CASE WHEN W_SEQ = 33 THEN WAGES_CODE ELSE '' END) AS 'C33'
											    , MAX(CASE WHEN W_SEQ = 34 THEN WAGES_CODE ELSE '' END) AS 'C34'
											    , MAX(CASE WHEN W_SEQ = 35 THEN WAGES_CODE ELSE '' END) AS 'C35'
											    , MAX(CASE WHEN W_SEQ = 36 THEN WAGES_CODE ELSE '' END) AS 'C36'
											    , MAX(CASE WHEN W_SEQ = 37 THEN WAGES_CODE ELSE '' END) AS 'C37'
											    , MAX(CASE WHEN W_SEQ = 38 THEN WAGES_CODE ELSE '' END) AS 'C38'
											    , MAX(CASE WHEN W_SEQ = 39 THEN WAGES_CODE ELSE '' END) AS 'C39'
											    , MAX(CASE WHEN W_SEQ &gt;= 40 
											                    THEN 'zzz' 
											                    ELSE (CASE WHEN W_SEQ = 40 THEN WAGES_CODE ELSE '' END)
											           END) AS 'C40'
	                                         FROM HBO800PH_${S_COMP_CODE}) T4
	                                WHERE T1.COMP_CODE  = #{S_COMP_CODE}
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">
	                                  AND T1.SUPP_TYPE = #{SUPP_TYPE}
				</if>
	                                  AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
	                                  AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
	                                GROUP BY T1.PERSON_NUMB, T1.PAY_YYYYMM, T1.SUPP_TYPE, T1.COMP_CODE) M2 ON M2.COMP_CODE   = M1.COMP_CODE
	                                                                                                      AND M2.PERSON_NUMB = M1.PERSON_NUMB
	                                                                                                      AND M2.SUPP_TYPE   = M1.SUPP_TYPE
	                                                                                                      AND M2.PAY_YYYYMM  = M1.PAY_YYYYMM
	                   LEFT  JOIN (SELECT T1.PERSON_NUMB
	                                    , T1.PAY_YYYYMM
	                                    , T1.SUPP_TYPE
	                                   , SUM(CASE WHEN T1.DED_CODE = T4.D1 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D1'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D2 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D2'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D3 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D3'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D4 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D4'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D5 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D5'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D6 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D6'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D7 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D7'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D8 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D8'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D9 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D9'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D10 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D10'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D11 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D11'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D12 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D12'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D13 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D13'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D14 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D14'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D15 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D15'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D16 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D16'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D17 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D17'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D18 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D18'
									   , SUM(CASE WHEN T1.DED_CODE = T4.D19 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D19'
									   
									   , SUM(CASE WHEN T4.D20 = 'zz' 
									                   THEN ISNULL(T5.ETC_AMT,0)
									                   ELSE (CASE WHEN T1.DED_CODE = T4.D20 THEN T1.DED_AMOUNT_I ELSE 0 END) 
									          END) AS 'D20'
									   , T1.COMP_CODE
	                                 FROM HPA400T T1
	                                      LEFT JOIN (SELECT PERSON_NUMB
	                                                      , PAY_YYYYMM
	                                                      , SUPP_TYPE
	                                                      , SUM(DED_AMOUNT_I) AS ETC_AMT
	                                                      , COMP_CODE
	                                                   FROM HPA400T
	                                                  WHERE COMP_CODE = #{S_COMP_CODE}
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">
	                                                    AND SUPP_TYPE = #{SUPP_TYPE}
				</if>
	                                                    AND PAY_YYYYMM &gt;= #{DATE_FR}
	                                                    AND PAY_YYYYMM &lt;= #{DATE_TO}
	                                                    AND DED_CODE IN (SELECT SUB_CODE FROM HPA900PH_${S_COMP_CODE} WHERE SEQ &gt;= 15 )
	                                                  GROUP BY PERSON_NUMB, PAY_YYYYMM, SUPP_TYPE, COMP_CODE ) T5 ON T5.COMP_CODE   = T1.COMP_CODE
	                                                                                                             AND T5.PERSON_NUMB = T1.PERSON_NUMB
	                                                                                                             AND T5.SUPP_TYPE   = T1.SUPP_TYPE
	                                                                                                             AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
									   , (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'D1' 
									           , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'D2' 
									           , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'D3' 
									           , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'D4' 
									           , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'D5' 
									           , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'D6' 
									           , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'D7' 
									           , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'D8' 
									           , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'D9' 
									           , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'D10' 
									           , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'D11' 
									           , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'D12' 
									           , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'D13' 
									           , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'D14' 
									           , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'D15' 
									           , MAX(CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) AS 'D16' 
									           , MAX(CASE WHEN A.SEQ = 17 THEN A.SUB_CODE ELSE '' END) AS 'D17' 
									           , MAX(CASE WHEN A.SEQ = 18 THEN A.SUB_CODE ELSE '' END) AS 'D18' 
									           , MAX(CASE WHEN A.SEQ = 19 THEN A.SUB_CODE ELSE '' END) AS 'D19' 
									           , MAX(CASE WHEN A.SEQ &gt;= 20 
									                           THEN 'zz' 
									                           ELSE (CASE WHEN A.SEQ = 20 THEN A.SUB_CODE ELSE '' END) 
									                  END) AS 'D20'
	                                         FROM HPA900PH_${S_COMP_CODE} A) T4
	                                WHERE T1.COMP_CODE = #{S_COMP_CODE}
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">
	                                  AND T1.SUPP_TYPE = #{SUPP_TYPE}
				</if>
	                                  AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
	                                  AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
	                                GROUP BY T1.PERSON_NUMB, T1.PAY_YYYYMM, T1.SUPP_TYPE, T1.COMP_CODE) M3 ON M3.COMP_CODE   = M1.COMP_CODE
	                                                                                                      AND M3.PERSON_NUMB = M1.PERSON_NUMB
	                                                                                                      AND M3.SUPP_TYPE   = M1.SUPP_TYPE
	                                                                                                      AND M3.PAY_YYYYMM  = M1.PAY_YYYYMM
	             WHERE M0.COMP_CODE = #{S_COMP_CODE}
	
				<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">	     
				  	AND M1.DIV_CODE	= #{DIV_CODE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(DEPTS)">
				   AND  M1.DEPT_CODE IN
					<foreach collection="DEPTS" item="item" separator="," close=")" open="(">
			          		 #{item}
					</foreach>
				</if>
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">	     
				  	AND M1.SUPP_TYPE = #{SUPP_TYPE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(DATE_FR)">
                    AND  M1.PAY_YYYYMM &gt;= #{DATE_FR}
				</if>
				<if test="@foren.Ognl@isNotEmpty(DATE_TO)">
                    AND  M1.PAY_YYYYMM &lt;= #{DATE_TO}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PAY_CODE)">
	                AND  M1.PAY_CODE = #{PAY_CODE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PAY_DAY_FLAG)">
	                AND  M1.PAY_PROV_FLAG = #{PAY_DAY_FLAG}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">
                    AND M1.PAY_GUBUN = #{PAY_GUBUN}
				</if>
				<if test="@foren.Ognl@isNotEmpty(rdoSelect)">
                    AND M1.PAY_GUBUN2 = #{rdoSelect}
				</if>
				<if test="rdoSelect4 == &quot;male&quot;">
	            	AND M0.SEX_CODE = 'M'
				</if>
				<if test="rdoSelect4 == &quot;female&quot;">
            		AND M0.SEX_CODE = 'F'
				</if>
				<if test="rdoSelect3 == &quot;hired&quot;">
	            	AND (M0.RETR_DATE = '00000000' OR M0.RETR_DATE = '')
				</if>
				<if test="rdoSelect3 == &quot;fired&quot;">
            		AND (M0.RETR_DATE != '00000000' AND M0.RETR_DATE != '')
				</if>
				<if test="@foren.Ognl@isNotEmpty(COST_POOL)">
                    AND  M1.COST_KIND = #{COST_POOL}
				</if>
				<if test="@foren.Ognl@isNotEmpty(EMPLOY_TYPE)">
                    AND  M1.EMPLOY_TYPE = #{EMPLOY_TYPE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PERSON_GROUP)">
                    AND  Z.REF_CODE1 = #{PERSON_GROUP}
				</if>
            	
	            
            	GROUP BY M1.COMP_CODE, M1.PAY_YYYYMM, M1.SUPP_TYPE, M1.DIV_CODE, M1.DEPT_CODE, M1.DEPT_NAME
            	ORDER BY M1.COMP_CODE, M1.PAY_YYYYMM, M1.SUPP_TYPE, M1.DIV_CODE, M1.DEPT_CODE, M1.DEPT_NAME
			</when>
			<otherwise>
				SELECT '1'									AS GUBUN
					 , M1.COMP_CODE							AS COMP_CODE
					 , uniLITE.fnGetUserDateComp(M1.COMP_CODE, M1.PAY_YYYYMM) AS PAY_YYYYMM
					 , M1.SUPP_TYPE							AS SUPP_TYPE
	                 , (SELECT CODE_NAME 
	                      FROM BSA100T
	                     WHERE COMP_CODE = 'MASTER'
	                       AND MAIN_CODE = 'H032'
	                       AND SUB_CODE = M1.SUPP_TYPE) 	AS SUPP_NAME
	                 , M1.DIV_CODE
	                 , M1.POST_CODE 						AS DEPT_CODE
	                 , (SELECT CODE_NAME
	                      FROM BSA100T
	                     WHERE COMP_CODE = #{S_COMP_CODE}
	                       AND MAIN_CODE = 'H005'
	                       AND SUB_CODE  = M1.POST_CODE) 	AS DEPT_NAME
	                 , COUNT(M1.PERSON_NUMB) 				AS PERSON_CNT
	                 , SUM(M1.SUPP_TOTAL_I) 				AS SUPP_TOTAL_I
	                 , SUM(M1.DED_TOTAL_I) 					AS DED_TOTAL_I
	                 , SUM(M1.REAL_AMOUNT_I) 				AS REAL_AMOUNT_I
	                 , SUM(M1.BUSI_SHARE_I) 				AS BUSI_SHARE_I
	                 , SUM(M1.WORKER_COMPEN_I) 				AS WORKER_COMPEN_I
	                 , SUM(M2.S1)	AS S1       , SUM(M2.S2)  AS S2       , SUM(M2.S3)  AS S3
	                 , SUM(M2.S4)	AS S4       , SUM(M2.S5)  AS S5       , SUM(M2.S6)  AS S6
	                 , SUM(M2.S7)	AS S7       , SUM(M2.S8)  AS S8       , SUM(M2.S9)  AS S9
	                 , SUM(M2.S10)	AS S10      , SUM(M2.S11) AS S11      , SUM(M2.S12) AS S12
	                 , SUM(M2.S13)	AS S13      , SUM(M2.S14) AS S14      , SUM(M2.S15) AS S15
	                 , SUM(M2.S16)	AS S16      , SUM(M2.S17) AS S17      , SUM(M2.S18) AS S18
	                 , SUM(M2.S19)	AS S19      , SUM(M2.S20) AS S20
	                 , SUM(M2.S21)	AS S21      , SUM(M2.S22) AS S22      , SUM(M2.S23) AS S23
	                 , SUM(M2.S24)	AS S24      , SUM(M2.S25) AS S25      , SUM(M2.S26) AS S26
	                 , SUM(M2.S27)	AS S27      , SUM(M2.S28) AS S28      , SUM(M2.S29) AS S29
	                 , SUM(M2.S30)  AS S30      , SUM(M2.S31) AS S31      , SUM(M2.S32) AS S32
	                 , SUM(M2.S33)  AS S33      , SUM(M2.S34) AS S34      , SUM(M2.S35) AS S35
	                 , SUM(M2.S36)  AS S36      , SUM(M2.S37) AS S37      , SUM(M2.S38) AS S38
	                 , SUM(M2.S39)  AS S39      , SUM(M2.S20) AS S40
					 , ISNULL(SUM(M3.D1), 0) AS D1
					 , ISNULL(SUM(M3.D2), 0) AS D2
					 , ISNULL(SUM(M3.D3), 0) AS D3
					 , ISNULL(SUM(M3.D4), 0) AS D4
					 , ISNULL(SUM(M3.D5), 0) AS D5
					 , ISNULL(SUM(M3.D6), 0) AS D6
					 , ISNULL(SUM(M3.D7), 0) AS D7
					 , ISNULL(SUM(M3.D8), 0) AS D8
					 , ISNULL(SUM(M3.D9), 0) AS D9
					 , ISNULL(SUM(M3.D10), 0) AS D10
					 , ISNULL(SUM(M3.D11), 0) AS D11
					 , ISNULL(SUM(M3.D12), 0) AS D12
					 , ISNULL(SUM(M3.D13), 0) AS D13
					 , ISNULL(SUM(M3.D14), 0) AS D14
					 , ISNULL(SUM(M3.D15), 0) AS D15
					 , ISNULL(SUM(M3.D16), 0) AS D16
					 , ISNULL(SUM(M3.D17), 0) AS D17
					 , ISNULL(SUM(M3.D18), 0) AS D18
					 , ISNULL(SUM(M3.D19), 0) AS D19
					 , ISNULL(SUM(M3.D20), 0) AS D20
				  INTO #HPA955SKR_160405
	              FROM HUM100T M0
	                   INNER JOIN HPA600T M1 ON M1.COMP_CODE    = M0.COMP_CODE
	                                        AND M1.PERSON_NUMB  = M0.PERSON_NUMB
				       INNER JOIN BSA100T Z  ON M1.COMP_CODE  = Z.COMP_CODE
				                            AND Z.MAIN_CODE     = 'H024'
				                            AND M1.EMPLOY_TYPE  = Z.SUB_CODE
	                   LEFT  JOIN (SELECT T1.PERSON_NUMB
	                                    , T1.PAY_YYYYMM
	                                    , T1.SUPP_TYPE
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C1  THEN T1.AMOUNT_I ELSE 0 END) AS 'S1'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C2  THEN T1.AMOUNT_I ELSE 0 END) AS 'S2'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C3  THEN T1.AMOUNT_I ELSE 0 END) AS 'S3'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C4  THEN T1.AMOUNT_I ELSE 0 END) AS 'S4'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C5  THEN T1.AMOUNT_I ELSE 0 END) AS 'S5'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C6  THEN T1.AMOUNT_I ELSE 0 END) AS 'S6'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C7  THEN T1.AMOUNT_I ELSE 0 END) AS 'S7'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C8  THEN T1.AMOUNT_I ELSE 0 END) AS 'S8'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C9  THEN T1.AMOUNT_I ELSE 0 END) AS 'S9'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C10 THEN T1.AMOUNT_I ELSE 0 END) AS 'S10'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C11 THEN T1.AMOUNT_I ELSE 0 END) AS 'S11'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C12 THEN T1.AMOUNT_I ELSE 0 END) AS 'S12'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C13 THEN T1.AMOUNT_I ELSE 0 END) AS 'S13'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C14 THEN T1.AMOUNT_I ELSE 0 END) AS 'S14'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C15 THEN T1.AMOUNT_I ELSE 0 END) AS 'S15'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C16 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C17 THEN T1.AMOUNT_I ELSE 0 END) AS 'S17'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C18 THEN T1.AMOUNT_I ELSE 0 END) AS 'S18'
	                                    , SUM(CASE WHEN T1.WAGES_CODE = T4.C19 THEN T1.AMOUNT_I ELSE 0 END) AS 'S19'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C20 THEN T1.AMOUNT_I ELSE 0 END) AS 'S20'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C21 THEN T1.AMOUNT_I ELSE 0 END) AS 'S21'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C22 THEN T1.AMOUNT_I ELSE 0 END) AS 'S22'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C23 THEN T1.AMOUNT_I ELSE 0 END) AS 'S23'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C24 THEN T1.AMOUNT_I ELSE 0 END) AS 'S24'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C25 THEN T1.AMOUNT_I ELSE 0 END) AS 'S25'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C26 THEN T1.AMOUNT_I ELSE 0 END) AS 'S26'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C27 THEN T1.AMOUNT_I ELSE 0 END) AS 'S27'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C28 THEN T1.AMOUNT_I ELSE 0 END) AS 'S28'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C29 THEN T1.AMOUNT_I ELSE 0 END) AS 'S29'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C30 THEN T1.AMOUNT_I ELSE 0 END) AS 'S30'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C31 THEN T1.AMOUNT_I ELSE 0 END) AS 'S31'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C32 THEN T1.AMOUNT_I ELSE 0 END) AS 'S32'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C33 THEN T1.AMOUNT_I ELSE 0 END) AS 'S33'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C35 THEN T1.AMOUNT_I ELSE 0 END) AS 'S34'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C35 THEN T1.AMOUNT_I ELSE 0 END) AS 'S35'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C36 THEN T1.AMOUNT_I ELSE 0 END) AS 'S36'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C37 THEN T1.AMOUNT_I ELSE 0 END) AS 'S37'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C38 THEN T1.AMOUNT_I ELSE 0 END) AS 'S38'
										, SUM(CASE WHEN T1.WAGES_CODE = T4.C39 THEN T1.AMOUNT_I ELSE 0 END) AS 'S39'
										, MAX(CASE WHEN T4.C40 = 'zzz' THEN ISNULL(T5.ETC_AMT,0)
										                ELSE (CASE WHEN T1.WAGES_CODE = T4.C40 THEN T1.AMOUNT_I ELSE 0 END) 
										       END) AS 'S40'		
	                                    , T1.COMP_CODE
	                                 FROM HPA300T T1
	                                      LEFT JOIN (SELECT PERSON_NUMB
	                                                      , PAY_YYYYMM
	                                                      , SUPP_TYPE
	                                                      , SUM(AMOUNT_I) AS ETC_AMT 
	                                                      , COMP_CODE
	                                                   FROM HPA300T
	                                                  WHERE COMP_CODE = #{S_COMP_CODE}
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">
	                                                    AND SUPP_TYPE = #{SUPP_TYPE}
				</if>
	                                                    AND PAY_YYYYMM &gt;= #{DATE_FR}
	                                                    AND PAY_YYYYMM &lt;= #{DATE_TO}
	                                                    AND WAGES_CODE IN (SELECT WAGES_CODE
	                                                                         FROM HBO800PH_${S_COMP_CODE}
	                                                             WHERE W_SEQ &gt;= 20 )
	                                                  GROUP BY PERSON_NUMB, PAY_YYYYMM, SUPP_TYPE, COMP_CODE) T5 ON T5.COMP_CODE   = T1.COMP_CODE
	                                                                                                            AND T5.PERSON_NUMB = T1.PERSON_NUMB
	                                                                                                            AND T5.SUPP_TYPE   = T1.SUPP_TYPE
	                                                                                                            AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
	                                    , (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
	                                            , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
	                                            , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
	                                            , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
	                                            , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
	                                            , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
	                                            , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
	                                            , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
	                                            , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
	                                            , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
	                                            , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
	                                            , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
	                                            , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
	                                            , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
	                                            , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
	                                            , MAX(CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) AS 'C16'
	                                            , MAX(CASE WHEN W_SEQ = 17 THEN WAGES_CODE ELSE '' END) AS 'C17'
	                                            , MAX(CASE WHEN W_SEQ = 18 THEN WAGES_CODE ELSE '' END) AS 'C18'
	                                            , MAX(CASE WHEN W_SEQ = 19 THEN WAGES_CODE ELSE '' END) AS 'C19'
												, MAX(CASE WHEN W_SEQ = 20 THEN WAGES_CODE ELSE '' END) AS 'C20'
												, MAX(CASE WHEN W_SEQ = 21 THEN WAGES_CODE ELSE '' END) AS 'C21'
												, MAX(CASE WHEN W_SEQ = 22 THEN WAGES_CODE ELSE '' END) AS 'C22'
												, MAX(CASE WHEN W_SEQ = 23 THEN WAGES_CODE ELSE '' END) AS 'C23'
												, MAX(CASE WHEN W_SEQ = 24 THEN WAGES_CODE ELSE '' END) AS 'C24'
												, MAX(CASE WHEN W_SEQ = 25 THEN WAGES_CODE ELSE '' END) AS 'C25'
												, MAX(CASE WHEN W_SEQ = 26 THEN WAGES_CODE ELSE '' END) AS 'C26'
												, MAX(CASE WHEN W_SEQ = 27 THEN WAGES_CODE ELSE '' END) AS 'C27'
												, MAX(CASE WHEN W_SEQ = 28 THEN WAGES_CODE ELSE '' END) AS 'C28'
												, MAX(CASE WHEN W_SEQ = 29 THEN WAGES_CODE ELSE '' END) AS 'C29'
												, MAX(CASE WHEN W_SEQ = 30 THEN WAGES_CODE ELSE '' END) AS 'C30'
												, MAX(CASE WHEN W_SEQ = 31 THEN WAGES_CODE ELSE '' END) AS 'C31'
												, MAX(CASE WHEN W_SEQ = 32 THEN WAGES_CODE ELSE '' END) AS 'C32'
												, MAX(CASE WHEN W_SEQ = 33 THEN WAGES_CODE ELSE '' END) AS 'C33'
												, MAX(CASE WHEN W_SEQ = 34 THEN WAGES_CODE ELSE '' END) AS 'C34'
												, MAX(CASE WHEN W_SEQ = 35 THEN WAGES_CODE ELSE '' END) AS 'C35'
												, MAX(CASE WHEN W_SEQ = 36 THEN WAGES_CODE ELSE '' END) AS 'C36'
												, MAX(CASE WHEN W_SEQ = 37 THEN WAGES_CODE ELSE '' END) AS 'C37'
												, MAX(CASE WHEN W_SEQ = 38 THEN WAGES_CODE ELSE '' END) AS 'C38'
												, MAX(CASE WHEN W_SEQ = 39 THEN WAGES_CODE ELSE '' END) AS 'C39'
												, MAX(CASE WHEN W_SEQ &gt;= 40 
												                THEN 'zzz' 
												                ELSE (CASE WHEN W_SEQ = 40 THEN WAGES_CODE ELSE '' END)
												       END) AS 'C40'
	                                         FROM HBO800PH_${S_COMP_CODE}) T4
	                                WHERE T1.COMP_CODE = #{S_COMP_CODE}
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">
	                                  AND T1.SUPP_TYPE = #{SUPP_TYPE}
				</if>
	                                  AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
	                                  AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
	                                GROUP BY T1.PERSON_NUMB, T1.PAY_YYYYMM, T1.SUPP_TYPE, T1.COMP_CODE) M2 ON M2.COMP_CODE   = M1.COMP_CODE
	                                                                                                      AND M2.PERSON_NUMB = M1.PERSON_NUMB
	                                                                                                      AND M2.SUPP_TYPE   = M1.SUPP_TYPE
	                                                                                                      AND M2.PAY_YYYYMM  = M1.PAY_YYYYMM
	                   LEFT  JOIN (SELECT T1.PERSON_NUMB
	                                    , T1.PAY_YYYYMM
	                                    , T1.SUPP_TYPE
	                                    , SUM(CASE WHEN T1.DED_CODE = T4.D1 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D1'
										, SUM(CASE WHEN T1.DED_CODE = T4.D2 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D2'
										, SUM(CASE WHEN T1.DED_CODE = T4.D3 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D3'
										, SUM(CASE WHEN T1.DED_CODE = T4.D4 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D4'
										, SUM(CASE WHEN T1.DED_CODE = T4.D5 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D5'
										, SUM(CASE WHEN T1.DED_CODE = T4.D6 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D6'
										, SUM(CASE WHEN T1.DED_CODE = T4.D7 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D7'
										, SUM(CASE WHEN T1.DED_CODE = T4.D8 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D8'
										, SUM(CASE WHEN T1.DED_CODE = T4.D9 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D9'
										, SUM(CASE WHEN T1.DED_CODE = T4.D10 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D10'
										, SUM(CASE WHEN T1.DED_CODE = T4.D11 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D11'
										, SUM(CASE WHEN T1.DED_CODE = T4.D12 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D12'
										, SUM(CASE WHEN T1.DED_CODE = T4.D13 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D13'
										, SUM(CASE WHEN T1.DED_CODE = T4.D14 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D14'
										, SUM(CASE WHEN T1.DED_CODE = T4.D15 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D15'
										, SUM(CASE WHEN T1.DED_CODE = T4.D16 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D16'
										, SUM(CASE WHEN T1.DED_CODE = T4.D17 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D17'
										, SUM(CASE WHEN T1.DED_CODE = T4.D18 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D18'
										, SUM(CASE WHEN T1.DED_CODE = T4.D19 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'D19'
										
										, SUM(CASE WHEN T4.D20 = 'zz' 
										                THEN ISNULL(T5.ETC_AMT,0)
										                ELSE (CASE WHEN T1.DED_CODE = T4.D20 THEN T1.DED_AMOUNT_I ELSE 0 END) 
										       END) AS 'D20'
	                                    , T1.COMP_CODE
	                                 FROM HPA400T T1
	                                      LEFT JOIN (SELECT PERSON_NUMB
	                                                      , PAY_YYYYMM
	                                                      , SUPP_TYPE
	                                                      , SUM(DED_AMOUNT_I) AS ETC_AMT
	                                                      , COMP_CODE
	                                                   FROM HPA400T
	                                                  WHERE COMP_CODE = #{S_COMP_CODE}
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">
	                                                    AND SUPP_TYPE = #{SUPP_TYPE}
				</if>
	                                                    AND PAY_YYYYMM &gt;= #{DATE_FR}
	                                                    AND PAY_YYYYMM &lt;= #{DATE_TO}
	                                                    AND DED_CODE IN (SELECT SUB_CODE FROM HPA900PH_${S_COMP_CODE} WHERE SEQ &gt;= 15 )
	                                                  GROUP BY PERSON_NUMB, PAY_YYYYMM, SUPP_TYPE, COMP_CODE) T5 ON T5.COMP_CODE   = T1.COMP_CODE
	                                                                                                            AND T5.PERSON_NUMB = T1.PERSON_NUMB
	                                                                                                            AND T5.SUPP_TYPE   = T1.SUPP_TYPE
	                                                                                                            AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
										, (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'D1' 
										        , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'D2' 
										        , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'D3' 
										        , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'D4' 
										        , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'D5' 
										        , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'D6' 
										        , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'D7' 
										        , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'D8' 
										        , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'D9' 
										        , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'D10' 
										        , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'D11' 
										        , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'D12' 
										        , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'D13' 
										        , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'D14' 
										        , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'D15' 
										        , MAX(CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) AS 'D16' 
										        , MAX(CASE WHEN A.SEQ = 17 THEN A.SUB_CODE ELSE '' END) AS 'D17' 
										        , MAX(CASE WHEN A.SEQ = 18 THEN A.SUB_CODE ELSE '' END) AS 'D18' 
										        , MAX(CASE WHEN A.SEQ = 19 THEN A.SUB_CODE ELSE '' END) AS 'D19' 
										        , MAX(CASE WHEN A.SEQ &gt;= 20 
										                        THEN 'zz' 
										                        ELSE (CASE WHEN A.SEQ = 20 THEN A.SUB_CODE ELSE '' END) 
										               END) AS 'D20'
	                                         FROM HPA900PH_${S_COMP_CODE} A ) T4
	                                WHERE T1.COMP_CODE = #{S_COMP_CODE}
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">
	                                  AND T1.SUPP_TYPE = #{SUPP_TYPE}
				</if>
	                                  AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
	                                  AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
	                                GROUP BY T1.PERSON_NUMB, T1.PAY_YYYYMM, T1.SUPP_TYPE, T1.COMP_CODE) M3 ON M3.COMP_CODE   = M1.COMP_CODE
	                                                                                                      AND M3.PERSON_NUMB = M1.PERSON_NUMB
	                                                                                                      AND M3.SUPP_TYPE   = M1.SUPP_TYPE
	                                                                                                      AND M3.PAY_YYYYMM  = M1.PAY_YYYYMM
	             WHERE M0.COMP_CODE = #{S_COMP_CODE}
	                 
				<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">	     
				  	AND M1.DIV_CODE	= #{DIV_CODE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(DEPTS)">
				   AND  M1.DEPT_CODE IN
					<foreach collection="DEPTS" item="item" separator="," close=")" open="(">
			          		 #{item}
					</foreach>
				</if>
				<if test="@foren.Ognl@isNotEmpty(SUPP_TYPE)">	     
				  	AND M1.SUPP_TYPE = #{SUPP_TYPE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(DATE_FR)">
                    AND  M1.PAY_YYYYMM &gt;= #{DATE_FR}
				</if>
				<if test="@foren.Ognl@isNotEmpty(DATE_TO)">
                    AND  M1.PAY_YYYYMM &lt;= #{DATE_TO}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PAY_CODE)">
	                AND  M1.PAY_CODE = #{PAY_CODE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PAY_DAY_FLAG)">
	                AND  M1.PAY_PROV_FLAG = #{PAY_DAY_FLAG}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">
                    AND M1.PAY_GUBUN = #{PAY_GUBUN}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN2)">
                    AND M1.PAY_GUBUN2 = #{PAY_GUBUN2}
				</if>
				<if test="rdoSelect4 == &quot;male&quot;">
	            	AND M0.SEX_CODE = 'M'
				</if>
				<if test="rdoSelect4 == &quot;female&quot;">
            		AND M0.SEX_CODE = 'F'
				</if>
				<if test="rdoSelect3 == &quot;hired&quot;">
	            	AND (M0.RETR_DATE = '00000000' OR M0.RETR_DATE = '')
				</if>
				<if test="rdoSelect3 == &quot;fired&quot;">
            		AND (M0.RETR_DATE != '00000000' AND M0.RETR_DATE != '')
				</if>
				<if test="@foren.Ognl@isNotEmpty(COST_POOL)">
                    AND  M1.COST_KIND = #{COST_POOL}
				</if>
				<if test="@foren.Ognl@isNotEmpty(EMPLOY_TYPE)">
                    AND  M1.EMPLOY_TYPE = #{EMPLOY_TYPE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PERSON_GROUP)">
                    AND  Z.REF_CODE1 = #{PERSON_GROUP}
				</if>

	            	AND M1.REAL_AMOUNT_I &gt; 0
	            	AND (M1.REAL_AMOUNT_I &gt; 0 OR M1.REAL_AMOUNT_I &lt;0 )
           
           		GROUP BY M1.COMP_CODE, M1.PAY_YYYYMM, M1.SUPP_TYPE, M1.DIV_CODE, M1.POST_CODE
           		ORDER BY M1.COMP_CODE, M1.PAY_YYYYMM, M1.SUPP_TYPE, M1.DIV_CODE, M1.POST_CODE
			</otherwise>
		</choose>
		
		/* 사업장별 합계 INSERT */
		 INSERT INTO #HPA955SKR_160405
		       (GUBUN           , COMP_CODE		, PAY_YYYYMM		, SUPP_TYPE		, SUPP_NAME     , DIV_CODE			, DEPT_CODE
			  , DEPT_NAME		, PERSON_CNT	, SUPP_TOTAL_I		, DED_TOTAL_I	, REAL_AMOUNT_I	, BUSI_SHARE_I		, WORKER_COMPEN_I

		      , S1              , S2            , S3                , S4            , S5
		      , S6              , S7            , S8                , S9            , S10
		      , S11             , S12           , S13               , S14           , S15
		      , S16             , S17           , S18               , S19           , S20
		      , S21             , S22           , S23               , S24           , S25
		      , S26             , S27           , S28               , S29           , S30
		      , S31             , S32           , S33               , S34           , S35
		      , S36             , S37           , S38               , S39           , S40
		
		      , D1              , D2            , D3                , D4            , D5
		      , D6              , D7            , D8                , D9            , D10
		      , D11             , D12           , D13               , D14           , D15
		      , D16             , D17           , D18               , D19           , D20
		       )
		 SELECT   '2'									AS GUBUN
				, COMP_CODE								AS COMP_CODE
				, PAY_YYYYMM							AS PAY_YYYYMM
				, SUPP_TYPE								AS SUPP_TYPE
				, SUPP_NAME								AS SUPP_NAME 
				, DIV_CODE								AS DIV_CODE
				, 'Z'									AS DEPT_CODE
				, ''									AS DEPT_NAME
				, ISNULL(SUM( PERSON_CNT ),0)			AS PERSON_CNT
				, ISNULL(SUM( SUPP_TOTAL_I ),0)			AS SUPP_TOTAL_I
				, ISNULL(SUM( DED_TOTAL_I ),0)			AS DED_TOTAL_I 
				, ISNULL(SUM( REAL_AMOUNT_I ),0)		AS REAL_AMOUNT_I
				, ISNULL(SUM( BUSI_SHARE_I ),0)			AS BUSI_SHARE_I
				, ISNULL(SUM( WORKER_COMPEN_I ),0)		AS WORKER_COMPEN_I
				, ISNULL(SUM( S1 ),0)					AS S1
				, ISNULL(SUM( S2 ),0)					AS S2
				, ISNULL(SUM( S3 ),0)					AS S3
				, ISNULL(SUM( S4 ),0)					AS S4
				, ISNULL(SUM( S5 ),0)					AS S5
				, ISNULL(SUM( S6 ),0)					AS S6
				, ISNULL(SUM( S7 ),0)					AS S7
				, ISNULL(SUM( S8 ),0)					AS S8
				, ISNULL(SUM( S9 ),0)					AS S9
				, ISNULL(SUM( S10 ),0)					AS S10
				, ISNULL(SUM( S11 ),0)					AS S11
				, ISNULL(SUM( S12 ),0)					AS S12
				, ISNULL(SUM( S13 ),0)					AS S13
				, ISNULL(SUM( S14 ),0)					AS S14
				, ISNULL(SUM( S15 ),0)					AS S15
				, ISNULL(SUM( S16 ),0)					AS S16
				, ISNULL(SUM( S17 ),0)					AS S17
				, ISNULL(SUM( S18 ),0)					AS S18
				, ISNULL(SUM( S19 ),0)					AS S19
				, ISNULL(SUM( S20 ),0)					AS S20
				, ISNULL(SUM( S21 ),0)					AS S21
				, ISNULL(SUM( S22 ),0)					AS S22
				, ISNULL(SUM( S23 ),0)					AS S23
				, ISNULL(SUM( S24 ),0)					AS S24
				, ISNULL(SUM( S25 ),0)					AS S25
				, ISNULL(SUM( S26 ),0)					AS S26
				, ISNULL(SUM( S27 ),0)					AS S27
				, ISNULL(SUM( S28 ),0)					AS S28
				, ISNULL(SUM( S29 ),0)					AS S29
				, ISNULL(SUM( S30 ),0)					AS S30
				, ISNULL(SUM( S31 ),0)					AS S31
				, ISNULL(SUM( S32 ),0)					AS S32
				, ISNULL(SUM( S33 ),0)					AS S33
				, ISNULL(SUM( S34 ),0)					AS S34
				, ISNULL(SUM( S35 ),0)					AS S35
				, ISNULL(SUM( S36 ),0)					AS S36
				, ISNULL(SUM( S37 ),0)					AS S37
				, ISNULL(SUM( S38 ),0)					AS S38
				, ISNULL(SUM( S39 ),0)					AS S39
				, ISNULL(SUM( S40 ),0)					AS S40
				
				, ISNULL(SUM( D1 ),0)					AS D1
				, ISNULL(SUM( D2 ),0)					AS D2
				, ISNULL(SUM( D3 ),0)					AS D3
				, ISNULL(SUM( D4 ),0)					AS D4
				, ISNULL(SUM( D5 ),0)					AS D5
				, ISNULL(SUM( D6 ),0)					AS D6
				, ISNULL(SUM( D7 ),0)					AS D7
				, ISNULL(SUM( D8 ),0)					AS D8
				, ISNULL(SUM( D9 ),0)					AS D9
				, ISNULL(SUM( D10 ),0)					AS D10
				, ISNULL(SUM( D11 ),0)					AS D11
				, ISNULL(SUM( D12 ),0)					AS D12
				, ISNULL(SUM( D13 ),0)					AS D13
				, ISNULL(SUM( D14 ),0)					AS D14
				, ISNULL(SUM( D15 ),0)					AS D15
				, ISNULL(SUM( D16 ),0)					AS D16
				, ISNULL(SUM( D17 ),0)					AS D17
				, ISNULL(SUM( D18 ),0)					AS D18
				, ISNULL(SUM( D19 ),0)					AS D19
				, ISNULL(SUM( D20 ),0)					AS D20
		  FROM #HPA955SKR_160405
		 WHERE GUBUN = '1'
         GROUP BY COMP_CODE, PAY_YYYYMM, SUPP_TYPE, SUPP_NAME, DIV_CODE
		 ORDER BY COMP_CODE, PAY_YYYYMM, SUPP_TYPE, DIV_CODE, DEPT_CODE

		/* 지급구분별 합계 INSERT */
		 INSERT INTO #HPA955SKR_160405
		       (GUBUN           , COMP_CODE		, PAY_YYYYMM		, SUPP_TYPE		, SUPP_NAME     , DIV_CODE			, DEPT_CODE
			  , DEPT_NAME		, PERSON_CNT	, SUPP_TOTAL_I		, DED_TOTAL_I	, REAL_AMOUNT_I	, BUSI_SHARE_I		, WORKER_COMPEN_I

		      , S1              , S2            , S3                , S4            , S5
		      , S6              , S7            , S8                , S9            , S10
		      , S11             , S12           , S13               , S14           , S15
		      , S16             , S17           , S18               , S19           , S20
		      , S21             , S22           , S23               , S24           , S25
		      , S26             , S27           , S28               , S29           , S30
		      , S31             , S32           , S33               , S34           , S35
		      , S36             , S37           , S38               , S39           , S40
		
		      , D1              , D2            , D3                , D4            , D5
		      , D6              , D7            , D8                , D9            , D10
		      , D11             , D12           , D13               , D14           , D15
		      , D16             , D17           , D18               , D19           , D20
		       )
		 SELECT   '3'									AS GUBUN
				, COMP_CODE								AS COMP_CODE
				, PAY_YYYYMM							AS PAY_YYYYMM
				, SUPP_TYPE								AS SUPP_TYPE
				, SUPP_NAME								AS SUPP_NAME 
				, 'Z'									AS DIV_CODE
				, 'Z'									AS DEPT_CODE
				, ''									AS DEPT_NAME
				, ISNULL(SUM( PERSON_CNT ),0)			AS PERSON_CNT
				, ISNULL(SUM( SUPP_TOTAL_I ),0)			AS SUPP_TOTAL_I
				, ISNULL(SUM( DED_TOTAL_I ),0)			AS DED_TOTAL_I 
				, ISNULL(SUM( REAL_AMOUNT_I ),0)		AS REAL_AMOUNT_I
				, ISNULL(SUM( BUSI_SHARE_I ),0)			AS BUSI_SHARE_I
				, ISNULL(SUM( WORKER_COMPEN_I ),0)		AS WORKER_COMPEN_I
				, ISNULL(SUM( S1 ),0)					AS S1
				, ISNULL(SUM( S2 ),0)					AS S2
				, ISNULL(SUM( S3 ),0)					AS S3
				, ISNULL(SUM( S4 ),0)					AS S4
				, ISNULL(SUM( S5 ),0)					AS S5
				, ISNULL(SUM( S6 ),0)					AS S6
				, ISNULL(SUM( S7 ),0)					AS S7
				, ISNULL(SUM( S8 ),0)					AS S8
				, ISNULL(SUM( S9 ),0)					AS S9
				, ISNULL(SUM( S10 ),0)					AS S10
				, ISNULL(SUM( S11 ),0)					AS S11
				, ISNULL(SUM( S12 ),0)					AS S12
				, ISNULL(SUM( S13 ),0)					AS S13
				, ISNULL(SUM( S14 ),0)					AS S14
				, ISNULL(SUM( S15 ),0)					AS S15
				, ISNULL(SUM( S16 ),0)					AS S16
				, ISNULL(SUM( S17 ),0)					AS S17
				, ISNULL(SUM( S18 ),0)					AS S18
				, ISNULL(SUM( S19 ),0)					AS S19
				, ISNULL(SUM( S20 ),0)					AS S20
				, ISNULL(SUM( S21 ),0)					AS S21
				, ISNULL(SUM( S22 ),0)					AS S22
				, ISNULL(SUM( S23 ),0)					AS S23
				, ISNULL(SUM( S24 ),0)					AS S24
				, ISNULL(SUM( S25 ),0)					AS S25
				, ISNULL(SUM( S26 ),0)					AS S26
				, ISNULL(SUM( S27 ),0)					AS S27
				, ISNULL(SUM( S28 ),0)					AS S28
				, ISNULL(SUM( S29 ),0)					AS S29
				, ISNULL(SUM( S30 ),0)					AS S30
				, ISNULL(SUM( S31 ),0)					AS S31
				, ISNULL(SUM( S32 ),0)					AS S32
				, ISNULL(SUM( S33 ),0)					AS S33
				, ISNULL(SUM( S34 ),0)					AS S34
				, ISNULL(SUM( S35 ),0)					AS S35
				, ISNULL(SUM( S36 ),0)					AS S36
				, ISNULL(SUM( S37 ),0)					AS S37
				, ISNULL(SUM( S38 ),0)					AS S38
				, ISNULL(SUM( S39 ),0)					AS S39
				, ISNULL(SUM( S40 ),0)					AS S40
				
				, ISNULL(SUM( D1 ),0)					AS D1
				, ISNULL(SUM( D2 ),0)					AS D2
				, ISNULL(SUM( D3 ),0)					AS D3
				, ISNULL(SUM( D4 ),0)					AS D4
				, ISNULL(SUM( D5 ),0)					AS D5
				, ISNULL(SUM( D6 ),0)					AS D6
				, ISNULL(SUM( D7 ),0)					AS D7
				, ISNULL(SUM( D8 ),0)					AS D8
				, ISNULL(SUM( D9 ),0)					AS D9
				, ISNULL(SUM( D10 ),0)					AS D10
				, ISNULL(SUM( D11 ),0)					AS D11
				, ISNULL(SUM( D12 ),0)					AS D12
				, ISNULL(SUM( D13 ),0)					AS D13
				, ISNULL(SUM( D14 ),0)					AS D14
				, ISNULL(SUM( D15 ),0)					AS D15
				, ISNULL(SUM( D16 ),0)					AS D16
				, ISNULL(SUM( D17 ),0)					AS D17
				, ISNULL(SUM( D18 ),0)					AS D18
				, ISNULL(SUM( D19 ),0)					AS D19
				, ISNULL(SUM( D20 ),0)					AS D20
		  FROM #HPA955SKR_160405
		 WHERE GUBUN = '1'
         GROUP BY COMP_CODE, PAY_YYYYMM, SUPP_TYPE, SUPP_NAME
		 ORDER BY COMP_CODE, PAY_YYYYMM, SUPP_TYPE, DIV_CODE, DEPT_CODE, GUBUN
		 
		/* 지급일별 합계 INSERT */
		 INSERT INTO #HPA955SKR_160405
		       (GUBUN           , COMP_CODE		, PAY_YYYYMM		, SUPP_TYPE		, SUPP_NAME     , DIV_CODE			, DEPT_CODE
			  , DEPT_NAME		, PERSON_CNT	, SUPP_TOTAL_I		, DED_TOTAL_I	, REAL_AMOUNT_I	, BUSI_SHARE_I		, WORKER_COMPEN_I

		      , S1              , S2            , S3                , S4            , S5
		      , S6              , S7            , S8                , S9            , S10
		      , S11             , S12           , S13               , S14           , S15
		      , S16             , S17           , S18               , S19           , S20
		      , S21             , S22           , S23               , S24           , S25
		      , S26             , S27           , S28               , S29           , S30
		      , S31             , S32           , S33               , S34           , S35
		      , S36             , S37           , S38               , S39           , S40
		
		      , D1              , D2            , D3                , D4            , D5
		      , D6              , D7            , D8                , D9            , D10
		      , D11             , D12           , D13               , D14           , D15
		      , D16             , D17           , D18               , D19           , D20
		       )
		 SELECT   '4'									AS GUBUN
				, COMP_CODE								AS COMP_CODE
				, PAY_YYYYMM							AS PAY_YYYYMM
				, 'Z'									AS SUPP_TYPE
				, ''									AS SUPP_NAME 
				, 'Z'									AS DIV_CODE
				, 'Z'									AS DEPT_CODE
				, ''									AS DEPT_NAME
				, ISNULL(SUM( PERSON_CNT ),0)			AS PERSON_CNT
				, ISNULL(SUM( SUPP_TOTAL_I ),0)			AS SUPP_TOTAL_I
				, ISNULL(SUM( DED_TOTAL_I ),0)			AS DED_TOTAL_I 
				, ISNULL(SUM( REAL_AMOUNT_I ),0)		AS REAL_AMOUNT_I
				, ISNULL(SUM( BUSI_SHARE_I ),0)			AS BUSI_SHARE_I
				, ISNULL(SUM( WORKER_COMPEN_I ),0)		AS WORKER_COMPEN_I
				, ISNULL(SUM( S1 ),0)					AS S1
				, ISNULL(SUM( S2 ),0)					AS S2
				, ISNULL(SUM( S3 ),0)					AS S3
				, ISNULL(SUM( S4 ),0)					AS S4
				, ISNULL(SUM( S5 ),0)					AS S5
				, ISNULL(SUM( S6 ),0)					AS S6
				, ISNULL(SUM( S7 ),0)					AS S7
				, ISNULL(SUM( S8 ),0)					AS S8
				, ISNULL(SUM( S9 ),0)					AS S9
				, ISNULL(SUM( S10 ),0)					AS S10
				, ISNULL(SUM( S11 ),0)					AS S11
				, ISNULL(SUM( S12 ),0)					AS S12
				, ISNULL(SUM( S13 ),0)					AS S13
				, ISNULL(SUM( S14 ),0)					AS S14
				, ISNULL(SUM( S15 ),0)					AS S15
				, ISNULL(SUM( S16 ),0)					AS S16
				, ISNULL(SUM( S17 ),0)					AS S17
				, ISNULL(SUM( S18 ),0)					AS S18
				, ISNULL(SUM( S19 ),0)					AS S19
				, ISNULL(SUM( S20 ),0)					AS S20
				, ISNULL(SUM( S21 ),0)					AS S21
				, ISNULL(SUM( S22 ),0)					AS S22
				, ISNULL(SUM( S23 ),0)					AS S23
				, ISNULL(SUM( S24 ),0)					AS S24
				, ISNULL(SUM( S25 ),0)					AS S25
				, ISNULL(SUM( S26 ),0)					AS S26
				, ISNULL(SUM( S27 ),0)					AS S27
				, ISNULL(SUM( S28 ),0)					AS S28
				, ISNULL(SUM( S29 ),0)					AS S29
				, ISNULL(SUM( S30 ),0)					AS S30
				, ISNULL(SUM( S31 ),0)					AS S31
				, ISNULL(SUM( S32 ),0)					AS S32
				, ISNULL(SUM( S33 ),0)					AS S33
				, ISNULL(SUM( S34 ),0)					AS S34
				, ISNULL(SUM( S35 ),0)					AS S35
				, ISNULL(SUM( S36 ),0)					AS S36
				, ISNULL(SUM( S37 ),0)					AS S37
				, ISNULL(SUM( S38 ),0)					AS S38
				, ISNULL(SUM( S39 ),0)					AS S39
				, ISNULL(SUM( S40 ),0)					AS S40
				
				, ISNULL(SUM( D1 ),0)					AS D1
				, ISNULL(SUM( D2 ),0)					AS D2
				, ISNULL(SUM( D3 ),0)					AS D3
				, ISNULL(SUM( D4 ),0)					AS D4
				, ISNULL(SUM( D5 ),0)					AS D5
				, ISNULL(SUM( D6 ),0)					AS D6
				, ISNULL(SUM( D7 ),0)					AS D7
				, ISNULL(SUM( D8 ),0)					AS D8
				, ISNULL(SUM( D9 ),0)					AS D9
				, ISNULL(SUM( D10 ),0)					AS D10
				, ISNULL(SUM( D11 ),0)					AS D11
				, ISNULL(SUM( D12 ),0)					AS D12
				, ISNULL(SUM( D13 ),0)					AS D13
				, ISNULL(SUM( D14 ),0)					AS D14
				, ISNULL(SUM( D15 ),0)					AS D15
				, ISNULL(SUM( D16 ),0)					AS D16
				, ISNULL(SUM( D17 ),0)					AS D17
				, ISNULL(SUM( D18 ),0)					AS D18
				, ISNULL(SUM( D19 ),0)					AS D19
				, ISNULL(SUM( D20 ),0)					AS D20
		  FROM #HPA955SKR_160405
		 WHERE GUBUN = '1'
         GROUP BY COMP_CODE, PAY_YYYYMM
		 ORDER BY COMP_CODE, PAY_YYYYMM, SUPP_TYPE, DIV_CODE, DEPT_CODE, GUBUN

		/* 총계 INSERT */
		 INSERT INTO #HPA955SKR_160405
		       (GUBUN           , COMP_CODE		, PAY_YYYYMM		, SUPP_TYPE		, SUPP_NAME     , DIV_CODE			, DEPT_CODE
			  , DEPT_NAME		, PERSON_CNT	, SUPP_TOTAL_I		, DED_TOTAL_I	, REAL_AMOUNT_I	, BUSI_SHARE_I		, WORKER_COMPEN_I

		      , S1              , S2            , S3                , S4            , S5
		      , S6              , S7            , S8                , S9            , S10
		      , S11             , S12           , S13               , S14           , S15
		      , S16             , S17           , S18               , S19           , S20
		      , S21             , S22           , S23               , S24           , S25
		      , S26             , S27           , S28               , S29           , S30
		      , S31             , S32           , S33               , S34           , S35
		      , S36             , S37           , S38               , S39           , S40
		
		      , D1              , D2            , D3                , D4            , D5
		      , D6              , D7            , D8                , D9            , D10
		      , D11             , D12           , D13               , D14           , D15
		      , D16             , D17           , D18               , D19           , D20
		       )
		 SELECT   '5'									AS GUBUN
				, COMP_CODE								AS COMP_CODE
				, '999999'								AS PAY_YYYYMM
				, 'Z'									AS SUPP_TYPE
				, ''									AS SUPP_NAME 
				, 'Z'									AS DIV_CODE
				, 'Z'									AS DEPT_CODE
				, ''									AS DEPT_NAME
				, ISNULL(SUM( PERSON_CNT ),0)			AS PERSON_CNT
				, ISNULL(SUM( SUPP_TOTAL_I ),0)			AS SUPP_TOTAL_I
				, ISNULL(SUM( DED_TOTAL_I ),0)			AS DED_TOTAL_I 
				, ISNULL(SUM( REAL_AMOUNT_I ),0)		AS REAL_AMOUNT_I
				, ISNULL(SUM( BUSI_SHARE_I ),0)			AS BUSI_SHARE_I
				, ISNULL(SUM( WORKER_COMPEN_I ),0)		AS WORKER_COMPEN_I
				, ISNULL(SUM( S1 ),0)					AS S1
				, ISNULL(SUM( S2 ),0)					AS S2
				, ISNULL(SUM( S3 ),0)					AS S3
				, ISNULL(SUM( S4 ),0)					AS S4
				, ISNULL(SUM( S5 ),0)					AS S5
				, ISNULL(SUM( S6 ),0)					AS S6
				, ISNULL(SUM( S7 ),0)					AS S7
				, ISNULL(SUM( S8 ),0)					AS S8
				, ISNULL(SUM( S9 ),0)					AS S9
				, ISNULL(SUM( S10 ),0)					AS S10
				, ISNULL(SUM( S11 ),0)					AS S11
				, ISNULL(SUM( S12 ),0)					AS S12
				, ISNULL(SUM( S13 ),0)					AS S13
				, ISNULL(SUM( S14 ),0)					AS S14
				, ISNULL(SUM( S15 ),0)					AS S15
				, ISNULL(SUM( S16 ),0)					AS S16
				, ISNULL(SUM( S17 ),0)					AS S17
				, ISNULL(SUM( S18 ),0)					AS S18
				, ISNULL(SUM( S19 ),0)					AS S19
				, ISNULL(SUM( S20 ),0)					AS S20
				, ISNULL(SUM( S21 ),0)					AS S21
				, ISNULL(SUM( S22 ),0)					AS S22
				, ISNULL(SUM( S23 ),0)					AS S23
				, ISNULL(SUM( S24 ),0)					AS S24
				, ISNULL(SUM( S25 ),0)					AS S25
				, ISNULL(SUM( S26 ),0)					AS S26
				, ISNULL(SUM( S27 ),0)					AS S27
				, ISNULL(SUM( S28 ),0)					AS S28
				, ISNULL(SUM( S29 ),0)					AS S29
				, ISNULL(SUM( S30 ),0)					AS S30
				, ISNULL(SUM( S31 ),0)					AS S31
				, ISNULL(SUM( S32 ),0)					AS S32
				, ISNULL(SUM( S33 ),0)					AS S33
				, ISNULL(SUM( S34 ),0)					AS S34
				, ISNULL(SUM( S35 ),0)					AS S35
				, ISNULL(SUM( S36 ),0)					AS S36
				, ISNULL(SUM( S37 ),0)					AS S37
				, ISNULL(SUM( S38 ),0)					AS S38
				, ISNULL(SUM( S39 ),0)					AS S39
				, ISNULL(SUM( S40 ),0)					AS S40
				
				, ISNULL(SUM( D1 ),0)					AS D1
				, ISNULL(SUM( D2 ),0)					AS D2
				, ISNULL(SUM( D3 ),0)					AS D3
				, ISNULL(SUM( D4 ),0)					AS D4
				, ISNULL(SUM( D5 ),0)					AS D5
				, ISNULL(SUM( D6 ),0)					AS D6
				, ISNULL(SUM( D7 ),0)					AS D7
				, ISNULL(SUM( D8 ),0)					AS D8
				, ISNULL(SUM( D9 ),0)					AS D9
				, ISNULL(SUM( D10 ),0)					AS D10
				, ISNULL(SUM( D11 ),0)					AS D11
				, ISNULL(SUM( D12 ),0)					AS D12
				, ISNULL(SUM( D13 ),0)					AS D13
				, ISNULL(SUM( D14 ),0)					AS D14
				, ISNULL(SUM( D15 ),0)					AS D15
				, ISNULL(SUM( D16 ),0)					AS D16
				, ISNULL(SUM( D17 ),0)					AS D17
				, ISNULL(SUM( D18 ),0)					AS D18
				, ISNULL(SUM( D19 ),0)					AS D19
				, ISNULL(SUM( D20 ),0)					AS D20
		  FROM #HPA955SKR_160405
		 WHERE GUBUN = '1'
         GROUP BY COMP_CODE
		 ORDER BY COMP_CODE, PAY_YYYYMM, SUPP_TYPE, DIV_CODE, DEPT_CODE, GUBUN
		 
		/* Data 불러오기 */
		SELECT * FROM #HPA955SKR_160405
		 ORDER BY COMP_CODE, PAY_YYYYMM, SUPP_TYPE, DIV_CODE, DEPT_CODE, GUBUN
			
	</select>
	
</mapper>