<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="agb111rkrServiceImpl">
<select id="agb111rkrServiceImpl.selectListTo111rkrPrint" parameterType="Map" resultType="rMap">
		
		--agb110skr.Cagb111rkr, [FNAGB111R] Query3
		   SET NOCOUNT ON
		   SET ARITHABORT ON
		   ------- 1. 변수 선언
	    DECLARE @COMP_CODE      NVARCHAR(08)

	          ,@ACCNT_DIVI NVARCHAR(03)
	          ,@START_DATE	NVARCHAR(12)
	          ,@AC_DATE_FR	NVARCHAR(12)
	          ,@AC_DATE_TO  NVARCHAR(12)
	          
			  ,@AC_DATA1   	NVARCHAR(30)	-- 20201014 추가 
			  ,@ACCNT		NVARCHAR(08)	-- 20201014 추가

		      ,@ACCNT_DIV_CODE NVARCHAR(255)
			  ,@DIV_NAME NVARCHAR(255)
			  ,@FR_DEPT_CODE NVARCHAR(255)
			  ,@TO_DEPT_CODE NVARCHAR(255)
			  ,@POSTIT NVARCHAR(255)
			  ,@CHARGE_CODE NVARCHAR(255)
			  ,@CUSTOM_CODE NVARCHAR(255)
			  ,@REMARK NVARCHAR(255)
			  ,@CUSTOM_NAME NVARCHAR(255)
			  ,@FR_AMT_I NUMERIC(30, 6)
			  ,@TO_AMT_I NUMERIC(30, 6)
			  ,@FR_FOR_AMT_I NUMERIC(30, 6)
			  ,@TO_FOR_AMT_I NUMERIC(30, 6)
			  ,@msgBalance NVARCHAR(255)
			  ,@msgDealTotal NVARCHAR(255)
			  
        SET     @COMP_CODE      = #{S_COMP_CODE}      
        SET     @AC_DATE_FR      = #{AC_DATE_FR}      
        SET     @AC_DATE_TO      = #{AC_DATE_TO}
        
        
        
		SET @ACCNT_DIVI  = #{ACCNT_DIVI}
		SET @START_DATE  = #{START_DATE}

		SET @ACCNT_DIV_CODE  = #{ACCNT_DIV_CODE}
		SET @DIV_NAME  = #{DIV_NAME}
		SET @FR_DEPT_CODE   = #{FR_DEPT_CODE}
	    SET @TO_DEPT_CODE   = #{TO_DEPT_CODE}
	    SET @POSTIT   = #{POSTIT}
	    SET @CHARGE_CODE   = #{CHARGE_CODE}
	    SET @CUSTOM_CODE   = #{CUSTOM_CODE}
	    SET @REMARK   = #{REMARK}
	    SET @CUSTOM_NAME   = #{CUSTOM_NAME}
	    
	    SET     @FR_AMT_I       = #{FR_AMT_I}
	    SET     @TO_AMT_I       = #{TO_AMT_I}
	    SET     @FR_FOR_AMT_I   = #{FR_FOR_AMT_I}
	    SET     @TO_FOR_AMT_I   = #{TO_FOR_AMT_I}
	    
	    SET		@AC_DATA1		= #{AC_DATA1}
	    SET 	@ACCNT			= NULL
	    
	    SELECT TOP 1 @msgBalance = MSG_DESC
		FROM   BSA010T   WITH (NOLOCK)                       
		WHERE  MSG_TYPE = '1'                 
		AND    MSG_NO ='A0139';
		   
		SELECT TOP 1 @msgDealTotal = MSG_DESC
		FROM   BSA010T    WITH (NOLOCK)                      
		WHERE  MSG_TYPE = '1'                 
		AND    MSG_NO ='A0141';

		IF(@AC_DATA1 IS NOT NULL)			-- 20201014 추가
			SET @ACCNT = (
							SELECT AC_CODE1
							FROM   ABA400T
							WHERE  ACCNT = @AC_DATA1
						  )
			
			
			
		IF(@ACCNT != '' OR @ACCNT IS NULL)
			BEGIN
				SELECT ' ' AS AC_DATE
				      , 0 AS SLIP_NUM
				      , 0 AS SLIP_SEQ
				      , CONVERT(NVARCHAR(50), @msgBalance) AS REMARK
				      , ACCNT
				      , ISNULL((SELECT ACCNT_NAME
				                  FROM ABA400T  WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND ACCNT     = A.ACCNT),' ') AS ACCNT_NAME
				      , '' CUSTOM_NAME
				      , '' P_ACCNT_NAME
				      , ISNULL(SUM(DR_AMT_I),0.0) AS DR_AMT_I
				      , ISNULL(SUM(CR_AMT_I),0.0) AS CR_AMT_I
				      , ISNULL(CASE (SELECT JAN_DIVI 
				                       FROM ABA400T  WITH (NOLOCK)
				                      WHERE COMP_CODE = @COMP_CODE
				                        AND ACCNT     = A.ACCNT)
				                    WHEN '1' 
				                         THEN SUM(DR_AMT_I) - SUM(CR_AMT_I)
				                    WHEN '2' 
				                         THEN SUM(CR_AMT_I) - SUM(DR_AMT_I)
				                END,0.0) AS JAN_AMT_I
				      , '' AS MONEY_UNIT
				      , 0 AS FOR_AMT_I
				      , '2' AS GUBUN
				      , 'N' AS POSTIT_YN
				      , '' AS POSTIT
				      , '' AS MOD_DIVI
				      , ISNULL((SELECT AC_NAME 
				                  FROM ABA200T   WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND AC_CD     = A.BOOK_CODE1),' ') AS BOOK_CODE1
				      , ISNULL(BOOK_DATA1, ' ') AS BOOK_DATA1
				      , ISNULL((SELECT AC_NAME 
				                  FROM ABA200TV   WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND AC_CODE   = A.BOOK_CODE1
				                   AND AC_DATA   = A.BOOK_DATA1), ' ') AS BOOK_NAME1
				      , ISNULL((SELECT AC_NAME 
				                  FROM ABA200T  WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND AC_CD     = A.BOOK_CODE2),' ') AS BOOK_CODE2
				      , ISNULL(BOOK_DATA2, ' ') AS BOOK_DATA2
				      , ISNULL((SELECT AC_NAME 
				                  FROM ABA200TV  WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND AC_CODE   = A.BOOK_CODE2
				                   AND AC_DATA   = A.BOOK_DATA2), ' ') AS BOOK_NAME2
				   FROM 
				   <if test='ACCNT_DIVI == "1"'>
					(SELECT A.AC_DATE
					      , A.DIV_CODE
					      , A.DEPT_CODE
					      , B.ACCNT_CD ACCNT
					      , DR_AMT_I
					      , CR_AMT_I
					      , A.JAN_DIVI
					      , A.BOOK_CODE1
					      , A.BOOK_DATA1
					      , A.BOOK_CODE2
					      , A.BOOK_DATA2
					      , INPUT_PATH
					      , MONEY_UNIT
					      , '' CHARGE_CODE
					   FROM AGB200TV A  WITH (NOLOCK)
					      , ABA400T  B  WITH (NOLOCK)
					  WHERE A.COMP_CODE = @COMP_CODE
					    AND B.COMP_CODE = @COMP_CODE
					    AND A.ACCNT     = B.ACCNT)
				   </if>
				   <if test= 'ACCNT_DIVI != "1"'>
					   	(SELECT A.* 
					        FROM AGB200TV A  WITH (NOLOCK), ABA400T  B  WITH (NOLOCK)
				     	  WHERE A.COMP_CODE    = @COMP_CODE
					        AND B.COMP_CODE    = @COMP_CODE
					        AND A.ACCNT        = B.ACCNT
					        AND B.SUBJECT_DIVI = '2')
				   </if>
				     A, BOR120T B
				  WHERE B.COMP_CODE = @COMP_CODE
				    AND A.AC_DATE  &gt;= @START_DATE
				    AND A.DIV_CODE  = B.DIV_CODE
				    AND AC_DATE     &lt; @AC_DATE_FR
				    -- AND (ISNULL(BOOK_CODE1, '') &lt;&gt; '' OR ISNULL(BOOK_CODE2,'')&lt;&gt;'')
		---sSqlWhere
			<if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		            AND (ACCNT &gt;= #{FR_ACCNT_CODE}
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB1)">
		        	AND NOT (ACCNT = #{FR_ACCNT_CODE} AND BOOK_DATA1 &lt; #{FR_ACCNT_CODE_SUB1})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB2)">
		            AND NOT (ACCNT = #{FR_ACCNT_CODE}  AND BOOK_DATA2 &lt; #{FR_ACCNT_CODE_SUB2})
		        </if>
		  </if>
		  
		  <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		       <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE)">
		       	 	AND (ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if> 
		       <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		       	 	AND ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if>       
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB3)">
		        	AND NOT (ACCNT = #{TO_ACCNT_CODE} AND BOOK_DATA1 &gt; #{TO_ACCNT_CODE_SUB3})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB4)">
		            AND NOT (ACCNT = #{TO_ACCNT_CODE}  AND BOOK_DATA2 &gt; #{TO_ACCNT_CODE_SUB4})
		        </if>
		  </if>
		    
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB111)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB111}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB112}
		   		 </if>
		   		 )
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB121}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB122)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB122}
		   		 </if>
		   		 )
		   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB131)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB131}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB132)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB132}
			   		 </if>
			   		 )
			   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE3)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB141)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB141}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB142)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB142}
			   		 </if>
			   		 )
			   </if>
		
		    <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)  or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)">
			   			  )
			 </if> 
		   
		     <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		     		<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE1)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE1} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB11)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB11}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB12)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB12}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE2)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE2} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB21)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB21}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB22)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB22}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE3)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE3} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB31)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB31}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB32)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB32}
			        	</if>
			        	)
		        	</if>
		         -- <if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				 --		AND CHARGE_CODE = @CHARGE_CODE
				 --	</if>
		     </if>
		----END sSqlWhere 
		<if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">
				AND A.DIV_CODE IN (#{ACCNT_DIV_CODE})
			</if>
			<if test="@foren.Ognl@isNotEmpty(DIV_NAME)">
				 AND B.DIV_NAME LIKE N'%'+@DIV_NAME+'%'    
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_DEPT_CODE)">
				AND DEPT_CODE &gt;= @FR_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_DEPT_CODE)">
				AND DEPT_CODE &lt;= @TO_DEPT_CODE
			</if>
			
				 GROUP BY ACCNT, BOOK_CODE1, BOOK_CODE2, JAN_DIVI, BOOK_DATA1
				        , BOOK_DATA2
				HAVING SUM(DR_AMT_I) &lt;&gt; 0 OR SUM(CR_AMT_I) &lt;&gt; 0
				 UNION ALL 
				SELECT '' AS AC_DATE
				     , NULL AS SLIP_NUM
				     , NULL AS SLIP_SEQ
				     , CONVERT(NVARCHAR(20), @msgDealTotal) AS REMARK
				     , ACCNT
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND ACCNT     = A.ACCNT),'') AS ACCNT_NAME
				     , '' AS CUSTOM_NAME 
				     , '' AS P_ACCNT_NAME
				     , ISNULL(SUM(DR_AMT_I),0.0) AS DR_AMT_I
				     , ISNULL(SUM(CR_AMT_I),0.0) AS CR_AMT_I
				     , ISNULL(CASE (SELECT JAN_DIVI 
				                      FROM ABA400T  WITH (NOLOCK)
				                     WHERE COMP_CODE = @COMP_CODE
				                       AND ACCNT     = A.ACCNT)
				                   WHEN '1' 
				                        THEN SUM(DR_AMT_I) - SUM(CR_AMT_I)
				                   WHEN '2' 
				                        THEN SUM(CR_AMT_I) - SUM(DR_AMT_I)
				               END,0.0) JAN_AMT_I
				     , '' AS MONEY_UNIT
				     , NULL AS FOR_AMT_I
				     , '2' AS GUBUN
				     , 'N' AS POSTIT_YN
				     , '' AS POSTIT
				     , '' AS MOD_DIVI
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200T   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CD     = A.BOOK_CODE1),'') AS BOOK_CODE1
				     , ISNULL(BOOK_DATA1, '') AS BOOK_DATA1
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE1 
				                  AND AC_DATA   = A.BOOK_DATA1), '') AS BOOK_NAME1
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CD     = A.BOOK_CODE2),'') AS BOOK_CODE2
				     , ISNULL(BOOK_DATA2, '') AS BOOK_DATA2
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE2 
				                  AND AC_DATA   = A.BOOK_DATA2), '') AS BOOK_NAME2
				  FROM 
				    <if test='ACCNT_DIVI == "1"'>
					(SELECT A.AC_DATE
					      , A.DIV_CODE
					      , A.DEPT_CODE
					      , B.ACCNT_CD ACCNT
					      , DR_AMT_I
					      , CR_AMT_I
					      , A.JAN_DIVI
					      , A.BOOK_CODE1
					      , A.BOOK_DATA1
					      , A.BOOK_CODE2
					      , A.BOOK_DATA2
					      , INPUT_PATH
					      , MONEY_UNIT
					      , '' CHARGE_CODE
					   FROM AGB200TV A  WITH (NOLOCK)
					      , ABA400T  B  WITH (NOLOCK)
					  WHERE A.COMP_CODE = @COMP_CODE
					    AND B.COMP_CODE = @COMP_CODE
					    AND A.ACCNT     = B.ACCNT)
				   </if>
				   <if test= 'ACCNT_DIVI != "1"'>
					   	(SELECT A.* 
					        FROM AGB200TV A  WITH (NOLOCK), ABA400T  B  WITH (NOLOCK)
				     	  WHERE A.COMP_CODE    = @COMP_CODE
					        AND B.COMP_CODE    = @COMP_CODE
					        AND A.ACCNT        = B.ACCNT
					        AND B.SUBJECT_DIVI = '2')
				   </if>
				     A, BOR120T B  WITH (NOLOCK)
				 WHERE B.COMP_CODE  = @COMP_CODE
				   AND A.AC_DATE BETWEEN @AC_DATE_FR
				                     AND @AC_DATE_TO
				   AND A.DIV_CODE   = B.DIV_CODE
				   AND INPUT_PATH   = 'A1' 
				   AND LEN(AC_DATE) = 6
				   -- AND (ISNULL(BOOK_CODE1, '') &lt;&gt;'' OR ISNULL(BOOK_CODE2,'') &lt;&gt;'') 
		---sSqlWhere
			<if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		            AND (ACCNT &gt;= #{FR_ACCNT_CODE}
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB1)">
		        	AND NOT (ACCNT = #{FR_ACCNT_CODE} AND BOOK_DATA1 &lt; #{FR_ACCNT_CODE_SUB1})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB2)">
		            AND NOT (ACCNT = #{FR_ACCNT_CODE}  AND BOOK_DATA2 &lt; #{FR_ACCNT_CODE_SUB2})
		        </if>
		  </if>
		  
		  <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		       <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE)">
		       	 	AND (ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if> 
		       <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		       	 	AND ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if>       
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB3)">
		        	AND NOT (ACCNT = #{TO_ACCNT_CODE} AND BOOK_DATA1 &gt; #{TO_ACCNT_CODE_SUB3})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB4)">
		            AND NOT (ACCNT = #{TO_ACCNT_CODE}  AND BOOK_DATA2 &gt; #{TO_ACCNT_CODE_SUB4})
		        </if>
		  </if>
		    
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB111)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB111}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB112}
		   		 </if>
		   		 )
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB121}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB122)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB122}
		   		 </if>
		   		 )
		   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB131)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB131}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB132)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB132}
			   		 </if>
			   		 )
			   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE3)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB141)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB141}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB142)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB142}
			   		 </if>
			   		 )
			   </if>
		
		    <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)  or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)">
			   			  )
			 </if> 
		   
		     <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		     		<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE1)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE1} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB11)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB11}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB12)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB12}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE2)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE2} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB21)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB21}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB22)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB22}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE3)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE3} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB31)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB31}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB32)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB32}
			        	</if>
			        	)
		        	</if>
		         -- <if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				 --		AND CHARGE_CODE = @CHARGE_CODE
				 --	</if>
		     </if>
		----END sSqlWhere 
		   <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">
				AND A.DIV_CODE IN (#{ACCNT_DIV_CODE})
			</if>
			<if test="@foren.Ognl@isNotEmpty(DIV_NAME)">
				 AND B.DIV_NAME LIKE N'%'+@DIV_NAME+'%'     
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_DEPT_CODE)">
				AND DEPT_CODE &gt;= @FR_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_DEPT_CODE)">
				AND DEPT_CODE &lt;= @TO_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				AND CHARGE_CODE = @CHARGE_CODE
			</if>
			
				 GROUP BY ACCNT, BOOK_CODE1, BOOK_CODE2, JAN_DIVI, BOOK_DATA1
				        , BOOK_DATA2
				HAVING SUM(DR_AMT_I) &lt;&gt; 0 OR SUM(CR_AMT_I) &lt;&gt; 0
				 
				 UNION ALL 
				 
				SELECT unilite.fnGetUserDateComp(@COMP_CODE, ac_date) AS AC_DATE
				     , SLIP_NUM
				     , SLIP_SEQ
				     , ISNULL(SUBSTRING(REMARK, 0, 50),'') AS REMARK                                                
				     , A.ACCNT
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND ACCNT     = A.ACCNT),'') AS ACCNT_NAME
				     , CASE WHEN ISNULL(A.CUSTOM_CODE,'')  &lt;&gt;  '' 
				                 THEN (SELECT CUSTOM_NAME 
				                         FROM BCM100T  WITH (NOLOCK)
				                        WHERE COMP_CODE   = @COMP_CODE
				                          AND CUSTOM_CODE = A.CUSTOM_CODE)
				                 ELSE ISNULL(A.CUSTOM_NAME, '') 
				        END AS CUSTOM_NAME
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND ACCNT     = A.P_ACCNT),'') AS P_ACCNT_NAME
				     , CASE DR_CR WHEN '1' 
				                       THEN AMT_I
				                  WHEN '2' 
				                       THEN 0.0
				        END AS DR_AMT_I
				     , CASE DR_CR WHEN '1' 
				                       THEN 0.0
				                  WHEN '2' 
				                       THEN AMT_I
				        END AS CR_AMT_I
				     , CASE JAN_DIVI WHEN DR_CR 
				                          THEN AMT_I
				                          ELSE -1 * AMT_I
				        END AS JAN_AMT_I
				     , MONEY_UNIT
				     , FOR_AMT_I
				     , '1' AS GUBUN
				     , ISNULL(POSTIT_YN,'N') AS POSTIT_YN
				     , ISNULL(POSTIT,'') AS POSTIT
				     , ISNULL(MOD_DIVI, 'N') AS MOD_DIVI
				     , (SELECT AC_NAME 
				          FROM ABA200T  WITH (NOLOCK)
				         WHERE COMP_CODE = @COMP_CODE
				           AND AC_CD     = A.BOOK_CODE1) AS BOOK_CODE1
				     , BOOK_DATA1
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE1
				                  AND AC_DATA   = A.BOOK_DATA1), '') AS BOOK_NAME1
				     , (SELECT AC_NAME 
				          FROM ABA200T   WITH (NOLOCK)
				         WHERE COMP_CODE = @COMP_CODE
				           AND AC_CD     = A.BOOK_CODE2) AS BOOK_CODE2
				     , BOOK_DATA2
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE2
				                  AND AC_DATA   = A.BOOK_DATA2), '') AS BOOK_NAME2 
				  FROM 
				
				 <if test='ACCNT_DIVI == "1"'>
				 	(SELECT DIV_CODE
				      , AC_DATE
				      , SLIP_NUM
				      , SLIP_SEQ
				      , REMARK
				      , (SELECT ACCNT_CD
				           FROM ABA400T  WITH (NOLOCK)
				          WHERE COMP_CODE = A.COMP_CODE
				            AND ACCNT     = A.ACCNT) ACCNT
				      , CUSTOM_CODE
				      , CUSTOM_NAME
				      , P_ACCNT
				      , BOOK_CODE1
				      , BOOK_DATA1
				      , BOOK_CODE2
				      , BOOK_DATA2
				      , DEPT_CODE
				      , DR_CR
				      , AMT_I
				      , JAN_DIVI
				      , POSTIT_YN
				      , POSTIT
				      , MOD_DIVI
				      , MOD_DATE
				      , INPUT_PATH
				      , CHARGE_CODE
				      , MONEY_UNIT
				      , FOR_AMT_I 
				   FROM AGJ210T A  WITH (NOLOCK)
				  WHERE A.COMP_CODE = @COMP_CODE)
				 </if>
				 <if test= 'ACCNT_DIVI != "1"'>
				 	(SELECT A.DIV_CODE 
		                 , A.AC_DATE 
		                 , A.SLIP_NUM 
		                 , A.SLIP_SEQ 
		                 , A.REMARK 
		                 , A.ACCNT 
		                 , A.CUSTOM_CODE 
		                 , A.CUSTOM_NAME 
		                 , A.P_ACCNT 
		                 , A.BOOK_CODE1 
		                 , A.BOOK_DATA1 
		                 , A.BOOK_CODE2 
		                 , A.BOOK_DATA2 
		                 , A.DEPT_CODE 
		                 , A.DR_CR 
		                 , A.AMT_I 
		                 , A.JAN_DIVI 
		                 , A.POSTIT_YN 
		                 , A.POSTIT 
		                 , A.MOD_DIVI 
		                 , A.MOD_DATE 
		                 , A.INPUT_PATH 
		                 , A.CHARGE_CODE 
		                 , A.MONEY_UNIT 
		                 , A.FOR_AMT_I 
		              FROM AGJ210T A   WITH (NOLOCK)
		                 , ABA400T B   WITH (NOLOCK) 
		             WHERE A.COMP_CODE    = @COMP_CODE
		               AND B.COMP_CODE    = @COMP_CODE
		               AND A.ACCNT        = B.ACCNT 
		               AND B.SUBJECT_DIVI = '2')
				 </if>
				   A, BOR120T B
				 WHERE B.COMP_CODE = @COMP_CODE
				   AND AC_DATE Between @AC_DATE_FR AND @AC_DATE_TO
				   AND A.DIV_CODE = B.DIV_CODE
				-- AND (BOOK_CODE1 &lt;&gt; '' OR BOOK_CODE2 &lt;&gt; '')
				-- AND ((ISNULL(A.AMT_I,0.0) &gt;= @FR_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@FR_AMT_I IS NULL))
			    -- AND ((ISNULL(A.AMT_I,0.0) &lt;= @TO_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@TO_AMT_I IS NULL))
				-- AND ((ISNULL(A.FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I AND @FR_FOR_AMT_I IS NOT NULL) OR (@FR_FOR_AMT_I IS NULL))
				-- AND ((ISNULL(A.FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I AND @TO_FOR_AMT_I IS NOT NULL) OR (@TO_FOR_AMT_I IS NULL))
				-- AND ((A.REMARK LIKE '%' + ISNULL(@REMARK,'')+ '%' AND ISNULL(@REMARK,'') != '') OR (ISNULL(@REMARK,'') = ''))
		---sSqlWhere
			<if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		            AND (ACCNT &gt;= #{FR_ACCNT_CODE}
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB1)">
		        	AND NOT (ACCNT = #{FR_ACCNT_CODE} AND BOOK_DATA1 &lt; #{FR_ACCNT_CODE_SUB1})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB2)">
		            AND NOT (ACCNT = #{FR_ACCNT_CODE}  AND BOOK_DATA2 &lt; #{FR_ACCNT_CODE_SUB2})
		        </if>
		  </if>
		  
		  <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		       <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE)">
		       	 	AND (ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if> 
		       <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		       	 	AND ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if>       
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB3)">
		        	AND NOT (ACCNT = #{TO_ACCNT_CODE} AND BOOK_DATA1 &gt; #{TO_ACCNT_CODE_SUB3})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB4)">
		            AND NOT (ACCNT = #{TO_ACCNT_CODE}  AND BOOK_DATA2 &gt; #{TO_ACCNT_CODE_SUB4})
		        </if>
		  </if>
		    
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB111)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB111}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB112}
		   		 </if>
		   		 )
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB121}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB122)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB122}
		   		 </if>
		   		 )
		   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB131)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB131}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB132)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB132}
			   		 </if>
			   		 )
			   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE3)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB141)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB141}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB142)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB142}
			   		 </if>
			   		 )
			   </if>
		
		    <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)  or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)">
			   			  )
			 </if> 
		   
		     <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		     		<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE1)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE1} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB11)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB11}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB12)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB12}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE2)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE2} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB21)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB21}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB22)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB22}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE3)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE3} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB31)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB31}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB32)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB32}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
						AND CHARGE_CODE = @CHARGE_CODE
					</if>
		     </if>
		----END sSqlWhere 
		----sSqlWhere2
		    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">
				AND A.DIV_CODE IN (#{ACCNT_DIV_CODE})
			</if>
			<if test="@foren.Ognl@isNotEmpty(DIV_NAME)">
				 AND B.DIV_NAME LIKE N'%'+@DIV_NAME+'%'    
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_DEPT_CODE)">
				AND DEPT_CODE &gt;= @FR_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_DEPT_CODE)">
				AND DEPT_CODE &lt;= @TO_DEPT_CODE
			</if>	 
			<if test='INCLUDE_DELETE == "N"'>
		           AND ISNULL(MOD_DATE,'')  = ''
		    </if>
		    <if test='POSTIT_YN == "Y"'>
		           AND POSTIT_YN = 'Y'
		        <if test="@foren.Ognl@isNotEmpty(POSTIT)">
		          AND POSTIT LIKE @POSTIT +'%'
		        </if>    
		    </if>  
		    <if test="@foren.Ognl@isNotEmpty(FR_AMT_I)">
			 -- AND ISNULL(AMT_I,0.0) &gt;= @FR_AMT_I
				AND ((ISNULL(A.AMT_I,0.0) &gt;= @FR_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@FR_AMT_I IS NULL))
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_AMT_I)">
			 -- AND ISNULL(AMT_I,0.0) &lt;= @TO_AMT_I
				AND ((ISNULL(A.AMT_I,0.0) &lt;= @TO_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@TO_AMT_I IS NULL))
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_FOR_AMT_I)">
			 -- AND ISNULL(FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I
				AND ((ISNULL(A.FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I AND @FR_FOR_AMT_I IS NOT NULL) OR (@FR_FOR_AMT_I IS NULL))
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_FOR_AMT_I)">
			 -- AND ISNULL(FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I
				AND ((ISNULL(A.FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I AND @TO_FOR_AMT_I IS NOT NULL) OR (@TO_FOR_AMT_I IS NULL))
			</if> 	    
			<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				AND CHARGE_CODE = @CHARGE_CODE
			</if>	  
		   <if test="@foren.Ognl@isNotEmpty(REMARK)">
			 -- AND REMARK LIKE N'%'+ @REMARK + '%'
				AND ((A.REMARK LIKE '%' + ISNULL(@REMARK,'')+ '%' AND ISNULL(@REMARK,'') != '') OR (ISNULL(@REMARK,'') = ''))
			</if>	
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)  and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
				AND CUSTOM_CODE = @CUSTOM_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)">
					AND CUSTOM_CODE LIKE '%' + @CUSTOM_CODE + '%'
			</if>
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME)">
					AND CUSTOM_NAME LIKE '%' + @CUSTOM_NAME + '%' 
			</if>	
		----end sSqlWhere2
				 UNION ALL
				SELECT unilite.fnGetUserDateComp(@COMP_CODE, ac_date) AS AC_DATE
				     , SLIP_NUM
				     , SLIP_SEQ
				     , ISNULL(SUBSTRING(REMARK, 0, 50),'') AS REMARK                                                
				     , ACCNT
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE 
				                  AND ACCNT     = A.ACCNT),'') AS ACCNT_NAME
				     , CASE WHEN ISNULL(A.CUSTOM_NAME,'') = '' 
				                 THEN (SELECT CUSTOM_NAME 
				                         FROM BCM100T 
				                        WHERE COMP_CODE   = @COMP_CODE
				                          AND CUSTOM_CODE = A.CUSTOM_CODE)
				                 ELSE ISNULL(A.CUSTOM_NAME, '') 
				        END AS CUSTOM_NAME
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND ACCNT     = A.P_ACCNT),'') AS P_ACCNT_NAME
				     , CASE DR_CR WHEN '1' 
				                       THEN AMT_I
				                  WHEN '2' 
				                       THEN 0.0
				        END AS DR_AMT_I
				     , CASE DR_CR WHEN '1' 
				                       THEN 0.0
				                  WHEN '2' 
				                       THEN AMT_I
				        END AS CR_AMT_I
				     , CASE JAN_DIVI WHEN DR_CR 
				                          THEN AMT_I
				                          ELSE -1 * AMT_I
				        END JAN_AMT_I
				     , MONEY_UNIT
				     , FOR_AMT_I
				     , '1' GUBUN
				     , ISNULL(POSTIT_YN,'N') AS POSTIT_YN
				     , ISNULL(POSTIT,'') AS POSTIT
				     , ISNULL(MOD_DIVI, 'N') AS MOD_DIVI
				     , (SELECT AC_NAME 
				          FROM ABA200T  WITH (NOLOCK) 
				         WHERE COMP_CODE = @COMP_CODE
				           AND AC_CD     = A.BOOK_CODE1) AS BOOK_CODE1
				     , BOOK_DATA1
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV 
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE1
				                  AND AC_DATA   = A.BOOK_DATA1), '') AS BOOK_NAME1
				     , (SELECT AC_NAME 
				          FROM ABA200T   WITH (NOLOCK)
				         WHERE COMP_CODE = @COMP_CODE
				           AND AC_CD     = A.BOOK_CODE2) AS BOOK_CODE2
				     , BOOK_DATA2
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE2 
				                  AND AC_DATA   = A.BOOK_DATA2), '') AS BOOK_NAME2 
				  FROM 
				  <if test='ACCNT_DIVI == "1"'>
				 	(SELECT DIV_CODE
				      , AC_DATE
				      , SLIP_NUM
				      , SLIP_SEQ
				      , REMARK
				      , (SELECT ACCNT_CD
				           FROM ABA400T  WITH (NOLOCK)
				          WHERE COMP_CODE = A.COMP_CODE
				            AND ACCNT     = A.ACCNT) ACCNT
				      , CUSTOM_CODE
				      , CUSTOM_NAME
				      , P_ACCNT
				      , BOOK_CODE1
				      , BOOK_DATA1
				      , BOOK_CODE2
				      , BOOK_DATA2
				      , DEPT_CODE
				      , DR_CR
				      , AMT_I
				      , JAN_DIVI
				      , POSTIT_YN
				      , POSTIT
				      , MOD_DIVI
				      , MOD_DATE
				      , INPUT_PATH
				      , CHARGE_CODE
				      , MONEY_UNIT
				      , FOR_AMT_I 
				   FROM AGJ210T A  WITH (NOLOCK)
				  WHERE A.COMP_CODE = @COMP_CODE)
				 </if>
				 <if test= 'ACCNT_DIVI != "1"'>
				 	(SELECT A.DIV_CODE 
		                 , A.AC_DATE 
		                 , A.SLIP_NUM 
		                 , A.SLIP_SEQ 
		                 , A.REMARK 
		                 , A.ACCNT 
		                 , A.CUSTOM_CODE 
		                 , A.CUSTOM_NAME 
		                 , A.P_ACCNT 
		                 , A.BOOK_CODE1 
		                 , A.BOOK_DATA1 
		                 , A.BOOK_CODE2 
		                 , A.BOOK_DATA2 
		                 , A.DEPT_CODE 
		                 , A.DR_CR 
		                 , A.AMT_I 
		                 , A.JAN_DIVI 
		                 , A.POSTIT_YN 
		                 , A.POSTIT 
		                 , A.MOD_DIVI 
		                 , A.MOD_DATE 
		                 , A.INPUT_PATH 
		                 , A.CHARGE_CODE 
		                 , A.MONEY_UNIT 
		                 , A.FOR_AMT_I 
		              FROM AGJ210T A   WITH (NOLOCK)
		                 , ABA400T B    WITH (NOLOCK)
		             WHERE A.COMP_CODE    = @COMP_CODE
		               AND B.COMP_CODE    = @COMP_CODE
		               AND A.ACCNT        = B.ACCNT 
		               AND B.SUBJECT_DIVI = '2')
				 </if> 
				  A, BOR120T B
				 WHERE B.COMP_CODE = @COMP_CODE
				   AND AC_DATE BETWEEN @AC_DATE_FR AND @AC_DATE_TO
				   AND A.DIV_CODE = B.DIV_CODE
				-- AND (BOOK_CODE1 &lt;&gt; '' OR BOOK_CODE2 &lt;&gt; '') 
				   AND A.ACCNT IN (SELECT ACCNT 
				                   FROM ABA400T  WITH (NOLOCK)
				                   WHERE COMP_CODE    = @COMP_CODE
				             	   AND SUBJECT_DIVI ='2')
				-- AND ((ISNULL(A.AMT_I,0.0) &gt;= @FR_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@FR_AMT_I IS NULL))
				-- AND ((ISNULL(A.AMT_I,0.0) &lt;= @TO_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@TO_AMT_I IS NULL))
				-- AND ((ISNULL(A.FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I AND @FR_FOR_AMT_I IS NOT NULL) OR (@FR_FOR_AMT_I IS NULL))
				-- AND ((ISNULL(A.FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I AND @TO_FOR_AMT_I IS NOT NULL) OR (@TO_FOR_AMT_I IS NULL))
				-- AND ((A.REMARK LIKE '%' + ISNULL(@REMARK,'')+ '%' AND ISNULL(@REMARK,'') != '') OR (ISNULL(@REMARK,'') = ''))
		---sSqlWhere
			<if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		            AND (ACCNT &gt;= #{FR_ACCNT_CODE}
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB1)">
		        	AND NOT (ACCNT = #{FR_ACCNT_CODE} AND BOOK_DATA1 &lt; #{FR_ACCNT_CODE_SUB1})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB2)">
		            AND NOT (ACCNT = #{FR_ACCNT_CODE}  AND BOOK_DATA2 &lt; #{FR_ACCNT_CODE_SUB2})
		        </if>
		  </if>
		  
		  <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		       <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE)">
		       	 	AND (ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if> 
		       <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		       	 	AND ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if>       
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB3)">
		        	AND NOT (ACCNT = #{TO_ACCNT_CODE} AND BOOK_DATA1 &gt; #{TO_ACCNT_CODE_SUB3})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB4)">
		            AND NOT (ACCNT = #{TO_ACCNT_CODE}  AND BOOK_DATA2 &gt; #{TO_ACCNT_CODE_SUB4})
		        </if>
		  </if>
		    
		  <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB111)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB111}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB112}
		   		 </if>
		   		 )
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB121}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB122)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB122}
		   		 </if>
		   		 )
		   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB131)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB131}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB132)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB132}
			   		 </if>
			   		 )
			   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE3)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB141)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB141}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB142)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB142}
			   		 </if>
			   		 )
			   </if>
		
		    <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)  or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)">
			   			  )
			 </if> 
		   
		     <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		     		<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE1)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE1} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB11)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB11}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB12)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB12}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE2)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE2} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB21)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB21}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB22)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB22}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE3)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE3} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB31)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB31}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB32)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB32}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
						AND CHARGE_CODE = @CHARGE_CODE
					</if>
		     </if>
		----END sSqlWhere 
		----sSqlWhere2
		    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">
				AND A.DIV_CODE IN (#{ACCNT_DIV_CODE})
			</if>
			<if test="@foren.Ognl@isNotEmpty(DIV_NAME)">
				 AND B.DIV_NAME LIKE N'%'+@DIV_NAME+'%'    
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_DEPT_CODE)">
				AND DEPT_CODE &gt;= @FR_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_DEPT_CODE)">
				AND DEPT_CODE &lt;= @TO_DEPT_CODE
			</if>	 
			<if test='INCLUDE_DELETE == "N"'>
		           AND ISNULL(MOD_DATE,'')  = ''
		    </if>
		    <if test='POSTIT_YN == "Y"'>
		           AND POSTIT_YN = 'Y'
		        <if test="@foren.Ognl@isNotEmpty(POSTIT)">
		          AND POSTIT LIKE @POSTIT +'%'
		        </if>    
		    </if>  
		    <if test="@foren.Ognl@isNotEmpty(FR_AMT_I)">
			 -- AND ISNULL(AMT_I,0.0) &gt;= @FR_AMT_I
				AND ((ISNULL(A.AMT_I,0.0) &gt;= @FR_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@FR_AMT_I IS NULL))
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_AMT_I)">
			 -- AND ISNULL(AMT_I,0.0) &lt;= @TO_AMT_I
				AND ((ISNULL(A.AMT_I,0.0) &lt;= @TO_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@TO_AMT_I IS NULL))
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_FOR_AMT_I)">
			 -- AND ISNULL(FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I
				AND ((ISNULL(A.FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I AND @FR_FOR_AMT_I IS NOT NULL) OR (@FR_FOR_AMT_I IS NULL))
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_FOR_AMT_I)">
			 -- AND ISNULL(FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I
				AND ((ISNULL(A.FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I AND @TO_FOR_AMT_I IS NOT NULL) OR (@TO_FOR_AMT_I IS NULL))
			</if> 	    
			<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				AND CHARGE_CODE = @CHARGE_CODE
			</if>	  
		   <if test="@foren.Ognl@isNotEmpty(REMARK)">
			 -- AND REMARK LIKE '%'+ @REMARK +'%'
				AND ((A.REMARK LIKE '%' + ISNULL(@REMARK,'')+ '%' AND ISNULL(@REMARK,'') != '') OR (ISNULL(@REMARK,'') = ''))
			</if>	
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)  and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
				AND CUSTOM_CODE = @CUSTOM_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)">
					AND CUSTOM_CODE LIKE N'%' + @CUSTOM_CODE + '%'
			</if>
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME)">
					AND CUSTOM_NAME LIKE N'%' + @CUSTOM_NAME + '%'
			</if>
			<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
						AND CHARGE_CODE = @CHARGE_CODE
			</if>
		----end sSqlWhere2
				 ORDER BY ACCNT, BOOK_DATA1, BOOK_DATA2, AC_DATE, SLIP_NUM
				        , SLIP_SEQ
			END
	    ELSE
	    	BEGIN
	    		SELECT '' AS AC_DATE
				      , 0 AS SLIP_NUM
				      , 0 AS SLIP_SEQ
				      , CONVERT(NVARCHAR(50), @msgBalance) AS REMARK
				      , ACCNT
				      , ISNULL((SELECT ACCNT_NAME
				                  FROM ABA400T  WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND ACCNT     = A.ACCNT),' ') AS ACCNT_NAME
				      , '' CUSTOM_NAME
				      , '' P_ACCNT_NAME
				      , ISNULL(SUM(DR_AMT_I),0.0) AS DR_AMT_I
				      , ISNULL(SUM(CR_AMT_I),0.0) AS CR_AMT_I
				      , ISNULL(CASE (SELECT JAN_DIVI 
				                       FROM ABA400T  WITH (NOLOCK)
				                      WHERE COMP_CODE = @COMP_CODE
				                        AND ACCNT     = A.ACCNT)
				                    WHEN '1' 
				                         THEN SUM(DR_AMT_I) - SUM(CR_AMT_I)
				                    WHEN '2' 
				                         THEN SUM(CR_AMT_I) - SUM(DR_AMT_I)
				                END,0.0) AS JAN_AMT_I
				      , '' AS MONEY_UNIT
				      , 0 AS FOR_AMT_I
				      , '2' AS GUBUN
				      , 'N' AS POSTIT_YN
				      , '' AS POSTIT
				      , '' AS MOD_DIVI
				      , ISNULL((SELECT AC_NAME 
				                  FROM ABA200T   WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND AC_CD     = A.BOOK_CODE1),' ') AS BOOK_CODE1
				      , ISNULL(BOOK_DATA1, ' ') AS BOOK_DATA1
				      , ISNULL((SELECT AC_NAME 
				                  FROM ABA200TV   WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND AC_CODE   = A.BOOK_CODE1
				                   AND AC_DATA   = A.BOOK_DATA1), ' ') AS BOOK_NAME1
				      , ISNULL((SELECT AC_NAME 
				                  FROM ABA200T  WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND AC_CD     = A.BOOK_CODE2),' ') AS BOOK_CODE2
				      , ISNULL(BOOK_DATA2, ' ') AS BOOK_DATA2
				      , ISNULL((SELECT AC_NAME 
				                  FROM ABA200TV  WITH (NOLOCK)
				                 WHERE COMP_CODE = @COMP_CODE
				                   AND AC_CODE   = A.BOOK_CODE2
				                   AND AC_DATA   = A.BOOK_DATA2), ' ') AS BOOK_NAME2
				   FROM 
				   <if test='ACCNT_DIVI == "1"'>
					(SELECT A.AC_DATE
					      , A.DIV_CODE
					      , A.DEPT_CODE
					      , B.ACCNT_CD ACCNT
					      , DR_AMT_I
					      , CR_AMT_I
					      , A.JAN_DIVI
					      , '' AS BOOK_CODE1
					      , '' AS BOOK_DATA1
					      , '' AS BOOK_CODE2
					      , '' AS BOOK_DATA2
					      , INPUT_PATH
					      , MONEY_UNIT
					      , '' CHARGE_CODE
					   FROM AGB100TV A  WITH (NOLOCK)
					      , ABA400T  B  WITH (NOLOCK)
					  WHERE A.COMP_CODE = @COMP_CODE
					    AND B.COMP_CODE = @COMP_CODE
					    AND A.ACCNT     = B.ACCNT)
				   </if>
				   <if test= 'ACCNT_DIVI != "1"'>
					   	(SELECT A.* 
					        FROM AGB100TV A  WITH (NOLOCK), ABA400T  B  WITH (NOLOCK)
				     	  WHERE A.COMP_CODE    = @COMP_CODE
					        AND B.COMP_CODE    = @COMP_CODE
					        AND A.ACCNT        = B.ACCNT
					        AND B.SUBJECT_DIVI = '2')
				   </if>
				     A, BOR120T B
				  WHERE B.COMP_CODE = @COMP_CODE
				    AND A.AC_DATE  &gt;= @START_DATE
				    AND A.DIV_CODE  = B.DIV_CODE
				    AND AC_DATE     &lt; @AC_DATE_FR
				    -- AND (ISNULL(BOOK_CODE1, '') &lt;&gt; '' OR ISNULL(BOOK_CODE2,'')&lt;&gt;'')
		---sSqlWhere
			<if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		            AND (ACCNT &gt;= #{FR_ACCNT_CODE}
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB1)">
		        	AND NOT (ACCNT = #{FR_ACCNT_CODE} AND BOOK_DATA1 &lt; #{FR_ACCNT_CODE_SUB1})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB2)">
		            AND NOT (ACCNT = #{FR_ACCNT_CODE}  AND BOOK_DATA2 &lt; #{FR_ACCNT_CODE_SUB2})
		        </if>
		  </if>
		  
		  <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		       <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE)">
		       	 	AND (ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if> 
		       <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		       	 	AND ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if>       
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB3)">
		        	AND NOT (ACCNT = #{TO_ACCNT_CODE} AND BOOK_DATA1 &gt; #{TO_ACCNT_CODE_SUB3})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB4)">
		            AND NOT (ACCNT = #{TO_ACCNT_CODE}  AND BOOK_DATA2 &gt; #{TO_ACCNT_CODE_SUB4})
		        </if>
		  </if>
		    
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB111)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB111}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB112}
		   		 </if>
		   		 )
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB121}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB122)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB122}
		   		 </if>
		   		 )
		   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB131)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB131}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB132)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB132}
			   		 </if>
			   		 )
			   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE3)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB141)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB141}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB142)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB142}
			   		 </if>
			   		 )
			   </if>
		
		    <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)  or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)">
			   			  )
			 </if> 
		   
		     <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		     		<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE1)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE1} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB11)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB11}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB12)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB12}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE2)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE2} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB21)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB21}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB22)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB22}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE3)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE3} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB31)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB31}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB32)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB32}
			        	</if>
			        	)
		        	</if>
		         -- <if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				 --		AND CHARGE_CODE = @CHARGE_CODE
				 --	</if>
		     </if>
		----END sSqlWhere 
		<if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">
				AND A.DIV_CODE IN (#{ACCNT_DIV_CODE})
			</if>
			<if test="@foren.Ognl@isNotEmpty(DIV_NAME)">
				 AND B.DIV_NAME LIKE N'%'+@DIV_NAME+'%'    
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_DEPT_CODE)">
				AND DEPT_CODE &gt;= @FR_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_DEPT_CODE)">
				AND DEPT_CODE &lt;= @TO_DEPT_CODE
			</if>
			
				 GROUP BY ACCNT, BOOK_CODE1, BOOK_CODE2, JAN_DIVI, BOOK_DATA1
				        , BOOK_DATA2
				HAVING SUM(DR_AMT_I) &lt;&gt; 0 OR SUM(CR_AMT_I) &lt;&gt; 0
				 UNION ALL 
				SELECT '' AS AC_DATE
				     , NULL AS SLIP_NUM
				     , NULL AS SLIP_SEQ
				     , CONVERT(NVARCHAR(20), @msgDealTotal) AS REMARK
				     , ACCNT
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND ACCNT     = A.ACCNT),'') AS ACCNT_NAME
				     , '' AS CUSTOM_NAME 
				     , '' AS P_ACCNT_NAME
				     , ISNULL(SUM(DR_AMT_I),0.0) AS DR_AMT_I
				     , ISNULL(SUM(CR_AMT_I),0.0) AS CR_AMT_I
				     , ISNULL(CASE (SELECT JAN_DIVI 
				                      FROM ABA400T  WITH (NOLOCK)
				                     WHERE COMP_CODE = @COMP_CODE
				                       AND ACCNT     = A.ACCNT)
				                   WHEN '1' 
				                        THEN SUM(DR_AMT_I) - SUM(CR_AMT_I)
				                   WHEN '2' 
				                        THEN SUM(CR_AMT_I) - SUM(DR_AMT_I)
				               END,0.0) JAN_AMT_I
				     , '' AS MONEY_UNIT
				     , NULL AS FOR_AMT_I
				     , '2' AS GUBUN
				     , 'N' AS POSTIT_YN
				     , '' AS POSTIT
				     , '' AS MOD_DIVI
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200T   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CD     = A.BOOK_CODE1),'') AS BOOK_CODE1
				     , ISNULL(BOOK_DATA1, '') AS BOOK_DATA1
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE1 
				                  AND AC_DATA   = A.BOOK_DATA1), '') AS BOOK_NAME1
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CD     = A.BOOK_CODE2),'') AS BOOK_CODE2
				     , ISNULL(BOOK_DATA2, '') AS BOOK_DATA2
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE2 
				                  AND AC_DATA   = A.BOOK_DATA2), '') AS BOOK_NAME2
				  FROM 
				    <if test='ACCNT_DIVI == "1"'>
					(SELECT A.AC_DATE
					      , A.DIV_CODE
					      , A.DEPT_CODE
					      , B.ACCNT_CD ACCNT
					      , DR_AMT_I
					      , CR_AMT_I
					      , A.JAN_DIVI
					      , '' AS BOOK_CODE1
					      , '' AS BOOK_DATA1
					      , '' AS BOOK_CODE2
					      , '' AS BOOK_DATA2
					      , INPUT_PATH
					      , MONEY_UNIT
					      , '' CHARGE_CODE
					   FROM AGB100TV A  WITH (NOLOCK)
					      , ABA400T  B  WITH (NOLOCK)
					  WHERE A.COMP_CODE = @COMP_CODE
					    AND B.COMP_CODE = @COMP_CODE
					    AND A.ACCNT     = B.ACCNT)
				   </if>
				   <if test= 'ACCNT_DIVI != "1"'>
					   	(SELECT A.* 
					        FROM AGB100TV A  WITH (NOLOCK), ABA400T  B  WITH (NOLOCK)
				     	  WHERE A.COMP_CODE    = @COMP_CODE
					        AND B.COMP_CODE    = @COMP_CODE
					        AND A.ACCNT        = B.ACCNT
					        AND B.SUBJECT_DIVI = '2')
				   </if>
				     A, BOR120T B  WITH (NOLOCK)
				 WHERE B.COMP_CODE  = @COMP_CODE
				   AND A.AC_DATE BETWEEN @AC_DATE_FR
				                     AND @AC_DATE_TO
				   AND A.DIV_CODE   = B.DIV_CODE
				   AND INPUT_PATH   = 'A1' 
				   AND LEN(AC_DATE) = 6
				   -- AND (ISNULL(BOOK_CODE1, '') &lt;&gt;'' OR ISNULL(BOOK_CODE2,'') &lt;&gt;'') 
		---sSqlWhere
			<if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		            AND (ACCNT &gt;= #{FR_ACCNT_CODE}
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB1)">
		        	AND NOT (ACCNT = #{FR_ACCNT_CODE} AND BOOK_DATA1 &lt; #{FR_ACCNT_CODE_SUB1})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB2)">
		            AND NOT (ACCNT = #{FR_ACCNT_CODE}  AND BOOK_DATA2 &lt; #{FR_ACCNT_CODE_SUB2})
		        </if>
		  </if>
		  
		  <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		       <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE)">
		       	 	AND (ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if> 
		       <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		       	 	AND ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if>       
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB3)">
		        	AND NOT (ACCNT = #{TO_ACCNT_CODE} AND BOOK_DATA1 &gt; #{TO_ACCNT_CODE_SUB3})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB4)">
		            AND NOT (ACCNT = #{TO_ACCNT_CODE}  AND BOOK_DATA2 &gt; #{TO_ACCNT_CODE_SUB4})
		        </if>
		  </if>
		    
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB111)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB111}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB112}
		   		 </if>
		   		 )
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB121}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB122)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB122}
		   		 </if>
		   		 )
		   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB131)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB131}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB132)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB132}
			   		 </if>
			   		 )
			   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE3)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB141)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB141}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB142)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB142}
			   		 </if>
			   		 )
			   </if>
		
		    <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)  or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)">
			   			  )
			 </if> 
		   
		     <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		     		<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE1)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE1} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB11)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB11}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB12)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB12}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE2)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE2} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB21)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB21}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB22)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB22}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE3)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE3} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB31)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB31}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB32)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB32}
			        	</if>
			        	)
		        	</if>
		         -- <if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				 --		AND CHARGE_CODE = @CHARGE_CODE
				 --	</if>
		     </if>
		----END sSqlWhere 
		   <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">
				AND A.DIV_CODE IN (#{ACCNT_DIV_CODE})
			</if>
			<if test="@foren.Ognl@isNotEmpty(DIV_NAME)">
				 AND B.DIV_NAME LIKE N'%'+@DIV_NAME+'%'     
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_DEPT_CODE)">
				AND DEPT_CODE &gt;= @FR_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_DEPT_CODE)">
				AND DEPT_CODE &lt;= @TO_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				AND CHARGE_CODE = @CHARGE_CODE
			</if>
			
				 GROUP BY ACCNT, BOOK_CODE1, BOOK_CODE2, JAN_DIVI, BOOK_DATA1
				        , BOOK_DATA2
				HAVING SUM(DR_AMT_I) &lt;&gt; 0 OR SUM(CR_AMT_I) &lt;&gt; 0
				 
				 UNION ALL 
				 
				SELECT unilite.fnGetUserDateComp(@COMP_CODE, ac_date) AS AC_DATE
				     , SLIP_NUM
				     , SLIP_SEQ
				     , ISNULL(SUBSTRING(REMARK, 0, 50),'') AS REMARK                                                
				     , A.ACCNT
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND ACCNT     = A.ACCNT),'') AS ACCNT_NAME
				     , CASE WHEN ISNULL(A.CUSTOM_CODE,'')  &lt;&gt;  '' 
				                 THEN (SELECT CUSTOM_NAME 
				                         FROM BCM100T  WITH (NOLOCK)
				                        WHERE COMP_CODE   = @COMP_CODE
				                          AND CUSTOM_CODE = A.CUSTOM_CODE)
				                 ELSE ISNULL(A.CUSTOM_NAME, '') 
				        END AS CUSTOM_NAME
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND ACCNT     = A.P_ACCNT),'') AS P_ACCNT_NAME
				     , CASE DR_CR WHEN '1' 
				                       THEN AMT_I
				                  WHEN '2' 
				                       THEN 0.0
				        END AS DR_AMT_I
				     , CASE DR_CR WHEN '1' 
				                       THEN 0.0
				                  WHEN '2' 
				                       THEN AMT_I
				        END AS CR_AMT_I
				     , CASE JAN_DIVI WHEN DR_CR 
				                          THEN AMT_I
				                          ELSE -1 * AMT_I
				        END AS JAN_AMT_I
				     , MONEY_UNIT
				     , FOR_AMT_I
				     , '1' AS GUBUN
				     , ISNULL(POSTIT_YN,'N') AS POSTIT_YN
				     , ISNULL(POSTIT,'') AS POSTIT
				     , ISNULL(MOD_DIVI, 'N') AS MOD_DIVI
				     , (SELECT AC_NAME 
				          FROM ABA200T  WITH (NOLOCK)
				         WHERE COMP_CODE = @COMP_CODE
				           AND AC_CD     = A.BOOK_CODE1) AS BOOK_CODE1
				     , BOOK_DATA1
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV   WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE1
				                  AND AC_DATA   = A.BOOK_DATA1), '') AS BOOK_NAME1
				     , (SELECT AC_NAME 
				          FROM ABA200T   WITH (NOLOCK)
				         WHERE COMP_CODE = @COMP_CODE
				           AND AC_CD     = A.BOOK_CODE2) AS BOOK_CODE2
				     , BOOK_DATA2
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE2
				                  AND AC_DATA   = A.BOOK_DATA2), '') AS BOOK_NAME2 
				  FROM 
				
				 <if test='ACCNT_DIVI == "1"'>
				 	(SELECT DIV_CODE
				      , AC_DATE
				      , SLIP_NUM
				      , SLIP_SEQ
				      , REMARK
				      , (SELECT ACCNT_CD
				           FROM ABA400T  WITH (NOLOCK)
				          WHERE COMP_CODE = A.COMP_CODE
				            AND ACCNT     = A.ACCNT) ACCNT
				      , CUSTOM_CODE
				      , CUSTOM_NAME
				      , P_ACCNT
				      , BOOK_CODE1
				      , BOOK_DATA1
				      , BOOK_CODE2
				      , BOOK_DATA2
				      , DEPT_CODE
				      , DR_CR
				      , AMT_I
				      , JAN_DIVI
				      , POSTIT_YN
				      , POSTIT
				      , MOD_DIVI
				      , MOD_DATE
				      , INPUT_PATH
				      , CHARGE_CODE
				      , MONEY_UNIT
				      , FOR_AMT_I 
				   FROM AGJ210T A  WITH (NOLOCK)
				  WHERE A.COMP_CODE = @COMP_CODE)
				 </if>
				 <if test= 'ACCNT_DIVI != "1"'>
				 	(SELECT A.DIV_CODE 
		                 , A.AC_DATE 
		                 , A.SLIP_NUM 
		                 , A.SLIP_SEQ 
		                 , A.REMARK 
		                 , A.ACCNT 
		                 , A.CUSTOM_CODE 
		                 , A.CUSTOM_NAME 
		                 , A.P_ACCNT 
		                 , A.BOOK_CODE1 
		                 , A.BOOK_DATA1 
		                 , A.BOOK_CODE2 
		                 , A.BOOK_DATA2 
		                 , A.DEPT_CODE 
		                 , A.DR_CR 
		                 , A.AMT_I 
		                 , A.JAN_DIVI 
		                 , A.POSTIT_YN 
		                 , A.POSTIT 
		                 , A.MOD_DIVI 
		                 , A.MOD_DATE 
		                 , A.INPUT_PATH 
		                 , A.CHARGE_CODE 
		                 , A.MONEY_UNIT 
		                 , A.FOR_AMT_I 
		              FROM AGJ210T A   WITH (NOLOCK)
		                 , ABA400T B   WITH (NOLOCK) 
		             WHERE A.COMP_CODE    = @COMP_CODE
		               AND B.COMP_CODE    = @COMP_CODE
		               AND A.ACCNT        = B.ACCNT 
		               AND B.SUBJECT_DIVI = '2')
				 </if>
				   A, BOR120T B
				 WHERE B.COMP_CODE = @COMP_CODE
				   AND AC_DATE Between @AC_DATE_FR AND @AC_DATE_TO
				   AND A.DIV_CODE = B.DIV_CODE
				-- AND (BOOK_CODE1 &lt;&gt; '' OR BOOK_CODE2 &lt;&gt; '')
				-- AND ((ISNULL(A.AMT_I,0.0) &gt;= @FR_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@FR_AMT_I IS NULL))
			    -- AND ((ISNULL(A.AMT_I,0.0) &lt;= @TO_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@TO_AMT_I IS NULL))
				-- AND ((ISNULL(A.FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I AND @FR_FOR_AMT_I IS NOT NULL) OR (@FR_FOR_AMT_I IS NULL))
				-- AND ((ISNULL(A.FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I AND @TO_FOR_AMT_I IS NOT NULL) OR (@TO_FOR_AMT_I IS NULL))
				-- AND ((A.REMARK LIKE '%' + ISNULL(@REMARK,'')+ '%' AND ISNULL(@REMARK,'') != '') OR (ISNULL(@REMARK,'') = ''))
		---sSqlWhere
			<if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		            AND (ACCNT &gt;= #{FR_ACCNT_CODE}
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB1)">
		        	AND NOT (ACCNT = #{FR_ACCNT_CODE} AND BOOK_DATA1 &lt; #{FR_ACCNT_CODE_SUB1})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB2)">
		            AND NOT (ACCNT = #{FR_ACCNT_CODE}  AND BOOK_DATA2 &lt; #{FR_ACCNT_CODE_SUB2})
		        </if>
		  </if>
		  
		  <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		       <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE)">
		       	 	AND (ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if> 
		       <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		       	 	AND ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if>       
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB3)">
		        	AND NOT (ACCNT = #{TO_ACCNT_CODE} AND BOOK_DATA1 &gt; #{TO_ACCNT_CODE_SUB3})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB4)">
		            AND NOT (ACCNT = #{TO_ACCNT_CODE}  AND BOOK_DATA2 &gt; #{TO_ACCNT_CODE_SUB4})
		        </if>
		  </if>
		    
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB111)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB111}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB112}
		   		 </if>
		   		 )
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB121}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB122)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB122}
		   		 </if>
		   		 )
		   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB131)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB131}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB132)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB132}
			   		 </if>
			   		 )
			   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE3)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB141)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB141}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB142)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB142}
			   		 </if>
			   		 )
			   </if>
		
		    <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)  or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)">
			   			  )
			 </if> 
		   
		     <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		     		<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE1)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE1} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB11)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB11}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB12)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB12}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE2)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE2} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB21)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB21}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB22)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB22}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE3)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE3} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB31)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB31}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB32)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB32}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
						AND CHARGE_CODE = @CHARGE_CODE
					</if>
		     </if>
		----END sSqlWhere 
		----sSqlWhere2
		    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">
				AND A.DIV_CODE IN (#{ACCNT_DIV_CODE})
			</if>
			<if test="@foren.Ognl@isNotEmpty(DIV_NAME)">
				 AND B.DIV_NAME LIKE N'%'+@DIV_NAME+'%'    
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_DEPT_CODE)">
				AND DEPT_CODE &gt;= @FR_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_DEPT_CODE)">
				AND DEPT_CODE &lt;= @TO_DEPT_CODE
			</if>	 
			<if test='INCLUDE_DELETE == "N"'>
		           AND ISNULL(MOD_DATE,'')  = ''
		    </if>
		    <if test='POSTIT_YN == "Y"'>
		           AND POSTIT_YN = 'Y'
		        <if test="@foren.Ognl@isNotEmpty(POSTIT)">
		          AND POSTIT LIKE @POSTIT +'%'
		        </if>    
		    </if>  
		    <if test="@foren.Ognl@isNotEmpty(FR_AMT_I)">
			 -- AND ISNULL(AMT_I,0.0) &gt;= @FR_AMT_I
				AND ((ISNULL(A.AMT_I,0.0) &gt;= @FR_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@FR_AMT_I IS NULL))
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_AMT_I)">
			 -- AND ISNULL(AMT_I,0.0) &lt;= @TO_AMT_I
				AND ((ISNULL(A.AMT_I,0.0) &lt;= @TO_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@TO_AMT_I IS NULL))
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_FOR_AMT_I)">
			 -- AND ISNULL(FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I
				AND ((ISNULL(A.FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I AND @FR_FOR_AMT_I IS NOT NULL) OR (@FR_FOR_AMT_I IS NULL))
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_FOR_AMT_I)">
			 -- AND ISNULL(FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I
				AND ((ISNULL(A.FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I AND @TO_FOR_AMT_I IS NOT NULL) OR (@TO_FOR_AMT_I IS NULL))
			</if> 	    
			<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				AND CHARGE_CODE = @CHARGE_CODE
			</if>	  
		   <if test="@foren.Ognl@isNotEmpty(REMARK)">
			 -- AND REMARK LIKE N'%'+ @REMARK + '%'
				AND ((A.REMARK LIKE '%' + ISNULL(@REMARK,'')+ '%' AND ISNULL(@REMARK,'') != '') OR (ISNULL(@REMARK,'') = ''))
			</if>	
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)  and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
				AND CUSTOM_CODE = @CUSTOM_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)">
					AND CUSTOM_CODE LIKE '%' + @CUSTOM_CODE + '%'
			</if>
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME)">
					AND CUSTOM_NAME LIKE '%' + @CUSTOM_NAME + '%' 
			</if>	
		----end sSqlWhere2
				 UNION ALL
				SELECT unilite.fnGetUserDateComp(@COMP_CODE, ac_date) AS AC_DATE
				     , SLIP_NUM
				     , SLIP_SEQ
				     , ISNULL(SUBSTRING(REMARK, 0, 50),'') AS REMARK                                                
				     , ACCNT
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE 
				                  AND ACCNT     = A.ACCNT),'') AS ACCNT_NAME
				     , CASE WHEN ISNULL(A.CUSTOM_NAME,'') = '' 
				                 THEN (SELECT CUSTOM_NAME 
				                         FROM BCM100T 
				                        WHERE COMP_CODE   = @COMP_CODE
				                          AND CUSTOM_CODE = A.CUSTOM_CODE)
				                 ELSE ISNULL(A.CUSTOM_NAME, '') 
				        END AS CUSTOM_NAME
				     , ISNULL((SELECT ACCNT_NAME 
				                 FROM ABA400T  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND ACCNT     = A.P_ACCNT),'') AS P_ACCNT_NAME
				     , CASE DR_CR WHEN '1' 
				                       THEN AMT_I
				                  WHEN '2' 
				                       THEN 0.0
				        END AS DR_AMT_I
				     , CASE DR_CR WHEN '1' 
				                       THEN 0.0
				                  WHEN '2' 
				                       THEN AMT_I
				        END AS CR_AMT_I
				     , CASE JAN_DIVI WHEN DR_CR 
				                          THEN AMT_I
				                          ELSE -1 * AMT_I
				        END JAN_AMT_I
				     , MONEY_UNIT
				     , FOR_AMT_I
				     , '1' GUBUN
				     , ISNULL(POSTIT_YN,'N') AS POSTIT_YN
				     , ISNULL(POSTIT,'') AS POSTIT
				     , ISNULL(MOD_DIVI, 'N') AS MOD_DIVI
				     , (SELECT AC_NAME 
				          FROM ABA200T  WITH (NOLOCK) 
				         WHERE COMP_CODE = @COMP_CODE
				           AND AC_CD     = A.BOOK_CODE1) AS BOOK_CODE1
				     , BOOK_DATA1
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV 
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE1
				                  AND AC_DATA   = A.BOOK_DATA1), '') AS BOOK_NAME1
				     , (SELECT AC_NAME 
				          FROM ABA200T   WITH (NOLOCK)
				         WHERE COMP_CODE = @COMP_CODE
				           AND AC_CD     = A.BOOK_CODE2) AS BOOK_CODE2
				     , BOOK_DATA2
				     , ISNULL((SELECT AC_NAME 
				                 FROM ABA200TV  WITH (NOLOCK)
				                WHERE COMP_CODE = @COMP_CODE
				                  AND AC_CODE   = A.BOOK_CODE2 
				                  AND AC_DATA   = A.BOOK_DATA2), '') AS BOOK_NAME2 
				  FROM 
				  <if test='ACCNT_DIVI == "1"'>
				 	(SELECT DIV_CODE
				      , AC_DATE
				      , SLIP_NUM
				      , SLIP_SEQ
				      , REMARK
				      , (SELECT ACCNT_CD
				           FROM ABA400T  WITH (NOLOCK)
				          WHERE COMP_CODE = A.COMP_CODE
				            AND ACCNT     = A.ACCNT) ACCNT
				      , CUSTOM_CODE
				      , CUSTOM_NAME
				      , P_ACCNT
				      , BOOK_CODE1
				      , BOOK_DATA1
				      , BOOK_CODE2
				      , BOOK_DATA2
				      , DEPT_CODE
				      , DR_CR
				      , AMT_I
				      , JAN_DIVI
				      , POSTIT_YN
				      , POSTIT
				      , MOD_DIVI
				      , MOD_DATE
				      , INPUT_PATH
				      , CHARGE_CODE
				      , MONEY_UNIT
				      , FOR_AMT_I 
				   FROM AGJ210T A  WITH (NOLOCK)
				  WHERE A.COMP_CODE = @COMP_CODE)
				 </if>
				 <if test= 'ACCNT_DIVI != "1"'>
				 	(SELECT A.DIV_CODE 
		                 , A.AC_DATE 
		                 , A.SLIP_NUM 
		                 , A.SLIP_SEQ 
		                 , A.REMARK 
		                 , A.ACCNT 
		                 , A.CUSTOM_CODE 
		                 , A.CUSTOM_NAME 
		                 , A.P_ACCNT 
		                 , A.BOOK_CODE1 
		                 , A.BOOK_DATA1 
		                 , A.BOOK_CODE2 
		                 , A.BOOK_DATA2 
		                 , A.DEPT_CODE 
		                 , A.DR_CR 
		                 , A.AMT_I 
		                 , A.JAN_DIVI 
		                 , A.POSTIT_YN 
		                 , A.POSTIT 
		                 , A.MOD_DIVI 
		                 , A.MOD_DATE 
		                 , A.INPUT_PATH 
		                 , A.CHARGE_CODE 
		                 , A.MONEY_UNIT 
		                 , A.FOR_AMT_I 
		              FROM AGJ210T A   WITH (NOLOCK)
		                 , ABA400T B    WITH (NOLOCK)
		             WHERE A.COMP_CODE    = @COMP_CODE
		               AND B.COMP_CODE    = @COMP_CODE
		               AND A.ACCNT        = B.ACCNT 
		               AND B.SUBJECT_DIVI = '2')
				 </if> 
				  A, BOR120T B
				 WHERE B.COMP_CODE = @COMP_CODE
				   AND AC_DATE BETWEEN @AC_DATE_FR AND @AC_DATE_TO
				   AND A.DIV_CODE = B.DIV_CODE
				-- AND (BOOK_CODE1 &lt;&gt; '' OR BOOK_CODE2 &lt;&gt; '') 
				   AND A.ACCNT IN (SELECT ACCNT 
				                   FROM ABA400T  WITH (NOLOCK)
				                   WHERE COMP_CODE    = @COMP_CODE
				             	   AND SUBJECT_DIVI ='2')
				-- AND ((ISNULL(A.AMT_I,0.0) &gt;= @FR_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@FR_AMT_I IS NULL))
				-- AND ((ISNULL(A.AMT_I,0.0) &lt;= @TO_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@TO_AMT_I IS NULL))
				-- AND ((ISNULL(A.FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I AND @FR_FOR_AMT_I IS NOT NULL) OR (@FR_FOR_AMT_I IS NULL))
				-- AND ((ISNULL(A.FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I AND @TO_FOR_AMT_I IS NOT NULL) OR (@TO_FOR_AMT_I IS NULL))
				-- AND ((A.REMARK LIKE '%' + ISNULL(@REMARK,'')+ '%' AND ISNULL(@REMARK,'') != '') OR (ISNULL(@REMARK,'') = ''))
		---sSqlWhere
			<if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		            AND (ACCNT &gt;= #{FR_ACCNT_CODE}
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB1)">
		        	AND NOT (ACCNT = #{FR_ACCNT_CODE} AND BOOK_DATA1 &lt; #{FR_ACCNT_CODE_SUB1})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE_SUB2)">
		            AND NOT (ACCNT = #{FR_ACCNT_CODE}  AND BOOK_DATA2 &lt; #{FR_ACCNT_CODE_SUB2})
		        </if>
		  </if>
		  
		  <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		       <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE)">
		       	 	AND (ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if> 
		       <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE)">
		       	 	AND ACCNT &lt;= #{TO_ACCNT_CODE}
		       </if>       
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB3)">
		        	AND NOT (ACCNT = #{TO_ACCNT_CODE} AND BOOK_DATA1 &gt; #{TO_ACCNT_CODE_SUB3})
		        </if>
		        <if test="@foren.Ognl@isNotEmpty(TO_ACCNT_CODE_SUB4)">
		            AND NOT (ACCNT = #{TO_ACCNT_CODE}  AND BOOK_DATA2 &gt; #{TO_ACCNT_CODE_SUB4})
		        </if>
		  </if>
		    
		  <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE1}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB111)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB111}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB112}
		   		 </if>
		   		 )
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)"> 
		   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1)">
		   			 OR (ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1)">
		   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE2}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB121)"> 
		   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB121}
		   		 </if>
		   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB122)"> 
		   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB122}
		   		 </if>
		   		 )
		   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE3}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB131)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB131}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB132)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB132}
			   		 </if>
			   		 )
			   </if>
			<if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)"> 
			   		 <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3)">
			   			 OR (ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isEmpty(FR_ACCNT_CODE) and @foren.Ognl@isEmpty(TO_ACCNT_CODE) and  @foren.Ognl@isEmpty(ADD_ACCNT_CODE1) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE2) and @foren.Ognl@isEmpty(ADD_ACCNT_CODE3)">
			   		 	 AND ((ACCNT = #{ADD_ACCNT_CODE4}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB141)"> 
			   		 	AND BOOK_DATA1 = #{ADD_ACCNT_CODE_SUB141}
			   		 </if>
			   		 <if test="@foren.Ognl@isNotEmpty(ADD_ACCNT_CODE_SUB142)"> 
			   		 	AND BOOK_DATA2 = #{ADD_ACCNT_CODE_SUB142}
			   		 </if>
			   		 )
			   </if>
		
		    <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE1) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE2)  or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE3) or @foren.Ognl@isNotEmpty(ADD_ACCNT_CODE4)">
			   			  )
			 </if> 
		   
		     <if test="@foren.Ognl@isNotEmpty(FR_ACCNT_CODE) or @foren.Ognl@isNotEmpty(TO_ACCNT_CODE)">
		     		<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE1)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE1} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB11)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB11}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB12)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB12}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE2)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE2} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB21)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB21}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB22)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB22}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE3)">
		     			AND NOT (ACCNT = #{EX_ACCNT_CODE3} 
		     		
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB31)">
			        		AND BOOK_DATA1 = #{EX_ACCNT_CODE_SUB31}
			        	</if>
			        	<if test="@foren.Ognl@isNotEmpty(EX_ACCNT_CODE_SUB32)">
			        		AND BOOK_DATA2 = #{EX_ACCNT_CODE_SUB32}
			        	</if>
			        	)
		        	</if>
		        	<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
						AND CHARGE_CODE = @CHARGE_CODE
					</if>
		     </if>
		----END sSqlWhere 
		----sSqlWhere2
		    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">
				AND A.DIV_CODE IN (#{ACCNT_DIV_CODE})
			</if>
			<if test="@foren.Ognl@isNotEmpty(DIV_NAME)">
				 AND B.DIV_NAME LIKE N'%'+@DIV_NAME+'%'    
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_DEPT_CODE)">
				AND DEPT_CODE &gt;= @FR_DEPT_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_DEPT_CODE)">
				AND DEPT_CODE &lt;= @TO_DEPT_CODE
			</if>	 
			<if test='INCLUDE_DELETE == "N"'>
		           AND ISNULL(MOD_DATE,'')  = ''
		    </if>
		    <if test='POSTIT_YN == "Y"'>
		           AND POSTIT_YN = 'Y'
		        <if test="@foren.Ognl@isNotEmpty(POSTIT)">
		          AND POSTIT LIKE @POSTIT +'%'
		        </if>    
		    </if>  
		    <if test="@foren.Ognl@isNotEmpty(FR_AMT_I)">
			 -- AND ISNULL(AMT_I,0.0) &gt;= @FR_AMT_I
				AND ((ISNULL(A.AMT_I,0.0) &gt;= @FR_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@FR_AMT_I IS NULL))
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_AMT_I)">
			 -- AND ISNULL(AMT_I,0.0) &lt;= @TO_AMT_I
				AND ((ISNULL(A.AMT_I,0.0) &lt;= @TO_AMT_I AND @FR_AMT_I IS NOT NULL) OR (@TO_AMT_I IS NULL))
			</if>    
			<if test="@foren.Ognl@isNotEmpty(FR_FOR_AMT_I)">
			 -- AND ISNULL(FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I
				AND ((ISNULL(A.FOR_AMT_I,0.0) &gt;= @FR_FOR_AMT_I AND @FR_FOR_AMT_I IS NOT NULL) OR (@FR_FOR_AMT_I IS NULL))
			</if>
			<if test="@foren.Ognl@isNotEmpty(TO_FOR_AMT_I)">
			 -- AND ISNULL(FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I
				AND ((ISNULL(A.FOR_AMT_I,0.0) &lt;= @TO_FOR_AMT_I AND @TO_FOR_AMT_I IS NOT NULL) OR (@TO_FOR_AMT_I IS NULL))
			</if> 	    
			<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
				AND CHARGE_CODE = @CHARGE_CODE
			</if>	  
		   <if test="@foren.Ognl@isNotEmpty(REMARK)">
			 -- AND REMARK LIKE '%'+ @REMARK +'%'
				AND ((A.REMARK LIKE '%' + ISNULL(@REMARK,'')+ '%' AND ISNULL(@REMARK,'') != '') OR (ISNULL(@REMARK,'') = ''))
			</if>	
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)  and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
				AND CUSTOM_CODE = @CUSTOM_CODE
			</if>
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)">
					AND CUSTOM_CODE LIKE N'%' + @CUSTOM_CODE + '%'
			</if>
			<if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME)">
					AND CUSTOM_NAME LIKE N'%' + @CUSTOM_NAME + '%'
			</if>
			<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">
						AND CHARGE_CODE = @CHARGE_CODE
			</if>
		----end sSqlWhere2
				 ORDER BY ACCNT, BOOK_DATA1, BOOK_DATA2, AC_DATE, SLIP_NUM
				        , SLIP_SEQ
	    	END
	    	
	    SET ARITHABORT OFF
	 	SET NOCOUNT OFF
	  
</select>
</mapper>