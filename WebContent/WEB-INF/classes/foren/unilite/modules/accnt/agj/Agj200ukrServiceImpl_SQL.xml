<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="agj200ukrServiceImpl">
	<select id="agj200ukrServiceImpl.selectOption" parameterType="Map" resultType="rMap">
		/*agj200ukrServiceImpl.selectOption*/
	   SELECT  MAX(DIV_CHANGE_YN)    AS DIV_CHANGE_YN
              , MAX(DIV_CODE_USE)     AS DIV_CODE_USE
              , MAX(REMARK_COPY)      AS REMARK_COPY
              , MAX(AMT_ENTER)        AS AMT_ENTER
        FROM    (
                SELECT  CASE WHEN SUB_CODE = '42' THEN UPPER(ISNULL(REF_CODE1, 'Y')) ELSE '' END    AS DIV_CHANGE_YN      --귀속부서 입력시 사업장 자동 변경
                      , CASE WHEN SUB_CODE = '43' THEN UPPER(ISNULL(REF_CODE1, 'Y')) ELSE '' END    AS DIV_CODE_USE       --사업장 입력조건 사용
                      , CASE WHEN SUB_CODE = '44' THEN UPPER(ISNULL(REF_CODE1, 'Y')) ELSE '' END    AS REMARK_COPY        --전표_적요 copy방식_적요 빈 값 상태에서 Enter칠 때 copy
                      , CASE WHEN SUB_CODE = '45' THEN UPPER(ISNULL(REF_CODE1, 'Y')) ELSE '' END    AS AMT_ENTER          --전표_금액이 0이면 마지막 행에서 Enter안넘어감(부가세 제외)
                FROM    BSA100T WITH (NOLOCK)
                WHERE   COMP_CODE   = #{S_COMP_CODE}
                AND     MAIN_CODE   = N'A165'
                AND     SUB_CODE   IN ('42', '43', '44', '45')
            ) T
	</select>
	<select id="agj200ukrServiceImpl.selectList" parameterType="Map" resultType="rMap">		
		/* agj200ukrServiceImpl.selectList */
		 SELECT A.AC_DATE                                    OLD_AC_DATE 
		     , A.SLIP_NUM                                   OLD_SLIP_NUM 
		     , A.SLIP_SEQ                                   OLD_SLIP_SEQ
		     , A.AC_DATE 
		     , SUBSTRING(A.AC_DATE,7,2)                     AC_DAY
		     , A.SLIP_NUM 
		     , A.SLIP_SEQ
		     , A.SLIP_DIVI
		     , A.ACCNT
		     , ISNULL(C1.ACCNT_NAME,'')                     ACCNT_NAME
		     , ISNULL(A.CUSTOM_CODE,'')                     CUSTOM_CODE
		     , CASE WHEN ISNULL(A.CUSTOM_NAME,'') = '' 
		            THEN ISNULL(C2.CUSTOM_NAME, '')
		            ELSE ISNULL(A.CUSTOM_NAME , '') 
		        END                                         CUSTOM_NAME
		     , CASE A.DR_CR WHEN '1' THEN ISNULL(A.AMT_I, 0.0) ELSE 0.0 END DR_AMT_I
     		 , CASE A.DR_CR WHEN '2' THEN ISNULL(A.AMT_I, 0.0) ELSE 0.0 END CR_AMT_I     
		     , ISNULL(A.AMT_I, 0.0)                         AMT_I
		     , ISNULL(A.REMARK,'')                          REMARK
		     , ISNULL(M1.CODE_NAME,'')                      PROOF_KIND_NM
		     , ISNULL(A.DEPT_NAME,'')                       DEPT_NAME
		     , ISNULL(A.DIV_CODE,'')                        DIV_CODE
		    
		     , ISNULL(A.DEPT_CODE,'')                       DEPT_CODE
		     , ISNULL(A.DR_CR,'')                           DR_CR
		     , ISNULL(A.P_ACCNT,'')                         P_ACCNT
		     , ISNULL(A.PROOF_KIND,'')                      PROOF_KIND
		     , ISNULL(A.MONEY_UNIT,'')                      MONEY_UNIT
		     , ISNULL(A.EXCHG_RATE_O,0.0)                   EXCHG_RATE_O
		     , ISNULL(A.FOR_AMT_I,0.0)                      FOR_AMT_I
		     , ISNULL(A.IN_DIV_CODE,'')                     IN_DIV_CODE
		     , ISNULL(A.IN_DEPT_CODE,'')                    IN_DEPT_CODE
		     , ISNULL(A.IN_DEPT_NAME,'')                    IN_DEPT_NAME
		     , ISNULL(A.BILL_DIV_CODE,'')                   BILL_DIV_CODE
		     , ISNULL(A.AC_CODE1,'')                        AC_CODE1,         ISNULL(A.AC_CODE2,'')        AC_CODE2
		     , ISNULL(A.AC_CODE3,'')                        AC_CODE3,         ISNULL(A.AC_CODE4,'')        AC_CODE4
		     , ISNULL(A.AC_CODE5,'')                        AC_CODE5,         ISNULL(A.AC_CODE6,'')        AC_CODE6
		     , ISNULL(A.AC_DATA1,'')                        AC_DATA1,         ISNULL(A.AC_DATA2,'')        AC_DATA2
		     , ISNULL(A.AC_DATA3,'')                        AC_DATA3,         ISNULL(A.AC_DATA4,'')        AC_DATA4
		     , ISNULL(A.AC_DATA5,'')                        AC_DATA5,         ISNULL(A.AC_DATA6,'')        AC_DATA6
		     , ISNULL(A.AC_DATA_NAME1,'')                   AC_DATA_NAME1,    ISNULL(A.AC_DATA_NAME2,'')   AC_DATA_NAME2
		     , ISNULL(A.AC_DATA_NAME3,'')                   AC_DATA_NAME3,    ISNULL(A.AC_DATA_NAME4,'')   AC_DATA_NAME4
		     , ISNULL(A.AC_DATA_NAME5,'')                   AC_DATA_NAME5,    ISNULL(A.AC_DATA_NAME6,'')   AC_DATA_NAME6
		     , ISNULL(A.BOOK_CODE1,'')                      BOOK_CODE1,       ISNULL(A.BOOK_CODE2,'')      BOOK_CODE2
		     , ISNULL(A.BOOK_DATA1,'')                      BOOK_DATA1,       ISNULL(A.BOOK_DATA2,'')      BOOK_DATA2
		     , ISNULL(A.BOOK_DATA_NAME1,'')                 BOOK_DATA_NAME1,  ISNULL(A.BOOK_DATA_NAME2,'') BOOK_DATA_NAME2
		     , ISNULL(A.ACCNT_SPEC,'')                      ACCNT_SPEC,       ISNULL(A.SPEC_DIVI,'')       SPEC_DIVI
		     , ISNULL(A.PROFIT_DIVI,'')                     PROFIT_DIVI,      ISNULL(A.JAN_DIVI,'')        JAN_DIVI
		     , ISNULL(A.PEND_YN,'N')                        PEND_YN,          ISNULL(A.PEND_CODE,'')       PEND_CODE
		     , ISNULL(A.PEND_DATA_CODE,'')                  PEND_DATA_CODE,   ISNULL(A.BUDG_YN,'N')        BUDG_YN
		     , ISNULL(A.BUDGCTL_YN,'N')                     BUDGCTL_YN,       ISNULL(A.FOR_YN,'N')         FOR_YN
		     , ISNULL(A.POSTIT_YN,'')                       POSTIT_YN,        ISNULL(A.POSTIT,'')          POSTIT
		     , ISNULL(A.POSTIT_USER_ID,'')                  POSTIT_USER_ID ,  ISNULL(A.INPUT_PATH,'')      INPUT_PATH
		     , ISNULL(A.INPUT_DIVI,'')                      INPUT_DIVI ,      ISNULL(A.AUTO_SLIP_NUM,'')   AUTO_SLIP_NUM
		     , ISNULL(A.CLOSE_FG,'')                        CLOSE_FG ,        ISNULL(A.INPUT_DATE,'')      INPUT_DATE
		     , ISNULL(A.INPUT_USER_ID,'')                   INPUT_USER_ID,    ISNULL(A.CHARGE_CODE,'')     CHARGE_CODE
		     , ISNULL(M2.CODE_NAME,'')     CHARGE_NAME
		     , ISNULL(A.CREDIT_CODE,'')                     CREDIT_CODE,      ISNULL(A.REASON_CODE,'')     REASON_CODE
		     , uniLITE.fnCipherDecrypt(A.CREDIT_NUM, '')    CREDIT_NUM_EXPOS
		     , ISNULL(A.CREDIT_NUM, '')     CREDIT_NUM
		     , ISNULL(A.AP_DATE,'')         AP_DATE
		     , ISNULL(A.AP_USER_ID,'')                      AP_USER_ID,       ISNULL(A.EX_DATE,'')         EX_DATE
		     , ISNULL(A.EX_NUM,0)                           EX_NUM,           ISNULL(A.EX_SEQ,0)           EX_SEQ
		    
		     , ISNULL(N1.AC_NAME ,'' )                      AC_NAME1 ,        ISNULL(N2.AC_NAME ,'' )      AC_NAME2
		     , ISNULL(N3.AC_NAME ,'' )                      AC_NAME3 ,        ISNULL(N4.AC_NAME ,'' )      AC_NAME4
		     , ISNULL(N5.AC_NAME ,'' )                      AC_NAME5 ,        ISNULL(N6.AC_NAME ,'' )      AC_NAME6
		     , ISNULL(A.AC_CTL1  ,'N')                      AC_CTL1  ,        ISNULL(A.AC_CTL2  ,'N')      AC_CTL2
		     , ISNULL(A.AC_CTL3  ,'N')                      AC_CTL3  ,        ISNULL(A.AC_CTL4  ,'N')      AC_CTL4
		     , ISNULL(A.AC_CTL5  ,'N')                      AC_CTL5  ,        ISNULL(A.AC_CTL6  ,'N')      AC_CTL6
		     , ISNULL(N1.DT_TYPE ,0  )                      AC_TYPE1 ,        ISNULL(N2.DT_TYPE ,0  )      AC_TYPE2
		     , ISNULL(N3.DT_TYPE ,0  )                      AC_TYPE3 ,        ISNULL(N4.DT_TYPE ,0  )      AC_TYPE4
		     , ISNULL(N5.DT_TYPE ,0  )                      AC_TYPE5 ,        ISNULL(N6.DT_TYPE ,0  )      AC_TYPE6
		     , ISNULL(N1.DT_LEN  ,0  )                      AC_LEN1  ,        ISNULL(N2.DT_LEN  ,0  )      AC_LEN2
		     , ISNULL(N3.DT_LEN  ,0  )                      AC_LEN3  ,        ISNULL(N4.DT_LEN  ,0  )      AC_LEN4
		     , ISNULL(N5.DT_LEN  ,0  )                      AC_LEN5  ,        ISNULL(N6.DT_LEN  ,0  )      AC_LEN6
		     , ISNULL(N1.DT_POPUP,'N')                      AC_POPUP1,        ISNULL(N2.DT_POPUP,'N')      AC_POPUP2
		     , ISNULL(N3.DT_POPUP,'N')                      AC_POPUP3,        ISNULL(N4.DT_POPUP,'N')      AC_POPUP4
		     , ISNULL(N5.DT_POPUP,'N')                      AC_POPUP5,        ISNULL(N6.DT_POPUP,'N')      AC_POPUP6
		     , A.COMP_CODE
		     , ISNULL(N1.DT_FMT,'0')                        AC_FORMAT1,       ISNULL(N2.DT_FMT,'0')    AC_FORMAT2
		     , ISNULL(N3.DT_FMT,'0')                        AC_FORMAT3,       ISNULL(N4.DT_FMT,'0')    AC_FORMAT4
		     , ISNULL(N5.DT_FMT,'0')                        AC_FORMAT5,       ISNULL(N6.DT_FMT,'0')    AC_FORMAT6
		     , ISNULL(A.ASST_SUPPLY_AMT_I, 0.0)			   ASST_SUPPLY_AMT_I
             , ISNULL(A.ASST_TAX_AMT_I, 0.0)			   	   ASST_TAX_AMT_I
             , A.ASST_DIVI
		  FROM             AGJ210T  AS A  WITH (NOLOCK)
		        LEFT  JOIN ABA400T  AS C1 WITH (NOLOCK) ON  C1.COMP_CODE   = A.COMP_CODE
		                                                AND C1.ACCNT       = A.ACCNT
		        LEFT  JOIN BCM100T  AS C2 WITH (NOLOCK) ON  C2.COMP_CODE   = A.COMP_CODE
		                                                AND C2.CUSTOM_CODE = A.CUSTOM_CODE
		        LEFT  JOIN BSA100T  AS M1 WITH (NOLOCK) ON  M1.COMP_CODE   = A.COMP_CODE
		                                                AND M1.MAIN_CODE   = 'A022' 
		                                                AND M1.SUB_CODE    = A.PROOF_KIND
		        LEFT  JOIN BSA100T AS M2 WITH (NOLOCK)   ON  M2.COMP_CODE   = A.COMP_CODE
		                                                AND M2.MAIN_CODE   = N'A009' 
		                                                AND M2.SUB_CODE    = A.CHARGE_CODE
		        LEFT  JOIN ABA200T  AS N1 WITH (NOLOCK) ON  N1.COMP_CODE   = A.COMP_CODE
		                                                AND N1.AC_CD       = A.AC_CODE1
		        LEFT  JOIN ABA200T  AS N2 WITH (NOLOCK) ON  N2.COMP_CODE   = A.COMP_CODE
		                                                AND N2.AC_CD       = A.AC_CODE2
		        LEFT  JOIN ABA200T  AS N3 WITH (NOLOCK) ON  N3.COMP_CODE   = A.COMP_CODE
		                                                AND N3.AC_CD       = A.AC_CODE3
		        LEFT  JOIN ABA200T  AS N4 WITH (NOLOCK) ON  N4.COMP_CODE   = A.COMP_CODE
		                                                AND N4.AC_CD       = A.AC_CODE4
		        LEFT  JOIN ABA200T  AS N5 WITH (NOLOCK) ON  N5.COMP_CODE   = A.COMP_CODE
		                                                AND N5.AC_CD       = A.AC_CODE5
		        LEFT  JOIN ABA200T  AS N6 WITH (NOLOCK) ON  N6.COMP_CODE   = A.COMP_CODE
		                                                AND N6.AC_CD       = A.AC_CODE6
		 WHERE A.COMP_CODE       = #{S_COMP_CODE}
		   <if test="@foren.Ognl@isNotEmpty(AC_DATE_FR) &amp;&amp; @foren.Ognl@isNotEmpty(AC_DATE_TO)">
		   AND A.AC_DATE       &gt;= #{AC_DATE_FR}
		   AND A.AC_DATE       &lt;= #{AC_DATE_TO}
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(AC_DATE)">
		   AND A.AC_DATE       = #{AC_DATE}
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(SLIP_NUM)">
		   AND A.SLIP_NUM        = #{SLIP_NUM}
		   </if>
		   <if test="@foren.Ognl@isNotEmpty(INPUT_PATH)">
		   AND A.INPUT_PATH        = #{INPUT_PATH}
		   </if>
		   <if test="AUTHORITY == &quot;2&quot;">
		 	<if test="@foren.Ognl@isNotEmpty(IN_DEPT_CODE) and @foren.Ognl@isNotEmpty(CHARGE_CODE)">
		 	 	AND (A.IN_DEPT_CODE = #{IN_DEPT_CODE} 
		        OR  A.CHARGE_CODE  = #{CHARGE_CODE} )
		 	</if>
		 	<if test="@foren.Ognl@isEmpty(IN_DEPT_CODE)">
			 	<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">		 	
			      AND   A.CHARGE_CODE  = #{CHARGE_CODE} 
			 	</if>
		 	</if>
		   </if>
		   AND ISNULL(A.CASH_NUM, 0) = 0
		   AND ISNULL(A.MOD_DIVI,'') = ''
		 ORDER BY A.AC_DATE, A.SLIP_NUM, A.SLIP_SEQ
	</select>
	<select id="agj200ukrServiceImpl.selectSalesList" parameterType="Map" resultType="rMap">	
		DECLARE	 @INPUT_PATH     NVARCHAR(02)
		
		SET @INPUT_PATH     = #{INPUT_PATH}
		
		SELECT A.AC_DATE                                            OLD_AC_DATE
	         , A.SLIP_NUM                                           OLD_SLIP_NUM
	         , A.PUB_DATE                                           OLD_PUB_DATE
	         , A.PUB_NUM                                            OLD_PUB_NUM
	         , A.AC_DATE
	         , A.SLIP_NUM
	         , SUBSTRING(A.AC_DATE,7,2)                             AC_DAY
	         , UNILITE.fnGetUserDateComp(A.COMP_CODE, A.PUB_DATE)   PUB_DATE
	         , A.PUB_NUM
	         , A.SALE_DIVI
	         , ISNULL(M1.CODE_NAME, '')                             BUSI_TYPE_NM
	         , A.CUSTOM_CODE
	         , A.CUSTOM_NAME
	         , ISNULL(M2.CODE_NAME, '')                             PROOF_KIND_NM
	         , A.SUPPLY_AMT_I
	         , A.TAX_AMT_I
	         , ISNULL(A.REMARK,'')                                  REMARK
	         , A.DEPT_NAME
	         , A.DIV_CODE
	         , A.DEPT_CODE
	         , A.IN_DEPT_CODE
	         , A.IN_DEPT_NAME
	         , A.IN_DIV_CODE
	         , A.BILL_DIV_CODE
	         , A.BUSI_TYPE
	         , A.PROOF_KIND
	         , A.CREDIT_CODE
	         , A.REASON_CODE
	         , uniLITE.fnCipherDecrypt(A.CREDIT_NUM, '')            CREDIT_NUM_EXPOS
	         , ISNULL(A.CREDIT_NUM, '')            CREDIT_NUM
	         , A.COMP_CODE
	         , ISNULL(A.ASST_SUPPLY_AMT_I, 0.0)			   ASST_SUPPLY_AMT_I
             , ISNULL(A.ASST_TAX_AMT_I, 0.0)			   	   ASST_TAX_AMT_I
             , A.ASST_DIVI
	      FROM             AGJ300T  AS A  WITH (NOLOCK)
	            LEFT  JOIN BSA100T  AS M1 WITH (NOLOCK) ON  M1.COMP_CODE = A.COMP_CODE
	                                                    AND M1.MAIN_CODE = 'A012' 
	                                                    AND M1.SUB_CODE  = A.BUSI_TYPE
	            LEFT  JOIN BSA100T  AS M2 WITH (NOLOCK) ON  M2.COMP_CODE = A.COMP_CODE
	                                                    AND M2.MAIN_CODE = 'A022' 
	                                                    AND M2.SUB_CODE  = A.PROOF_KIND
	     WHERE A.COMP_CODE       = #{S_COMP_CODE}
		   AND A.AC_DATE       &gt;= #{AC_DATE_FR}
		   AND A.AC_DATE       &lt;= #{AC_DATE_TO}
		   <if test="@foren.Ognl@isNotEmpty(SLIP_NUM)">
		   AND A.SLIP_NUM        = #{SLIP_NUM}
		   </if>
		   <if test="AUTHORITY == &quot;2&quot;">
		 	<if test="@foren.Ognl@isNotEmpty(IN_DEPT_CODE) and @foren.Ognl@isNotEmpty(CHARGE_CODE)">
		 	 	AND (A.IN_DEPT_CODE = #{IN_DEPT_CODE} 
		        OR  A.CHARGE_CODE  = #{CHARGE_CODE} )
		 	</if>
		 	<if test="@foren.Ognl@isEmpty(IN_DEPT_CODE)">
			 	<if test="@foren.Ognl@isNotEmpty(CHARGE_CODE)">		 	
			      AND   CHARGE_CODE  = #{CHARGE_CODE} 
			 	</if>
		 	</if>
		   </if>
	       AND @INPUT_PATH  = ISNULL((SELECT MAX(INPUT_PATH) 
	                                  FROM   AGJ210T WITH (NOLOCK)
	                                  WHERE  COMP_CODE = A.COMP_CODE
	                                  AND    AC_DATE   = A.AC_DATE
	                                  AND    SLIP_NUM  = A.SLIP_NUM
	                                  AND    INPUT_PATH LIKE 'Y%'
	                                  AND    ISNULL(MOD_DIVI,'') = ''),'')
	     ORDER BY A.PUB_DATE, A.PUB_NUM
	</select>
	<update id="agj200ukrServiceImpl.insertLog" parameterType="Map">
		INSERT INTO L_AGJ210T (                                                                                                                       
			                                                                                                                                        
     	KEY_VALUE        ,OPR_FLAG             	  ,COMP_CODE					 ,AUTO_NUM                                                                                                            
 		     <if test="@foren.Ognl@isNotEmpty(AC_DATE         )">,AC_DATE 					</if><if test="@foren.Ognl@isNotEmpty(SLIP_NUM        )">,SLIP_NUM            		
 		</if><if test="@foren.Ognl@isNotEmpty(SLIP_SEQ        )">,SLIP_SEQ					</if><if test="@foren.Ognl@isNotEmpty(SLIP_DIVI       )">,SLIP_DIVI                                                                                                        
	   	</if><if test="@foren.Ognl@isNotEmpty(DR_CR           )">,DR_CR               		</if><if test="@foren.Ognl@isNotEmpty(CASH_NUM        )">,CASH_NUM             	   	                                                                                     
	   	</if><if test="@foren.Ognl@isNotEmpty(ACCNT           )">,ACCNT                	   	</if><if test="@foren.Ognl@isNotEmpty(P_ACCNT         )">,P_ACCNT                                                                                                      
	   	</if><if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE     )">,CUSTOM_CODE         		</if><if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME     )">,CUSTOM_NAME          	   	                                                                                     
	   	</if><if test="@foren.Ognl@isNotEmpty(MONEY_UNIT      )">,MONEY_UNIT           	   	</if><if test="@foren.Ognl@isNotEmpty(EXCHG_RATE_O    )">,EXCHG_RATE_O                                                                                                 
	   	</if><if test="@foren.Ognl@isNotEmpty(AMT_I           )">,AMT_I                	   	</if><if test="@foren.Ognl@isNotEmpty(FOR_AMT_I       )">,FOR_AMT_I            	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(REMARK          )">,REMARK               	   	</if><if test="@foren.Ognl@isNotEmpty(IN_DIV_CODE     )">,IN_DIV_CODE                                                                                                  
	   	</if><if test="@foren.Ognl@isNotEmpty(IN_DEPT_CODE    )">,IN_DEPT_CODE         	   	</if><if test="@foren.Ognl@isNotEmpty(IN_DEPT_NAME    )">,IN_DEPT_NAME         	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(DIV_CODE        )">,DIV_CODE             	   	</if><if test="@foren.Ognl@isNotEmpty(DEPT_CODE       )">,DEPT_CODE                                                                                                    
	   	</if><if test="@foren.Ognl@isNotEmpty(DEPT_NAME       )">,DEPT_NAME            	   	</if><if test="@foren.Ognl@isNotEmpty(BILL_DIV_CODE   )">,BILL_DIV_CODE        	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CODE1        )">,AC_CODE1             	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CODE2        )">,AC_CODE2                                                                                                     
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CODE3        )">,AC_CODE3             	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CODE4        )">,AC_CODE4             	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CODE5        )">,AC_CODE5             	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CODE6        )">,AC_CODE6                                                                                                     
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA1        )">,AC_DATA1             	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA2        )">,AC_DATA2             	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA3        )">,AC_DATA3             	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA4        )">,AC_DATA4                                                                                                     
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA5        )">,AC_DATA5             	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA6        )">,AC_DATA6             	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME1   )">,AC_DATA_NAME1        	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME2   )">,AC_DATA_NAME2                                                                                                
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME3   )">,AC_DATA_NAME3        	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME4   )">,AC_DATA_NAME4        	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME5   )">,AC_DATA_NAME5        	   	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME6   )">,AC_DATA_NAME6                                                                                                
	   	</if><if test="@foren.Ognl@isNotEmpty(BOOK_CODE1      )">,BOOK_CODE1           	   	</if><if test="@foren.Ognl@isNotEmpty(BOOK_CODE2      )">,BOOK_CODE2           	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(BOOK_DATA1      )">,BOOK_DATA1           	   	</if><if test="@foren.Ognl@isNotEmpty(BOOK_DATA2      )">,BOOK_DATA2                                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(BOOK_DATA_NAME1 )">,BOOK_DATA_NAME1      	   	</if><if test="@foren.Ognl@isNotEmpty(BOOK_DATA_NAME2 )">,BOOK_DATA_NAME2      	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CTL1         )">,AC_CTL1              	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CTL2         )">,AC_CTL2                                                                                                      
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CTL3         )">,AC_CTL3              	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CTL4         )">,AC_CTL4              	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CTL5         )">,AC_CTL5              	   	</if><if test="@foren.Ognl@isNotEmpty(AC_CTL6         )">,AC_CTL6                                                                                                      
	   	</if><if test="@foren.Ognl@isNotEmpty(ACCNT_SPEC      )">,ACCNT_SPEC           	   	</if><if test="@foren.Ognl@isNotEmpty(SPEC_DIVI       )">,SPEC_DIVI            	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(PROFIT_DIVI     )">,PROFIT_DIVI          	   	</if><if test="@foren.Ognl@isNotEmpty(JAN_DIVI        )">,JAN_DIVI                                                                                                     
	   	</if><if test="@foren.Ognl@isNotEmpty(PEND_YN         )">,PEND_YN              	   	</if><if test="@foren.Ognl@isNotEmpty(PEND_CODE       )">,PEND_CODE            	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(PEND_DATA_CODE  )">,PEND_DATA_CODE       	   	</if><if test="@foren.Ognl@isNotEmpty(BUDG_YN         )">,BUDG_YN                                                                                                      
	   	</if><if test="@foren.Ognl@isNotEmpty(BUDGCTL_YN      )">,BUDGCTL_YN           	   	</if><if test="@foren.Ognl@isNotEmpty(FOR_YN          )">,FOR_YN               	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(PROOF_KIND      )">,PROOF_KIND           	   	</if><if test="@foren.Ognl@isNotEmpty(CREDIT_NUM      )">,CREDIT_NUM                                                                                                   
                                                                                                                                                                                                                                                                 
	   	</if><if test="@foren.Ognl@isNotEmpty(CREDIT_CODE     )">,CREDIT_CODE          	   	</if><if test="@foren.Ognl@isNotEmpty(REASON_CODE     )">,REASON_CODE          	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(POSTIT_YN       )">,POSTIT_YN            	   	</if><if test="@foren.Ognl@isNotEmpty(POSTIT          )">,POSTIT                                                                                                       
	   	</if><if test="@foren.Ognl@isNotEmpty(POSTIT_USER_ID  )">,POSTIT_USER_ID       	   	</if><if test="@foren.Ognl@isNotEmpty(INPUT_PATH      )">,INPUT_PATH           	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(INPUT_DIVI      )">,INPUT_DIVI           	   	</if><if test="@foren.Ognl@isNotEmpty(AUTO_SLIP_NUM   )">,AUTO_SLIP_NUM                                                                                                
	   	</if><if test="@foren.Ognl@isNotEmpty(CLOSE_FG        )">,CLOSE_FG</if>             ,INPUT_DATE    ,INPUT_USER_ID        	   	
	   		 <if test="@foren.Ognl@isNotEmpty(CHARGE_CODE     )">,CHARGE_CODE                                                                                                  
	   	</if><if test="@foren.Ognl@isNotEmpty(AP_DATE         )">,AP_DATE              	   	                                                                                   
	   	</if><if test="@foren.Ognl@isNotEmpty(AP_USER_ID      )">,AP_USER_ID           	   	</if>,AP_CHARGE_CODE                                                                                     
	   	     <if test="@foren.Ognl@isNotEmpty(DRAFT_YN        )">,DRAFT_YN                                                                                                     
	   	</if><if test="@foren.Ognl@isNotEmpty(AGREE_YN        )">,AGREE_YN             	   	</if><if test="@foren.Ognl@isNotEmpty(OLD_AC_DATE	  )">,OLD_AC_DATE				                                                                                           
	   	</if><if test="@foren.Ognl@isNotEmpty(OLD_SLIP_NUM 	  )">,OLD_SLIP_NUM 			    </if><if test="@foren.Ognl@isNotEmpty(OLD_SLIP_SEQ    )">,OLD_SLIP_SEQ
	   	</if><if test="@foren.Ognl@isNotEmpty(EX_DATE	  	  )">,EX_DATE					</if><if test="@foren.Ognl@isNotEmpty(EX_NUM 	  	  )">,EX_NUM 			    
	   	</if><if test="@foren.Ognl@isNotEmpty(EX_SEQ    	  )">,EX_SEQ 
	   	</if>                                                                                                                                                         
            <if test="@foren.Ognl@isNotEmpty(ASST_SUPPLY_AMT_I)">,ASST_SUPPLY_AMT_I         </if><if test="@foren.Ognl@isNotEmpty(ASST_TAX_AMT_I  )">,ASST_TAX_AMT_I 
        </if><if test="@foren.Ognl@isNotEmpty(ASST_DIVI       )">,ASST_DIVI              	</if>                                                                                                                                  
	   	                                                                                                                                        
	   ,INSERT_DB_USER       	   	,INSERT_DB_TIME       	      	,UPDATE_DB_USER       	   	,UPDATE_DB_TIME                                     
                                                                                                                                              
		) VALUES (                                                                                                                                  
		 	#{KEY_VALUE}             		,#{OPR_FLAG}   
		 	,#{S_COMP_CODE}					,#{AUTO_NUM}          	   	
			     <if test="@foren.Ognl@isNotEmpty(AC_DATE         )">,#{AC_DATE}     			</if><if test="@foren.Ognl@isNotEmpty(SLIP_NUM        )">,#{SLIP_NUM}            		
 			</if><if test="@foren.Ognl@isNotEmpty(SLIP_SEQ        )">,#{SLIP_SEQ}				</if><if test="@foren.Ognl@isNotEmpty(SLIP_DIVI       )">,#{SLIP_DIVI}                                                                       
			</if><if test="@foren.Ognl@isNotEmpty(DR_CR           )">,#{DR_CR}             		</if><if test="@foren.Ognl@isNotEmpty(CASH_NUM        )">,0             	   				
			</if><if test="@foren.Ognl@isNotEmpty(ACCNT           )">,#{ACCNT}  	   			</if><if test="@foren.Ognl@isNotEmpty(P_ACCNT         )">,#{P_ACCNT}                 
			</if><if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE     )">,#{CUSTOM_CODE}         	</if><if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME     )">,#{CUSTOM_NAME}          	   	
			</if><if test="@foren.Ognl@isNotEmpty(MONEY_UNIT      )">,#{MONEY_UNIT}    	   		</if><if test="@foren.Ognl@isNotEmpty(EXCHG_RATE_O    )">,#{EXCHG_RATE_O}    
			</if><if test="@foren.Ognl@isNotEmpty(AMT_I           )">,#{AMT_I}         			</if><if test="@foren.Ognl@isNotEmpty(FOR_AMT_I       )">,#{FOR_AMT_I}         			
			</if><if test="@foren.Ognl@isNotEmpty(REMARK          )">,#{REMARK}   	   			</if><if test="@foren.Ognl@isNotEmpty(IN_DIV_CODE     )">,#{IN_DIV_CODE}                         
			</if><if test="@foren.Ognl@isNotEmpty(IN_DEPT_CODE    )">,#{IN_DEPT_CODE}         	</if><if test="@foren.Ognl@isNotEmpty(IN_DEPT_NAME    )">,#{IN_DEPT_NAME}         	   	
			</if><if test="@foren.Ognl@isNotEmpty(DIV_CODE        )">,#{DIV_CODE}     	   		</if><if test="@foren.Ognl@isNotEmpty(DEPT_CODE       )">,#{DEPT_CODE}       
			</if><if test="@foren.Ognl@isNotEmpty(DEPT_NAME       )">,#{DEPT_NAME}            	</if><if test="@foren.Ognl@isNotEmpty(BILL_DIV_CODE   )">,#{BILL_DIV_CODE}        	   	
			</if><if test="@foren.Ognl@isNotEmpty(AC_CODE1        )">,#{AC_CODE1}     	   		</if><if test="@foren.Ognl@isNotEmpty(AC_CODE2        )">,#{AC_CODE2}        
			</if><if test="@foren.Ognl@isNotEmpty(AC_CODE3        )">,#{AC_CODE3}             	</if><if test="@foren.Ognl@isNotEmpty(AC_CODE4        )">,#{AC_CODE4}             	   	
			</if><if test="@foren.Ognl@isNotEmpty(AC_CODE5        )">,#{AC_CODE5}     	   		</if><if test="@foren.Ognl@isNotEmpty(AC_CODE6        )">,#{AC_CODE6}        
			</if><if test="@foren.Ognl@isNotEmpty(AC_DATA1        )">,#{AC_DATA1}             	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA2        )">,#{AC_DATA2}             	   	
			</if><if test="@foren.Ognl@isNotEmpty(AC_DATA3        )">,#{AC_DATA3}     	   		</if><if test="@foren.Ognl@isNotEmpty(AC_DATA4        )">,#{AC_DATA4}        
			</if><if test="@foren.Ognl@isNotEmpty(AC_DATA5        )">,#{AC_DATA5}             	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA6        )">,#{AC_DATA6}             	   	
			</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME1   )">,#{AC_DATA_NAME1}    		</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME2   )">,#{AC_DATA_NAME2}     
			</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME3   )">,#{AC_DATA_NAME3}        	</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME4   )">,#{AC_DATA_NAME4}        	   	
			</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME5   )">,#{AC_DATA_NAME5}    		</if><if test="@foren.Ognl@isNotEmpty(AC_DATA_NAME6   )">,#{AC_DATA_NAME6}   
			</if><if test="@foren.Ognl@isNotEmpty(BOOK_CODE1      )">,#{BOOK_CODE1}           	</if><if test="@foren.Ognl@isNotEmpty(BOOK_CODE2      )">,#{BOOK_CODE2}       	   		
			</if><if test="@foren.Ognl@isNotEmpty(BOOK_DATA1      )">,#{BOOK_DATA1}    	   		</if><if test="@foren.Ognl@isNotEmpty(BOOK_DATA2      )">,#{BOOK_DATA2}      
			</if><if test="@foren.Ognl@isNotEmpty(BOOK_DATA_NAME1 )">,#{BOOK_DATA_NAME1}      	</if><if test="@foren.Ognl@isNotEmpty(BOOK_DATA_NAME2 )">,#{BOOK_DATA_NAME2}      	   	
			</if><if test="@foren.Ognl@isNotEmpty(AC_CTL1         )">,#{AC_CTL1}    	   		</if><if test="@foren.Ognl@isNotEmpty(AC_CTL2         )">,#{AC_CTL2}         
			</if><if test="@foren.Ognl@isNotEmpty(AC_CTL3         )">,#{AC_CTL3}             	</if><if test="@foren.Ognl@isNotEmpty(AC_CTL4         )">,#{AC_CTL4}             	   	
			</if><if test="@foren.Ognl@isNotEmpty(AC_CTL5         )">,#{AC_CTL5}    	   		</if><if test="@foren.Ognl@isNotEmpty(AC_CTL6         )">,#{AC_CTL6}         
			</if><if test="@foren.Ognl@isNotEmpty(ACCNT_SPEC      )">,#{ACCNT_SPEC}           	</if><if test="@foren.Ognl@isNotEmpty(SPEC_DIVI       )">,#{SPEC_DIVI}     	   			
			</if><if test="@foren.Ognl@isNotEmpty(PROFIT_DIVI     )">,#{PROFIT_DIVI}  	   		</if><if test="@foren.Ognl@isNotEmpty(JAN_DIVI        )">,#{JAN_DIVI}          
			</if><if test="@foren.Ognl@isNotEmpty(PEND_YN         )">,#{PEND_YN}             	</if><if test="@foren.Ognl@isNotEmpty(PEND_CODE       )">,#{PEND_CODE}    	   			
			</if><if test="@foren.Ognl@isNotEmpty(PEND_DATA_CODE  )">,#{PEND_DATA_CODE}  		</if><if test="@foren.Ognl@isNotEmpty(BUDG_YN         )">,#{BUDG_YN}             
			</if><if test="@foren.Ognl@isNotEmpty(BUDGCTL_YN      )">,#{BUDGCTL_YN}           	</if><if test="@foren.Ognl@isNotEmpty(FOR_YN          )">,#{FOR_YN}             	   		
			</if><if test="@foren.Ognl@isNotEmpty(PROOF_KIND      )">,#{PROOF_KIND} 	   		</if><if test="@foren.Ognl@isNotEmpty(CREDIT_NUM      )">,#{CREDIT_NUM}
			                                                                                                                                          
			</if><if test="@foren.Ognl@isNotEmpty(CREDIT_CODE     )">,#{CREDIT_CODE}          	</if><if test="@foren.Ognl@isNotEmpty(REASON_CODE     )">,#{REASON_CODE}    	   			
			</if><if test="@foren.Ognl@isNotEmpty(POSTIT_YN       )">,#{POSTIT_YN}     	   		</if><if test="@foren.Ognl@isNotEmpty(POSTIT          )">,#{POSTIT}          
			</if><if test="@foren.Ognl@isNotEmpty(POSTIT_USER_ID  )">,#{POSTIT_USER_ID}       	</if><if test="@foren.Ognl@isNotEmpty(INPUT_PATH      )">,#{INPUT_PATH}   	   			
			</if><if test="@foren.Ognl@isNotEmpty(INPUT_DIVI      )">,#{INPUT_DIVI}     	   	</if><if test="@foren.Ognl@isNotEmpty(AUTO_SLIP_NUM   )">,#{AUTO_SLIP_NUM}     
			</if><if test="@foren.Ognl@isNotEmpty(CLOSE_FG        )">,#{CLOSE_FG}</if>			,CONVERT(NVARCHAR(8), GETDATE(),112)  ,ISNULL(#{INPUT_USER_ID},#{S_USER_ID} )    		
				 <if test="@foren.Ognl@isNotEmpty(CHARGE_CODE     )">,#{CHARGE_CODE}       
			</if><if test="@foren.Ognl@isNotEmpty(AP_DATE         )">,#{AP_DATE}             	   	
			</if><if test="@foren.Ognl@isNotEmpty(AP_USER_ID      )">,#{AP_USER_ID}     	   	</if>,isnull(#{AP_CHARGE_CODE}, #{CHARGE_CODE}  )
			     <if test="@foren.Ognl@isNotEmpty(DRAFT_YN        )">,#{DRAFT_YN}              
			</if><if test="@foren.Ognl@isNotEmpty(AGREE_YN        )">,#{AGREE_YN}             	</if><if test="@foren.Ognl@isNotEmpty(OLD_AC_DATE	  )">,#{OLD_AC_DATE}		
			</if><if test="@foren.Ognl@isNotEmpty(OLD_SLIP_NUM 	  )">,#{OLD_SLIP_NUM} 		  	</if><if test="@foren.Ognl@isNotEmpty(OLD_SLIP_SEQ      )">,#{OLD_SLIP_SEQ}                 
			</if><if test="@foren.Ognl@isNotEmpty(EX_DATE	  	  )">,#{EX_DATE}				</if><if test="@foren.Ognl@isNotEmpty(EX_NUM 	  	  )">,#{EX_NUM}			    
	   		</if><if test="@foren.Ognl@isNotEmpty(EX_SEQ    	  )">,#{EX_SEQ}     			</if>         
	   		    <if test="@foren.Ognl@isNotEmpty(ASST_SUPPLY_AMT_I)">,#{ASST_SUPPLY_AMT_I}      </if><if test="@foren.Ognl@isNotEmpty(ASST_TAX_AMT_I  )">,#{ASST_TAX_AMT_I} 
	    	</if><if test="@foren.Ognl@isNotEmpty(ASST_DIVI       )">,#{ASST_DIVI}     		    </if>                                                                                
			,#{S_USER_ID}           		,GETDATE()           			,#{S_USER_ID}           ,GETDATE()              
                                             
	   	)
	</update>
	<select id="agj200ukrServiceImpl.getSlipNum" parameterType="Map" resultType="rMap">
		SELECT ISNULL(MAX(SLIP_NUM), 0) + 1  AS SLIP_NUM
		  FROM AGJ210T WITH (NOLOCK)        
		 WHERE ISNULL(MOD_DIVI,'') = ''    
		   AND AC_DATE = #{AC_DATE}
		   AND COMP_CODE = #{S_COMP_CODE}
		 
	</select>
	<select id="agj200ukrServiceImpl.getMaxAutoNum" parameterType="Map" resultType="rMap">
		SELECT ISNULL(MAX(AUTO_NUM),0) +1 AS "MAX_AUTO_NUM" FROM L_AGJ210T  WITH (NOLOCK)
	</select>
	<select id="agj200ukrServiceImpl.selectLog" parameterType="Map" resultType="rMap">	
		SELECT KEY_VALUE      ,OPR_FLAG   	,COMP_CODE   	,AUTO_NUM    ,SLIP_NUM             	   	
		FROM  L_AGJ210T  WITH (NOLOCK)
		WHERE KEY_VALUE = #{KEY_VALUE}
		  AND AUTO_NUM = #{AUTO_NUM}
	</select>
	<select id="agj200ukrServiceImpl.selectSalesLog" parameterType="Map" resultType="rMap">	
		SELECT KEY_VALUE      ,OPR_FLAG   	,PUB_NUM 	,SLIP_NUM            	   	
		FROM  L_AGJ300T  WITH (NOLOCK)
		WHERE KEY_VALUE = #{KEY_VALUE}
	</select>
	<update id="agj200ukrServiceImpl.deleteLog" parameterType="Map">
		DELETE FROM  L_AGJ210T
		WHERE KEY_VALUE = #{KEY_VALUE}
	</update>
	<update id="agj200ukrServiceImpl.deleteLog300" parameterType="Map">
		DELETE FROM  L_AGJ300T
		WHERE KEY_VALUE = #{KEY_VALUE}
	</update>
	<update id="agj200ukrServiceImpl.spAccntAcSlip" parameterType="Map" statementType="CALLABLE">
	   
		<!-- 1) parameterMap 정의 후 사용하는 법  -->
		<!-- {call SP_SALES_SalesOrder (?,?,?,?)} -->
		
		<!-- 2) parameterMap 없이 사용하는 법  -->
		{call USP_ACCNT_AcSlip (
			#{CompCode, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
			#{KeyValue, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
			#{UserLang, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
			#{UserID, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
			#{ErrorDesc, mode=OUT, jdbcType=VARCHAR, javaType=java.lang.String}
		)}
	   
	 </update>
	 <update id="agj200ukrServiceImpl.insertLog300" parameterType="Map">
		INSERT INTO L_AGJ300T (                                                                                                                       
			                                                                                                                                        
     	KEY_VALUE        ,OPR_FLAG             	  ,COMP_CODE					
     		 <if test="@foren.Ognl@isNotEmpty(PUB_DATE      )">,PUB_DATE      		</if><if test="@foren.Ognl@isNotEmpty(PUB_NUM        )">,PUB_NUM       
		</if><if test="@foren.Ognl@isNotEmpty(SALE_DIVI     )">,SALE_DIVI     		</if><if test="@foren.Ognl@isNotEmpty(BUSI_TYPE      )">,BUSI_TYPE     
		</if><if test="@foren.Ognl@isNotEmpty(PROOF_KIND    )">,PROOF_KIND    		</if><if test="@foren.Ognl@isNotEmpty(CREDIT_NUM     )">,CREDIT_NUM    
		</if><if test="@foren.Ognl@isNotEmpty(CREDIT_CODE   )">,CREDIT_CODE   		</if><if test="@foren.Ognl@isNotEmpty(REASON_CODE    )">,REASON_CODE   
		</if><if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE   )">,CUSTOM_CODE   		</if><if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME    )">,CUSTOM_NAME   
		</if><if test="@foren.Ognl@isNotEmpty(SUPPLY_AMT_I  )">,SUPPLY_AMT_I  		</if><if test="@foren.Ognl@isNotEmpty(TAX_AMT_I      )">,TAX_AMT_I     
		</if><if test="@foren.Ognl@isNotEmpty(REMARK        )">,REMARK        		</if><if test="@foren.Ognl@isNotEmpty(IN_DIV_CODE    )">,IN_DIV_CODE   
		</if><if test="@foren.Ognl@isNotEmpty(IN_DEPT_CODE  )">,IN_DEPT_CODE  		</if><if test="@foren.Ognl@isNotEmpty(IN_DEPT_NAME   )">,IN_DEPT_NAME  
		</if><if test="@foren.Ognl@isNotEmpty(DIV_CODE      )">,DIV_CODE      		</if><if test="@foren.Ognl@isNotEmpty(DEPT_CODE      )">,DEPT_CODE     
		</if><if test="@foren.Ognl@isNotEmpty(DEPT_NAME     )">,DEPT_NAME     		</if><if test="@foren.Ognl@isNotEmpty(BILL_DIV_CODE  )">,BILL_DIV_CODE 
		</if><if test="@foren.Ognl@isNotEmpty(AC_DATE       )">,AC_DATE       		</if><if test="@foren.Ognl@isNotEmpty(SLIP_NUM         )">,SLIP_NUM        
		</if><if test="@foren.Ognl@isNotEmpty(AP_STS        )">,AP_STS        		
		</if><if test="@foren.Ognl@isNotEmpty(OLD_PUB_DATE  )">,OLD_PUB_DATE      	</if><if test="@foren.Ognl@isNotEmpty(OLD_PUB_NUM    )">,OLD_PUB_NUM    		
		</if><if test="@foren.Ognl@isNotEmpty(OLD_AC_DATE   )">,OLD_AC_DATE       	</if><if test="@foren.Ognl@isNotEmpty(OLD_SLIP_NUM   )">,OLD_SLIP_NUM     		
		</if>
	   	  <if test="@foren.Ognl@isNotEmpty(ASST_SUPPLY_AMT_I)">,ASST_SUPPLY_AMT_I   </if><if test="@foren.Ognl@isNotEmpty(ASST_TAX_AMT_I )">,ASST_TAX_AMT_I 
        </if><if test="@foren.Ognl@isNotEmpty(ASST_DIVI     )">,ASST_DIVI           </if>                                                                                                                                      
	   ,INSERT_DB_USER       	   	,INSERT_DB_TIME       	      	,UPDATE_DB_USER       	   	,UPDATE_DB_TIME                                     
                                                                                                                                              
		) VALUES (                                                                                                                                  
		 	#{KEY_VALUE}             		,#{OPR_FLAG}   		,#{S_COMP_CODE}					       	   	
			 <if test="@foren.Ognl@isNotEmpty(PUB_DATE      )">,#{PUB_DATE}      		</if><if test="@foren.Ognl@isNotEmpty(PUB_NUM        )">,#{PUB_NUM}       
		</if><if test="@foren.Ognl@isNotEmpty(SALE_DIVI     )">,#{SALE_DIVI}     		</if><if test="@foren.Ognl@isNotEmpty(BUSI_TYPE      )">,#{BUSI_TYPE}     
		</if><if test="@foren.Ognl@isNotEmpty(PROOF_KIND    )">,#{PROOF_KIND}    		</if><if test="@foren.Ognl@isNotEmpty(CREDIT_NUM     )">,#{CREDIT_NUM} 
		</if><if test="@foren.Ognl@isNotEmpty(CREDIT_CODE   )">,#{CREDIT_CODE}   		</if><if test="@foren.Ognl@isNotEmpty(REASON_CODE    )">,#{REASON_CODE}   
		</if><if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE   )">,#{CUSTOM_CODE}   		</if><if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME    )">,#{CUSTOM_NAME}   
		</if><if test="@foren.Ognl@isNotEmpty(SUPPLY_AMT_I  )">,#{SUPPLY_AMT_I}  		</if><if test="@foren.Ognl@isNotEmpty(TAX_AMT_I      )">,#{TAX_AMT_I}     
		</if><if test="@foren.Ognl@isNotEmpty(REMARK        )">,#{REMARK}        		</if><if test="@foren.Ognl@isNotEmpty(IN_DIV_CODE    )">,#{IN_DIV_CODE}   
		</if><if test="@foren.Ognl@isNotEmpty(IN_DEPT_CODE  )">,#{IN_DEPT_CODE}  		</if><if test="@foren.Ognl@isNotEmpty(IN_DEPT_NAME   )">,#{IN_DEPT_NAME}  
		</if><if test="@foren.Ognl@isNotEmpty(DIV_CODE      )">,#{DIV_CODE}      		</if><if test="@foren.Ognl@isNotEmpty(DEPT_CODE      )">,#{DEPT_CODE}     
		</if><if test="@foren.Ognl@isNotEmpty(DEPT_NAME     )">,#{DEPT_NAME}     		</if><if test="@foren.Ognl@isNotEmpty(BILL_DIV_CODE  )">,#{BILL_DIV_CODE} 
		</if><if test="@foren.Ognl@isNotEmpty(AC_DATE       )">,#{AC_DATE}       		</if><if test="@foren.Ognl@isNotEmpty(SLIP_NUM       )">,#{SLIP_NUM}        
		</if><if test="@foren.Ognl@isNotEmpty(AP_STS        )">,#{AP_STS}        		
		</if><if test="@foren.Ognl@isNotEmpty(OLD_PUB_DATE  )">,#{OLD_PUB_DATE}      	</if><if test="@foren.Ognl@isNotEmpty(OLD_PUB_NUM    )">,#{OLD_PUB_NUM}    		
		</if><if test="@foren.Ognl@isNotEmpty(OLD_AC_DATE   )">,#{OLD_AC_DATE}       	</if><if test="@foren.Ognl@isNotEmpty(OLD_SLIP_NUM   )">,#{OLD_SLIP_NUM}     		
		</if>  
		  <if test="@foren.Ognl@isNotEmpty(ASST_SUPPLY_AMT_I)">,#{ASST_SUPPLY_AMT_I}    </if><if test="@foren.Ognl@isNotEmpty(ASST_TAX_AMT_I )">,#{ASST_TAX_AMT_I} 
	    </if><if test="@foren.Ognl@isNotEmpty(ASST_DIVI     )">,#{ASST_DIVI}     		</if>
			,#{S_USER_ID}           		,GETDATE()           			,#{S_USER_ID}           ,GETDATE()              
                                             
	   	)
	</update>
	 <update id="agj200ukrServiceImpl.spAccntAcSlipY0" parameterType="Map" statementType="CALLABLE">
	   
		<!-- 1) parameterMap 정의 후 사용하는 법  -->
		<!-- {call SP_SALES_SalesOrder (?,?,?,?)} -->
		
		<!-- 2) parameterMap 없이 사용하는 법  -->
		{call USP_ACCNT_AcSlipY0 (
			#{CompCode, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
			#{KeyValue, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
			#{UserLang, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
			#{UserID, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
			#{ErrorDesc, mode=OUT, jdbcType=VARCHAR, javaType=java.lang.String}
		)}
	   
	 </update>
	 <select id="agj200ukrServiceImpl.getPubNum" parameterType="Map" resultType="rMap">
		SELECT ISNULL(MAX(PUB_NUM), 0) + 1  AS PUB_NUM
		  FROM AGJ300T WITH (NOLOCK)        
		 WHERE COMP_CODE = #{S_COMP_CODE}
		   AND PUB_DATE = #{PUB_DATE}
		 
	</select>
	<select id="agj200ukrServiceImpl.selectDuplicate" parameterType="Map" resultType="rMap">
    	SELECT 	COUNT(*) AS CNT	    
    	   FROM AGJ210T WITH (NOLOCK)
    	  WHERE COMP_CODE   = #{S_COMP_CODE}
    	 	AND AC_DATE     = #{AC_DATE}         
		    AND DR_CR       = #{DR_CR}         
		    AND ACCNT       = #{ACCNT}         
		    AND CUSTOM_CODE = ISNULL(#{CUSTOM_CODE}, '')          
		    AND AMT_I       = #{AMT_I}         
		    AND DIV_CODE    = #{DIV_CODE} 
		    AND ISNULL(MOD_DIVI  ,'') =''  
    </select>
</mapper>