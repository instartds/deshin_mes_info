<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="gri500ukrvServiceImpl">
	<select id="gri500ukrvServiceImpl.selectMaster" parameterType="Map" resultType="rMap">
		IF EXISTS(SELECT TOP 1 1 FROM Gri500T WHERE COMP_CODE = #{S_COMP_CODE} AND SERVICE_YEAR = #{SERVICE_YEAR})
	   		BEGIN
			SELECT  COMP_CODE
			      , SERVICE_YEAR
			      , C_O1_01
			      , C_O1_02
			      , C_O1_03
			      , C_O1_06
			      , C_O1_07
			      , C_O1_08
			      , C_O2_01
			      , C_O2_02
			      , C_O2_03
			      , C_O3_01
			      , C_O3_02
			      , C_O3_03
			      , C_O3_04
			      , C_O3_05
			      , C_O4_01
			      , C_O4_02
			      , C_O4_03
			      , C_O4_04
			      , C_O4_05
			      , C_O7_01
			      , C_O7_02
			      , C_O7_03
			      , C_O8_01
			      , C_O8_02
			      , C_O8_03
			      , C_O8_04
			      , C_O8_05
			      , C_O9_01
			      , C_O9_02
			      , C_O9_03
			      , C_1O_01
			      , C_1O_02
			      , C_1O_03
			      , C_11_01
			      , C_11_02
			      , C_11_03
			      , C_12_01
			      , C_12_02
			      , C_12_03
			      , C_12_06
			      , C_12_07
			      , C_12_08
			      , C_13_01
			      , C_13_02
			      , C_13_03
			      , C_13_06
			      , C_13_07
			      , C_13_08
			      , C_14_01
			      , C_14_02
			      , C_14_03
			      , C_15_01
			      , C_15_02
			      , C_15_03
			      , C_16_01
			      , C_16_02
			      , C_16_03
			      , C_16_06
			      , C_16_07
			      , C_16_08
			      , C_17_01
			      , C_17_02
			      , C_17_03
			      , C_17_04
			      , C_17_05
			      , C_17_06
			      , C_17_07
			      , C_17_08
			      , C_17_09
			      , C_17_10
			      , C_18_01
			      , C_18_02
			      , C_18_03
			      , C_18_04
			      , C_18_05
			      , C_18_06
			      , C_18_07
			      , C_18_08
			      , C_18_09
			      , C_18_10
			      , C_19_01
			      , C_19_02
			      , C_19_03
			      , C_19_04
			      , C_19_05
			      , C_19_06
			      , C_19_07
			      , C_19_08
			      , C_19_09
			      , C_19_10
			      , C_20_01
			      , C_20_02
			      , C_20_03
			      , C_20_04
			      , C_20_05
			      , C_21_01
			      , C_21_02
			      , C_21_03
			      , C_21_04
			      , C_21_05
			      , C_21_06
			      , C_21_07
			      , C_21_08
			      , C_21_09
			      , C_21_10
			      , C_22_01
			      , C_22_02
			      , C_22_03
			      , C_23_01
			      , C_23_02
			      , C_23_03
			      , C_23_06
			      , C_23_07
			      , C_23_08
			      , C_24_01
			      , C_24_02
			      , C_24_03
			      , C_24_06
			      , C_24_07
			      , C_24_08
			      , C_25_01
			      , C_25_02
			      , C_25_03
			      , C_25_06
			      , C_25_07
			      , C_25_08
			      , C_26_01
			      , C_26_02
			      , C_26_03
			      , C_26_06
			      , C_26_07
			      , C_26_08
			      , C_27_01
			      , C_27_02
			      , C_27_03
			      , C_27_06
			      , C_27_07
			      , C_27_08
			      , C_28_01
			      , C_28_02
			      , C_28_03
			      , C_28_06
			      , C_28_07
			      , C_28_08			      
			  FROM Gri500T
			  WHERE COMP_CODE = #{S_COMP_CODE}
			  	AND SERVICE_YEAR = #{SERVICE_YEAR}
	   	END	   
	ELSE
	
		BEGIN
			SELECT TOP 1 #{S_COMP_CODE} AS COMP_CODE
		      , #{SERVICE_YEAR} AS SERVICE_YEAR
		      , 0 AS C_O1_01
		      , 0 AS C_O1_02
		      , 0 AS C_O1_03
		      , 0 AS C_O1_06
		      , 0 AS C_O1_07
		      , 0 AS C_O1_08
		      , 0 AS C_O2_01
		      , 0 AS C_O2_02
		      , 0 AS C_O2_03
		      , 0 AS C_O3_01
		      , 0 AS C_O3_02
		      , 0 AS C_O3_03
		      , 0 AS C_O3_04
		      , 0 AS C_O3_05
		      , 0 AS C_O4_01
		      , 0 AS C_O4_02
		      , 0 AS C_O4_03
		      , 0 AS C_O4_04
		      , 0 AS C_O4_05
		      , 0 AS C_O7_01
		      , 0 AS C_O7_02
		      , 0 AS C_O7_03
		      , 0 AS C_O8_01
		      , 0 AS C_O8_02
		      , 0 AS C_O8_03
		      , 0 AS C_O8_04
		      , 0 AS C_O8_05
		      , 0 AS C_O9_01
		      , 0 AS C_O9_02
		      , 0 AS C_O9_03
		      , 0 AS C_1O_01
		      , 0 AS C_1O_02
		      , 0 AS C_1O_03
		      , 0 AS C_11_01
		      , 0 AS C_11_02
		      , 0 AS C_11_03
		      , 0 AS C_12_01
		      , 0 AS C_12_02
		      , 0 AS C_12_03
		      , 0 AS C_12_06
		      , 0 AS C_12_07
		      , 0 AS C_12_08
		      , 0 AS C_13_01
		      , 0 AS C_13_02
		      , 0 AS C_13_03
		      , 0 AS C_13_06
		      , 0 AS C_13_07
		      , 0 AS C_13_08
		      , 0 AS C_14_01
		      , 0 AS C_14_02
		      , 0 AS C_14_03
		      , 0 AS C_15_01
		      , 0 AS C_15_02
		      , 0 AS C_15_03
		      , 0 AS C_16_01
		      , 0 AS C_16_02
		      , 0 AS C_16_03
		      , 0 AS C_16_06
		      , 0 AS C_16_07
		      , 0 AS C_16_08
		      , 0 AS C_17_01
		      , 0 AS C_17_02
		      , 0 AS C_17_03
		      , 0 AS C_17_04
		      , 0 AS C_17_05
		      , 0 AS C_17_06
		      , 0 AS C_17_07
		      , 0 AS C_17_08
		      , 0 AS C_17_09
		      , 0 AS C_17_10
		      , 0 AS C_18_01
		      , 0 AS C_18_02
		      , 0 AS C_18_03
		      , 0 AS C_18_04
		      , 0 AS C_18_05
		      , 0 AS C_18_06
		      , 0 AS C_18_07
		      , 0 AS C_18_08
		      , 0 AS C_18_09
		      , 0 AS C_18_10
		      , 0 AS C_19_01
		      , 0 AS C_19_02
		      , 0 AS C_19_03
		      , 0 AS C_19_04
		      , 0 AS C_19_05
		      , 0 AS C_19_06
		      , 0 AS C_19_07
		      , 0 AS C_19_08
		      , 0 AS C_19_09
		      , 0 AS C_19_10
		      , 0 AS C_20_01
		      , 0 AS C_20_02
		      , 0 AS C_20_03
		      , 0 AS C_20_04
		      , 0 AS C_20_05
		      , 0 AS C_21_01
		      , 0 AS C_21_02
		      , 0 AS C_21_03
		      , 0 AS C_21_04
		      , 0 AS C_21_05
		      , 0 AS C_21_06
		      , 0 AS C_21_07
		      , 0 AS C_21_08
		      , 0 AS C_21_09
		      , 0 AS C_21_10
		      , 0 AS C_22_01
		      , 0 AS C_22_02
		      , 0 AS C_22_03
		      , 0 AS C_23_01
		      , 0 AS C_23_02
		      , 0 AS C_23_03
		      , 0 AS C_23_06
		      , 0 AS C_23_07
		      , 0 AS C_23_08
		      , 0 AS C_24_01
		      , 0 AS C_24_02
		      , 0 AS C_24_03
		      , 0 AS C_24_06
		      , 0 AS C_24_07
		      , 0 AS C_24_08
		      , 0 AS C_25_01
		      , 0 AS C_25_02
		      , 0 AS C_25_03
		      , 0 AS C_25_06
		      , 0 AS C_25_07
		      , 0 AS C_25_08
		      , 0 AS C_26_01
		      , 0 AS C_26_02
		      , 0 AS C_26_03
		      , 0 AS C_26_06
		      , 0 AS C_26_07
		      , 0 AS C_26_08
		      , 0 AS C_27_01
		      , 0 AS C_27_02
		      , 0 AS C_27_03
		      , 0 AS C_27_06
		      , 0 AS C_27_07
		      , 0 AS C_27_08
		      , 0 AS C_28_01
		      , 0 AS C_28_02
		      , 0 AS C_28_03
		      , 0 AS C_28_06
		      , 0 AS C_28_07
		      , 0 AS C_28_08
		END
	</select>
	
	<update id="gri500ukrvServiceImpl.deleteUpdate" parameterType="Map">
		/* gri500ukrvServiceImpl.deleteUpdate */
		
			DELETE FROM  Gri500T
			 WHERE COMP_CODE= #{COMP_CODE}
			   AND SERVICE_YEAR = #{SERVICE_YEAR}
		
			INSERT INTO Gri500T(
		  	    SERVICE_YEAR
			  , COMP_CODE
			  , C_O1_01
		      , C_O1_02
		      , C_O1_03
		      , C_O1_06
		      , C_O1_07
		      , C_O1_08
		      , C_O2_01
		      , C_O2_02
		      , C_O2_03
		      , C_O3_01
		      , C_O3_02
		      , C_O3_03
		      , C_O3_04
		      , C_O3_05
		      , C_O4_01
		      , C_O4_02
		      , C_O4_03
		      , C_O4_04
		      , C_O4_05
		      , C_O7_01
		      , C_O7_02
		      , C_O7_03
		      , C_O8_01
		      , C_O8_02
		      , C_O8_03
		      , C_O8_04
		      , C_O8_05
		      , C_O9_01
		      , C_O9_02
		      , C_O9_03
		      , C_1O_01
		      , C_1O_02
		      , C_1O_03
		      , C_11_01
		      , C_11_02
		      , C_11_03
		      , C_12_01
		      , C_12_02
		      , C_12_03
		      , C_12_06
		      , C_12_07
		      , C_12_08
		      , C_13_01
		      , C_13_02
		      , C_13_03
		      , C_13_06
		      , C_13_07
		      , C_13_08
		      , C_14_01
		      , C_14_02
		      , C_14_03
		      , C_15_01
		      , C_15_02
		      , C_15_03
		      , C_16_01
		      , C_16_02
		      , C_16_03
		      , C_16_06
		      , C_16_07
		      , C_16_08
		      , C_17_01
		      , C_17_02
		      , C_17_03
		      , C_17_04
		      , C_17_05
		      , C_17_06
		      , C_17_07
		      , C_17_08
		      , C_17_09
		      , C_17_10
		      , C_18_01
		      , C_18_02
		      , C_18_03
		      , C_18_04
		      , C_18_05
		      , C_18_06
		      , C_18_07
		      , C_18_08
		      , C_18_09
		      , C_18_10
		      , C_19_01
		      , C_19_02
		      , C_19_03
		      , C_19_04
		      , C_19_05
		      , C_19_06
		      , C_19_07
		      , C_19_08
		      , C_19_09
		      , C_19_10
		      , C_20_01
		      , C_20_02
		      , C_20_03
		      , C_20_04
		      , C_20_05
		      , C_21_01
		      , C_21_02
		      , C_21_03
		      , C_21_04
		      , C_21_05
		      , C_21_06
		      , C_21_07
		      , C_21_08
		      , C_21_09
		      , C_21_10
		      , C_22_01
		      , C_22_02
		      , C_22_03
		      , C_23_01
		      , C_23_02
		      , C_23_03
		      , C_23_06
		      , C_23_07
		      , C_23_08
		      , C_24_01
		      , C_24_02
		      , C_24_03
		      , C_24_06
		      , C_24_07
		      , C_24_08
		      , C_25_01
		      , C_25_02
		      , C_25_03
		      , C_25_06
		      , C_25_07
		      , C_25_08
		      , C_26_01
		      , C_26_02
		      , C_26_03
		      , C_26_06
		      , C_26_07
		      , C_26_08
		      , C_27_01
		      , C_27_02
		      , C_27_03
		      , C_27_06
		      , C_27_07
		      , C_27_08
		      , C_28_01
		      , C_28_02
		      , C_28_03
		      , C_28_06
		      , C_28_07
		      , C_28_08		    
		      , UPDATE_DB_USER
			  , UPDATE_DB_TIME
		  )
			VALUES(
			    #{SERVICE_YEAR}
			  , #{COMP_CODE}
		      , #{C_O1_01}
		      , #{C_O1_02}
		      , #{C_O1_03}
		      , #{C_O1_06}
		      , #{C_O1_07}
		      , #{C_O1_08}
		      , #{C_O2_01}
		      , #{C_O2_02}
		      , #{C_O2_03}
		      , #{C_O3_01}
		      , #{C_O3_02}
		      , #{C_O3_03}
		      , #{C_O3_04}
		      , #{C_O3_05}
		      , #{C_O4_01}
		      , #{C_O4_02}
		      , #{C_O4_03}
		      , #{C_O4_04}
		      , #{C_O4_05}
		      , #{C_O7_01}
		      , #{C_O7_02}
		      , #{C_O7_03}
		      , #{C_O8_01}
		      , #{C_O8_02}
		      , #{C_O8_03}
		      , #{C_O8_04}
		      , #{C_O8_05}
		      , #{C_O9_01}
		      , #{C_O9_02}
		      , #{C_O9_03}
		      , #{C_1O_01}
		      , #{C_1O_02}
		      , #{C_1O_03}
		      , #{C_11_01}
		      , #{C_11_02}
		      , #{C_11_03}
		      , #{C_12_01}
		      , #{C_12_02}
		      , #{C_12_03}
		      , #{C_12_06}
		      , #{C_12_07}
		      , #{C_12_08}
		      , #{C_13_01}
		      , #{C_13_02}
		      , #{C_13_03}
		      , #{C_13_06}
		      , #{C_13_07}
		      , #{C_13_08}
		      , #{C_14_01}
		      , #{C_14_02}
		      , #{C_14_03}
		      , #{C_15_01}
		      , #{C_15_02}
		      , #{C_15_03}
		      , #{C_16_01}
		      , #{C_16_02}
		      , #{C_16_03}
		      , #{C_16_06}
		      , #{C_16_07}
		      , #{C_16_08}
		      , #{C_17_01}
		      , #{C_17_02}
		      , #{C_17_03}
		      , #{C_17_04}
		      , #{C_17_05}
		      , #{C_17_06}
		      , #{C_17_07}
		      , #{C_17_08}
		      , #{C_17_09}
		      , #{C_17_10}
		      , #{C_18_01}
		      , #{C_18_02}
		      , #{C_18_03}
		      , #{C_18_04}
		      , #{C_18_05}
		      , #{C_18_06}
		      , #{C_18_07}
		      , #{C_18_08}
		      , #{C_18_09}
		      , #{C_18_10}
		      , #{C_19_01}
		      , #{C_19_02}
		      , #{C_19_03}
		      , #{C_19_04}
		      , #{C_19_05}
		      , #{C_19_06}
		      , #{C_19_07}
		      , #{C_19_08}
		      , #{C_19_09}
		      , #{C_19_10}
		      , #{C_20_01}
		      , #{C_20_02}
		      , #{C_20_03}
		      , #{C_20_04}
		      , #{C_20_05}
		      , #{C_21_01}
		      , #{C_21_02}
		      , #{C_21_03}
		      , #{C_21_04}
		      , #{C_21_05}
		      , #{C_21_06}
		      , #{C_21_07}
		      , #{C_21_08}
		      , #{C_21_09}
		      , #{C_21_10}
		      , #{C_22_01}
		      , #{C_22_02}
		      , #{C_22_03}
		      , #{C_23_01}
		      , #{C_23_02}
		      , #{C_23_03}
		      , #{C_23_06}
		      , #{C_23_07}
		      , #{C_23_08}
		      , #{C_24_01}
		      , #{C_24_02}
		      , #{C_24_03}
		      , #{C_24_06}
		      , #{C_24_07}
		      , #{C_24_08}
		      , #{C_25_01}
		      , #{C_25_02}
		      , #{C_25_03}
		      , #{C_25_06}
		      , #{C_25_07}
		      , #{C_25_08}
		      , #{C_26_01}
		      , #{C_26_02}
		      , #{C_26_03}
		      , #{C_26_06}
		      , #{C_26_07}
		      , #{C_26_08}
		      , #{C_27_01}
		      , #{C_27_02}
		      , #{C_27_03}
		      , #{C_27_06}
		      , #{C_27_07}
		      , #{C_27_08}
		      , #{C_28_01}
		      , #{C_28_02}
		      , #{C_28_03}
		      , #{C_28_06}
		      , #{C_28_07}
		      , #{C_28_08}
		      , #{S_USER_ID}
		      , GETDATE()
		 )		 
	</update>
</mapper>