<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="S_hpa900skr_jwServiceImpl">
	
	<select id="selectPrint" parameterType="Map" resultType="rMap" >	
	/* s_hpa900skr_jwServiceImpl.selectPrimaryDataList  */	
        	
    SELECT Z.COMP_CODE
         , Z.PAY_YYYY       -- 년도
         , Z.PAY_MM         -- 월
         , Z.JOIN_DATE      -- 입사일
         , Z.DEPT_CODE      -- 부서코드
         , Z.DEPT_NAME      -- 부서명
         , Z.PERSON_NUMB    -- 사원번호
         , Z.PERSON_NAME    -- 사원명
         , Z.TIME_AMT       -- 시급
         , Z.WAGES_100      -- 기본급
         , Z.WAGES_110      -- 시간외수당
         , Z.WAGES_120      -- 휴일수당
         , Z.WAGES_130      -- 야간수당
         , Z.WAGES_140      -- 직책수당
         , Z.WAGES_150      -- 성과급
         , Z.WAGES_160      -- 출장수당
         , Z.WAGES_170      -- 제수당
         , Z.WAGES_190      -- 기능수당
    
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_01) AS DUTY_16_01     -- 야간조가산(150%) 01일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_02) AS DUTY_16_02     -- 야간조가산(150%) 02일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_03) AS DUTY_16_03     -- 야간조가산(150%) 03일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_04) AS DUTY_16_04     -- 야간조가산(150%) 04일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_05) AS DUTY_16_05     -- 야간조가산(150%) 05일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_06) AS DUTY_16_06     -- 야간조가산(150%) 06일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_07) AS DUTY_16_07     -- 야간조가산(150%) 07일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_08) AS DUTY_16_08     -- 야간조가산(150%) 08일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_09) AS DUTY_16_09     -- 야간조가산(150%) 09일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_10) AS DUTY_16_10     -- 야간조가산(150%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_11) AS DUTY_16_11     -- 야간조가산(150%) 11일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_12) AS DUTY_16_12     -- 야간조가산(150%) 12일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_13) AS DUTY_16_13     -- 야간조가산(150%) 13일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_14) AS DUTY_16_14     -- 야간조가산(150%) 14일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_15) AS DUTY_16_15     -- 야간조가산(150%) 15일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_16) AS DUTY_16_16     -- 야간조가산(150%) 16일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_17) AS DUTY_16_17     -- 야간조가산(150%) 17일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_18) AS DUTY_16_18     -- 야간조가산(150%) 18일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_19) AS DUTY_16_19     -- 야간조가산(150%) 19일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_20) AS DUTY_16_20     -- 야간조가산(150%) 20일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_21) AS DUTY_16_21     -- 야간조가산(150%) 21일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_22) AS DUTY_16_22     -- 야간조가산(150%) 22일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_23) AS DUTY_16_23     -- 야간조가산(150%) 23일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_24) AS DUTY_16_24     -- 야간조가산(150%) 24일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_25) AS DUTY_16_25     -- 야간조가산(150%) 25일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_26) AS DUTY_16_26     -- 야간조가산(150%) 26일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_27) AS DUTY_16_27     -- 야간조가산(150%) 27일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_28) AS DUTY_16_28     -- 야간조가산(150%) 28일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_29) AS DUTY_16_29     -- 야간조가산(150%) 29일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_30) AS DUTY_16_30     -- 야간조가산(150%) 30일
         , CONVERT(NUMERIC(9,6),Z.DUTY_16_31) AS DUTY_16_31     -- 야간조가산(150%) 31일
         
    
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_01) AS DUTY_17_01     -- 야간조심야(200%) 01일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_02) AS DUTY_17_02     -- 야간조심야(200%) 02일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_03) AS DUTY_17_03     -- 야간조심야(200%) 03일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_04) AS DUTY_17_04     -- 야간조심야(200%) 04일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_05) AS DUTY_17_05     -- 야간조심야(200%) 05일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_06) AS DUTY_17_06     -- 야간조심야(200%) 06일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_07) AS DUTY_17_07     -- 야간조심야(200%) 07일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_08) AS DUTY_17_08     -- 야간조심야(200%) 08일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_09) AS DUTY_17_09     -- 야간조심야(200%) 09일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_10) AS DUTY_17_10     -- 야간조심야(200%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_11) AS DUTY_17_11     -- 야간조심야(200%) 11일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_12) AS DUTY_17_12     -- 야간조심야(200%) 12일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_13) AS DUTY_17_13     -- 야간조심야(200%) 13일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_14) AS DUTY_17_14     -- 야간조심야(200%) 14일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_15) AS DUTY_17_15     -- 야간조심야(200%) 15일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_16) AS DUTY_17_16     -- 야간조심야(200%) 16일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_17) AS DUTY_17_17     -- 야간조심야(200%) 17일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_18) AS DUTY_17_18     -- 야간조심야(200%) 18일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_19) AS DUTY_17_19     -- 야간조심야(200%) 19일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_20) AS DUTY_17_20     -- 야간조심야(200%) 20일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_21) AS DUTY_17_21     -- 야간조심야(200%) 21일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_22) AS DUTY_17_22     -- 야간조심야(200%) 22일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_23) AS DUTY_17_23     -- 야간조심야(200%) 23일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_24) AS DUTY_17_24     -- 야간조심야(200%) 24일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_25) AS DUTY_17_25     -- 야간조심야(200%) 25일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_26) AS DUTY_17_26     -- 야간조심야(200%) 26일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_27) AS DUTY_17_27     -- 야간조심야(200%) 27일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_28) AS DUTY_17_28     -- 야간조심야(200%) 28일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_29) AS DUTY_17_29     -- 야간조심야(200%) 29일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_30) AS DUTY_17_30     -- 야간조심야(200%) 30일
         , CONVERT(NUMERIC(9,6),Z.DUTY_17_31) AS DUTY_17_31     -- 야간조심야(200%) 31일
    
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_01) AS DUTY_10_01     -- 연장(150%) 01일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_02) AS DUTY_10_02     -- 연장(150%) 02일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_03) AS DUTY_10_03     -- 연장(150%) 03일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_04) AS DUTY_10_04     -- 연장(150%) 04일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_05) AS DUTY_10_05     -- 연장(150%) 05일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_06) AS DUTY_10_06     -- 연장(150%) 06일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_07) AS DUTY_10_07     -- 연장(150%) 07일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_08) AS DUTY_10_08     -- 연장(150%) 08일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_09) AS DUTY_10_09     -- 연장(150%) 09일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_10) AS DUTY_10_10     -- 연장(150%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_11) AS DUTY_10_11     -- 연장(150%) 11일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_12) AS DUTY_10_12     -- 연장(150%) 12일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_13) AS DUTY_10_13     -- 연장(150%) 13일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_14) AS DUTY_10_14     -- 연장(150%) 14일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_15) AS DUTY_10_15     -- 연장(150%) 15일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_16) AS DUTY_10_16     -- 연장(150%) 16일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_17) AS DUTY_10_17     -- 연장(150%) 17일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_18) AS DUTY_10_18     -- 연장(150%) 18일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_19) AS DUTY_10_19     -- 연장(150%) 19일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_20) AS DUTY_10_20     -- 연장(150%) 20일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_21) AS DUTY_10_21     -- 연장(150%) 21일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_22) AS DUTY_10_22     -- 연장(150%) 22일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_23) AS DUTY_10_23     -- 연장(150%) 23일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_24) AS DUTY_10_24     -- 연장(150%) 24일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_25) AS DUTY_10_25     -- 연장(150%) 25일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_26) AS DUTY_10_26     -- 연장(150%) 26일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_27) AS DUTY_10_27     -- 연장(150%) 27일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_28) AS DUTY_10_28     -- 연장(150%) 28일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_29) AS DUTY_10_29     -- 연장(150%) 29일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_30) AS DUTY_10_30     -- 연장(150%) 30일
         , CONVERT(NUMERIC(9,6),Z.DUTY_10_31) AS DUTY_10_31     -- 연장(150%) 31일
    
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_01) AS DUTY_11_01     -- 심야(50%) 01일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_02) AS DUTY_11_02     -- 심야(50%) 02일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_03) AS DUTY_11_03     -- 심야(50%) 03일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_04) AS DUTY_11_04     -- 심야(50%) 04일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_05) AS DUTY_11_05     -- 심야(50%) 05일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_06) AS DUTY_11_06     -- 심야(50%) 06일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_07) AS DUTY_11_07     -- 심야(50%) 07일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_08) AS DUTY_11_08     -- 심야(50%) 08일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_09) AS DUTY_11_09     -- 심야(50%) 09일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_10) AS DUTY_11_10     -- 심야(50%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_11) AS DUTY_11_11     -- 심야(50%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_12) AS DUTY_11_12     -- 심야(50%) 12일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_13) AS DUTY_11_13     -- 심야(50%) 13일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_14) AS DUTY_11_14     -- 심야(50%) 14일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_15) AS DUTY_11_15     -- 심야(50%) 15일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_16) AS DUTY_11_16     -- 심야(50%) 16일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_17) AS DUTY_11_17     -- 심야(50%) 17일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_18) AS DUTY_11_18     -- 심야(50%) 18일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_19) AS DUTY_11_19     -- 심야(50%) 19일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_20) AS DUTY_11_20     -- 심야(50%) 20일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_21) AS DUTY_11_21     -- 심야(50%) 21일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_22) AS DUTY_11_22     -- 심야(50%) 22일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_23) AS DUTY_11_23     -- 심야(50%) 23일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_24) AS DUTY_11_24     -- 심야(50%) 24일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_25) AS DUTY_11_25     -- 심야(50%) 25일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_26) AS DUTY_11_26     -- 심야(50%) 26일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_27) AS DUTY_11_27     -- 심야(50%) 27일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_28) AS DUTY_11_28     -- 심야(50%) 28일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_29) AS DUTY_11_29     -- 심야(50%) 29일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_30) AS DUTY_11_30     -- 심야(50%) 30일
         , CONVERT(NUMERIC(9,6),Z.DUTY_11_31) AS DUTY_11_31     -- 심야(50%) 31일
    
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_01) AS DUTY_12_01     -- 특근(150%) 01일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_02) AS DUTY_12_02     -- 특근(150%) 02일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_03) AS DUTY_12_03     -- 특근(150%) 03일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_04) AS DUTY_12_04     -- 특근(150%) 04일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_05) AS DUTY_12_05     -- 특근(150%) 05일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_06) AS DUTY_12_06     -- 특근(150%) 06일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_07) AS DUTY_12_07     -- 특근(150%) 07일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_08) AS DUTY_12_08     -- 특근(150%) 08일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_09) AS DUTY_12_09     -- 특근(150%) 09일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_10) AS DUTY_12_10     -- 특근(150%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_11) AS DUTY_12_11     -- 특근(150%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_12) AS DUTY_12_12     -- 특근(150%) 12일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_13) AS DUTY_12_13     -- 특근(150%) 13일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_14) AS DUTY_12_14     -- 특근(150%) 14일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_15) AS DUTY_12_15     -- 특근(150%) 15일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_16) AS DUTY_12_16     -- 특근(150%) 16일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_17) AS DUTY_12_17     -- 특근(150%) 17일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_18) AS DUTY_12_18     -- 특근(150%) 18일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_19) AS DUTY_12_19     -- 특근(150%) 19일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_20) AS DUTY_12_20     -- 특근(150%) 20일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_21) AS DUTY_12_21     -- 특근(150%) 21일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_22) AS DUTY_12_22     -- 특근(150%) 22일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_23) AS DUTY_12_23     -- 특근(150%) 23일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_24) AS DUTY_12_24     -- 특근(150%) 24일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_25) AS DUTY_12_25     -- 특근(150%) 25일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_26) AS DUTY_12_26     -- 특근(150%) 26일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_27) AS DUTY_12_27     -- 특근(150%) 27일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_28) AS DUTY_12_28     -- 특근(150%) 28일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_29) AS DUTY_12_29     -- 특근(150%) 29일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_30) AS DUTY_12_30     -- 특근(150%) 30일
         , CONVERT(NUMERIC(9,6),Z.DUTY_12_31) AS DUTY_12_31     -- 특근(150%) 31일
    
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_01) AS DUTY_13_01     -- 특근연장(200%) 01일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_02) AS DUTY_13_02     -- 특근연장(200%) 02일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_03) AS DUTY_13_03     -- 특근연장(200%) 03일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_04) AS DUTY_13_04     -- 특근연장(200%) 04일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_05) AS DUTY_13_05     -- 특근연장(200%) 05일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_06) AS DUTY_13_06     -- 특근연장(200%) 06일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_07) AS DUTY_13_07     -- 특근연장(200%) 07일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_08) AS DUTY_13_08     -- 특근연장(200%) 08일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_09) AS DUTY_13_09     -- 특근연장(200%) 09일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_10) AS DUTY_13_10     -- 특근연장(200%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_11) AS DUTY_13_11     -- 특근연장(200%) 10일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_12) AS DUTY_13_12     -- 특근연장(200%) 12일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_13) AS DUTY_13_13     -- 특근연장(200%) 13일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_14) AS DUTY_13_14     -- 특근연장(200%) 14일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_15) AS DUTY_13_15     -- 특근연장(200%) 15일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_16) AS DUTY_13_16     -- 특근연장(200%) 16일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_17) AS DUTY_13_17     -- 특근연장(200%) 17일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_18) AS DUTY_13_18     -- 특근연장(200%) 18일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_19) AS DUTY_13_19     -- 특근연장(200%) 19일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_20) AS DUTY_13_20     -- 특근연장(200%) 20일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_21) AS DUTY_13_21     -- 특근연장(200%) 21일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_22) AS DUTY_13_22     -- 특근연장(200%) 22일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_23) AS DUTY_13_23     -- 특근연장(200%) 23일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_24) AS DUTY_13_24     -- 특근연장(200%) 24일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_25) AS DUTY_13_25     -- 특근연장(200%) 25일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_26) AS DUTY_13_26     -- 특근연장(200%) 26일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_27) AS DUTY_13_27     -- 특근연장(200%) 27일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_28) AS DUTY_13_28     -- 특근연장(200%) 28일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_29) AS DUTY_13_29     -- 특근연장(200%) 29일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_30) AS DUTY_13_30     -- 특근연장(200%) 30일
         , CONVERT(NUMERIC(9,6),Z.DUTY_13_31) AS DUTY_13_31     -- 특근연장(200%) 31일
                                          
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_01) AS DUTY_5556_01   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_02) AS DUTY_5556_02   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_03) AS DUTY_5556_03   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_04) AS DUTY_5556_04   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_05) AS DUTY_5556_05   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_06) AS DUTY_5556_06   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_07) AS DUTY_5556_07   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_08) AS DUTY_5556_08   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_09) AS DUTY_5556_09   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_10) AS DUTY_5556_10   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_11) AS DUTY_5556_11   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_12) AS DUTY_5556_12   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_13) AS DUTY_5556_13   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_14) AS DUTY_5556_14   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_15) AS DUTY_5556_15   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_16) AS DUTY_5556_16   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_17) AS DUTY_5556_17   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_18) AS DUTY_5556_18   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_19) AS DUTY_5556_19   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_20) AS DUTY_5556_20   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_21) AS DUTY_5556_21   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_22) AS DUTY_5556_22   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_23) AS DUTY_5556_23   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_24) AS DUTY_5556_24   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_25) AS DUTY_5556_25   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_26) AS DUTY_5556_26   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_27) AS DUTY_5556_27   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_28) AS DUTY_5556_28   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_29) AS DUTY_5556_29   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_30) AS DUTY_5556_30   -- 지각/조퇴
         , CONVERT(NUMERIC(9,6),Z.DUTY_5556_31) AS DUTY_5556_31   -- 지각/조퇴
    
         , Z.DUTY_20_01     -- 결근
         , Z.DUTY_20_02     -- 결근
         , Z.DUTY_20_03     -- 결근
         , Z.DUTY_20_04     -- 결근
         , Z.DUTY_20_05     -- 결근
         , Z.DUTY_20_06     -- 결근
         , Z.DUTY_20_07     -- 결근
         , Z.DUTY_20_08     -- 결근
         , Z.DUTY_20_09     -- 결근
         , Z.DUTY_20_10     -- 결근
         , Z.DUTY_20_11     -- 결근
         , Z.DUTY_20_12     -- 결근
         , Z.DUTY_20_13     -- 결근
         , Z.DUTY_20_14     -- 결근
         , Z.DUTY_20_15     -- 결근
         , Z.DUTY_20_16     -- 결근
         , Z.DUTY_20_17     -- 결근
         , Z.DUTY_20_18     -- 결근
         , Z.DUTY_20_19     -- 결근
         , Z.DUTY_20_20     -- 결근
         , Z.DUTY_20_21     -- 결근
         , Z.DUTY_20_22     -- 결근
         , Z.DUTY_20_23     -- 결근
         , Z.DUTY_20_24     -- 결근
         , Z.DUTY_20_25     -- 결근
         , Z.DUTY_20_26     -- 결근
         , Z.DUTY_20_27     -- 결근
         , Z.DUTY_20_28     -- 결근
         , Z.DUTY_20_29     -- 결근
         , Z.DUTY_20_30     -- 결근
         , Z.DUTY_20_31     -- 결근
    
         , CONVERT(NUMERIC,Z.DUTY_16_AMT) AS DUTY_16_AMT    -- 야간조가산(150%) 수당
         , CONVERT(NUMERIC,Z.DUTY_17_AMT) AS DUTY_17_AMT    -- 야간조심야(200%) 수당
         , CONVERT(NUMERIC,Z.DUTY_10_AMT) AS DUTY_10_AMT    -- 연장(150%)    수당
         , CONVERT(NUMERIC,Z.DUTY_11_AMT) AS DUTY_11_AMT    -- 심야(50%)     수당
         , CONVERT(NUMERIC,Z.DUTY_12_AMT) AS DUTY_12_AMT    -- 특근(150%)    수당
         , CONVERT(NUMERIC,Z.DUTY_13_AMT) AS DUTY_13_AMT    -- 특근연장(200%)  수당
    
         , Z.WAGES_100   + Z.WAGES_110   + Z.WAGES_120   + Z.WAGES_130   + Z.WAGES_140   +
           Z.WAGES_150   + Z.WAGES_160   + Z.WAGES_170   + Z.WAGES_190   + Z.DUTY_16_AMT +
           Z.DUTY_17_AMT + Z.DUTY_10_AMT + Z.DUTY_11_AMT + Z.DUTY_12_AMT + Z.DUTY_13_AMT                 AS PAY_TOT_AMT    -- 총급여
    
         , Z.DED_AMT_ANU    -- 공제 - 국민연금
         , Z.DED_AMT_MED    -- 공제 - 건강보험
         , Z.DED_AMT_LCI    -- 공제 - 요양보험
         , Z.DED_AMT_HIR    -- 공제 - 고용보험
         , Z.DED_AMT_INC    -- 공제 - 소득세
         , Z.DED_AMT_LOC    -- 공제 - 지방소득세(주민세)
         , Z.DED_AMT_DUTY   -- 공제 - 근태공제
         , Z.DED_AMT_002    -- 공제 - 기타공제
         , Z.DED_AMT_S01    -- 공제 - 연말정산
    
         , Z.DED_AMT_ANU  + Z.DED_AMT_MED  + Z.DED_AMT_LCI  + Z.DED_AMT_HIR  + Z.DED_AMT_INC  +
           Z.DED_AMT_LOC  + Z.DED_AMT_DUTY + Z.DED_AMT_002  + Z.DED_AMT_S01                       AS DED_TOT_AMT    -- 공제 - 총계
    
         , (Z.WAGES_100   + Z.WAGES_110   + Z.WAGES_120   + Z.WAGES_130   + Z.WAGES_140   +
            Z.WAGES_150   + Z.WAGES_160   + Z.WAGES_170   + Z.WAGES_190   + Z.DUTY_16_AMT +
            Z.DUTY_17_AMT + Z.DUTY_10_AMT + Z.DUTY_11_AMT + Z.DUTY_12_AMT + Z.DUTY_13_AMT ) -
           (Z.DED_AMT_ANU  + Z.DED_AMT_MED  + Z.DED_AMT_LCI  + Z.DED_AMT_HIR  + Z.DED_AMT_INC  +
            Z.DED_AMT_LOC  + Z.DED_AMT_DUTY + Z.DED_AMT_002  + Z.DED_AMT_S01)                     AS REAL_AMOUNT_I  -- 차인지급액
         , 0 AS REAL_AMOUNT_I2
    FROM (
            SELECT A.COMP_CODE
                 , LEFT(#{BASE_DATE}, 4)  + ' 년도'   AS PAY_YYYY       -- 년도
                 , RIGHT(#{BASE_DATE}, 2) + ' 월'     AS PAY_MM         -- 월
                 , B.JOIN_DATE                    AS JOIN_DATE      -- 입사일
                 , B.DEPT_CODE                    AS DEPT_CODE      -- 부서코드
                 , B.DEPT_NAME                    AS DEPT_NAME      -- 부서명
                 , A.PERSON_NUMB                  AS PERSON_NUMB    -- 사원번호
                 , B.NAME                         AS PERSON_NAME    -- 사원명
                 , B.POST_CODE                    AS POST_CODE      -- 직위코드
                 , ISNULL(B.PAY_PRESERVE_I, 0)    AS TIME_AMT       -- 시급
                 , ISNULL(C.WAGES_100, 0)         AS WAGES_100      -- 기본급
                 , ISNULL(C.WAGES_110, 0)         AS WAGES_110      -- 시간외수당
                 , ISNULL(C.WAGES_120, 0)         AS WAGES_120      -- 휴일수당
                 , ISNULL(C.WAGES_130, 0)         AS WAGES_130      -- 야간수당
                 , ISNULL(C.WAGES_140, 0)         AS WAGES_140      -- 직책수당
                 , ISNULL(C.WAGES_150, 0)         AS WAGES_150      -- 성과급
                 , ISNULL(C.WAGES_160, 0)         AS WAGES_160      -- 출장수당
                 , ISNULL(C.WAGES_170, 0)         AS WAGES_170      -- 제수당
                 , ISNULL(C.WAGES_190, 0)         AS WAGES_190      -- 기능수당
            
                 , ISNULL(E.DUTY_16_01, 0)        AS DUTY_16_01     -- 야간조가산(150%) 01일
                 , ISNULL(E.DUTY_16_02, 0)        AS DUTY_16_02     -- 야간조가산(150%) 02일
                 , ISNULL(E.DUTY_16_03, 0)        AS DUTY_16_03     -- 야간조가산(150%) 03일
                 , ISNULL(E.DUTY_16_04, 0)        AS DUTY_16_04     -- 야간조가산(150%) 04일
                 , ISNULL(E.DUTY_16_05, 0)        AS DUTY_16_05     -- 야간조가산(150%) 05일
                 , ISNULL(E.DUTY_16_06, 0)        AS DUTY_16_06     -- 야간조가산(150%) 06일
                 , ISNULL(E.DUTY_16_07, 0)        AS DUTY_16_07     -- 야간조가산(150%) 07일
                 , ISNULL(E.DUTY_16_08, 0)        AS DUTY_16_08     -- 야간조가산(150%) 08일
                 , ISNULL(E.DUTY_16_09, 0)        AS DUTY_16_09     -- 야간조가산(150%) 09일
                 , ISNULL(E.DUTY_16_10, 0)        AS DUTY_16_10     -- 야간조가산(150%) 10일
                 , ISNULL(E.DUTY_16_11, 0)        AS DUTY_16_11     -- 야간조가산(150%) 10일
                 , ISNULL(E.DUTY_16_12, 0)        AS DUTY_16_12     -- 야간조가산(150%) 12일
                 , ISNULL(E.DUTY_16_13, 0)        AS DUTY_16_13     -- 야간조가산(150%) 13일
                 , ISNULL(E.DUTY_16_14, 0)        AS DUTY_16_14     -- 야간조가산(150%) 14일
                 , ISNULL(E.DUTY_16_15, 0)        AS DUTY_16_15     -- 야간조가산(150%) 15일
                 , ISNULL(E.DUTY_16_16, 0)        AS DUTY_16_16     -- 야간조가산(150%) 16일
                 , ISNULL(E.DUTY_16_17, 0)        AS DUTY_16_17     -- 야간조가산(150%) 17일
                 , ISNULL(E.DUTY_16_18, 0)        AS DUTY_16_18     -- 야간조가산(150%) 18일
                 , ISNULL(E.DUTY_16_19, 0)        AS DUTY_16_19     -- 야간조가산(150%) 19일
                 , ISNULL(E.DUTY_16_20, 0)        AS DUTY_16_20     -- 야간조가산(150%) 20일
                 , ISNULL(E.DUTY_16_21, 0)        AS DUTY_16_21     -- 야간조가산(150%) 21일
                 , ISNULL(E.DUTY_16_22, 0)        AS DUTY_16_22     -- 야간조가산(150%) 22일
                 , ISNULL(E.DUTY_16_23, 0)        AS DUTY_16_23     -- 야간조가산(150%) 23일
                 , ISNULL(E.DUTY_16_24, 0)        AS DUTY_16_24     -- 야간조가산(150%) 24일
                 , ISNULL(E.DUTY_16_25, 0)        AS DUTY_16_25     -- 야간조가산(150%) 25일
                 , ISNULL(E.DUTY_16_26, 0)        AS DUTY_16_26     -- 야간조가산(150%) 26일
                 , ISNULL(E.DUTY_16_27, 0)        AS DUTY_16_27     -- 야간조가산(150%) 27일
                 , ISNULL(E.DUTY_16_28, 0)        AS DUTY_16_28     -- 야간조가산(150%) 28일
                 , ISNULL(E.DUTY_16_29, 0)        AS DUTY_16_29     -- 야간조가산(150%) 29일
                 , ISNULL(E.DUTY_16_30, 0)        AS DUTY_16_30     -- 야간조가산(150%) 30일
                 , ISNULL(E.DUTY_16_31, 0)        AS DUTY_16_31     -- 야간조가산(150%) 31일
            
                 , ISNULL(F.DUTY_17_01, 0)        AS DUTY_17_01     -- 야간조심야(200%) 01일
                 , ISNULL(F.DUTY_17_02, 0)        AS DUTY_17_02     -- 야간조심야(200%) 02일
                 , ISNULL(F.DUTY_17_03, 0)        AS DUTY_17_03     -- 야간조심야(200%) 03일
                 , ISNULL(F.DUTY_17_04, 0)        AS DUTY_17_04     -- 야간조심야(200%) 04일
                 , ISNULL(F.DUTY_17_05, 0)        AS DUTY_17_05     -- 야간조심야(200%) 05일
                 , ISNULL(F.DUTY_17_06, 0)        AS DUTY_17_06     -- 야간조심야(200%) 06일
                 , ISNULL(F.DUTY_17_07, 0)        AS DUTY_17_07     -- 야간조심야(200%) 07일
                 , ISNULL(F.DUTY_17_08, 0)        AS DUTY_17_08     -- 야간조심야(200%) 08일
                 , ISNULL(F.DUTY_17_09, 0)        AS DUTY_17_09     -- 야간조심야(200%) 09일
                 , ISNULL(F.DUTY_17_10, 0)        AS DUTY_17_10     -- 야간조심야(200%) 10일
                 , ISNULL(F.DUTY_17_11, 0)        AS DUTY_17_11     -- 야간조심야(200%) 10일
                 , ISNULL(F.DUTY_17_12, 0)        AS DUTY_17_12     -- 야간조심야(200%) 12일
                 , ISNULL(F.DUTY_17_13, 0)        AS DUTY_17_13     -- 야간조심야(200%) 13일
                 , ISNULL(F.DUTY_17_14, 0)        AS DUTY_17_14     -- 야간조심야(200%) 14일
                 , ISNULL(F.DUTY_17_15, 0)        AS DUTY_17_15     -- 야간조심야(200%) 15일
                 , ISNULL(F.DUTY_17_16, 0)        AS DUTY_17_16     -- 야간조심야(200%) 16일
                 , ISNULL(F.DUTY_17_17, 0)        AS DUTY_17_17     -- 야간조심야(200%) 17일
                 , ISNULL(F.DUTY_17_18, 0)        AS DUTY_17_18     -- 야간조심야(200%) 18일
                 , ISNULL(F.DUTY_17_19, 0)        AS DUTY_17_19     -- 야간조심야(200%) 19일
                 , ISNULL(F.DUTY_17_20, 0)        AS DUTY_17_20     -- 야간조심야(200%) 20일
                 , ISNULL(F.DUTY_17_21, 0)        AS DUTY_17_21     -- 야간조심야(200%) 21일
                 , ISNULL(F.DUTY_17_22, 0)        AS DUTY_17_22     -- 야간조심야(200%) 22일
                 , ISNULL(F.DUTY_17_23, 0)        AS DUTY_17_23     -- 야간조심야(200%) 23일
                 , ISNULL(F.DUTY_17_24, 0)        AS DUTY_17_24     -- 야간조심야(200%) 24일
                 , ISNULL(F.DUTY_17_25, 0)        AS DUTY_17_25     -- 야간조심야(200%) 25일
                 , ISNULL(F.DUTY_17_26, 0)        AS DUTY_17_26     -- 야간조심야(200%) 26일
                 , ISNULL(F.DUTY_17_27, 0)        AS DUTY_17_27     -- 야간조심야(200%) 27일
                 , ISNULL(F.DUTY_17_28, 0)        AS DUTY_17_28     -- 야간조심야(200%) 28일
                 , ISNULL(F.DUTY_17_29, 0)        AS DUTY_17_29     -- 야간조심야(200%) 29일
                 , ISNULL(F.DUTY_17_30, 0)        AS DUTY_17_30     -- 야간조심야(200%) 30일
                 , ISNULL(F.DUTY_17_31, 0)        AS DUTY_17_31     -- 야간조심야(200%) 31일
            
                 , ISNULL(G.DUTY_10_01, 0)        AS DUTY_10_01     -- 연장(150%) 01일
                 , ISNULL(G.DUTY_10_02, 0)        AS DUTY_10_02     -- 연장(150%) 02일
                 , ISNULL(G.DUTY_10_03, 0)        AS DUTY_10_03     -- 연장(150%) 03일
                 , ISNULL(G.DUTY_10_04, 0)        AS DUTY_10_04     -- 연장(150%) 04일
                 , ISNULL(G.DUTY_10_05, 0)        AS DUTY_10_05     -- 연장(150%) 05일
                 , ISNULL(G.DUTY_10_06, 0)        AS DUTY_10_06     -- 연장(150%) 06일
                 , ISNULL(G.DUTY_10_07, 0)        AS DUTY_10_07     -- 연장(150%) 07일
                 , ISNULL(G.DUTY_10_08, 0)        AS DUTY_10_08     -- 연장(150%) 08일
                 , ISNULL(G.DUTY_10_09, 0)        AS DUTY_10_09     -- 연장(150%) 09일
                 , ISNULL(G.DUTY_10_10, 0)        AS DUTY_10_10     -- 연장(150%) 10일
                 , ISNULL(G.DUTY_10_11, 0)        AS DUTY_10_11     -- 연장(150%) 10일
                 , ISNULL(G.DUTY_10_12, 0)        AS DUTY_10_12     -- 연장(150%) 12일
                 , ISNULL(G.DUTY_10_13, 0)        AS DUTY_10_13     -- 연장(150%) 13일
                 , ISNULL(G.DUTY_10_14, 0)        AS DUTY_10_14     -- 연장(150%) 14일
                 , ISNULL(G.DUTY_10_15, 0)        AS DUTY_10_15     -- 연장(150%) 15일
                 , ISNULL(G.DUTY_10_16, 0)        AS DUTY_10_16     -- 연장(150%) 16일
                 , ISNULL(G.DUTY_10_17, 0)        AS DUTY_10_17     -- 연장(150%) 17일
                 , ISNULL(G.DUTY_10_18, 0)        AS DUTY_10_18     -- 연장(150%) 18일
                 , ISNULL(G.DUTY_10_19, 0)        AS DUTY_10_19     -- 연장(150%) 19일
                 , ISNULL(G.DUTY_10_20, 0)        AS DUTY_10_20     -- 연장(150%) 20일
                 , ISNULL(G.DUTY_10_21, 0)        AS DUTY_10_21     -- 연장(150%) 21일
                 , ISNULL(G.DUTY_10_22, 0)        AS DUTY_10_22     -- 연장(150%) 22일
                 , ISNULL(G.DUTY_10_23, 0)        AS DUTY_10_23     -- 연장(150%) 23일
                 , ISNULL(G.DUTY_10_24, 0)        AS DUTY_10_24     -- 연장(150%) 24일
                 , ISNULL(G.DUTY_10_25, 0)        AS DUTY_10_25     -- 연장(150%) 25일
                 , ISNULL(G.DUTY_10_26, 0)        AS DUTY_10_26     -- 연장(150%) 26일
                 , ISNULL(G.DUTY_10_27, 0)        AS DUTY_10_27     -- 연장(150%) 27일
                 , ISNULL(G.DUTY_10_28, 0)        AS DUTY_10_28     -- 연장(150%) 28일
                 , ISNULL(G.DUTY_10_29, 0)        AS DUTY_10_29     -- 연장(150%) 29일
                 , ISNULL(G.DUTY_10_30, 0)        AS DUTY_10_30     -- 연장(150%) 30일
                 , ISNULL(G.DUTY_10_31, 0)        AS DUTY_10_31     -- 연장(150%) 31일
            
                 , ISNULL(H.DUTY_11_01, 0)        AS DUTY_11_01     -- 심야(50%) 01일
                 , ISNULL(H.DUTY_11_02, 0)        AS DUTY_11_02     -- 심야(50%) 02일
                 , ISNULL(H.DUTY_11_03, 0)        AS DUTY_11_03     -- 심야(50%) 03일
                 , ISNULL(H.DUTY_11_04, 0)        AS DUTY_11_04     -- 심야(50%) 04일
                 , ISNULL(H.DUTY_11_05, 0)        AS DUTY_11_05     -- 심야(50%) 05일
                 , ISNULL(H.DUTY_11_06, 0)        AS DUTY_11_06     -- 심야(50%) 06일
                 , ISNULL(H.DUTY_11_07, 0)        AS DUTY_11_07     -- 심야(50%) 07일
                 , ISNULL(H.DUTY_11_08, 0)        AS DUTY_11_08     -- 심야(50%) 08일
                 , ISNULL(H.DUTY_11_09, 0)        AS DUTY_11_09     -- 심야(50%) 09일
                 , ISNULL(H.DUTY_11_10, 0)        AS DUTY_11_10     -- 심야(50%) 10일
                 , ISNULL(H.DUTY_11_11, 0)        AS DUTY_11_11     -- 심야(50%) 10일
                 , ISNULL(H.DUTY_11_12, 0)        AS DUTY_11_12     -- 심야(50%) 12일
                 , ISNULL(H.DUTY_11_13, 0)        AS DUTY_11_13     -- 심야(50%) 13일
                 , ISNULL(H.DUTY_11_14, 0)        AS DUTY_11_14     -- 심야(50%) 14일
                 , ISNULL(H.DUTY_11_15, 0)        AS DUTY_11_15     -- 심야(50%) 15일
                 , ISNULL(H.DUTY_11_16, 0)        AS DUTY_11_16     -- 심야(50%) 16일
                 , ISNULL(H.DUTY_11_17, 0)        AS DUTY_11_17     -- 심야(50%) 17일
                 , ISNULL(H.DUTY_11_18, 0)        AS DUTY_11_18     -- 심야(50%) 18일
                 , ISNULL(H.DUTY_11_19, 0)        AS DUTY_11_19     -- 심야(50%) 19일
                 , ISNULL(H.DUTY_11_20, 0)        AS DUTY_11_20     -- 심야(50%) 20일
                 , ISNULL(H.DUTY_11_21, 0)        AS DUTY_11_21     -- 심야(50%) 21일
                 , ISNULL(H.DUTY_11_22, 0)        AS DUTY_11_22     -- 심야(50%) 22일
                 , ISNULL(H.DUTY_11_23, 0)        AS DUTY_11_23     -- 심야(50%) 23일
                 , ISNULL(H.DUTY_11_24, 0)        AS DUTY_11_24     -- 심야(50%) 24일
                 , ISNULL(H.DUTY_11_25, 0)        AS DUTY_11_25     -- 심야(50%) 25일
                 , ISNULL(H.DUTY_11_26, 0)        AS DUTY_11_26     -- 심야(50%) 26일
                 , ISNULL(H.DUTY_11_27, 0)        AS DUTY_11_27     -- 심야(50%) 27일
                 , ISNULL(H.DUTY_11_28, 0)        AS DUTY_11_28     -- 심야(50%) 28일
                 , ISNULL(H.DUTY_11_29, 0)        AS DUTY_11_29     -- 심야(50%) 29일
                 , ISNULL(H.DUTY_11_30, 0)        AS DUTY_11_30     -- 심야(50%) 30일
                 , ISNULL(H.DUTY_11_31, 0)        AS DUTY_11_31     -- 심야(50%) 31일
            
                 , ISNULL(I.DUTY_12_01, 0)        AS DUTY_12_01     -- 특근(150%) 01일
                 , ISNULL(I.DUTY_12_02, 0)        AS DUTY_12_02     -- 특근(150%) 02일
                 , ISNULL(I.DUTY_12_03, 0)        AS DUTY_12_03     -- 특근(150%) 03일
                 , ISNULL(I.DUTY_12_04, 0)        AS DUTY_12_04     -- 특근(150%) 04일
                 , ISNULL(I.DUTY_12_05, 0)        AS DUTY_12_05     -- 특근(150%) 05일
                 , ISNULL(I.DUTY_12_06, 0)        AS DUTY_12_06     -- 특근(150%) 06일
                 , ISNULL(I.DUTY_12_07, 0)        AS DUTY_12_07     -- 특근(150%) 07일
                 , ISNULL(I.DUTY_12_08, 0)        AS DUTY_12_08     -- 특근(150%) 08일
                 , ISNULL(I.DUTY_12_09, 0)        AS DUTY_12_09     -- 특근(150%) 09일
                 , ISNULL(I.DUTY_12_10, 0)        AS DUTY_12_10     -- 특근(150%) 10일
                 , ISNULL(I.DUTY_12_11, 0)        AS DUTY_12_11     -- 특근(150%) 10일
                 , ISNULL(I.DUTY_12_12, 0)        AS DUTY_12_12     -- 특근(150%) 12일
                 , ISNULL(I.DUTY_12_13, 0)        AS DUTY_12_13     -- 특근(150%) 13일
                 , ISNULL(I.DUTY_12_14, 0)        AS DUTY_12_14     -- 특근(150%) 14일
                 , ISNULL(I.DUTY_12_15, 0)        AS DUTY_12_15     -- 특근(150%) 15일
                 , ISNULL(I.DUTY_12_16, 0)        AS DUTY_12_16     -- 특근(150%) 16일
                 , ISNULL(I.DUTY_12_17, 0)        AS DUTY_12_17     -- 특근(150%) 17일
                 , ISNULL(I.DUTY_12_18, 0)        AS DUTY_12_18     -- 특근(150%) 18일
                 , ISNULL(I.DUTY_12_19, 0)        AS DUTY_12_19     -- 특근(150%) 19일
                 , ISNULL(I.DUTY_12_20, 0)        AS DUTY_12_20     -- 특근(150%) 20일
                 , ISNULL(I.DUTY_12_21, 0)        AS DUTY_12_21     -- 특근(150%) 21일
                 , ISNULL(I.DUTY_12_22, 0)        AS DUTY_12_22     -- 특근(150%) 22일
                 , ISNULL(I.DUTY_12_23, 0)        AS DUTY_12_23     -- 특근(150%) 23일
                 , ISNULL(I.DUTY_12_24, 0)        AS DUTY_12_24     -- 특근(150%) 24일
                 , ISNULL(I.DUTY_12_25, 0)        AS DUTY_12_25     -- 특근(150%) 25일
                 , ISNULL(I.DUTY_12_26, 0)        AS DUTY_12_26     -- 특근(150%) 26일
                 , ISNULL(I.DUTY_12_27, 0)        AS DUTY_12_27     -- 특근(150%) 27일
                 , ISNULL(I.DUTY_12_28, 0)        AS DUTY_12_28     -- 특근(150%) 28일
                 , ISNULL(I.DUTY_12_29, 0)        AS DUTY_12_29     -- 특근(150%) 29일
                 , ISNULL(I.DUTY_12_30, 0)        AS DUTY_12_30     -- 특근(150%) 30일
                 , ISNULL(I.DUTY_12_31, 0)        AS DUTY_12_31     -- 특근(150%) 31일
            
                 , ISNULL(J.DUTY_13_01, 0)        AS DUTY_13_01     -- 특근연장(200%) 01일
                 , ISNULL(J.DUTY_13_02, 0)        AS DUTY_13_02     -- 특근연장(200%) 02일
                 , ISNULL(J.DUTY_13_03, 0)        AS DUTY_13_03     -- 특근연장(200%) 03일
                 , ISNULL(J.DUTY_13_04, 0)        AS DUTY_13_04     -- 특근연장(200%) 04일
                 , ISNULL(J.DUTY_13_05, 0)        AS DUTY_13_05     -- 특근연장(200%) 05일
                 , ISNULL(J.DUTY_13_06, 0)        AS DUTY_13_06     -- 특근연장(200%) 06일
                 , ISNULL(J.DUTY_13_07, 0)        AS DUTY_13_07     -- 특근연장(200%) 07일
                 , ISNULL(J.DUTY_13_08, 0)        AS DUTY_13_08     -- 특근연장(200%) 08일
                 , ISNULL(J.DUTY_13_09, 0)        AS DUTY_13_09     -- 특근연장(200%) 09일
                 , ISNULL(J.DUTY_13_10, 0)        AS DUTY_13_10     -- 특근연장(200%) 10일
                 , ISNULL(J.DUTY_13_11, 0)        AS DUTY_13_11     -- 특근연장(200%) 10일
                 , ISNULL(J.DUTY_13_12, 0)        AS DUTY_13_12     -- 특근연장(200%) 12일
                 , ISNULL(J.DUTY_13_13, 0)        AS DUTY_13_13     -- 특근연장(200%) 13일
                 , ISNULL(J.DUTY_13_14, 0)        AS DUTY_13_14     -- 특근연장(200%) 14일
                 , ISNULL(J.DUTY_13_15, 0)        AS DUTY_13_15     -- 특근연장(200%) 15일
                 , ISNULL(J.DUTY_13_16, 0)        AS DUTY_13_16     -- 특근연장(200%) 16일
                 , ISNULL(J.DUTY_13_17, 0)        AS DUTY_13_17     -- 특근연장(200%) 17일
                 , ISNULL(J.DUTY_13_18, 0)        AS DUTY_13_18     -- 특근연장(200%) 18일
                 , ISNULL(J.DUTY_13_19, 0)        AS DUTY_13_19     -- 특근연장(200%) 19일
                 , ISNULL(J.DUTY_13_20, 0)        AS DUTY_13_20     -- 특근연장(200%) 20일
                 , ISNULL(J.DUTY_13_21, 0)        AS DUTY_13_21     -- 특근연장(200%) 21일
                 , ISNULL(J.DUTY_13_22, 0)        AS DUTY_13_22     -- 특근연장(200%) 22일
                 , ISNULL(J.DUTY_13_23, 0)        AS DUTY_13_23     -- 특근연장(200%) 23일
                 , ISNULL(J.DUTY_13_24, 0)        AS DUTY_13_24     -- 특근연장(200%) 24일
                 , ISNULL(J.DUTY_13_25, 0)        AS DUTY_13_25     -- 특근연장(200%) 25일
                 , ISNULL(J.DUTY_13_26, 0)        AS DUTY_13_26     -- 특근연장(200%) 26일
                 , ISNULL(J.DUTY_13_27, 0)        AS DUTY_13_27     -- 특근연장(200%) 27일
                 , ISNULL(J.DUTY_13_28, 0)        AS DUTY_13_28     -- 특근연장(200%) 28일
                 , ISNULL(J.DUTY_13_29, 0)        AS DUTY_13_29     -- 특근연장(200%) 29일
                 , ISNULL(J.DUTY_13_30, 0)        AS DUTY_13_30     -- 특근연장(200%) 30일
                 , ISNULL(J.DUTY_13_31, 0)        AS DUTY_13_31     -- 특근연장(200%) 31일
                                                  
                 , ISNULL(K.DUTY_5556_01, 0)      AS DUTY_5556_01   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_02, 0)      AS DUTY_5556_02   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_03, 0)      AS DUTY_5556_03   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_04, 0)      AS DUTY_5556_04   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_05, 0)      AS DUTY_5556_05   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_06, 0)      AS DUTY_5556_06   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_07, 0)      AS DUTY_5556_07   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_08, 0)      AS DUTY_5556_08   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_09, 0)      AS DUTY_5556_09   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_10, 0)      AS DUTY_5556_10   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_11, 0)      AS DUTY_5556_11   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_12, 0)      AS DUTY_5556_12   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_13, 0)      AS DUTY_5556_13   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_14, 0)      AS DUTY_5556_14   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_15, 0)      AS DUTY_5556_15   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_16, 0)      AS DUTY_5556_16   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_17, 0)      AS DUTY_5556_17   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_18, 0)      AS DUTY_5556_18   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_19, 0)      AS DUTY_5556_19   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_20, 0)      AS DUTY_5556_20   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_21, 0)      AS DUTY_5556_21   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_22, 0)      AS DUTY_5556_22   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_23, 0)      AS DUTY_5556_23   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_24, 0)      AS DUTY_5556_24   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_25, 0)      AS DUTY_5556_25   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_26, 0)      AS DUTY_5556_26   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_27, 0)      AS DUTY_5556_27   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_28, 0)      AS DUTY_5556_28   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_29, 0)      AS DUTY_5556_29   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_30, 0)      AS DUTY_5556_30   -- 지각/조퇴
                 , ISNULL(K.DUTY_5556_31, 0)      AS DUTY_5556_31   -- 지각/조퇴
            
                 , ISNULL(L.DUTY_20_01, 0)        AS DUTY_20_01     -- 결근
                 , ISNULL(L.DUTY_20_02, 0)        AS DUTY_20_02     -- 결근
                 , ISNULL(L.DUTY_20_03, 0)        AS DUTY_20_03     -- 결근
                 , ISNULL(L.DUTY_20_04, 0)        AS DUTY_20_04     -- 결근
                 , ISNULL(L.DUTY_20_05, 0)        AS DUTY_20_05     -- 결근
                 , ISNULL(L.DUTY_20_06, 0)        AS DUTY_20_06     -- 결근
                 , ISNULL(L.DUTY_20_07, 0)        AS DUTY_20_07     -- 결근
                 , ISNULL(L.DUTY_20_08, 0)        AS DUTY_20_08     -- 결근
                 , ISNULL(L.DUTY_20_09, 0)        AS DUTY_20_09     -- 결근
                 , ISNULL(L.DUTY_20_10, 0)        AS DUTY_20_10     -- 결근
                 , ISNULL(L.DUTY_20_11, 0)        AS DUTY_20_11     -- 결근
                 , ISNULL(L.DUTY_20_12, 0)        AS DUTY_20_12     -- 결근
                 , ISNULL(L.DUTY_20_13, 0)        AS DUTY_20_13     -- 결근
                 , ISNULL(L.DUTY_20_14, 0)        AS DUTY_20_14     -- 결근
                 , ISNULL(L.DUTY_20_15, 0)        AS DUTY_20_15     -- 결근
                 , ISNULL(L.DUTY_20_16, 0)        AS DUTY_20_16     -- 결근
                 , ISNULL(L.DUTY_20_17, 0)        AS DUTY_20_17     -- 결근
                 , ISNULL(L.DUTY_20_18, 0)        AS DUTY_20_18     -- 결근
                 , ISNULL(L.DUTY_20_19, 0)        AS DUTY_20_19     -- 결근
                 , ISNULL(L.DUTY_20_20, 0)        AS DUTY_20_20     -- 결근
                 , ISNULL(L.DUTY_20_21, 0)        AS DUTY_20_21     -- 결근
                 , ISNULL(L.DUTY_20_22, 0)        AS DUTY_20_22     -- 결근
                 , ISNULL(L.DUTY_20_23, 0)        AS DUTY_20_23     -- 결근
                 , ISNULL(L.DUTY_20_24, 0)        AS DUTY_20_24     -- 결근
                 , ISNULL(L.DUTY_20_25, 0)        AS DUTY_20_25     -- 결근
                 , ISNULL(L.DUTY_20_26, 0)        AS DUTY_20_26     -- 결근
                 , ISNULL(L.DUTY_20_27, 0)        AS DUTY_20_27     -- 결근
                 , ISNULL(L.DUTY_20_28, 0)        AS DUTY_20_28     -- 결근
                 , ISNULL(L.DUTY_20_29, 0)        AS DUTY_20_29     -- 결근
                 , ISNULL(L.DUTY_20_30, 0)        AS DUTY_20_30     -- 결근
                 , ISNULL(L.DUTY_20_31, 0)        AS DUTY_20_31     -- 결근
            
                 , (ISNULL(B.PAY_PRESERVE_I, 0) *
                    ( CASE WHEN ISNULL(E.DUTY_16_01, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_01) END +
                      CASE WHEN ISNULL(E.DUTY_16_02, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_02) END +
                      CASE WHEN ISNULL(E.DUTY_16_03, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_03) END +
                      CASE WHEN ISNULL(E.DUTY_16_04, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_04) END +
                      CASE WHEN ISNULL(E.DUTY_16_05, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_05) END +
                      CASE WHEN ISNULL(E.DUTY_16_06, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_06) END +
                      CASE WHEN ISNULL(E.DUTY_16_07, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_07) END +
                      CASE WHEN ISNULL(E.DUTY_16_08, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_08) END +
                      CASE WHEN ISNULL(E.DUTY_16_09, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_09) END +
                      CASE WHEN ISNULL(E.DUTY_16_10, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_10) END +
                      CASE WHEN ISNULL(E.DUTY_16_11, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_11) END +
                      CASE WHEN ISNULL(E.DUTY_16_12, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_12) END +
                      CASE WHEN ISNULL(E.DUTY_16_13, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_13) END +
                      CASE WHEN ISNULL(E.DUTY_16_14, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_14) END +
                      CASE WHEN ISNULL(E.DUTY_16_15, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_15) END +
                      CASE WHEN ISNULL(E.DUTY_16_16, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_16) END +
                      CASE WHEN ISNULL(E.DUTY_16_17, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_17) END +
                      CASE WHEN ISNULL(E.DUTY_16_18, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_18) END +
                      CASE WHEN ISNULL(E.DUTY_16_19, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_19) END +
                      CASE WHEN ISNULL(E.DUTY_16_20, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_20) END +
                      CASE WHEN ISNULL(E.DUTY_16_21, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_21) END +
                      CASE WHEN ISNULL(E.DUTY_16_22, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_22) END +
                      CASE WHEN ISNULL(E.DUTY_16_23, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_23) END +
                      CASE WHEN ISNULL(E.DUTY_16_24, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_24) END +
                      CASE WHEN ISNULL(E.DUTY_16_25, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_25) END +
                      CASE WHEN ISNULL(E.DUTY_16_26, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_26) END +
                      CASE WHEN ISNULL(E.DUTY_16_27, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_27) END +
                      CASE WHEN ISNULL(E.DUTY_16_28, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_28) END +
                      CASE WHEN ISNULL(E.DUTY_16_29, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_29) END +
                      CASE WHEN ISNULL(E.DUTY_16_30, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_30) END +
                      CASE WHEN ISNULL(E.DUTY_16_31, '') = '' THEN 0 ELSE CONVERT(NUMERIC, E.DUTY_16_31) END ) ) * 1.5         AS DUTY_16_AMT    -- 야간조가산(150%) 수당
    
                 , (ISNULL(B.PAY_PRESERVE_I, 0) *
                    ( CASE WHEN ISNULL(F.DUTY_17_01, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_01) END +
                      CASE WHEN ISNULL(F.DUTY_17_02, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_02) END +
                      CASE WHEN ISNULL(F.DUTY_17_03, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_03) END +
                      CASE WHEN ISNULL(F.DUTY_17_04, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_04) END +
                      CASE WHEN ISNULL(F.DUTY_17_05, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_05) END +
                      CASE WHEN ISNULL(F.DUTY_17_06, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_06) END +
                      CASE WHEN ISNULL(F.DUTY_17_07, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_07) END +
                      CASE WHEN ISNULL(F.DUTY_17_08, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_08) END +
                      CASE WHEN ISNULL(F.DUTY_17_09, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_09) END +
                      CASE WHEN ISNULL(F.DUTY_17_10, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_10) END +
                      CASE WHEN ISNULL(F.DUTY_17_11, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_11) END +
                      CASE WHEN ISNULL(F.DUTY_17_12, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_12) END +
                      CASE WHEN ISNULL(F.DUTY_17_13, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_13) END +
                      CASE WHEN ISNULL(F.DUTY_17_14, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_14) END +
                      CASE WHEN ISNULL(F.DUTY_17_15, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_15) END +
                      CASE WHEN ISNULL(F.DUTY_17_16, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_16) END +
                      CASE WHEN ISNULL(F.DUTY_17_17, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_17) END +
                      CASE WHEN ISNULL(F.DUTY_17_18, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_18) END +
                      CASE WHEN ISNULL(F.DUTY_17_19, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_19) END +
                      CASE WHEN ISNULL(F.DUTY_17_20, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_20) END +
                      CASE WHEN ISNULL(F.DUTY_17_21, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_21) END +
                      CASE WHEN ISNULL(F.DUTY_17_22, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_22) END +
                      CASE WHEN ISNULL(F.DUTY_17_23, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_23) END +
                      CASE WHEN ISNULL(F.DUTY_17_24, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_24) END +
                      CASE WHEN ISNULL(F.DUTY_17_25, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_25) END +
                      CASE WHEN ISNULL(F.DUTY_17_26, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_26) END +
                      CASE WHEN ISNULL(F.DUTY_17_27, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_27) END +
                      CASE WHEN ISNULL(F.DUTY_17_28, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_28) END +
                      CASE WHEN ISNULL(F.DUTY_17_29, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_29) END +
                      CASE WHEN ISNULL(F.DUTY_17_30, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_30) END +
                      CASE WHEN ISNULL(F.DUTY_17_31, '') = '' THEN 0 ELSE CONVERT(NUMERIC, F.DUTY_17_31) END ) ) * 2.0         AS DUTY_17_AMT    -- 야간조심야(200%) 수당
    
                 , (ISNULL(B.PAY_PRESERVE_I, 0) *
                    ( CASE WHEN ISNULL(G.DUTY_10_01, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_01) END +
                      CASE WHEN ISNULL(G.DUTY_10_02, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_02) END +
                      CASE WHEN ISNULL(G.DUTY_10_03, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_03) END +
                      CASE WHEN ISNULL(G.DUTY_10_04, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_04) END +
                      CASE WHEN ISNULL(G.DUTY_10_05, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_05) END +
                      CASE WHEN ISNULL(G.DUTY_10_06, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_06) END +
                      CASE WHEN ISNULL(G.DUTY_10_07, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_07) END +
                      CASE WHEN ISNULL(G.DUTY_10_08, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_08) END +
                      CASE WHEN ISNULL(G.DUTY_10_09, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_09) END +
                      CASE WHEN ISNULL(G.DUTY_10_10, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_10) END +
                      CASE WHEN ISNULL(G.DUTY_10_11, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_11) END +
                      CASE WHEN ISNULL(G.DUTY_10_12, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_12) END +
                      CASE WHEN ISNULL(G.DUTY_10_13, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_13) END +
                      CASE WHEN ISNULL(G.DUTY_10_14, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_14) END +
                      CASE WHEN ISNULL(G.DUTY_10_15, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_15) END +
                      CASE WHEN ISNULL(G.DUTY_10_16, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_16) END +
                      CASE WHEN ISNULL(G.DUTY_10_17, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_17) END +
                      CASE WHEN ISNULL(G.DUTY_10_18, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_18) END +
                      CASE WHEN ISNULL(G.DUTY_10_19, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_19) END +
                      CASE WHEN ISNULL(G.DUTY_10_20, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_20) END +
                      CASE WHEN ISNULL(G.DUTY_10_21, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_21) END +
                      CASE WHEN ISNULL(G.DUTY_10_22, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_22) END +
                      CASE WHEN ISNULL(G.DUTY_10_23, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_23) END +
                      CASE WHEN ISNULL(G.DUTY_10_24, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_24) END +
                      CASE WHEN ISNULL(G.DUTY_10_25, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_25) END +
                      CASE WHEN ISNULL(G.DUTY_10_26, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_26) END +
                      CASE WHEN ISNULL(G.DUTY_10_27, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_27) END +
                      CASE WHEN ISNULL(G.DUTY_10_28, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_28) END +
                      CASE WHEN ISNULL(G.DUTY_10_29, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_29) END +
                      CASE WHEN ISNULL(G.DUTY_10_30, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_30) END +
                      CASE WHEN ISNULL(G.DUTY_10_31, '') = '' THEN 0 ELSE CONVERT(NUMERIC, G.DUTY_10_31) END ) ) * 1.5         AS DUTY_10_AMT    -- 연장(150%)       수당
    
                 , (ISNULL(B.PAY_PRESERVE_I, 0) *
                    ( CASE WHEN ISNULL(H.DUTY_11_01, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_01) END +
                      CASE WHEN ISNULL(H.DUTY_11_02, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_02) END +
                      CASE WHEN ISNULL(H.DUTY_11_03, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_03) END +
                      CASE WHEN ISNULL(H.DUTY_11_04, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_04) END +
                      CASE WHEN ISNULL(H.DUTY_11_05, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_05) END +
                      CASE WHEN ISNULL(H.DUTY_11_06, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_06) END +
                      CASE WHEN ISNULL(H.DUTY_11_07, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_07) END +
                      CASE WHEN ISNULL(H.DUTY_11_08, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_08) END +
                      CASE WHEN ISNULL(H.DUTY_11_09, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_09) END +
                      CASE WHEN ISNULL(H.DUTY_11_10, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_10) END +
                      CASE WHEN ISNULL(H.DUTY_11_11, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_11) END +
                      CASE WHEN ISNULL(H.DUTY_11_12, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_12) END +
                      CASE WHEN ISNULL(H.DUTY_11_13, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_13) END +
                      CASE WHEN ISNULL(H.DUTY_11_14, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_14) END +
                      CASE WHEN ISNULL(H.DUTY_11_15, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_15) END +
                      CASE WHEN ISNULL(H.DUTY_11_16, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_16) END +
                      CASE WHEN ISNULL(H.DUTY_11_17, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_17) END +
                      CASE WHEN ISNULL(H.DUTY_11_18, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_18) END +
                      CASE WHEN ISNULL(H.DUTY_11_19, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_19) END +
                      CASE WHEN ISNULL(H.DUTY_11_20, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_20) END +
                      CASE WHEN ISNULL(H.DUTY_11_21, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_21) END +
                      CASE WHEN ISNULL(H.DUTY_11_22, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_22) END +
                      CASE WHEN ISNULL(H.DUTY_11_23, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_23) END +
                      CASE WHEN ISNULL(H.DUTY_11_24, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_24) END +
                      CASE WHEN ISNULL(H.DUTY_11_25, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_25) END +
                      CASE WHEN ISNULL(H.DUTY_11_26, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_26) END +
                      CASE WHEN ISNULL(H.DUTY_11_27, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_27) END +
                      CASE WHEN ISNULL(H.DUTY_11_28, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_28) END +
                      CASE WHEN ISNULL(H.DUTY_11_29, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_29) END +
                      CASE WHEN ISNULL(H.DUTY_11_30, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_30) END +
                      CASE WHEN ISNULL(H.DUTY_11_31, '') = '' THEN 0 ELSE CONVERT(NUMERIC, H.DUTY_11_31) END ) ) * 0.5         AS DUTY_11_AMT    -- 심야(50%)        수당
    
                 , (ISNULL(B.PAY_PRESERVE_I, 0) *
                    ( CASE WHEN ISNULL(I.DUTY_12_01, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_01) END +
                      CASE WHEN ISNULL(I.DUTY_12_02, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_02) END +
                      CASE WHEN ISNULL(I.DUTY_12_03, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_03) END +
                      CASE WHEN ISNULL(I.DUTY_12_04, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_04) END +
                      CASE WHEN ISNULL(I.DUTY_12_05, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_05) END +
                      CASE WHEN ISNULL(I.DUTY_12_06, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_06) END +
                      CASE WHEN ISNULL(I.DUTY_12_07, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_07) END +
                      CASE WHEN ISNULL(I.DUTY_12_08, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_08) END +
                      CASE WHEN ISNULL(I.DUTY_12_09, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_09) END +
                      CASE WHEN ISNULL(I.DUTY_12_10, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_10) END +
                      CASE WHEN ISNULL(I.DUTY_12_11, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_11) END +
                      CASE WHEN ISNULL(I.DUTY_12_12, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_12) END +
                      CASE WHEN ISNULL(I.DUTY_12_13, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_13) END +
                      CASE WHEN ISNULL(I.DUTY_12_14, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_14) END +
                      CASE WHEN ISNULL(I.DUTY_12_15, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_15) END +
                      CASE WHEN ISNULL(I.DUTY_12_16, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_16) END +
                      CASE WHEN ISNULL(I.DUTY_12_17, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_17) END +
                      CASE WHEN ISNULL(I.DUTY_12_18, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_18) END +
                      CASE WHEN ISNULL(I.DUTY_12_19, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_19) END +
                      CASE WHEN ISNULL(I.DUTY_12_20, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_20) END +
                      CASE WHEN ISNULL(I.DUTY_12_21, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_21) END +
                      CASE WHEN ISNULL(I.DUTY_12_22, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_22) END +
                      CASE WHEN ISNULL(I.DUTY_12_23, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_23) END +
                      CASE WHEN ISNULL(I.DUTY_12_24, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_24) END +
                      CASE WHEN ISNULL(I.DUTY_12_25, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_25) END +
                      CASE WHEN ISNULL(I.DUTY_12_26, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_26) END +
                      CASE WHEN ISNULL(I.DUTY_12_27, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_27) END +
                      CASE WHEN ISNULL(I.DUTY_12_28, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_28) END +
                      CASE WHEN ISNULL(I.DUTY_12_29, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_29) END +
                      CASE WHEN ISNULL(I.DUTY_12_30, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_30) END +
                      CASE WHEN ISNULL(I.DUTY_12_31, '') = '' THEN 0 ELSE CONVERT(NUMERIC, I.DUTY_12_31) END ) ) * 1.5         AS DUTY_12_AMT    -- 특근(150%)       수당
    
                 , (ISNULL(B.PAY_PRESERVE_I, 0) *
                    ( CASE WHEN ISNULL(J.DUTY_13_01, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_01) END +
                      CASE WHEN ISNULL(J.DUTY_13_02, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_02) END +
                      CASE WHEN ISNULL(J.DUTY_13_03, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_03) END +
                      CASE WHEN ISNULL(J.DUTY_13_04, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_04) END +
                      CASE WHEN ISNULL(J.DUTY_13_05, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_05) END +
                      CASE WHEN ISNULL(J.DUTY_13_06, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_06) END +
                      CASE WHEN ISNULL(J.DUTY_13_07, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_07) END +
                      CASE WHEN ISNULL(J.DUTY_13_08, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_08) END +
                      CASE WHEN ISNULL(J.DUTY_13_09, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_09) END +
                      CASE WHEN ISNULL(J.DUTY_13_10, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_10) END +
                      CASE WHEN ISNULL(J.DUTY_13_11, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_11) END +
                      CASE WHEN ISNULL(J.DUTY_13_12, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_12) END +
                      CASE WHEN ISNULL(J.DUTY_13_13, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_13) END +
                      CASE WHEN ISNULL(J.DUTY_13_14, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_14) END +
                      CASE WHEN ISNULL(J.DUTY_13_15, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_15) END +
                      CASE WHEN ISNULL(J.DUTY_13_16, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_16) END +
                      CASE WHEN ISNULL(J.DUTY_13_17, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_17) END +
                      CASE WHEN ISNULL(J.DUTY_13_18, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_18) END +
                      CASE WHEN ISNULL(J.DUTY_13_19, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_19) END +
                      CASE WHEN ISNULL(J.DUTY_13_20, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_20) END +
                      CASE WHEN ISNULL(J.DUTY_13_21, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_21) END +
                      CASE WHEN ISNULL(J.DUTY_13_22, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_22) END +
                      CASE WHEN ISNULL(J.DUTY_13_23, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_23) END +
                      CASE WHEN ISNULL(J.DUTY_13_24, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_24) END +
                      CASE WHEN ISNULL(J.DUTY_13_25, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_25) END +
                      CASE WHEN ISNULL(J.DUTY_13_26, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_26) END +
                      CASE WHEN ISNULL(J.DUTY_13_27, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_27) END +
                      CASE WHEN ISNULL(J.DUTY_13_28, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_28) END +
                      CASE WHEN ISNULL(J.DUTY_13_29, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_29) END +
                      CASE WHEN ISNULL(J.DUTY_13_30, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_30) END +
                      CASE WHEN ISNULL(J.DUTY_13_31, '') = '' THEN 0 ELSE CONVERT(NUMERIC, J.DUTY_13_31) END ) ) * 2.0         AS DUTY_13_AMT    -- 특근연장(200%)   수당
            
                 , 0                              AS PAY_TOT_AMT    -- 총급여
            
                 , ISNULL(B.ANU_INSUR_I, 0)       AS DED_AMT_ANU    -- 공제 - 국민연금
                 , ISNULL(B.ORI_MED_INSUR_I, 0)   AS DED_AMT_MED    -- 공제 - 건강보험
                 , ISNULL(B.OLD_MED_INSUR_I, 0)   AS DED_AMT_LCI    -- 공제 - 요양보험
                 , ISNULL(B.HIRE_INSUR_I, 0)      AS DED_AMT_HIR    -- 공제 - 고용보험
                 , ISNULL(D.DED_AMT_INC, 0)       AS DED_AMT_INC    -- 공제 - 소득세
                 , ISNULL(D.DED_AMT_LOC, 0)       AS DED_AMT_LOC    -- 공제 - 지방소득세(주민세)
                 , 0                              AS DED_AMT_DUTY   -- 공제 - 근태공제
                 , ISNULL(D.DED_AMT_002, 0)       AS DED_AMT_002    -- 공제 - 기타공제
                 , ISNULL(D.DED_AMT_S01, 0)       AS DED_AMT_S01    -- 공제 - 연말정산
                 , 0                              AS DED_TOT_AMT    -- 공제 - 총계
              FROM HPA600T A WITH (NOLOCK)
                   INNER JOIN HUM100T B WITH (NOLOCK)  ON B.COMP_CODE   = A.COMP_CODE
                                                      AND B.PERSON_NUMB = A.PERSON_NUMB
                                                      AND (B.RETR_DATE = '00000000' OR LEFT(B.RETR_DATE, 6) &gt;= #{BASE_DATE})
                   LEFT JOIN (
                              SELECT A.COMP_CODE
                                   , A.PERSON_NUMB
                                   , SUM(CASE WHEN WAGES_CODE = '100' THEN DED_AMOUNT_I ELSE 0 END)  AS WAGES_100      -- 기본급
                                   , SUM(CASE WHEN WAGES_CODE = '110' THEN DED_AMOUNT_I ELSE 0 END)  AS WAGES_110      -- 시간외수당
                                   , SUM(CASE WHEN WAGES_CODE = '120' THEN DED_AMOUNT_I ELSE 0 END)  AS WAGES_120      -- 휴일수당
                                   , SUM(CASE WHEN WAGES_CODE = '130' THEN DED_AMOUNT_I ELSE 0 END)  AS WAGES_130      -- 야간수당
                                   , SUM(CASE WHEN WAGES_CODE = '140' THEN DED_AMOUNT_I ELSE 0 END)  AS WAGES_140      -- 직책수당
                                   , SUM(CASE WHEN WAGES_CODE = '150' THEN DED_AMOUNT_I ELSE 0 END)  AS WAGES_150      -- 성과급
                                   , 0                                                               AS WAGES_160      -- 출장수당
                                   , SUM(CASE WHEN WAGES_CODE = '170' THEN DED_AMOUNT_I ELSE 0 END)  AS WAGES_170      -- 제수당
                                   , SUM(CASE WHEN WAGES_CODE = '190' THEN DED_AMOUNT_I ELSE 0 END)  AS WAGES_190      -- 기능수당
                                FROM HPA700T A WITH (NOLOCK)
                               WHERE COMP_CODE = #{S_COMP_CODE}
                                 AND (PAY_FR_YYYYMM &lt;= #{BASE_DATE} AND PAY_TO_YYYYMM &gt;= #{BASE_DATE})
                               GROUP BY A.COMP_CODE, A.PERSON_NUMB
                             ) C  ON C.COMP_CODE   = A.COMP_CODE
                                 AND C.PERSON_NUMB = A.PERSON_NUMB
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , Z.PAY_YYYYMM
                                   , Z.SUPP_TYPE
                                   , SUM(Z.DED_AMT_INC) AS DED_AMT_INC    -- 소득세
                                   , SUM(Z.DED_AMT_LOC) AS DED_AMT_LOC    -- 지방소득세(주민세)
                                   , SUM(Z.DED_AMT_002) AS DED_AMT_002    -- 기타공제
                                   , SUM(Z.DED_AMT_S01) AS DED_AMT_S01    -- 연말정산(소득세 + 지방소득세)
                               FROM (
                                     SELECT A.COMP_CODE
                                          , A.PERSON_NUMB
                                          , A.PAY_YYYYMM
                                          , A.SUPP_TYPE
                                          , CASE WHEN DED_CODE = 'INC'             THEN DED_AMOUNT_I ELSE 0 END AS DED_AMT_INC    -- 소득세
                                          , CASE WHEN DED_CODE = 'LOC'             THEN DED_AMOUNT_I ELSE 0 END AS DED_AMT_LOC    -- 지방소득세(주민세)
                                          , CASE WHEN DED_CODE = '002'             THEN DED_AMOUNT_I ELSE 0 END AS DED_AMT_002    -- 기타공제
                                          , CASE WHEN DED_CODE IN ( 'S01', 'S02' ) THEN DED_AMOUNT_I ELSE 0 END AS DED_AMT_S01    -- 연말정산(소득세 + 지방소득세)
                                       FROM HPA400T A WITH (NOLOCK)
                                      WHERE A.COMP_CODE  = #{S_COMP_CODE}
                                        AND A.SUPP_TYPE  ='1'
                                        AND A.PAY_YYYYMM = #{BASE_DATE}
                                    ) Z
                              GROUP BY Z.COMP_CODE, Z.PERSON_NUMB, Z.PAY_YYYYMM, Z.SUPP_TYPE
                             ) D  ON D.COMP_CODE   = A.COMP_CODE
                                 AND D.PERSON_NUMB = A.PERSON_NUMB
                                 AND D.PAY_YYYYMM  = A.PAY_YYYYMM
                                 AND D.SUPP_TYPE   = A.SUPP_TYPE
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_01_H, 0)) + SUM(ISNULL(Z.DUTY_16_01_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_01_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_01_M, 0))))
                                     END                                                                                                                    AS DUTY_16_01
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_02_H, 0)) + SUM(ISNULL(Z.DUTY_16_02_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_02_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_02_M, 0))))
                                     END                                                                                                                    AS DUTY_16_02
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_03_H, 0)) + SUM(ISNULL(Z.DUTY_16_03_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_03_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_03_M, 0))))
                                     END                                                                                                                    AS DUTY_16_03
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_04_H, 0)) + SUM(ISNULL(Z.DUTY_16_04_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_04_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_04_M, 0))))
                                     END                                                                                                                    AS DUTY_16_04
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_05_H, 0)) + SUM(ISNULL(Z.DUTY_16_05_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_05_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_05_M, 0))))
                                     END                                                                                                                    AS DUTY_16_05
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_06_H, 0)) + SUM(ISNULL(Z.DUTY_16_06_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_06_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_06_M, 0))))
                                     END                                                                                                                    AS DUTY_16_06
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_07_H, 0)) + SUM(ISNULL(Z.DUTY_16_07_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_07_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_07_M, 0))))
                                     END                                                                                                                    AS DUTY_16_07
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_08_H, 0)) + SUM(ISNULL(Z.DUTY_16_08_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_08_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_08_M, 0))))
                                     END                                                                                                                    AS DUTY_16_08
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_09_H, 0)) + SUM(ISNULL(Z.DUTY_16_09_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_09_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_09_M, 0))))
                                     END                                                                                                                    AS DUTY_16_09
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_10_H, 0)) + SUM(ISNULL(Z.DUTY_16_10_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_10_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_10_M, 0))))
                                     END                                                                                                                    AS DUTY_16_10
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_11_H, 0)) + SUM(ISNULL(Z.DUTY_16_11_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_11_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_11_M, 0))))
                                     END                                                                                                                    AS DUTY_16_11
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_12_H, 0)) + SUM(ISNULL(Z.DUTY_16_12_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_12_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_12_M, 0))))
                                     END                                                                                                                    AS DUTY_16_12
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_13_H, 0)) + SUM(ISNULL(Z.DUTY_16_13_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_13_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_13_M, 0))))
                                     END                                                                                                                    AS DUTY_16_13
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_14_H, 0)) + SUM(ISNULL(Z.DUTY_16_14_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_14_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_14_M, 0))))
                                     END                                                                                                                    AS DUTY_16_14
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_15_H, 0)) + SUM(ISNULL(Z.DUTY_16_15_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_15_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_15_M, 0))))
                                     END                                                                                                                    AS DUTY_16_15
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_16_H, 0)) + SUM(ISNULL(Z.DUTY_16_16_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_16_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_16_M, 0))))
                                     END                                                                                                                    AS DUTY_16_16
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_17_H, 0)) + SUM(ISNULL(Z.DUTY_16_17_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_17_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_17_M, 0))))
                                     END                                                                                                                    AS DUTY_16_17
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_18_H, 0)) + SUM(ISNULL(Z.DUTY_16_18_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_18_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_18_M, 0))))
                                     END                                                                                                                    AS DUTY_16_18
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_19_H, 0)) + SUM(ISNULL(Z.DUTY_16_19_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_19_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_19_M, 0))))
                                     END                                                                                                                    AS DUTY_16_19
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_20_H, 0)) + SUM(ISNULL(Z.DUTY_16_20_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_20_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_20_M, 0))))
                                     END                                                                                                                    AS DUTY_16_20
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_21_H, 0)) + SUM(ISNULL(Z.DUTY_16_21_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_21_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_21_M, 0))))
                                     END                                                                                                                    AS DUTY_16_21
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_22_H, 0)) + SUM(ISNULL(Z.DUTY_16_22_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_22_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_22_M, 0))))
                                     END                                                                                                                    AS DUTY_16_22
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_23_H, 0)) + SUM(ISNULL(Z.DUTY_16_23_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_23_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_23_M, 0))))
                                     END                                                                                                                    AS DUTY_16_23
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_24_H, 0)) + SUM(ISNULL(Z.DUTY_16_24_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_24_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_24_M, 0))))
                                     END                                                                                                                    AS DUTY_16_24
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_25_H, 0)) + SUM(ISNULL(Z.DUTY_16_25_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_25_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_25_M, 0))))
                                     END                                                                                                                    AS DUTY_16_25
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_26_H, 0)) + SUM(ISNULL(Z.DUTY_16_26_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_26_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_26_M, 0))))
                                     END                                                                                                                    AS DUTY_16_26
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_27_H, 0)) + SUM(ISNULL(Z.DUTY_16_27_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_27_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_27_M, 0))))
                                     END                                                                                                                    AS DUTY_16_27
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_28_H, 0)) + SUM(ISNULL(Z.DUTY_16_28_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_28_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_28_M, 0))))
                                     END                                                                                                                    AS DUTY_16_28
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_29_H, 0)) + SUM(ISNULL(Z.DUTY_16_29_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_29_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_29_M, 0))))
                                     END                                                                                                                    AS DUTY_16_29
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_30_H, 0)) + SUM(ISNULL(Z.DUTY_16_30_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_30_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_30_M, 0))))
                                     END                                                                                                                    AS DUTY_16_30
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_16_31_H, 0)) + SUM(ISNULL(Z.DUTY_16_31_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_31_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_16_31_M, 0))))
                                     END                                                                                                                    AS DUTY_16_31
                               FROM (
                                     SELECT A.COMP_CODE
                                          , A.PERSON_NUMB
                                          , RIGHT(A.DUTY_YYYYMMDD, 2)   AS DUTY_YYYYMMDD
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_01_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_01_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_02_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_02_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_03_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_03_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_04_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_04_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_05_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_05_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_06_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_06_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_07_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_07_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_08_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_08_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_09_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_09_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_10_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_10_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_11_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_11_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_12_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_12_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_13_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_13_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_14_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_14_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_15_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_15_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_16_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_16_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_17_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_17_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_18_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_18_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_19_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_19_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_20_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_20_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_21_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_21_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_22_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_22_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_23_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_23_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_24_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_24_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_25_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_25_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_26_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_26_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_27_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_27_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_28_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_28_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_29_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_29_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_30_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_30_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_6_H ELSE 0 END                           AS DUTY_16_31_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_6_M ELSE 0 END                           AS DUTY_16_31_M
                                       FROM HAT500T A WITH (NOLOCK)
                                      WHERE A.COMP_CODE              = #{S_COMP_CODE}
                                        AND LEFT(A.DUTY_YYYYMMDD, 6) = #{BASE_DATE}
                                    ) Z
                              GROUP BY Z.COMP_CODE, Z.PERSON_NUMB
                             ) E  ON E.COMP_CODE   = A.COMP_CODE
                                 AND E.PERSON_NUMB = A.PERSON_NUMB
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_01_H, 0)) + SUM(ISNULL(Z.DUTY_17_01_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_01_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_01_H, 0))))
                                     END                                                                                                                    AS DUTY_17_01
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_02_H, 0)) + SUM(ISNULL(Z.DUTY_17_02_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_02_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_02_H, 0))))
                                     END                                                                                                                    AS DUTY_17_02
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_03_H, 0)) + SUM(ISNULL(Z.DUTY_17_03_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_03_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_03_H, 0))))
                                     END                                                                                                                    AS DUTY_17_03
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_04_H, 0)) + SUM(ISNULL(Z.DUTY_17_04_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_04_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_04_H, 0))))
                                     END                                                                                                                    AS DUTY_17_04
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_05_H, 0)) + SUM(ISNULL(Z.DUTY_17_05_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_05_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_05_H, 0))))
                                     END                                                                                                                    AS DUTY_17_05
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_06_H, 0)) + SUM(ISNULL(Z.DUTY_17_06_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_06_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_06_H, 0))))
                                     END                                                                                                                    AS DUTY_17_06
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_07_H, 0)) + SUM(ISNULL(Z.DUTY_17_07_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_07_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_07_H, 0))))
                                     END                                                                                                                    AS DUTY_17_07
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_08_H, 0)) + SUM(ISNULL(Z.DUTY_17_08_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_08_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_08_H, 0))))
                                     END                                                                                                                    AS DUTY_17_08
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_09_H, 0)) + SUM(ISNULL(Z.DUTY_17_09_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_09_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_09_H, 0))))
                                     END                                                                                                                    AS DUTY_17_09
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_10_H, 0)) + SUM(ISNULL(Z.DUTY_17_10_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_10_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_10_H, 0))))
                                     END                                                                                                                    AS DUTY_17_10
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_11_H, 0)) + SUM(ISNULL(Z.DUTY_17_11_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_11_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_11_H, 0))))
                                     END                                                                                                                    AS DUTY_17_11
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_12_H, 0)) + SUM(ISNULL(Z.DUTY_17_12_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_12_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_12_H, 0))))
                                     END                                                                                                                    AS DUTY_17_12
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_13_H, 0)) + SUM(ISNULL(Z.DUTY_17_13_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_13_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_13_H, 0))))
                                     END                                                                                                                    AS DUTY_17_13
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_14_H, 0)) + SUM(ISNULL(Z.DUTY_17_14_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_14_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_14_H, 0))))
                                     END                                                                                                                    AS DUTY_17_14
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_15_H, 0)) + SUM(ISNULL(Z.DUTY_17_15_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_15_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_15_H, 0))))
                                     END                                                                                                                    AS DUTY_17_15
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_16_H, 0)) + SUM(ISNULL(Z.DUTY_17_16_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_16_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_16_H, 0))))
                                     END                                                                                                                    AS DUTY_17_16
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_17_H, 0)) + SUM(ISNULL(Z.DUTY_17_17_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_17_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_17_H, 0))))
                                     END                                                                                                                    AS DUTY_17_17
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_18_H, 0)) + SUM(ISNULL(Z.DUTY_17_18_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_18_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_18_H, 0))))
                                     END                                                                                                                    AS DUTY_17_18
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_19_H, 0)) + SUM(ISNULL(Z.DUTY_17_19_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_19_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_19_H, 0))))
                                     END                                                                                                                    AS DUTY_17_19
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_20_H, 0)) + SUM(ISNULL(Z.DUTY_17_20_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_20_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_20_H, 0))))
                                     END                                                                                                                    AS DUTY_17_20
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_21_H, 0)) + SUM(ISNULL(Z.DUTY_17_21_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_21_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_21_H, 0))))
                                     END                                                                                                                    AS DUTY_17_21
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_22_H, 0)) + SUM(ISNULL(Z.DUTY_17_22_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_22_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_22_H, 0))))
                                     END                                                                                                                    AS DUTY_17_22
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_23_H, 0)) + SUM(ISNULL(Z.DUTY_17_23_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_23_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_23_H, 0))))
                                     END                                                                                                                    AS DUTY_17_23
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_24_H, 0)) + SUM(ISNULL(Z.DUTY_17_24_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_24_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_24_H, 0))))
                                     END                                                                                                                    AS DUTY_17_24
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_25_H, 0)) + SUM(ISNULL(Z.DUTY_17_25_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_25_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_25_H, 0))))
                                     END                                                                                                                    AS DUTY_17_25
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_26_H, 0)) + SUM(ISNULL(Z.DUTY_17_26_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_26_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_26_H, 0))))
                                     END                                                                                                                    AS DUTY_17_26
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_27_H, 0)) + SUM(ISNULL(Z.DUTY_17_27_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_27_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_27_H, 0))))
                                     END                                                                                                                    AS DUTY_17_27
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_28_H, 0)) + SUM(ISNULL(Z.DUTY_17_28_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_28_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_28_H, 0))))
                                     END                                                                                                                    AS DUTY_17_28
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_29_H, 0)) + SUM(ISNULL(Z.DUTY_17_29_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_29_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_29_H, 0))))
                                     END                                                                                                                    AS DUTY_17_29
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_30_H, 0)) + SUM(ISNULL(Z.DUTY_17_30_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_30_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_30_H, 0))))
                                     END                                                                                                                    AS DUTY_17_30
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_17_31_H, 0)) + SUM(ISNULL(Z.DUTY_17_31_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_31_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_17_31_H, 0))))
                                     END                                                                                                                    AS DUTY_17_31
                               FROM (
                                     SELECT A.COMP_CODE
                                          , A.PERSON_NUMB
                                          , RIGHT(A.DUTY_YYYYMMDD, 2)   AS DUTY_YYYYMMDD
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_01_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_01_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_02_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_02_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_03_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_03_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_04_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_04_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_05_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_05_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_06_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_06_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_07_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_07_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_08_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_08_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_09_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_09_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_10_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_10_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_11_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_11_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_12_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_12_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_13_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_13_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_14_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_14_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_15_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_15_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_16_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_16_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_17_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_17_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_18_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_18_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_19_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_19_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_20_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_20_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_21_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_21_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_22_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_22_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_23_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_23_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_24_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_24_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_25_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_25_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_26_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_26_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_27_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_27_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_28_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_28_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_29_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_29_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_30_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_30_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_7_H ELSE 0 END                           AS DUTY_17_31_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_7_M ELSE 0 END                           AS DUTY_17_31_M
                                       FROM HAT500T A WITH (NOLOCK)
                                      WHERE A.COMP_CODE              = #{S_COMP_CODE}
                                        AND LEFT(A.DUTY_YYYYMMDD, 6) = #{BASE_DATE}
                                    ) Z
                              GROUP BY Z.COMP_CODE, Z.PERSON_NUMB
                             ) F  ON F.COMP_CODE   = A.COMP_CODE
                                 AND F.PERSON_NUMB = A.PERSON_NUMB
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_01_H, 0)) + SUM(ISNULL(Z.DUTY_10_01_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_01_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_01_M, 0))))
                                     END                                                                                                                    AS DUTY_10_01
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_02_H, 0)) + SUM(ISNULL(Z.DUTY_10_02_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_02_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_02_M, 0))))
                                     END                                                                                                                    AS DUTY_10_02
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_03_H, 0)) + SUM(ISNULL(Z.DUTY_10_03_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_03_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_03_M, 0))))
                                     END                                                                                                                    AS DUTY_10_03
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_04_H, 0)) + SUM(ISNULL(Z.DUTY_10_04_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_04_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_04_M, 0))))
                                     END                                                                                                                    AS DUTY_10_04
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_05_H, 0)) + SUM(ISNULL(Z.DUTY_10_05_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_05_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_05_M, 0))))
                                     END                                                                                                                    AS DUTY_10_05
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_06_H, 0)) + SUM(ISNULL(Z.DUTY_10_06_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_06_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_06_M, 0))))
                                     END                                                                                                                    AS DUTY_10_06
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_07_H, 0)) + SUM(ISNULL(Z.DUTY_10_07_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_07_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_07_M, 0))))
                                     END                                                                                                                    AS DUTY_10_07
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_08_H, 0)) + SUM(ISNULL(Z.DUTY_10_08_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_08_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_08_M, 0))))
                                     END                                                                                                                    AS DUTY_10_08
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_09_H, 0)) + SUM(ISNULL(Z.DUTY_10_09_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_09_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_09_M, 0))))
                                     END                                                                                                                    AS DUTY_10_09
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_10_H, 0)) + SUM(ISNULL(Z.DUTY_10_10_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_10_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_10_M, 0))))
                                     END                                                                                                                    AS DUTY_10_10
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_11_H, 0)) + SUM(ISNULL(Z.DUTY_10_11_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_11_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_11_M, 0))))
                                     END                                                                                                                    AS DUTY_10_11
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_12_H, 0)) + SUM(ISNULL(Z.DUTY_10_12_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_12_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_12_M, 0))))
                                     END                                                                                                                    AS DUTY_10_12
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_13_H, 0)) + SUM(ISNULL(Z.DUTY_10_13_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_13_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_13_M, 0))))
                                     END                                                                                                                    AS DUTY_10_13
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_14_H, 0)) + SUM(ISNULL(Z.DUTY_10_14_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_14_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_14_M, 0))))
                                     END                                                                                                                    AS DUTY_10_14
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_15_H, 0)) + SUM(ISNULL(Z.DUTY_10_15_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_15_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_15_M, 0))))
                                     END                                                                                                                    AS DUTY_10_15
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_16_H, 0)) + SUM(ISNULL(Z.DUTY_10_16_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_16_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_16_M, 0))))
                                     END                                                                                                                    AS DUTY_10_16
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_17_H, 0)) + SUM(ISNULL(Z.DUTY_10_17_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_17_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_17_M, 0))))
                                     END                                                                                                                    AS DUTY_10_17
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_18_H, 0)) + SUM(ISNULL(Z.DUTY_10_18_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_18_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_18_M, 0))))
                                     END                                                                                                                    AS DUTY_10_18
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_19_H, 0)) + SUM(ISNULL(Z.DUTY_10_19_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_19_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_19_M, 0))))
                                     END                                                                                                                    AS DUTY_10_19
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_20_H, 0)) + SUM(ISNULL(Z.DUTY_10_20_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_20_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_20_M, 0))))
                                     END                                                                                                                    AS DUTY_10_20
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_21_H, 0)) + SUM(ISNULL(Z.DUTY_10_21_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_21_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_21_M, 0))))
                                     END                                                                                                                    AS DUTY_10_21
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_22_H, 0)) + SUM(ISNULL(Z.DUTY_10_22_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_22_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_22_M, 0))))
                                     END                                                                                                                    AS DUTY_10_22
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_23_H, 0)) + SUM(ISNULL(Z.DUTY_10_23_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_23_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_23_M, 0))))
                                     END                                                                                                                    AS DUTY_10_23
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_24_H, 0)) + SUM(ISNULL(Z.DUTY_10_24_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_24_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_24_M, 0))))
                                     END                                                                                                                    AS DUTY_10_24
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_25_H, 0)) + SUM(ISNULL(Z.DUTY_10_25_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_25_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_25_M, 0))))
                                     END                                                                                                                    AS DUTY_10_25
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_26_H, 0)) + SUM(ISNULL(Z.DUTY_10_26_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_26_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_26_M, 0))))
                                     END                                                                                                                    AS DUTY_10_26
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_27_H, 0)) + SUM(ISNULL(Z.DUTY_10_27_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_27_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_27_M, 0))))
                                     END                                                                                                                    AS DUTY_10_27
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_28_H, 0)) + SUM(ISNULL(Z.DUTY_10_28_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_28_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_28_M, 0))))
                                     END                                                                                                                    AS DUTY_10_28
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_29_H, 0)) + SUM(ISNULL(Z.DUTY_10_29_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_29_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_29_M, 0))))
                                     END                                                                                                                    AS DUTY_10_29
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_30_H, 0)) + SUM(ISNULL(Z.DUTY_10_30_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_30_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_30_M, 0))))
                                     END                                                                                                                    AS DUTY_10_30
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_10_31_H, 0)) + SUM(ISNULL(Z.DUTY_10_31_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_31_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_10_31_M, 0))))
                                     END                                                                                                                    AS DUTY_10_31
                               FROM (
                                     SELECT A.COMP_CODE
                                          , A.PERSON_NUMB
                                          , RIGHT(A.DUTY_YYYYMMDD, 2)   AS DUTY_YYYYMMDD
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_01_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_01_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_02_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_02_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_03_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_03_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_04_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_04_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_05_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_05_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_06_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_06_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_07_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_07_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_08_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_08_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_09_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_09_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_10_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_10_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_11_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_11_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_12_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_12_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_13_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_13_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_14_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_14_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_15_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_15_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_16_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_16_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_17_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_17_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_18_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_18_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_19_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_19_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_20_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_20_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_21_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_21_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_22_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_22_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_23_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_23_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_24_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_24_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_25_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_25_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_26_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_26_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_27_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_27_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_28_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_28_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_29_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_29_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_30_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_30_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_1_H ELSE 0 END                           AS DUTY_10_31_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_1_M ELSE 0 END                           AS DUTY_10_31_M
                                       FROM HAT500T A WITH (NOLOCK)
                                      WHERE A.COMP_CODE              = #{S_COMP_CODE}
                                        AND LEFT(A.DUTY_YYYYMMDD, 6) = #{BASE_DATE}
                                    ) Z
                              GROUP BY Z.COMP_CODE, Z.PERSON_NUMB
                             ) G  ON G.COMP_CODE   = A.COMP_CODE
                                 AND G.PERSON_NUMB = A.PERSON_NUMB
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_01_H, 0)) + SUM(ISNULL(Z.DUTY_11_01_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_01_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_01_M, 0))))
                                     END                                                                                                                    AS DUTY_11_01
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_02_H, 0)) + SUM(ISNULL(Z.DUTY_11_02_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_02_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_02_M, 0))))
                                     END                                                                                                                    AS DUTY_11_02
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_03_H, 0)) + SUM(ISNULL(Z.DUTY_11_03_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_03_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_03_M, 0))))
                                     END                                                                                                                    AS DUTY_11_03
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_04_H, 0)) + SUM(ISNULL(Z.DUTY_11_04_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_04_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_04_M, 0))))
                                     END                                                                                                                    AS DUTY_11_04
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_05_H, 0)) + SUM(ISNULL(Z.DUTY_11_05_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_05_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_05_M, 0))))
                                     END                                                                                                                    AS DUTY_11_05
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_06_H, 0)) + SUM(ISNULL(Z.DUTY_11_06_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_06_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_06_M, 0))))
                                     END                                                                                                                    AS DUTY_11_06
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_07_H, 0)) + SUM(ISNULL(Z.DUTY_11_07_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_07_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_07_M, 0))))
                                     END                                                                                                                    AS DUTY_11_07
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_08_H, 0)) + SUM(ISNULL(Z.DUTY_11_08_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_08_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_08_M, 0))))
                                     END                                                                                                                    AS DUTY_11_08
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_09_H, 0)) + SUM(ISNULL(Z.DUTY_11_09_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_09_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_09_M, 0))))
                                     END                                                                                                                    AS DUTY_11_09
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_10_H, 0)) + SUM(ISNULL(Z.DUTY_11_10_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_10_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_10_M, 0))))
                                     END                                                                                                                    AS DUTY_11_10
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_11_H, 0)) + SUM(ISNULL(Z.DUTY_11_11_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_11_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_11_M, 0))))
                                     END                                                                                                                    AS DUTY_11_11
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_12_H, 0)) + SUM(ISNULL(Z.DUTY_11_12_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_12_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_12_M, 0))))
                                     END                                                                                                                    AS DUTY_11_12
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_13_H, 0)) + SUM(ISNULL(Z.DUTY_11_13_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_13_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_13_M, 0))))
                                     END                                                                                                                    AS DUTY_11_13
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_14_H, 0)) + SUM(ISNULL(Z.DUTY_11_14_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_14_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_14_M, 0))))
                                     END                                                                                                                    AS DUTY_11_14
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_15_H, 0)) + SUM(ISNULL(Z.DUTY_11_15_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_15_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_15_M, 0))))
                                     END                                                                                                                    AS DUTY_11_15
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_16_H, 0)) + SUM(ISNULL(Z.DUTY_11_16_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_16_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_16_M, 0))))
                                     END                                                                                                                    AS DUTY_11_16
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_17_H, 0)) + SUM(ISNULL(Z.DUTY_11_17_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_17_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_17_M, 0))))
                                     END                                                                                                                    AS DUTY_11_17
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_18_H, 0)) + SUM(ISNULL(Z.DUTY_11_18_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_18_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_18_M, 0))))
                                     END                                                                                                                    AS DUTY_11_18
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_19_H, 0)) + SUM(ISNULL(Z.DUTY_11_19_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_19_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_19_M, 0))))
                                     END                                                                                                                    AS DUTY_11_19
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_20_H, 0)) + SUM(ISNULL(Z.DUTY_11_20_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_20_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_20_M, 0))))
                                     END                                                                                                                    AS DUTY_11_20
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_21_H, 0)) + SUM(ISNULL(Z.DUTY_11_21_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_21_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_21_M, 0))))
                                     END                                                                                                                    AS DUTY_11_21
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_22_H, 0)) + SUM(ISNULL(Z.DUTY_11_22_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_22_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_22_M, 0))))
                                     END                                                                                                                    AS DUTY_11_22
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_23_H, 0)) + SUM(ISNULL(Z.DUTY_11_23_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_23_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_23_M, 0))))
                                     END                                                                                                                    AS DUTY_11_23
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_24_H, 0)) + SUM(ISNULL(Z.DUTY_11_24_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_24_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_24_M, 0))))
                                     END                                                                                                                    AS DUTY_11_24
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_25_H, 0)) + SUM(ISNULL(Z.DUTY_11_25_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_25_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_25_M, 0))))
                                     END                                                                                                                    AS DUTY_11_25
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_26_H, 0)) + SUM(ISNULL(Z.DUTY_11_26_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_26_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_26_M, 0))))
                                     END                                                                                                                    AS DUTY_11_26
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_27_H, 0)) + SUM(ISNULL(Z.DUTY_11_27_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_27_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_27_M, 0))))
                                     END                                                                                                                    AS DUTY_11_27
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_28_H, 0)) + SUM(ISNULL(Z.DUTY_11_28_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_28_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_28_M, 0))))
                                     END                                                                                                                    AS DUTY_11_28
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_29_H, 0)) + SUM(ISNULL(Z.DUTY_11_29_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_29_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_29_M, 0))))
                                     END                                                                                                                    AS DUTY_11_29
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_30_H, 0)) + SUM(ISNULL(Z.DUTY_11_30_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_30_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_30_M, 0))))
                                     END                                                                                                                    AS DUTY_11_30
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_11_31_H, 0)) + SUM(ISNULL(Z.DUTY_11_31_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_31_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_11_31_M, 0))))
                                     END                                                                                                                    AS DUTY_11_31
                               FROM (
                                     SELECT A.COMP_CODE
                                          , A.PERSON_NUMB
                                          , RIGHT(A.DUTY_YYYYMMDD, 2)   AS DUTY_YYYYMMDD
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_01_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_01_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_02_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_02_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_03_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_03_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_04_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_04_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_05_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_05_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_06_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_06_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_07_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_07_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_08_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_08_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_09_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_09_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_10_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_10_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_11_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_11_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_12_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_12_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_13_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_13_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_14_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_14_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_15_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_15_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_16_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_16_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_17_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_17_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_18_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_18_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_19_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_19_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_20_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_20_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_21_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_21_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_22_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_22_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_23_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_23_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_24_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_24_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_25_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_25_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_26_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_26_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_27_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_27_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_28_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_28_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_29_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_29_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_30_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_30_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_2_H ELSE 0 END                           AS DUTY_11_31_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_2_M ELSE 0 END                           AS DUTY_11_31_M
                                       FROM HAT500T A WITH (NOLOCK)
                                      WHERE A.COMP_CODE              = #{S_COMP_CODE}
                                        AND LEFT(A.DUTY_YYYYMMDD, 6) = #{BASE_DATE}
                                    ) Z
                              GROUP BY Z.COMP_CODE, Z.PERSON_NUMB
                             ) H  ON H.COMP_CODE   = A.COMP_CODE
                                 AND H.PERSON_NUMB = A.PERSON_NUMB
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_01_H, 0)) + SUM(ISNULL(Z.DUTY_12_01_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_01_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_01_M, 0))))
                                     END                                                                                                                    AS DUTY_12_01
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_02_H, 0)) + SUM(ISNULL(Z.DUTY_12_02_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_02_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_02_M, 0))))
                                     END                                                                                                                    AS DUTY_12_02
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_03_H, 0)) + SUM(ISNULL(Z.DUTY_12_03_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_03_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_03_M, 0))))
                                     END                                                                                                                    AS DUTY_12_03
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_04_H, 0)) + SUM(ISNULL(Z.DUTY_12_04_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_04_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_04_M, 0))))
                                     END                                                                                                                    AS DUTY_12_04
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_05_H, 0)) + SUM(ISNULL(Z.DUTY_12_05_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_05_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_05_M, 0))))
                                     END                                                                                                                    AS DUTY_12_05
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_06_H, 0)) + SUM(ISNULL(Z.DUTY_12_06_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_06_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_06_M, 0))))
                                     END                                                                                                                    AS DUTY_12_06
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_07_H, 0)) + SUM(ISNULL(Z.DUTY_12_07_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_07_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_07_M, 0))))
                                     END                                                                                                                    AS DUTY_12_07
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_08_H, 0)) + SUM(ISNULL(Z.DUTY_12_08_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_08_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_08_M, 0))))
                                     END                                                                                                                    AS DUTY_12_08
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_09_H, 0)) + SUM(ISNULL(Z.DUTY_12_09_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_09_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_09_M, 0))))
                                     END                                                                                                                    AS DUTY_12_09
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_10_H, 0)) + SUM(ISNULL(Z.DUTY_12_10_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_10_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_10_M, 0))))
                                     END                                                                                                                    AS DUTY_12_10
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_11_H, 0)) + SUM(ISNULL(Z.DUTY_12_11_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_11_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_11_M, 0))))
                                     END                                                                                                                    AS DUTY_12_11
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_12_H, 0)) + SUM(ISNULL(Z.DUTY_12_12_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_12_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_12_M, 0))))
                                     END                                                                                                                    AS DUTY_12_12
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_13_H, 0)) + SUM(ISNULL(Z.DUTY_12_13_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_13_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_13_M, 0))))
                                     END                                                                                                                    AS DUTY_12_13
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_14_H, 0)) + SUM(ISNULL(Z.DUTY_12_14_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_14_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_14_M, 0))))
                                     END                                                                                                                    AS DUTY_12_14
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_15_H, 0)) + SUM(ISNULL(Z.DUTY_12_15_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_15_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_15_M, 0))))
                                     END                                                                                                                    AS DUTY_12_15
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_16_H, 0)) + SUM(ISNULL(Z.DUTY_12_16_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_16_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_16_M, 0))))
                                     END                                                                                                                    AS DUTY_12_16
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_17_H, 0)) + SUM(ISNULL(Z.DUTY_12_17_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_17_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_17_M, 0))))
                                     END                                                                                                                    AS DUTY_12_17
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_18_H, 0)) + SUM(ISNULL(Z.DUTY_12_18_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_18_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_18_M, 0))))
                                     END                                                                                                                    AS DUTY_12_18
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_19_H, 0)) + SUM(ISNULL(Z.DUTY_12_19_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_19_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_19_M, 0))))
                                     END                                                                                                                    AS DUTY_12_19
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_20_H, 0)) + SUM(ISNULL(Z.DUTY_12_20_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_20_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_20_M, 0))))
                                     END                                                                                                                    AS DUTY_12_20
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_21_H, 0)) + SUM(ISNULL(Z.DUTY_12_21_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_21_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_21_M, 0))))
                                     END                                                                                                                    AS DUTY_12_21
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_22_H, 0)) + SUM(ISNULL(Z.DUTY_12_22_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_22_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_22_M, 0))))
                                     END                                                                                                                    AS DUTY_12_22
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_23_H, 0)) + SUM(ISNULL(Z.DUTY_12_23_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_23_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_23_M, 0))))
                                     END                                                                                                                    AS DUTY_12_23
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_24_H, 0)) + SUM(ISNULL(Z.DUTY_12_24_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_24_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_24_M, 0))))
                                     END                                                                                                                    AS DUTY_12_24
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_25_H, 0)) + SUM(ISNULL(Z.DUTY_12_25_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_25_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_25_M, 0))))
                                     END                                                                                                                    AS DUTY_12_25
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_26_H, 0)) + SUM(ISNULL(Z.DUTY_12_26_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_26_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_26_M, 0))))
                                     END                                                                                                                    AS DUTY_12_26
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_27_H, 0)) + SUM(ISNULL(Z.DUTY_12_27_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_27_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_27_M, 0))))
                                     END                                                                                                                    AS DUTY_12_27
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_28_H, 0)) + SUM(ISNULL(Z.DUTY_12_28_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_28_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_28_M, 0))))
                                     END                                                                                                                    AS DUTY_12_28
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_29_H, 0)) + SUM(ISNULL(Z.DUTY_12_29_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_29_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_29_M, 0))))
                                     END                                                                                                                    AS DUTY_12_29
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_30_H, 0)) + SUM(ISNULL(Z.DUTY_12_30_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_30_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_30_M, 0))))
                                     END                                                                                                                    AS DUTY_12_30
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_12_31_H, 0)) + SUM(ISNULL(Z.DUTY_12_31_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_31_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_12_31_M, 0))))
                                     END                                                                                                                    AS DUTY_12_31
                               FROM (
                                     SELECT A.COMP_CODE
                                          , A.PERSON_NUMB
                                          , RIGHT(A.DUTY_YYYYMMDD, 2)   AS DUTY_YYYYMMDD
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_01_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_01_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_02_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_02_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_03_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_03_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_04_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_04_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_05_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_05_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_06_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_06_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_07_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_07_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_08_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_08_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_09_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_09_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_10_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_10_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_11_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_11_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_12_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_12_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_13_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_13_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_14_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_14_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_15_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_15_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_16_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_16_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_17_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_17_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_18_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_18_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_19_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_19_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_20_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_20_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_21_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_21_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_22_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_22_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_23_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_23_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_24_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_24_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_25_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_25_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_26_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_26_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_27_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_27_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_28_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_28_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_29_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_29_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_30_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_30_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_3_H ELSE 0 END                           AS DUTY_12_31_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_3_M ELSE 0 END                           AS DUTY_12_31_M
                                       FROM HAT500T A WITH (NOLOCK)
                                      WHERE A.COMP_CODE              = #{S_COMP_CODE}
                                        AND LEFT(A.DUTY_YYYYMMDD, 6) = #{BASE_DATE}
                                    ) Z
                              GROUP BY Z.COMP_CODE, Z.PERSON_NUMB
                             ) I  ON I.COMP_CODE   = A.COMP_CODE
                                 AND I.PERSON_NUMB = A.PERSON_NUMB
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_01_H, 0)) + SUM(ISNULL(Z.DUTY_13_01_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_01_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_01_M, 0))))
                                     END                                                                                                                    AS DUTY_13_01
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_02_H, 0)) + SUM(ISNULL(Z.DUTY_13_02_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_02_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_02_M, 0))))
                                     END                                                                                                                    AS DUTY_13_02
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_03_H, 0)) + SUM(ISNULL(Z.DUTY_13_03_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_03_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_03_M, 0))))
                                     END                                                                                                                    AS DUTY_13_03
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_04_H, 0)) + SUM(ISNULL(Z.DUTY_13_04_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_04_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_04_M, 0))))
                                     END                                                                                                                    AS DUTY_13_04
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_05_H, 0)) + SUM(ISNULL(Z.DUTY_13_05_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_05_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_05_M, 0))))
                                     END                                                                                                                    AS DUTY_13_05
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_06_H, 0)) + SUM(ISNULL(Z.DUTY_13_06_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_06_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_06_M, 0))))
                                     END                                                                                                                    AS DUTY_13_06
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_07_H, 0)) + SUM(ISNULL(Z.DUTY_13_07_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_07_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_07_M, 0))))
                                     END                                                                                                                    AS DUTY_13_07
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_08_H, 0)) + SUM(ISNULL(Z.DUTY_13_08_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_08_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_08_M, 0))))
                                     END                                                                                                                    AS DUTY_13_08
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_09_H, 0)) + SUM(ISNULL(Z.DUTY_13_09_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_09_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_09_M, 0))))
                                     END                                                                                                                    AS DUTY_13_09
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_10_H, 0)) + SUM(ISNULL(Z.DUTY_13_10_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_10_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_10_M, 0))))
                                     END                                                                                                                    AS DUTY_13_10
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_11_H, 0)) + SUM(ISNULL(Z.DUTY_13_11_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_11_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_11_M, 0))))
                                     END                                                                                                                    AS DUTY_13_11
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_12_H, 0)) + SUM(ISNULL(Z.DUTY_13_12_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_12_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_12_M, 0))))
                                     END                                                                                                                    AS DUTY_13_12
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_13_H, 0)) + SUM(ISNULL(Z.DUTY_13_13_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_13_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_13_M, 0))))
                                     END                                                                                                                    AS DUTY_13_13
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_14_H, 0)) + SUM(ISNULL(Z.DUTY_13_14_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_14_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_14_M, 0))))
                                     END                                                                                                                    AS DUTY_13_14
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_15_H, 0)) + SUM(ISNULL(Z.DUTY_13_15_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_15_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_15_M, 0))))
                                     END                                                                                                                    AS DUTY_13_15
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_16_H, 0)) + SUM(ISNULL(Z.DUTY_13_16_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_16_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_16_M, 0))))
                                     END                                                                                                                    AS DUTY_13_16
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_17_H, 0)) + SUM(ISNULL(Z.DUTY_13_17_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_17_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_17_M, 0))))
                                     END                                                                                                                    AS DUTY_13_17
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_18_H, 0)) + SUM(ISNULL(Z.DUTY_13_18_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_18_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_18_M, 0))))
                                     END                                                                                                                    AS DUTY_13_18
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_19_H, 0)) + SUM(ISNULL(Z.DUTY_13_19_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_19_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_19_M, 0))))
                                     END                                                                                                                    AS DUTY_13_19
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_20_H, 0)) + SUM(ISNULL(Z.DUTY_13_20_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_20_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_20_M, 0))))
                                     END                                                                                                                    AS DUTY_13_20
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_21_H, 0)) + SUM(ISNULL(Z.DUTY_13_21_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_21_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_21_M, 0))))
                                     END                                                                                                                    AS DUTY_13_21
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_22_H, 0)) + SUM(ISNULL(Z.DUTY_13_22_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_22_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_22_M, 0))))
                                     END                                                                                                                    AS DUTY_13_22
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_23_H, 0)) + SUM(ISNULL(Z.DUTY_13_23_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_23_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_23_M, 0))))
                                     END                                                                                                                    AS DUTY_13_23
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_24_H, 0)) + SUM(ISNULL(Z.DUTY_13_24_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_24_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_24_M, 0))))
                                     END                                                                                                                    AS DUTY_13_24
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_25_H, 0)) + SUM(ISNULL(Z.DUTY_13_25_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_25_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_25_M, 0))))
                                     END                                                                                                                    AS DUTY_13_25
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_26_H, 0)) + SUM(ISNULL(Z.DUTY_13_26_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_26_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_26_M, 0))))
                                     END                                                                                                                    AS DUTY_13_26
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_27_H, 0)) + SUM(ISNULL(Z.DUTY_13_27_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_27_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_27_M, 0))))
                                     END                                                                                                                    AS DUTY_13_27
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_28_H, 0)) + SUM(ISNULL(Z.DUTY_13_28_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_28_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_28_M, 0))))
                                     END                                                                                                                    AS DUTY_13_28
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_29_H, 0)) + SUM(ISNULL(Z.DUTY_13_29_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_29_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_29_M, 0))))
                                     END                                                                                                                    AS DUTY_13_29
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_30_H, 0)) + SUM(ISNULL(Z.DUTY_13_30_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_30_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_30_M, 0))))
                                     END                                                                                                                    AS DUTY_13_30
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_13_31_H, 0)) + SUM(ISNULL(Z.DUTY_13_31_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_31_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_13_31_M, 0))))
                                     END                                                                                                                    AS DUTY_13_31
                               FROM (
                                     SELECT A.COMP_CODE
                                          , A.PERSON_NUMB
                                          , RIGHT(A.DUTY_YYYYMMDD, 2)   AS DUTY_YYYYMMDD
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_01_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_01_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_02_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_02_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_03_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_03_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_04_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_04_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_05_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_05_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_06_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_06_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_07_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_07_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_08_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_08_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_09_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_09_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_10_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_10_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_11_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_11_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_12_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_12_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_13_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_13_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_14_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_14_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_15_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_15_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_16_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_16_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_17_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_17_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_18_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_18_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_19_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_19_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_20_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_20_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_21_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_21_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_22_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_22_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_23_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_23_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_24_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_24_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_25_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_25_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_26_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_26_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_27_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_27_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_28_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_28_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_29_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_29_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_30_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_30_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_4_H ELSE 0 END                           AS DUTY_13_31_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN A.OVERTIME_4_M ELSE 0 END                           AS DUTY_13_31_M
                                       FROM HAT500T A WITH (NOLOCK)
                                      WHERE A.COMP_CODE              = #{S_COMP_CODE}
                                        AND LEFT(A.DUTY_YYYYMMDD, 6) = #{BASE_DATE}
                                    ) Z
                              GROUP BY Z.COMP_CODE, Z.PERSON_NUMB
                             ) J  ON J.COMP_CODE   = A.COMP_CODE
                                 AND J.PERSON_NUMB = A.PERSON_NUMB
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_01_H, 0)) + SUM(ISNULL(Z.DUTY_5556_01_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_01_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_01_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_01
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_02_H, 0)) + SUM(ISNULL(Z.DUTY_5556_02_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_02_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_02_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_02
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_03_H, 0)) + SUM(ISNULL(Z.DUTY_5556_03_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_03_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_03_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_03
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_04_H, 0)) + SUM(ISNULL(Z.DUTY_5556_04_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_04_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_04_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_04
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_05_H, 0)) + SUM(ISNULL(Z.DUTY_5556_05_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_05_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_05_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_05
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_06_H, 0)) + SUM(ISNULL(Z.DUTY_5556_06_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_06_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_06_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_06
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_07_H, 0)) + SUM(ISNULL(Z.DUTY_5556_07_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_07_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_07_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_07
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_08_H, 0)) + SUM(ISNULL(Z.DUTY_5556_08_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_08_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_08_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_08
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_09_H, 0)) + SUM(ISNULL(Z.DUTY_5556_09_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_09_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_09_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_09
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_10_H, 0)) + SUM(ISNULL(Z.DUTY_5556_10_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_10_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_10_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_10
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_11_H, 0)) + SUM(ISNULL(Z.DUTY_5556_11_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_11_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_11_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_11
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_12_H, 0)) + SUM(ISNULL(Z.DUTY_5556_12_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_12_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_12_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_12
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_13_H, 0)) + SUM(ISNULL(Z.DUTY_5556_13_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_13_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_13_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_13
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_14_H, 0)) + SUM(ISNULL(Z.DUTY_5556_14_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_14_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_14_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_14
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_15_H, 0)) + SUM(ISNULL(Z.DUTY_5556_15_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_15_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_15_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_15
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_16_H, 0)) + SUM(ISNULL(Z.DUTY_5556_16_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_16_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_16_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_16
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_17_H, 0)) + SUM(ISNULL(Z.DUTY_5556_17_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_17_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_17_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_17
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_18_H, 0)) + SUM(ISNULL(Z.DUTY_5556_18_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_18_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_18_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_18
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_19_H, 0)) + SUM(ISNULL(Z.DUTY_5556_19_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_19_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_19_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_19
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_20_H, 0)) + SUM(ISNULL(Z.DUTY_5556_20_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_20_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_20_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_20
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_21_H, 0)) + SUM(ISNULL(Z.DUTY_5556_21_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_21_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_21_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_21
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_22_H, 0)) + SUM(ISNULL(Z.DUTY_5556_22_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_22_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_22_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_22
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_23_H, 0)) + SUM(ISNULL(Z.DUTY_5556_23_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_23_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_23_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_23
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_24_H, 0)) + SUM(ISNULL(Z.DUTY_5556_24_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_24_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_24_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_24
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_25_H, 0)) + SUM(ISNULL(Z.DUTY_5556_25_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_25_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_25_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_25
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_26_H, 0)) + SUM(ISNULL(Z.DUTY_5556_26_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_26_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_26_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_26
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_27_H, 0)) + SUM(ISNULL(Z.DUTY_5556_27_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_27_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_27_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_27
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_28_H, 0)) + SUM(ISNULL(Z.DUTY_5556_28_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_28_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_28_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_28
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_29_H, 0)) + SUM(ISNULL(Z.DUTY_5556_29_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_29_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_29_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_29
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_30_H, 0)) + SUM(ISNULL(Z.DUTY_5556_30_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_30_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_30_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_30
                                   , CASE WHEN (SUM(ISNULL(Z.DUTY_5556_31_H, 0)) + SUM(ISNULL(Z.DUTY_5556_31_M, 0)))  = 0 THEN '0'
                                     ELSE CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_31_H, 0)))) + '.' + CONVERT(NVARCHAR, CONVERT(INT, SUM(ISNULL(Z.DUTY_5556_31_M, 0))))
                                     END                                                                                                                    AS DUTY_5556_31
                               FROM (
                                     SELECT A.COMP_CODE
                                          , A.PERSON_NUMB
                                          , RIGHT(A.DUTY_YYYYMMDD, 2)   AS DUTY_YYYYMMDD
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_01_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_01_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_02_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_02_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_03_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_03_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_04_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_04_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_05_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_05_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_06_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_06_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_07_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_07_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_08_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_08_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_09_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_09_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_10_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_10_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_11_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_11_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_12_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_12_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_13_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_13_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_14_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_14_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_15_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_15_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_16_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_16_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_17_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_17_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_18_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_18_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_19_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_19_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_20_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_20_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_21_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_21_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_22_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_22_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_23_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_23_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_24_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_24_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_25_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_25_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_26_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_26_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_27_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_27_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_28_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_28_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_29_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_29_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_30_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_30_M
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN A.LATENESS_H + A.EARLY_H + 1 ELSE A.LATENESS_H + A.EARLY_H END ELSE 0 END   AS DUTY_5556_31_H
                                          , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN CASE WHEN A.LATENESS_M + A.EARLY_M > 30 THEN 0                            ELSE A.LATENESS_M + A.EARLY_M END ELSE 0 END   AS DUTY_5556_31_M
                                       FROM HAT500T A WITH (NOLOCK)
                                      WHERE A.COMP_CODE              = #{S_COMP_CODE}
                                        AND LEFT(A.DUTY_YYYYMMDD, 6) = #{BASE_DATE}
                                    ) Z
                              GROUP BY Z.COMP_CODE, Z.PERSON_NUMB
                             ) K  ON K.COMP_CODE   = A.COMP_CODE
                                 AND K.PERSON_NUMB = A.PERSON_NUMB
                   LEFT JOIN (
                              SELECT Z.COMP_CODE
                                   , Z.PERSON_NUMB
                                   , SUM(Z.DUTY_20_01)         AS DUTY_20_01
                                   , SUM(Z.DUTY_20_02)         AS DUTY_20_02
                                   , SUM(Z.DUTY_20_03)         AS DUTY_20_03
                                   , SUM(Z.DUTY_20_04)         AS DUTY_20_04
                                   , SUM(Z.DUTY_20_05)         AS DUTY_20_05
                                   , SUM(Z.DUTY_20_06)         AS DUTY_20_06
                                   , SUM(Z.DUTY_20_07)         AS DUTY_20_07
                                   , SUM(Z.DUTY_20_08)         AS DUTY_20_08
                                   , SUM(Z.DUTY_20_09)         AS DUTY_20_09
                                   , SUM(Z.DUTY_20_10)         AS DUTY_20_10
                                   , SUM(Z.DUTY_20_11)         AS DUTY_20_11
                                   , SUM(Z.DUTY_20_12)         AS DUTY_20_12
                                   , SUM(Z.DUTY_20_13)         AS DUTY_20_13
                                   , SUM(Z.DUTY_20_14)         AS DUTY_20_14
                                   , SUM(Z.DUTY_20_15)         AS DUTY_20_15
                                   , SUM(Z.DUTY_20_16)         AS DUTY_20_16
                                   , SUM(Z.DUTY_20_17)         AS DUTY_20_17
                                   , SUM(Z.DUTY_20_18)         AS DUTY_20_18
                                   , SUM(Z.DUTY_20_19)         AS DUTY_20_19
                                   , SUM(Z.DUTY_20_20)         AS DUTY_20_20
                                   , SUM(Z.DUTY_20_21)         AS DUTY_20_21
                                   , SUM(Z.DUTY_20_22)         AS DUTY_20_22
                                   , SUM(Z.DUTY_20_23)         AS DUTY_20_23
                                   , SUM(Z.DUTY_20_24)         AS DUTY_20_24
                                   , SUM(Z.DUTY_20_25)         AS DUTY_20_25
                                   , SUM(Z.DUTY_20_26)         AS DUTY_20_26
                                   , SUM(Z.DUTY_20_27)         AS DUTY_20_27
                                   , SUM(Z.DUTY_20_28)         AS DUTY_20_28
                                   , SUM(Z.DUTY_20_29)         AS DUTY_20_29
                                   , SUM(Z.DUTY_20_30)         AS DUTY_20_30
                                   , SUM(Z.DUTY_20_31)         AS DUTY_20_31
                                FROM (
                                      SELECT A.COMP_CODE
                                           , A.PERSON_NUMB
                                           , RIGHT(A.DUTY_YYYYMMDD, 2)   AS DUTY_YYYYMMDD
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '01' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_01
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '02' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_02
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '03' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_03
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '04' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_04
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '05' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_05
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '06' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_06
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '07' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_07
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '08' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_08
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '09' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_09
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '10' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_10
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '11' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_11
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '12' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_12
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '13' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_13
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '14' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_14
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '15' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_15
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '16' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_16
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '17' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_17
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '18' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_18
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '19' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_19
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '20' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_20
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '21' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_21
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '22' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_22
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '23' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_23
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '24' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_24
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '25' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_25
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '26' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_26
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '27' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_27
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '28' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_28
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '29' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_29
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '30' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_30
                                           , CASE WHEN RIGHT(A.DUTY_YYYYMMDD, 2) = '31' THEN CASE WHEN A.DUTY_CODE = '20' THEN 1 ELSE 0 END ELSE 0 END     AS DUTY_20_31
                                        FROM HAT500T A WITH (NOLOCK)
                                       WHERE A.COMP_CODE              = #{S_COMP_CODE}
                                         AND LEFT(A.DUTY_YYYYMMDD, 6) = #{BASE_DATE}
                                     ) Z
                               GROUP BY Z.COMP_CODE, Z.PERSON_NUMB
                             ) L  ON L.COMP_CODE   = A.COMP_CODE
                                 AND L.PERSON_NUMB = A.PERSON_NUMB
             WHERE A.COMP_CODE = #{S_COMP_CODE}
               AND A.SUPP_TYPE = '1'
               AND A.PAY_YYYYMM = #{BASE_DATE}
            <if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">    
               AND A.PERSON_NUMB = #{PERSON_NUMB}
            </if>
            <if test="@foren.Ognl@isNotEmpty(DEPT_CODE)">    
               AND A.DEPT_CODE = #{DEPT_CODE}
            </if>
           ) Z
     ORDER BY Z.DEPT_CODE, Z.POST_CODE, Z.PERSON_NUMB

	</select>
	<select id="selectSubPrint" parameterType="Map" resultType="rMap" >
		DECLARE @Calendar DATETIME = #{BASE_DATE} + '01'
 
        SELECT MAX(CASE WHEN A.M_NUM = 1 THEN A.M_NAME END)   AS DAY1
               , MAX(CASE WHEN A.M_NUM = 2 THEN A.M_NAME END)   AS DAY2
               , MAX(CASE WHEN A.M_NUM = 3 THEN A.M_NAME END)   AS DAY3
               , MAX(CASE WHEN A.M_NUM = 4 THEN A.M_NAME END)   AS DAY4
               , MAX(CASE WHEN A.M_NUM = 5 THEN A.M_NAME END)   AS DAY5
               , MAX(CASE WHEN A.M_NUM = 6 THEN A.M_NAME END)   AS DAY6
               , MAX(CASE WHEN A.M_NUM = 7 THEN A.M_NAME END)   AS DAY7
               , MAX(CASE WHEN A.M_NUM = 8 THEN A.M_NAME END)   AS DAY8
               , MAX(CASE WHEN A.M_NUM = 9 THEN A.M_NAME END)   AS DAY9
               , MAX(CASE WHEN A.M_NUM = 10 THEN A.M_NAME END) AS DAY10
               , MAX(CASE WHEN A.M_NUM = 11 THEN A.M_NAME END) AS DAY11
               , MAX(CASE WHEN A.M_NUM = 12 THEN A.M_NAME END) AS DAY12
               , MAX(CASE WHEN A.M_NUM = 13 THEN A.M_NAME END) AS DAY13
               , MAX(CASE WHEN A.M_NUM = 14 THEN A.M_NAME END) AS DAY14
               , MAX(CASE WHEN A.M_NUM = 15 THEN A.M_NAME END) AS DAY15
               , MAX(CASE WHEN A.M_NUM = 16 THEN A.M_NAME END) AS DAY16
               , MAX(CASE WHEN A.M_NUM = 17 THEN A.M_NAME END) AS DAY17
               , MAX(CASE WHEN A.M_NUM = 18 THEN A.M_NAME END) AS DAY18
               , MAX(CASE WHEN A.M_NUM = 19 THEN A.M_NAME END) AS DAY19
               , MAX(CASE WHEN A.M_NUM = 20 THEN A.M_NAME END) AS DAY20
               , MAX(CASE WHEN A.M_NUM = 21 THEN A.M_NAME END) AS DAY21
               , MAX(CASE WHEN A.M_NUM = 22 THEN A.M_NAME END) AS DAY22
               , MAX(CASE WHEN A.M_NUM = 23 THEN A.M_NAME END) AS DAY23
               , MAX(CASE WHEN A.M_NUM = 24 THEN A.M_NAME END) AS DAY24
               , MAX(CASE WHEN A.M_NUM = 25 THEN A.M_NAME END) AS DAY25
               , MAX(CASE WHEN A.M_NUM = 26 THEN A.M_NAME END) AS DAY26
               , MAX(CASE WHEN A.M_NUM = 27 THEN A.M_NAME END) AS DAY27
               , MAX(CASE WHEN A.M_NUM = 28 THEN A.M_NAME END) AS DAY28
               , MAX(CASE WHEN A.M_NUM = 29 THEN A.M_NAME END) AS DAY29
               , MAX(CASE WHEN A.M_NUM = 30 THEN A.M_NAME END) AS DAY30
               , MAX(CASE WHEN A.M_NUM = 31 THEN A.M_NAME END) AS DAY31
         
        FROM
             ( SELECT 
                     #{S_COMP_CODE} AS COMP_CODE,
                     NUMBER M_NUM, /*DAY, 날짜의 일*/
                     DATEPART(DW, CONVERT(DATETIME, @Calendar)+ NUMBER-1) M_PART, /*DATE에 해당하는 요일넘버, 1(일요일)~7(토요일)*/
                     LEFT(DATENAME(DW, CONVERT(DATETIME, @Calendar)+ NUMBER-1),1) M_NAME, /*DATE에 해당하는 요일명*/
                     DATEDIFF(WK, @Calendar, DATEADD(D, NUMBER-1, @Calendar)) WK,
                     (CASE CONVERT(VARCHAR(8), CONVERT(DATETIME, @Calendar) + NUMBER - 1, 112) 
                      WHEN CONVERT(VARCHAR(8), GETDATE(), 112) THEN '(오늘)' ELSE '' END) TODAY
               FROM MASTER..SPT_VALUES
               WHERE TYPE = 'P'
                 AND NUMBER BETWEEN 1 AND DATEDIFF(D, @Calendar, DATEADD(MM, 1, @Calendar))) A
        
        GROUP BY A.COMP_CODE
	</select>
</mapper>