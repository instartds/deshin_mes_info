<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cmd100ukrvServiceImpl">
	
	<!--
		Sorry, I can`t migrate	Cmd100ukrvModel
		See console output for further details 
	-->
	
	<select id="cmd100ukrvServiceImpl.getDataList" parameterType="Map" resultType="rMap">
			/* cmd100ukrvServiceImpl.getDataList= 일일 영업활동 등록 목록 조회 */
         SELECT 
		        ROW_NUMBER()OVER(ORDER BY A.DOC_NO) AS ROW_NUM
		      , A.DOC_NO             AS DOC_NO               /*  NVARCHAR(20)    NOT NULL                          문서번호                                   */
		      , B1.CUSTOM_CODE       AS PLAN_CUSTOM_CODE
		      , C1.CUSTOM_NAME       AS PLAN_CUSTOM_NAME
		      , B1.DVRY_CUST_SEQ     AS PLAN_DVRY_CUST_SEQ
		      , S1.DVRY_CUST_NM      AS PLAN_DVRY_CUST_NM
		      , A.PLAN_CLIENT        AS PLAN_CLIENT          /*  NUMERIC(20)         NULL                          계획고객                                   */
		      , B1.CLIENT_NAME       AS PLAN_CLIENT_NM
		      , uniLITE.fnGetUserDateComp(A.COMP_CODE, A.PLAN_DATE) AS PLAN_DATE            /*  NVARCHAR(10)        NULL                          계획일자                                   */
		      , A.PLAN_TARGET        AS PLAN_TARGET          /*  NVARCHAR(100)       NULL                          계획목적                                   */         
		      , A.PLAN_GROUP_YN      AS PLAN_GROUP_YN        /*  NVARCHAR(01)        NULL DEFAULT 'N'              계획 동반미팅 여부(Y/N)                    */
		      
		      , A.RESULT_CLIENT      AS RESULT_CLIENT        /*  NUMERIC(20)     NOT NULL DEFAULT 0                결과고객 ID                                */
		      , B2.CLIENT_NAME       AS RESULT_CLIENT_NM
		      , uniLITE.fnGetUserDateComp(A.COMP_CODE, A.RESULT_DATE)        AS RESULT_DATE          /*  NVARCHAR(10)    NOT NULL DEFAULT ''               결과일자                                   */
		      , A.CUSTOM_CODE        AS CUSTOM_CODE          /*  NVARCHAR(20)    NOT NULL                          고객 업체(BCM100T_CUSTOM_CODE)             */
		      , C2.CUSTOM_NAME       AS CUSTOM_NAME
		      , A.DVRY_CUST_SEQ      AS DVRY_CUST_SEQ        /*  NVARCHAR(10)    NOT NULL                          배송처(SCM100T_DVRY_CUST_SEQ)              */
		      , S2.DVRY_CUST_NM      AS DVRY_CUST_NM
		      , A.PROCESS_TYPE       AS PROCESS_TYPE         /*  NVARCHAR(10)    NOT NULL                          공정코드(CMB300T_PROCESS_TYPE)             */
		      , M1.CODE_NAME         AS PROCESS_TYPE_NM
		      , A.PROJECT_NO         AS PROJECT_NO           /*  NVARCHAR(20)    NOT NULL DEFAULT ''               공정코드(CMB200T-PROJECT_NO)               */
		      , C3.PROJECT_NAME      AS PROJECT_NO_NM
		      , A.SALE_EMP           AS SALE_EMP             /*  NVARCHAR(10)    NOT NULL DEFAULT ''               영업 담당자                                */
		      , A.SALE_ATTEND        AS SALE_ATTEND          /*  NVARCHAR(100)       NULL                          영업 참석자                                */
		      , A.SUMMARY_STR        AS SUMMARY_STR          /*  NVARCHAR(200)       NULL                          현황 요약                                  */
		      , A.CONTENT_STR        AS CONTENT_STR          /*  NVARCHAR(1000)      NULL                          결과 내용                                  */
		      , A.REQ_STR            AS REQ_STR              /*  NVARCHAR(20)        NULL                          요청사항                                   */
		      , A.OPINION_STR        AS OPINION_STR          /*  NVARCHAR(200)       NULL                          소견                                       */
		      , A.KEYWORD            AS KEYWORD              /*  NVARCHAR(200)       NULL                          키워드                                     */
		      , A.REMARK             AS REMARK               /*  NVARCHAR(1000)      NULL                          비고                                       */
		      , A.FILE_NO            AS FILE_NO              /*  NVARCHAR(20)        NULL                          첨부 파일 번호(BFL100T-                    */
		      , A.CREATE_EMP         AS CREATE_EMP           /*  NVARCHAR(10)    NOT NULL                          작성자(CMS100T_EMP_ID)                     */
		      , A.UPDATE_EMP         AS UPDATE_EMP           /*  NVARCHAR(10)    NOT NULL                          변경자(CMS100T_EMP_ID)                     */ 
		      , B3.ITEM_CODE
		      , B3.ITEM_NAME
		      , M2.CODE_NAME         AS IMPORTANCE_STATUS
		      , A.SALE_TYPE			 AS SALE_TYPE
		   FROM          CMD100T  A  WITH (NOLOCK)
		       LEFT JOIN CMB100T  B1 WITH (NOLOCK) ON B1.COMP_CODE      = A.COMP_CODE
		                                          AND B1.CLIENT_ID      = A.PLAN_CLIENT
		       LEFT JOIN CMB100T  B2 WITH (NOLOCK) ON B2.COMP_CODE      = A.COMP_CODE
		                                          AND B2.CLIENT_ID      = A.RESULT_CLIENT                                          
		       LEFT JOIN (SELECT COMP_CODE, CUSTOM_CODE, DVRY_CUST_SEQ, PROCESS_TYPE, MAX(ITEM_CODE) AS ITEM_CODE, MAX(ITEM_NAME)AS ITEM_NAME
		                    FROM CMB310TV
		                   WHERE COMP_CODE = 'MASTER'
		                GROUP BY COMP_CODE, CUSTOM_CODE, DVRY_CUST_SEQ, PROCESS_TYPE
		                 ) B3 ON B3.COMP_CODE     = A.COMP_CODE
		                     AND B3.CUSTOM_CODE   = A.CUSTOM_CODE
		                     AND B3.DVRY_CUST_SEQ = A.DVRY_CUST_SEQ
		                     AND B3.PROCESS_TYPE  = A.PROCESS_TYPE

		       LEFT JOIN SCM100T  S1  WITH (NOLOCK) ON S1.COMP_CODE     = B1.COMP_CODE
		                                          AND S1.CUSTOM_CODE    = B1.CUSTOM_CODE
		                                          AND CONVERT(NVARCHAR, S1.DVRY_CUST_SEQ)  = B1.DVRY_CUST_SEQ  
		       LEFT JOIN SCM100T  S2  WITH (NOLOCK) ON S2.COMP_CODE     = A.COMP_CODE
		                                          AND S2.CUSTOM_CODE    = A.CUSTOM_CODE
		                                          AND CONVERT(NVARCHAR, S2.DVRY_CUST_SEQ)  = A.DVRY_CUST_SEQ                                            
		       LEFT JOIN BCM100T  C1 WITH (NOLOCK) ON C1.COMP_CODE      = B1.COMP_CODE
		                                          AND C1.CUSTOM_CODE    = B1.CUSTOM_CODE
		       LEFT JOIN BCM100T  C2 WITH (NOLOCK) ON C2.COMP_CODE      = A.COMP_CODE
		                                          AND C2.CUSTOM_CODE    = A.CUSTOM_CODE  
		       LEFT JOIN CMB200T  C3 WITH (NOLOCK) ON C3.COMP_CODE      = A.COMP_CODE
		                                          AND C3.PROJECT_NO     = A.PROJECT_NO     
		       LEFT JOIN BSA100T  M1 WITH (NOLOCK) ON M1.COMP_CODE      = A.COMP_CODE
		                                          AND M1.MAIN_CODE      = N'ZS08'
		                                          AND M1.SUB_CODE       = A.PROCESS_TYPE
		       LEFT JOIN BSA100T  M2 WITH (NOLOCK) ON M2.COMP_CODE      = C3.COMP_CODE
		                                          AND M2.MAIN_CODE      = N'CB23'
		                                          AND M2.SUB_CODE       = C3.IMPORTANCE_STATUS
		 WHERE A.COMP_CODE        =  #{S_COMP_CODE}
		 	and A.DOC_NO = #{DOC_NO}
				
	</select>	
	<select id="cmd100ukrvServiceImpl.getData" parameterType="Map" resultType="rMap">
	/* cmd100ukrvServiceImpl.getData= 일일 영업활동 등록  조회 */
	BEGIN        
	    DECLARE @COMP_CODE       NVARCHAR(08)
	          , @DOC_NO          NVARCHAR(20)
	          , @TYPE            NVARCHAR(01)
	          , @AUTHORITY_LEVEL NVARCHAR(10)
	          
	        SET @COMP_CODE       = #{S_COMP_CODE}
	        SET @DOC_NO          = #{DOC_NO}
	        <if test="@foren.Ognl@isNotEmpty(TYPE)">
	        SET @TYPE            = #{TYPE}
	        </if>
	        <if test="@foren.Ognl@isEmpty(TYPE)">
	        SET @TYPE            = 'Q'	
	        </if>
	        SET @AUTHORITY_LEVEL = #{S_AUTHORITY_LEVEL}
	
	        IF @DOC_NO = ''
	            SET @DOC_NO = (SELECT MIN(DOC_NO) FROM CMD100T WITH (NOLOCK) WHERE COMP_CODE = @COMP_CODE)
	
	
	
	 SELECT TOP 1 A.COMP_CODE    AS COMP_CODE            /*  NVARCHAR(08)    NOT NULL DEFAULT 'MASTER'         법인코드                                   */
	      , A.DOC_NO             AS DOC_NO               /*  NVARCHAR(20)    NOT NULL                          문서번호                                   */
	      , CASE WHEN ISNULL(RESULT_DATE,'') != ''  THEN RESULT_CLIENT
				 ELSE PLAN_CLIENT
			END CLIENT
		  , CASE WHEN ISNULL(RESULT_DATE,'') != ''  THEN B2.CLIENT_NAME
				 ELSE B1.CLIENT_NAME
			END CLIENT_NM
	      , B1.CUSTOM_CODE       AS PLAN_CUSTOM_CODE
	      , C1.CUSTOM_NAME       AS PLAN_CUSTOM_NAME
	      , B1.DVRY_CUST_SEQ     AS PLAN_DVRY_CUST_SEQ
	      , S1.DVRY_CUST_NM      AS PLAN_DVRY_CUST_NM
	      , A.PLAN_CLIENT        AS PLAN_CLIENT          /*  NUMERIC(20)         NULL                          계획고객                                   */
	      , B1.CLIENT_NAME       AS PLAN_CLIENT_NM
	      , uniLITE.fnGetUserDateComp(A.COMP_CODE, A.PLAN_DATE)          AS PLAN_DATE            /*  NVARCHAR(10)        NULL                          계획일자                                   */
	      , A.PLAN_TARGET        AS PLAN_TARGET          /*  NVARCHAR(100)       NULL                          계획목적                                   */         
	      , A.PLAN_GROUP_YN      AS PLAN_GROUP_YN        /*  NVARCHAR(01)        NULL DEFAULT 'N'              계획 동반미팅 여부(Y/N)                    */
	      , A.PLAN_TIME			 AS PLAN_TIME
	      
	      , A.RESULT_CLIENT      AS RESULT_CLIENT        /*  NUMERIC(20)     NOT NULL DEFAULT 0                결과고객 ID                                */
	      , B2.CLIENT_NAME       AS RESULT_CLIENT_NM
	      , uniLITE.fnGetUserDateComp(A.COMP_CODE, A.RESULT_DATE)        AS RESULT_DATE          /*  NVARCHAR(10)    NOT NULL DEFAULT ''               결과일자                                   */
	      , A.RESULT_TIME        AS RESULT_TIME
	      , A.CUSTOM_CODE        AS CUSTOM_CODE          /*  NVARCHAR(20)    NOT NULL                          고객 업체(BCM100T_CUSTOM_CODE)             */
	      , C2.CUSTOM_NAME       AS CUSTOM_NAME
	      , A.DVRY_CUST_SEQ      AS DVRY_CUST_SEQ        /*  NVARCHAR(10)    NOT NULL                          배송처(SCM100T_DVRY_CUST_SEQ)              */
	      , S2.DVRY_CUST_NM      AS DVRY_CUST_NM
	      , A.PROCESS_TYPE       AS PROCESS_TYPE         /*  NVARCHAR(10)    NOT NULL                          공정코드(CMB300T_PROCESS_TYPE)             */
	      , M1.CODE_NAME         AS PROCESS_TYPE_NM
	      , A.PROJECT_NO         AS PROJECT_NO           /*  NVARCHAR(20)    NOT NULL DEFAULT ''               공정코드(CMB200T-PROJECT_NO)               */
	      , C3.PROJECT_NAME      AS PROJECT_NO_NM
	      , A.SALE_EMP           AS SALE_EMP             /*  NVARCHAR(10)    NOT NULL DEFAULT ''               영업 담당자                                */
	      , A.SALE_ATTEND        AS SALE_ATTEND          /*  NVARCHAR(100)       NULL                          영업 참석자                                */
	      , A.SUMMARY_STR        AS SUMMARY_STR          /*  NVARCHAR(200)       NULL                          현황 요약                                  */
	      , A.CONTENT_STR        AS CONTENT_STR          /*  NVARCHAR(1000)      NULL                          결과 내용                                  */
	      , A.REQ_STR            AS REQ_STR              /*  NVARCHAR(20)        NULL                          요청사항                                   */
	      , A.OPINION_STR        AS OPINION_STR          /*  NVARCHAR(200)       NULL                          소견                                       */
	      , A.KEYWORD            AS KEYWORD              /*  NVARCHAR(200)       NULL                          키워드                                     */
	      , A.REMARK             AS REMARK               /*  NVARCHAR(1000)      NULL                          비고                                       */
	      , A.FILE_NO            AS FILE_NO              /*  NVARCHAR(20)        NULL                          첨부 파일 번호(BCD100T-                    */
	      , A.CREATE_EMP         AS CREATE_EMP           /*  NVARCHAR(10)    NOT NULL                          작성자(CMS100T_EMP_ID)                     */
	      , A.UPDATE_EMP         AS UPDATE_EMP           /*  NVARCHAR(10)    NOT NULL                          변경자(CMS100T_EMP_ID)                     */
	      , A.AUTHORITY_LEVEL    AS AUTHORITY_LEVEL      /*  NVARCHAR(10)    NOT NULL                          권한레벨 (CM10)                            */
	      , A.INSERT_DB_USER     AS INSERT_DB_USER       /*  NVARCHAR(20)    NOT NULL DEFAULT 'uniLITE'        입력자                                     */
	      , A.INSERT_DB_TIME     AS INSERT_DB_TIME       /*  SMALLDATETIME   NOT NULL DEFAULT GETDATE()        입력일                                     */
	      , A.UPDATE_DB_USER     AS UPDATE_DB_USER       /*  NVARCHAR(20)    NOT NULL DEFAULT 'uniLITE'        수정자                                     */
	      , A.UPDATE_DB_TIME     AS UPDATE_DB_TIME       /*  SMALLDATETIME   NOT NULL DEFAULT GETDATE()        수정일                                     */
	 
	      , B3.ITEM_CODE
	      , B3.ITEM_NAME
	      , A.IMPORTANCE_STATUS         AS IMPORTANCE_STATUS
	      , A.SALE_TYPE          AS SALE_TYPE
	      , A.ETC_CLIENT         AS ETC_CLIENT
	      , A.SALE_STATUS        AS SALE_STATUS
	
	      , A.WRITE_EMP1
	      , A.WRITE_EMP2
	      , A.WRITE_EMP3
	      , A.OPINION_STR2
	      , A.OPINION_STR3
	      , 'UPDATE'	ACTION_TYPE
	      , A.SALES_PROJECTION
	   FROM          CMD100T  A  WITH (NOLOCK)
	       LEFT JOIN CMB100T  B1 WITH (NOLOCK) ON B1.COMP_CODE      = A.COMP_CODE
	                                          AND B1.CLIENT_ID      = A.PLAN_CLIENT
	       LEFT JOIN CMB100T  B2 WITH (NOLOCK) ON B2.COMP_CODE      = A.COMP_CODE
	                                          AND B2.CLIENT_ID      = A.RESULT_CLIENT                                          
	       LEFT JOIN (SELECT COMP_CODE, CUSTOM_CODE, DVRY_CUST_SEQ, PROCESS_TYPE, MAX(ITEM_CODE) AS ITEM_CODE, MAX(ITEM_NAME)AS ITEM_NAME
	                    FROM CMB310TV
	                   WHERE COMP_CODE = @COMP_CODE
	                GROUP BY COMP_CODE, CUSTOM_CODE, DVRY_CUST_SEQ, PROCESS_TYPE
	                 ) B3 ON B3.COMP_CODE     = A.COMP_CODE
	                     AND B3.CUSTOM_CODE   = A.CUSTOM_CODE
	                     AND B3.DVRY_CUST_SEQ = A.DVRY_CUST_SEQ
	                     AND B3.PROCESS_TYPE  = A.PROCESS_TYPE
	       LEFT JOIN SCM100T  S1  WITH (NOLOCK) ON S1.COMP_CODE     = B1.COMP_CODE
	                                          AND S1.CUSTOM_CODE    = B1.CUSTOM_CODE
	                                          AND CONVERT(NVARCHAR, S1.DVRY_CUST_SEQ)  = B1.DVRY_CUST_SEQ  
	       LEFT JOIN SCM100T  S2  WITH (NOLOCK) ON S2.COMP_CODE     = A.COMP_CODE
	                                          AND S2.CUSTOM_CODE    = A.CUSTOM_CODE
	                                          AND CONVERT(NVARCHAR, S2.DVRY_CUST_SEQ)  = A.DVRY_CUST_SEQ                                            
	       LEFT JOIN BCM100T  C1 WITH (NOLOCK) ON C1.COMP_CODE      = B1.COMP_CODE
	                                          AND C1.CUSTOM_CODE    = B1.CUSTOM_CODE
	       LEFT JOIN BCM100T  C2 WITH (NOLOCK) ON C2.COMP_CODE      = A.COMP_CODE
	                                          AND C2.CUSTOM_CODE    = A.CUSTOM_CODE  
	       LEFT JOIN CMB200T  C3 WITH (NOLOCK) ON C3.COMP_CODE      = A.COMP_CODE
	                                          AND C3.PROJECT_NO     = A.PROJECT_NO     
	       LEFT JOIN BSA100T  M1 WITH (NOLOCK) ON M1.COMP_CODE      = A.COMP_CODE
	                                          AND M1.MAIN_CODE      = N'ZS08'
	                                          AND M1.SUB_CODE       = A.PROCESS_TYPE
	       LEFT JOIN BSA100T  M2 WITH (NOLOCK) ON M2.COMP_CODE      = A.COMP_CODE
	                                          AND M2.MAIN_CODE      = 'CB23'
	                                          AND M2.SUB_CODE       = A.IMPORTANCE_STATUS
	                                          
	     WHERE A.COMP_CODE = @COMP_CODE
	       AND A.AUTHORITY_LEVEL  &gt;= @AUTHORITY_LEVEL
	       AND (
	              (@TYPE = 'Q' AND A.DOC_NO     = @DOC_NO AND @DOC_NO != '')
	          OR  (@TYPE = 'P' AND A.DOC_NO     &lt; @DOC_NO AND @DOC_NO != '')
	          OR  (@TYPE = 'N' AND A.DOC_NO     &gt; @DOC_NO AND @DOC_NO != '')
	        
	           )
	 		 ORDER BY A.DOC_NO

	END	
	</select>
	
	<select id="cmd100ukrvServiceImpl.getAutoNumComp" parameterType="foren.unilite.modules.crm.cmd.Cmd100ukrvModel" resultType="String">
		/* cmd100ukrvServiceImpl.getAutoNumComp 일일 영업활동 등록 문서번호 생성 */
		DECLARE  @DOC_NO               NVARCHAR(20)          /*문서번호*/    
				,@CDATE					NVARCHAR(8)
		SET		@CDATE = CONVERT(NVARCHAR(8), GETDATE(),112) 
		            EXEC uniLITE.SP_GetAutoNumComp 'MASTER', 'DM', 'CMD100T', '', @CDATE, '1', @DOC_NO OUTPUT
		            
		 select @DOC_NO  as a
	</select>

	<update id="cmd100ukrvServiceImpl.insert" parameterType="foren.unilite.modules.crm.cmd.Cmd100ukrvModel" >

			/* cmd100ukrvServiceImpl.insert= 일일 영업활동 등록 등록 */
		    DECLARE @COMP_CODE            NVARCHAR(08)          /*법인코드*/                          
		          , @DOC_NO               NVARCHAR(20)          /*문서번호*/                               
		          , @PLAN_DATE            NVARCHAR(10)          /*계획일자*/                          
		          , @PLAN_TARGET          NVARCHAR(100)         /*계획목적*/                          
		          , @PLAN_GROUP_YN        NVARCHAR(01)          /*계획 동반미팅 여부(Y/N)*/           
		          
		          , @CLIENT        		  NUMERIC(20)           /*결과고객 ID*/                       
		          , @RESULT_DATE          NVARCHAR(10)          /*결과일자*/                          
		          , @RESULT_TIME          NVARCHAR(08)          /*결과시간*/                          
		          , @CUSTOM_CODE          NVARCHAR(20)          /*고객 업체(BCM100T_CUSTOM_CODE)*/    
		          , @DVRY_CUST_SEQ        NVARCHAR(10)          /*배송처(SCM100T_DVRY_CUST_SEQ) */    
		          , @PROCESS_TYPE         NVARCHAR(10)          /*공정코드(CMB300T_PROCESS_TYPE)*/    
		          , @PROJECT_NO           NVARCHAR(20)          /*공정코드(CMB200T-PROJECT_NO)*/      
		          , @SALE_EMP             NVARCHAR(10)          /*영업 담당자*/                       
		          , @SALE_ATTEND          NVARCHAR(100)         /*영업 참석자 */                      
		          , @SUMMARY_STR          NVARCHAR(200)         /*현황 요약 */                        
		          , @CONTENT_STR          NVARCHAR(1000)        /*결과 내용 */                        
		          , @REQ_STR              NVARCHAR(50)          /*요청사항*/                          
		          , @OPINION_STR          NVARCHAR(200)         /*소견    */                          
		          , @OPINION_STR2         NVARCHAR(200)         /*소견2   */                          
		          , @OPINION_STR3         NVARCHAR(200)         /*소견3   */                          
		          , @KEYWORD              NVARCHAR(200)         /*키워드  */                          
		          , @REMARK               NVARCHAR(1000)        /*비고    */                          
		          , @SALE_TYPE            NVARCHAR(02)          /*영업유형*/                          
		          , @FILE_NO              NVARCHAR(20)          /*첨부 파일 번호(BFL100T-*/           
		          , @CREATE_EMP           NVARCHAR(10)          /*작성자(CMS100T_EMP_ID)*/            
		          , @UPDATE_EMP           NVARCHAR(10)          /*변경자(CMS100T_EMP_ID) */           
		          , @AUTHORITY_LEVEL      NVARCHAR(10)          /*권한레벨 (CM10) */                  
		          , @INSERT_DB_USER       NVARCHAR(20)          /*입력자  */                          
		          , @UPDATE_DB_USER       NVARCHAR(20)          /*수정자  */                          
		          , @IMPORTANCE_STATUS    NVARCHAR(10)          /*중요도  */                          
		          , @USER_ID              NVARCHAR(100)
		          , @ERROR_DESC           NVARCHAR(100)
		          , @SALE_STATUS          NVARCHAR(02)          /*상태*/
		          
		          , @WRITE_EMP1           NVARCHAR(20)
		          , @WRITE_EMP2           NVARCHAR(20)
		          , @WRITE_EMP3           NVARCHAR(20)
		          , @PLAN_TIME			  NVARCHAR(8)
		          , @SALES_PROJECTION	  NUMERIC(5,2)
		
				<if test="@foren.Ognl@isNotEmpty(S_COMP_CODE)">
		        	SET @COMP_CODE           = #{S_COMP_CODE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(DOC_NO)">
		        	SET @DOC_NO              = #{DOC_NO}
				</if>
				<if test="@foren.Ognl@isNotEmpty(CLIENT)">
		        	SET @CLIENT         = #{CLIENT}		        	
				</if>
				<if test="@foren.Ognl@isNotEmpty(PLAN_DATE)">
		        	SET @PLAN_DATE           = #{PLAN_DATE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PLAN_TARGET)">
		        	SET @PLAN_TARGET         = #{PLAN_TARGET}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PLAN_GROUP_YN)">
		        	SET @PLAN_GROUP_YN       = #{PLAN_GROUP_YN}
				</if>
				<if test="@foren.Ognl@isNotEmpty(FILE_NO)">
		        	SET @FILE_NO       = #{FILE_NO}
				</if>
		
				
				<if test="@foren.Ognl@isNotEmpty(RESULT_DATE)">
		        	SET @RESULT_DATE         = #{RESULT_DATE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(RESULT_TIME)">
		        	SET @RESULT_TIME         = #{RESULT_TIME}
				</if>
				<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE)">
		        	SET @CUSTOM_CODE         = #{CUSTOM_CODE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(DVRY_CUST_SEQ)">
		        	SET @DVRY_CUST_SEQ       = #{DVRY_CUST_SEQ}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PROCESS_TYPE)">
		        	SET @PROCESS_TYPE        = #{PROCESS_TYPE}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PROJECT_NO)">
		        	SET @PROJECT_NO          = #{PROJECT_NO}
				</if>
				<if test="@foren.Ognl@isNotEmpty(SALE_EMP)">
		        	SET @SALE_EMP            = #{SALE_EMP}
				</if>
				<if test="@foren.Ognl@isNotEmpty(SALE_ATTEND)">
		        	SET @SALE_ATTEND         = #{SALE_ATTEND}
				</if>
				<if test="@foren.Ognl@isNotEmpty(SUMMARY_STR)">
		        	SET @SUMMARY_STR         = #{SUMMARY_STR}
				</if>
				<if test="@foren.Ognl@isNotEmpty(CONTENT_STR)">
		        	SET @CONTENT_STR         = #{CONTENT_STR}
				</if>
				<if test="@foren.Ognl@isNotEmpty(REQ_STR)">
		        	SET @REQ_STR             = #{REQ_STR}
				</if>
				<if test="@foren.Ognl@isNotEmpty(OPINION_STR)">
		        	SET @OPINION_STR         = #{OPINION_STR}
				</if>
				<if test="@foren.Ognl@isNotEmpty(OPINION_STR2)">
		        	SET @OPINION_STR2        = #{OPINION_STR2}
				</if>
				<if test="@foren.Ognl@isNotEmpty(OPINION_STR3)">
		        	SET @OPINION_STR3        = #{OPINION_STR3}
				</if>
				<if test="@foren.Ognl@isNotEmpty(KEYWORD)">
		        	SET @KEYWORD             = #{KEYWORD}
				</if>
				<if test="@foren.Ognl@isNotEmpty(REMARK)">
		        	SET @REMARK              = #{REMARK}
				</if>
				<if test="@foren.Ognl@isNotEmpty(SALE_TYPE)">
		        	SET @SALE_TYPE           = #{SALE_TYPE}
				</if>
				
				<if test="@foren.Ognl@isNotEmpty(CREATE_EMP)">
		        	SET @CREATE_EMP          = #{CREATE_EMP}
				</if>
				<if test="@foren.Ognl@isNotEmpty(S_USER_ID)">
		        	SET @UPDATE_EMP          = #{S_USER_ID}
				</if>
				<if test="@foren.Ognl@isNotEmpty(S_AUTHORITY_LEVEL)">
		        	SET @AUTHORITY_LEVEL     = #{S_AUTHORITY_LEVEL}
				</if>
				<if test="@foren.Ognl@isNotEmpty(S_USER_ID)">
		        	SET @INSERT_DB_USER      = #{S_USER_ID}
				</if>
				<if test="@foren.Ognl@isNotEmpty(S_USER_ID)">
		        	SET @UPDATE_DB_USER      = #{S_USER_ID}
				</if>
				
				<if test="@foren.Ognl@isNotEmpty(IMPORTANCE_STATUS)">
		        	SET @IMPORTANCE_STATUS   = #{IMPORTANCE_STATUS}
				</if>
				
				<if test="@foren.Ognl@isNotEmpty(S_USER_ID)">
		        	SET @USER_ID             = #{S_USER_ID}
				</if>
				<if test="@foren.Ognl@isNotEmpty(SALE_STATUS)">
		        	SET @SALE_STATUS         = #{SALE_STATUS}
				</if>
				<if test="@foren.Ognl@isNotEmpty(WRITE_EMP1)">
		        	SET @WRITE_EMP1          = #{WRITE_EMP1}
				</if>
				<if test="@foren.Ognl@isNotEmpty(WRITE_EMP2)">
		        	SET @WRITE_EMP2          = #{WRITE_EMP2}
				</if>
				<if test="@foren.Ognl@isNotEmpty(WRITE_EMP3)">
		        	SET @WRITE_EMP3          = #{WRITE_EMP3}
				</if>
				<if test="@foren.Ognl@isNotEmpty(PLAN_TIME)">
		        	SET @PLAN_TIME          = #{PLAN_TIME}
				</if>
				<if test="@foren.Ognl@isNotEmpty(SALES_PROJECTION)">
		 			SET @SALES_PROJECTION	= #{SALES_PROJECTION}
				</if>
		        BEGIN
		            
		            INSERT INTO CMD100T 
		                                (
		                                  COMP_CODE          ,DOC_NO            ,SALE_TYPE  ,PROJECT_NO ,CUSTOM_CODE      ,DVRY_CUST_SEQ      ,PROCESS_TYPE  
		                                  <if test="PLAN_SAVE_YN == &quot;Y&quot;"> 
		                                  	,PLAN_CLIENT        ,PLAN_DATE        ,PLAN_TIME		,PLAN_TARGET   	,PLAN_GROUP_YN   
		                                  </if>
		                                  
		                                  <if test="RESULT_SAVE_YN == &quot;Y&quot;"> 
			                                  ,RESULT_CLIENT    ,RESULT_DATE                    ,SALE_EMP           ,SALE_ATTEND      ,SUMMARY_STR      
			                                 ,CONTENT_STR        ,REQ_STR          ,OPINION_STR        ,KEYWORD          ,REMARK       
			                                 ,IMPORTANCE_STATUS  ,RESULT_TIME      ,SALE_STATUS        ,OPINION_STR2     ,OPINION_STR3
			                                 ,WRITE_EMP1         ,WRITE_EMP2       ,WRITE_EMP3	, SALES_PROJECTION	
		                                  </if> 
		                                 ,CREATE_EMP       ,UPDATE_EMP         ,AUTHORITY_LEVEL, FILE_NO  
		                                 ,INSERT_DB_USER    ,INSERT_DB_TIME     ,UPDATE_DB_USER   ,UPDATE_DB_TIME  
		                                 )
		                          VALUES (
		                                  @COMP_CODE         ,@DOC_NO          ,@SALE_TYPE ,@PROJECT_NO ,@CUSTOM_CODE  ,'1'    ,' '
		                                  <if test="PLAN_SAVE_YN == &quot;Y&quot;"> 
		                                 	 ,@CLIENT 			 ,@PLAN_DATE       ,@PLAN_TIME ,@PLAN_TARGET      ,@PLAN_GROUP_YN
		                                  </if>		                                   
		                                  <if test="RESULT_SAVE_YN == &quot;Y&quot;"> 
			                                 ,@CLIENT   		,@RESULT_DATE                   ,@SALE_EMP          ,@SALE_ATTEND     ,@SUMMARY_STR     
			                                 ,@CONTENT_STR       ,@REQ_STR         ,@OPINION_STR       ,@KEYWORD         ,@REMARK 
			                                 ,@IMPORTANCE_STATUS ,@RESULT_TIME     ,@SALE_STATUS       ,@OPINION_STR2    ,@OPINION_STR3
			                                 ,@WRITE_EMP1        ,@WRITE_EMP2      ,@WRITE_EMP3	,@SALES_PROJECTION
		                                  </if>       
		                                 ,@CREATE_EMP      ,@UPDATE_EMP        ,@AUTHORITY_LEVEL , @FILE_NO
		                                 ,@INSERT_DB_USER  ,GETDATE()          ,@UPDATE_DB_USER  ,GETDATE()                
		                                	   
		                                 )                               
		                    
		        END
		        
		        EXEC uniLITE.SP_CM_MakeKeyWord #{S_COMP_CODE}, 'DM', #{S_USER_ID}, #{KEYWORD}, #{S_USER_ID}, @ERROR_DESC OUTPUT 
		        
	</update>
	<update id="cmd100ukrvServiceImpl.update" parameterType="foren.unilite.modules.crm.cmd.Cmd100ukrvModel">
		 /* cmd100ukrvServiceImpl.update= 일일 영업활동 등록 수정 */
         BEGIN
         DECLARE @COMP_CODE            NVARCHAR(08)          /*법인코드*/                          
		          , @DOC_NO               NVARCHAR(20)          /*문서번호*/                          
		          , @CLIENT          NUMERIC(20)           /*고객*/                          
		          , @PLAN_DATE            NVARCHAR(10)          /*계획일자*/                          
		          , @PLAN_TARGET          NVARCHAR(100)         /*계획목적*/                          
		          , @PLAN_GROUP_YN        NVARCHAR(01)          /*계획 동반미팅 여부(Y/N)*/           
		          
		          , @RESULT_DATE          NVARCHAR(10)          /*결과일자*/                          
		          , @RESULT_TIME          NVARCHAR(08)          /*결과시간*/                          
		          , @CUSTOM_CODE          NVARCHAR(20)          /*고객 업체(BCM100T_CUSTOM_CODE)*/    
		          , @DVRY_CUST_SEQ        NVARCHAR(10)          /*배송처(SCM100T_DVRY_CUST_SEQ) */    
		          , @PROCESS_TYPE         NVARCHAR(10)          /*공정코드(CMB300T_PROCESS_TYPE)*/    
		          , @PROJECT_NO           NVARCHAR(20)          /*공정코드(CMB200T-PROJECT_NO)*/      
		          , @SALE_EMP             NVARCHAR(10)          /*영업 담당자*/                       
		          , @SALE_ATTEND          NVARCHAR(100)         /*영업 참석자 */                      
		          , @SUMMARY_STR          NVARCHAR(200)         /*현황 요약 */                        
		          , @CONTENT_STR          NVARCHAR(1000)        /*결과 내용 */                        
		          , @REQ_STR              NVARCHAR(50)          /*요청사항*/                          
		          , @OPINION_STR          NVARCHAR(200)         /*소견    */                          
		          , @OPINION_STR2         NVARCHAR(200)         /*소견2   */                          
		          , @OPINION_STR3         NVARCHAR(200)         /*소견3   */                          
		          , @KEYWORD              NVARCHAR(200)         /*키워드  */                          
		          , @REMARK               NVARCHAR(1000)        /*비고    */                          
		          , @SALE_TYPE            NVARCHAR(02)          /*영업유형*/                          
		          , @FILE_NO              NVARCHAR(20)          /*첨부 파일 번호(BCD100T-  */         
		          , @CREATE_EMP           NVARCHAR(10)          /*작성자(CMS100T_EMP_ID)*/            
		          , @UPDATE_EMP           NVARCHAR(10)          /*변경자(CMS100T_EMP_ID) */           
		          , @AUTHORITY_LEVEL      NVARCHAR(10)          /*권한레벨 (CM10) */                  
		          , @INSERT_DB_USER       NVARCHAR(20)          /*입력자  */                          
		          , @UPDATE_DB_USER       NVARCHAR(20)          /*수정자  */                          
		          , @IMPORTANCE_STATUS    NVARCHAR(10)          /*중요도  */                          
		          , @USER_ID              NVARCHAR(100)
		          , @ERROR_DESC           NVARCHAR(100)
		          , @SALE_STATUS          NVARCHAR(02)          /*상태*/
		          
		          , @WRITE_EMP1           NVARCHAR(20)
		          , @WRITE_EMP2           NVARCHAR(20)
		          , @WRITE_EMP3           NVARCHAR(20)
		          , @PLAN_TIME			  NVARCHAR(8)
				  , @SALES_PROJECTION	  NUMERIC(5,2)	
				  
				<if test="@foren.Ognl@isExists(_parameter, 'S_COMP_CODE')">
		        	SET @COMP_CODE           = #{S_COMP_CODE}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'DOC_NO')">
		        	SET @DOC_NO              = #{DOC_NO}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'CLIENT')">
		        	SET @CLIENT         = #{CLIENT}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'CUSTOM_CODE')">
		        	SET @CUSTOM_CODE         = #{CUSTOM_CODE}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'DVRY_CUST_SEQ')">
		        	SET @DVRY_CUST_SEQ       = #{DVRY_CUST_SEQ}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'PROCESS_TYPE')">
		        	SET @PROCESS_TYPE        = #{PROCESS_TYPE}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'PROJECT_NO')">
		        	SET @PROJECT_NO          = #{PROJECT_NO}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'SALE_TYPE')">
			       	SET @SALE_TYPE           = #{SALE_TYPE}
				</if>
					
				<if test="PLAN_SAVE_YN == &quot;Y&quot;"> 
					<if test="@foren.Ognl@isExists(_parameter, 'PLAN_DATE')">
			        	SET @PLAN_DATE           = #{PLAN_DATE}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'PLAN_TARGET')">
			        	SET @PLAN_TARGET         = #{PLAN_TARGET}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'PLAN_GROUP_YN')">
			        	SET @PLAN_GROUP_YN       = #{PLAN_GROUP_YN}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'PLAN_TIME')">
			        	SET @PLAN_TIME             = #{PLAN_TIME}
					</if>
				</if>

				<if test="RESULT_SAVE_YN == &quot;Y&quot;"> 
					<if test="@foren.Ognl@isExists(_parameter, 'RESULT_DATE')">
			        	SET @RESULT_DATE         = #{RESULT_DATE}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'RESULT_TIME')">
			        	SET @RESULT_TIME         = #{RESULT_TIME}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'SALE_EMP')">
			        	SET @SALE_EMP            = #{SALE_EMP}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'SALE_ATTEND')">
			        	SET @SALE_ATTEND         = #{SALE_ATTEND}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'SUMMARY_STR')">
			        	SET @SUMMARY_STR         = #{SUMMARY_STR}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'CONTENT_STR')">
			        	SET @CONTENT_STR         = #{CONTENT_STR}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'REQ_STR')">
			        	SET @REQ_STR             = #{REQ_STR}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'OPINION_STR')">
			        	SET @OPINION_STR         = #{OPINION_STR}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'OPINION_STR2')">
			        	SET @OPINION_STR2        = #{OPINION_STR2}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'OPINION_STR3')">
			        	SET @OPINION_STR3        = #{OPINION_STR3}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'KEYWORD')">
			        	SET @KEYWORD             = #{KEYWORD}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'REMARK')">
			        	SET @REMARK              = #{REMARK}
					</if>
					
					<if test="@foren.Ognl@isExists(_parameter, 'IMPORTANCE_STATUS')">
			        	SET @IMPORTANCE_STATUS   = #{IMPORTANCE_STATUS}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'SALE_STATUS')">
			        	SET @SALE_STATUS         = #{SALE_STATUS}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'WRITE_EMP1')">
						SET @WRITE_EMP1          = #{WRITE_EMP1}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'WRITE_EMP2')">
			        	SET @WRITE_EMP2          = #{WRITE_EMP2}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'WRITE_EMP3')">
			        	SET @WRITE_EMP3          = #{WRITE_EMP3}
					</if>
					<if test="@foren.Ognl@isExists(_parameter, 'SALES_PROJECTION')">
		 				SET @SALES_PROJECTION	= #{SALES_PROJECTION}
					</if>
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'CREATE_EMP')">
		        	SET @CREATE_EMP          = #{CREATE_EMP}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'S_USER_ID')">
		        	SET @UPDATE_EMP          = #{S_USER_ID}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'FILE_NO')">
		        	SET @FILE_NO             = #{FILE_NO}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'S_AUTHORITY_LEVEL')">
		        	SET @AUTHORITY_LEVEL     = #{S_AUTHORITY_LEVEL}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'S_USER_ID')">
		        	SET @INSERT_DB_USER      = #{S_USER_ID}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'S_USER_ID')">
		        	SET @UPDATE_DB_USER      = #{S_USER_ID}
				</if>
				<if test="@foren.Ognl@isExists(_parameter, 'S_USER_ID')">
		        	SET @USER_ID             = #{S_USER_ID}
				</if>
				
				
	           UPDATE A
	              SET UPDATE_DB_USER     = @UPDATE_DB_USER 
					  ,UPDATE_DB_TIME     = GETDATE()
	              <if test="@foren.Ognl@isExists(_parameter, 'CUSTOM_CODE')">
	                 ,CUSTOM_CODE        = @CUSTOM_CODE    
	              </if>
	              <if test="@foren.Ognl@isExists(_parameter, 'DVRY_CUST_SEQ')">
	                 ,DVRY_CUST_SEQ      = '1' 
	              </if>
	              <if test="@foren.Ognl@isExists(_parameter, 'PROCESS_TYPE')">
	                 ,PROCESS_TYPE       = @PROCESS_TYPE   
	              </if>
	              <if test="@foren.Ognl@isExists(_parameter, 'PROJECT_NO')">
	                 ,PROJECT_NO         = @PROJECT_NO     
	              </if>
	              <if test="@foren.Ognl@isExists(_parameter, 'SALE_TYPE')">  
	                 ,SALE_TYPE          = @SALE_TYPE   
	              </if>
	              <if test="@foren.Ognl@isExists(_parameter, 'S_USER_ID')">
	                 ,UPDATE_EMP         = @UPDATE_EMP   
	              </if>
	              <if test="@foren.Ognl@isExists(_parameter, 'S_AUTHORITY_LEVEL')"> 
	                 ,AUTHORITY_LEVEL    = @AUTHORITY_LEVEL
	              </if>
	              <if test="@foren.Ognl@isExists(_parameter, 'FILE_NO')">
	                 ,FILE_NO    = @FILE_NO
	              </if>
	              
	              <if test="PLAN_SAVE_YN == &quot;Y&quot;"> 
	              	 <if test="@foren.Ognl@isExists(_parameter, 'CLIENT')">
	              	 	,PLAN_CLIENT        = @CLIENT
	              	 </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'PLAN_DATE')">
		              	 ,PLAN_DATE          = @PLAN_DATE  
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'PLAN_TARGET')">
		              	 ,PLAN_TARGET        = @PLAN_TARGET
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'PLAN_GROUP_YN')">
			             ,PLAN_GROUP_YN      = @PLAN_GROUP_YN
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'PLAN_TIME')">
			             ,PLAN_TIME      = @PLAN_TIME
		              </if>		              
	              </if>
	              <if test="RESULT_SAVE_YN == &quot;Y&quot;"> 
		              <if test="@foren.Ognl@isExists(_parameter, 'CLIENT')">
		              	 ,RESULT_CLIENT      = @CLIENT  
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'RESULT_DATE')">
		                 ,RESULT_DATE        = @RESULT_DATE    
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'RESULT_TIME')">
		                 ,RESULT_TIME        = @RESULT_TIME    
		              </if>
	              
		              <if test="@foren.Ognl@isExists(_parameter, 'SALE_EMP')">
		                 ,SALE_EMP           = @SALE_EMP       
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'SALE_ATTEND')">
		                 ,SALE_ATTEND        = @SALE_ATTEND    
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'SUMMARY_STR')">
		                 ,SUMMARY_STR        = @SUMMARY_STR    
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'CONTENT_STR')">
		                 ,CONTENT_STR        = @CONTENT_STR   
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'REQ_STR')">
		                 ,REQ_STR            = @REQ_STR        
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'OPINION_STR')">
		                 ,OPINION_STR        = @OPINION_STR    
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'OPINION_STR2')">
		                 ,OPINION_STR2       = @OPINION_STR2   
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'OPINION_STR3')">
		                 ,OPINION_STR3       = @OPINION_STR3   
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'KEYWORD')">
		                 ,KEYWORD            = @KEYWORD       
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'REMARK')">
		                 ,REMARK             = @REMARK    
		              </if>
	              
		              <if test="@foren.Ognl@isExists(_parameter, 'IMPORTANCE_STATUS')">
		                 ,IMPORTANCE_STATUS  = @IMPORTANCE_STATUS  
		              </if>  
		              <if test="@foren.Ognl@isExists(_parameter, 'SALE_STATUS')">
	                 	,SALE_STATUS        = @SALE_STATUS
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'WRITE_EMP1')">
		                 ,WRITE_EMP1         = @WRITE_EMP1
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'WRITE_EMP2')">
		                 ,WRITE_EMP2         = @WRITE_EMP2
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'WRITE_EMP3')">
		                 ,WRITE_EMP3         = @WRITE_EMP3
		              </if>
		              <if test="@foren.Ognl@isExists(_parameter, 'SALES_PROJECTION')">
		                 ,SALES_PROJECTION   = @SALES_PROJECTION
		              </if>
		              
	              </if>         
	              FROM CMD100T A WITH (NOLOCK)
	             WHERE COMP_CODE = @COMP_CODE
	               AND DOC_NO    = @DOC_NO
	       END
	         
	</update>	
	<update id="cmd100ukrvServiceImpl.delete" parameterType="Map">
		 /* cmd100skrvServiceImpl.delete= 일일 영업활동 등록 삭제 */
         DELETE 
          FROM CMD100T
         WHERE COMP_CODE = #{S_COMP_CODE}
           AND DOC_NO    = #{DOC_NO}
	</update>	
	<update id="cmd100ukrvServiceImpl.updateSalesProjection" parameterType="Map">
		 UPDATE CMB200T 
			SET SALES_PROJECTION = (SELECT TOP 1 SALES_PROJECTION FROM CMD100T WHERE COMP_CODE =#{S_COMP_CODE} AND PROJECT_NO = #{PROJECT_NO} ORDER BY RESULT_DATE DESC) 
		  WHERE COMP_CODE = #{S_COMP_CODE}
			AND PROJECT_NO = #{PROJECT_NO}
	</update>
</mapper>