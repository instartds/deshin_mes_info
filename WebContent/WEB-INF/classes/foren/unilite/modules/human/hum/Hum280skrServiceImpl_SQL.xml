<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="hum280skrServiceImpl">

	<select id="hum280skrServiceImpl.selectDataList" parameterType="Map" resultType="rMap">
		<foreach collection="CAL_YEAR_LIST" item="CAL_YEAR" separator=" UNION ">
			SELECT DIV_CODE = (SELECT C.DIV_NAME 
	                             FROM BOR120T AS C 
	                            WHERE C.COMP_CODE = A.COMP_CODE
	                              AND C.DIV_CODE  = A.DIV_CODE) 
	             , HDEPT = (SELECT A.DEPT_NAME) 
	             , JYEAR = (SELECT '${CAL_YEAR.YEAR}') 
	            
				
				<!-- 01월 -->
	 			<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M' 
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                 
	                 
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'01' 
	                   AND (
	                         SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'01' 
	                         OR
	                         SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN01 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M' 
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                   
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	                    
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'01'
	                ) AS M_HOUT01 
	             <!--여성 -->   
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F' 
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                 
	                 
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'01' 
	                   AND (
	                         SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'01' 
	                         OR
	                         SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN01 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F' 
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                   
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	                    
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'01'
	                ) AS F_HOUT01 
	 
	 			<!-- 02월 -->
	 			<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'02'
	                   AND (
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'02'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN02 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'02'
	                ) AS M_HOUT02
	 			<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'02'
	                   AND (
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'02'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN02 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'02'
	                ) AS F_HOUT02  
	 		<!-- 03월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'03' 
	                   AND (
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'03'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000'
	                       ) 
	                ) AS M_HIN03 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 

	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'03'
	                ) AS M_HOUT03
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'03' 
	                   AND (
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'03'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000'
	                       ) 
	                ) AS F_HIN03 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 

	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'03'
	                ) AS F_HOUT03 
	 
	 		<!-- 04월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'04'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'04'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN04 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'04'
	                ) AS M_HOUT04 
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'04'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'04'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN04 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'04'
	                ) AS F_HOUT04 
	 
	 		<!-- 05월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'05'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'05'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000'
	                       ) 
	                ) AS M_HIN05 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                 FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
	        		   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'05'
	                ) AS M_HOUT05
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'05'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'05'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000'
	                       ) 
	                ) AS F_HIN05 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                 FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	        		   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'05'
	                ) AS F_HOUT05 
	 
	 		<!-- 06월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'06'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'06'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN06 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'06'
	                ) AS M_HOUT06 
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'06'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'06'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN06 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'06'
	                ) AS F_HOUT06 
	 
	 		<!-- 07월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'07'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'07'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN07 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                       END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'07'
	                ) AS M_HOUT07
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'07'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'07'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN07 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                       END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if> 
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'07'
	                ) AS F_HOUT07 
	 
	 		<!-- 08월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>  
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'08'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'08'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN08 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>  
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'08'
	                ) AS M_HOUT08 
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>  
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'08'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'08'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN08 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>  
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'08'
	                ) AS F_HOUT08 
	 
	 		<!-- 09월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'09'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'09'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN09 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'09'
	                ) AS M_HOUT09 
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'09'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'09'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN09 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'09'
	                ) AS F_HOUT09 
	 
	 		<!-- 10월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
	        		   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'10'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'10'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN10 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'10'
	                ) AS M_HOUT10 
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'10'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'10'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN10 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'10'
	                ) AS F_HOUT10 
	 
	 		<!-- 11월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'11'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'11'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN11 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'11'
	                ) AS M_HOUT11 
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
	        		   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	        		<if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'11'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'11'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN11 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'11'
	                ) AS F_HOUT11 
	 
	 		<!-- 12월 -->
	 		<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'12'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'12'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS M_HIN12 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'12'
	                ) AS M_HOUT12 
	 		<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,6) = '${CAL_YEAR.YEAR}'+'12'
	                   AND ( 
	                        SUBSTRING(B.RETR_DATE, 1,6) &gt;  '${CAL_YEAR.YEAR}'+'12'
	                        OR 
	                        SUBSTRING(B.RETR_DATE, 1,6) =  '000000' 
	                       ) 
	                ) AS F_HIN12 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,6) = '${CAL_YEAR.YEAR}'+'12'
	                ) AS F_HOUT12 
	                
	                

	        <!-- 합계 -->
			<!-- 남성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,4) = '${CAL_YEAR.YEAR}'
	                    AND SUBSTRING(B.RETR_DATE, 1,6) &lt;&gt; SUBSTRING(B.JOIN_DATE, 1,6)
	                ) AS M_HINTOT 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'M'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,4) = '${CAL_YEAR.YEAR}'
	                ) AS M_HOUTTOT 
			<!-- 여성 -->
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F' 
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,4) = '${CAL_YEAR.YEAR}'
	                    AND SUBSTRING(B.RETR_DATE, 1,6) &lt;&gt; SUBSTRING(B.JOIN_DATE, 1,6)
	                ) AS F_HINTOT 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE
	                   AND B.SEX_CODE = 'F'
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,4) = '${CAL_YEAR.YEAR}'
	                ) AS F_HOUTTOT 




	        
	        <!-- 합계 -->
	
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.JOIN_DATE,1,4) = '${CAL_YEAR.YEAR}'
	                    AND SUBSTRING(B.RETR_DATE, 1,6) &lt;&gt; SUBSTRING(B.JOIN_DATE, 1,6)
	                ) AS HINTOT 
	             , (SELECT CASE COUNT(B.PERSON_NUMB) 
	                            WHEN 0 THEN NULL 
	                                   ELSE COUNT(B.PERSON_NUMB) 
	                        END 
	                  FROM HUM100T AS B WITH (NOLOCK)
					  LEFT JOIN HBS400T M1 WITH(NOLOCK) ON M1.COMP_CODE  = B.COMP_CODE
					                                    AND M1.COMPANY_CODE = '1'    
	                 WHERE B.COMP_CODE = A.COMP_CODE
	                   AND B.DEPT_CODE = A.DEPT_CODE 
		               AND (M1.DAY_LABOR_RULE = '2' OR (M1.DAY_LABOR_RULE = '1' AND (B.PAY_GUBUN != '2' OR (B.PAY_GUBUN = '2' AND B.PAY_GUBUN2 = '2'))))
	                <if test="PAY_GUBUN == &quot;Y&quot;">
				 		AND B.PAY_GUBUN = '1' 
				 	</if>
	        
	                   AND SUBSTRING(B.RETR_DATE,1,4) = '${CAL_YEAR.YEAR}'
	                ) AS HOUTTOT 
	
	          FROM HUM100T AS A 
	         WHERE A.COMP_CODE = '${S_COMP_CODE}'
	           AND uniLITE.fnCheckCompDivAuth(A.COMP_CODE, A.DIV_CODE, #{S_USER_ID}) = 'Y'
	         <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">					
			   AND A.DIV_CODE IN
					<foreach collection="DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
			 </if>

	        <if test="@foren.Ognl@isNotEmpty(DEPTS)">
			   AND  A.DEPT_CODE	 IN
				 <foreach collection="DEPTS" item="item" separator="," close=")" open="(">
		          		 #{item}
		    	 </foreach>
			</if>

	        GROUP BY A.DIV_CODE,A.DEPT_CODE,A.DEPT_NAME, A.COMP_CODE 
		</foreach>
	
	</select>
</mapper>