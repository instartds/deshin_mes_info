<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="had617ukrServiceImpl">
	
	<select id="had617ukrServiceImpl.selectAuth" parameterType="LoginVO" resultType="rMap">		
	/* had617ukrServiceImpl.selectAuth */
		    DECLARE @RetireDateFr       NVARCHAR(08)                -- (필수) 퇴사기준일(Fr)
                  , @RetireDateTo       NVARCHAR(08)                -- (필수) 퇴사기준일(To)
        		  , @JoinDate           NVARCHAR(08)
        		  , @personNum			NVARCHAR(20)
        		  , @personName			NVARCHAR(100)
    			  , @auth				NUMERIC(30,0)
    			  , @useAuth				NVARCHAR(01)
    			  
            SET @RetireDateFr = #{YEAR_YYYY} + '0101'
            SET @RetireDateTo = #{YEAR_YYYY} + '1231'
            SET @JoinDate     = #{YEAR_YYYY} + '1231'
   			SET @auth = 0
   			
   			SELECT @useAuth = UPPER(ISNULL(REF_CODE1,'N')) 
		      FROM BSA100T WITH (NOLOCK)
		     WHERE COMP_CODE = #{S_COMP_CODE}
		       AND MAIN_CODE = 'H161'
		       AND SUB_CODE  = '10'
   			
   			SELECT @auth = COUNT(*)
	          FROM BSA100T WITH (NOLOCK)
	         WHERE COMP_CODE             = #{S_COMP_CODE}
	           AND MAIN_CODE             = 'H162'
	           AND ISNULL(USE_YN   ,'N') = 'Y'
	           AND ISNULL(REF_CODE1,'' ) = #{S_USER_ID}
   			IF (@useAuth = 'Y')
   			BEGIN
	            SELECT @personNum 	= MAX(A.PERSON_NUMB)
	            	 , @personName 	= (SELECT NAME FROM HUM100T WITH (NOLOCK) WHERE COMP_CODE=#{S_COMP_CODE} AND PERSON_NUMB= MAX(A.PERSON_NUMB))
	              FROM            HUM100T A WITH (NOLOCK)
	                   INNER JOIN BSA300T B WITH (NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
	                                                     AND B.PERSON_NUMB = A.PERSON_NUMB
	             WHERE A.COMP_CODE  = #{S_COMP_CODE}
	               AND A.JOIN_DATE  &lt; @JoinDate
	               AND (A.RETR_DATE = '00000000' OR (A.RETR_DATE &gt;= @RetireDateFr AND A.RETR_DATE &lt;= @RetireDateTo))
	               AND B.USER_ID    = #{S_USER_ID}
            END
            
            SELECT	 @useAuth AS USE_AUTH
            		,CASE WHEN @auth = 0 THEN 'N' ELSE 'Y' END AS AUTH_YN
            		,@personNum AS PERSON_NUMB
            		,@personName AS PERSON_NAME
	</select>
	<select id="had617ukrServiceImpl.selectFormHad600" parameterType="rMap" resultType="rMap">		
	/* had617ukrServiceImpl.selectFormHad600 */
        SELECT  'HAD600T' AS T_GBN
             , A.PERSON_NUMB
			 , ISNULL(B.JOIN_DATE             , (CASE WHEN ISNULL(A.ORI_JOIN_DATE,'00000000') = '00000000'
													  THEN A.JOIN_DATE
													  ELSE A.ORI_JOIN_DATE
												  END))                          AS JOIN_DATE                  --입사일
			 , ISNULL(B.RETR_DATE             , ISNULL(A.RETR_DATE,'00000000'))  AS RETR_DATE                  --퇴사일
			 , ISNULL(B.DEPT_CODE             , A.DEPT_CODE)                     AS DEPT_CODE                  --부서코드
			 , ISNULL(B.DEPT_NAME             , A.DEPT_NAME)                     AS DEPT_NAME                  --부서명
			 , ISNULL(B.YEAR_YYYY             , #{YEAR_YYYY})                    AS YEAR_YYYY                  --정산년도
			 , ISNULL(B.HALFWAY_TYPE          , 'N')                             AS HALFWAY_TYPE               --중도퇴사자정산여부
			 , ISNULL(B.FORE_SINGLE_YN        , 'N')                             AS FORE_SINGLE_YN             --외국인단일세율적용여부
			 , ISNULL(B.FOREIGN_DISPATCH_YN   , 'N')                             AS FOREIGN_DISPATCH_YN        --외국법인소속 파견근로자 여부
			 , ISNULL(B.HOUSEHOLDER_YN        , '2')                             AS HOUSEHOLDER_YN             --세대주여부
	    
			 , ISNULL(B.INCOME_SUPP_TOTAL_I   , 0)                               AS INCOME_SUPP_TOTAL_I        --총급여액
	    
			 , ISNULL(B.PAY_TOTAL_I           , 0)                               AS PAY_TOTAL_I                --급여총액(숨김)
			 , ISNULL(B.BONUS_TOTAL_I         , 0)                               AS BONUS_TOTAL_I              --상여총액(숨김)
			 , ISNULL(B.ADD_BONUS_I           , 0)                               AS ADD_BONUS_I                --인정상여금액(숨김)
			 , ISNULL(B.STOCK_PROFIT_I        , 0)                               AS STOCK_PROFIT_I             --주식매수선택행사이익(숨김)
			 , ISNULL(B.OWNER_STOCK_DRAW_I    , 0)                               AS OWNER_STOCK_DRAW_I         --우리사주조합인출금(숨김)
			 , ISNULL(B.OF_RETR_OVER_I        , 0)                               AS OF_RETR_OVER_I             --임원퇴직한도초과액(숨김)
	    
			 , ISNULL(B.NOW_PAY_TOT_I         , 0)                               AS NOW_PAY_TOT_I              --주(현)급여총액(숨김)
			 , ISNULL(B.NOW_BONUS_TOTAL_I     , 0)                               AS NOW_BONUS_TOTAL_I          --주(현)상여총액(숨김)
			 , ISNULL(B.NOW_ADD_BONUS_I       , 0)                               AS NOW_ADD_BONUS_I            --주(현)인정상여금액(숨김)
			 , ISNULL(B.NOW_STOCK_PROFIT_I    , 0)                               AS NOW_STOCK_PROFIT_I         --주(현)주식매수선택행사이익(숨김)
			 , ISNULL(B.NOW_OWNER_STOCK_DRAW_I, 0)                               AS NOW_OWNER_STOCK_DRAW_I     --주(현)우리사주조합인출금(숨김)
			 , ISNULL(B.NOW_OF_RETR_OVER_I    , 0)                               AS NOW_OF_RETR_OVER_I         --주(현)임원퇴직한도초과액(숨김)
			 , ISNULL(B.OLD_PAY_TOT_I         , 0)                               AS OLD_PAY_TOT_I              --종(전)급여총액(숨김)
			 , ISNULL(B.OLD_BONUS_TOTAL_I     , 0)                               AS OLD_BONUS_TOTAL_I          --종(전)상여총액(숨김)
			 , ISNULL(B.OLD_ADD_BONUS_I       , 0)                               AS OLD_ADD_BONUS_I            --종(전)인정상여금액(숨김)
			 , ISNULL(B.OLD_STOCK_PROFIT_I    , 0)                               AS OLD_STOCK_PROFIT_I         --종(전)주식매수선택행사이익(숨김)
			 , ISNULL(B.OLD_OWNER_STOCK_DRAW_I, 0)                               AS OLD_OWNER_STOCK_DRAW_I     --종(전)우리사주조합인출금(숨김)
			 , ISNULL(B.OLD_OF_RETR_OVER_I    , 0)                               AS OLD_OF_RETR_OVER_I         --종(전)임원퇴직한도초과액(숨김)
			 , ISNULL(B.NAP_PAY_TOT_I         , 0)                               AS NAP_PAY_TOT_I              --(납)급여총액
			 , ISNULL(B.NAP_BONUS_TOTAL_I     , 0)                               AS NAP_BONUS_TOTAL_I          --(납)상여총액
	    
			 , ISNULL(B.INCOME_DED_I          , 0)                               AS INCOME_DED_I               --근로소득공제
			 , ISNULL(B.EARN_INCOME_I         , 0)                               AS EARN_INCOME_I              --근로소득금액
	    
			 , ISNULL(B.PER_DED_I             , 0)                               AS PER_DED_I                  --본인공제
			 , ISNULL(B.SPOUSE                ,'N')                              AS SPOUSE                     --배우자유무
			 , ISNULL(B.SPOUSE_DED_I          , 0)                               AS SPOUSE_DED_I               --배우자공제
			 , ISNULL(B.SUPP_NUM              , 0)                               AS SUPP_NUM                   --부양자
			 , ISNULL(B.SUPP_SUB_I            , 0)                               AS SUPP_SUB_I                 --부양자공제
			 , ISNULL(B.AGED_NUM              , 0)                               AS AGED_NUM                   --경로자
			 , ISNULL(B.DEFORM_NUM            , 0)                               AS DEFORM_NUM                 --장애자
			 , ISNULL(B.MANY_CHILD_NUM        , 0)                               AS MANY_CHILD_NUM             --자녀
			 , ISNULL(B.BRING_CHILD_NUM       , 0)                               AS BRING_CHILD_NUM            --자녀양육
			 , ISNULL(B.BIRTH_ADOPT_NUM       , 0)                               AS BIRTH_ADOPT_NUM            --출산입양
			 , ISNULL(B.WOMAN                 ,'N')                              AS WOMAN                      --부녀자유무
			 , ISNULL(B.ONE_PARENT            ,'N')                              AS ONE_PARENT                 --부녀자유무
			 , ISNULL(B.BIRTH_ADOPT_NUM1      , 0)                               AS BIRTH_ADOPT_NUM1           --출산입양첫째
			 , ISNULL(B.BIRTH_ADOPT_NUM2      , 0)                               AS BIRTH_ADOPT_NUM2           --출산입양둘째
			 , ISNULL(B.BIRTH_ADOPT_NUM3      , 0)                               AS BIRTH_ADOPT_NUM3           --출산입양셋째이상
	    	 , ISNULL(B.AGED_DED_I            , 0)                               AS AGED_DED_I                 --경로공제
			 , ISNULL(B.DEFORM_DED_I          , 0)                               AS DEFORM_DED_I               --장애인공제
			 , ISNULL(B.WOMAN_DED_I           , 0)                               AS WOMAN_DED_I                --부녀자공제
			 , ISNULL(B.ONE_PARENT_DED_I      , 0)                               AS ONE_PARENT_DED_I           --한부모공제
			 
			 , ISNULL(B.ANU_I                 , 0)                               AS ANU_I                      --국민연금
			 , ISNULL(B.ANU_ADD_I             , 0)                               AS ANU_ADD_I                  --국민연금(개별입력)
			 , ISNULL(B.ANU_DED_I             , 0)                               AS ANU_DED_I                  --국민연금공제금액
			 , ISNULL(B.PUBLIC_PENS_I         , 0)                               AS PUBLIC_PENS_I              --공무원연금
			 , ISNULL(B.SOLDIER_PENS_I        , 0)                               AS SOLDIER_PENS_I             --군인연금
			 , ISNULL(B.SCH_PENS_I            , 0)                               AS SCH_PENS_I                 --사립학교교직원연금
			 , ISNULL(B.POST_PENS_I           , 0)                               AS POST_PENS_I                --별정우체국연금
	    
			 , ISNULL(B.MED_PREMINM_I         , 0)                               AS MED_PREMINM_I              --건강보험료
			 , ISNULL(B.HIRE_INSUR_I          , 0)                               AS HIRE_INSUR_I               --고용보험료
	    
			 , ISNULL(B.HOUS_AMOUNT_I         , 0)                               AS HOUS_AMOUNT_I              --주택자금불입액(대출기관)
			 , ISNULL(B.HOUS_AMOUNT_I_2       , 0)                               AS HOUS_AMOUNT_I_2            --주택자금불입액(거주자)
			 , ISNULL(B.MORTGAGE_RETURN_I_2   , 0)                               AS MORTGAGE_RETURN_I_2        --장기주택저당차입금이자상환액(15년미만)
			 , ISNULL(B.MORTGAGE_RETURN_I     , 0)                               AS MORTGAGE_RETURN_I          --장기주택저당차입금이자상환액(15년~29년)
			 , ISNULL(B.MORTGAGE_RETURN_I_3   , 0)                               AS MORTGAGE_RETURN_I_3        --장기주택저당차입금이자상환액(30년이상)
			 , ISNULL(B.MORTGAGE_RETURN_I_5   , 0)                               AS MORTGAGE_RETURN_I_5        --고정금리비거치상환대출(1500만원한도)
			 , ISNULL(B.MORTGAGE_RETURN_I_4   , 0)                               AS MORTGAGE_RETURN_I_4        --기타대출(500만원한도)
			 , ISNULL(B.MORTGAGE_RETURN_I_6   , 0)                               AS MORTGAGE_RETURN_I_6        --15년이상(고정금리이면서 비거치상환)
			 , ISNULL(B.MORTGAGE_RETURN_I_7   , 0)                               AS MORTGAGE_RETURN_I_7        --15년이상(고정금리이거나 비거치상환)
			 , ISNULL(B.MORTGAGE_RETURN_I_8   , 0)                               AS MORTGAGE_RETURN_I_8        --15년이상(그밖의대출)
			 , ISNULL(B.MORTGAGE_RETURN_I_9   , 0)                               AS MORTGAGE_RETURN_I_9        --10년이상(고정금리이거나 비거치상환)
	    
			 , ISNULL(B.PRIV_PENS_I           , 0)                               AS PRIV_PENS_I                --개인연금저축소득공제
	    
			 , ISNULL(B.HOUS_BU_AMT           , 0)                               AS HOUS_BU_AMT                --청약저축(240만원한도)
			 , ISNULL(B.HOUS_BU_ADD_AMT       , 0)                               AS HOUS_BU_ADD_AMT            --청약저축(120만원한도)
			 , ISNULL(B.HOUS_WORK_AMT         , 0)                               AS HOUS_WORK_AMT              --근로자주택마련저축
			 , ISNULL(B.HOUS_BU_AMOUNT_I      , 0)                               AS HOUS_BU_AMOUNT_I           --주택청약종합저축(240만원한도)
			 , ISNULL(B.HOUS_BU_AMOUNT_ADD_I  , 0)                               AS HOUS_BU_AMOUNT_ADD_I       --주택청약종합저축(120만원한도)
	    
			 , ISNULL(B.CARD_DED_I            , 0)                               AS CARD_DED_I                 --신용카드공제
			 , ISNULL(B.CARD_USE_I            , 0)                               AS CARD_USE_I                 --신용카드사용액
			 , ISNULL(B.CASH_USE_I            , 0)                               AS CASH_USE_I                 --현금영수증사용액
			 , ISNULL(B.DEBIT_CARD_USE_I      , 0)                               AS DEBIT_CARD_USE_I           --직불카드사용액
			 , ISNULL(B.TRA_MARKET_USE_I      , 0)                               AS TRA_MARKET_USE_I           --전통시장사용액
			 , ISNULL(B.TRAFFIC_USE_I         , 0)                               AS TRAFFIC_USE_I              --대중교통이용액
	
			
	    
			 , ISNULL(B.COMP_PREMINUM         , '0')                             AS COMP_PREMINUM              --소기업,소상공인공제부금소득공제 2016년 가입한 대표자 여부
			 , ISNULL(B.COMP_PREMINUM_DED_I   , 0)                               AS COMP_PREMINUM_DED_I        --소기업,소상공인공제부금소득공제
			 , ISNULL(B.INVESTMENT_DED_I      , 0)                               AS INVESTMENT_DED_I           --투자조합출자공제
			 , ISNULL(B.INVESTMENT_DED_I2     , 0)                               AS INVESTMENT_DED_I2          --투자조합출자공제(2013년도분)
			 , ISNULL(B.INVESTMENT_DED_I3     , 0)                               AS INVESTMENT_DED_I3          --투자조합출자공제(2014년도분)
			 , ISNULL(B.INVESTMENT_DED_I4     , 0)                               AS INVESTMENT_DED_I4          --투자조합출자공제(2015년이후분)
			 , ISNULL(B.STAFF_STOCK_DED_I     , 0)                               AS STAFF_STOCK_DED_I          --우리사주조합출연금액
			 , ISNULL(B.EMPLOY_WORKER_DED_I   , 0)                               AS EMPLOY_WORKER_DED_I        --고용유지중소기업근로자소득공제
			 , ISNULL(B.NOT_AMOUNT_LOAN_DED_I , 0)                               AS NOT_AMOUNT_LOAN_DED_I      --목돈안드는전세이자상환액
			 , ISNULL(B.LONG_INVEST_STOCK_DED_I,0)                               AS LONG_INVEST_STOCK_DED_I    --장기집합투자증권저축
	    
			 , ISNULL(B.INCOME_REDU_I         , 0)                               AS INCOME_REDU_I              --소득세법
			 , ISNULL(B.YOUTH_DED_I           , 0)                               AS YOUTH_DED_I                --중소기업청년소득세감면금액(100%)
			 , ISNULL(B.YOUTH_DED_I3          , 0)                               AS YOUTH_DED_I3               --중소기업청년소득세감면금액(70%)
			 , ISNULL(B.YOUTH_DED_I2          , 0)                               AS YOUTH_DED_I2               --중소기업청년소득세감면금액(50%)
			 , ISNULL(B.YOUTH_DED_I_SUM       , 0)                               AS YOUTH_DED_I_SUM            --중소기업청년 감면기간내 총소득금액(감면소득)
			 , ISNULL(B.SKILL_DED_I           , 0)                               AS SKILL_DED_I                --외국인기술공제
			 , ISNULL(B.TAXES_REDU_I          , 0)                               AS TAXES_REDU_I               --조감법
	    
			 , ISNULL(B.IN_TAX_DED_I          , 0)                               AS IN_TAX_DED_I               --근로소득세액공제
			 , ISNULL(B.CHILD_TAX_DED_I       , 0)                               AS CHILD_TAX_DED_I            --자녀세액공제
			 , ISNULL(B.BRING_CHILD_DED_I     , 0)                               AS BRING_CHILD_DED_I          --자녀양육비공제
			 , ISNULL(B.BIRTH_ADOPT_I         , 0)                               AS BIRTH_ADOPT_I              --출산입양공제
	    
			 , ISNULL(B.SCI_DEDUC_I           , 0)                               AS SCI_DEDUC_I                --(공제대상)과학기술인공제
			 , ISNULL(B.RETIRE_PENS_I         , 0)                               AS RETIRE_PENS_I              --(공제대상)근로자퇴직급여보장법
			 , ISNULL(B.PENS_I                , 0)                               AS PENS_I                     --(공제대상)연금저축소득공제
	    
			 , ISNULL(B.SCI_TAX_DED_I         , 0)                               AS SCI_TAX_DED_I              --과학기술인공제      (급여5,500만원이상 12% 적용)
			 , ISNULL(B.SCI_TAX_DED_I1        , 0)                               AS SCI_TAX_DED_I1             --과학기술인공제      (급여5,500만원이하 15% 적용)
	    
			 , ISNULL(B.RETIRE_TAX_DED_I      , 0)                               AS RETIRE_TAX_DED_I           --근로자퇴직급여보장법(급여5,500만원이상 12% 적용)
			 , ISNULL(B.RETIRE_TAX_DED_I1     , 0)                               AS RETIRE_TAX_DED_I1          --근로자퇴직급여보장법(급여5,500만원이하 15% 적용)
	    
			 , ISNULL(B.PENS_TAX_DED_I        , 0)                               AS PENS_TAX_DED_I             --연금저축소득공제    (급여5,500만원이상 12% 적용)
			 , ISNULL(B.PENS_TAX_DED_I1       , 0)                               AS PENS_TAX_DED_I1            --연금저축소득공제    (급여5,500만원이하 15% 적용)
	    
			 , ISNULL(B.ETC_INSUR_I           , 0)                               AS ETC_INSUR_I                --(공제대상)보장성보험
			 , ISNULL(B.DEFORM_INSUR_I        , 0)                               AS DEFORM_INSUR_I             --(공제대상)장애인전용보장성보험
			 , ISNULL(B.ETC_INSUR_TAX_DED_I   , 0)                               AS ETC_INSUR_TAX_DED_I        --보장성보험
			 , ISNULL(B.DEFORM_INSUR_TAX_DED_I, 0)                               AS DEFORM_INSUR_TAX_DED_I     --장애인전용보장성보험
	    
			 , ISNULL(B.MED_DED_I             , 0)                               AS MED_DED_I                  --(공제대상)의료비공제금액
			 , ISNULL(B.MY_MED_DED_I          , 0)                               AS MY_MED_DED_I               --(공제대상)본인의료비
			 , ISNULL(B.SENIOR_MED_I          , 0)                               AS SENIOR_MED_I               --(공제대상)경로의료비
			 , ISNULL(B.DEFORM_MED_I          , 0)                               AS DEFORM_MED_I               --(공제대상)장애의료비
			 , ISNULL(B.SURGERY_MED_I         , 0)                               AS SURGERY_MED_I              --(공제대상)난임시술비
			 , ISNULL(B.MED_TOTAL_I           , 0)                               AS MED_TOTAL_I                --(공제대상)그밖의 공제대상자 의료비
			 , ISNULL(B.MED_TAX_DED_I         , 0)                               AS MED_TAX_DED_I              --의료비공제금액
			 , ISNULL(B.MY_MED_TAX_DED_I      , 0)                               AS MY_MED_TAX_DED_I           --본인의료비
			 , ISNULL(B.SENIOR_MED_TAX_DED_I  , 0)                               AS SENIOR_MED_TAX_DED_I       --경로의료비
			 , ISNULL(B.DEFORM_MED_TAX_DED_I  , 0)                               AS DEFORM_MED_TAX_DED_I       --장애의료비
			 , ISNULL(B.SURGERY_MED_TAX_DED_I , 0)                               AS SURGERY_MED_TAX_DED_I      --난임시술비
			 , ISNULL(B.MED_TOTAL_TAX_DED_I   , 0)                               AS MED_TOTAL_TAX_DED_I        --그밖의 공제대상자 의료비
	    
			 , ISNULL(B.EDUC_DED_I            , 0)                               AS EDUC_DED_I                 --(공제대상)교육비공제
			 , ISNULL(B.UNIV_EDUC_NUM         , 0)                               AS UNIV_EDUC_NUM              --대학교자녀수
			 , ISNULL(B.STUD_EDUC_NUM         , 0)                               AS STUD_EDUC_NUM              --초중고자녀수
			 , ISNULL(B.KIND_EDU_NUM          , 0)                               AS KIND_EDU_NUM               --유치원자녀수
			 , ISNULL(B.PER_EDUC_DED_I        , 0)                               AS PER_EDUC_DED_I             --(공제대상)본인교육비공제
			 , ISNULL(B.UNIV_EDUC_DED_I       , 0)                               AS UNIV_EDUC_DED_I            --(공제대상)대학교교육비공제
			 , ISNULL(B.STUD_EDUC_DED_I       , 0)                               AS STUD_EDUC_DED_I            --(공제대상)초중고교육비공제
			 , ISNULL(B.KIND_EDUC_DED_I       , 0)                               AS KIND_EDUC_DED_I            --(공제대상)유치원교육비공제
			 , ISNULL(B.DEFORM_EDUC_DED_I     , 0)                               AS DEFORM_EDUC_DED_I          --(공제대상)장애인특수교육비공제
			 , ISNULL(B.FIELD_EDUC_DED_I      , 0)                               AS FIELD_EDUC_DED_I           --(공제대상)체험학습비공제
			 , ISNULL(B.EDUC_TAX_DED_I        , 0)                               AS EDUC_TAX_DED_I             --교육비공제
			 , ISNULL(B.PER_EDUC_TAX_DED_I    , 0)                               AS PER_EDUC_TAX_DED_I         --본인교육비공제
			 , ISNULL(B.UNIV_EDUC_TAX_DED_I   , 0)                               AS UNIV_EDUC_TAX_DED_I        --대학교교육비공제
			 , ISNULL(B.STUD_EDUC_TAX_DED_I   , 0)                               AS STUD_EDUC_TAX_DED_I        --초중고교육비공제
			 , ISNULL(B.KIND_EDUC_TAX_DED_I   , 0)                               AS KIND_EDUC_TAX_DED_I        --유치원교육비공제
			 , ISNULL(B.DEFORM_EDUC_TAX_DED_I , 0)                               AS DEFORM_EDUC_TAX_DED_I      --장애인특수교육비공제
			 , ISNULL(B.FIELD_EDUC_TAX_DED_I  , 0)                               AS FIELD_EDUC_TAX_DED_I       --체험학습비공제
	    
			 , ISNULL(B.POLICY_INDED          , 0)                               AS POLICY_INDED               --(입력금액)정치자금기부금(10만원미만)
			 , ISNULL(B.POLICY_GIFT_I         , 0)                               AS POLICY_GIFT_I              --(입력금액)정치자금기부금(10만원초과)
			 , ISNULL(B.LEGAL_GIFT_I_PREV     , 0)                               AS LEGAL_GIFT_I_PREV          --(입력금액)법정기부금이월-2013
			 , ISNULL(B.LEGAL_GIFT_I_PREV_14  , 0)                               AS LEGAL_GIFT_I_PREV_14       --(입력금액)법정기부금이월-2014
			 , ISNULL(B.LEGAL_GIFT_I          , 0)                               AS LEGAL_GIFT_I               --(입력금액)법정기부금
			 , ISNULL(B.PRIV_GIFT_I_PREV      , 0)                               AS PRIV_GIFT_I_PREV           --(입력금액)특례기부금이월액
			 , ISNULL(B.PRIV_GIFT_I           , 0)                               AS PRIV_GIFT_I                --(입력금액)특례기부금
			 , ISNULL(B.PUBLIC_GIFT_I_PREV    , 0)                               AS PUBLIC_GIFT_I_PREV         --(입력금액)공익법인신탁기부금이월액
			 , ISNULL(B.PUBLIC_GIFT_I         , 0)                               AS PUBLIC_GIFT_I              --(입력금액)공익법인신탁기부금
			 , ISNULL(B.STAFF_GIFT_I          , 0)                               AS STAFF_GIFT_I               --(입력금액)우리사주기부금
			 , ISNULL(B.APPOINT_GIFT_I_PREV   , 0)                               AS APPOINT_GIFT_I_PREV        --(입력금액)지정기부금이월액-2013
			 , ISNULL(B.APPOINT_GIFT_I_PREV_14, 0)                               AS APPOINT_GIFT_I_PREV_14     --(입력금액)지정기부금이월액-2014
			 , ISNULL(B.APPOINT_GIFT_I        , 0)                               AS APPOINT_GIFT_I             --(입력금액)지정기부금
			 , ISNULL(B.ASS_GIFT_I_PREV       , 0)                               AS ASS_GIFT_I_PREV            --(입력금액)종교단체기부금이월액-2013
			 , ISNULL(B.ASS_GIFT_I_PREV_14    , 0)                               AS ASS_GIFT_I_PREV_14         --(입력금액)종교단체기부금이월액-2014
			 , ISNULL(B.ASS_GIFT_I            , 0)                               AS ASS_GIFT_I                 --(입력금액)종교단체기부금
	    
			 , ISNULL(B.POLICY_INDED_DED_AMT  , 0)                               AS POLICY_INDED_DED_AMT       --(공제대상)정치자금기부금(10만원미만)
			 , ISNULL(B.POLICY_GIFT_DED_AMT   , 0)                               AS POLICY_GIFT_DED_AMT        --(공제대상)정치자금기부금(10만원초과)
			 , ISNULL(B.LEGAL_DED_AMT         , 0)                               AS LEGAL_DED_AMT              --(공제대상)법정기부금
			 , ISNULL(B.STAFF_DED_AMT         , 0)                               AS STAFF_DED_AMT              --(공제대상)우리사주기부금
			 , ISNULL(B.APPOINT_ASS_TAX_DED_AMT,0)                               AS APPOINT_ASS_TAX_DED_AMT    --(공제대상)지정기부금
	    
			 , ISNULL(B.GIFT_DED_I            , 0)                               AS GIFT_DED_I                 --(소득공제)기부금소득공제합계
			 , ISNULL(B.LEGAL_GIFT_DED_I      , 0)                               AS LEGAL_GIFT_DED_I           --(소득공제)법정기부금
			 , ISNULL(B.PRIV_GIFT_DED_I       , 0)                               AS PRIV_GIFT_DED_I            --(소득공제)특례기부금
			 , ISNULL(B.PUBLIC_GIFT_DED_I     , 0)                               AS PUBLIC_GIFT_DED_I          --(소득공제)공익법인신탁기부금
			 , ISNULL(B.STAFF_GIFT_DED_I      , 0)                               AS STAFF_GIFT_DED_I           --(소득공제)우리사주기부금
			 , ISNULL(B.APPOINT_GIFT_DED_I    , 0)                               AS APPOINT_GIFT_DED_I         --(소득공제)지정기부금
			 , ISNULL(B.ASS_GIFT_DED_I        , 0)                               AS ASS_GIFT_DED_I             --(소득공제)종교단체기부금
	    
			 , ISNULL(B.GIFT_TAX_DED_I        , 0)                               AS GIFT_TAX_DED_I             --(세액공제)기부금세액공제합계
			 , ISNULL(B.POLICY_INDED_TAX_DED_I, 0)                               AS POLICY_INDED_TAX_DED_I     --(세액공제)정치자금기부금(10만원미만)
			 , ISNULL(B.POLICY_GIFT_TAX_DED_I , 0)                               AS POLICY_GIFT_TAX_DED_I      --(세액공제)정치자금기부금(10만원초과)
			 , ISNULL(B.LEGAL_GIFT_TAX_DED_I  , 0)                               AS LEGAL_GIFT_TAX_DED_I       --(세액공제)법정기부금
			 , ISNULL(B.STAFF_GIFT_TAX_DED_I  , 0)                               AS STAFF_GIFT_TAX_DED_I       --(세액공제)우리사주기부금
			 , ISNULL(B.APPOINT_GIFT_TAX_DED_I, 0)                               AS APPOINT_GIFT_TAX_DED_I     --(세액공제)지정기부금
			 , ISNULL(B.ASS_GIFT_TAX_DED_I    , 0)                               AS ASS_GIFT_TAX_DED_I         --(세액공제)종교단체기부금
	    
			 , ISNULL(B.NAP_TAX_DED_I         , 0)                               AS NAP_TAX_DED_I              --납세조합세액공제
			 , ISNULL(B.HOUS_INTER_I          , 0)                               AS HOUS_INTER_I               --주택자금상환액
			 , ISNULL(B.OUTSIDE_INCOME_I      , 0)                               AS OUTSIDE_INCOME_I           --외국납부세액
			 , ISNULL(B.MON_RENT_I            , 0)                               AS MON_RENT_I                 --월세액
	    
			 , ISNULL(B.PER_DED_I             , 0)
			 + ISNULL(B.SPOUSE_DED_I          , 0)
			 + ISNULL(B.SUPP_SUB_I            , 0)                               AS TAB1_DED_AMT               --(세액산출요약)기본공제
	    
			 , ISNULL(B.AGED_DED_I            , 0)
			 + ISNULL(B.DEFORM_DED_I          , 0)
			 + ISNULL(B.WOMAN_DED_I           , 0)
			 + ISNULL(B.ONE_PARENT_DED_I      , 0)                               AS TAB2_DED_AMT               --(세액산출요약)추가공제
	    
			 , ISNULL(B.ANU_DED_I             , 0)
			 + ISNULL(B.PUBLIC_PENS_I         , 0)
			 + ISNULL(B.SOLDIER_PENS_I        , 0)
			 + ISNULL(B.SCH_PENS_I            , 0)
			 + ISNULL(B.POST_PENS_I           , 0)                               AS TAB3_DED_AMT               --(세액산출요약)연금보험료공제
	    
			 , ISNULL(B.MED_PREMINM_I         , 0)
			 + ISNULL(B.HIRE_INSUR_I          , 0)                               AS TAB4_DED_AMT               --(세액산출요약)특별소득공제-보험료
	    
			 , ISNULL(B.HOUS_AMOUNT_I         , 0)
			 + ISNULL(B.HOUS_AMOUNT_I_2       , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I_2   , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I     , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I_3   , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I_5   , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I_4   , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I_6   , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I_7   , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I_8   , 0)
			 + ISNULL(B.MORTGAGE_RETURN_I_9   , 0)                               AS TAB5_DED_AMT               --(세액산출요약)특별소득공제-주택자금
	    
			 , ISNULL(B.DED_INCOME_I          , 0)                               AS DED_INCOME_I               --차감근로소득
			 , ISNULL(B.DED_INCOME_I1         , 0)                               AS DED_INCOME_I1              --차감근로소득(표준세액공제계산용):특별소득공제포함
			 , ISNULL(B.DED_INCOME_I2         , 0)                               AS DED_INCOME_I2              --차감근로소득(표준세액공제계산용):특별소득공제제외
	    
			 , ISNULL(B.PRIV_PENS_I           , 0)                               AS TAB6_DED_AMT               --(세액산출요약)그밖소득공제-연금저축
	    
			 , ISNULL(B.HOUS_BU_AMT           , 0)
			 + ISNULL(B.HOUS_BU_ADD_AMT       , 0)
			 + ISNULL(B.HOUS_WORK_AMT         , 0)
			 + ISNULL(B.HOUS_BU_AMOUNT_I      , 0)
			 + ISNULL(B.HOUS_BU_AMOUNT_ADD_I  , 0)                               AS TAB7_DED_AMT               --(세액산출요약)그밖소득공제-주택마련
	    
			 , ISNULL(B.CARD_DED_I            , 0)                               AS TAB8_DED_AMT               --(세액산출요약)그밖소득공제-신용카드
	    
			 , ISNULL(B.COMP_PREMINUM_DED_I   , 0)
			 + ISNULL(B.INVESTMENT_DED_I      , 0)
			 + ISNULL(B.STAFF_STOCK_DED_I     , 0)
			 + ISNULL(B.EMPLOY_WORKER_DED_I   , 0)
			 + ISNULL(B.NOT_AMOUNT_LOAN_DED_I , 0)
			 + ISNULL(B.LONG_INVEST_STOCK_DED_I,0)                               AS TAB9_DED_AMT               --(세액산출요약)그밖소득공제-기타
	    
			 , ISNULL(B.OVER_INCOME_DED_LMT   , 0)                               AS OVER_INCOME_DED_LMT        --특별공제 종합한도 초과액
	    
			 , ISNULL(B.TAX_STD_I             , 0)                               AS TAX_STD_I                  --소득과세표준
			 , ISNULL(B.TAX_STD_I1            , 0)                               AS TAX_STD_I1                 --소득과세표준(표준세액공제계산용):특별소득공제포함
			 , ISNULL(B.TAX_STD_I2            , 0)                               AS TAX_STD_I2                 --소득과세표준(표준세액공제계산용):특별소득공제제외
			 , ISNULL(B.COMP_TAX_I            , 0)                               AS COMP_TAX_I                 --산출세액
			 , ISNULL(B.COMP_TAX_I1           , 0)                               AS COMP_TAX_I1                --산출세액(표준세액공제계산용):특별소득공제포함
			 , ISNULL(B.COMP_TAX_I2           , 0)                               AS COMP_TAX_I2                --산출세액(표준세액공제계산용):특별소득공제제외
	    
			 , ISNULL(B.INCOME_REDU_I         , 0)
			 + ISNULL(B.YOUTH_DED_I           , 0)
			 + ISNULL(B.YOUTH_DED_I3          , 0)
			 + ISNULL(B.YOUTH_DED_I2          , 0)
			 + ISNULL(B.SKILL_DED_I           , 0)
			 + ISNULL(B.TAXES_REDU_I          , 0)                               AS TAB10_DED_AMT              --(세액산출요약)세액감면
	    
			 , ISNULL(B.IN_TAX_DED_I          , 0)
			 + ISNULL(B.CHILD_TAX_DED_I       , 0)
			 + ISNULL(B.BRING_CHILD_DED_I     , 0)
			 + ISNULL(B.BIRTH_ADOPT_I         , 0)                               AS TAB11_DED_AMT              --(세액산출요약)세액공제-근로소득/자녀
	    
			 , ISNULL(B.SCI_TAX_DED_I         , 0)
			 + ISNULL(B.RETIRE_TAX_DED_I      , 0)
			 + ISNULL(B.PENS_TAX_DED_I        , 0)
			 + ISNULL(B.SCI_TAX_DED_I1        , 0)
			 + ISNULL(B.RETIRE_TAX_DED_I1     , 0)
			 + ISNULL(B.PENS_TAX_DED_I1       , 0)                               AS TAB12_DED_AMT              --(세액산출요약)세액공제-연금계좌
	    
			 , ISNULL(B.ETC_INSUR_TAX_DED_I   , 0)
			 + ISNULL(B.DEFORM_INSUR_TAX_DED_I, 0)                               AS TAB13_DED_AMT              --(세액산출요약)특별세액공제-보험료
	    
	    
			 , ISNULL(B.MED_TAX_DED_I         , 0)                               AS TAB14_DED_AMT              --(세액산출요약)특별세액공제-의료비
			 , ISNULL(B.EDUC_TAX_DED_I        , 0)                               AS TAB15_DED_AMT              --(세액산출요약)특별세액공제-교육비
			 , ISNULL(B.GIFT_TAX_DED_I        , 0)                               AS TAB16_DED_AMT              --(세액산출요약)특별세액공제-기부금
	    
			 , ISNULL(B.STD_TAX_DED_I         , 0)                               AS STD_TAX_DED_I              --표준세액공제
	    
			 , ISNULL(B.NAP_TAX_DED_I         , 0)
			 + ISNULL(B.HOUS_INTER_I          , 0)
			 + ISNULL(B.OUTSIDE_INCOME_I      , 0)
			 + ISNULL(B.MON_RENT_I            , 0)                               AS TAB17_DED_AMT              --(세액산출요약)세액공제-기타
	    
			 , ISNULL(B.DEF_IN_TAX_I          , 0)                               AS DEF_IN_TAX_I               --결정소득세
			 , ISNULL(B.DEF_LOCAL_TAX_I       , 0)                               AS DEF_LOCAL_TAX_I            --결정주민세
			 , ISNULL(B.DEF_SP_TAX_I          , 0)                               AS DEF_SP_TAX_I               --결정농특세
	    
			 , ISNULL(B.DEF_IN_TAX_I          , 0)
			 + ISNULL(B.DEF_LOCAL_TAX_I       , 0)
			 + ISNULL(B.DEF_SP_TAX_I          , 0)                               AS DEF_TAX_SUM                --(세액산출요약)결정세액합계
	
			 , ISNULL(B.NOW_IN_TAX_I          , 0)                               AS NOW_IN_TAX_I               --주(현)소득세
			 , ISNULL(B.NOW_LOCAL_TAX_I       , 0)                               AS NOW_LOCAL_TAX_I            --주(현)주민세
			 , ISNULL(B.NOW_SP_TAX_I          , 0)                               AS NOW_SP_TAX_I               --주(현)농특세
	
			 , ISNULL(B.NOW_IN_TAX_I          , 0)
			 + ISNULL(B.NOW_LOCAL_TAX_I       , 0)
			 + ISNULL(B.NOW_SP_TAX_I          , 0)                               AS NOW_TAX_SUM                --(세액산출요약)현근무지기납부세액
	
			 , ISNULL(B.PRE_IN_TAX_I          , 0)                               AS PRE_IN_TAX_I               --종(전)소득세
			 , ISNULL(B.PRE_LOCAL_TAX_I       , 0)                               AS PRE_LOCAL_TAX_I            --종(전)주민세
			 , ISNULL(B.PRE_SP_TAX_I          , 0)                               AS PRE_SP_TAX_I               --종(전)농특세
	    
			 , ISNULL(B.PRE_IN_TAX_I          , 0)
			 + ISNULL(B.PRE_LOCAL_TAX_I       , 0)
			 + ISNULL(B.PRE_SP_TAX_I          , 0)                               AS PRE_TAX_SUM                --(세액산출요약)종전근무지결정세액
	
			 , ISNULL(B.NAP_IN_TAX_I          , 0)                               AS NAP_IN_TAX_I               --(납)소득세
			 , ISNULL(B.NAP_LOCAL_TAX_I       , 0)                               AS NAP_LOCAL_TAX_I            --(납)주민세
			 , ISNULL(B.NAP_SP_TAX_I          , 0)                               AS NAP_SP_TAX_I               --(납)농특세
	
			 , ISNULL(B.NAP_IN_TAX_I          , 0)
			 + ISNULL(B.NAP_LOCAL_TAX_I       , 0)
			 + ISNULL(B.NAP_SP_TAX_I          , 0)                               AS NAP_TAX_SUM                --(세액산출요약)납세조합기납부세액
	
			 , ISNULL(B.NOW_IN_TAX_I          , 0)
			 + ISNULL(B.PRE_IN_TAX_I          , 0)
			 + ISNULL(B.NAP_IN_TAX_I          , 0)                               AS PAID_IN_TAX_SUM            --(조회용)기납부소득세합계
	
			 , ISNULL(B.NOW_LOCAL_TAX_I       , 0)
			 + ISNULL(B.PRE_LOCAL_TAX_I       , 0)
			 + ISNULL(B.NAP_LOCAL_TAX_I       , 0)                               AS PAID_LOCAL_TAX_SUM         --(조회용)기납부주민세합계
	
			 , ISNULL(B.NOW_SP_TAX_I          , 0)
			 + ISNULL(B.PRE_SP_TAX_I          , 0)
			 + ISNULL(B.NAP_SP_TAX_I          , 0)                               AS PAID_SP_TAX_SUM            --(조회용)기납부농특세합계
	
			 , ISNULL(B.NOW_IN_TAX_I          , 0)
			 + ISNULL(B.NOW_LOCAL_TAX_I       , 0)
			 + ISNULL(B.NOW_SP_TAX_I          , 0)
			 + ISNULL(B.PRE_IN_TAX_I          , 0)
			 + ISNULL(B.PRE_LOCAL_TAX_I       , 0)
			 + ISNULL(B.PRE_SP_TAX_I          , 0)
			 + ISNULL(B.NAP_IN_TAX_I          , 0)
			 + ISNULL(B.NAP_LOCAL_TAX_I       , 0)
			 + ISNULL(B.NAP_SP_TAX_I          , 0)                               AS PAID_TAX_SUM               --(조회용)기납부세액합계
	
			 , ISNULL(B.IN_TAX_I              , 0)                               AS IN_TAX_I                   --정산소득세
			 , ISNULL(B.LOCAL_TAX_I           , 0)                               AS LOCAL_TAX_I                --정산주민세
			 , ISNULL(B.SP_TAX_I              , 0)                               AS SP_TAX_I                   --정산농특세
	
			 , ISNULL(B.IN_TAX_I              , 0)
			 + ISNULL(B.LOCAL_TAX_I           , 0)
			 + ISNULL(B.SP_TAX_I              , 0)                               AS TAX_SUM                    --(조회용)정산세액합계

          FROM            HUM100T A  WITH (NOLOCK)
               LEFT  JOIN HAD600T B  WITH (NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
                                                  AND B.YEAR_YYYY   = #{YEAR_YYYY}
                                                  AND B.PERSON_NUMB = A.PERSON_NUMB
               LEFT  JOIN BSA100T M1 WITH (NOLOCK) ON M1.COMP_CODE  = A.COMP_CODE
                                                  AND M1.MAIN_CODE  = 'H005'
                                                  AND M1.SUB_CODE   = A.POST_CODE
         WHERE A.COMP_CODE   = #{S_COMP_CODE}
           AND A.PERSON_NUMB = #{PERSON_NUMB}
          
	</select>
	
	<select id="had617ukrServiceImpl.selectFormHad400" parameterType="rMap" resultType="rMap">		
		/* had617ukrServiceImpl.selectFormHad400 */
		Declare @YearYyyy NVARCHAR(4)
		SET @YearYyyy = #{YEAR_YYYY}
		
        SELECT 'HAD400T' AS T_GBN
             , A.PERSON_NUMB                                                                                   --사번
             , A.NAME                                                                                          --성명
             , A.DEPT_CODE                                                                                     --(참조)
             , A.DEPT_NAME                                                                                     --(참조)
             , A.POST_CODE                                                                                     --(참조)
             , ISNULL(M1.CODE_NAME            , '')                              AS POST_NAME                  --(참조)
             , ISNULL(unilite.fnCipherDecrypt(A.REPRE_NUM  ,'A'), '')            AS REPRE_NUM                  --(참조)
             , ISNULL(unilite.fnCipherDecrypt(A.FOREIGN_NUM,'F'), '')            AS FOREIGN_NUM                --(참조)
             , A.NATION_CODE                                                                                   --(참조)
             , A.LIVE_GUBUN                                                                                    --(참조)
             , ISNULL(B.YEAR_YYYY             , @YearYyyy)                       AS YEAR_YYYY                  --정산년도
             , (CASE WHEN A.RETR_DATE != '00000000' AND LEN(A.RETR_DATE) &gt; 0 AND RIGHT(A.RETR_DATE,4) != '1231' AND LEFT(A.RETR_DATE,4) &lt;= @YearYyyy
                     THEN 'Y'
                     ELSE  CASE WHEN RIGHT(A.RETR_DATE,4) = '1231' AND ISNULL(C.YEARENDTAX_CALCU_RULE,'1') = '2' 
                                THEN 'Y'
                                ELSE 'N'
                           END
                 END)                                                            AS HALFWAY_TYPE               --중도퇴사자정산여부
             , ISNULL(B.FORE_SINGLE_YN        , '')                              AS FORE_SINGLE_YN             --외국인단일세율적용여부
             , ISNULL(B.FOREIGN_DISPATCH_YN        , '')                         AS FOREIGN_DISPATCH_YN        --외국법인소속 파견근로자여부
             , ISNULL(B.HOUSEHOLDER_YN        , '2')                             AS HOUSEHOLDER_YN             --세대주여부
             , (CASE WHEN ISNULL(B.NONTAX_FR, '') = '' OR ISNULL(B.NONTAX_FR, '') = '0'
                     THEN ''
                     ELSE B.NONTAX_FR
                 END)                                                            AS NONTAX_FR                  --세액감면기간(Fr)
             , (CASE WHEN ISNULL(B.NONTAX_TO, '') = '' OR ISNULL(B.NONTAX_TO, '') = '0'
                     THEN ''
                     ELSE B.NONTAX_TO
                 END)                                                            AS NONTAX_TO                  --세액감면기간(To)
    
             , ISNULL(B.INCOME_SUPP_TOTAL_I   , 0)                               AS INCOME_SUPP_TOTAL_I        --총급여액
    
             , ISNULL(B.NOW_PAY_TOT_I         , 0)
             + ISNULL(B.NOW_BONUS_TOTAL_I     , 0)
             + ISNULL(B.NOW_ADD_BONUS_I       , 0)
             + ISNULL(B.NOW_STOCK_PROFIT_I    , 0)
             + ISNULL(B.NOW_OWNER_STOCK_DRAW_I, 0)
             + ISNULL(B.NOW_OF_RETR_OVER_I    , 0)                               AS NOW_PAY_AMT                --주(현)총급여액
             , ISNULL(B.NOW_PAY_TOT_I         , 0)                               AS NOW_PAY_TOT_I              --주(현)급여총액(숨김)
             , ISNULL(B.NOW_BONUS_TOTAL_I     , 0)                               AS NOW_BONUS_TOTAL_I          --주(현)상여총액(숨김)
             , ISNULL(B.NOW_ADD_BONUS_I       , 0)                               AS NOW_ADD_BONUS_I            --주(현)인정상여금액(숨김)
             , ISNULL(B.NOW_STOCK_PROFIT_I    , 0)                               AS NOW_STOCK_PROFIT_I         --주(현)주식매수선택행사이익(숨김)
             , ISNULL(B.NOW_OWNER_STOCK_DRAW_I, 0)                               AS NOW_OWNER_STOCK_DRAW_I     --주(현)우리사주조합인출금(숨김)
             , ISNULL(B.NOW_OF_RETR_OVER_I, 0)                                   AS NOW_OF_RETR_OVER_I         --주(현)임원퇴직한도초과액(숨김)
             , ISNULL(B.OLD_PAY_TOT_I         , 0)
             + ISNULL(B.OLD_BONUS_TOTAL_I     , 0)
             + ISNULL(B.OLD_ADD_BONUS_I       , 0)
             + ISNULL(B.OLD_STOCK_PROFIT_I    , 0)
             + ISNULL(B.OLD_OWNER_STOCK_DRAW_I, 0)
             + ISNULL(B.OLD_OF_RETR_OVER_I    , 0)                               AS OLD_PAY_AMT                --종(전)총급여액
             , ISNULL(B.OLD_PAY_TOT_I         , 0)                               AS OLD_PAY_TOT_I              --종(전)급여총액
             , ISNULL(B.OLD_BONUS_TOTAL_I     , 0)                               AS OLD_BONUS_TOTAL_I          --종(전)상여총액
             , ISNULL(B.OLD_ADD_BONUS_I       , 0)                               AS OLD_ADD_BONUS_I            --종(전)인정상여금액
             , ISNULL(B.OLD_STOCK_PROFIT_I    , 0)                               AS OLD_STOCK_PROFIT_I         --종(전)주식매수선택행사이익
             , ISNULL(B.OLD_OWNER_STOCK_DRAW_I, 0)                               AS OLD_OWNER_STOCK_DRAW_I     --종(전)우리사주조합인출금
             , ISNULL(B.OLD_OF_RETR_OVER_I    , 0)                               AS OLD_OF_RETR_OVER_I         --종(전)임원퇴직한도초과액
             , ISNULL(B.NAP_PAY_TOT_I         , 0)
             + ISNULL(B.NAP_BONUS_TOTAL_I     , 0)                               AS NAP_PAY_AMT                --(납)총급여액
             , ISNULL(B.NAP_PAY_TOT_I         , 0)                               AS NAP_PAY_TOT_I              --(납)급여총액
             , ISNULL(B.NAP_BONUS_TOTAL_I     , 0)                               AS NAP_BONUS_TOTAL_I          --(납)상여총액
             , ISNULL(B.INCOME_DED_I          , 0)                               AS INCOME_DED_I               --근로소득공제
             , ISNULL(B.EARN_INCOME_I         , 0)                               AS EARN_INCOME_I              --근로소득금액
    
             , ISNULL(B.PER_DED_I             , 0)                               AS PER_DED_I                  --본인공제
             , ISNULL(B.SPOUSE                ,'N')                              AS SPOUSE                     --배우자유무
             , ISNULL(B.SUPP_NUM              , 0)                               AS SUPP_NUM                   --부양자
             , ISNULL(B.SUPP_NUM_1            , 0)                               AS SUPP_NUM_1                 --부양자:직계존속
             , ISNULL(B.SUPP_NUM_4            , 0)                               AS SUPP_NUM_4                 --부양자:직계비속-자녀입양자
             , ISNULL(B.SUPP_NUM_5            , 0)                               AS SUPP_NUM_5                 --부양자:직계비속-그외직계비속
             , ISNULL(B.SUPP_NUM_6            , 0)                               AS SUPP_NUM_6                 --부양자:형제자매
             , ISNULL(B.SUPP_NUM_7            , 0)                               AS SUPP_NUM_7                 --부양자:수급자
             , ISNULL(B.SUPP_NUM_8            , 0)                               AS SUPP_NUM_8                 --부양자:위탁아동
             , ISNULL(B.AGED_NUM              , 0)                               AS AGED_NUM                   --경로자
             , ISNULL(B.DEFORM_NUM            , 0)                               AS DEFORM_NUM                 --장애자
             , ISNULL(B.MANY_CHILD_NUM        , 0)                               AS MANY_CHILD_NUM             --자녀
             , ISNULL(B.BRING_CHILD_NUM       , 0)                               AS BRING_CHILD_NUM            --자녀양육
             , ISNULL(B.BIRTH_ADOPT_NUM       , 0)                               AS BIRTH_ADOPT_NUM            --출산입양
             , ISNULL(B.WOMAN                 , 'N')                             AS WOMAN                      --부녀자유무
             , ISNULL(B.ONE_PARENT            , 'N')                             AS ONE_PARENT                 --한부모유무
    		 , ISNULL(B.BIRTH_ADOPT_NUM1      , 0)                               AS BIRTH_ADOPT_NUM1           --출산입양첫째
			 , ISNULL(B.BIRTH_ADOPT_NUM2      , 0)                               AS BIRTH_ADOPT_NUM2           --출산입양둘째
			 , ISNULL(B.BIRTH_ADOPT_NUM3      , 0)                               AS BIRTH_ADOPT_NUM3           --출산입양셋째이상
		 
             , ISNULL(B.ANU_I                 , 0)                               AS ANU_I                      --국민연금보험료
             , ISNULL(B.ANU_ADD_I             , 0)                               AS ANU_ADD_I                  --국민연금보험료(개별입력)
             , ISNULL(B.PUBLIC_PENS_I         , 0)                               AS PUBLIC_PENS_I              --공무원연금
             , ISNULL(B.SOLDIER_PENS_I        , 0)                               AS SOLDIER_PENS_I             --군인연금
             , ISNULL(B.SCH_PENS_I            , 0)                               AS SCH_PENS_I                 --사립학교교직원연금
             , ISNULL(B.POST_PENS_I           , 0)                               AS POST_PENS_I                --별정우체국연금
    
             , ISNULL(B.MED_PREMINM_I         , 0)                               AS MED_PREMINM_I              --건강보험료
             , ISNULL(B.MED_PREMINM_ADD_I     , 0)                               AS MED_PREMINM_ADD_I          --건강보험료(개별입력)
             , ISNULL(B.HIRE_INSUR_I          , 0)                               AS HIRE_INSUR_I               --고용보험료
    
             , ISNULL(B.HOUS_AMOUNT_TOT_I     , 0)                               AS HOUS_AMOUNT_TOT_I          --원리금상환액(대출기관)
             , ISNULL(B.HOUS_AMOUNT_TOT_I_2   , 0)                               AS HOUS_AMOUNT_TOT_I_2        --원리금상환액(거주자)
             , ISNULL(B.HOUS_AMOUNT_INTER_I_2 , 0)                               AS HOUS_AMOUNT_INTER_I_2      --주택자금이자상환액(15년미만)
             , ISNULL(B.HOUS_AMOUNT_INTER_I   , 0)                               AS HOUS_AMOUNT_INTER_I        --주택자금이자상환액(15년~29년)
             , ISNULL(B.HOUS_AMOUNT_INTER_I_3 , 0)                               AS HOUS_AMOUNT_INTER_I_3      --주택자금이자상환액(30년이상)
             , ISNULL(B.FIXED_RATE_LOAN       , 0)                               AS FIXED_RATE_LOAN            --고정금리비거치상환대출
             , ISNULL(B.ETC_LOAN              , 0)                               AS ETC_LOAN                   --기타대출
             , ISNULL(B.HOUS_AMOUNT_INTER_I_6 , 0)                               AS HOUS_AMOUNT_INTER_I_6      --15년이상(고정금리이면서 비거치상환)
             , ISNULL(B.HOUS_AMOUNT_INTER_I_7 , 0)                               AS HOUS_AMOUNT_INTER_I_7      --15년이상(고정금리이거나 비거치상환)
             , ISNULL(B.HOUS_AMOUNT_INTER_I_8 , 0)                               AS HOUS_AMOUNT_INTER_I_8      --15년이상(그밖의대출)
             , ISNULL(B.HOUS_AMOUNT_INTER_I_9 , 0)                               AS HOUS_AMOUNT_INTER_I_9      --10년이상(고정금리이거나 비거치상환)
    
             , ISNULL(B.PRIV_PENS_I           , 0)                               AS PRIV_PENS_I                --개인연금저축소득공제
    
             , ISNULL(B.HOUS_BU_AMT           , 0)                               AS HOUS_BU_AMT                --청약저축
             , ISNULL(B.HOUS_BU_ADD_AMT       , 0)                               AS HOUS_BU_ADD_AMT            --청약저축(120만원한도)
             , ISNULL(B.HOUS_WORK_AMT         , 0)                               AS HOUS_WORK_AMT              --근로자주택마련저축
             , ISNULL(B.HOUS_AMOUNT_I         , 0)                               AS HOUS_AMOUNT_I              --주택청약종합저축
             , ISNULL(B.HOUS_AMOUNT_ADD_I     , 0)                               AS HOUS_AMOUNT_ADD_I          --주택청약종합저축(120만원한도)
    
             , ISNULL(B.CARD_USE_I            , 0)                               AS CARD_USE_I                 --신용카드사용액
             , ISNULL(B.CASH_USE_I            , 0)                               AS CASH_USE_I                 --현금영수증사용액
             , ISNULL(B.DEBIT_CARD_USE_I      , 0)                               AS DEBIT_CARD_USE_I           --직불카드사용액
             , ISNULL(B.TRA_MARKET_USE_I      , 0)                               AS TRA_MARKET_USE_I           --전통시장사용액
             , ISNULL(B.TRAFFIC_USE_I         , 0)                               AS TRAFFIC_USE_I              --대중교통이용액
             
    
             , ISNULL(B.COMP_PREMINUM         , '0')                             AS COMP_PREMINUM              --소기업소상공인공제부금 2017년 가입한 법인대표자 여부
             , ISNULL(B.COMP_PREMINUM_I       , 0)                               AS COMP_PREMINUM_I            --소기업소상공인공제부금2
             , ISNULL(B.INVESTMENT_I          , 0)                               AS INVESTMENT_I               --투자조합출자(2012년이전 10%해당분)
             , ISNULL(B.INVESTMENT_I3         , 0)                               AS INVESTMENT_I3              --투자조합출자(2012년 20%해당분)
             , ISNULL(B.INVESTMENT_I4         , 0)                               AS INVESTMENT_I4              --투자조합출자(2013년 10%해당분)
             , ISNULL(B.INVESTMENT_I2         , 0)                               AS INVESTMENT_I2              --투자조합출자(2013년 30%해당분)
             , ISNULL(B.INVESTMENT_I5         , 0)                               AS INVESTMENT_I5              --투자조합출자(2014년 10%해당분)
             , ISNULL(B.INVESTMENT_I6         , 0)                               AS INVESTMENT_I6              --투자조합출자(2014년 50%해당분)
             , ISNULL(B.INVESTMENT_I7         , 0)                               AS INVESTMENT_I7              --투자조합출자(2014년 30%해당분)
             , ISNULL(B.INVESTMENT_I8         , 0)                               AS INVESTMENT_I8              --투자조합출자(2015년 10%해당분)
             , ISNULL(B.INVESTMENT_I9         , 0)                               AS INVESTMENT_I9              --투자조합출자(2015년100%해당분)
             , ISNULL(B.INVESTMENT_I10        , 0)                               AS INVESTMENT_I10             --투자조합출자(2015년 50%해당분)
             , ISNULL(B.INVESTMENT_I11        , 0)                               AS INVESTMENT_I11             --투자조합출자(2015년 30%해당분)
             , ISNULL(B.STAFF_STOCK_I         , 0)                               AS STAFF_STOCK_I              --우리사주조합출연
             , ISNULL(B.EMPLOY_WORKER_I       , 0)                               AS EMPLOY_WORKER_I            --고용유지중소기업근로자소득공제
             , 0                                                                 AS NOT_AMOUNT_LOAN_I          --목돈안드는전세이자상환액(2017년 삭제)
             , ISNULL(B.LONG_INVEST_STOCK_I   , 0)                               AS LONG_INVEST_STOCK_I        --장기집합투자증권저축
    
             , ISNULL(B.INCOME_REDU_I         , 0)                               AS INCOME_REDU_I              --소득세법
             , ISNULL(B.TAXES_REDU_I          , 0)                               AS TAXES_REDU_I               --조세조약
    
             , ISNULL(B.SCI_DEDUC_I           , 0)                               AS SCI_DEDUC_I                --과학기술인공제
             , ISNULL(B.RETIRE_PENS_I         , 0)                               AS RETIRE_PENS_I              --근로자퇴직급여보장법
             , ISNULL(B.PENS_I                , 0)                               AS PENS_I                     --연금저축소득공제
    
             , ISNULL(B.ETC_INSUR_I           , 0)                               AS ETC_INSUR_I                --보장성보험
             , ISNULL(B.DEFORM_INSUR_I        , 0)                               AS DEFORM_INSUR_I             --장애인전용보장성보험
    
             , ISNULL(B.MY_MED_DED_I          , 0)                               AS MY_MED_DED_I               --본인의료비
             , ISNULL(B.SENIOR_MED_I          , 0)                               AS SENIOR_MED_I               --경로의료비
             , ISNULL(B.DEFORM_MED_I          , 0)                               AS DEFORM_MED_I               --장애의료비
             , ISNULL(B.SURGERY_MED_I         , 0)                               AS SURGERY_MED_I              --난임시술비
             , ISNULL(B.MED_TOTAL_I           , 0)                               AS MED_TOTAL_I                --그밖의 공제대상자 의료비
    
             , ISNULL(B.PER_EDUC_I            , 0)                               AS PER_EDUC_I                 --본인교육비
             , ISNULL(B.UNIV_EDUC_NUM         , 0)                               AS UNIV_EDUC_NUM              --대학교자녀수
             , ISNULL(B.UNIV_EDUC_I           , 0)                               AS UNIV_EDUC_I                --대학교교육비
             , ISNULL(B.STUD_EDUC_NUM         , 0)                               AS STUD_EDUC_NUM              --초중고자녀수
             , ISNULL(B.STUD_EDUC_I           , 0)                               AS STUD_EDUC_I                --초중고교육비
             , ISNULL(B.KIND_EDU_NUM          , 0)                               AS KIND_EDU_NUM               --유치원자녀수
             , ISNULL(B.KIND_EDUC_I           , 0)                               AS KIND_EDUC_I                --유치원교육비
             , ISNULL(B.DEFORM_EDUC_NUM       , 0)                               AS DEFORM_EDUC_NUM            --장애인수
             , ISNULL(B.DEFORM_EDUC_I         , 0)                               AS DEFORM_EDUC_I              --장애인특수교육비
             , ISNULL(B.FIELD_EDUC_I          , 0)                               AS FIELD_EDUC_I               --체험학습비
    
             , ISNULL(B.PER_EDUC_DED_I        , 0)                               AS PER_EDUC_DED_I             --본인교육비공제
             , ISNULL(B.UNIV_EDUC_DED_I       , 0)                               AS UNIV_EDUC_DED_I            --대학교교육비공제
             , ISNULL(B.STUD_EDUC_DED_I       , 0)                               AS STUD_EDUC_DED_I            --초중고교육비공제
             , ISNULL(B.KIND_EDUC_DED_I       , 0)                               AS KIND_EDUC_DED_I            --유치원교육비공제
             , ISNULL(B.DEFORM_EDUC_DED_I     , 0)                               AS DEFORM_EDUC_DED_I          --장애인특수교육비공제
    
             , ISNULL(B.POLICY_INDED          , 0)                               AS POLICY_INDED               --정치자금기부금공제
             , ISNULL(B.POLICY_GIFT_I         , 0)                               AS POLICY_GIFT_I              --정치자금기부금
             , ISNULL(B.LEGAL_GIFT_I_PREV     , 0)                               AS LEGAL_GIFT_I_PREV          --법정기부금(전년도이월액)-2013
             , ISNULL(B.LEGAL_GIFT_I_PREV_14  , 0)                               AS LEGAL_GIFT_I_PREV_14       --법정기부금(전년도이월액)-2014
             , ISNULL(B.LEGAL_GIFT_I          , 0)                               AS LEGAL_GIFT_I               --법정기부금
             , ISNULL(B.PRIV_GIFT_I_PREV      , 0)                               AS PRIV_GIFT_I_PREV           --특례기부금(전년도이월액)
             , ISNULL(B.PRIV_GIFT_I           , 0)                               AS PRIV_GIFT_I                --특례기부금
             , ISNULL(B.PUBLIC_GIFT_I_PREV    , 0)                               AS PUBLIC_GIFT_I_PREV         --공익법인신탁기부금(전년도이월액)
             , ISNULL(B.PUBLIC_GIFT_I         , 0)                               AS PUBLIC_GIFT_I              --공익법인신탁기부금
             , ISNULL(B.STAFF_GIFT_I          , 0)                               AS STAFF_GIFT_I               --우리사주기부금
             , ISNULL(B.APPOINT_GIFT_I_PREV   , 0)                               AS APPOINT_GIFT_I_PREV        --지정기부금(전년도이월액)-2013
             , ISNULL(B.APPOINT_GIFT_I_PREV_14, 0)                               AS APPOINT_GIFT_I_PREV_14     --지정기부금(전년도이월액)-2014
             , ISNULL(B.APPOINT_GIFT_I        , 0)                               AS APPOINT_GIFT_I             --지정기부금
             , ISNULL(B.ASS_GIFT_I_PREV       , 0)                               AS ASS_GIFT_I_PREV            --종교단체기부금(전년도이월액)-2013
             , ISNULL(B.ASS_GIFT_I_PREV_14    , 0)                               AS ASS_GIFT_I_PREV_14         --종교단체기부금(전년도이월액)-2014
             , ISNULL(B.ASS_GIFT_I            , 0)                               AS ASS_GIFT_I                 --종교단체기부금
    
             , ISNULL(B.P3_TAX_DED_I          , 0)                               AS P3_TAX_DED_I               --납세조합세액
             , ISNULL(B.HOUS_INTER_I          , 0)                               AS HOUS_INTER_I               --주택자금상환액
             , ISNULL(B.FORE_INCOME_I         , 0)                               AS FORE_INCOME_I              --외국납부소득금액
             , ISNULL(B.FORE_TAX_I            , 0)                               AS FORE_TAX_I                 --외국납부세액
             , ISNULL(B.MON_RENT_I            , 0)                               AS MON_RENT_I                 --월세액
    
             , (CASE WHEN ISNULL(B.PERSON_NUMB, '') = ''
                     THEN 'Y'
                     ELSE 'N'
                 END)                                                            AS NEW_DATA_YN                --개인연말정산기초자료 존재여부
          FROM            HUM100T A  WITH (NOLOCK)
               LEFT  JOIN HAD400T B  WITH (NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
                                                  AND B.YEAR_YYYY   = #{YEAR_YYYY}
                                                  AND B.PERSON_NUMB = A.PERSON_NUMB
               LEFT  JOIN BSA100T M1 WITH (NOLOCK) ON M1.COMP_CODE  = A.COMP_CODE
                                                  AND M1.MAIN_CODE  = 'H005'
                                                  AND M1.SUB_CODE   = A.POST_CODE
               LEFT  JOIN HBS400T C  WITH (NOLOCK) ON C.COMP_CODE = A.COMP_CODE
         WHERE A.COMP_CODE   = #{S_COMP_CODE}
           AND A.PERSON_NUMB = #{PERSON_NUMB}
	</select>
	<select id="had617ukrServiceImpl.selectPrevious" parameterType="rMap" resultType="rMap">
		    DECLARE @JoinDate           NVARCHAR(08)                -- (필수) 입사기준일
		          , @RetireDateFr       NVARCHAR(08)                -- (필수) 퇴사기준일(Fr)
		          , @RetireDateTo       NVARCHAR(08)                -- (필수) 퇴사기준일(To)
	
		    SET @JoinDate     = #{YEAR_YYYY} + '1231'
		    SET @RetireDateFr = #{YEAR_YYYY} + '0101'
		    SET @RetireDateTo = #{YEAR_YYYY} + '1231'
		
	        SELECT TOP 1 A.PERSON_NUMB AS PREV_PERSON_NUMB, A.NAME
	          FROM HUM100T A WITH (NOLOCK)
	         WHERE A.COMP_CODE   = #{S_COMP_CODE}
	           AND A.PERSON_NUMB &lt; #{PERSON_NUMB}
	           AND A.JOIN_DATE   &lt; @JoinDate
	           AND (A.RETR_DATE = '00000000' OR (A.RETR_DATE &gt;= @RetireDateFr AND RETR_DATE &lt;= @RetireDateTo))
	         ORDER BY A.PERSON_NUMB DESC
		 
	</select>
	<select id="had617ukrServiceImpl.selectNext" parameterType="rMap" resultType="rMap">
		    DECLARE @JoinDate           NVARCHAR(08)                -- (필수) 입사기준일
		          , @RetireDateFr       NVARCHAR(08)                -- (필수) 퇴사기준일(Fr)
		          , @RetireDateTo       NVARCHAR(08)                -- (필수) 퇴사기준일(To)
	
		    SET @JoinDate     = #{YEAR_YYYY} + '1231'
		    SET @RetireDateFr = #{YEAR_YYYY} + '0101'
		    SET @RetireDateTo = #{YEAR_YYYY} + '1231'
		    
	        SELECT TOP 1  A.PERSON_NUMB AS NEXT_PERSON_NUMB, A.NAME
	          FROM HUM100T A WITH (NOLOCK)
	         WHERE A.COMP_CODE   = #{S_COMP_CODE}
	           AND A.PERSON_NUMB &gt; #{PERSON_NUMB}
	           AND A.JOIN_DATE   &lt; @JoinDate
	           AND (A.RETR_DATE = '00000000' OR (A.RETR_DATE &gt;= @RetireDateFr AND RETR_DATE &lt;= @RetireDateTo))
	         ORDER BY A.PERSON_NUMB ASC
	</select>
	<select id="had617ukrServiceImpl.checkRetroOTKind" parameterType="rMap" resultType="rMap">
	/* had617ukrServiceImpl.checkRetroOTKind */
			SELECT CASE WHEN ISNULL(B.POST_CODE   , '') != '' THEN 'OF'
		                WHEN ISNULL(A.RETR_OT_KIND, '')  = '' THEN 'ST'
		                ELSE A.RETR_OT_KIND
		           END  AS RETR_OT_KIND
		    FROM              HUM100T   A  WITH (NOLOCK)
		           LEFT  JOIN HRT120T   B  WITH (NOLOCK) ON B.COMP_CODE = A.COMP_CODE
		                                                AND B.POST_CODE = A.POST_CODE
		    WHERE  A.COMP_CODE   = #{S_COMP_CODE}
		    AND    A.PERSON_NUMB = #{PERSON_NUMB}
	</select>
	
	<select id="had617ukrServiceImpl.selectFormData01" parameterType="rMap" resultType="rMap">
		DECLARE @JSON_PARAM    NVARCHAR(2000), @ERROR_DESC   NVARCHAR(2000) 
        --※ 주의 : Json 파람조건에 엔터키 값 없이 해야함.
        SET @JSON_PARAM = '{"COMP_CODE":"${S_COMP_CODE}", "PERSON_NUMB":"${PERSON_NUMB}", "RETR_TYPE":"${RETR_TYPE}", "RETR_DATE":"${RETR_DATE}", "TAXCALCUYN":"${TAX_CALCU}", "SUPP_DATE":"${SUPP_DATE}", "RETR_KINE":"", "WORK_TYPE":"1", "KEY_VALUE":"", "UPDATE_DB_USER":"${S_USER_ID}", "LANG_TYPE":"${S_LANG_CODE}"}'
        exec uniLITE.USP_HUMAN_Had617UKR @JSON_PARAM, @ERROR_DESC 

       --SELECT ISNULL(@ERROR_DESC, '')	AS errorDesc	
	</select>
	<update id="had617ukrServiceImpl.save400"  parameterType="rMap">
		IF EXISTS (SELECT PERSON_NUMB 
				    FROM HAD400T 
				    WHERE COMP_CODE = #{S_COMP_CODE} 
				      AND PERSON_NUMB = #{PERSON_NUMB} 
				      AND YEAR_YYYY= #{YEAR_YYYY} )
		UPDATE HAD400T
		SET 			
			INCOME_SUPP_TOTAL_I			= #{INCOME_SUPP_TOTAL_I}		
			, NOW_PAY_TOT_I				= #{NOW_PAY_TOT_I}				
			, NOW_BONUS_TOTAL_I			= #{NOW_BONUS_TOTAL_I}			
			, NOW_ADD_BONUS_I			= #{NOW_ADD_BONUS_I}			
			, NOW_STOCK_PROFIT_I		= #{NOW_STOCK_PROFIT_I}		
			, NOW_OWNER_STOCK_DRAW_I	= #{NOW_OWNER_STOCK_DRAW_I}	
			, NOW_OF_RETR_OVER_I	    = #{NOW_OF_RETR_OVER_I}	    
			, OLD_PAY_TOT_I				= #{OLD_PAY_TOT_I}				
			, OLD_BONUS_TOTAL_I			= #{OLD_BONUS_TOTAL_I}			
			, OLD_ADD_BONUS_I			= #{OLD_ADD_BONUS_I}			
			, OLD_STOCK_PROFIT_I		= #{OLD_STOCK_PROFIT_I}		
			, OLD_OWNER_STOCK_DRAW_I	= #{OLD_OWNER_STOCK_DRAW_I}	
			, OLD_OF_RETR_OVER_I	    = #{OLD_OF_RETR_OVER_I}	    
			, NAP_PAY_TOT_I				= #{NAP_PAY_TOT_I}				
			, NAP_BONUS_TOTAL_I			= #{NAP_BONUS_TOTAL_I}			
			, INCOME_DED_I				= #{INCOME_DED_I}				
			, EARN_INCOME_I				= #{EARN_INCOME_I}				
			, PER_DED_I					= #{PER_DED_I}					
			, SPOUSE					= #{SPOUSE}					
			, SUPP_NUM					= #{SUPP_NUM}					
			, SUPP_NUM_1				= #{SUPP_NUM_1}				
			, SUPP_NUM_4				= #{SUPP_NUM_4}				
			, SUPP_NUM_5				= #{SUPP_NUM_5}				
			, SUPP_NUM_6				= #{SUPP_NUM_6}				
			, SUPP_NUM_7				= #{SUPP_NUM_7}				
			, SUPP_NUM_8				= #{SUPP_NUM_8}				
			, AGED_NUM					= #{AGED_NUM}					
			, DEFORM_NUM				= #{DEFORM_NUM}				
			, MANY_CHILD_NUM			= #{MANY_CHILD_NUM}			
			, BRING_CHILD_NUM			= #{BRING_CHILD_NUM}			
			, BIRTH_ADOPT_NUM			= #{BIRTH_ADOPT_NUM}			
			, WOMAN						= #{WOMAN}						
			, ONE_PARENT                = #{ONE_PARENT} 
			, BIRTH_ADOPT_NUM1			= #{BIRTH_ADOPT_NUM1}				
			, BIRTH_ADOPT_NUM2			= #{BIRTH_ADOPT_NUM2}
			, BIRTH_ADOPT_NUM3			= #{BIRTH_ADOPT_NUM3}		               
			, ANU_I						= #{ANU_I}						
			, ANU_ADD_I					= #{ANU_ADD_I}					
			, PUBLIC_PENS_I				= #{PUBLIC_PENS_I}				
			, SOLDIER_PENS_I			= #{SOLDIER_PENS_I}			
			, SCH_PENS_I				= #{SCH_PENS_I}				
			, POST_PENS_I				= #{POST_PENS_I}				
			, MED_PREMINM_I				= #{MED_PREMINM_I}				
			, MED_PREMINM_ADD_I			= #{MED_PREMINM_ADD_I}			
			, HIRE_INSUR_I				= #{HIRE_INSUR_I}				
			, HOUS_AMOUNT_TOT_I			= #{HOUS_AMOUNT_TOT_I}			
			, HOUS_AMOUNT_TOT_I_2		= #{HOUS_AMOUNT_TOT_I_2}		
			, HOUS_AMOUNT_INTER_I_2		= #{HOUS_AMOUNT_INTER_I_2}		
			, HOUS_AMOUNT_INTER_I		= #{HOUS_AMOUNT_INTER_I}		
			, HOUS_AMOUNT_INTER_I_3		= #{HOUS_AMOUNT_INTER_I_3}		
			, FIXED_RATE_LOAN			= #{FIXED_RATE_LOAN}			
			, ETC_LOAN					= #{ETC_LOAN}					
			, HOUS_AMOUNT_INTER_I_6		= #{HOUS_AMOUNT_INTER_I_6}		
			, HOUS_AMOUNT_INTER_I_7		= #{HOUS_AMOUNT_INTER_I_7}		
			, HOUS_AMOUNT_INTER_I_8		= #{HOUS_AMOUNT_INTER_I_8}		
			, HOUS_AMOUNT_INTER_I_9		= #{HOUS_AMOUNT_INTER_I_9}		
			, PRIV_PENS_I				= #{PRIV_PENS_I}				
			, HOUS_BU_AMT				= #{HOUS_BU_AMT}				
			, HOUS_BU_ADD_AMT			= #{HOUS_BU_ADD_AMT}			
			, HOUS_WORK_AMT				= #{HOUS_WORK_AMT}				
			, HOUS_AMOUNT_I				= #{HOUS_AMOUNT_I}				
			, HOUS_AMOUNT_ADD_I			= #{HOUS_AMOUNT_ADD_I}			
			, CARD_USE_I				= #{CARD_USE_I}				
			, CASH_USE_I				= #{CASH_USE_I}				
			, DEBIT_CARD_USE_I			= #{DEBIT_CARD_USE_I}			
			, TRA_MARKET_USE_I			= #{TRA_MARKET_USE_I}			
			, TRAFFIC_USE_I  			= #{TRAFFIC_USE_I}  			
			
			, COMP_PREMINUM 			= #{COMP_PREMINUM} 			
			, COMP_PREMINUM_I			= #{COMP_PREMINUM_I}			
			, INVESTMENT_I				= #{INVESTMENT_I}				
			, INVESTMENT_I3				= #{INVESTMENT_I3}				
			, INVESTMENT_I4				= #{INVESTMENT_I4}				
			, INVESTMENT_I2				= #{INVESTMENT_I2}					
			, INVESTMENT_I5				= #{INVESTMENT_I5}					
			, INVESTMENT_I6				= #{INVESTMENT_I6}					
			, INVESTMENT_I7				= #{INVESTMENT_I7}					
			, INVESTMENT_I8				= #{INVESTMENT_I8}					
			, INVESTMENT_I9				= #{INVESTMENT_I9}					
			, INVESTMENT_I10			= #{INVESTMENT_I10}				
			, INVESTMENT_I11			= #{INVESTMENT_I11}				
			, STAFF_STOCK_I				= #{STAFF_STOCK_I}				
			, EMPLOY_WORKER_I			= #{EMPLOY_WORKER_I}			
			, LONG_INVEST_STOCK_I		= #{LONG_INVEST_STOCK_I}		
			, INCOME_REDU_I				= #{INCOME_REDU_I}				
			, TAXES_REDU_I				= #{TAXES_REDU_I}				
			, SCI_DEDUC_I				= #{SCI_DEDUC_I}				
			, RETIRE_PENS_I				= #{RETIRE_PENS_I}				
			, PENS_I					= #{PENS_I}					
			, ETC_INSUR_I				= #{ETC_INSUR_I}				
			, DEFORM_INSUR_I			= #{DEFORM_INSUR_I}			
			, MY_MED_DED_I				= #{MY_MED_DED_I}				
			, SENIOR_MED_I				= #{SENIOR_MED_I}				
			, DEFORM_MED_I				= #{DEFORM_MED_I}				
			, SURGERY_MED_I				= #{SURGERY_MED_I}				
			, MED_TOTAL_I				= #{MED_TOTAL_I}				
			, PER_EDUC_I				= #{PER_EDUC_I}				
			, UNIV_EDUC_NUM				= #{UNIV_EDUC_NUM}				
			, UNIV_EDUC_I				= #{UNIV_EDUC_I}				
			, STUD_EDUC_NUM				= #{STUD_EDUC_NUM}				
			, STUD_EDUC_I				= #{STUD_EDUC_I}				
			, KIND_EDU_NUM				= #{KIND_EDU_NUM}				
			, KIND_EDUC_I				= #{KIND_EDUC_I}				
			, DEFORM_EDUC_NUM 			= #{DEFORM_EDUC_NUM }			
			, DEFORM_EDUC_I				= #{DEFORM_EDUC_I}
			, FIELD_EDUC_I				= #{FIELD_EDUC_I}				
			, PER_EDUC_DED_I			= #{PER_EDUC_DED_I}			
			, UNIV_EDUC_DED_I			= #{UNIV_EDUC_DED_I}			
			, STUD_EDUC_DED_I			= #{STUD_EDUC_DED_I}			
			, KIND_EDUC_DED_I			= #{KIND_EDUC_DED_I}			
			, DEFORM_EDUC_DED_I			= #{DEFORM_EDUC_DED_I}
			, FIELD_EDUC_DED_I			= #{FIELD_EDUC_DED_I}			
			, POLICY_INDED				= #{POLICY_INDED}				
			, POLICY_GIFT_I				= #{POLICY_GIFT_I}				
			, LEGAL_GIFT_I_PREV			= #{LEGAL_GIFT_I_PREV}			
			, LEGAL_GIFT_I_PREV_14		= #{LEGAL_GIFT_I_PREV_14}		
			, LEGAL_GIFT_I				= #{LEGAL_GIFT_I}				
			, PRIV_GIFT_I_PREV			= #{PRIV_GIFT_I_PREV}			
			, PRIV_GIFT_I				= #{PRIV_GIFT_I}				
			, PUBLIC_GIFT_I_PREV		= #{PUBLIC_GIFT_I_PREV}		
			, PUBLIC_GIFT_I				= #{PUBLIC_GIFT_I}				
			, STAFF_GIFT_I				= #{STAFF_GIFT_I}				
			, APPOINT_GIFT_I_PREV		= #{APPOINT_GIFT_I_PREV}		
			, APPOINT_GIFT_I_PREV_14	= #{APPOINT_GIFT_I_PREV_14}	
			, APPOINT_GIFT_I			= #{APPOINT_GIFT_I}			
			, ASS_GIFT_I_PREV			= #{ASS_GIFT_I_PREV}			
			, ASS_GIFT_I_PREV_14		= #{ASS_GIFT_I_PREV_14}		
			, ASS_GIFT_I				= #{ASS_GIFT_I}				
			, P3_TAX_DED_I				= #{P3_TAX_DED_I}				
			, HOUS_INTER_I				= #{HOUS_INTER_I}				
			, FORE_INCOME_I				= #{FORE_INCOME_I}				
			, FORE_TAX_I				= #{FORE_TAX_I}				
			, MON_RENT_I				= #{MON_RENT_I}				
			, FORE_SINGLE_YN			= #{FORE_SINGLE_YN}			
			, FOREIGN_DISPATCH_YN		= #{FOREIGN_DISPATCH_YN}		
			, HOUSEHOLDER_YN			= #{HOUSEHOLDER_YN}			
			, HALFWAY_TYPE				= #{HALFWAY_TYPE}				
			, NONTAX_FR					= #{NONTAX_FR}					
			, NONTAX_TO					= #{NONTAX_TO}		
			, UPDATE_DB_USER			= #{S_USER_ID}			
			, UPDATE_DB_TIME			= GETDATE()			
		WHERE COMP_CODE = #{S_COMP_CODE} 
		  AND PERSON_NUMB = #{PERSON_NUMB} 
		  AND YEAR_YYYY= #{YEAR_YYYY} 
		ELSE
		INSERT INTO HAD400T 
		(	    	  
			 COMP_CODE							
			,YEAR_YYYY					    
			,PERSON_NUMB				    
			,INCOME_SUPP_TOTAL_I		
			,NOW_PAY_TOT_I				  
			,NOW_BONUS_TOTAL_I			
			,NOW_ADD_BONUS_I			  
			,NOW_STOCK_PROFIT_I		  
			,NOW_OWNER_STOCK_DRAW_I	
			,NOW_OF_RETR_OVER_I	    
			,OLD_PAY_TOT_I				  
			,OLD_BONUS_TOTAL_I			
			,OLD_ADD_BONUS_I			  
			,OLD_STOCK_PROFIT_I		  
			,OLD_OWNER_STOCK_DRAW_I	
			,OLD_OF_RETR_OVER_I	    
			,NAP_PAY_TOT_I				  
			,NAP_BONUS_TOTAL_I			
			,INCOME_DED_I				    
			,EARN_INCOME_I				  
			,PER_DED_I					    
			,SPOUSE					        
			,SUPP_NUM					      
			,SUPP_NUM_1				      
			,SUPP_NUM_4				      
			,SUPP_NUM_5				      
			,SUPP_NUM_6				      
			,SUPP_NUM_7				      
			,SUPP_NUM_8				      
			,AGED_NUM					      
			,DEFORM_NUM				      
			,MANY_CHILD_NUM			    
			,BRING_CHILD_NUM			  
			,BIRTH_ADOPT_NUM			  
			,WOMAN						      
			,ONE_PARENT           
			,BIRTH_ADOPT_NUM1			
			,BIRTH_ADOPT_NUM2
			,BIRTH_ADOPT_NUM3  
			,ANU_I						      
			,ANU_ADD_I					    
			,PUBLIC_PENS_I				  
			,SOLDIER_PENS_I			    
			,SCH_PENS_I				      
			,POST_PENS_I				    
			,MED_PREMINM_I				  
			,MED_PREMINM_ADD_I			
			,HIRE_INSUR_I				    
			,HOUS_AMOUNT_TOT_I			
			,HOUS_AMOUNT_TOT_I_2		
			,HOUS_AMOUNT_INTER_I_2	
			,HOUS_AMOUNT_INTER_I		
			,HOUS_AMOUNT_INTER_I_3	
			,FIXED_RATE_LOAN			  
			,ETC_LOAN					      
			,HOUS_AMOUNT_INTER_I_6	
			,HOUS_AMOUNT_INTER_I_7	
			,HOUS_AMOUNT_INTER_I_8	
			,HOUS_AMOUNT_INTER_I_9	
			,PRIV_PENS_I				    
			,HOUS_BU_AMT				    
			,HOUS_BU_ADD_AMT			  
			,HOUS_WORK_AMT				  
			,HOUS_AMOUNT_I				  
			,HOUS_AMOUNT_ADD_I			
			,CARD_USE_I				      
			,CASH_USE_I				      
			,DEBIT_CARD_USE_I			  
			,TRA_MARKET_USE_I			  
			,TRAFFIC_USE_I  			  
			
			,COMP_PREMINUM 			    
			,COMP_PREMINUM_I			  
			,INVESTMENT_I				    
			,INVESTMENT_I3				  
			,INVESTMENT_I4				  
			,INVESTMENT_I2					
			,INVESTMENT_I5					
			,INVESTMENT_I6					
			,INVESTMENT_I7					
			,INVESTMENT_I8					
			,INVESTMENT_I9					
			,INVESTMENT_I10				  
			,INVESTMENT_I11				  
			,STAFF_STOCK_I				  
			,EMPLOY_WORKER_I			  
			,LONG_INVEST_STOCK_I		
			,INCOME_REDU_I				  
			,TAXES_REDU_I				    
			,SCI_DEDUC_I				    
			,RETIRE_PENS_I				  
			,PENS_I					        
			,ETC_INSUR_I				    
			,DEFORM_INSUR_I			    
			,MY_MED_DED_I				    
			,SENIOR_MED_I				    
			,DEFORM_MED_I				    
			,SURGERY_MED_I				  
			,MED_TOTAL_I				    
			,PER_EDUC_I				      
			,UNIV_EDUC_NUM				  
			,UNIV_EDUC_I				    
			,STUD_EDUC_NUM				  
			,STUD_EDUC_I				    
			,KIND_EDU_NUM				    
			,KIND_EDUC_I				    
			,DEFORM_EDUC_NUM 			  
			,DEFORM_EDUC_I	
			,FIELD_EDUC_I			  
			,PER_EDUC_DED_I			    
			,UNIV_EDUC_DED_I			  
			,STUD_EDUC_DED_I			  
			,KIND_EDUC_DED_I			  
			,DEFORM_EDUC_DED_I	
			,FIELD_EDUC_DED_I		
			,POLICY_INDED				    
			,POLICY_GIFT_I				  
			,LEGAL_GIFT_I_PREV			
			,LEGAL_GIFT_I_PREV_14		
			,LEGAL_GIFT_I				    
			,PRIV_GIFT_I_PREV			  
			,PRIV_GIFT_I				    
			,PUBLIC_GIFT_I_PREV		  
			,PUBLIC_GIFT_I				  
			,STAFF_GIFT_I				    
			,APPOINT_GIFT_I_PREV		
			,APPOINT_GIFT_I_PREV_14	
			,APPOINT_GIFT_I			    
			,ASS_GIFT_I_PREV			  
			,ASS_GIFT_I_PREV_14		  
			,ASS_GIFT_I				      
			,P3_TAX_DED_I				    
			,HOUS_INTER_I				    
			,FORE_INCOME_I				  
			,FORE_TAX_I				      
			,MON_RENT_I				      
			,FORE_SINGLE_YN			    
			,FOREIGN_DISPATCH_YN		
			,HOUSEHOLDER_YN			    
			,HALFWAY_TYPE				    
			,NONTAX_FR					    
			,NONTAX_TO					    
			,INSERT_DB_USER			    
			,INSERT_DB_TIME			    
			,UPDATE_DB_USER			    
			,UPDATE_DB_TIME			    
		)VALUES (
			  #{S_COMP_CODE}					    
			, #{YEAR_YYYY}					      
			, #{PERSON_NUMB}				      
			, #{INCOME_SUPP_TOTAL_I}		  
			, #{NOW_PAY_TOT_I}				    
			, #{NOW_BONUS_TOTAL_I}			  
			, #{NOW_ADD_BONUS_I}			    
			, #{NOW_STOCK_PROFIT_I}		    
			, #{NOW_OWNER_STOCK_DRAW_I}	  
			, #{NOW_OF_RETR_OVER_I}	      
			, #{OLD_PAY_TOT_I}				    
			, #{OLD_BONUS_TOTAL_I}			  
			, #{OLD_ADD_BONUS_I}			    
			, #{OLD_STOCK_PROFIT_I}		    
			, #{OLD_OWNER_STOCK_DRAW_I}	  
			, #{OLD_OF_RETR_OVER_I}	      
			, #{NAP_PAY_TOT_I}				    
			, #{NAP_BONUS_TOTAL_I}			  
			, #{INCOME_DED_I}				      
			, #{EARN_INCOME_I}				    
			, #{PER_DED_I}					      
			, #{SPOUSE}					          
			, #{SUPP_NUM}					        
			, #{SUPP_NUM_1}				          
			, #{SUPP_NUM_4}				          
			, #{SUPP_NUM_5}				          
			, #{SUPP_NUM_6}				          
			, #{SUPP_NUM_7}				          
			, #{SUPP_NUM_8}				          
			, #{AGED_NUM}					          
			, #{DEFORM_NUM}				          
			, #{MANY_CHILD_NUM}			        
			, #{BRING_CHILD_NUM}			    
			, #{BIRTH_ADOPT_NUM}			    
			, #{WOMAN}						        
			, #{ONE_PARENT} 
			, #{BIRTH_ADOPT_NUM1}				
			, #{BIRTH_ADOPT_NUM2}
			, #{BIRTH_ADOPT_NUM3}		               
			, #{ANU_I}						        
			, #{ANU_ADD_I}					      
			, #{PUBLIC_PENS_I}				    
			, #{SOLDIER_PENS_I}			        
			, #{SCH_PENS_I}				          
			, #{POST_PENS_I}				      
			, #{MED_PREMINM_I}				    
			, #{MED_PREMINM_ADD_I}			  
			, #{HIRE_INSUR_I}				        
			, #{HOUS_AMOUNT_TOT_I}			  
			, #{HOUS_AMOUNT_TOT_I_2}		  
			, #{HOUS_AMOUNT_INTER_I_2}		
			, #{HOUS_AMOUNT_INTER_I}		  
			, #{HOUS_AMOUNT_INTER_I_3}		
			, #{FIXED_RATE_LOAN}			    
			, #{ETC_LOAN}					          
			, #{HOUS_AMOUNT_INTER_I_6}		
			, #{HOUS_AMOUNT_INTER_I_7}		
			, #{HOUS_AMOUNT_INTER_I_8}		
			, #{HOUS_AMOUNT_INTER_I_9}		
			, #{PRIV_PENS_I}				      
			, #{HOUS_BU_AMT}				      
			, #{HOUS_BU_ADD_AMT}			    
			, #{HOUS_WORK_AMT}				    
			, #{HOUS_AMOUNT_I}				    
			, #{HOUS_AMOUNT_ADD_I}			  
			, #{CARD_USE_I}				          
			, #{CASH_USE_I}				          
			, #{DEBIT_CARD_USE_I}			      
			, #{TRA_MARKET_USE_I}			      
			, #{TRAFFIC_USE_I}  			    
			
			, #{COMP_PREMINUM} 			        
			, #{COMP_PREMINUM_I}			    
			, #{INVESTMENT_I}				        
			, #{INVESTMENT_I3}				    
			, #{INVESTMENT_I4}				    
			, #{INVESTMENT_I2}					  
			, #{INVESTMENT_I5}					  
			, #{INVESTMENT_I6}					  
			, #{INVESTMENT_I7}					  
			, #{INVESTMENT_I8}					  
			, #{INVESTMENT_I9}					  
			, #{INVESTMENT_I10}				      
			, #{INVESTMENT_I11}				      
			, #{STAFF_STOCK_I}				    
			, #{EMPLOY_WORKER_I}			    
			, #{LONG_INVEST_STOCK_I}		  
			, #{INCOME_REDU_I}				    
			, #{TAXES_REDU_I}				        
			, #{SCI_DEDUC_I}				      
			, #{RETIRE_PENS_I}				    
			, #{PENS_I}					            
			, #{ETC_INSUR_I}				      
			, #{DEFORM_INSUR_I}			        
			, #{MY_MED_DED_I}				        
			, #{SENIOR_MED_I}				        
			, #{DEFORM_MED_I}				        
			, #{SURGERY_MED_I}				    
			, #{MED_TOTAL_I}				      
			, #{PER_EDUC_I}				          
			, #{UNIV_EDUC_NUM}				    
			, #{UNIV_EDUC_I}				      
			, #{STUD_EDUC_NUM}				    
			, #{STUD_EDUC_I}				      
			, #{KIND_EDU_NUM}				        
			, #{KIND_EDUC_I}				      
			, #{DEFORM_EDUC_NUM }			      
			, #{DEFORM_EDUC_I}		
			, #{FIELD_EDUC_I}			    
			, #{PER_EDUC_DED_I}			        
			, #{UNIV_EDUC_DED_I}			    
			, #{STUD_EDUC_DED_I}			    
			, #{KIND_EDUC_DED_I}			    
			, #{DEFORM_EDUC_DED_I}	
			, #{FIELD_EDUC_DED_I}		  
			, #{POLICY_INDED}				        
			, #{POLICY_GIFT_I}				    
			, #{LEGAL_GIFT_I_PREV}			  
			, #{LEGAL_GIFT_I_PREV_14}		    
			, #{LEGAL_GIFT_I}				        
			, #{PRIV_GIFT_I_PREV}			      
			, #{PRIV_GIFT_I}				      
			, #{PUBLIC_GIFT_I_PREV}		      
			, #{PUBLIC_GIFT_I}				    
			, #{STAFF_GIFT_I}				        
			, #{APPOINT_GIFT_I_PREV}		  
			, #{APPOINT_GIFT_I_PREV_14}	    
			, #{APPOINT_GIFT_I}			        
			, #{ASS_GIFT_I_PREV}			    
			, #{ASS_GIFT_I_PREV_14}		      
			, #{ASS_GIFT_I}				          
			, #{P3_TAX_DED_I}				        
			, #{HOUS_INTER_I}				        
			, #{FORE_INCOME_I}				    
			, #{FORE_TAX_I}				          
			, #{MON_RENT_I}				          
			, #{FORE_SINGLE_YN}			        
			, #{FOREIGN_DISPATCH_YN}		  
			, #{HOUSEHOLDER_YN}			        
			, #{HALFWAY_TYPE}				        
			, #{NONTAX_FR}					      
			, #{NONTAX_TO}					      
			, #{S_USER_ID}			            
			, GETDATE()			                
			, #{S_USER_ID}			            
			, GETDATE()			                
	 )
	</update>
	<update id="had617ukrServiceImpl.save600"  parameterType="rMap">
		IF EXISTS (SELECT PERSON_NUMB 
				    FROM HAD600T 
				    WHERE COMP_CODE = #{S_COMP_CODE} 
				      AND PERSON_NUMB = #{PERSON_NUMB} 
				      AND YEAR_YYYY= #{YEAR_YYYY} )
			UPDATE HAD600T
			SET 	  INCOME_SUPP_TOTAL_I				= #{INCOME_SUPP_TOTAL_I}				
					, PAY_TOTAL_I						= #{PAY_TOTAL_I}								
					, BONUS_TOTAL_I						= #{BONUS_TOTAL_I}							
					, ADD_BONUS_I						= #{ADD_BONUS_I}								
					, STOCK_PROFIT_I					= #{STOCK_PROFIT_I}						
					, OWNER_STOCK_DRAW_I				= #{OWNER_STOCK_DRAW_I}				
					, OF_RETR_OVER_I                    = #{OF_RETR_OVER_I}            
					, NOW_PAY_TOT_I						= #{NOW_PAY_TOT_I}							
					, NOW_BONUS_TOTAL_I					= #{NOW_BONUS_TOTAL_I}					
					, NOW_ADD_BONUS_I					= #{NOW_ADD_BONUS_I}						
					, NOW_STOCK_PROFIT_I				= #{NOW_STOCK_PROFIT_I}				
					, NOW_OWNER_STOCK_DRAW_I		  	= #{NOW_OWNER_STOCK_DRAW_I}		
					, NOW_OF_RETR_OVER_I                = #{NOW_OF_RETR_OVER_I}        
					, OLD_PAY_TOT_I						= #{OLD_PAY_TOT_I}							
					, OLD_BONUS_TOTAL_I					= #{OLD_BONUS_TOTAL_I}					
					, OLD_ADD_BONUS_I					= #{OLD_ADD_BONUS_I}						
					, OLD_STOCK_PROFIT_I				= #{OLD_STOCK_PROFIT_I}				
					, OLD_OWNER_STOCK_DRAW_I		  	= #{OLD_OWNER_STOCK_DRAW_I}		
					, OLD_OF_RETR_OVER_I                = #{OLD_OF_RETR_OVER_I}        
					, NAP_PAY_TOT_I						= #{NAP_PAY_TOT_I}							
					, NAP_BONUS_TOTAL_I					= #{NAP_BONUS_TOTAL_I}					
					, INCOME_DED_I						= #{INCOME_DED_I}							
					, EARN_INCOME_I						= #{EARN_INCOME_I}							
					, PER_DED_I							= #{PER_DED_I}									
					, SPOUSE							= #{SPOUSE}										
					, SPOUSE_DED_I						= #{SPOUSE_DED_I}							
					, SUPP_NUM							= #{SUPP_NUM}									
					, SUPP_SUB_I						= #{SUPP_SUB_I}								
					, AGED_NUM							= #{AGED_NUM}									
					, DEFORM_NUM						= #{DEFORM_NUM}								
					, MANY_CHILD_NUM					= #{MANY_CHILD_NUM}						
					, BRING_CHILD_NUM					= #{BRING_CHILD_NUM}						
					, BIRTH_ADOPT_NUM					= #{BIRTH_ADOPT_NUM}						
					, WOMAN								= #{WOMAN}											
					, ONE_PARENT						= #{ONE_PARENT}		
					, BIRTH_ADOPT_NUM1					= #{BIRTH_ADOPT_NUM1}				
					, BIRTH_ADOPT_NUM2					= #{BIRTH_ADOPT_NUM2}
					, BIRTH_ADOPT_NUM3					= #{BIRTH_ADOPT_NUM3}		
					, AGED_DED_I						= #{AGED_DED_I}								
					, DEFORM_DED_I						= #{DEFORM_DED_I}							
					, WOMAN_DED_I						= #{WOMAN_DED_I}								
					, ONE_PARENT_DED_I					= #{ONE_PARENT_DED_I}					
					, ANU_I								= #{ANU_I}											
					, ANU_ADD_I							= #{ANU_ADD_I}									
					, ANU_DED_I							= #{ANU_DED_I}									
					, PUBLIC_PENS_I						= #{PUBLIC_PENS_I}							
					, SOLDIER_PENS_I					= #{SOLDIER_PENS_I}						
					, SCH_PENS_I						= #{SCH_PENS_I}								
					, POST_PENS_I						= #{POST_PENS_I}								
					, MED_PREMINM_I						= #{MED_PREMINM_I}							
					, HIRE_INSUR_I						= #{HIRE_INSUR_I}							
					, HOUS_AMOUNT_I						= #{HOUS_AMOUNT_I}							
					, HOUS_AMOUNT_I_2					= #{HOUS_AMOUNT_I_2}						
					, MORTGAGE_RETURN_I_2				= #{MORTGAGE_RETURN_I_2}				
					, MORTGAGE_RETURN_I					= #{MORTGAGE_RETURN_I}					
					, MORTGAGE_RETURN_I_3				= #{MORTGAGE_RETURN_I_3}				
					, MORTGAGE_RETURN_I_5				= #{MORTGAGE_RETURN_I_5}				
					, MORTGAGE_RETURN_I_4				= #{MORTGAGE_RETURN_I_4}				
					, MORTGAGE_RETURN_I_6				= #{MORTGAGE_RETURN_I_6}				
					, MORTGAGE_RETURN_I_7				= #{MORTGAGE_RETURN_I_7}				
					, MORTGAGE_RETURN_I_8				= #{MORTGAGE_RETURN_I_8}				
					, MORTGAGE_RETURN_I_9				= #{MORTGAGE_RETURN_I_9}				
					, DED_INCOME_I						= #{DED_INCOME_I}							
					, DED_INCOME_I1						= #{DED_INCOME_I1}							
					, DED_INCOME_I2						= #{DED_INCOME_I2}							
					, PRIV_PENS_I						= #{PRIV_PENS_I}								
					, HOUS_BU_AMT						= #{HOUS_BU_AMT}								
					, HOUS_BU_ADD_AMT					= #{HOUS_BU_ADD_AMT}						
					, HOUS_WORK_AMT						= #{HOUS_WORK_AMT}							
					, HOUS_BU_AMOUNT_I					= #{HOUS_BU_AMOUNT_I}					
					, HOUS_BU_AMOUNT_ADD_I			  	= #{HOUS_BU_AMOUNT_ADD_I}			
					, CARD_DED_I						= #{CARD_DED_I}								
					, CARD_USE_I						= #{CARD_USE_I}								
					, CASH_USE_I						= #{CASH_USE_I}								
					, DEBIT_CARD_USE_I					= #{DEBIT_CARD_USE_I}					
					, TRA_MARKET_USE_I					= #{TRA_MARKET_USE_I}					
					, TRAFFIC_USE_I  					= #{TRAFFIC_USE_I}  						
						
					, COMP_PREMINUM     				= #{COMP_PREMINUM}     				
					, COMP_PREMINUM_DED_I				= #{COMP_PREMINUM_DED_I}				
					, INVESTMENT_DED_I					= #{INVESTMENT_DED_I}					
					, INVESTMENT_DED_I2					= #{INVESTMENT_DED_I2}					
					, INVESTMENT_DED_I3					= #{INVESTMENT_DED_I3}					
					, INVESTMENT_DED_I4					= #{INVESTMENT_DED_I4}					
					, STAFF_STOCK_DED_I					= #{STAFF_STOCK_DED_I}					
					, EMPLOY_WORKER_DED_I				= #{EMPLOY_WORKER_DED_I}				
					, LONG_INVEST_STOCK_DED_I			= #{LONG_INVEST_STOCK_DED_I}		
					, OVER_INCOME_DED_LMT				= #{OVER_INCOME_DED_LMT}				
					, TAX_STD_I							= #{TAX_STD_I}									
					, TAX_STD_I1						= #{TAX_STD_I1}								
					, TAX_STD_I2						= #{TAX_STD_I2}								
					, COMP_TAX_I						= #{COMP_TAX_I}								
					, COMP_TAX_I1						= #{COMP_TAX_I1}								
					, COMP_TAX_I2						= #{COMP_TAX_I2}								
					, INCOME_REDU_I						= #{INCOME_REDU_I}							
					, YOUTH_DED_I						= #{YOUTH_DED_I}								
					, YOUTH_DED_I3						= #{YOUTH_DED_I3}							
					, YOUTH_DED_I2						= #{YOUTH_DED_I2}							
					, YOUTH_DED_I_SUM	    			= #{YOUTH_DED_I_SUM}	    			
					, SKILL_DED_I						= #{SKILL_DED_I}								
					, TAXES_REDU_I						= #{TAXES_REDU_I}							
					, IN_TAX_DED_I						= #{IN_TAX_DED_I}							
					, CHILD_TAX_DED_I					= #{CHILD_TAX_DED_I}						
					, BRING_CHILD_DED_I					= #{BRING_CHILD_DED_I}					
					, BIRTH_ADOPT_I		 				= #{BIRTH_ADOPT_I}		 					
					, SCI_DEDUC_I						= #{SCI_DEDUC_I}								
					, RETIRE_PENS_I						= #{RETIRE_PENS_I}							
					, PENS_I							= #{PENS_I}										
					, SCI_TAX_DED_I1					= #{SCI_TAX_DED_I1}						
					, SCI_TAX_DED_I						= #{SCI_TAX_DED_I}							
					, RETIRE_TAX_DED_I1					= #{RETIRE_TAX_DED_I1}					
					, RETIRE_TAX_DED_I					= #{RETIRE_TAX_DED_I}					
					, PENS_TAX_DED_I1					= #{PENS_TAX_DED_I1}						
					, PENS_TAX_DED_I					= #{PENS_TAX_DED_I}						
					, ETC_INSUR_I						= #{ETC_INSUR_I}								
					, DEFORM_INSUR_I					= #{DEFORM_INSUR_I}						
					, ETC_INSUR_TAX_DED_I				= #{ETC_INSUR_TAX_DED_I}				
					, DEFORM_INSUR_TAX_DED_I		  	= #{DEFORM_INSUR_TAX_DED_I}		
					, MED_DED_I							= #{MED_DED_I}									
					, MY_MED_DED_I						= #{MY_MED_DED_I}							
					, SENIOR_MED_I						= #{SENIOR_MED_I}							
					, DEFORM_MED_I						= #{DEFORM_MED_I}							
					, SURGERY_MED_I						= #{SURGERY_MED_I}							
					, MED_TOTAL_I						= #{MED_TOTAL_I}								
					, MED_TAX_DED_I						= #{MED_TAX_DED_I}							
					, MY_MED_TAX_DED_I					= #{MY_MED_TAX_DED_I}					
					, SENIOR_MED_TAX_DED_I			  	= #{SENIOR_MED_TAX_DED_I}			
					, DEFORM_MED_TAX_DED_I			  	= #{DEFORM_MED_TAX_DED_I}			
					, SURGERY_MED_TAX_DED_I				= #{SURGERY_MED_TAX_DED_I}			
					, MED_TOTAL_TAX_DED_I				= #{MED_TOTAL_TAX_DED_I}				
					, EDUC_DED_I						= #{EDUC_DED_I}								
					, UNIV_EDUC_NUM						= #{UNIV_EDUC_NUM}							
					, STUD_EDUC_NUM						= #{STUD_EDUC_NUM}							
					, KIND_EDU_NUM						= #{KIND_EDU_NUM}							
					, PER_EDUC_DED_I					= #{PER_EDUC_DED_I}						
					, UNIV_EDUC_DED_I					= #{UNIV_EDUC_DED_I}						
					, STUD_EDUC_DED_I					= #{STUD_EDUC_DED_I}						
					, KIND_EDUC_DED_I					= #{KIND_EDUC_DED_I}						
					, DEFORM_EDUC_DED_I					= #{DEFORM_EDUC_DED_I}
					, FIELD_EDUC_DED_I					= #{FIELD_EDUC_DED_I}					
					, EDUC_TAX_DED_I					= #{EDUC_TAX_DED_I}						
					, PER_EDUC_TAX_DED_I				= #{PER_EDUC_TAX_DED_I}				
					, UNIV_EDUC_TAX_DED_I				= #{UNIV_EDUC_TAX_DED_I}				
					, STUD_EDUC_TAX_DED_I				= #{STUD_EDUC_TAX_DED_I}				
					, KIND_EDUC_TAX_DED_I				= #{KIND_EDUC_TAX_DED_I}				
					, DEFORM_EDUC_TAX_DED_I				= #{DEFORM_EDUC_TAX_DED_I}	
					, FIELD_EDUC_TAX_DED_I				= #{FIELD_EDUC_TAX_DED_I}			
					, POLICY_INDED						= #{POLICY_INDED}							
					, POLICY_GIFT_I						= #{POLICY_GIFT_I}							
					, LEGAL_GIFT_I_PREV					= #{LEGAL_GIFT_I_PREV}					
					, LEGAL_GIFT_I_PREV_14			  	= #{LEGAL_GIFT_I_PREV_14}			
					, LEGAL_GIFT_I						= #{LEGAL_GIFT_I}							
					, PRIV_GIFT_I_PREV					= #{PRIV_GIFT_I_PREV}					
					, PRIV_GIFT_I						= #{PRIV_GIFT_I}								
					, PUBLIC_GIFT_I_PREV				= #{PUBLIC_GIFT_I_PREV}				
					, PUBLIC_GIFT_I						= #{PUBLIC_GIFT_I}							
					, STAFF_GIFT_I						= #{STAFF_GIFT_I}							
					, APPOINT_GIFT_I_PREV				= #{APPOINT_GIFT_I_PREV}				
					, APPOINT_GIFT_I_PREV_14		  	= #{APPOINT_GIFT_I_PREV_14}		
					, APPOINT_GIFT_I					= #{APPOINT_GIFT_I}						
					, ASS_GIFT_I_PREV					= #{ASS_GIFT_I_PREV}						
					, ASS_GIFT_I_PREV_14				= #{ASS_GIFT_I_PREV_14}				
					, ASS_GIFT_I						= #{ASS_GIFT_I}								
					, POLICY_INDED_DED_AMT			  	= #{POLICY_INDED_DED_AMT}			
					, POLICY_GIFT_DED_AMT				= #{POLICY_GIFT_DED_AMT}				
					, LEGAL_DED_AMT						= #{LEGAL_DED_AMT}							
					, STAFF_DED_AMT						= #{STAFF_DED_AMT}							
					, APPOINT_ASS_TAX_DED_AMT			= #{APPOINT_ASS_TAX_DED_AMT}		
					, GIFT_DED_I						= #{GIFT_DED_I}								
					, LEGAL_GIFT_DED_I					= #{LEGAL_GIFT_DED_I}					
					, PRIV_GIFT_DED_I					= #{PRIV_GIFT_DED_I}						
					, PUBLIC_GIFT_DED_I					= #{PUBLIC_GIFT_DED_I}					
					, STAFF_GIFT_DED_I					= #{STAFF_GIFT_DED_I}					
					, APPOINT_GIFT_DED_I				= #{APPOINT_GIFT_DED_I}				
					, ASS_GIFT_DED_I					= #{ASS_GIFT_DED_I}						
					, GIFT_TAX_DED_I					= #{GIFT_TAX_DED_I}						
					, POLICY_INDED_TAX_DED_I		  	= #{POLICY_INDED_TAX_DED_I}		
					, POLICY_GIFT_TAX_DED_I				= #{POLICY_GIFT_TAX_DED_I}			
					, LEGAL_GIFT_TAX_DED_I			  	= #{LEGAL_GIFT_TAX_DED_I}			
					, STAFF_GIFT_TAX_DED_I			  	= #{STAFF_GIFT_TAX_DED_I}			
					, APPOINT_GIFT_TAX_DED_I		  	= #{APPOINT_GIFT_TAX_DED_I}		
					, ASS_GIFT_TAX_DED_I				= #{ASS_GIFT_TAX_DED_I}				
					, STD_TAX_DED_I						= #{STD_TAX_DED_I}							
					, NAP_TAX_DED_I						= #{NAP_TAX_DED_I}							
					, HOUS_INTER_I						= #{HOUS_INTER_I}							
					, OUTSIDE_INCOME_I					= #{OUTSIDE_INCOME_I}					
					, MON_RENT_I						= #{MON_RENT_I}								
					, DEF_IN_TAX_I						= #{DEF_IN_TAX_I}							
					, DEF_LOCAL_TAX_I					= #{DEF_LOCAL_TAX_I}						
					, DEF_SP_TAX_I						= #{DEF_SP_TAX_I}							
					, NOW_IN_TAX_I						= #{NOW_IN_TAX_I}							
					, NOW_LOCAL_TAX_I					= #{NOW_LOCAL_TAX_I}						
					, NOW_SP_TAX_I						= #{NOW_SP_TAX_I}							
					, PRE_IN_TAX_I						= #{PRE_IN_TAX_I}							
					, PRE_LOCAL_TAX_I					= #{PRE_LOCAL_TAX_I}						
					, PRE_SP_TAX_I						= #{PRE_SP_TAX_I}							
					, NAP_IN_TAX_I						= #{NAP_IN_TAX_I}							
					, NAP_LOCAL_TAX_I					= #{NAP_LOCAL_TAX_I}						
					, NAP_SP_TAX_I						= #{NAP_SP_TAX_I}							
					, IN_TAX_I							= #{IN_TAX_I}									
					, LOCAL_TAX_I						= #{LOCAL_TAX_I}								
					, SP_TAX_I							= #{SP_TAX_I}									
					, HALFWAY_TYPE						= #{HALFWAY_TYPE}							
					, HOUSEHOLDER_YN					= #{HOUSEHOLDER_YN}						
					, FOREIGN_DISPATCH_YN				= #{FOREIGN_DISPATCH_YN}				
					, FORE_SINGLE_YN					= #{FORE_SINGLE_YN}						
					, JOIN_DATE							= #{JOIN_DATE}									
					, RETR_DATE							= ISNULL(#{RETR_DATE},'00000000')									
					, DEPT_CODE							= #{DEPT_CODE}									
					, DEPT_NAME							= #{DEPT_NAME}						
					, UPDATE_DB_USER					= #{S_USER_ID}						
					, UPDATE_DB_TIME					= GETDATE()	
			WHERE COMP_CODE = #{S_COMP_CODE} 
			      AND PERSON_NUMB = #{PERSON_NUMB} 
			      AND YEAR_YYYY= #{YEAR_YYYY} 
		ELSE 
			INSERT INTO HAD600T  (
				 COMP_CODE									    
				, YEAR_YYYY									    
				, PERSON_NUMB								    
				, INCOME_SUPP_TOTAL_I				    
				, PAY_TOTAL_I								    
				, BONUS_TOTAL_I							    
				, ADD_BONUS_I								    
				, STOCK_PROFIT_I						    
				, OWNER_STOCK_DRAW_I				    
				, OF_RETR_OVER_I                
				, NOW_PAY_TOT_I							    
				, NOW_BONUS_TOTAL_I					    
				, NOW_ADD_BONUS_I						    
				, NOW_STOCK_PROFIT_I				    
				, NOW_OWNER_STOCK_DRAW_I		    
				, NOW_OF_RETR_OVER_I            
				, OLD_PAY_TOT_I							    
				, OLD_BONUS_TOTAL_I					    
				, OLD_ADD_BONUS_I						    
				, OLD_STOCK_PROFIT_I				    
				, OLD_OWNER_STOCK_DRAW_I		    
				, OLD_OF_RETR_OVER_I            
				, NAP_PAY_TOT_I							    
				, NAP_BONUS_TOTAL_I					    
				, INCOME_DED_I							    
				, EARN_INCOME_I							    
				, PER_DED_I									    
				, SPOUSE										    
				, SPOUSE_DED_I							    
				, SUPP_NUM									    
				, SUPP_SUB_I								    
				, AGED_NUM									    
				, DEFORM_NUM								    
				, MANY_CHILD_NUM						    
				, BRING_CHILD_NUM						    
				, BIRTH_ADOPT_NUM						    
				, WOMAN											    
				, ONE_PARENT	
				, BIRTH_ADOPT_NUM1	
				, BIRTH_ADOPT_NUM2	
				, BIRTH_ADOPT_NUM3				    
				, AGED_DED_I								    
				, DEFORM_DED_I							    
				, WOMAN_DED_I								    
				, ONE_PARENT_DED_I					    
				, ANU_I											    
				, ANU_ADD_I									    
				, ANU_DED_I									    
				, PUBLIC_PENS_I							    
				, SOLDIER_PENS_I						    
				, SCH_PENS_I								    
				, POST_PENS_I								    
				, MED_PREMINM_I							    
				, HIRE_INSUR_I							    
				, HOUS_AMOUNT_I							    
				, HOUS_AMOUNT_I_2						    
				, MORTGAGE_RETURN_I_2				    
				, MORTGAGE_RETURN_I					    
				, MORTGAGE_RETURN_I_3				    
				, MORTGAGE_RETURN_I_5				    
				, MORTGAGE_RETURN_I_4				    
				, MORTGAGE_RETURN_I_6				    
				, MORTGAGE_RETURN_I_7				    
				, MORTGAGE_RETURN_I_8				    
				, MORTGAGE_RETURN_I_9				    
				, DED_INCOME_I							    
				, DED_INCOME_I1							    
				, DED_INCOME_I2							    
				, PRIV_PENS_I								    
				, HOUS_BU_AMT								    
				, HOUS_BU_ADD_AMT						    
				, HOUS_WORK_AMT							    
				, HOUS_BU_AMOUNT_I					    
				, HOUS_BU_AMOUNT_ADD_I			    
				, CARD_DED_I								    
				, CARD_USE_I								    
				, CASH_USE_I								    
				, DEBIT_CARD_USE_I					    
				, TRA_MARKET_USE_I					    
				, TRAFFIC_USE_I  						    
				 
				, COMP_PREMINUM     				    
				, COMP_PREMINUM_DED_I				    
				, INVESTMENT_DED_I					    
				, INVESTMENT_DED_I2					    
				, INVESTMENT_DED_I3					    
				, INVESTMENT_DED_I4					    
				, STAFF_STOCK_DED_I					    
				, EMPLOY_WORKER_DED_I				    
				, LONG_INVEST_STOCK_DED_I		    
				, OVER_INCOME_DED_LMT				    
				, TAX_STD_I									    
				, TAX_STD_I1								    
				, TAX_STD_I2								    
				, COMP_TAX_I								    
				, COMP_TAX_I1								    
				, COMP_TAX_I2								    
				, INCOME_REDU_I							    
				, YOUTH_DED_I								    
				, YOUTH_DED_I3							    
				, YOUTH_DED_I2							    
				, YOUTH_DED_I_SUM	    			    
				, SKILL_DED_I								    
				, TAXES_REDU_I							    
				, IN_TAX_DED_I							    
				, CHILD_TAX_DED_I						    
				, BRING_CHILD_DED_I					    
				, BIRTH_ADOPT_I		 					    
				, SCI_DEDUC_I								    
				, RETIRE_PENS_I							    
				, PENS_I										    
				, SCI_TAX_DED_I1						    
				, SCI_TAX_DED_I							    
				, RETIRE_TAX_DED_I1					    
				, RETIRE_TAX_DED_I					    
				, PENS_TAX_DED_I1						    
				, PENS_TAX_DED_I						    
				, ETC_INSUR_I								    
				, DEFORM_INSUR_I						    
				, ETC_INSUR_TAX_DED_I				    
				, DEFORM_INSUR_TAX_DED_I		    
				, MED_DED_I									    
				, MY_MED_DED_I							    
				, SENIOR_MED_I							    
				, DEFORM_MED_I							    
				, SURGERY_MED_I							    
				, MED_TOTAL_I								    
				, MED_TAX_DED_I							    
				, MY_MED_TAX_DED_I					    
				, SENIOR_MED_TAX_DED_I			    
				, DEFORM_MED_TAX_DED_I			    
				, SURGERY_MED_TAX_DED_I			    
				, MED_TOTAL_TAX_DED_I				    
				, EDUC_DED_I								    
				, UNIV_EDUC_NUM							    
				, STUD_EDUC_NUM							    
				, KIND_EDU_NUM							    
				, PER_EDUC_DED_I						    
				, UNIV_EDUC_DED_I						    
				, STUD_EDUC_DED_I						    
				, KIND_EDUC_DED_I						    
				, DEFORM_EDUC_DED_I			
				, FIELD_EDUC_DED_I		    
				, EDUC_TAX_DED_I						    
				, PER_EDUC_TAX_DED_I				    
				, UNIV_EDUC_TAX_DED_I				    
				, STUD_EDUC_TAX_DED_I				    
				, KIND_EDUC_TAX_DED_I				    
				, DEFORM_EDUC_TAX_DED_I	
				, FIELD_EDUC_TAX_DED_I		    
				, POLICY_INDED							    
				, POLICY_GIFT_I							    
				, LEGAL_GIFT_I_PREV					    
				, LEGAL_GIFT_I_PREV_14			    
				, LEGAL_GIFT_I							    
				, PRIV_GIFT_I_PREV					    
				, PRIV_GIFT_I								    
				, PUBLIC_GIFT_I_PREV				    
				, PUBLIC_GIFT_I							    
				, STAFF_GIFT_I							    
				, APPOINT_GIFT_I_PREV				    
				, APPOINT_GIFT_I_PREV_14		    
				, APPOINT_GIFT_I						    
				, ASS_GIFT_I_PREV						    
				, ASS_GIFT_I_PREV_14				    
				, ASS_GIFT_I								    
				, POLICY_INDED_DED_AMT			    
				, POLICY_GIFT_DED_AMT				    
				, LEGAL_DED_AMT							    
				, STAFF_DED_AMT							    
				, APPOINT_ASS_TAX_DED_AMT		    
				, GIFT_DED_I								    
				, LEGAL_GIFT_DED_I					    
				, PRIV_GIFT_DED_I						    
				, PUBLIC_GIFT_DED_I					    
				, STAFF_GIFT_DED_I					    
				, APPOINT_GIFT_DED_I				    
				, ASS_GIFT_DED_I						    
				, GIFT_TAX_DED_I						    
				, POLICY_INDED_TAX_DED_I		    
				, POLICY_GIFT_TAX_DED_I			    
				, LEGAL_GIFT_TAX_DED_I			    
				, STAFF_GIFT_TAX_DED_I			    
				, APPOINT_GIFT_TAX_DED_I		    
				, ASS_GIFT_TAX_DED_I				    
				, STD_TAX_DED_I							    
				, NAP_TAX_DED_I							    
				, HOUS_INTER_I							    
				, OUTSIDE_INCOME_I					    
				, MON_RENT_I								    
				, DEF_IN_TAX_I							    
				, DEF_LOCAL_TAX_I						    
				, DEF_SP_TAX_I							    
				, NOW_IN_TAX_I							    
				, NOW_LOCAL_TAX_I						    
				, NOW_SP_TAX_I							    
				, PRE_IN_TAX_I							    
				, PRE_LOCAL_TAX_I						    
				, PRE_SP_TAX_I							    
				, NAP_IN_TAX_I							    
				, NAP_LOCAL_TAX_I						    
				, NAP_SP_TAX_I							    
				, IN_TAX_I									    
				, LOCAL_TAX_I								    
				, SP_TAX_I									    
				, HALFWAY_TYPE							      
				, HOUSEHOLDER_YN						      
				, FOREIGN_DISPATCH_YN				    
				, FORE_SINGLE_YN						      
				, JOIN_DATE									    
				, RETR_DATE									    
				, DEPT_CODE									    
				, DEPT_NAME									    
				, INSERT_DB_USER						    
				, INSERT_DB_TIME						    
				, UPDATE_DB_USER						    
				, UPDATE_DB_TIME						    
			) VALUES (
				 #{S_COMP_CODE}									
			   , #{YEAR_YYYY}									
			   , #{PERSON_NUMB}								
			   , #{INCOME_SUPP_TOTAL_I}				
			   , #{PAY_TOTAL_I}								
			   , #{BONUS_TOTAL_I}							
			   , #{ADD_BONUS_I}								
			   , #{STOCK_PROFIT_I}						
			   , #{OWNER_STOCK_DRAW_I}				
			   , #{OF_RETR_OVER_I}            
			   , #{NOW_PAY_TOT_I}							
			   , #{NOW_BONUS_TOTAL_I}					
			   , #{NOW_ADD_BONUS_I}						
			   , #{NOW_STOCK_PROFIT_I}				
			   , #{NOW_OWNER_STOCK_DRAW_I}		
			   , #{NOW_OF_RETR_OVER_I}        
			   , #{OLD_PAY_TOT_I}							
			   , #{OLD_BONUS_TOTAL_I}					
			   , #{OLD_ADD_BONUS_I}						
			   , #{OLD_STOCK_PROFIT_I}				
			   , #{OLD_OWNER_STOCK_DRAW_I}		
			   , #{OLD_OF_RETR_OVER_I}        
			   , #{NAP_PAY_TOT_I}							
			   , #{NAP_BONUS_TOTAL_I}					
			   , #{INCOME_DED_I}							
			   , #{EARN_INCOME_I}							
			   , #{PER_DED_I}									
			   , #{SPOUSE}										
			   , #{SPOUSE_DED_I}							
			   , #{SUPP_NUM}									
			   , #{SUPP_SUB_I}								
			   , #{AGED_NUM}									
			   , #{DEFORM_NUM}								
			   , #{MANY_CHILD_NUM}						
			   , #{BRING_CHILD_NUM}						
			   , #{BIRTH_ADOPT_NUM}						
			   , #{WOMAN}											
			   , #{ONE_PARENT}	
			   , #{BIRTH_ADOPT_NUM1}	
			   , #{BIRTH_ADOPT_NUM2}
			   , #{BIRTH_ADOPT_NUM3}						
			   , #{AGED_DED_I}								
			   , #{DEFORM_DED_I}							
			   , #{WOMAN_DED_I}								
			   , #{ONE_PARENT_DED_I}					
			   , #{ANU_I}											
			   , #{ANU_ADD_I}									
			   , #{ANU_DED_I}									
			   , #{PUBLIC_PENS_I}							
			   , #{SOLDIER_PENS_I}						
			   , #{SCH_PENS_I}								
			   , #{POST_PENS_I}								
			   , #{MED_PREMINM_I}							
			   , #{HIRE_INSUR_I}							
			   , #{HOUS_AMOUNT_I}							
			   , #{HOUS_AMOUNT_I_2}						
			   , #{MORTGAGE_RETURN_I_2}				
			   , #{MORTGAGE_RETURN_I}					
			   , #{MORTGAGE_RETURN_I_3}				
			   , #{MORTGAGE_RETURN_I_5}				
			   , #{MORTGAGE_RETURN_I_4}				
			   , #{MORTGAGE_RETURN_I_6}				
			   , #{MORTGAGE_RETURN_I_7}				
			   , #{MORTGAGE_RETURN_I_8}				
			   , #{MORTGAGE_RETURN_I_9}				
			   , #{DED_INCOME_I}							
			   , #{DED_INCOME_I1}							
			   , #{DED_INCOME_I2}							
			   , #{PRIV_PENS_I}								
			   , #{HOUS_BU_AMT}								
			   , #{HOUS_BU_ADD_AMT}						
			   , #{HOUS_WORK_AMT}							
			   , #{HOUS_BU_AMOUNT_I}					
			   , #{HOUS_BU_AMOUNT_ADD_I}			
			   , #{CARD_DED_I}								
			   , #{CARD_USE_I}								
			   , #{CASH_USE_I}								
			   , #{DEBIT_CARD_USE_I}					
			   , #{TRA_MARKET_USE_I}					
			   , #{TRAFFIC_USE_I}  						
			   
			   , #{COMP_PREMINUM}     				
			   , #{COMP_PREMINUM_DED_I}				
			   , #{INVESTMENT_DED_I}					
			   , #{INVESTMENT_DED_I2}					
			   , #{INVESTMENT_DED_I3}					
			   , #{INVESTMENT_DED_I4}					
			   , #{STAFF_STOCK_DED_I}					
			   , #{EMPLOY_WORKER_DED_I}				
			   , #{LONG_INVEST_STOCK_DED_I}		
			   , #{OVER_INCOME_DED_LMT}				
			   , #{TAX_STD_I}									
			   , #{TAX_STD_I1}								
			   , #{TAX_STD_I2}								
			   , #{COMP_TAX_I}								
			   , #{COMP_TAX_I1}								
			   , #{COMP_TAX_I2}								
			   , #{INCOME_REDU_I}							
			   , #{YOUTH_DED_I}								
			   , #{YOUTH_DED_I3}							
			   , #{YOUTH_DED_I2}							
			   , #{YOUTH_DED_I_SUM}	    			
			   , #{SKILL_DED_I}								
			   , #{TAXES_REDU_I}							
			   , #{IN_TAX_DED_I}							
			   , #{CHILD_TAX_DED_I}						
			   , #{BRING_CHILD_DED_I}					
			   , #{BIRTH_ADOPT_I}		 					
			   , #{SCI_DEDUC_I}								
			   , #{RETIRE_PENS_I}							
			   , #{PENS_I}										
			   , #{SCI_TAX_DED_I1}						
			   , #{SCI_TAX_DED_I}							
			   , #{RETIRE_TAX_DED_I1}					
			   , #{RETIRE_TAX_DED_I}					
			   , #{PENS_TAX_DED_I1}						
			   , #{PENS_TAX_DED_I}						
			   , #{ETC_INSUR_I}								
			   , #{DEFORM_INSUR_I}						
			   , #{ETC_INSUR_TAX_DED_I}				
			   , #{DEFORM_INSUR_TAX_DED_I}		
			   , #{MED_DED_I}									
			   , #{MY_MED_DED_I}							
			   , #{SENIOR_MED_I}							
			   , #{DEFORM_MED_I}							
			   , #{SURGERY_MED_I}							
			   , #{MED_TOTAL_I}								
			   , #{MED_TAX_DED_I}							
			   , #{MY_MED_TAX_DED_I}					
			   , #{SENIOR_MED_TAX_DED_I}			
			   , #{DEFORM_MED_TAX_DED_I}			
			   , #{SURGERY_MED_TAX_DED_I}			
			   , #{MED_TOTAL_TAX_DED_I}				
			   , #{EDUC_DED_I}								
			   , #{UNIV_EDUC_NUM}							
			   , #{STUD_EDUC_NUM}							
			   , #{KIND_EDU_NUM}							
			   , #{PER_EDUC_DED_I}						
			   , #{UNIV_EDUC_DED_I}						
			   , #{STUD_EDUC_DED_I}						
			   , #{KIND_EDUC_DED_I}						
			   , #{DEFORM_EDUC_DED_I}
			   , #{FIELD_EDUC_DED_I}				
			   , #{EDUC_TAX_DED_I}						
			   , #{PER_EDUC_TAX_DED_I}				
			   , #{UNIV_EDUC_TAX_DED_I}				
			   , #{STUD_EDUC_TAX_DED_I}				
			   , #{KIND_EDUC_TAX_DED_I}				
			   , #{DEFORM_EDUC_TAX_DED_I}	
			   , #{FIELD_EDUC_TAX_DED_I}			
			   , #{POLICY_INDED}							
			   , #{POLICY_GIFT_I}							
			   , #{LEGAL_GIFT_I_PREV}					
			   , #{LEGAL_GIFT_I_PREV_14}			
			   , #{LEGAL_GIFT_I}							
			   , #{PRIV_GIFT_I_PREV}					
			   , #{PRIV_GIFT_I}								
			   , #{PUBLIC_GIFT_I_PREV}				
			   , #{PUBLIC_GIFT_I}							
			   , #{STAFF_GIFT_I}							
			   , #{APPOINT_GIFT_I_PREV}				
			   , #{APPOINT_GIFT_I_PREV_14}		
			   , #{APPOINT_GIFT_I}						
			   , #{ASS_GIFT_I_PREV}						
			   , #{ASS_GIFT_I_PREV_14}				
			   , #{ASS_GIFT_I}								
			   , #{POLICY_INDED_DED_AMT}			
			   , #{POLICY_GIFT_DED_AMT}				
			   , #{LEGAL_DED_AMT}							
			   , #{STAFF_DED_AMT}							
			   , #{APPOINT_ASS_TAX_DED_AMT}		
			   , #{GIFT_DED_I}								
			   , #{LEGAL_GIFT_DED_I}					
			   , #{PRIV_GIFT_DED_I}						
			   , #{PUBLIC_GIFT_DED_I}					
			   , #{STAFF_GIFT_DED_I}					
			   , #{APPOINT_GIFT_DED_I}				
			   , #{ASS_GIFT_DED_I}						
			   , #{GIFT_TAX_DED_I}						
			   , #{POLICY_INDED_TAX_DED_I}		
			   , #{POLICY_GIFT_TAX_DED_I}			
			   , #{LEGAL_GIFT_TAX_DED_I}			
			   , #{STAFF_GIFT_TAX_DED_I}			
			   , #{APPOINT_GIFT_TAX_DED_I}		
			   , #{ASS_GIFT_TAX_DED_I}				
			   , #{STD_TAX_DED_I}							
			   , #{NAP_TAX_DED_I}							
			   , #{HOUS_INTER_I}							
			   , #{OUTSIDE_INCOME_I}					
			   , #{MON_RENT_I}								
			   , #{DEF_IN_TAX_I}							
			   , #{DEF_LOCAL_TAX_I}						
			   , #{DEF_SP_TAX_I}							
			   , #{NOW_IN_TAX_I}							
			   , #{NOW_LOCAL_TAX_I}						
			   , #{NOW_SP_TAX_I}							
			   , #{PRE_IN_TAX_I}							
			   , #{PRE_LOCAL_TAX_I}						
			   , #{PRE_SP_TAX_I}							
			   , #{NAP_IN_TAX_I}							
			   , #{NAP_LOCAL_TAX_I}						
			   , #{NAP_SP_TAX_I}							
			   , #{IN_TAX_I}									
			   , #{LOCAL_TAX_I}								
			   , #{SP_TAX_I}									
			   , #{HALFWAY_TYPE}							
			   , #{HOUSEHOLDER_YN}						
			   , #{FOREIGN_DISPATCH_YN}				
			   , #{FORE_SINGLE_YN}						
			   , #{JOIN_DATE}									
			   , ISNULL(#{RETR_DATE},'00000000')									
			   , #{DEPT_CODE}									
			   , #{DEPT_NAME}									
			   , #{S_USER_ID}						
			   , GETDATE()						
			   , #{S_USER_ID}						
			   , GETDATE()		
			)
	</update>
	<update id="had617ukrServiceImpl.save600_2" parameterType="rMap" >
		DECLARE @CompCode           NVARCHAR(08)                -- (필수) 법인코드
			  , @YearYyyy           NVARCHAR(04)                -- (필수) 정산년도
			  , @PersonNumb         NVARCHAR(10)                -- (필수) 사번
			  , @UserId             NVARCHAR(100)                -- (필수) 사용자ID
			  , @ForeSingleYn       NVARCHAR(01)                -- (필수) 외국인단일세율적용여부
		/**********************************************************************************************************************
         기부금 조정
        **********************************************************************************************************************/
        BEGIN
			
        
			DECLARE @EarnIncomeI        NUMERIC(30,6)
				  , @PolicyInded        NUMERIC(30,6), @PolicyGiftI        NUMERIC(30,6), @LegalGiftIPrev     NUMERIC(30,6)
				  , @LegalGiftIPrev14   NUMERIC(30,6), @LegalGiftI         NUMERIC(30,6), @PrivGiftIPrev      NUMERIC(30,6)
				  , @PrivGiftI          NUMERIC(30,6), @PublicGiftIPrev    NUMERIC(30,6), @PublicGiftI        NUMERIC(30,6)
				  , @StaffGiftI         NUMERIC(30,6), @AppointGiftIPrev   NUMERIC(30,6), @AppointGiftIPrev14 NUMERIC(30,6)
				  , @AppointGiftI       NUMERIC(30,6), @AssGiftIPrev       NUMERIC(30,6), @AssGiftIPrev14     NUMERIC(30,6)
				  , @AssGiftI           NUMERIC(30,6)
				  , @GiftDedI           NUMERIC(30,6), @StaffGiftDedI      NUMERIC(30,6), @GiftTaxDedI        NUMERIC(30,6)
        
			SET NOCOUNT ON
			SET ARITHABORT ON
        
			--  1. 변수 값 할당 -------------------------------------------------------------------------------------------------
			SET @CompCode     = #{S_COMP_CODE}
			SET @YearYyyy     = #{YEAR_YYYY}
			SET @PersonNumb   = #{PERSON_NUMB}
			SET @UserId       = #{S_USER_ID}
        
			SET @EarnIncomeI        =  #{EARN_INCOME_I}
			SET @PolicyInded        =  #{POLICY_INDED}
			SET @PolicyGiftI        =  #{POLICY_GIFT_I}
			SET @LegalGiftIPrev     =  #{LEGAL_GIFT_I_PREV}
			SET @LegalGiftIPrev14   =  #{LEGAL_GIFT_I_PREV_14}
			SET @LegalGiftI         =  #{LEGAL_GIFT_I}
			SET @PrivGiftIPrev      =  #{PRIV_GIFT_I_PREV}
			SET @PrivGiftI          =  #{PRIV_GIFT_I}
			SET @PublicGiftIPrev    =  #{PUBLIC_GIFT_I_PREV}
			SET @PublicGiftI        =  #{PUBLIC_GIFT_I}
			SET @StaffGiftI         =  #{STAFF_GIFT_I}
			SET @AppointGiftIPrev   =  #{APPOINT_GIFT_I_PREV}
			SET @AppointGiftIPrev14 =  #{APPOINT_GIFT_I_PREV_14}	
			SET @AppointGiftI       =  #{APPOINT_GIFT_I}	
			SET @AssGiftIPrev       =  #{ASS_GIFT_I_PREV}
			SET @AssGiftIPrev14     =  #{ASS_GIFT_I_PREV_14}	
			SET @AssGiftI           =  #{ASS_GIFT_I}	
			SET @GiftDedI           =  #{GIFT_DED_I}
			SET @StaffGiftDedI      =  #{STAFF_GIFT_DED_I}
			SET @GiftTaxDedI        =  #{GIFT_TAX_DED_I}	
        
			--  2. 데이터 조회 --------------------------------------------------------------------------------------------------
			EXEC sp2017YearEndTax315SetContributionDeduction @CompCode
														   , @YearYyyy
														   , @PersonNumb
														   , @EarnIncomeI           --근로소득금액
														   , @PolicyInded           --정치자금기부금(10만원미만)
														   , @PolicyGiftI           --정치자금기부금(10만원초과)
														   , @LegalGiftIPrev        --법정기부금이월금-2013
														   , @LegalGiftIPrev14      --법정기부금이월금-2014
														   , @LegalGiftI            --법정기부금
														   , @PrivGiftIPrev         --특례기부금이월금
														   , @PrivGiftI             --특례기부금
														   , @PublicGiftIPrev       --공익법인신탁기부금이월금
														   , @PublicGiftI           --공익법인신탁기부금
														   , @StaffGiftI            --우리사주기부금
														   , @AppointGiftIPrev      --지정기부금이월금-2013
														   , @AppointGiftIPrev14    --지정기부금이월금-2014
														   , @AppointGiftI          --지정기부금
														   , @AssGiftIPrev          --종교단체기부금이월금-2013
														   , @AssGiftIPrev14        --종교단체기부금이월금-2014
														   , @AssGiftI              --종교단체기부금
														   , @GiftDedI              --기부금공제(특별소득공제)
														   , @StaffGiftDedI         --기부금공제(기타소득공제)
														   , @GiftTaxDedI           --기부금공제(특별세액공제)
														   , @UserId
			SET NOCOUNT OFF
			SET ARITHABORT OFF
        END

        /**********************************************************************************************************************
         연금저축소득공제금액 업데이트
        **********************************************************************************************************************/
        BEGIN
			
			DECLARE @RetireTaxDedI      NUMERIC(30,6), @SciTaxDedI         NUMERIC(30,6), @PrivPensI           NUMERIC(30,6)
				  , @PensTaxDedI        NUMERIC(30,6), @HousBuAmt          NUMERIC(30,6), @HousBuAddAmt        NUMERIC(30,6)
				  , @HousWorkAmt        NUMERIC(30,6), @HousBuAmountI      NUMERIC(30,6), @HousBuAmountAddI    NUMERIC(30,6)
				  , @LongInvestStockDedI NUMERIC(30,6)
				  , @SciTaxDedI1        NUMERIC(30,6), @RetireTaxDedI1     NUMERIC(30,6), @PensTaxDedI1        NUMERIC(30,6)
				  , @IncomeSuppTotalI   NUMERIC(30,6)
        
			SET NOCOUNT ON
			SET ARITHABORT ON
        
			--  1. 변수 값 할당 -------------------------------------------------------------------------------------------------
        
			SET @IncomeSuppTotalI    =  #{INCOME_SUPP_TOTAL_I}
			SET @PrivPensI           =  #{PRIV_PENS_I}
			SET @HousBuAmt           =  #{HOUS_BU_AMT}
			SET @HousBuAddAmt        =  #{HOUS_BU_ADD_AMT}
			SET @HousWorkAmt         =  #{HOUS_WORK_AMT}
			SET @HousBuAmountI       =  #{HOUS_BU_AMOUNT_I}
			SET @HousBuAmountAddI    =  #{HOUS_BU_AMOUNT_ADD_I}
			SET @LongInvestStockDedI =  #{LONG_INVEST_STOCK_DED_I}
			SET @SciTaxDedI          =  #{SCI_TAX_DED_I}
			SET @RetireTaxDedI       =  #{RETIRE_TAX_DED_I}
			SET @PensTaxDedI         =  #{PENS_TAX_DED_I}
			SET @SciTaxDedI1         =  #{SCI_TAX_DED_I1}
			SET @RetireTaxDedI1      =  #{RETIRE_TAX_DED_I1}
			SET @PensTaxDedI1        =  #{PENS_TAX_DED_I1}
        
			SET @SciTaxDedI          = @SciTaxDedI    + @SciTaxDedI1
			SET @RetireTaxDedI       = @RetireTaxDedI + @RetireTaxDedI1
			SET @PensTaxDedI         = @PensTaxDedI   + @PensTaxDedI1
        
			--  2. 데이터 조회 --------------------------------------------------------------------------------------------------
			EXEC sp2017YearEndTax320SetAnnuitySavingsDeduction @CompCode
															 , @YearYyyy
															 , @PersonNumb
															 , @IncomeSuppTotalI                    --총급여액
															 , @PrivPensI                           --(소득공제)21-개인연금저축
															 , @HousBuAmt                           --(소득공제)31-청약저축
															 , @HousBuAddAmt                        --(소득공제)35-청약저축
															 , @HousWorkAmt                         --(소득공제)34-근로자주택마련저축
															 , @HousBuAmountI                       --(소득공제)32-주택청약종합저축
															 , @HousBuAmountAddI                    --(소득공제)36-주택청약종합저축
															 , @LongInvestStockDedI                 --(소득공제)51-장기집합투자증권저축
															 , @SciTaxDedI                          --(세액공제)12-과학기술인공제
															 , @RetireTaxDedI                       --(세액공제)11-근로자퇴직급여보장법
															 , @PensTaxDedI                         --(세액공제)22-연금저축
			SET NOCOUNT OFF
			SET ARITHABORT OFF
        END
            
        /**********************************************************************************************************************
         비과세소득금액 생성
        **********************************************************************************************************************/
        BEGIN
        
			SET NOCOUNT ON
			SET ARITHABORT ON
        
			--  1. 변수 값 할당 -------------------------------------------------------------------------------------------------
			SET @ForeSingleYn  = #{FORE_SINGLE_YN}
        
			--  2. 데이터 조회 --------------------------------------------------------------------------------------------------
			EXEC sp2017YearEndTax325SumNontaxableIncome @CompCode
													  , @YearYyyy
													  , @PersonNumb
													  , @ForeSingleYn
													  , @UserId
			SET NOCOUNT OFF
			SET ARITHABORT OFF
        END
		
	</update>
	<select id="had617ukrServiceImpl.fnSuppTotI" parameterType="rMap" resultType="rMap">
	/* had617ukrServiceImpl.fnSuppTotI */
		DECLARE @ERROR_CODE nvarchar(10),	@return_value numeric(03)
						
		EXEC @return_value = SP_HRT_CHANGE_RETIRE_ST_SUPP_TOTAL 
					  #{S_COMP_CODE}
					, #{PERSON_NUMB} 
					, #{RETR_DATE}
					, #{RETR_TYPE}
					, #{TAX_CALCU}
					, #{R_CALCU_END_DATE}
					, #{S_LONG_YEARS}
					, #{LONG_YEARS_BE13}
					, #{LONG_YEARS_AF13}
					, #{PAY_END_TAX}
					, #{R_ANNU_TOTAL_I}
					, #{OUT_INCOME_I}
					, #{M_ANNU_TOTAL_I}
					, #{M_OUT_INCOME_I}
					, #{DED_IN_TAX_ADD_I}
					, #{DED_IN_LOCAL_ADD_I}
					, #{DED_ETC_I}
					, #{S_USER_ID}
					, @ERROR_CODE OUTPUT
		SELECT	@ERROR_CODE as N'ERROR_CODE', @return_value as 'RETURN_VALUE'
	</select>
	
	<update id="had617ukrServiceImpl.submitFormData01" parameterType="Map">
	/* had617ukrServiceImpl.submitFormData01 */
		UPDATE HRT500T
		   SET JOIN_DATE           = #{JOIN_DATE}
		     , SUPP_DATE           = #{SUPP_DATE}
		     , RETR_RESN           = #{RETR_RESN}
		     , DUTY_YYYY           = #{DUTY_YYYY}
		     , LONG_MONTH          = #{LONG_MONTH}
		     , LONG_DAY            = #{LONG_DAY}
		     , LONG_TOT_DAY        = #{LONG_TOT_DAY}
		     , ADD_MONTH           = #{ADD_MONTH}
		     , LONG_TOT_MONTH      = #{LONG_TOT_MONTH}
		     , LONG_YEARS          = #{LONG_YEARS}
		     , AVG_DAY             = #{AVG_DAY}
		     , PAY_TOTAL_I         = #{PAY_TOTAL_I}
		     , BONUS_TOTAL_I       = #{BONUS_TOTAL_I}
		     , YEAR_TOTAL_I        = #{YEAR_TOTAL_I}
		     , AVG_PAY_3           = #{AVG_PAY_3}
		     , AVG_BONUS_I_3       = #{AVG_BONUS_I_3}
		     , AVG_YEAR_I_3        = #{AVG_YEAR_I_3}
		     , TOT_WAGES_I         = #{TOT_WAGES_I}
		     , AVG_WAGES_I         = #{AVG_WAGES_I}
		     , ORI_RETR_ANNU_I     = #{ORI_RETR_ANNU_I}
		     , RETR_ANNU_I         = #{RETR_ANNU_I}
		     , GLORY_AMOUNT_I      = #{GLORY_AMOUNT_I}
		     , GROUP_INSUR_I       = #{GROUP_INSUR_I}
		     , OUT_INCOME_I        = #{OUT_INCOME_I}
		     , ETC_AMOUNT_I        = #{ETC_AMOUNT_I}
		     , RETR_SUM_I          = #{RETR_SUM_I}
		     , SUPP_TOTAL_I        = #{SUPP_TOTAL_I}
		     , SPEC_DED_I          = #{SPEC_DED_I}
		     , INCOME_DED_I        = #{INCOME_DED_I}
		     , EARN_INCOME_I       = #{EARN_INCOME_I}
		     , TAX_STD_I           = #{TAX_STD_I}
		     , AVG_TAX_STD_I       = #{AVG_TAX_STD_I}
		     , AVR_COMP_TAX_I      = #{AVR_COMP_TAX_I}
		     , COMP_TAX_I          = #{COMP_TAX_I}
		     , IN_TAX_I            = #{IN_TAX_I}
		     , LOCAL_TAX_I         = #{LOCAL_TAX_I}
		     , DED_IN_TAX_ADD_I    = #{DED_IN_TAX_ADD_I}
		     , DED_IN_LOCAL_ADD_I  = #{DED_IN_LOCAL_ADD_I}
		     , DED_ETC_I           = #{DED_ETC_I}
		     , DED_TOTAL_I         = #{DED_TOTAL_I}
		     , PAY_END_TAX         = #{PAY_END_TAX}
		     , DEF_TAX_I           = #{DEF_TAX_I}
		     , REAL_AMOUNT_I       = #{REAL_AMOUNT_I}
		     , M_ANNU_TOTAL_I      = #{M_ANNU_TOTAL_I}
		     , M_OUT_INCOME_I      = #{M_OUT_INCOME_I}
		     , M_TAX_TOTAL_I       = #{DED_TOTAL_I}
		     , R_ANNU_TOTAL_I      = #{R_ANNU_TOTAL_I}
		     , R_TAX_TOTAL_I       = #{R_TAX_TOTAL_I}
		     , R_CALCU_END_DATE    = #{R_CALCU_END_DATE}
		     , S_LONG_YEARS        = #{S_LONG_YEARS}
		     , LONG_YEARS_BE13     = #{LONG_YEARS_BE13}
		     , LONG_YEARS_AF13     = #{LONG_YEARS_AF13}
		     , INSERT_DB_USER      = #{S_USER_ID}
		     , INSERT_DB_TIME      = GETDATE()
		     , UPDATE_DB_USER      = #{S_USER_ID}
		     , UPDATE_DB_TIME      = GETDATE()
		     		     
		 WHERE COMP_CODE           = #{S_COMP_CODE}
		   AND RETR_DATE           = #{RETR_DATE}
		   AND RETR_TYPE           = #{RETR_TYPE}
		   AND PERSON_NUMB         = #{PERSON_NUMB}
	</update>
	
	<select id="had617ukrServiceImpl.selectFormData02" parameterType="rMap" resultType="rMap">
	/* had617ukrServiceImpl.selectFormData02 */
		SELECT     A.SUPP_TOTAL_I   AS A
			     , A.SPEC_DED_I     AS B
			     , (CASE WHEN A.LONG_YEARS &lt;= 5                         THEN A.INCOME_DED_I ELSE 0 END) AS C
			     , (CASE WHEN A.LONG_YEARS  &gt; 5  AND A.LONG_YEARS &lt;= 10 THEN A.INCOME_DED_I ELSE 0 END) AS D
			     , (CASE WHEN A.LONG_YEARS  &gt; 10 AND A.LONG_YEARS &lt;= 20 THEN A.INCOME_DED_I ELSE 0 END) AS E
			     , (CASE WHEN A.LONG_YEARS  &gt; 20                        THEN A.INCOME_DED_I ELSE 0 END) AS F
			     , A.EARN_INCOME_I  AS G
			     , A.TAX_STD_I      AS H
			     , A.AVG_TAX_STD_I  AS I
			     , (CASE WHEN A.AVG_TAX_STD_I &lt;=  12000000                                  THEN A.AVR_COMP_TAX_I ELSE 0 END) AS J
			     , (CASE WHEN A.AVG_TAX_STD_I  &gt;  12000000 AND A.AVG_TAX_STD_I &lt;=  46000000 THEN A.AVR_COMP_TAX_I ELSE 0 END) AS K
			     , (CASE WHEN A.AVG_TAX_STD_I  &gt;  46000000 AND A.AVG_TAX_STD_I &lt;=  88000000 THEN A.AVR_COMP_TAX_I ELSE 0 END) AS L
			     , (CASE WHEN A.AVG_TAX_STD_I  &gt;  88000000 AND A.AVG_TAX_STD_I &lt;= 300000000 THEN A.AVR_COMP_TAX_I ELSE 0 END) AS M
			     , (CASE WHEN A.AVG_TAX_STD_I  &gt; 300000000                                  THEN A.AVR_COMP_TAX_I ELSE 0 END) AS N
			     , A.COMP_TAX_I     AS O
			     , ISNULL(A.PAY_TOTAL_I_16         , 0)                   AS P                   -- (33)환산급여
			     , ISNULL(A.PAY_TOTAL_DED_I_16     , 0)                   AS Q                   -- (34)환산급여별공제
			     , ISNULL(A.TAX_STD_I_16           , 0)                   AS R                   -- (35)퇴직소득과세표준
			     , ISNULL(A.CHANGE_COMP_TAX_I_16   , 0)                   AS S                   -- (42)환산산출세액
			     , ISNULL(A.COMP_TAX_I_16          , 0)                   AS T                   -- (43)산출세액
			     , ISNULL(A.CHANGE_TAX_YEAR_16     ,'')                   AS U                   -- (44)퇴직일이 속하는 과세연도
			     , ISNULL(A.EXEMPTION_COMP_TAX_I_16, 0)                   AS V                   -- (45)특례적용 산출세액
			     , ISNULL(A.CHANGE_TARGET_TAX_I_16 , 0)                   AS W                   -- (47)신고대상액
		  FROM            HRT500T A WITH (NOLOCK)
		       INNER JOIN HUM100T B WITH (NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
		                                         AND B.PERSON_NUMB = A.PERSON_NUMB
		 WHERE A.COMP_CODE   = #{S_COMP_CODE} 
		   AND A.RETR_DATE   = #{RETR_DATE}
		   AND A.RETR_TYPE   = #{RETR_TYPE}
		   AND A.PERSON_NUMB = #{PERSON_NUMB}
	</select>
	
	<select id="had617ukrServiceImpl.selectFormDataResult" parameterType="rMap" resultType="rMap">
	/* had617ukrServiceImpl.selectFormDataResult */
		SELECT * FROM TEMPRETIRE
		--DROP TABLE TEMPRETIRE
		--DROP TABLE TEMPRETIRE1
		--DROP TABLE TEMPRETIRE2
		--DROP TABLE TEMPRETIRE3
		--DROP TABLE TEMPRETIRE4
		--DROP TABLE TEMPRETIRE5
	</select>
	
	<select id="had617ukrServiceImpl.selectList01" parameterType="rMap" resultType="rMap">
	/* had617ukrServiceImpl.selectList01 */
		--Hrt501ukr.CHrt501ukr[fnHrt501QSt1] Query01
		SELECT 
		       A.COMP_CODE
		     , A.RETR_DATE
		     , A.RETR_TYPE
		     , A.PERSON_NUMB
		     , uniLITE.fnGetUserDateComp(A.COMP_CODE, A.PAY_YYYYMM) AS PAY_YYYYMM
		     , A.WAGES_CODE
		     , B.WAGES_NAME AS WAGES_NAME
		     , A.AMOUNT_I
		     , A.PAY_STRT_DATE
		     , A.PAY_LAST_DATE
		     , A.WAGES_DAY
		     , A.INSERT_DB_USER
		     , A.INSERT_DB_TIME
		     , A.UPDATE_DB_USER
		     , A.UPDATE_DB_TIME
		  FROM            HRT300T A WITH (NOLOCK)
		       LEFT  JOIN HBS300T B WITH (NOLOCK) ON B.COMP_CODE  = A.COMP_CODE
		                                         AND B.CODE_TYPE  = '1'
		                                         AND B.WAGES_CODE = A.WAGES_CODE
		 WHERE A.COMP_CODE   = #{S_COMP_CODE}
		   AND A.RETR_DATE   = #{RETR_DATE}
		   AND A.RETR_TYPE   = #{RETR_TYPE}
		   AND A.PERSON_NUMB = #{PERSON_NUMB}
		 ORDER BY A.PAY_YYYYMM 	
	</select>
	
	<select id="had617ukrServiceImpl.selectList02" parameterType="rMap" resultType="rMap">
		--Hrt501ukr.CHrt501ukr[fnHrt501QSt1] Query02
		SELECT 
		       A.COMP_CODE
		     , A.RETR_DATE
		     , A.RETR_TYPE
		     , A.PERSON_NUMB
		     , uniLITE.fnGetUserDateComp(A.COMP_CODE, A.PAY_YYYYMM) AS PAY_YYYYMM
		     , A.WEL_CODE
		     , B.WEL_NAME
		     , A.GIVE_I
		     , A.WEL_LEVEL1
		     , A.WEL_LEVEL2
		     , A.APPLY_YYMM
		     , A.PAY_STRT_DATE
		     , A.PAY_LAST_DATE
		     , A.WAGES_DAY
		     , A.INSERT_DB_USER
		     , A.INSERT_DB_TIME
		  FROM            HRT350T A WITH (NOLOCK)
		       INNER JOIN HWE100T B WITH (NOLOCK) ON B.COMP_CODE  = A.COMP_CODE
		                                         AND B.APPLY_YYMM = A.APPLY_YYMM
		                                         AND B.WEL_LEVEL1 = A.WEL_LEVEL1
		                                         AND B.WEL_LEVEL2 = A.WEL_LEVEL2
		                                         AND B.WEL_CODE   = A.WEL_CODE
		 WHERE A.COMP_CODE   = #{S_COMP_CODE}
		   AND A.RETR_DATE   = #{RETR_DATE}
		   AND A.RETR_TYPE   = #{RETR_TYPE}
		   AND A.PERSON_NUMB = #{PERSON_NUMB}
		 ORDER BY A.PAY_YYYYMM
	</select>
	
	<select id="had617ukrServiceImpl.selectList03" parameterType="rMap" resultType="rMap">
		--Hrt501ukr.CHrt501ukr[fnHrt501QSt1] Query03
		SELECT 
		       A.COMP_CODE
		     , A.RETR_DATE
		     , A.RETR_TYPE
		     , A.PERSON_NUMB
		     , uniLite.fnGetUserDateComp(A.COMP_CODE, A.BONUS_YYYYMM) AS BONUS_YYYYMM
		     , A.BONUS_TYPE
		     , M1.CODE_NAME AS BONUS_NAME
		     , A.BONUS_I
		     , A.BONUS_RATE
		     , A.INSERT_DB_USER
		     , A.INSERT_DB_TIME
		     , A.UPDATE_DB_USER
		     , A.UPDATE_DB_TIME
		  FROM            HRT400T A  WITH (NOLOCK)
		       LEFT  JOIN BSA100T M1 WITH (NOLOCK) ON M1.COMP_CODE = A.COMP_CODE
		                                          AND M1.MAIN_CODE = 'H032'
		                                          AND M1.SUB_CODE  = A.BONUS_TYPE
		 WHERE A.COMP_CODE   = #{S_COMP_CODE}
		   AND A.RETR_DATE   = #{RETR_DATE}
		   AND A.RETR_TYPE   = #{RETR_TYPE}
		   AND A.PERSON_NUMB = #{PERSON_NUMB}
		   AND A.BONUS_TYPE NOT IN ('1','E','F','G')
		 ORDER BY A.BONUS_YYYYMM		
	</select>
	
	<select id="had617ukrServiceImpl.selectList04" parameterType="rMap" resultType="rMap">
		--Hrt501ukr.CHrt501ukr[fnHrt501QSt1] Query04
		SELECT 
		       A.COMP_CODE
		     , A.RETR_DATE
		     , A.RETR_TYPE
		     , A.PERSON_NUMB
		     , uniLITE.fnGetUserDateComp(A.COMP_CODE, A.BONUS_YYYYMM) AS BONUS_YYYYMM
		     , A.BONUS_TYPE
		     , M1.CODE_NAME AS BONUS_NAME
		     , A.BONUS_I
		     , A.SUPP_DATE
		     , A.BONUS_RATE
		     , A.INSERT_DB_USER
		     , A.INSERT_DB_TIME
		     , A.UPDATE_DB_USER
		     , A.UPDATE_DB_TIME
		  FROM            HRT400T A  WITH (NOLOCK)
		       LEFT  JOIN BSA100T M1 WITH (NOLOCK) ON M1.COMP_CODE = A.COMP_CODE
		                                          AND M1.MAIN_CODE = 'H032'
		                                          AND M1.SUB_CODE  = A.BONUS_TYPE
		 WHERE A.COMP_CODE   = #{S_COMP_CODE}
		   AND A.RETR_DATE   = #{RETR_DATE}
		   AND A.RETR_TYPE   = #{RETR_TYPE}
		   AND A.PERSON_NUMB = #{PERSON_NUMB}
		   AND A.BONUS_TYPE IN ('E','F','G') 
		 ORDER BY A.BONUS_YYYYMM ASC	
	</select>
	
	<insert id="had617ukrServiceImpl.insertList04" parameterType="rMap">
	/* had617ukrServiceImpl.insertList04 */	
		INSERT INTO HRT400T
		     ( RETR_DATE
		     , RETR_TYPE
		     , PERSON_NUMB
		     , BONUS_YYYYMM
		     , BONUS_TYPE
		     , BONUS_I
		     , SUPP_DATE
		     , INSERT_DB_USER
		     , INSERT_DB_TIME
		     , UPDATE_DB_USER
		     , UPDATE_DB_TIME
		     ) 
		VALUES
		     ( #{RETR_DATE}
		     , #{RETR_TYPE}
		     , #{PERSON_NUMB}
		     , #{BONUS_YYYYMM}
		     , #{BONUS_TYPE}
		     , #{BONUS_I}
		     , #{SUPP_DATE}
		     , #{S_USER_ID}
		     , GETDATE()
		     , #{S_USER_ID}
		     , GETDATE()
		     )
	</insert>
	
	<update id="had617ukrServiceImpl.updateList04" parameterType="rMap">
	/* had617ukrServiceImpl.updateList04 */	
		UPDATE HRT400T
		   SET BONUS_I        = #{BONUS_I}
		     , SUPP_DATE      = #{SUPP_DATE}
		     , BONUS_RATE     = #{BONUS_RATE}
		     , INSERT_DB_USER = #{S_USER_ID}
		     , INSERT_DB_TIME = GETDATE()
		     , UPDATE_DB_USER = #{S_USER_ID}
		     , UPDATE_DB_TIME = GETDATE()
		     
		 WHERE COMP_CODE      = #{S_COMP_CODE}
		   AND RETR_DATE      = #{RETR_DATE}
		   AND RETR_TYPE      = #{RETR_TYPE}
		   AND PERSON_NUMB    = #{PERSON_NUMB}
		   AND BONUS_YYYYMM   = #{BONUS_YYYYMM}
		   AND BONUS_TYPE     = #{BONUS_TYPE}
	</update>
	
	<select id="had617ukrServiceImpl.selectList05" parameterType="rMap" resultType="rMap">
	/* had617ukrServiceImpl.selectList05 */
		BEGIN
    --  1. 변수선언 -----------------------------------------------------------------------------------
        DECLARE @SUPP_TOTAL_I           NUMERIC(30, 6)
              , @Y2011_SUPP_TOTAL_I     NUMERIC(30, 6)
              , @STD_RETR_ANNU_I        NUMERIC(30, 6)
              , @Y_AVG_PAY_I            NUMERIC(30, 6)
              , @CON_RETR_ANNU_I        NUMERIC(30, 6)
              , @PAY_ANNU_I             NUMERIC(30, 6)
              , @RETR_ANNU_I            NUMERIC(30, 6)
              , @R_IN_TAX_I             NUMERIC(30, 6)
              , @R_LOCAL_TAX_I          NUMERIC(30, 6)
              , @ORG_RETR_ANNU_I        NUMERIC(30, 6)
              , @ORG_GLORY_AMOUNT_I     NUMERIC(30, 6)
              , @ORG_ETC_AMOUNT_I       NUMERIC(30, 6)
              , @ORG_GROUP_INSUR_I      NUMERIC(30, 6)
              , @JOIN_DATE              NVARCHAR(08)
              , @RETR_DATE              NVARCHAR(08)
    
              , @RETR_TYPE              NVARCHAR(01)
              , @SUPP_DATE              NVARCHAR(08)
              , @M_SUPP_TOTAL_I         NUMERIC(30, 6)
              , @M_RETR_ANNU_I          NUMERIC(30, 6)
    
    --  2. 데이터 조회 , 변수값 저장 -------------------------------------------------------------------------
        SELECT @JOIN_DATE           = ISNULL(B.JOIN_DATE         , '0')
             , @RETR_DATE           = ISNULL(B.RETR_DATE         , '0')
             , @SUPP_TOTAL_I        = ISNULL(A.SUPP_TOTAL_I      , 0 )
             , @Y2011_SUPP_TOTAL_I  = ISNULL(A.Y2011_SUPP_TOTAL_I, 0 )
             , @STD_RETR_ANNU_I     = ISNULL(A.STD_RETR_ANNU_I   , 0 )
             , @Y_AVG_PAY_I         = ISNULL(A.Y_AVG_PAY_I       , 0 )
             , @CON_RETR_ANNU_I     = ISNULL(A.CON_RETR_ANNU_I   , 0 )
             , @PAY_ANNU_I          = ISNULL(A.PAY_ANNU_I        , 0 )
             , @RETR_ANNU_I         = ISNULL(A.RETR_ANNU_I       , 0 )
             , @R_IN_TAX_I          = ISNULL(A.R_IN_TAX_I        , 0 )
             , @R_LOCAL_TAX_I       = ISNULL(A.R_LOCAL_TAX_I     , 0 )
        FROM              HRT510T   A  WITH (NOLOCK)
               LEFT  JOIN HUM100T   B  WITH (NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
                                                    AND B.PERSON_NUMB = A.PERSON_NUMB
        WHERE   A.COMP_CODE      = #{S_COMP_CODE}
			AND A.RETR_DATE      = #{RETR_DATE}
			AND A.RETR_TYPE      = #{RETR_TYPE}
			AND A.PERSON_NUMB    = #{PERSON_NUMB}
    
        SELECT CONVERT(NVARCHAR(02), '01')              AS SEQ
             , 'JOIN_DATE'                              AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , CONVERT(NUMERIC(30, 6) , @JOIN_DATE)     AS CONTENT
             , 'JOIN_DATE'				                AS REMARK
             , 'D'                                      AS DATA_TYPE
        UNION  ALL
        SELECT CONVERT(NVARCHAR(02), '02')              AS SEQ
             , 'RETR_DATE'                              AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , CONVERT(NUMERIC(30, 6) , @RETR_DATE)     AS CONTENT
             , 'RETR_DATE'					            AS REMARK
             , 'D'                                      AS DATA_TYPE
            UNION  ALL
        SELECT CONVERT(NVARCHAR(02), '08')              AS SEQ
             , 'SUPP_TOTAL_I'                           AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , @SUPP_TOTAL_I                            AS CONTENT
             , 'SUPP_TOTAL_I'			                AS REMARK
             , 'N'                                      AS DATA_TYPE
        UNION  ALL
        SELECT CONVERT(NVARCHAR(02), '09')              AS SEQ
             , 'Y2011_SUPP_TOTAL_I'                     AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , @Y2011_SUPP_TOTAL_I                      AS CONTENT
             , 'Y2011_SUPP_TOTAL_I'		                AS REMARK
             , 'N'                                      AS DATA_TYPE
        UNION  ALL
        SELECT CONVERT(NVARCHAR(02), '10')              AS SEQ
             , 'STD_RETR_ANNU_I'                        AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , @STD_RETR_ANNU_I                         AS CONTENT
             , 'STD_RETR_ANNU_I'		                AS REMARK
             , 'N'                                      AS DATA_TYPE
        UNION  ALL
        SELECT CONVERT(NVARCHAR(02), '11')              AS SEQ
             , 'Y_AVG_PAY_I'                            AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , @Y_AVG_PAY_I                             AS CONTENT
             , 'Y_AVG_PAY_I'  			                AS REMARK
             , 'N'                                      AS DATA_TYPE
        UNION  ALL
        SELECT CONVERT(NVARCHAR(02), '12')              AS SEQ
             , 'CON_RETR_ANNU_I'                        AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , @CON_RETR_ANNU_I                         AS CONTENT
             , 'CON_RETR_ANNU_I'		                AS REMARK
             , 'N'                                      AS DATA_TYPE
        UNION  ALL
        SELECT CONVERT(NVARCHAR(02), '13')              AS SEQ
             , 'PAY_ANNU_I'                             AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , @PAY_ANNU_I                              AS CONTENT
             , 'PAY_ANNU_I'               				AS REMARK
             , 'N'                                      AS DATA_TYPE
        UNION  ALL
        SELECT CONVERT(NVARCHAR(02), '14')              AS SEQ
             , 'RETR_ANNU_I'                            AS DIVI_CODE
             , CONVERT(NVARCHAR(100), '')               AS DIVI_NAME
             , @RETR_ANNU_I                             AS CONTENT
             , 'RETR_ANNU_I'				            AS REMARK
             , 'N'                                      AS DATA_TYPE
    	END	
	</select>
	
	<select id="had617ukrServiceImpl.selectList06" parameterType="rMap" resultType="rMap">
	/* had617ukrServiceImpl.selectList06 */
		SELECT uniLITE.fnGetUserdateComp(#{S_COMP_CODE}, SUPP_DATE) AS SUPP_DATE
	         , uniLITE.fnGetUserdateComp(#{S_COMP_CODE}, JOIN_DATE) AS RETR_DATE_FR
	         , uniLITE.fnGetUserdateComp(#{S_COMP_CODE}, RETR_DATE) AS RETR_DATE_TO
	         , ISNULL(RETR_ANNU_I , 0) AS RETR_ANNU_I
	         , ISNULL(IN_TAX_I    , 0) AS IN_TAX_I
	         , ISNULL(LOCAL_TAX_I , 0) AS LOCAL_TAX_I
	         , (ISNULL(RETR_ANNU_I, 0) - ISNULL(IN_TAX_I, 0) - ISNULL(LOCAL_TAX_I, 0)) AS BALANCE_I
	         , CONVERT(NVARCHAR(1),'') AS REMARK
	      FROM HRT500T WITH(NOLOCK)
	     WHERE COMP_CODE   = #{S_COMP_CODE}
	       AND RETR_TYPE   = 'M'
	       AND PERSON_NUMB = #{PERSON_NUMB}
	</select>
	<select id="had617ukrServiceImpl.checkTaxRate" parameterType="rMap" resultType="rMap">
		SELECT TOP 1 1 AS CHK
          FROM HAD100T WITH (NOLOCK)
         WHERE COMP_CODE = #{S_COMP_CODE}
           AND TAX_YEAR  = #{YEAR_YYYY}
	</select>
	<select id="had617ukrServiceImpl.checkTaxDedRate" parameterType="rMap" resultType="rMap">
		SELECT TOP 1 1 AS CHK
          FROM HAD200T WITH (NOLOCK)
         WHERE COMP_CODE = #{S_COMP_CODE}
           AND TAX_YEAR  = #{YEAR_YYYY}
           AND COMPANY_CODE =  '2'
	</select>
	<select id="had617ukrServiceImpl.selectSummaryData" parameterType="rMap" resultType="rMap">
	--Had617UKr.CHad617UKr[fnHad617QCol] Query03
   --**********************************************************************************************************************
   --  정산입력자료 집계/저장
   --**********************************************************************************************************************/
    BEGIN
        DECLARE @CompCode           NVARCHAR(08)                -- (필수) 법인코드
              , @YearYyyy           NVARCHAR(04)                -- (필수) 정산년도
              , @PersonNumb         NVARCHAR(10)                -- (필수) 사번
              , @UserId             NVARCHAR(100)                -- (필수) 사용자ID
              , @ForeignNum         NVARCHAR(20)                -- (필수) 외국인번호
              , @ForeSingleYn       NVARCHAR(01)                -- (필수) 외국인단일세율적용여부
              , @ForeDispachYn      NVARCHAR(01)                -- (필수) 외국법인소속 파견근로자 여부
    
        DECLARE @IncomeSuppTotalI   NUMERIC(30,6)
			  , @NowPayAmt          NUMERIC(30,6), @NowPayTotI         NUMERIC(30,6), @NowBonusTotalI     NUMERIC(30,6)
			  , @NowAddBonusI       NUMERIC(30,6), @NowStockProfitI    NUMERIC(30,6), @NowOwnerStockDrawI NUMERIC(30,6)
			  , @NowOfRetrOverI     NUMERIC(30,6)
			  , @OldPayAmt          NUMERIC(30,6), @OldPayTotI         NUMERIC(30,6), @OldBonusTotalI     NUMERIC(30,6)
			  , @OldAddBonusI       NUMERIC(30,6), @OldStockProfitI    NUMERIC(30,6), @OldOwnerStockDrawI NUMERIC(30,6)
			  , @OldOfRetrOverI     NUMERIC(30,6)
			  , @NapPayAmt          NUMERIC(30,6), @NapPayTotI         NUMERIC(30,6), @NapBonusTotalI     NUMERIC(30,6)
			  , @IncomeDedI         NUMERIC(30,6), @EarnIncomeI        NUMERIC(30,6)
			  , @PerDedI            NUMERIC(30,6), @Spouse             NVARCHAR(01) , @SuppNum            NUMERIC(30,6)
			  , @SuppNum1           NUMERIC(30,6), @SuppNum4           NUMERIC(30,6), @SuppNum5           NUMERIC(30,6)
			  , @SuppNum6           NUMERIC(30,6), @SuppNum7           NUMERIC(30,6), @SuppNum8           NUMERIC(30,6)
			  , @AgedNum            NUMERIC(30,6), @DeformNum          NUMERIC(30,6), @ManyChildNum       NUMERIC(30,6)
			  , @BringChildNum      NUMERIC(30,6), @BirthAdoptNum      NUMERIC(30,6), @Woman              NVARCHAR(01)
			  , @OneParent          NVARCHAR(01)
		      , @BirthAdoptNum1     NUMERIC(30,6), @BirthAdoptNum2     NUMERIC(30,6), @BirthAdoptNum3     NUMERIC(30,6)
			  , @AnuI               NUMERIC(30,6), @MedPreMinmI        NUMERIC(30,6), @HireInsurI         NUMERIC(30,6)
			  , @MonRentI           NUMERIC(30,6)
			  , @PrivPensI          NUMERIC(30,6)
			  , @HousBuAmt          NUMERIC(30,6), @HousWorkAmt        NUMERIC(30,6), @HousAmountI        NUMERIC(30,6)
			  , @HousBuAddAmt       NUMERIC(30,6), @HousAmountAddI     NUMERIC(30,6)
			  , @CardUseI           NUMERIC(30,6), @CashUseI           NUMERIC(30,6), @DebitCardUseI      NUMERIC(30,6)
			  , @TraMarketUseI      NUMERIC(30,6), @TrafficUseI        NUMERIC(30,6)
			  , @SciDeducI          NUMERIC(30,6), @RetirePensI        NUMERIC(30,6), @PensI              NUMERIC(30,6)
			  , @LongInvestStockI   NUMERIC(30,6)
			  , @EtcInsurI          NUMERIC(30,6), @DeformInsurI       NUMERIC(30,6)
			  , @MyMedDedI          NUMERIC(30,6), @SeniorMedI         NUMERIC(30,6), @DeformMedI         NUMERIC(30,6)
			  , @SurgeryMedI        NUMERIC(30,6), @MedTotalI          NUMERIC(30,6)
			  , @PerEducI           NUMERIC(30,6), @UnivEducNum        NUMERIC(30,6), @UnivEducI          NUMERIC(30,6)
			  , @StudEducNum        NUMERIC(30,6), @StudEducI          NUMERIC(30,6), @KindEduNum         NUMERIC(30,6)
			  , @KindEducI          NUMERIC(30,6), @DeformEducNum      NUMERIC(30,6), @DeformEducI        NUMERIC(30,6)
			  , @FieldEducI	        NUMERIC(30,6), @EduPrincipalRtnI	NUMERIC(30,6)	
			  , @PerEducDedI        NUMERIC(30,6), @UnivEducDedI       NUMERIC(30,6), @StudEducDedI       NUMERIC(30,6)
			  , @KindEducDedI       NUMERIC(30,6), @DeformEducDedI     NUMERIC(30,6), @FieldEducDedI	  NUMERIC(30,6)	
			  , @PolicyInded        NUMERIC(30,6)
			  , @PolicyGiftI        NUMERIC(30,6), @LegalGiftIPrev     NUMERIC(30,6), @LegalGiftIPrev14   NUMERIC(30,6)
			  , @LegalGiftI         NUMERIC(30,6), @PrivGiftIPrev      NUMERIC(30,6), @PrivGiftI          NUMERIC(30,6)
			  , @PublicGiftIPrev    NUMERIC(30,6), @PublicGiftI        NUMERIC(30,6), @StaffGiftI         NUMERIC(30,6)
			  , @AppointGiftIPrev   NUMERIC(30,6), @AppointGiftIPrev14 NUMERIC(30,6), @AppointGiftI       NUMERIC(30,6)
			  , @AssGiftIPrev       NUMERIC(30,6), @AssGiftIPrev14     NUMERIC(30,6), @AssGiftI           NUMERIC(30,6)
    
        SET NOCOUNT ON
        SET ARITHABORT ON
    
    --  1. 변수 값 할당 -------------------------------------------------------------------------------------------------
        SET @CompCode      = #{S_COMP_CODE}
        SET @YearYyyy      = #{YEAR_YYYY}
        SET @PersonNumb    = #{PERSON_NUMB}
        SET @UserId        = #{S_USER_ID}
        SET @ForeignNum    = #{FOREIGN_NUM}
        SET @ForeSingleYn  = #{FORE_SINGLE_YN}
        SET @ForeDispachYn = #{FOREIGN_DISPATCH_YN}
    
    --  2. 데이터 조회 --------------------------------------------------------------------------------------------------
        --(조정)비과세소득
        EXEC sp2017YearEndTax305SetNontaxableIncome @CompCode, @YearYyyy, @PersonNumb, @UserId
    
        --(조정)기부금내역 조정
        EXEC sp2017YearEndTax310SetContribution @CompCode, @YearYyyy, @PersonNumb, @UserId
        
    
        --(집계)총급여액
        IF @ForeignNum != '' AND @ForeSingleYn = 'Y'
    
            SELECT @IncomeSuppTotalI   = INCOME_SUPP_TOTAL_I
				 , @NowPayAmt          = NOW_PAY_AMT
				 , @NowPayTotI         = NOW_PAY_TOT_I
				 , @NowBonusTotalI     = NOW_BONUS_TOTAL_I
				 , @NowAddBonusI       = NOW_ADD_BONUS_I
				 , @NowStockProfitI    = NOW_STOCK_PROFIT_I
				 , @NowOwnerStockDrawI = NOW_OWNER_STOCK_DRAW_I
				 , @NowOfRetrOverI     = 0
				 , @OldPayAmt          = OLD_PAY_AMT
				 , @OldPayTotI         = OLD_PAY_TOT_I
				 , @OldBonusTotalI     = OLD_BONUS_TOTAL_I
				 , @OldAddBonusI       = OLD_ADD_BONUS_I
				 , @OldStockProfitI    = OLD_STOCK_PROFIT_I
				 , @OldOwnerStockDrawI = OLD_OWNER_STOCK_DRAW_I
				 , @OldOfRetrOverI     = 0
				 , @NapPayAmt          = NAP_PAY_AMT
				 , @NapPayTotI         = NAP_PAY_TOT_I
				 , @NapBonusTotalI     = NAP_BONUS_TOTAL_I
			  FROM uniLITE.fn2017YearEndTax102GetIncomeSuppTotalIForeign(@CompCode, @YearYyyy, @PersonNumb)
        ELSE
            SELECT @IncomeSuppTotalI   = INCOME_SUPP_TOTAL_I
			 	 , @NowPayAmt          = NOW_PAY_AMT
				 , @NowPayTotI         = NOW_PAY_TOT_I
				 , @NowBonusTotalI     = NOW_BONUS_TOTAL_I
				 , @NowAddBonusI       = NOW_ADD_BONUS_I
				 , @NowStockProfitI    = NOW_STOCK_PROFIT_I
				 , @NowOwnerStockDrawI = NOW_OWNER_STOCK_DRAW_I
				 , @NowOfRetrOverI     = NOW_OF_RETR_OVER_I
				 , @OldPayAmt          = OLD_PAY_AMT
				 , @OldPayTotI         = OLD_PAY_TOT_I
				 , @OldBonusTotalI     = OLD_BONUS_TOTAL_I
				 , @OldAddBonusI       = OLD_ADD_BONUS_I
				 , @OldStockProfitI    = OLD_STOCK_PROFIT_I
				 , @OldOwnerStockDrawI = OLD_OWNER_STOCK_DRAW_I
				 , @OldOfRetrOverI     = OLD_OF_RETR_OVER_I
				 , @NapPayAmt          = NAP_PAY_AMT
				 , @NapPayTotI         = NAP_PAY_TOT_I
				 , @NapBonusTotalI     = NAP_BONUS_TOTAL_I
			  FROM uniLITE.fn2017YearEndTax101GetIncomeSuppTotalI(@CompCode, @YearYyyy, @PersonNumb)
    
        --(계산)근로소득공제/근로소득금액
        SELECT @IncomeDedI  = INCOME_DED_I
			 , @EarnIncomeI = EARN_INCOME_I
		  FROM uniLITE.fn2017YearEndTax205CalIncomeDed(@CompCode, @YearYyyy, @IncomeSuppTotalI)
    
        --(집계)인적정보
        SELECT @Spouse         = SPOUSE
			 , @SuppNum        = SUPP_NUM
			 , @SuppNum1       = SUPP_NUM_1
			 , @SuppNum4       = SUPP_NUM_4
			 , @SuppNum5       = SUPP_NUM_5
			 , @SuppNum6       = SUPP_NUM_6
			 , @SuppNum7       = SUPP_NUM_7
			 , @SuppNum8       = SUPP_NUM_8
			 , @AgedNum        = AGED_NUM
			 , @DeformNum      = DEFORM_NUM
			 , @ManyChildNum   = MANY_CHILD_NUM
			 , @BringChildNum  = BRING_CHILD_NUM
			 , @BirthAdoptNum  = BIRTH_ADOPT_NUM
			 , @Woman          = WOMAN
			 , @OneParent      = ONE_PARENT
			 , @BirthAdoptNum1 = BIRTH_ADOPT_NUM1
			 , @BirthAdoptNum2 = BIRTH_ADOPT_NUM2
			 , @BirthAdoptNum3 = BIRTH_ADOPT_NUM3
	  	FROM uniLITE.fn2017YearEndTax105GetPersonlInfo(@CompCode, @YearYyyy, @PersonNumb)
    
        --(계산)인적공제금액(기본공제/추가공제)
        SELECT @PerDedI = PER_DED_I
		  FROM uniLITE.fn2017YearEndTax210CalPersonlDed(@CompCode, @YearYyyy, @Spouse
																			, @SuppNum
																			, @AgedNum
																			, @DeformNum
																			, @Woman
																			, @OneParent
																			, @EarnIncomeI)
    
        --(집계)국민연금/건강보험/고용보험/보장성보험/장애인전용보장성보험
        SELECT @AnuI         = ANU_I
			 , @MedPreMinmI  = MED_PREMINM_I
			 , @HireInsurI   = HIRE_INSUR_I
			 , @EtcInsurI    = ETC_INSUR_I
			 , @DeformInsurI = DEFORM_INSUR_I
		  FROM uniLITE.fn2017YearEndTax110GetInsurance(@CompCode, @YearYyyy, @PersonNumb)
    
        --(집계)연금저축/주택마련
        SELECT @PrivPensI        = PRIV_PENS_I
			 , @SciDeducI        = SCI_DEDUC_I
			 , @RetirePensI      = RETIRE_PENS_I
			 , @PensI            = PENS_I
			 , @HousBuAmt        = HOUS_BU_AMT
			 , @HousBuAddAmt     = HOUS_BU_ADD_AMT
			 , @HousWorkAmt      = HOUS_WORK_AMT
			 , @HousAmountI      = HOUS_AMOUNT_I
			 , @HousAmountAddI   = HOUS_AMOUNT_ADD_I
			 , @LongInvestStockI = LONG_INVEST_STOCK_I
		  FROM uniLITE.fn2017YearEndTax115GetSavings(@CompCode, @YearYyyy, @PersonNumb)
    
        --(집계)월세액
        SELECT @MonRentI  = MON_RENT_I
	  	  FROM uniLITE.fn2017YearEndTax120GetMonthlyRent(@CompCode, @YearYyyy, @PersonNumb)
    
        --(집계)신용카드등
        SELECT @CardUseI         = CARD_USE_I
			 , @CashUseI         = CASH_USE_I
			 , @DebitCardUseI    = DEBIT_CARD_USE_I
			 , @TraMarketUseI    = TRA_MARKET_USE_I
			 , @TrafficUseI      = TRAFFIC_USE_I
		  FROM uniLITE.fn2017YearEndTax125GetCreditEtc(@CompCode, @YearYyyy, @PersonNumb)
    
        --(집계)의료비
        SELECT @MyMedDedI   = MY_MED_DED_I
			 , @SeniorMedI  = SENIOR_MED_I
			 , @DeformMedI  = DEFORM_MED_I
			 , @SurgeryMedI = SURGERY_MED_I
			 , @MedTotalI   = MED_TOTAL_I
		  FROM uniLITE.fn2017YearEndTax130GetMedicalExpenses(@CompCode, @YearYyyy, @PersonNumb)
    
        --(집계)교육비
        SELECT @PerEducI      = PER_EDUC_I
			 , @UnivEducNum   = UNIV_EDUC_NUM
			 , @UnivEducI     = UNIV_EDUC_I
			 , @StudEducNum   = STUD_EDUC_NUM
			 , @StudEducI     = STUD_EDUC_I
			 , @KindEduNum    = KIND_EDU_NUM
			 , @KindEducI     = KIND_EDUC_I
			 , @DeformEducNum = DEFORM_EDUC_NUM
			 , @DeformEducI   = DEFORM_EDUC_I
			 , @FieldEducI    = FIELD_EDUC_I
			 --, @EduPrincipalRtnI    = EDU_PRINCIPAL_RTN_I
		  FROM uniLITE.fn2017YearEndTax135GetEducationExpenses(@CompCode, @YearYyyy, @PersonNumb)
    
        --(계산)교육비
        SELECT @PerEducDedI    = PER_EDUC_DED_I
			 , @UnivEducDedI   = UNIV_EDUC_DED_I
			 , @StudEducDedI   = STUD_EDUC_DED_I
			 , @KindEducDedI   = KIND_EDUC_DED_I
			 , @DeformEducDedI = DEFORM_EDUC_DED_I
			 , @FieldEducDedI  = FIELD_EDUC_DED_I
		  FROM uniLITE.fn2017YearEndTax270CalEducationExpenses(@CompCode, @YearYyyy, @PersonNumb)
    
        --(집계)기부금
        SELECT @PolicyGiftI        = POLICY_GIFT_I
			 , @LegalGiftIPrev     = LEGAL_GIFT_I_PREV
			 , @LegalGiftIPrev14   = LEGAL_GIFT_I_PREV_14
			 , @LegalGiftI         = LEGAL_GIFT_I
			 , @PrivGiftIPrev      = PRIV_GIFT_I_PREV
			 , @PrivGiftI          = PRIV_GIFT_I
			 , @PublicGiftIPrev    = PUBLIC_GIFT_I_PREV
			 , @PublicGiftI        = PUBLIC_GIFT_I
			 , @StaffGiftI         = STAFF_GIFT_I
			 , @AppointGiftIPrev   = APPOINT_GIFT_I_PREV
			 , @AppointGiftIPrev14 = APPOINT_GIFT_I_PREV_14
			 , @AppointGiftI       = APPOINT_GIFT_I
			 , @AssGiftIPrev       = ASS_GIFT_I_PREV
			 , @AssGiftIPrev14     = ASS_GIFT_I_PREV_14
			 , @AssGiftI           = ASS_GIFT_I
			 , @PolicyInded        = POLICY_INDED
		  FROM uniLITE.fn2017YearEndTax140GetContribution(@CompCode, @YearYyyy, @PersonNumb)
    
    
--개별자료등록에서 호출시:selectSummaryData, 일괄자료등록에서 호출시:batchSummaryData
        --정산입력집계 조회
        SELECT A.PERSON_NUMB                                                                   --사번
			 , A.NAME                                                                          --성명
			 , A.DEPT_CODE                                                                     --(참조)
			 , A.DEPT_NAME                                                                     --(참조)
			 , A.POST_CODE                                                                     --(참조)
			 , ISNULL(M1.CODE_NAME, '')                                 AS POST_NAME           --(참조)
			 , ISNULL(unilite.fnCipherDecrypt(A.REPRE_NUM  ,'A'), '')   AS REPRE_NUM           --(참조)
			 , ISNULL(unilite.fnCipherDecrypt(A.FOREIGN_NUM,'F'), '')   AS FOREIGN_NUM         --(참조)
			 , A.NATION_CODE                                                                   --(참조)
			 , A.LIVE_GUBUN                                                                    --(참조)
			 , @YearYyyy                                        AS YEAR_YYYY                   --정산년도
			 , (CASE WHEN A.RETR_DATE != '00000000' AND LEN(A.RETR_DATE) &gt; 0 AND RIGHT(A.RETR_DATE,4) != '1231' AND LEFT(A.RETR_DATE,4) &lt;= @YearYyyy
					 THEN 'Y'
					 ELSE CASE WHEN RIGHT(A.RETR_DATE,4) = '1231' AND ISNULL(C.YEARENDTAX_CALCU_RULE,'1') = '2' 
							   THEN 'Y'
							   ELSE 'N'
					 END
				 END)                                           AS HALFWAY_TYPE                --중도퇴사자정산여부
			 , @ForeSingleYn                                    AS FORE_SINGLE_YN              --외국인단일세율적용여부
			 , ISNULL(A.FOREIGN_DISPATCH_YN,'')                 AS FOREIGN_DISPATCH_YN         --외국법인소속 파견근로자
			 , ISNULL(A.HOUSEHOLDER_YN, '')                     AS HOUSEHOLDER_YN              --세대주여부
			 , (CASE WHEN ISNULL(YOUTH_EXEMP_DATE,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE2,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE3,'')  = ''                                                          THEN ''
					 WHEN ISNULL(YOUTH_EXEMP_DATE,'') != '' AND ISNULL(YOUTH_EXEMP_DATE2,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE3,'')  = '' AND (@YearYyyy + '0101') &lt;= ISNULL(YOUTH_EXEMP_DATE ,'') THEN (CASE WHEN (ISNULL(JOIN_DATE,'') &gt; ISNULL(YOUTH_EXEMP_DATE ,''))   --     Else Case When 입사일  소득세감면기한
																																																			  THEN ''                                                      --               Then ''                            ex) 소득세감면기한이 입사일전인 경우(입사일:20120601 gt 소득감면기한:20120331)
																																																			  ELSE (CASE WHEN LEFT(ISNULL(JOIN_DATE,''),4) = @YearYyyy     --               Else Case When 입사년도 = 정산년도 ex) 소득세감면기한이 입사일후인 경우(입사일:20120601 gt 소득감면기한:20130731)
																																																						 THEN ISNULL(JOIN_DATE,'')                         --                         Then 입사일              ex) 정산년도에   입사한 경우 20120601(입사년도:2012 = 정산년도:2012)
																																																						 ELSE @YearYyyy + '0101'                           --                         Else 과세년도01월01일    ex) 정산년도전에 입사한 경우 20120101(입사년도:2011 = 정산년도:2012)
																																																					END)
																																																		 END)
					 WHEN ISNULL(YOUTH_EXEMP_DATE,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE2,'') != '' AND ISNULL(YOUTH_EXEMP_DATE3,'')  = '' AND (@YearYyyy + '0101') &lt;= ISNULL(YOUTH_EXEMP_DATE2,'') THEN (CASE WHEN (ISNULL(JOIN_DATE,'') &gt; ISNULL(YOUTH_EXEMP_DATE2,''))   --     Else Case When 입사일 &gt; 소득세감면기한
																																																			  THEN ''                                                      --               Then ''                            ex) 소득세감면기한이 입사일전인 경우(입사일:20120601 gt 소득감면기한:20120331)
																																																			  ELSE (CASE WHEN LEFT(ISNULL(JOIN_DATE,''),4) = @YearYyyy     --               Else Case When 입사년도 = 정산년도 ex) 소득세감면기한이 입사일후인 경우(입사일:20120601 gt 소득감면기한:20130731)
																																																						 THEN ISNULL(JOIN_DATE,'')                         --                         Then 입사일              ex) 정산년도에   입사한 경우 20120601(입사년도:2012 = 정산년도:2012)
																																																						 ELSE @YearYyyy + '0101'                           --                         Else 과세년도01월01일    ex) 정산년도전에 입사한 경우 20120101(입사년도:2011 = 정산년도:2012)
																																																					END)
																																																		 END)
					 WHEN ISNULL(YOUTH_EXEMP_DATE,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE2,'') = '' AND ISNULL(YOUTH_EXEMP_DATE3,'') != '' AND (@YearYyyy + '0101') &lt;= ISNULL(YOUTH_EXEMP_DATE3,'')  THEN (CASE WHEN (ISNULL(JOIN_DATE,'') &gt; ISNULL(YOUTH_EXEMP_DATE3,''))   --     Else Case When 입사일 gt 소득세감면기한
																																																			  THEN ''                                                      --               Then ''                            ex) 소득세감면기한이 입사일전인 경우(입사일:20120601 gt 소득감면기한:20120331)
																																																			  ELSE (CASE WHEN LEFT(ISNULL(JOIN_DATE,''),4) = @YearYyyy     --               Else Case When 입사년도 = 정산년도 ex) 소득세감면기한이 입사일후인 경우(입사일:20120601gt 소득감면기한:20130731)
																																																						 THEN ISNULL(JOIN_DATE,'')                         --                         Then 입사일              ex) 정산년도에   입사한 경우 20120601(입사년도:2012 = 정산년도:2012)
																																																						 ELSE @YearYyyy + '0101'                           --                         Else 과세년도01월01일    ex) 정산년도전에 입사한 경우 20120101(입사년도:2011 = 정산년도:2012)
																																																					END)
																																																		 END)
																																																   ELSE ''
				END)                                           AS NONTAX_FR
			 , (CASE WHEN ISNULL(YOUTH_EXEMP_DATE,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE2,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE3,'')  = ''                                                          THEN ''
					 WHEN ISNULL(YOUTH_EXEMP_DATE,'') != '' AND ISNULL(YOUTH_EXEMP_DATE2,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE3,'')  = '' AND (@YearYyyy + '0101') &lt;= ISNULL(YOUTH_EXEMP_DATE ,'') THEN (CASE WHEN (CASE WHEN RETR_DATE != '00000000' AND LEN(RETR_DATE) &gt; 0
																																																						 THEN (CASE WHEN RETR_DATE &gt; @YearYyyy + '1231'
																																																									THEN @YearYyyy + '1231'
																																																									ELSE RETR_DATE
																																																							   END)
																																																						 ELSE @YearYyyy + '1231'
																																																					END) &gt; ISNULL(YOUTH_EXEMP_DATE,'')                    --     Else Case When 퇴사일 or 과세년도12월31일 gt 소득세감면기한
																																																			  THEN ISNULL(YOUTH_EXEMP_DATE,'')                             --               Then 소득세감면기한                ex) 소득세감면기한이 퇴사일전인 경우(퇴사일:20121231 gt 소득감면기한:20120331)
																																																			  ELSE (CASE WHEN RETR_DATE != '00000000' AND LEN(RETR_DATE) &gt; 0
																																																						 THEN (CASE WHEN RETR_DATE &gt; @YearYyyy + '1231'
																																																									THEN @YearYyyy + '1231'
																																																									ELSE RETR_DATE
																																																							   END)
																																																						 ELSE @YearYyyy + '1231'
																																																					END)                                                  --               Else 퇴사일 or 과세년도12월31일    ex) 소득세감면기한이 퇴사일후인 경우(퇴사일:20121231 gt 소득감면기한:20130731)
																																																		 END)
					 WHEN ISNULL(YOUTH_EXEMP_DATE,'')  = '' AND ISNULL(YOUTH_EXEMP_DATE2,'') != '' AND ISNULL(YOUTH_EXEMP_DATE3,'')  = '' AND (@YearYyyy + '0101') &lt;= ISNULL(YOUTH_EXEMP_DATE2,'') THEN (CASE WHEN (CASE WHEN RETR_DATE != '00000000' AND LEN(RETR_DATE) &gt; 0
																																																						 THEN (CASE WHEN RETR_DATE &gt; @YearYyyy + '1231'
																																																									THEN @YearYyyy + '1231'
																																																									ELSE RETR_DATE
																																																							   END)
																																																						 ELSE @YearYyyy + '1231'
																																																					END) &gt; ISNULL(YOUTH_EXEMP_DATE2,'')                   --     Else Case When 퇴사일 or 과세년도12월31일 gt 소득세감면기한
																																																			  THEN ISNULL(YOUTH_EXEMP_DATE2,'')                            --               Then 소득세감면기한                ex) 소득세감면기한이 퇴사일전인 경우(퇴사일:20121231 gt 소득감면기한:20120331)
																																																			  ELSE (CASE WHEN RETR_DATE != '00000000' AND LEN(RETR_DATE) &gt; 0
																																																						 THEN (CASE WHEN RETR_DATE &gt; @YearYyyy + '1231'
																																																									THEN @YearYyyy + '1231'
																																																									ELSE RETR_DATE
																																																							   END)
																																																						 ELSE @YearYyyy + '1231'
																																																					END)                                                  --               Else 퇴사일 or 과세년도12월31일    ex) 소득세감면기한이 퇴사일후인 경우(퇴사일:20121231 &gt;t 소득감면기한:20130731)
																																																		 END)
					 WHEN ISNULL(YOUTH_EXEMP_DATE,'') = '' AND ISNULL(YOUTH_EXEMP_DATE2,'') = '' AND ISNULL(YOUTH_EXEMP_DATE3,'') != '' AND (@YearYyyy + '0101') &lt;= ISNULL(YOUTH_EXEMP_DATE3,'') THEN (CASE WHEN (CASE WHEN RETR_DATE != '00000000' AND LEN(RETR_DATE) &gt; 0
																																																					   THEN (CASE WHEN RETR_DATE &gt; @YearYyyy + '1231'
																																																								  THEN @YearYyyy + '1231'
																																																								  ELSE RETR_DATE
																																																							 END)
																																																					   ELSE @YearYyyy + '1231'
																																																				  END) &gt; ISNULL(YOUTH_EXEMP_DATE3,'')                   --     Else Case When 퇴사일 or 과세년도12월31일 gt 소득세감면기한
																																																			THEN ISNULL(YOUTH_EXEMP_DATE3,'')                            --               Then 소득세감면기한                ex) 소득세감면기한이 퇴사일전인 경우(퇴사일:20121231 gt 소득감면기한:20120331)
																																																			ELSE (CASE WHEN RETR_DATE != '00000000' AND LEN(RETR_DATE) &gt; 0
																																																					   THEN (CASE WHEN RETR_DATE &gt; @YearYyyy + '1231'
																																																								  THEN @YearYyyy + '1231'
																																																								  ELSE RETR_DATE
																																																							 END)
																																																					   ELSE @YearYyyy + '1231'
																																																				  END)                                                  --               Else 퇴사일 or 과세년도12월31일    ex) 소득세감면기한이 퇴사일후인 경우(퇴사일:20121231 gt 소득감면기한:20130731)
																																																		END)
																																							ELSE ''
				 END)                                           AS NONTAX_TO
			 , @IncomeSuppTotalI                                AS INCOME_SUPP_TOTAL_I         --총급여액
			 , @NowPayAmt                                       AS NOW_PAY_AMT                 --주(현)총급여액
			 , @NowPayTotI                                      AS NOW_PAY_TOT_I               --[숨김]주(현)급여총액
			 , @NowBonusTotalI                                  AS NOW_BONUS_TOTAL_I           --[숨김]주(현)상여총액
			 , @NowAddBonusI                                    AS NOW_ADD_BONUS_I             --[숨김]주(현)인정상여금액
			 , @NowStockProfitI                                 AS NOW_STOCK_PROFIT_I          --[숨김]주(현)주식매수선택행사이익
			 , @NowOwnerStockDrawI                              AS NOW_OWNER_STOCK_DRAW_I      --[숨김]주(현)우리사주조합인출금
			 , @NowOfRetrOverI                                  AS NOW_OF_RETR_OVER_I          --[숨김]주(현)임원퇴직한도초과액
			 , @OldPayAmt                                       AS OLD_PAY_AMT                 --종(전)총급여액
			 , @OldPayTotI                                      AS OLD_PAY_TOT_I               --[숨김]종(전)급여총액
			 , @OldBonusTotalI                                  AS OLD_BONUS_TOTAL_I           --[숨김]종(전)상여총액
			 , @OldAddBonusI                                    AS OLD_ADD_BONUS_I             --[숨김]종(전)인정상여금액
			 , @OldStockProfitI                                 AS OLD_STOCK_PROFIT_I          --[숨김]종(전)주식매수선택행사이익
			 , @OldOwnerStockDrawI                              AS OLD_OWNER_STOCK_DRAW_I      --[숨김]종(전)우리사주조합인출금
			 , @OldOfRetrOverI                                  AS OLD_OF_RETR_OVER_I          --[숨김]종(전)임원퇴직한도초과액
			 , @NapPayAmt                                       AS NAP_PAY_AMT                 --(납)총급여액
			 , @NapPayTotI                                      AS NAP_PAY_TOT_I               --[숨김](납)급여총액
			 , @NapBonusTotalI                                  AS NAP_BONUS_TOTAL_I           --[숨김](납)상여총액
			 , @IncomeDedI                                      AS INCOME_DED_I                --근로소득공제
			 , @EarnIncomeI                                     AS EARN_INCOME_I               --근로소득금액
			 , @PerDedI                                         AS PER_DED_I                   --본인공제
			 , @Spouse                                          AS SPOUSE                      --배우자유무
			 , @SuppNum                                         AS SUPP_NUM                    --부양자
			 , @SuppNum1                                        AS SUPP_NUM_1                  --부양자:직계존속
			 , @SuppNum4                                        AS SUPP_NUM_4                  --부양자:직계비속-자녀입양자
			 , @SuppNum5                                        AS SUPP_NUM_5                  --부양자:직계비속-그외직계비속
			 , @SuppNum6                                        AS SUPP_NUM_6                  --부양자:형제자매
			 , @SuppNum7                                        AS SUPP_NUM_7                  --부양자:수급자
			 , @SuppNum8                                        AS SUPP_NUM_8                  --부양자:위탁아동
			 , @AgedNum                                         AS AGED_NUM                    --경로자
			 , @DeformNum                                       AS DEFORM_NUM                  --장애자
			 , @Woman                                           AS WOMAN                       --부녀자
			 , @ManyChildNum                                    AS MANY_CHILD_NUM              --자녀
			 , @BringChildNum                                   AS BRING_CHILD_NUM             --자녀양육
			 , @BirthAdoptNum                                   AS BIRTH_ADOPT_NUM             --출산입양
			 , @OneParent                                       AS ONE_PARENT                  --한부모
			 , @BirthAdoptNum1                                  AS BIRTH_ADOPT_NUM1            --출산입양첫째
			 , @BirthAdoptNum2                                  AS BIRTH_ADOPT_NUM2            --출산입양둘째
			 , @BirthAdoptNum3                                  AS BIRTH_ADOPT_NUM3            --출산입양셋째이상
			 , @AnuI                                            AS ANU_I                       --국민연금보험료
			 , @MedPreMinmI                                     AS MED_PREMINM_I               --건강보험료
			 , @HireInsurI                                      AS HIRE_INSUR_I                --고용보험료
			 , @MonRentI                                        AS MON_RENT_I                  --월세액
			 , @PrivPensI                                       AS PRIV_PENS_I                 --개인연금저축
			 , @HousBuAmt                                       AS HOUS_BU_AMT                 --청약저축
			 , @HousBuAddAmt                                    AS HOUS_BU_ADD_AMT             --청약저축(120만원한도)
			 , @HousWorkAmt                                     AS HOUS_WORK_AMT               --근로자주택마련저축
			 , @HousAmountI                                     AS HOUS_AMOUNT_I               --주택청약종합저축
			 , @HousAmountAddI                                  AS HOUS_AMOUNT_ADD_I           --주택청약종합저축(120만원한도)
			 , @CardUseI                                        AS CARD_USE_I                  --신용카드사용액
			 , @CashUseI                                        AS CASH_USE_I                  --현금영수증사용액
			 , @DebitCardUseI                                   AS DEBIT_CARD_USE_I            --직불카드사용액
			 , @TraMarketUseI                                   AS TRA_MARKET_USE_I            --전통시장사용액
			 , @TrafficUseI                                     AS TRAFFIC_USE_I               --대중교통이용액
			 , @SciDeducI                                       AS SCI_DEDUC_I                 --과학기술인공제
			 , @RetirePensI                                     AS RETIRE_PENS_I               --근로자퇴직급여보장법
			 , @PensI                                           AS PENS_I                      --연금저축
			 , @LongInvestStockI                                AS LONG_INVEST_STOCK_I         --장기집합투자증권저축
			 , @EtcInsurI                                       AS ETC_INSUR_I                 --보장성보험
			 , @DeformInsurI                                    AS DEFORM_INSUR_I              --장애인전용보장성보험
			 , @MyMedDedI                                       AS MY_MED_DED_I                --본인의료비
			 , @SeniorMedI                                      AS SENIOR_MED_I                --경로의료비
			 , @DeformMedI                                      AS DEFORM_MED_I                --장애의료비
			 , @SurgeryMedI                                     AS SURGERY_MED_I               --난임시술비
			 , @MedTotalI                                       AS MED_TOTAL_I                 --그밖의 공제대상자 의료비
			 , @PerEducI                                        AS PER_EDUC_I                  --본인교육비
			 , @UnivEducNum                                     AS UNIV_EDUC_NUM               --대학교자녀수
			 , @UnivEducI                                       AS UNIV_EDUC_I                 --대학교교육비
			 , @StudEducNum                                     AS STUD_EDUC_NUM               --초중고자녀수
			 , @StudEducI                                       AS STUD_EDUC_I                 --초중고교육비
			 , @KindEduNum                                      AS KIND_EDU_NUM                --유치원자녀수
			 , @KindEducI                                       AS KIND_EDUC_I                 --유치원교육비
			 , @DeformEducNum                                   AS DEFORM_EDUC_NUM             --장애인수
			 , @DeformEducI                                     AS DEFORM_EDUC_I               --장애인특수교육비
			 , @FieldEducI                                      AS FIELD_EDUC_I                --체험학습비
			 , @EduPrincipalRtnI    							AS EDU_PRINCIPAL_RTN_I		   --학자금원리금상환액
			 , @PerEducDedI                                     AS PER_EDUC_DED_I              --본인교육비공제
			 , @UnivEducDedI                                    AS UNIV_EDUC_DED_I             --대학교교육비공제
			 , @StudEducDedI                                    AS STUD_EDUC_DED_I             --초중고교육비공제
			 , @KindEducDedI                                    AS KIND_EDUC_DED_I             --유치원교육비공제
			 , @DeformEducDedI                                  AS DEFORM_EDUC_DED_I           --장애인특수교육비공제
			 , @FieldEducDedI                                   AS FIELD_EDUC_DED_I            --체험학습비공제
			 , @PolicyInded                                     AS POLICY_INDED                --정치자금기부금공제
			 , @PolicyGiftI                                     AS POLICY_GIFT_I               --정치자금기부금
			 , @LegalGiftIPrev                                  AS LEGAL_GIFT_I_PREV           --법정기부금(전년도이월액)-2013
			 , @LegalGiftIPrev14                                AS LEGAL_GIFT_I_PREV_14        --법정기부금(전년도이월액)-2014
			 , @LegalGiftI                                      AS LEGAL_GIFT_I                --법정기부금
			 , @PrivGiftIPrev                                   AS PRIV_GIFT_I_PREV            --특례기부금(전년도이월액)
			 , @PrivGiftI                                       AS PRIV_GIFT_I                 --특례기부금
			 , @PublicGiftIPrev                                 AS PUBLIC_GIFT_I_PREV          --공익법인신탁기부금(전년도이월액)
			 , @PublicGiftI                                     AS PUBLIC_GIFT_I               --공익법인신탁기부금
			 , @StaffGiftI                                      AS STAFF_GIFT_I                --우리사주기부금
			 , @AppointGiftIPrev                                AS APPOINT_GIFT_I_PREV         --지정기부금(전년도이월액)-2013
			 , @AppointGiftIPrev14                              AS APPOINT_GIFT_I_PREV_14      --지정기부금(전년도이월액)-2014
			 , @AppointGiftI                                    AS APPOINT_GIFT_I              --지정기부금
			 , @AssGiftIPrev                                    AS ASS_GIFT_I_PREV             --종교단체기부금(전년도이월액)-2013
			 , @AssGiftIPrev14                                  AS ASS_GIFT_I_PREV_14          --종교단체기부금(전년도이월액)-2014
			 , @AssGiftI                                        AS ASS_GIFT_I                  --종교단체기부금
          FROM            HUM100T A  WITH (NOLOCK)
               LEFT  JOIN BSA100T M1 WITH (NOLOCK) ON M1.COMP_CODE  = A.COMP_CODE
                                                  AND M1.MAIN_CODE  = N'H005'
                                                  AND M1.SUB_CODE   = A.POST_CODE
               LEFT  JOIN HBS400T C  WITH (NOLOCK) ON C.COMP_CODE = A.COMP_CODE
         WHERE A.COMP_CODE   = @CompCode
           AND A.PERSON_NUMB = @PersonNumb
    
        SET NOCOUNT OFF
        SET ARITHABORT OFF
    END
 
	</select>
	<update id="had617ukrServiceImpl.batchSummaryData" parameterType="rMap" >
	--Had617UKr.CHad617UKr[fnHad617QCol] Query03
   --**********************************************************************************************************************
   --  정산입력자료 집계/저장
   --**********************************************************************************************************************/
    BEGIN
        DECLARE @CompCode           NVARCHAR(08)                -- (필수) 법인코드
              , @YearYyyy           NVARCHAR(04)                -- (필수) 정산년도
              , @PersonNumb         NVARCHAR(10)                -- (필수) 사번
              , @UserId             NVARCHAR(100)                -- (필수) 사용자ID
              , @ForeignNum         NVARCHAR(20)                -- (필수) 외국인번호
              , @ForeSingleYn       NVARCHAR(01)                -- (필수) 외국인단일세율적용여부
              , @ForeDispachYn      NVARCHAR(01)                -- (필수) 외국법인소속 파견근로자 여부
    
        DECLARE @IncomeSuppTotalI   NUMERIC(30,6)
		  , @NowPayAmt          NUMERIC(30,6), @NowPayTotI         NUMERIC(30,6), @NowBonusTotalI     NUMERIC(30,6)
		  , @NowAddBonusI       NUMERIC(30,6), @NowStockProfitI    NUMERIC(30,6), @NowOwnerStockDrawI NUMERIC(30,6)
		  , @NowOfRetrOverI     NUMERIC(30,6)
		  , @OldPayAmt          NUMERIC(30,6), @OldPayTotI         NUMERIC(30,6), @OldBonusTotalI     NUMERIC(30,6)
		  , @OldAddBonusI       NUMERIC(30,6), @OldStockProfitI    NUMERIC(30,6), @OldOwnerStockDrawI NUMERIC(30,6)
		  , @OldOfRetrOverI     NUMERIC(30,6)
		  , @NapPayAmt          NUMERIC(30,6), @NapPayTotI         NUMERIC(30,6), @NapBonusTotalI     NUMERIC(30,6)
		  , @IncomeDedI         NUMERIC(30,6), @EarnIncomeI        NUMERIC(30,6)
		  , @PerDedI            NUMERIC(30,6), @Spouse             NVARCHAR(01) , @SuppNum            NUMERIC(30,6)
		  , @SuppNum1           NUMERIC(30,6), @SuppNum4           NUMERIC(30,6), @SuppNum5           NUMERIC(30,6)
		  , @SuppNum6           NUMERIC(30,6), @SuppNum7           NUMERIC(30,6), @SuppNum8           NUMERIC(30,6)
		  , @AgedNum            NUMERIC(30,6), @DeformNum          NUMERIC(30,6), @ManyChildNum       NUMERIC(30,6)
		  , @BringChildNum      NUMERIC(30,6), @BirthAdoptNum      NUMERIC(30,6), @Woman              NVARCHAR(01)
		  , @OneParent          NVARCHAR(01)
	      , @BirthAdoptNum1     NUMERIC(30,6), @BirthAdoptNum2     NUMERIC(30,6), @BirthAdoptNum3     NUMERIC(30,6)
		  , @AnuI               NUMERIC(30,6), @MedPreMinmI        NUMERIC(30,6), @HireInsurI         NUMERIC(30,6)
		  , @MonRentI           NUMERIC(30,6)
		  , @PrivPensI          NUMERIC(30,6)
		  , @HousBuAmt          NUMERIC(30,6), @HousWorkAmt        NUMERIC(30,6), @HousAmountI        NUMERIC(30,6)
		  , @HousBuAddAmt       NUMERIC(30,6), @HousAmountAddI     NUMERIC(30,6)
		  , @CardUseI           NUMERIC(30,6), @CashUseI           NUMERIC(30,6), @DebitCardUseI      NUMERIC(30,6)
		  , @TraMarketUseI      NUMERIC(30,6), @TrafficUseI        NUMERIC(30,6)
		  , @SciDeducI          NUMERIC(30,6), @RetirePensI        NUMERIC(30,6), @PensI              NUMERIC(30,6)
		  , @LongInvestStockI   NUMERIC(30,6)
		  , @EtcInsurI          NUMERIC(30,6), @DeformInsurI       NUMERIC(30,6)
		  , @MyMedDedI          NUMERIC(30,6), @SeniorMedI         NUMERIC(30,6), @DeformMedI         NUMERIC(30,6)
		  , @SurgeryMedI        NUMERIC(30,6), @MedTotalI          NUMERIC(30,6)
		  , @PerEducI           NUMERIC(30,6), @UnivEducNum        NUMERIC(30,6), @UnivEducI          NUMERIC(30,6)
		  , @StudEducNum        NUMERIC(30,6), @StudEducI          NUMERIC(30,6), @KindEduNum         NUMERIC(30,6)
		  , @KindEducI          NUMERIC(30,6), @DeformEducNum      NUMERIC(30,6), @DeformEducI        NUMERIC(30,6)
		  , @FieldEducI	        NUMERIC(30,6), @EduPrincipalRtnI	NUMERIC(30,6)
		  , @PerEducDedI        NUMERIC(30,6), @UnivEducDedI       NUMERIC(30,6), @StudEducDedI       NUMERIC(30,6)
		  , @KindEducDedI       NUMERIC(30,6), @DeformEducDedI     NUMERIC(30,6), @FieldEducDedI	  NUMERIC(30,6)			
		  , @PolicyInded        NUMERIC(30,6)
		  , @PolicyGiftI        NUMERIC(30,6), @LegalGiftIPrev     NUMERIC(30,6), @LegalGiftIPrev14   NUMERIC(30,6)
		  , @LegalGiftI         NUMERIC(30,6), @PrivGiftIPrev      NUMERIC(30,6), @PrivGiftI          NUMERIC(30,6)
		  , @PublicGiftIPrev    NUMERIC(30,6), @PublicGiftI        NUMERIC(30,6), @StaffGiftI         NUMERIC(30,6)
		  , @AppointGiftIPrev   NUMERIC(30,6), @AppointGiftIPrev14 NUMERIC(30,6), @AppointGiftI       NUMERIC(30,6)
		  , @AssGiftIPrev       NUMERIC(30,6), @AssGiftIPrev14     NUMERIC(30,6), @AssGiftI           NUMERIC(30,6)
    
        SET NOCOUNT ON
        SET ARITHABORT ON
    
    --  1. 변수 값 할당 -------------------------------------------------------------------------------------------------
        SET @CompCode      = #{S_COMP_CODE}
        SET @YearYyyy      = #{YEAR_YYYY}
        SET @PersonNumb    = #{PERSON_NUMB}
        SET @UserId        = #{S_USER_ID}
        SET @ForeignNum    = #{FOREIGN_NUM}
        SET @ForeSingleYn  = #{FORE_SINGLE_YN}
        SET @ForeDispachYn = #{FOREIGN_DISPATCH_YN}
    
    --  2. 데이터 조회 --------------------------------------------------------------------------------------------------
        --(조정)비과세소득
		EXEC sp2017YearEndTax305SetNontaxableIncome @CompCode, @YearYyyy, @PersonNumb, @UserId
	
		--(조정)기부금내역 조정
		EXEC sp2017YearEndTax310SetContribution @CompCode, @YearYyyy, @PersonNumb, @UserId
	
		--(집계)총급여액
		IF @ForeignNum != '' AND @ForeSingleYn = 'Y'
			SELECT @IncomeSuppTotalI   = INCOME_SUPP_TOTAL_I
				 , @NowPayAmt          = NOW_PAY_AMT
				 , @NowPayTotI         = NOW_PAY_TOT_I
				 , @NowBonusTotalI     = NOW_BONUS_TOTAL_I
				 , @NowAddBonusI       = NOW_ADD_BONUS_I
				 , @NowStockProfitI    = NOW_STOCK_PROFIT_I
				 , @NowOwnerStockDrawI = NOW_OWNER_STOCK_DRAW_I
				 , @NowOfRetrOverI     = 0
				 , @OldPayAmt          = OLD_PAY_AMT
				 , @OldPayTotI         = OLD_PAY_TOT_I
				 , @OldBonusTotalI     = OLD_BONUS_TOTAL_I
				 , @OldAddBonusI       = OLD_ADD_BONUS_I
				 , @OldStockProfitI    = OLD_STOCK_PROFIT_I
				 , @OldOwnerStockDrawI = OLD_OWNER_STOCK_DRAW_I
				 , @OldOfRetrOverI     = 0
				 , @NapPayAmt          = NAP_PAY_AMT
				 , @NapPayTotI         = NAP_PAY_TOT_I
				 , @NapBonusTotalI     = NAP_BONUS_TOTAL_I
			  FROM uniLITE.fn2017YearEndTax102GetIncomeSuppTotalIForeign(@CompCode, @YearYyyy, @PersonNumb)
		ELSE
			SELECT @IncomeSuppTotalI   = INCOME_SUPP_TOTAL_I
				 , @NowPayAmt          = NOW_PAY_AMT
				 , @NowPayTotI         = NOW_PAY_TOT_I
				 , @NowBonusTotalI     = NOW_BONUS_TOTAL_I
				 , @NowAddBonusI       = NOW_ADD_BONUS_I
				 , @NowStockProfitI    = NOW_STOCK_PROFIT_I
				 , @NowOwnerStockDrawI = NOW_OWNER_STOCK_DRAW_I
				 , @NowOfRetrOverI     = NOW_OF_RETR_OVER_I
				 , @OldPayAmt          = OLD_PAY_AMT
				 , @OldPayTotI         = OLD_PAY_TOT_I
				 , @OldBonusTotalI     = OLD_BONUS_TOTAL_I
				 , @OldAddBonusI       = OLD_ADD_BONUS_I
				 , @OldStockProfitI    = OLD_STOCK_PROFIT_I
				 , @OldOwnerStockDrawI = OLD_OWNER_STOCK_DRAW_I
				 , @OldOfRetrOverI     = OLD_OF_RETR_OVER_I
				 , @NapPayAmt          = NAP_PAY_AMT
				 , @NapPayTotI         = NAP_PAY_TOT_I
				 , @NapBonusTotalI     = NAP_BONUS_TOTAL_I
			  FROM uniLITE.fn2017YearEndTax101GetIncomeSuppTotalI(@CompCode, @YearYyyy, @PersonNumb)
	
		--(계산)근로소득공제/근로소득금액
		SELECT @IncomeDedI  = INCOME_DED_I
			 , @EarnIncomeI = EARN_INCOME_I
		  FROM uniLITE.fn2017YearEndTax205CalIncomeDed(@CompCode, @YearYyyy, @IncomeSuppTotalI)
	
		--(집계)인적정보
		SELECT @Spouse         = SPOUSE
			 , @SuppNum        = SUPP_NUM
			 , @SuppNum1       = SUPP_NUM_1
			 , @SuppNum4       = SUPP_NUM_4
			 , @SuppNum5       = SUPP_NUM_5
			 , @SuppNum6       = SUPP_NUM_6
			 , @SuppNum7       = SUPP_NUM_7
			 , @SuppNum8       = SUPP_NUM_8
			 , @AgedNum        = AGED_NUM
			 , @DeformNum      = DEFORM_NUM
			 , @ManyChildNum   = MANY_CHILD_NUM
			 , @BringChildNum  = BRING_CHILD_NUM
			 , @BirthAdoptNum  = BIRTH_ADOPT_NUM
			 , @Woman          = WOMAN
			 , @OneParent      = ONE_PARENT
			 , @BirthAdoptNum1 = BIRTH_ADOPT_NUM1
			 , @BirthAdoptNum2 = BIRTH_ADOPT_NUM2
			 , @BirthAdoptNum3 = BIRTH_ADOPT_NUM3
		  FROM uniLITE.fn2017YearEndTax105GetPersonlInfo(@CompCode, @YearYyyy, @PersonNumb)
	
		--(계산)인적공제금액(기본공제/추가공제)
		SELECT @PerDedI = PER_DED_I
		  FROM uniLITE.fn2017YearEndTax210CalPersonlDed(@CompCode, @YearYyyy, @Spouse
																			, @SuppNum
																			, @AgedNum
																			, @DeformNum
																			, @Woman
																			, @OneParent
																			, @EarnIncomeI)
	
		--(집계)국민연금/건강보험/고용보험/보장성보험/장애인전용보장성보험
		SELECT @AnuI         = ANU_I
			 , @MedPreMinmI  = MED_PREMINM_I
			 , @HireInsurI   = HIRE_INSUR_I
			 , @EtcInsurI    = ETC_INSUR_I
			 , @DeformInsurI = DEFORM_INSUR_I
		  FROM uniLITE.fn2017YearEndTax110GetInsurance(@CompCode, @YearYyyy, @PersonNumb)
	
		--(집계)연금저축/주택마련
		SELECT @PrivPensI        = PRIV_PENS_I
			 , @SciDeducI        = SCI_DEDUC_I
			 , @RetirePensI      = RETIRE_PENS_I
			 , @PensI            = PENS_I
			 , @HousBuAmt        = HOUS_BU_AMT
			 , @HousBuAddAmt     = HOUS_BU_ADD_AMT
			 , @HousWorkAmt      = HOUS_WORK_AMT
			 , @HousAmountI      = HOUS_AMOUNT_I
			 , @HousAmountAddI   = HOUS_AMOUNT_ADD_I
			 , @LongInvestStockI = LONG_INVEST_STOCK_I
		  FROM uniLITE.fn2017YearEndTax115GetSavings(@CompCode, @YearYyyy, @PersonNumb)
	
		--(집계)월세액
		SELECT @MonRentI  = MON_RENT_I
		  FROM uniLITE.fn2017YearEndTax120GetMonthlyRent(@CompCode, @YearYyyy, @PersonNumb)
	
		--(집계)신용카드등
		SELECT @CardUseI         = CARD_USE_I
			 , @CashUseI         = CASH_USE_I
			 , @DebitCardUseI    = DEBIT_CARD_USE_I
			 , @TraMarketUseI    = TRA_MARKET_USE_I
			 , @TrafficUseI      = TRAFFIC_USE_I
		  FROM uniLITE.fn2017YearEndTax125GetCreditEtc(@CompCode, @YearYyyy, @PersonNumb)
	
		--(집계)의료비
		SELECT @MyMedDedI   = MY_MED_DED_I
			 , @SeniorMedI  = SENIOR_MED_I
			 , @DeformMedI  = DEFORM_MED_I
			 , @SurgeryMedI = SURGERY_MED_I
			 , @MedTotalI   = MED_TOTAL_I
		  FROM uniLITE.fn2017YearEndTax130GetMedicalExpenses(@CompCode, @YearYyyy, @PersonNumb)
	
		--(집계)교육비
		SELECT @PerEducI      = PER_EDUC_I
			 , @UnivEducNum   = UNIV_EDUC_NUM
			 , @UnivEducI     = UNIV_EDUC_I
			 , @StudEducNum   = STUD_EDUC_NUM
			 , @StudEducI     = STUD_EDUC_I
			 , @KindEduNum    = KIND_EDU_NUM
			 , @KindEducI     = KIND_EDUC_I
			 , @DeformEducNum = DEFORM_EDUC_NUM
			 , @DeformEducI   = DEFORM_EDUC_I
			 , @FieldEducI    = FIELD_EDUC_I
		  FROM uniLITE.fn2017YearEndTax135GetEducationExpenses(@CompCode, @YearYyyy, @PersonNumb)
	
		--(계산)교육비
		SELECT @PerEducDedI    = PER_EDUC_DED_I
			 , @UnivEducDedI   = UNIV_EDUC_DED_I
			 , @StudEducDedI   = STUD_EDUC_DED_I
			 , @KindEducDedI   = KIND_EDUC_DED_I
			 , @DeformEducDedI = DEFORM_EDUC_DED_I
			 , @FieldEducDedI  = FIELD_EDUC_DED_I
		  FROM uniLITE.fn2017YearEndTax270CalEducationExpenses(@CompCode, @YearYyyy, @PersonNumb)
	
		--(집계)기부금
		SELECT @PolicyGiftI        = POLICY_GIFT_I
			 , @LegalGiftIPrev     = LEGAL_GIFT_I_PREV
			 , @LegalGiftIPrev14   = LEGAL_GIFT_I_PREV_14
			 , @LegalGiftI         = LEGAL_GIFT_I
			 , @PrivGiftIPrev      = PRIV_GIFT_I_PREV
			 , @PrivGiftI          = PRIV_GIFT_I
			 , @PublicGiftIPrev    = PUBLIC_GIFT_I_PREV
			 , @PublicGiftI        = PUBLIC_GIFT_I
			 , @StaffGiftI         = STAFF_GIFT_I
			 , @AppointGiftIPrev   = APPOINT_GIFT_I_PREV
			 , @AppointGiftIPrev14 = APPOINT_GIFT_I_PREV_14
			 , @AppointGiftI       = APPOINT_GIFT_I
			 , @AssGiftIPrev       = ASS_GIFT_I_PREV
			 , @AssGiftIPrev14     = ASS_GIFT_I_PREV_14
			 , @AssGiftI           = ASS_GIFT_I
			 , @PolicyInded        = POLICY_INDED
		  FROM uniLITE.fn2017YearEndTax140GetContribution(@CompCode, @YearYyyy, @PersonNumb)
    
   
        DECLARE @NonTaxFr           NVARCHAR(08) , @NonTaxTo           NVARCHAR(08) , @HalfwayType        NVARCHAR(01)
			  , @HouseholderYn      NVARCHAR(01) , @AnuAddI            NUMERIC(30,6), @PublicPensI        NUMERIC(30,6)
			  , @SoldierPensI       NUMERIC(30,6), @SchPensI           NUMERIC(30,6), @PostPensI          NUMERIC(30,6)
			  , @MedPreMinmAddI     NUMERIC(30,6)
			  , @HousAmountTotI     NUMERIC(30,6), @HousAmountTotI2    NUMERIC(30,6)
			  , @HousAmountInterI2  NUMERIC(30,6), @HousAmountInterI   NUMERIC(30,6), @HousAmountInterI3  NUMERIC(30,6)
			  , @FixedRateLoan      NUMERIC(30,6), @EtcLoan            NUMERIC(30,6)
			  , @HousAmountInterI6  NUMERIC(30,6), @HousAmountInterI7  NUMERIC(30,6), @HousAmountInterI8  NUMERIC(30,6)
			  , @HousAmountInterI9  NUMERIC(30,6)
			  --, @CardSelfUse2013I   NUMERIC(30,6), @CardSelfUse2014I   NUMERIC(30,6), @CardSelfUse2015I   NUMERIC(30,6)
			  --, @AddSelfUse2013I    NUMERIC(30,6), @AddSelfUse2014I    NUMERIC(30,6), @AddSelfUse2015FI   NUMERIC(30,6)
			  --, @AddSelfUse2015SI   NUMERIC(30,6)
			  , @CompPreminumI      NUMERIC(30,6), @InvestmentI        NUMERIC(30,6), @InvestmentI3       NUMERIC(30,6)
			  , @InvestmentI4       NUMERIC(30,6), @InvestmentI2       NUMERIC(30,6), @InvestmentI5       NUMERIC(30,6)
			  , @InvestmentI6       NUMERIC(30,6), @InvestmentI7       NUMERIC(30,6), @InvestmentI8       NUMERIC(30,6)
			  , @InvestmentI9       NUMERIC(30,6), @InvestmentI10      NUMERIC(30,6), @InvestmentI11      NUMERIC(30,6)
			  , @StaffStockI        NUMERIC(30,6), @EmployWorkerI      NUMERIC(30,6), @NotAmountLoanI     NUMERIC(30,6)
			  , @IncomeReduI        NUMERIC(30,6), @TaxesReduI         NUMERIC(30,6)
			  , @HousInterI         NUMERIC(30,6), @ForeIncomeI        NUMERIC(30,6), @ForeTaxI           NUMERIC(30,6)

		DECLARE @P3CompanyNum       NVARCHAR(20) , @P3CompanyName      NVARCHAR(30) , @P3WorkDateFr       NVARCHAR(08)
			  , @P3WorkDateTo       NVARCHAR(08) , @P3NonTaxFr         NVARCHAR(08) , @P3NonTaxTo         NVARCHAR(08)
			  , @P3PayTotalI        NUMERIC(30,6), @P3BonusTotalI      NUMERIC(30,6), @P3InTaxI           NUMERIC(30,6)
			  , @P3LocalTaxI        NUMERIC(30,6), @P3SpTaxI           NUMERIC(30,6), @P3TaxDedI          NUMERIC(30,6)
    
        IF EXISTS (SELECT TOP 1 1
                     FROM HAD400T WITH (NOLOCK)
                    WHERE COMP_CODE   = @CompCode
                      AND YEAR_YYYY   = @YearYyyy
                      AND PERSON_NUMB = @PersonNumb)
        BEGIN
            SELECT @NonTaxFr          = ISNULL(B.NONTAX_FR             ,'')        --세액감면기간(Fr)
				 , @NonTaxTo          = ISNULL(B.NONTAX_TO             ,'')        --세액감면기간(To)
				 , @HalfwayType       = (CASE WHEN A.RETR_DATE != '00000000' AND LEN(A.RETR_DATE) &gt; 0 AND RIGHT(A.RETR_DATE,4) != '1231' AND LEFT(A.RETR_DATE,4) &lt;= @YearYyyy 
											  THEN 'Y'
											  ELSE CASE WHEN RIGHT(A.RETR_DATE,4) = '1231' AND ISNULL(C.YEARENDTAX_CALCU_RULE,'1') = '2' 
														THEN 'Y'
														ELSE 'N'
												   END
										  END)                                     --중도퇴사자정산여부
				 , @HouseholderYn     = ISNULL(B.HOUSEHOLDER_YN        ,'2')       --세대주여부
				 , @ForeDispachYn     = ISNULL(B.FOREIGN_DISPATCH_YN   ,'N')       --외국법인소속 파견근로자여부
				 , @AnuAddI           = ISNULL(B.ANU_ADD_I             , 0)        --(직접입력항목)국민연금보험료
				 , @PublicPensI       = ISNULL(B.PUBLIC_PENS_I         , 0)        --(직접입력항목)공무원연금
				 , @SoldierPensI      = ISNULL(B.SOLDIER_PENS_I        , 0)        --(직접입력항목)군인연금
				 , @SchPensI          = ISNULL(B.SCH_PENS_I            , 0)        --(직접입력항목)사립학교교직원연금
				 , @PostPensI         = ISNULL(B.POST_PENS_I           , 0)        --(직접입력항목)별정우체국연금
				 , @MedPreMinmAddI    = ISNULL(B.MED_PREMINM_ADD_I     , 0)        --(직접입력항목)건강보험료
				 , @HousAmountTotI    = ISNULL(B.HOUS_AMOUNT_TOT_I     , 0)        --(직접입력항목)원리금상환액(대출기관)
				 , @HousAmountTotI2   = ISNULL(B.HOUS_AMOUNT_TOT_I_2   , 0)        --(직접입력항목)원리금상환액(거주자)
				 , @HousAmountInterI2 = ISNULL(B.HOUS_AMOUNT_INTER_I_2 , 0)        --(직접입력항목)주택자금이자상환액(15년미만)
				 , @HousAmountInterI  = ISNULL(B.HOUS_AMOUNT_INTER_I   , 0)        --(직접입력항목)주택자금이자상환액(15년~29년)
				 , @HousAmountInterI3 = ISNULL(B.HOUS_AMOUNT_INTER_I_3 , 0)        --(직접입력항목)주택자금이자상환액(30년이상)
				 , @FixedRateLoan     = ISNULL(B.FIXED_RATE_LOAN       , 0)        --(직접입력항목)고정금리비거치상환대출
				 , @EtcLoan           = ISNULL(B.ETC_LOAN              , 0)        --(직접입력항목)기타대출
				 , @HousAmountInterI6 = ISNULL(B.HOUS_AMOUNT_INTER_I_6 , 0)        --(직접입력항목)15년이상(고정금리이면서 비거치상환)
				 , @HousAmountInterI7 = ISNULL(B.HOUS_AMOUNT_INTER_I_7 , 0)        --(직접입력항목)15년이상(고정금리이거나 비거치상환)
				 , @HousAmountInterI8 = ISNULL(B.HOUS_AMOUNT_INTER_I_8 , 0)        --(직접입력항목)15년이상(그밖의대출)
				 , @HousAmountInterI9 = ISNULL(B.HOUS_AMOUNT_INTER_I_9 , 0)        --(직접입력항목)10년이상(고정금리이거나 비거치상환)
				 
				 , @CompPreminumI     = ISNULL(B.COMP_PREMINUM_I       , 0)        --(직접입력항목)소기업소상공인공제부금
				 , @InvestmentI       = ISNULL(B.INVESTMENT_I          , 0)        --(직접입력항목)투자조합출자(2012년이전 10%해당분)
				 , @InvestmentI3      = ISNULL(B.INVESTMENT_I3         , 0)        --(직접입력항목)투자조합출자(2012년 20%해당분)
				 , @InvestmentI4      = ISNULL(B.INVESTMENT_I4         , 0)        --(직접입력항목)투자조합출자(2013년 10%해당분)
				 , @InvestmentI2      = ISNULL(B.INVESTMENT_I2         , 0)        --(직접입력항목)투자조합출자(2013년 30%해당분)
				 , @InvestmentI5      = ISNULL(B.INVESTMENT_I5         , 0)        --(직접입력항목)투자조합출자(2014년 10%해당분)
				 , @InvestmentI6      = ISNULL(B.INVESTMENT_I6         , 0)        --(직접입력항목)투자조합출자(2014년 50%해당분)
				 , @InvestmentI7      = ISNULL(B.INVESTMENT_I7         , 0)        --(직접입력항목)투자조합출자(2014년 30%해당분)
				 , @InvestmentI8      = ISNULL(B.INVESTMENT_I8         , 0)        --(직접입력항목)투자조합출자(2015년 10%해당분)
				 , @InvestmentI9      = ISNULL(B.INVESTMENT_I9         , 0)        --(직접입력항목)투자조합출자(2015년100%해당분)
				 , @InvestmentI10     = ISNULL(B.INVESTMENT_I10        , 0)        --(직접입력항목)투자조합출자(2015년 50%해당분)
				 , @InvestmentI11     = ISNULL(B.INVESTMENT_I11        , 0)        --(직접입력항목)투자조합출자(2015년 30%해당분)
				 , @StaffStockI       = ISNULL(B.STAFF_STOCK_I         , 0)        --(직접입력항목)우리사주조합출연
				 , @EmployWorkerI     = ISNULL(B.EMPLOY_WORKER_I       , 0)        --(직접입력항목)고용유지중소기업근로자소득공제
				 , @NotAmountLoanI    = 0                                          --(직접입력항목)목돈안드는전세이자상환액(2016년귀속 삭제)
				 , @IncomeReduI       = ISNULL(B.INCOME_REDU_I         , 0)        --(직접입력항목)소득세법
				 , @TaxesReduI        = ISNULL(B.TAXES_REDU_I          , 0)        --(직접입력항목)조세조약
				 , @HousInterI        = ISNULL(B.HOUS_INTER_I          , 0)        --(직접입력항목)주택자금상환액
				 , @ForeIncomeI       = ISNULL(B.FORE_INCOME_I         , 0)        --(직접입력항목)외국납부소득금액
				 , @ForeTaxI          = ISNULL(B.FORE_TAX_I            , 0)        --(직접입력항목)외국납부세액
				 , @P3CompanyNum      = ISNULL(B.P3_COMPANY_NUM        , '')
				 , @P3CompanyName     = ISNULL(B.P3_COMPANY_NAME       , '')
				 , @P3WorkDateFr      = ISNULL(B.P3_WORKDATE_FR        , '')
				 , @P3WorkDateTo      = ISNULL(B.P3_WORKDATE_TO        , '')
				 , @P3NonTaxFr        = ISNULL(B.P3_NONTAX_FR          , '')
				 , @P3NonTaxTo        = ISNULL(B.P3_NONTAX_TO          , '')
				 , @P3PayTotalI       = ISNULL(B.P3_PAY_TOTAL_I        , 0)
				 , @P3BonusTotalI     = ISNULL(B.P3_BONUS_I_TOTAL_I    , 0)
				 , @P3InTaxI          = ISNULL(B.P3_IN_TAX_I           , 0)
				 , @P3LocalTaxI       = ISNULL(B.P3_LOCAL_TAX_I        , 0)
				 , @P3SpTaxI          = ISNULL(B.P3_SP_TAX_I           , 0)
				 , @P3TaxDedI         = ISNULL(B.P3_TAX_DED_I          , 0)        --납세조합세액
              FROM            HUM100T A WITH (NOLOCK)
                   LEFT  JOIN HAD400T B WITH (NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
                                                     AND B.YEAR_YYYY   = @YearYyyy
                                                     AND B.PERSON_NUMB = A.PERSON_NUMB
                   LEFT  JOIN HBS400T C WITH (NOLOCK) ON C.COMP_CODE   = A.COMP_CODE
             WHERE A.COMP_CODE   = @CompCode
               AND A.PERSON_NUMB = @PersonNumb
    
            DELETE HAD400T
             WHERE COMP_CODE   = @CompCode
               AND YEAR_YYYY   = @YearYyyy
               AND PERSON_NUMB = @PersonNumb
        END
        ELSE
        BEGIN
            SELECT @NonTaxFr          = (CASE WHEN ISNULL(YOUTH_EXEMP_DATE,'') = '' OR (@YearYyyy + '0101') &gt; ISNULL(YOUTH_EXEMP_DATE,'')   --Case When 소득세감면기한 = '' or 소득세감면기한이 정산년도이전인 경우
											  THEN ''                                                                                       --     Then ''
											  ELSE (CASE WHEN ISNULL(JOIN_DATE,'') &gt; ISNULL(YOUTH_EXEMP_DATE,'')                            --     Else Case When 입사일 gt 소득세감면기한
														 THEN ''                                                                            --               Then ''                            ex) 소득세감면기한이 입사일전인 경우(입사일:20120601 gt 소득감면기한:20120331)
														 ELSE (CASE WHEN LEFT(ISNULL(JOIN_DATE,''),4) = @YearYyyy                           --               Else Case When 입사년도 = 정산년도 ex) 소득세감면기한이 입사일후인 경우(입사일:20120601 gt 소득감면기한:20130731)
																	THEN ISNULL(JOIN_DATE,'')                                               --                         Then 입사일              ex) 정산년도에   입사한 경우 20120601(입사년도:2012 = 정산년도:2012)
																	ELSE @YearYyyy + '0101'                                                 --                         Else 과세년도01월01일    ex) 정산년도전에 입사한 경우 20120101(입사년도:2011 = 정산년도:2012)
																END)
													 END)
										 END)
				 , @NonTaxTo          = (CASE WHEN ISNULL(YOUTH_EXEMP_DATE,'') = '' OR (@YearYyyy + '0101') &gt; ISNULL(YOUTH_EXEMP_DATE,'')   --Case When 소득세감면기한 = '' or 소득세감면기한이 정산년도이전인 경우
											  THEN ''                                                                                       --     Then ''
											  ELSE (CASE WHEN (CASE WHEN RETR_DATE != '00000000' AND LEN(RETR_DATE) &gt; 0
																	THEN RETR_DATE
																	ELSE @YearYyyy + '1231'
																END) &gt; ISNULL(YOUTH_EXEMP_DATE,'')                                          --     Else Case When 퇴사일 or 과세년도12월31일 gt 소득세감면기한
														 THEN ISNULL(YOUTH_EXEMP_DATE,'')                                                   --               Then 소득세감면기한                ex) 소득세감면기한이 퇴사일전인 경우(퇴사일:20121231 gt 소득감면기한:20120331)
														 ELSE (CASE WHEN RETR_DATE != '00000000' AND LEN(RETR_DATE) &gt; 0
																	THEN RETR_DATE
																	ELSE @YearYyyy + '1231'
																END)                                                                        --               Else 퇴사일 or 과세년도12월31일    ex) 소득세감면기한이 퇴사일후인 경우(퇴사일:20121231 gt 소득감면기한:20130731)
													 END)
										  END)
				 , @HalfwayType       = (CASE WHEN A.RETR_DATE != '00000000' AND LEN(A.RETR_DATE) &gt; 0 AND RIGHT(A.RETR_DATE,4) != '1231' AND LEFT(A.RETR_DATE,4) &lt;= @YearYyyy
											  THEN 'Y'
											  ELSE CASE WHEN RIGHT(A.RETR_DATE,4) = '1231' AND ISNULL(B.YEARENDTAX_CALCU_RULE,'1') = '2' 
														THEN 'Y'
														ELSE 'N'
													END 
										  END)                                     --중도퇴사자정산여부
				 , @HouseholderYn     = ISNULL(A.HOUSEHOLDER_YN, '2')              --세대주여부
				 , @ForeDispachYn     = ISNULL(A.FOREIGN_DISPATCH_YN, 'N')         --외국법인소속 파견근로자 여부
				 , @AnuAddI           = 0
				 , @PublicPensI       = 0
				 , @SoldierPensI      = 0
				 , @SchPensI          = 0
				 , @PostPensI         = 0
				 , @MedPreMinmAddI    = 0
				 , @HousAmountTotI    = 0
				 , @HousAmountTotI2   = 0
				 , @HousAmountInterI2 = 0
				 , @HousAmountInterI  = 0
				 , @HousAmountInterI3 = 0
				 , @FixedRateLoan     = 0
				 , @EtcLoan           = 0
				 , @HousAmountInterI6 = 0
				 , @HousAmountInterI7 = 0
				 , @HousAmountInterI8 = 0
				 , @HousAmountInterI9 = 0
				 --, @CardSelfUse2013I  = 0
				 --, @CardSelfUse2014I  = 0
				 --, @CardSelfUse2015I  = 0
				 --, @AddSelfUse2013I   = 0
				 --, @AddSelfUse2014I   = 0
				 --, @AddSelfUse2015FI  = 0
				 --, @AddSelfUse2015SI  = 0
				 , @CompPreminumI     = 0
				 , @InvestmentI       = 0
				 , @InvestmentI3      = 0
				 , @InvestmentI4      = 0
				 , @InvestmentI2      = 0
				 , @InvestmentI5      = 0
				 , @InvestmentI6      = 0
				 , @InvestmentI7      = 0
				 , @InvestmentI8      = 0
				 , @InvestmentI9      = 0
				 , @InvestmentI10     = 0
				 , @InvestmentI11     = 0
				 , @StaffStockI       = 0
				 , @EmployWorkerI     = 0
				 , @NotAmountLoanI    = 0
				 , @IncomeReduI       = 0
				 , @TaxesReduI        = 0
				 , @HousInterI        = 0
				 , @ForeIncomeI       = 0
				 , @ForeTaxI          = 0
				 , @P3CompanyNum      = ''
				 , @P3CompanyName     = ''
				 , @P3WorkDateFr      = ''
				 , @P3WorkDateTo      = ''
				 , @P3NonTaxFr        = ''
				 , @P3NonTaxTo        = ''
				 , @P3PayTotalI       = 0
				 , @P3BonusTotalI     = 0
				 , @P3InTaxI          = 0
				 , @P3LocalTaxI       = 0
				 , @P3SpTaxI          = 0
				 , @P3TaxDedI         = 0
              FROM           HUM100T A WITH (NOLOCK)
                   LEFT JOIN HBS400T B WITH (NOLOCK) ON B.COMP_CODE = A.COMP_CODE
             WHERE A.COMP_CODE   = @CompCode
               AND A.PERSON_NUMB = @PersonNumb
        END
    
        --정산입력자료 저장
        INSERT INTO HAD400T
             ( COMP_CODE            , YEAR_YYYY             , PERSON_NUMB           , NONTAX_FR             , NONTAX_TO
			 , HALFWAY_TYPE         , FORE_SINGLE_YN        , FOREIGN_DISPATCH_YN   , HOUSEHOLDER_YN
			 , NOW_PAY_TOT_I        , NOW_BONUS_TOTAL_I     , NOW_ADD_BONUS_I       , NOW_STOCK_PROFIT_I    , NOW_OWNER_STOCK_DRAW_I
			 , NOW_OF_RETR_OVER_I
			 , OLD_PAY_TOT_I        , OLD_BONUS_TOTAL_I     , OLD_ADD_BONUS_I       , OLD_STOCK_PROFIT_I    , OLD_OWNER_STOCK_DRAW_I
			 , OLD_OF_RETR_OVER_I
			 , NAP_PAY_TOT_I        , NAP_BONUS_TOTAL_I
			 , INCOME_SUPP_TOTAL_I  , INCOME_DED_I          , EARN_INCOME_I
			 , PER_DED_I            , SPOUSE
			 , SUPP_NUM             , SUPP_NUM_1            , SUPP_NUM_4            , SUPP_NUM_5            , SUPP_NUM_6
			 , SUPP_NUM_7           , SUPP_NUM_8            , AGED_NUM              , DEFORM_NUM            , MANY_CHILD_NUM
			 , BRING_CHILD_NUM      , BIRTH_ADOPT_NUM       , WOMAN                 , ONE_PARENT
			 , BIRTH_ADOPT_NUM1     , BIRTH_ADOPT_NUM2      , BIRTH_ADOPT_NUM3
			 , ANU_I                , ANU_ADD_I             , PUBLIC_PENS_I         , SOLDIER_PENS_I        , SCH_PENS_I
			 , POST_PENS_I
			 , MED_PREMINM_I        , MED_PREMINM_ADD_I     , HIRE_INSUR_I
			 , HOUS_AMOUNT_TOT_I    , HOUS_AMOUNT_TOT_I_2   , MON_RENT_I
			 , HOUS_AMOUNT_INTER_I_2, HOUS_AMOUNT_INTER_I   , HOUS_AMOUNT_INTER_I_3 , FIXED_RATE_LOAN       , ETC_LOAN
			 , HOUS_AMOUNT_INTER_I_6, HOUS_AMOUNT_INTER_I_7 , HOUS_AMOUNT_INTER_I_8 , HOUS_AMOUNT_INTER_I_9
			 , PRIV_PENS_I
			 , HOUS_BU_AMT          , HOUS_BU_ADD_AMT       , HOUS_WORK_AMT         , HOUS_AMOUNT_I         , HOUS_AMOUNT_ADD_I
			 , CARD_USE_I           , DEBIT_CARD_USE_I      , CASH_USE_I            , TRA_MARKET_USE_I      , TRAFFIC_USE_I
			 
			 , COMP_PREMINUM_I      , INVESTMENT_I          , INVESTMENT_I3         , INVESTMENT_I4         , INVESTMENT_I2
			 , INVESTMENT_I5        , INVESTMENT_I6         , INVESTMENT_I7         , INVESTMENT_I8         , INVESTMENT_I9
			 , INVESTMENT_I10       , INVESTMENT_I11
			 , STAFF_STOCK_I        , EMPLOY_WORKER_I       , NOT_AMOUNT_LOAN_I     , LONG_INVEST_STOCK_I
			 , INCOME_REDU_I        , TAXES_REDU_I
			 , SCI_DEDUC_I          , RETIRE_PENS_I         , PENS_I
			 , ETC_INSUR_I          , DEFORM_INSUR_I
			 , MY_MED_DED_I         , SENIOR_MED_I          , DEFORM_MED_I          , SURGERY_MED_I         , MED_TOTAL_I
			 , PER_EDUC_I           , UNIV_EDUC_NUM         , UNIV_EDUC_I           , STUD_EDUC_NUM         , STUD_EDUC_I
			 , KIND_EDU_NUM         , KIND_EDUC_I           , DEFORM_EDUC_NUM       , DEFORM_EDUC_I         , FIELD_EDUC_I			--, EDU_PRINCIPAL_RTN_I
			 , PER_EDUC_DED_I		, UNIV_EDUC_DED_I       , STUD_EDUC_DED_I       , KIND_EDUC_DED_I       , DEFORM_EDUC_DED_I
			 , FIELD_EDUC_DED_I
			 , POLICY_INDED         , POLICY_GIFT_I         , LEGAL_GIFT_I_PREV     , LEGAL_GIFT_I_PREV_14  , LEGAL_GIFT_I
			 , PRIV_GIFT_I_PREV     , PRIV_GIFT_I           , PUBLIC_GIFT_I_PREV    , PUBLIC_GIFT_I         , STAFF_GIFT_I
			 , APPOINT_GIFT_I_PREV  , APPOINT_GIFT_I_PREV_14, APPOINT_GIFT_I       ,  ASS_GIFT_I_PREV       , ASS_GIFT_I_PREV_14
			 , ASS_GIFT_I
			 , HOUS_INTER_I         , FORE_INCOME_I         , FORE_TAX_I
			 , P3_COMPANY_NUM       , P3_COMPANY_NAME       , P3_WORKDATE_FR        , P3_WORKDATE_TO        , P3_NONTAX_FR
			 , P3_NONTAX_TO         , P3_PAY_TOTAL_I        , P3_BONUS_I_TOTAL_I    , P3_IN_TAX_I           , P3_LOCAL_TAX_I
			 , P3_SP_TAX_I          , P3_TAX_DED_I
			 , INSERT_DB_USER       , INSERT_DB_TIME        , UPDATE_DB_USER        , UPDATE_DB_TIME )
        SELECT @CompCode            , @YearYyyy             , @PersonNumb           , @NonTaxFr             , @NonTaxTo
			 , @HalfwayType         , @ForeSingleYn         , @ForeDispachYn        , @HouseholderYn
			 , @NowPayTotI          , @NowBonusTotalI       , @NowAddBonusI         , @NowStockProfitI      , @NowOwnerStockDrawI
			 , @NowOfRetrOverI
			 , @OldPayTotI          , @OldBonusTotalI       , @OldAddBonusI         , @OldStockProfitI      , @OldOwnerStockDrawI
			 , @OldOfRetrOverI
			 , @NapPayTotI          , @NapBonusTotalI
			 , @IncomeSuppTotalI    , @IncomeDedI           , @EarnIncomeI
			 , @PerDedI             , @Spouse
			 , @SuppNum             , @SuppNum1             , @SuppNum4             , @SuppNum5             , @SuppNum6
			 , @SuppNum7            , @SuppNum8             , @AgedNum              , @DeformNum            , @ManyChildNum
			 , @BringChildNum       , @BirthAdoptNum        , @Woman                , @OneParent
		     , @BirthAdoptNum1      , @BirthAdoptNum2       , @BirthAdoptNum3
			 , @AnuI                , @AnuAddI              , @PublicPensI          , @SoldierPensI         , @SchPensI
			 , @PostPensI
			 , @MedPreMinmI         , @MedPreMinmAddI       , @HireInsurI
			 , @HousAmountTotI      , @HousAmountTotI2      , @MonRentI
			 , @HousAmountInterI2   , @HousAmountInterI     , @HousAmountInterI3    , @FixedRateLoan        , @EtcLoan
			 , @HousAmountInterI6   , @HousAmountInterI7    , @HousAmountInterI8    , @HousAmountInterI9
			 , @PrivPensI
			 , @HousBuAmt           , @HousBuAddAmt         , @HousWorkAmt          , @HousAmountI          , @HousAmountAddI
			 , @CardUseI            , @DebitCardUseI        , @CashUseI             , @TraMarketUseI        , @TrafficUseI
			 
			 , @CompPreminumI       , @InvestmentI          , @InvestmentI3         , @InvestmentI4         , @InvestmentI2
			 , @InvestmentI5        , @InvestmentI6         , @InvestmentI7         , @InvestmentI8         , @InvestmentI9
			 , @InvestmentI10       , @InvestmentI11
			 , @StaffStockI         , @EmployWorkerI        , @NotAmountLoanI       , @LongInvestStockI
			 , @IncomeReduI         , @TaxesReduI
			 , @SciDeducI           , @RetirePensI          , @PensI
			 , @EtcInsurI           , @DeformInsurI
			 , @MyMedDedI           , @SeniorMedI           , @DeformMedI           , @SurgeryMedI          , @MedTotalI
			 , @PerEducI            , @UnivEducNum          , @UnivEducI            , @StudEducNum          , @StudEducI
			 , @KindEduNum          , @KindEducI            , @DeformEducNum        , @DeformEducI          , @FieldEducI 		--, @EduPrincipalRtnI    
			 , @PerEducDedI         , @UnivEducDedI         , @StudEducDedI         , @KindEducDedI         , @DeformEducDedI
			 , @FieldEducDedI
			 , @PolicyInded         , @PolicyGiftI          , @LegalGiftIPrev       , @LegalGiftIPrev14     , @LegalGiftI
			 , @PrivGiftIPrev       , @PrivGiftI            , @PublicGiftIPrev      , @PublicGiftI          , @StaffGiftI
			 , @AppointGiftIPrev    , @AppointGiftIPrev14   , @AppointGiftI         , @AssGiftIPrev         , @AssGiftIPrev14
			 , @AssGiftI
			 , @HousInterI          , @ForeIncomeI          , @ForeTaxI
			 , @P3CompanyNum        , @P3CompanyName        , @P3WorkDateFr         , @P3WorkDateTo         , @P3NonTaxFr
			 , @P3NonTaxTo          , @P3PayTotalI          , @P3BonusTotalI        , @P3InTaxI             , @P3LocalTaxI
			 , @P3SpTaxI            , @P3TaxDedI
			 , @UserId              , GETDATE()             , @UserId               , GETDATE()
    
        SET NOCOUNT OFF
        SET ARITHABORT OFF
    END
	</update>
	<select  id="had617ukrServiceImpl.selectCalculateTax" parameterType="rMap"  resultType="rMap">
		--Had617UKr.CHad617UKr[fnHad617QCal] Query03
    /* *********************************************************************************************************************
     개인연말정산 계산/저장
    ********************************************************************************************************************* */
    BEGIN
        DECLARE @CompCode           NVARCHAR(08)                -- (필수) 법인코드
              , @YearYyyy           NVARCHAR(04)                -- (필수) 정산년도
              , @PersonNumb         NVARCHAR(10)                -- (필수) 사번
              , @UserId             NVARCHAR(100)                -- (필수) 사용자ID
    
        DECLARE @IncomeSuppTotalI   NUMERIC(30,6)
    
		  , @PayTotalI          NUMERIC(30,6), @BonusTotalI        NUMERIC(30,6), @AddBonusI          NUMERIC(30,6)
		  , @StockProfitI       NUMERIC(30,6), @OwnerStockDrawI    NUMERIC(30,6), @OfRetrOverI        NUMERIC(30,6)
		  , @NowPayTotI         NUMERIC(30,6), @NowBonusTotalI     NUMERIC(30,6), @NowAddBonusI       NUMERIC(30,6)
		  , @NowStockProfitI    NUMERIC(30,6), @NowOwnerStockDrawI NUMERIC(30,6), @NowOfRetrOverI     NUMERIC(30,6)
		  , @OldPayTotI         NUMERIC(30,6), @OldBonusTotalI     NUMERIC(30,6), @OldAddBonusI       NUMERIC(30,6)
		  , @OldStockProfitI    NUMERIC(30,6), @OldOwnerStockDrawI NUMERIC(30,6), @OldOfRetrOverI     NUMERIC(30,6)
		  , @NapPayTotI         NUMERIC(30,6), @NapBonusTotalI     NUMERIC(30,6)
    
		  , @IncomeDedI         NUMERIC(30,6), @EarnIncomeI        NUMERIC(30,6)
    
		  , @Spouse             NVARCHAR(01) , @SuppNum            NUMERIC(30,6)
		  , @AgedNum            NUMERIC(30,6), @DeformNum          NUMERIC(30,6), @ManyChildNum       NUMERIC(30,6)
		  , @BringChildNum      NUMERIC(30,6), @BirthAdoptNum      NUMERIC(30,6), @Woman              NVARCHAR(01)
		  , @OneParent          NVARCHAR(01)
          , @BirthAdoptNum1     NUMERIC(30,6), @BirthAdoptNum2     NUMERIC(30,6), @BirthAdoptNum3     NUMERIC(30,6)

		  , @PerDedI            NUMERIC(30,6), @SpouseDedI         NUMERIC(30,6), @SuppSubI           NUMERIC(30,6)
		  , @AgedDedI           NUMERIC(30,6), @DeformDedI         NUMERIC(30,6), @WomanDedI          NUMERIC(30,6)
		  , @OneParentDedI      NUMERIC(30,6)
    
		  , @AnuI               NUMERIC(30,6), @AnuAddI            NUMERIC(30,6), @AnuDedI            NUMERIC(30,6)
		  , @PublicPensI        NUMERIC(30,6), @SoldierPensI       NUMERIC(30,6), @SchPensI           NUMERIC(30,6)
		  , @PostPensI          NUMERIC(30,6)
		  , @MedPreMinmI        NUMERIC(30,6), @MedPreMinmAddI     NUMERIC(30,6), @HireInsurI         NUMERIC(30,6)
    
		  , @HousAmountTotI     NUMERIC(30,6), @HousAmountTotI2    NUMERIC(30,6)
		  , @HousAmountInterI2  NUMERIC(30,6), @HousAmountInterI   NUMERIC(30,6), @HousAmountInterI3  NUMERIC(30,6)
		  , @FixedRateLoan      NUMERIC(30,6), @EtcLoan            NUMERIC(30,6), @HousAmountInterI6  NUMERIC(30,6)
		  , @HousAmountInterI7  NUMERIC(30,6), @HousAmountInterI8  NUMERIC(30,6), @HousAmountInterI9  NUMERIC(30,6)
    
		  , @HousAmountI        NUMERIC(30,6), @HousAmountI2       NUMERIC(30,6), @MonRentI           NUMERIC(30,6)
		  , @MortageReturnI2    NUMERIC(30,6), @MortageReturnI     NUMERIC(30,6), @MortageReturnI3    NUMERIC(30,6)
		  , @MortageReturnI5    NUMERIC(30,6), @MortageReturnI4    NUMERIC(30,6), @MortageReturnI6    NUMERIC(30,6)
		  , @MortageReturnI7    NUMERIC(30,6), @MortageReturnI8    NUMERIC(30,6), @MortageReturnI9    NUMERIC(30,6)
    
		  , @PrivPensI          NUMERIC(30,6)
		  , @HousBuAmt          NUMERIC(30,6), @HousBuAddAmt       NUMERIC(30,6), @HousWorkAmt        NUMERIC(30,6)
		  , @HousAmountI400     NUMERIC(30,6), @HousAmountAddI     NUMERIC(30,6)
		  , @HousBuAmountI      NUMERIC(30,6), @HousBuAmountAddI   NUMERIC(30,6)
    
		  , @CardUseI           NUMERIC(30,6), @CashUseI           NUMERIC(30,6), @DebitCardUseI      NUMERIC(30,6)
		  , @TraMarketUseI      NUMERIC(30,6), @TrafficUseI        NUMERIC(30,6), @CardDedI           NUMERIC(30,6)
		  --, @CardSelfUse2014I   NUMERIC(30,6), @CardSelfUse2015I   NUMERIC(30,6)
		  --, @AddSelfUse2014I    NUMERIC(30,6), @AddSelfUse2015FI   NUMERIC(30,6)
    
		  , @CompPreminum       NVARCHAR(01)
		  , @CompPreminumI      NUMERIC(30,6), @InvestmentI        NUMERIC(30,6), @InvestmentI3       NUMERIC(30,6)
		  , @InvestmentI4       NUMERIC(30,6), @InvestmentI2       NUMERIC(30,6), @InvestmentI5       NUMERIC(30,6)
		  , @InvestmentI6       NUMERIC(30,6), @InvestmentI7       NUMERIC(30,6), @InvestmentI8       NUMERIC(30,6)
		  , @InvestmentI9       NUMERIC(30,6), @InvestmentI10      NUMERIC(30,6), @InvestmentI11      NUMERIC(30,6)
		  , @StaffStockI        NUMERIC(30,6), @EmployWorkerI      NUMERIC(30,6), @NotAmountLoanI     NUMERIC(30,6)
		  , @LongInvestStockI   NUMERIC(30,6)
     
		  , @CompPreminumDedI   NUMERIC(30,6), @InvestmentDedI     NUMERIC(30,6), @InvestmentDedI2    NUMERIC(30,6)
		  , @InvestmentDedI3    NUMERIC(30,6), @InvestmentDedI4    NUMERIC(30,6), @StaffStockDedI     NUMERIC(30,6)
		  , @EmployWorkerDedI   NUMERIC(30,6), @NotAmountLoanDedI  NUMERIC(30,6), @LongInvestStockDedI NUMERIC(30,6)
    
		  , @DedIncomeI         NUMERIC(30,6), @DedIncomeI1        NUMERIC(30,6), @DedIncomeI2        NUMERIC(30,6)
		  , @OverIncomeDedLmt   NUMERIC(30,6)
		  , @TaxStdI            NUMERIC(30,6), @TaxStdI1           NUMERIC(30,6), @TaxStdI2           NUMERIC(30,6)
		  , @CompTaxI           NUMERIC(30,6), @CompTaxI1          NUMERIC(30,6), @CompTaxI2          NUMERIC(30,6)
    
		  , @IncomeReduI        NUMERIC(30,6), @YouthDedI          NUMERIC(30,6), @YouthDedI2         NUMERIC(30,6)
		  , @YouthDedI3         NUMERIC(30,6), @YouthDedISum       NUMERIC(30,6), @SkillDedI          NUMERIC(30,6)
		  , @TaxesReduI         NUMERIC(30,6), @InTaxDedI          NUMERIC(30,6), @ChildTaxDedI       NUMERIC(30,6)
		  , @BringChildDedI     NUMERIC(30,6), @BirthAdoptI        NUMERIC(30,6)
    
		  , @SciDeducI          NUMERIC(30,6), @RetirePensI        NUMERIC(30,6), @PensI              NUMERIC(30,6)
		  , @SciTaxDedI         NUMERIC(30,6), @SciTaxDedI1        NUMERIC(30,6)
		  , @RetireTaxDedI      NUMERIC(30,6), @RetireTaxDedI1     NUMERIC(30,6)
		  , @PensTaxDedI        NUMERIC(30,6), @PensTaxDedI1       NUMERIC(30,6)
    
		  , @EtcInsurI          NUMERIC(30,6), @DeformInsurI       NUMERIC(30,6)
		  , @EtcInsurTaxDedI    NUMERIC(30,6), @DeformInsurTaxDedI NUMERIC(30,6)
    
		  , @MedDedI            NUMERIC(30,6), @MyMedDedI          NUMERIC(30,6), @SeniorMedI         NUMERIC(30,6)
		  , @DeformMedI         NUMERIC(30,6), @SurgeryMedI        NUMERIC(30,6), @MedTotalI          NUMERIC(30,6)
		  , @MedTaxDedI         NUMERIC(30,6), @MyMedTaxDedI       NUMERIC(30,6), @SeniorMedTaxDedI   NUMERIC(30,6)
		  , @DeformMedTaxDedI   NUMERIC(30,6), @SurgeryMedTaxDedI  NUMERIC(30,6), @MedTotalTaxDedI    NUMERIC(30,6)
    
		  , @EducDedI           NUMERIC(30,6), @PerEducDedI        NUMERIC(30,6), @UnivEducDedI       NUMERIC(30,6)
		  , @StudEducDedI       NUMERIC(30,6), @KindEducDedI       NUMERIC(30,6), @DeformEducDedI     NUMERIC(30,6)
		  , @FieldEducDedI      NUMERIC(30,6)
		  , @EducTaxDedI        NUMERIC(30,6), @PerEducTaxDedI     NUMERIC(30,6), @UnivEducTaxDedI    NUMERIC(30,6)
		  , @StudEducTaxDedI    NUMERIC(30,6), @KindEducTaxDedI    NUMERIC(30,6), @DeformEducTaxDedI  NUMERIC(30,6)
		  , @FieldEducTaxDedI   NUMERIC(30,6)
		  , @UnivEducNum        NUMERIC(30,6), @StudEducNum        NUMERIC(30,6), @KindEduNum         NUMERIC(30,6)
    
		  , @PolicyInded        NUMERIC(30,6), @PolicyGiftI        NUMERIC(30,6), @LegalGiftIPrev     NUMERIC(30,6)
		  , @LegalGiftIPrev14   NUMERIC(30,6), @LegalGiftI         NUMERIC(30,6), @PrivGiftIPrev      NUMERIC(30,6)
		  , @PrivGiftI          NUMERIC(30,6), @PublicGiftIPrev    NUMERIC(30,6), @PublicGiftI        NUMERIC(30,6)
		  , @StaffGiftI         NUMERIC(30,6), @AppointGiftIPrev   NUMERIC(30,6), @AppointGiftIPrev14 NUMERIC(30,6)
		  , @AppointGiftI       NUMERIC(30,6), @AssGiftIPrev       NUMERIC(30,6), @AssGiftIPrev14     NUMERIC(30,6)
		  , @AssGiftI           NUMERIC(30,6)
    
		  , @PolicyIndedDedAmt  NUMERIC(30,6), @PolicyGiftDedAmt   NUMERIC(30,6), @LegalDedAmt        NUMERIC(30,6)
		  , @StaffDedAmt        NUMERIC(30,6), @AppointAssTaxDedAmt NUMERIC(30,6)
    
		  , @GiftDedI           NUMERIC(30,6), @LegalGiftDedI      NUMERIC(30,6), @PrivGiftDedI       NUMERIC(30,6)
		  , @PublicGiftDedI     NUMERIC(30,6), @StaffGiftDedI      NUMERIC(30,6), @AppointGiftDedI    NUMERIC(30,6)
		  , @AssGiftDedI        NUMERIC(30,6)

		  , @GiftTaxDedI        NUMERIC(30,6), @PolicyIndedTaxDedI NUMERIC(30,6), @PolicyGiftTaxDedI  NUMERIC(30,6)
		  , @LegalGiftTaxDedI   NUMERIC(30,6), @StaffGiftTaxDedI   NUMERIC(30,6), @AppointGiftTaxDedI NUMERIC(30,6)
		  , @AssGiftTaxDedI     NUMERIC(30,6)
    
		  , @StdTaxDedI         NUMERIC(30,6)
		  , @NapTaxDedI         NUMERIC(30,6), @HousInterI         NUMERIC(30,6), @OutsideIncomeI     NUMERIC(30,6)
    
		  , @P3TaxDedI          NUMERIC(30,6), @ForeIncomeI        NUMERIC(30,6), @ForeTaxI           NUMERIC(30,6)
    
		  , @DefInTaxI          NUMERIC(30,6), @DefLocalTaxI       NUMERIC(30,6), @DefSpTaxI          NUMERIC(30,6)
		  , @DefTaxSum          NUMERIC(30,6)

		  , @NowInTaxI          NUMERIC(30,6), @NowLocalTaxI       NUMERIC(30,6), @NowSpTaxI          NUMERIC(30,6)
		  , @PreInTaxI          NUMERIC(30,6), @PreLocalTaxI       NUMERIC(30,6), @PreSpTaxI          NUMERIC(30,6)
		  , @NapInTaxI          NUMERIC(30,6), @NapLocalTaxI       NUMERIC(30,6), @NapSpTaxI          NUMERIC(30,6)
		  , @NowTaxSum          NUMERIC(30,6), @PreTaxSum          NUMERIC(30,6), @NapTaxSum          NUMERIC(30,6)
		  , @PaidInTaxSum       NUMERIC(30,6), @PaidLocalTaxSum    NUMERIC(30,6), @PaidSpTaxSum       NUMERIC(30,6)
		  , @PaidTaxSum         NUMERIC(30,6)

		  , @InTaxI             NUMERIC(30,6), @LocalTaxI          NUMERIC(30,6), @SpTaxI             NUMERIC(30,6)
		  , @TaxSum             NUMERIC(30,6)
    
        DECLARE @Tab1DedAmt         NUMERIC(30,6)      --(세액산출요약)기본공제
              , @Tab2DedAmt         NUMERIC(30,6)      --(세액산출요약)추가공제
              , @Tab3DedAmt         NUMERIC(30,6)      --(세액산출요약)연금보험료공제
              , @Tab4DedAmt         NUMERIC(30,6)      --(세액산출요약)특별공제-보험료
              , @Tab5DedAmt         NUMERIC(30,6)      --(세액산출요약)특별공제-주택자금
              , @Tab6DedAmt         NUMERIC(30,6)      --(세액산출요약)그밖소득공제-연금저출
              , @Tab7DedAmt         NUMERIC(30,6)      --(세액산출요약)그밖소득공제-주택마련
              , @Tab8DedAmt         NUMERIC(30,6)      --(세액산출요약)그밖소득공제-신용카드
              , @Tab9DedAmt         NUMERIC(30,6)      --(세액산출요약)그밖소득공제-기타
              , @Tab10DedAmt        NUMERIC(30,6)      --(세액산출요약)세액감면
              , @Tab11DedAmt        NUMERIC(30,6)      --(세액산출요약)세액공제-근로소득/자녀
              , @Tab12DedAmt        NUMERIC(30,6)      --(세액산출요약)세액공제-연금계좌
              , @Tab13DedAmt        NUMERIC(30,6)      --(세액산출요약)특별세액공제-보장성보험
              , @Tab14DedAmt        NUMERIC(30,6)      --(세액산출요약)특별세액공제-의료비
              , @Tab15DedAmt        NUMERIC(30,6)      --(세액산출요약)특별세액공제-교육비
              , @Tab16DedAmt        NUMERIC(30,6)      --(세액산출요약)특별세액공제-기부금
              , @Tab17DedAmt        NUMERIC(30,6)      --(세액산출요약)세액공제-기타
    
        DECLARE @ForeSingleYn       NVARCHAR(01) , @ForeDispachYn      NVARCHAR(01), @HouseholderYn       NVARCHAR(01)
              , @ForeignNum         NVARCHAR(20) , @LiveGubun          NVARCHAR(01), @ForeignSkillYn      NVARCHAR(01)
              , @HalfwayType        NVARCHAR(01) , @BaseDateFr         NVARCHAR(08), @BaseDateTo          NVARCHAR(08)
    
        DECLARE @NowIncomeI1        NUMERIC(30,6), @NowIncomeI2        NUMERIC(30,6) , @NowIncomeI3        NUMERIC(30,6)
              , @OldIncomeI1        NUMERIC(30,6), @OldIncomeI2        NUMERIC(30,6)
              , @P1NonTaxFr         NVARCHAR(08) , @P1NonTaxTo         NVARCHAR(08) , @P1ExempRate        NVARCHAR(01)
              , @P2NonTaxFr         NVARCHAR(08) , @P2NonTaxTo         NVARCHAR(08) , @P2ExempRate        NVARCHAR(01)
    
    
    --  1. 변수 값 할당 -------------------------------------------------------------------------------------------------
        SET @CompCode    = #{S_COMP_CODE}
        SET @YearYyyy    = #{YEAR_YYYY}
        SET @PersonNumb  = #{PERSON_NUMB}
        SET @UserId      = #{S_USER_ID}
    
    --  2. 데이터 조회 --------------------------------------------------------------------------------------------------
		--(참조)연말정산입력자료-HAD400T 참조
		SELECT @IncomeSuppTotalI   = INCOME_SUPP_TOTAL_I   --총급여액
			 , @PayTotalI          = PAY_TOTAL_I
			 , @BonusTotalI        = BONUS_TOTAL_I
			 , @AddBonusI          = ADD_BONUS_I
			 , @StockProfitI       = STOCK_PROFIT_I
			 , @OwnerStockDrawI    = OWNER_STOCK_DRAW_I
			 , @OfRetrOverI        = OF_RETR_OVER_I
			 , @NowPayTotI         = NOW_PAY_TOT_I
			 , @NowBonusTotalI     = NOW_BONUS_TOTAL_I
			 , @NowAddBonusI       = NOW_ADD_BONUS_I
			 , @NowStockProfitI    = NOW_STOCK_PROFIT_I
			 , @NowOwnerStockDrawI = NOW_OWNER_STOCK_DRAW_I
			 , @NowOfRetrOverI     = NOW_OF_RETR_OVER_I
			 , @OldPayTotI         = OLD_PAY_TOT_I
			 , @OldBonusTotalI     = OLD_BONUS_TOTAL_I
			 , @OldAddBonusI       = OLD_ADD_BONUS_I
			 , @OldStockProfitI    = OLD_STOCK_PROFIT_I
			 , @OldOwnerStockDrawI = OLD_OWNER_STOCK_DRAW_I
			 , @OldOfRetrOverI     = OLD_OF_RETR_OVER_I
			 , @NapPayTotI         = NAP_PAY_TOT_I
			 , @NapBonusTotalI     = NAP_BONUS_TOTAL_I
			 , @Spouse             = SPOUSE                --기본공제/추가공제
			 , @SuppNum            = SUPP_NUM
			 , @AgedNum            = AGED_NUM
			 , @DeformNum          = DEFORM_NUM
			 , @ManyChildNum       = MANY_CHILD_NUM
			 , @BringChildNum      = BRING_CHILD_NUM
			 , @BirthAdoptNum      = BIRTH_ADOPT_NUM
			 , @Woman              = WOMAN
			 , @OneParent          = ONE_PARENT
			 , @BirthAdoptNum1     = BIRTH_ADOPT_NUM1
			 , @BirthAdoptNum2     = BIRTH_ADOPT_NUM2
			 , @BirthAdoptNum3     = BIRTH_ADOPT_NUM3
			 , @AnuI               = ANU_I                 --연금보험료공제
			 , @AnuAddI            = ANU_ADD_I
			 , @PublicPensI        = PUBLIC_PENS_I
			 , @SoldierPensI       = SOLDIER_PENS_I
			 , @SchPensI           = SCH_PENS_I
			 , @PostPensI          = POST_PENS_I
			 , @MedPreMinmI        = MED_PREMINM_I         --특별공제-보험료
			 , @MedPreMinmAddI     = MED_PREMINM_ADD_I
			 , @HireInsurI         = HIRE_INSUR_I
			 , @HousAmountTotI     = HOUS_AMOUNT_TOT_I     --특별공제-주택자금
			 , @HousAmountTotI2    = HOUS_AMOUNT_TOT_I_2
			 , @MonRentI           = MON_RENT_I
			 , @HousAmountInterI2  = HOUS_AMOUNT_INTER_I_2
			 , @HousAmountInterI   = HOUS_AMOUNT_INTER_I
			 , @HousAmountInterI3  = HOUS_AMOUNT_INTER_I_3
			 , @FixedRateLoan      = FIXED_RATE_LOAN
			 , @EtcLoan            = ETC_LOAN
			 , @HousAmountInterI6  = HOUS_AMOUNT_INTER_I_6
			 , @HousAmountInterI7  = HOUS_AMOUNT_INTER_I_7
			 , @HousAmountInterI8  = HOUS_AMOUNT_INTER_I_8
			 , @HousAmountInterI9  = HOUS_AMOUNT_INTER_I_9
			 , @PrivPensI          = PRIV_PENS_I           --그밖의소득공제-연금저축
			 , @HousBuAmt          = HOUS_BU_AMT           --그밖의소득공제-주택마련
			 , @HousBuAddAmt       = HOUS_BU_ADD_AMT
			 , @HousWorkAmt        = HOUS_WORK_AMT
			 , @HousAmountI400     = HOUS_AMOUNT_I         --HAD400T의 HOUS_AMOUNT_I(주택청약종합저축)은 @HousAmountI400 에 저장
			 , @HousAmountAddI     = HOUS_AMOUNT_ADD_I
			 , @CardUseI           = CARD_USE_I            --그밖의소득공제-신용카드
			 , @CashUseI           = CASH_USE_I
			 , @DebitCardUseI      = DEBIT_CARD_USE_I
			 , @TraMarketUseI      = TRA_MARKET_USE_I
			 , @TrafficUseI        = TRAFFIC_USE_I
			 
			 , @CompPreminum       = COMP_PREMINUM         --그밖의소득공제-기타
			 , @CompPreminumI      = COMP_PREMINUM_I
			 , @InvestmentI        = INVESTMENT_I
			 , @InvestmentI3       = INVESTMENT_I3
			 , @InvestmentI4       = INVESTMENT_I4
			 , @InvestmentI2       = INVESTMENT_I2
			 , @InvestmentI5       = INVESTMENT_I5
			 , @InvestmentI6       = INVESTMENT_I6
			 , @InvestmentI7       = INVESTMENT_I7
			 , @InvestmentI8       = INVESTMENT_I8
			 , @InvestmentI9       = INVESTMENT_I9
			 , @InvestmentI10      = INVESTMENT_I10
			 , @InvestmentI11      = INVESTMENT_I11
			 , @StaffStockI        = STAFF_STOCK_I
			 , @EmployWorkerI      = EMPLOY_WORKER_I
			 , @NotAmountLoanI     = NOT_AMOUNT_LOAN_I
			 , @LongInvestStockI   = LONG_INVEST_STOCK_I
			 , @IncomeReduI        = INCOME_REDU_I         --세액감면
			 , @TaxesReduI         = TAXES_REDU_I
			 , @SciDeducI          = SCI_DEDUC_I           --세액공제-연금계좌
			 , @RetirePensI        = RETIRE_PENS_I
			 , @PensI              = PENS_I
			 , @EtcInsurI          = ETC_INSUR_I           --특별세액공제-보장성보험
			 , @DeformInsurI       = DEFORM_INSUR_I
			 , @MyMedDedI          = MY_MED_DED_I          --특별세액공제-의료비
			 , @SeniorMedI         = SENIOR_MED_I
			 , @DeformMedI         = DEFORM_MED_I
			 , @SurgeryMedI        = SURGERY_MED_I
			 , @MedTotalI          = MED_TOTAL_I
			 , @EducDedI           = EDUC_DED_I            --특별세액공제-교육비
			 , @PerEducDedI        = PER_EDUC_DED_I
			 , @UnivEducNum        = UNIV_EDUC_NUM
			 , @UnivEducDedI       = UNIV_EDUC_DED_I
			 , @StudEducNum        = STUD_EDUC_NUM
			 , @StudEducDedI       = STUD_EDUC_DED_I
			 , @KindEduNum         = KIND_EDU_NUM
			 , @KindEducDedI       = KIND_EDUC_DED_I
			 , @DeformEducDedI     = DEFORM_EDUC_DED_I
			 , @FieldEducDedI      = FIELD_EDUC_DED_I
			 , @PolicyInded        = POLICY_INDED          --특별세액공제-기부금
			 , @PolicyGiftI        = POLICY_GIFT_I
			 , @LegalGiftIPrev     = LEGAL_GIFT_I_PREV
			 , @LegalGiftIPrev14   = LEGAL_GIFT_I_PREV_14
			 , @LegalGiftI         = LEGAL_GIFT_I
			 , @PrivGiftIPrev      = PRIV_GIFT_I_PREV
			 , @PrivGiftI          = PRIV_GIFT_I
			 , @PublicGiftIPrev    = PUBLIC_GIFT_I_PREV
			 , @PublicGiftI        = PUBLIC_GIFT_I
			 , @StaffGiftI         = STAFF_GIFT_I
			 , @AppointGiftIPrev   = APPOINT_GIFT_I_PREV
			 , @AppointGiftIPrev14 = APPOINT_GIFT_I_PREV_14
			 , @AppointGiftI       = APPOINT_GIFT_I
			 , @AssGiftIPrev       = ASS_GIFT_I_PREV
			 , @AssGiftIPrev14     = ASS_GIFT_I_PREV_14
			 , @AssGiftI           = ASS_GIFT_I
			 , @P3TaxDedI          = P3_TAX_DED_I          --세액공제
			 , @HousInterI         = HOUS_INTER_I
			 , @ForeIncomeI        = FORE_INCOME_I
			 , @ForeTaxI           = FORE_TAX_I
			 , @ForeSingleYn       = FORE_SINGLE_YN        --외국인단일세율적용여부
			 , @ForeDispachYn      = FOREIGN_DISPATCH_YN   --외국법인소속 파견근로자여부
			 , @HouseholderYn      = HOUSEHOLDER_YN        --세대주여부
			 , @ForeignNum         = FOREIGN_NUM           --(참조)외국인번호
			 , @LiveGubun          = LIVE_GUBUN            --(참조)거주여부
			 , @ForeignSkillYn     = FOREIGN_SKILL_YN      --(참조)외국인기술자여부
			 , @HalfwayType        = HALFWAY_TYPE          --정산구분:중도퇴사자정산(=Y)/연말정산(=N)
			 , @BaseDateFr         = BASE_DATE_FR          --입사일
			 , @BaseDateTo         = BASE_DATE_TO          --퇴사자가아닌경우:정산년도+1231,퇴사자인경우:퇴사일
			 , @NowIncomeI1        = NOW_INCOME_I1         --(참조)중소기업취업세액감면월까지의총급여액(2013-100%)
			 , @NowIncomeI3        = NOW_INCOME_I3         --(참조)중소기업취업세액감면월까지의총급여액(2016-70%)
			 , @NowIncomeI2        = NOW_INCOME_I2         --(참조)중소기업취업세액감면월까지의총급여액(2014-50%)
			 , @OldIncomeI1        = OLD_INCOME_I1         --(참조)종전근무지1총급여액
			 , @OldIncomeI2        = OLD_INCOME_I2         --(참조)종전근무지2총급여액
			 , @P1NonTaxFr         = P1_NONTAX_FR          --(참조)종전근무지1세액감면기간(FR)
			 , @P1NonTaxTo         = P1_NONTAX_TO          --(참조)종전근무지1세액감면기간(TO)
			 , @P1ExempRate        = P1_EXEMP_RATE         --(참조)종전근무지1중소기업취업세액감면비율
			 , @P2NonTaxFr         = P2_NONTAX_FR          --(참조)종전근무지2세액감면기간(FR)
			 , @P2NonTaxTo         = P2_NONTAX_TO          --(참조)종전근무지2세액감면기간(TO)
			 , @P2ExempRate        = P2_EXEMP_RATE         --(참조)종전근무지1중소기업취업세액감면비율
		  FROM uniLITE.fn2017YearEndTax201ReferenceData(@CompCode, @YearYyyy, @PersonNumb)
	
		--(계산)근로소득공제/근로소득금액
		SELECT @IncomeDedI  = INCOME_DED_I
			 , @EarnIncomeI = EARN_INCOME_I
		  FROM uniLITE.fn2017YearEndTax205CalIncomeDed(@CompCode, @YearYyyy, @IncomeSuppTotalI)
	
		--(계산)기본공제/추가공제
		SELECT @PerDedI        = PER_DED_I
			 , @SpouseDedI     = SPOUSE_DED_I
			 , @SuppSubI       = SUPP_SUB_I
			 , @AgedDedI       = AGED_DED_I
			 , @DeformDedI     = DEFORM_DED_I
			 , @WomanDedI      = WOMAN_DED_I
			 , @OneParentDedI  = ONE_PARENT_DED_I
		  FROM uniLITE.fn2017YearEndTax210CalPersonlDed(@CompCode, @YearYyyy, @Spouse
																			, @SuppNum
																			, @AgedNum
																			, @DeformNum
																			, @Woman
																			, @OneParent
																			, @EarnIncomeI)
		--(계산)연금보험료공제/특별소득공제-보험료/그밖의소득공제-연금저축
		SELECT @AnuDedI      = ANU_DED_I
			 , @PublicPensI  = PUBLIC_PENS_DED_I       --입력금액과 정산금액 변수 동일하게 사용함
			 , @SoldierPensI = SOLDIER_PENS_DED_I      --입력금액과 정산금액 변수 동일하게 사용함
			 , @SchPensI     = SCH_PENS_DED_I          --입력금액과 정산금액 변수 동일하게 사용함
			 , @PostPensI    = POST_PENS_DED_I         --입력금액과 정산금액 변수 동일하게 사용함
			 , @MedPreMinmI  = MED_PREMINM_DED_I       --입력금액과 정산금액 변수 동일하게 사용함
			 , @HireInsurI   = HIRE_INSUR_DED_I        --입력금액과 정산금액 변수 동일하게 사용함
			 , @PrivPensI    = PRIV_PENS_DED_I         --입력금액과 정산금액 변수 동일하게 사용함
		  FROM uniLITE.fn2017YearEndTax215CalInsuranceSavings(@CompCode, @YearYyyy, @AnuI
																				  , @AnuAddI
																				  , @PublicPensI
																				  , @SoldierPensI
																				  , @SchPensI
																				  , @PostPensI
																				  , @MedPreMinmI
																				  , @MedPreMinmAddI
																				  , @HireInsurI
																				  , @PrivPensI)
		--(계산)특별소득공제-주택마련/그밖의소득공제-주택마련
		--HAD400T의 HOUS_AMOUNT_I는 주택청약종합저축         - @HousAmountI400
		--HAD600T의 HOUS_AMOUNT_I는 주택자금불입액(대출기관) - @HousAmountI
		SELECT @HousAmountI      = HOUS_AMOUNT_I
			 , @HousAmountI2     = HOUS_AMOUNT_I_2
			 , @MortageReturnI2  = MORTGAGE_RETURN_I_2
			 , @MortageReturnI   = MORTGAGE_RETURN_I
			 , @MortageReturnI3  = MORTGAGE_RETURN_I_3
			 , @MortageReturnI5  = MORTGAGE_RETURN_I_5
			 , @MortageReturnI4  = MORTGAGE_RETURN_I_4
			 , @MortageReturnI6  = MORTGAGE_RETURN_I_6
			 , @MortageReturnI7  = MORTGAGE_RETURN_I_7
			 , @MortageReturnI8  = MORTGAGE_RETURN_I_8
			 , @MortageReturnI9  = MORTGAGE_RETURN_I_9
			 , @HousBuAmt        = HOUS_BU_AMT          --입력금액과 정산금액 변수 동일하게 사용함
			 , @HousBuAddAmt     = HOUS_BU_ADD_AMT      --입력금액과 정산금액 변수 동일하게 사용함
			 , @HousWorkAmt      = HOUS_WORK_AMT        --입력금액과 정산금액 변수 동일하게 사용함
			 , @HousBuAmountI    = HOUS_BU_AMOUNT_I
			 , @HousBuAmountAddI = HOUS_BU_AMOUNT_ADD_I
		  FROM uniLITE.fn2017YearEndTax220CalHousingSavings(@CompCode, @YearYyyy, @IncomeSuppTotalI
																				, @HouseholderYn
																				, @HousAmountTotI
																				, @HousAmountTotI2
																				, @HousAmountInterI2
																				, @HousAmountInterI
																				, @HousAmountInterI3
																				, @FixedRateLoan
																				, @EtcLoan
																				, @HousAmountInterI6
																				, @HousAmountInterI7
																				, @HousAmountInterI8
																				, @HousAmountInterI9
																				, @HousBuAmt
																				, @HousBuAddAmt
																				, @HousWorkAmt
																				, @HousAmountI400
																				, @HousAmountAddI)
		--(계산)특별소득공제-기부금
		SELECT @GiftDedI           = GIFT_DED_I
			 , @LegalGiftDedI      = LEGAL_GIFT_DED_I
			 , @PrivGiftDedI       = PRIV_GIFT_DED_I
			 , @PublicGiftDedI     = PUBLIC_GIFT_DED_I
			 , @StaffGiftDedI      = STAFF_GIFT_DED_I
			 , @AppointGiftDedI    = APPOINT_GIFT_DED_I
			 , @AssGiftDedI        = ASS_GIFT_DED_I
		  FROM uniLITE.fn2017YearEndTax275CalContribution(@CompCode, @YearYyyy, @PersonNumb
		  																	  , @EarnIncomeI
																			  , @PolicyInded
																			  , @PolicyGiftI
																			  )
		--(계산)신용카드등
		SELECT @CardDedI = CARD_DED_I
		  FROM uniLITE.fn2017YearEndTax225CalCreditEtc(@CompCode, @YearYyyy, @IncomeSuppTotalI
		                                                                   , @EarnIncomeI
																		   , @CardUseI
																		   , @CashUseI
																		   , @DebitCardUseI
																		   , @TraMarketUseI
																		   , @TrafficUseI)
	  																     --, @CardSelfUse2014I, @CardSelfUse2015I, @AddSelfUse2014I, @AddSelfUse2015FI
		--(계산)그밖의소득공제-기타
		SELECT @CompPreminumDedI    = COMP_PREMINUM_DED_I
			 , @InvestmentDedI      = INVESTMENT_DED_I
			 , @InvestmentDedI2     = INVESTMENT_DED_I2
			 , @InvestmentDedI3     = INVESTMENT_DED_I3
			 , @InvestmentDedI4     = INVESTMENT_DED_I4
			 , @StaffStockDedI      = STAFF_STOCK_DED_I
			 , @EmployWorkerDedI    = EMPLOY_WORKER_DED_I
			 , @NotAmountLoanDedI   = NOT_AMOUNT_LOAN_DED_I
			 , @LongInvestStockDedI = LONG_INVEST_STOCK_DED_I
		  FROM uniLITE.fn2017YearEndTax230CalEtcIncomeDeduction(@CompCode, @YearYyyy, @IncomeSuppTotalI
																					, @EarnIncomeI
																					, @CompPreminum
																					, @CompPreminumI
																					, @InvestmentI
																					, @InvestmentI3
																					, @InvestmentI4
																					, @InvestmentI2
																					, @InvestmentI5
																					, @InvestmentI6
																					, @InvestmentI7
																					, @InvestmentI8
																					, @InvestmentI9
																					, @InvestmentI10
																					, @InvestmentI11
																					, @StaffStockI
																					, @EmployWorkerI
																					, @NotAmountLoanI
																					, @LongInvestStockI)
		--(계산)차감근로소득/특별공제한도초과액/과세표준
		SELECT @PerDedI             = PER_DED_I                   -- 1[기본공제]본인공제
			 , @SpouseDedI          = SPOUSE_DED_I                -- 2[기본공제]배우자공제
			 , @SuppSubI            = SUPP_SUB_I                  -- 3[기본공제]부양자공제
			 , @AgedDedI            = AGED_DED_I                  -- 4[추가공제]경로자공제
			 , @DeformDedI          = DEFORM_DED_I                -- 5[추가공제]장애인공제
			 , @WomanDedI           = WOMAN_DED_I                 -- 6[추가공제]부녀자공제
			 , @OneParentDedI       = ONE_PARENT_DED_I            -- 7[추가공제]한부모공제
			 , @AnuDedI             = ANU_DED_I                   -- 8[연금보험료공제]국민연금
			 , @PublicPensI         = PUBLIC_PENS_I               -- 9[연금보험료공제]공무원연금
			 , @SoldierPensI        = SOLDIER_PENS_I              --10[연금보험료공제]군인연금
			 , @SchPensI            = SCH_PENS_I                  --11[연금보험료공제]사립학교교직원연금
			 , @PostPensI           = POST_PENS_I                 --12[연금보험료공제]별정우체국연금
			 , @MedPreMinmI         = MED_PREMINM_I               --13[특별소득공제-보험료]건강보험료
			 , @HireInsurI          = HIRE_INSUR_I                --14[특별소득공제-보험료]고용보험료
			 , @HousAmountI         = HOUS_AMOUNT_I               --15[특별소득공제-주택자금]주택자금불입액(대출기관)
			 , @HousAmountI2        = HOUS_AMOUNT_I_2             --16[특별소득공제-주택자금]주택자금불입액(거주자)
			 , @MortageReturnI2     = MORTGAGE_RETURN_I_2         --17[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년미만)
			 , @MortageReturnI      = MORTGAGE_RETURN_I           --18[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년~29년)
			 , @MortageReturnI3     = MORTGAGE_RETURN_I_3         --19[특별소득공제-주택자금]장기주택저당차입금이자상환액(30년이상)
			 , @MortageReturnI5     = MORTGAGE_RETURN_I_5         --20[특별소득공제-주택자금]장기주택저당차입금이자상환액(30년이상)
			 , @MortageReturnI4     = MORTGAGE_RETURN_I_4         --21[특별소득공제-주택자금]기타대출(500만원한도)
			 , @MortageReturnI6     = MORTGAGE_RETURN_I_6         --22[특별소득공제-주택자금]2015년15년이상(고정금리and 비거치식)
			 , @MortageReturnI7     = MORTGAGE_RETURN_I_7         --23[특별소득공제-주택자금]2015년15년이상(고정금리OR비거치식)
			 , @MortageReturnI8     = MORTGAGE_RETURN_I_8         --24[특별소득공제-주택자금]2015년15년이상(그밖의대출)
			 , @MortageReturnI9     = MORTGAGE_RETURN_I_9         --25[특별소득공제-주택자금]2015년10년이상(고정금리OR비거치식)
			 , @GiftDedI            = GIFT_DED_I                  --26[특별소득공제-기부금]기부금
			 , @LegalGiftDedI       = LEGAL_GIFT_DED_I            --27[특별소득공제-기부금]법정기부금
			 , @PrivGiftDedI        = PRIV_GIFT_DED_I             --28[특별소득공제-기부금]특례기부금
			 , @PublicGiftDedI      = PUBLIC_GIFT_DED_I           --29[특별소득공제-기부금]공익신탁기부금
			 , @AppointGiftDedI     = APPOINT_GIFT_DED_I          --30[특별소득공제-기부금]지정기부금
			 , @AssGiftDedI         = ASS_GIFT_DED_I              --31[특별소득공제-기부금]지정기부금-종교단체기부금
			 , @PrivPensI           = PRIV_PENS_I                 --32[그밖소득공제-연금저축]개인연금저축
			 , @HousBuAmt           = HOUS_BU_AMT                 --33[그밖소득공제-주택마련]청약저축(240만원한도)
			 , @HousBuAddAmt        = HOUS_BU_ADD_AMT             --34[그밖소득공제-주택마련]청약저축(120만원한도)
			 , @HousWorkAmt         = HOUS_WORK_AMT               --35[그밖소득공제-주택마련]근로자주택마련저축
			 , @HousBuAmountI       = HOUS_BU_AMOUNT_I            --36[그밖소득공제-주택마련]주택청약종합저축(240만원한도)
			 , @HousBuAmountAddI    = HOUS_BU_AMOUNT_ADD_I        --37[그밖소득공제-주택마련]주택청약종합저축(120만원한도)
			 , @CardDedI            = CARD_DED_I                  --38[그밖소득공제-신용카드]신용카드
			 , @CompPreminumDedI    = COMP_PREMINUM_DED_I         --39[그밖소득공제-기타]소기업,소상공인공제부금소득공제
			 , @InvestmentDedI      = INVESTMENT_DED_I            --40[그밖소득공제-기타]투자조합출자공제
			 , @InvestmentDedI2     = INVESTMENT_DED_I2           --41[그밖소득공제-기타]투자조합출자공제(2013년분)
			 , @InvestmentDedI3     = INVESTMENT_DED_I3           --42[그밖소득공제-기타]투자조합출자공제(2014년분)
			 , @InvestmentDedI4     = INVESTMENT_DED_I4           --43[그밖소득공제-기타]투자조합출자공제(2015년분)
			 , @StaffStockDedI      = STAFF_STOCK_DED_I           --44[그밖소득공제-기타]우리사주조합출연금액
			 , @StaffGiftDedI       = STAFF_GIFT_DED_I            --45[그밖소득공제-기타]우리사주조합기부금
			 , @EmployWorkerDedI    = EMPLOY_WORKER_DED_I         --46[그밖소득공제-기타]고용유지중소기업근로자소득공제
			 , @NotAmountLoanDedI   = NOT_AMOUNT_LOAN_DED_I       --47[그밖소득공제-기타]목돈안드는전세이자상환액공제
			 , @LongInvestStockDedI = LONG_INVEST_STOCK_DED_I     --48[그밖소득공제-기타]장기집합투자증권저축
			 , @DedIncomeI          = DED_INCOME_I                --49 차감근로소득
			 , @DedIncomeI1         = DED_INCOME_I1               --50 차감근로소득(표준세액공제계산용):특별소득공제포함
			 , @DedIncomeI2         = DED_INCOME_I2               --51 차감근로소득(표준세액공제계산용):특별소득공제제외
			 , @OverIncomeDedLmt    = OVER_INCOME_DED_LMT         --52 특별공제종합한도초과액
			 , @TaxStdI             = TAX_STD_I                   --53 소득과세표준
			 , @TaxStdI1            = TAX_STD_I1                  --54 소득과세표준(표준세액공제계산용):특별소득공제포함
			 , @TaxStdI2            = TAX_STD_I2                  --55 소득과세표준(표준세액공제계산용):특별소득공제제외
		  FROM uniLITE.fn2017YearEndTax235CalAssessmentStandard(@CompCode, @YearYyyy, @EarnIncomeI             -- 1
																					, @PerDedI                 -- 2
																					, @SpouseDedI              -- 3
																					, @SuppSubI                -- 4
																					, @AgedDedI                -- 5
																					, @DeformDedI              -- 6
																					, @WomanDedI               -- 7
																					, @OneParentDedI           -- 8
																					, @AnuDedI                 -- 9
																					, @PublicPensI             --10
																					, @SoldierPensI            --11
																					, @SchPensI                --12
																					, @PostPensI               --13
																					, @MedPreMinmI             --14
																					, @HireInsurI              --15
																					, @HousAmountI             --16
																					, @HousAmountI2            --17
																					, @MortageReturnI2         --18
																					, @MortageReturnI          --19
																					, @MortageReturnI3         --20
																					, @MortageReturnI5         --21
																					, @MortageReturnI4         --22
																					, @MortageReturnI6         --23
																					, @MortageReturnI7         --24
																					, @MortageReturnI8         --25
																					, @MortageReturnI9         --26
																					, @GiftDedI                --27
																					, @LegalGiftDedI           --28
																					, @PrivGiftDedI            --29
																					, @PublicGiftDedI          --30
																					, @AppointGiftDedI         --31
																					, @AssGiftDedI             --32
																					, @PrivPensI               --33
																					, @HousBuAmt               --34
																					, @HousBuAddAmt            --35
																					, @HousWorkAmt             --36
																					, @HousBuAmountI           --37
																					, @HousBuAmountAddI        --38
																					, @CardDedI                --39
																					, @CompPreminumDedI        --40
																					, @InvestmentDedI          --41
																					, @InvestmentDedI2         --42
																					, @InvestmentDedI3         --43
																					, @InvestmentDedI4         --44
																					, @StaffStockDedI          --45
																					, @StaffGiftDedI           --46
																					, @EmployWorkerDedI        --47
																					, @NotAmountLoanDedI       --48
																					, @LongInvestStockDedI)    --49
		--(계산)산출세액
		SELECT @CompTaxI  = COMP_TAX_I
			 , @CompTaxI1 = COMP_TAX_I1
			 , @CompTaxI2 = COMP_TAX_I2
		  FROM uniLITE.fn2017YearEndTax240CalCalculatedTaxAmount(@CompCode, @YearYyyy, @ForeignNum
																					 , @ForeSingleYn
																					 , @TaxStdI
																					 , @TaxStdI1
																					 , @TaxStdI2)
	
		--(계산)세액감면
		SELECT @IncomeReduI  = INCOME_REDU_I            --입력금액과 정산금액 변수 동일하게 사용함
			 , @YouthDedI    = YOUTH_DED_I
			 , @YouthDedI3   = YOUTH_DED_I3
			 , @YouthDedI2   = YOUTH_DED_I2
			 , @YouthDedISum = YOUTH_DED_I_SUM
			 , @SkillDedI    = SKILL_DED_I
			 , @TaxesReduI   = TAXES_REDU_I             --입력금액과 정산금액 변수 동일하게 사용함
		  FROM uniLITE.fn2017YearEndTax245CalTaxReduction(@CompCode, @YearYyyy, @PersonNumb
																			  , @ForeignNum
																			  , @LiveGubun
																			  , @ForeignSkillYn
																			  , @EarnIncomeI
																			  , @CompTaxI
																			  , @IncomeReduI
																			  , @TaxesReduI
																			  , @BaseDateFr
																			  , @BaseDateTo
																			  , @IncomeSuppTotalI
																			  , @NowIncomeI1
																			  , @NowIncomeI3
																			  , @NowIncomeI2
																			  , @OldIncomeI1
																			  , @OldIncomeI2
																			  , @P1NonTaxFr
																			  , @P1NonTaxTo
																			  , @P1ExempRate
																			  , @P2NonTaxFr
																			  , @P2NonTaxTo
																			  , @P2ExempRate)
		--(계산)세액공제-근로소득/자녀
		SELECT @InTaxDedI      = IN_TAX_DED_I
			 , @ChildTaxDedI   = CHILD_TAX_DED_I
			 , @BringChildDedI = BRING_CHILD_DED_I
			 , @BirthAdoptI    = BIRTH_ADOPT_I
		  FROM uniLITE.fn2017YearEndTax250CalTaxCreditIncomeChild(@CompCode, @YearYyyy, @PersonNumb
																					  , @IncomeSuppTotalI
																					  , @NowIncomeI1
																					  , @NowIncomeI3
																					  , @NowIncomeI2
																					  , @OldIncomeI1
																					  , @OldIncomeI2
																					  , @P1NonTaxFr
																					  , @P1NonTaxTo
																					  , @P1ExempRate
																					  , @P2NonTaxFr
																					  , @P2NonTaxTo
																					  , @P2ExempRate
																					  , @CompTaxI
																					  , @YouthDedI
																					  , @YouthDedI3
																					  , @YouthDedI2
																					  , @ManyChildNum
																					  , @BringChildNum
																					  , @BirthAdoptNum1
																					  , @BirthAdoptNum2
																					  , @BirthAdoptNum3)
		--(계산)특별세액공제-연금계좌
		SELECT @SciTaxDedI     = SCI_TAX_DED_I
			 , @SciTaxDedI1    = SCI_TAX_DED_I1
			 , @RetireTaxDedI  = RETIRE_TAX_DED_I
			 , @RetireTaxDedI1 = RETIRE_TAX_DED_I1
			 , @PensTaxDedI    = PENS_TAX_DED_I
			 , @PensTaxDedI1   = PENS_TAX_DED_I1
			 , @SciDeducI      = SCI_DEDUC_I
			 , @RetirePensI    = RETIRE_PENS_I
			 , @PensI          = PENS_I
		  FROM uniLITE.fn2017YearEndTax255CalAnnuitySavings(@CompCode, @YearYyyy, @IncomeSuppTotalI
																				, @SciDeducI
																				, @RetirePensI
																				, @PensI)
		--(계산)특별세액공제-보장성보험
		SELECT @EtcInsurTaxDedI    = ETC_INSUR_TAX_DED_I
			 , @DeformInsurTaxDedI = DEFORM_INSUR_TAX_DED_I
			 , @EtcInsurI          = ETC_INSUR_I
			 , @DeformInsurI       = DEFORM_INSUR_I
		  FROM uniLITE.fn2017YearEndTax260CalEtcInsurance(@CompCode, @YearYyyy, @EtcInsurI
																			  , @DeformInsurI)
		--(계산)특별세액공제-의료비
		SELECT @MedDedI           = MED_DED_I
			 , @MedTaxDedI        = MED_TAX_DED_I
			 , @MyMedTaxDedI      = MY_MED_TAX_DED_I
			 , @SeniorMedTaxDedI  = SENIOR_MED_TAX_DED_I
			 , @DeformMedTaxDedI  = DEFORM_MED_TAX_DED_I
			 , @SurgeryMedTaxDedI = SURGERY_MED_TAX_DED_I
			 , @MedTotalTaxDedI   = MED_TOTAL_TAX_DED_I
		  FROM uniLITE.fn2017YearEndTax265CalMedicalExpenses(@CompCode, @YearYyyy, @IncomeSuppTotalI
																				 , @MyMedDedI
																				 , @SeniorMedI
																				 , @DeformMedI
																				 , @SurgeryMedI
																				 , @MedTotalI)
		--(계산)특별세액공제-교육비
		SELECT @EducTaxDedI       = EDUC_TAX_DED_I
			 , @PerEducTaxDedI    = PER_EDUC_TAX_DED_I
			 , @UnivEducTaxDedI   = UNIV_EDUC_TAX_DED_I
			 , @StudEducTaxDedI   = STUD_EDUC_TAX_DED_I
			 , @KindEducTaxDedI   = KIND_EDUC_TAX_DED_I
			 , @DeformEducTaxDedI = DEFORM_EDUC_TAX_DED_I
			 , @FieldEducTaxDedI  = FIELD_EDUC_TAX_DED_I
		  FROM uniLITE.fn2017YearEndTax270CalEducationExpenses(@CompCode, @YearYyyy, @PersonNumb)
	
	
		--(계산)특별세액공제-기부금
		SELECT @GiftTaxDedI         = GIFT_TAX_DED_I
			 , @PolicyIndedTaxDedI  = POLICY_INDED_TAX_DED_I
			 , @PolicyGiftTaxDedI   = POLICY_GIFT_TAX_DED_I
			 , @LegalGiftTaxDedI    = LEGAL_GIFT_TAX_DED_I
			 , @StaffGiftTaxDedI    = STAFF_GIFT_TAX_DED_I
			 , @AppointGiftTaxDedI  = APPOINT_GIFT_TAX_DED_I
			 , @AssGiftTaxDedI      = ASS_GIFT_TAX_DED_I
			 , @PolicyIndedDedAmt   = POLICY_INDED_DED_AMT
			 , @PolicyGiftDedAmt    = POLICY_GIFT_DED_AMT
			 , @LegalDedAmt         = LEGAL_DED_AMT
			 , @StaffDedAmt         = STAFF_DED_AMT
			 , @AppointAssTaxDedAmt = APPOINT_ASS_TAX_DED_AMT
		  FROM uniLITE.fn2017YearEndTax275CalContribution(@CompCode, @YearYyyy, @PersonNumb
		  																	  , @EarnIncomeI
																			  , @PolicyInded
																			  , @PolicyGiftI
																			  )
		--(계산)세액공제
		SELECT @NapTaxDedI     = NAP_TAX_DED_I
			 , @HousInterI     = HOUS_INTER_I         --입력금액과 정산금액 변수 동일하게 사용함
			 , @OutsideIncomeI = OUTSIDE_INCOME_I
			 , @MonRentI       = MON_RENT_I           --입력금액과 정산금액 변수 동일하게 사용함
		  FROM uniLITE.fn2017YearEndTax280CalTaxDeduction (@CompCode, @YearYyyy, @IncomeSuppTotalI
																			   , @EarnIncomeI
																			   , @CompTaxI
																			   , @P3TaxDedI
																			   , @HousInterI
																			   , @ForeIncomeI
																			   , @ForeTaxI
																			   , @MonRentI)
	
		--(계산)표준세액공제/결정세액
		SELECT @MedPreMinmI        = MED_PREMINM_I
			 , @HireInsurI         = HIRE_INSUR_I
			 , @HousAmountI        = HOUS_AMOUNT_I
			 , @HousAmountI2       = HOUS_AMOUNT_I_2
			 , @MortageReturnI2    = MORTGAGE_RETURN_I_2
			 , @MortageReturnI     = MORTGAGE_RETURN_I
			 , @MortageReturnI3    = MORTGAGE_RETURN_I_3
			 , @MortageReturnI5    = MORTGAGE_RETURN_I_5
			 , @MortageReturnI4    = MORTGAGE_RETURN_I_4
			 , @MortageReturnI6    = MORTGAGE_RETURN_I_6
			 , @MortageReturnI7    = MORTGAGE_RETURN_I_7
			 , @MortageReturnI8    = MORTGAGE_RETURN_I_8
			 , @MortageReturnI9    = MORTGAGE_RETURN_I_9
			 , @GiftDedI           = GIFT_DED_I
			 , @DedIncomeI         = DED_INCOME_I
			 , @DedIncomeI1        = DED_INCOME_I1
			 , @DedIncomeI2        = DED_INCOME_I2
			 , @TaxStdI            = TAX_STD_I
			 , @TaxStdI1           = TAX_STD_I1
			 , @TaxStdI2           = TAX_STD_I2
			 , @CompTaxI           = COMP_TAX_I
			 , @CompTaxI1          = COMP_TAX_I1
			 , @CompTaxI2          = COMP_TAX_I2
			 , @IncomeReduI        = INCOME_REDU_I
			 , @YouthDedI          = YOUTH_DED_I
			 , @YouthDedI3         = YOUTH_DED_I3
			 , @YouthDedI2         = YOUTH_DED_I2
			 , @YouthDedISum       = YOUTH_DED_I_SUM
			 , @SkillDedI          = SKILL_DED_I
			 , @TaxesReduI         = TAXES_REDU_I
			 , @InTaxDedI          = IN_TAX_DED_I
			 , @ChildTaxDedI       = CHILD_TAX_DED_I
			 , @BringChildDedI     = BRING_CHILD_DED_I
			 , @BirthAdoptI        = BIRTH_ADOPT_I
			 , @SciTaxDedI         = SCI_TAX_DED_I
			 , @SciTaxDedI1        = SCI_TAX_DED_I1
			 , @RetireTaxDedI      = RETIRE_TAX_DED_I
			 , @RetireTaxDedI1     = RETIRE_TAX_DED_I1
			 , @PensTaxDedI        = PENS_TAX_DED_I
			 , @PensTaxDedI1       = PENS_TAX_DED_I1
			 , @EtcInsurTaxDedI    = ETC_INSUR_TAX_DED_I
			 , @DeformInsurTaxDedI = DEFORM_INSUR_TAX_DED_I
			 , @MedTaxDedI         = MED_TAX_DED_I
			 , @EducTaxDedI        = EDUC_TAX_DED_I
			 , @GiftTaxDedI        = GIFT_TAX_DED_I
			 , @PolicyIndedTaxDedI = POLICY_INDED_TAX_DED_I
			 , @PolicyGiftTaxDedI  = POLICY_GIFT_TAX_DED_I
			 , @LegalGiftTaxDedI   = LEGAL_GIFT_TAX_DED_I
			 , @StaffGiftTaxDedI   = STAFF_GIFT_TAX_DED_I
			 , @AppointGiftTaxDedI = APPOINT_GIFT_TAX_DED_I
			 , @AssGiftTaxDedI     = ASS_GIFT_TAX_DED_I
			 , @StdTaxDedI         = STD_TAX_DED_I
			 , @NapTaxDedI         = NAP_TAX_DED_I
			 , @HousInterI         = HOUS_INTER_I
			 , @OutsideIncomeI     = OUTSIDE_INCOME_I
			 , @MonRentI           = MON_RENT_I
			 , @DefInTaxI          = DEF_IN_TAX_I                  --결정소득세
			 , @DefLocalTaxI       = DEF_LOCAL_TAX_I               --결정주민세
			 , @DefSpTaxI          = DEF_SP_TAX_I                  --결정농특세
			 , @DefTaxSum          = DEF_TAX_SUM                   --결정세액합계
		  FROM uniLITE.fn2017YearEndTax285CalFinalizedTaxAmount(@CompCode, @YearYyyy, @IncomeSuppTotalI
																					, @InvestmentDedI
																					, @LongInvestStockDedI
																					, @MedPreMinmI
																					, @HireInsurI
																					, @HousAmountI
																					, @HousAmountI2
																					, @MortageReturnI2
																					, @MortageReturnI
																					, @MortageReturnI3
																					, @MortageReturnI5
																					, @MortageReturnI4
																					, @MortageReturnI6
																					, @MortageReturnI7
																					, @MortageReturnI8
																					, @MortageReturnI9
																					, @GiftDedI
																					, @DedIncomeI
																					, @DedIncomeI1
																					, @DedIncomeI2
																					, @TaxStdI
																					, @TaxStdI1
																					, @TaxStdI2
																					, @CompTaxI
																					, @CompTaxI1
																					, @CompTaxI2
																					, @IncomeReduI
																					, @YouthDedI
																					, @YouthDedI3
																					, @YouthDedI2
																					, @YouthDedISum
																					, @SkillDedI
																					, @TaxesReduI
																					, @InTaxDedI
																					, @ChildTaxDedI
																					, @BringChildDedI
																					, @BirthAdoptI
																					, @SciTaxDedI
																					, @SciTaxDedI1
																					, @RetireTaxDedI
																					, @RetireTaxDedI1
																					, @PensTaxDedI
																					, @PensTaxDedI1
																					, @EtcInsurTaxDedI
																					, @DeformInsurTaxDedI
																					, @MedTaxDedI
																					, @EducTaxDedI
																					, @GiftTaxDedI
																					, @PolicyIndedTaxDedI
																					, @PolicyGiftTaxDedI
																					, @LegalGiftTaxDedI
																					, @StaffGiftTaxDedI
																					, @AppointGiftTaxDedI
																					, @AssGiftTaxDedI
																					, @StdTaxDedI
																					, @NapTaxDedI
																					, @HousInterI
																					, @OutsideIncomeI
																					, @MonRentI
																					, @ForeignNum
																					, @ForeSingleYn
																					, @PersonNumb
																					, @LiveGubun
																					, @ForeignSkillYn
																					, @EarnIncomeI
																					, @BaseDateFr
																					, @BaseDateTo
																					, @NowIncomeI1
																					, @NowIncomeI3
																					, @NowIncomeI2
																					, @OldIncomeI1
																					, @OldIncomeI2
																					, @P1NonTaxFr
																					, @P1NonTaxTo
																					, @P1ExempRate
																					, @P2NonTaxFr
																					, @P2NonTaxTo
																					, @P2ExempRate
																					, @ManyChildNum
																					, @BringChildNum
																					, @BirthAdoptNum1
																					, @BirthAdoptNum2
																					, @BirthAdoptNum3)
		 /*
		  외국인세액계산
		  Case 1) 외국인(FOREIGN_NUM != ''), 단일세율적용  (FORE_SINGLE_YN='Y')                           = 공제없음,단일세율15%
		  Case 2) 외국인(FOREIGN_NUM != ''), 단일세율미적용(FORE_SINGLE_YN='N'), 비거주자(LIVE_GUBUN='2') = 본인공제,연금보험료공제,우리사주조합소득공제
		  Case 3) 외국인(FOREIGN_NUM != ''), 단일세율미적용(FORE_SINGLE_YN='N'),   거주자(LIVE_GUBUN='1') = 내국인과 동일하게 처리
		*/
		--Case 1) 외국인(FOREIGN_NUM != ''), 단일세율적용  (FORE_SINGLE_YN='Y')                           = 공제없음,단일세율15%
		IF @ForeignNum !=  '' AND @ForeSingleYn = 'Y'
		BEGIN
			SET @IncomeDedI         = 0                    --근로소득공제
			SET @EarnIncomeI        = @IncomeSuppTotalI    --근로소득금액
	    
			SET @PerDedI            = 0                    --[기본공제]본인공제
			SET @SpouseDedI         = 0                    --[기본공제]배우자공제
			SET @SuppSubI           = 0                    --[기본공제]부양자공제
	    
			SET @AgedDedI           = 0                    --[추가공제]경로자공제
			SET @DeformDedI         = 0                    --[추가공제]장애인공제
			SET @WomanDedI          = 0                    --[추가공제]부녀자공제
			SET @OneParentDedI      = 0                    --[추가공제]한부모공제
	    
			SET @AnuDedI            = 0                    --[연금보험료공제]국민연금
			SET @PublicPensI        = 0                    --[연금보험료공제]공무원연금
			SET @SoldierPensI       = 0                    --[연금보험료공제]군인연금
			SET @SchPensI           = 0                    --[연금보험료공제]사립학교교직원연금
			SET @PostPensI          = 0                    --[연금보험료공제]별정우체국연금
	    
			SET @MedPreMinmI        = 0                    --[특별소득공제-보험료]건강보험료
			SET @HireInsurI         = 0                    --[특별소득공제-보험료]고용보험료
	    
			SET @HousAmountI        = 0                    --[특별소득공제-주택자금]주택자금불입액(대출기관)
			SET @HousAmountI2       = 0                    --[특별소득공제-주택자금]주택자금불입액(거주자)
			SET @MortageReturnI2    = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년미만)
			SET @MortageReturnI     = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년~29년)
			SET @MortageReturnI3    = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(30년이상)
			SET @MortageReturnI5    = 0                    --[특별소득공제-주택자금]고정금리비거치상환대출(1500만원한도)
			SET @MortageReturnI4    = 0                    --[특별소득공제-주택자금]기타대출(500만원한도)
			SET @MortageReturnI6    = 0                    --[특별소득공제-주택자금]2015년15년이상(고정금리and 비거치식)
			SET @MortageReturnI7    = 0                    --[특별소득공제-주택자금]2015년15년이상(고정금리OR비거치식)
			SET @MortageReturnI8    = 0                    --[특별소득공제-주택자금]2015년15년이상(그밖의대출)
			SET @MortageReturnI9    = 0                    --[특별소득공제-주택자금]2015년10년이상(고정금리OR비거치식)
	    
			SET @GiftDedI           = 0                    --[특별소득공제-기부금]
			SET @LegalGiftDedI      = 0                    --[특별소득공제-기부금]법정기부금
			SET @PrivGiftDedI       = 0                    --[특별소득공제-기부금]특례기부금
			SET @PublicGiftDedI     = 0                    --[특별소득공제-기부금]공익법인신탁기부금
			SET @AppointGiftDedI    = 0                    --[특별소득공제-기부금]지정기부금
			SET @AssGiftDedI        = 0                    --[특별소득공제-기부금]종교단체기부금
	    
			SET @PrivPensI          = 0                    --[그밖소득공제-연금저축]개인연금저축
	    
			SET @HousBuAmt          = 0                    --[그밖소득공제-주택마련]청약저축(240만원한도)
			SET @HousBuAddAmt       = 0                    --[그밖소득공제-주택마련]청약저축(120만원한도)
			SET @HousWorkAmt        = 0                    --[그밖소득공제-주택마련]근로자주택마련저축
			SET @HousBuAmountI      = 0                    --[그밖소득공제-주택마련]주택청약종합저축(240만원한도)
			SET @HousBuAmountAddI   = 0                    --[그밖소득공제-주택마련]주택청약종합저축(120만원한도)
	    
			SET @CardDedI           = 0                    --[그밖소득공제-신용카드]신용카드등
	    
			SET @CompPreminumDedI   = 0                    --[그밖소득공제-기타]소기업,소상공인공제부금소득공제
			SET @InvestmentDedI     = 0                    --[그밖소득공제-기타]투자조합출자공제
			SET @InvestmentDedI2    = 0                    --[그밖소득공제-기타]투자조합출자공제(2013년분)
			SET @InvestmentDedI3    = 0                    --[그밖소득공제-기타]투자조합출자공제(2014년분)
			SET @InvestmentDedI4    = 0                    --[그밖소득공제-기타]투자조합출자공제(2015년이후분)
			SET @StaffStockDedI     = 0                    --[그밖소득공제-기타]우리사주조합출연금액
			SET @StaffGiftDedI      = 0                    --[그밖소득공제-기타]우리사주기부금
			SET @EmployWorkerDedI   = 0                    --[그밖소득공제-기타]고용유지중소기업근로자소득공제
			SET @NotAmountLoanDedI  = 0                    --[그밖소득공제-기타]목돈안드는전세이자상환액공제
			SET @LongInvestStockDedI= 0                    --[그밖소득공제-기타]장기집합투자증권저축
	    
			SET @DedIncomeI         = @IncomeSuppTotalI    --차감근로소득
			SET @DedIncomeI1        = @IncomeSuppTotalI    --차감근로소득(표준세액공제계산용):특별소득공제포함
			SET @DedIncomeI2        = @IncomeSuppTotalI    --차감근로소득(표준세액공제계산용):특별소득공제제외
	    
			SET @OverIncomeDedLmt   = 0                    --특별공제종합한도초과액
	    
			SET @TaxStdI            = @IncomeSuppTotalI    --소득과세표준
			SET @TaxStdI1           = @IncomeSuppTotalI    --소득과세표준(표준세액공제계산용):특별소득공제포함
			SET @TaxStdI2           = @IncomeSuppTotalI    --소득과세표준(표준세액공제계산용):특별소득공제제외
	    
			--(계산)산출세액
			SELECT @CompTaxI  = COMP_TAX_I
				 , @CompTaxI1 = COMP_TAX_I1
				 , @CompTaxI2 = COMP_TAX_I2
			  FROM uniLITE.fn2017YearEndTax240CalCalculatedTaxAmount(@CompCode, @YearYyyy, @ForeignNum, @ForeSingleYn, @TaxStdI, @TaxStdI1, @TaxStdI2)
	    
			--결정세액
			SET @DefInTaxI          = @CompTaxI
	        
			SELECT @DefLocalTaxI = (CASE WHEN @DefInTaxI &gt; 0
										 THEN ROUND((@DefInTaxI * LOCAL_TAX_RATE / 100), 0, 1)      --@DefInTaxI(결정소득세) * LOCAL_TAX_RATE(10%) / 100
										 ELSE 0
									END)
			  FROM HAD200T WITH (NOLOCK)
			 WHERE COMP_CODE    = @CompCode
			   AND TAX_YEAR     = @YearYyyy
			   AND COMPANY_CODE = '2'
	       
			SET @DefSpTaxI          = 0
			SET @DefTaxSum          = ISNULL(@DefInTaxI + @DefLocalTaxI + @DefSpTaxI,0)
	    
			SET @IncomeReduI        = 0                    --[세액감면]소득세법
			SET @YouthDedI          = 0                    --[세액감면]중소기업청년소득세감면금액(100%)
			SET @YouthDedI3         = 0                    --[세액감면]중소기업청년소득세감면금액(70%)
			SET @YouthDedI2         = 0                    --[세액감면]중소기업청년소득세감면금액(50%)
			SET @SkillDedI          = 0                    --[세액감면]외국인기술공제
			SET @TaxesReduI         = 0                    --[세액감면]조감법
	    
			SET @InTaxDedI          = 0                    --[세액공제-근로소득/자녀]근로소득
			SET @ChildTaxDedI       = 0                    --[세액공제-근로소득/자녀]자녀
			SET @BringChildDedI     = 0                    --[세액공제-근로소득/자녀]자녀양육
			SET @BirthAdoptI        = 0                    --[세액공제-근로소득/자녀]출산입양
	    
			SET @SciTaxDedI         = 0                    --[특별세액공제-연금계좌]과학기술인    (급여5,500만원이상 12% 적용)
			SET @SciTaxDedI1        = 0                    --[특별세액공제-연금계좌]과학기술인    (급여5,500만원이하 15% 적용)
			SET @RetireTaxDedI      = 0                    --[특별세액공제-연금계좌]퇴직연금불입액(급여5,500만원이상 12% 적용)
			SET @RetireTaxDedI1     = 0                    --[특별세액공제-연금계좌]퇴직연금불입액(급여5,500만원이하 15% 적용)
			SET @PensTaxDedI        = 0                    --[특별세액공제-연금계좌]연금저축      (급여5,500만원이상 12% 적용)
			SET @PensTaxDedI1       = 0                    --[특별세액공제-연금계좌]연금저축      (급여5,500만원이하 15% 적용)
	    
			SET @EtcInsurTaxDedI    = 0                    --[특별세액공제-보장성보험]기타보험료
			SET @DeformInsurTaxDedI = 0                    --[특별세액공제-보장성보험]장애인전용보장보험료
	    
			SET @MedTaxDedI         = 0                    --[특별세액공제-의료비]의료비
			SET @MyMedTaxDedI       = 0                    --[특별세액공제-의료비]본인의료비
			SET @SeniorMedTaxDedI   = 0                    --[특별세액공제-의료비]경료의료비
			SET @DeformMedTaxDedI   = 0                    --[특별세액공제-의료비]장애의료비
			SET @MedTotalTaxDedI    = 0                    --[특별세액공제-의료비]그밖의공제대상자의료비
	    
			SET @EducTaxDedI        = 0                    --[특별세액공제-교육비]교육비
			SET @PerEducTaxDedI     = 0                    --[특별세액공제-교육비]본인교육비
			SET @UnivEducTaxDedI    = 0                    --[특별세액공제-교육비]대학교교육비
			SET @StudEducTaxDedI    = 0                    --[특별세액공제-교육비]초중고교육비
			SET @KindEducTaxDedI    = 0                    --[특별세액공제-교육비]유치원교육비
			SET @DeformEducTaxDedI  = 0                    --[특별세액공제-교육비]장애인특수교육비
			SET @FieldEducTaxDedI   = 0                    --[특별세액공제-교육비]체험학습비
	    
			SET @PolicyIndedDedAmt  = 0                    --[특별세액공제-기부금](공제대상)정치자금기부금(10만원미만)
			SET @PolicyGiftDedAmt   = 0                    --[특별세액공제-기부금](공제대상)정치자금기부금(10만원초과)
			SET @LegalDedAmt        = 0                    --[특별세액공제-기부금](공제대상)법정기부금
			SET @StaffDedAmt        = 0                    --[특별세액공제-기부금](공제대상)우리사주기부금
			SET @AppointAssTaxDedAmt= 0                    --[특별세액공제-기부금](공제대상)지정기부금
	    
			SET @GiftTaxDedI        = 0                    --[특별세액공제-기부금]기부금
			SET @PolicyIndedTaxDedI = 0                    --[특별세액공제-기부금]정치자금기부금(10만원미만)
			SET @PolicyGiftTaxDedI  = 0                    --[특별세액공제-기부금]정치자금기부금(10만원초과)
			SET @LegalGiftTaxDedI   = 0                    --[특별세액공제-기부금]법정기부금
			SET @StaffGiftTaxDedI   = 0                    --[특별세액공제-기부금]우리사주기부금
			SET @AppointGiftTaxDedI = 0                    --[특별세액공제-기부금]지정기부금
			SET @AssGiftTaxDedI     = 0                    --[특별세액공제-기부금]종교단체기부금
	    
			SET @StdTaxDedI         = 0                    --[표준세액공제]
	    
			SET @NapTaxDedI         = 0                    --[세액공제]납세조합세액
			SET @HousInterI         = 0                    --[세액공제]주택자금상환액
			SET @OutsideIncomeI     = 0                    --[세액공제]외국납부세액
			SET @MonRentI           = 0                    --[세액공제]월세액
		END
	
		--Case 2) 외국인(FOREIGN_NUM != ''), 단일세율미적용(FORE_SINGLE_YN='N'), 비거주자(LIVE_GUBUN='2') - 본인공제,연금보험료공제,우리사주조합소득공제
		IF @ForeignNum !=  '' AND @ForeSingleYn = 'N' AND @LiveGubun = '2'
		BEGIN
			SET @IncomeDedI         = @IncomeDedI          --근로소득공제
			SET @EarnIncomeI        = @EarnIncomeI         --근로소득금액
	    
			SET @PerDedI            = @PerDedI             --[기본공제]본인공제
			SET @SpouseDedI         = 0                    --[기본공제]배우자공제
			SET @SuppSubI           = 0                    --[기본공제]부양자공제
	    
			SET @AgedDedI           = 0                    --[추가공제]경로자공제
			SET @DeformDedI         = 0                    --[추가공제]장애인공제
			SET @WomanDedI          = 0                    --[추가공제]부녀자공제
			SET @OneParentDedI      = 0                    --[추가공제]한부모공제
	    
			SET @AnuDedI            = @AnuDedI             --[연금보험료공제]국민연금
			SET @PublicPensI        = @PublicPensI         --[연금보험료공제]공무원연금
			SET @SoldierPensI       = @SoldierPensI        --[연금보험료공제]군인연금
			SET @SchPensI           = @SchPensI            --[연금보험료공제]사립학교교직원연금
			SET @PostPensI          = @PostPensI           --[연금보험료공제]별정우체국연금
	    
			SET @MedPreMinmI        = 0                    --[특별소득공제-보험료]건강보험료
			SET @HireInsurI         = 0                    --[특별소득공제-보험료]고용보험료
	    
			SET @HousAmountI        = 0                    --[특별소득공제-주택자금]주택자금불입액(대출기관)
			SET @HousAmountI2       = 0                    --[특별소득공제-주택자금]주택자금불입액(거주자)
			SET @MortageReturnI2    = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년미만)
			SET @MortageReturnI     = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년~29년)
			SET @MortageReturnI3    = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(30년이상)
			SET @MortageReturnI5    = 0                    --[특별소득공제-주택자금]고정금리비거치상환대출(1500만원한도)
			SET @MortageReturnI4    = 0                    --[특별소득공제-주택자금]기타대출(500만원한도)
			SET @MortageReturnI6    = 0                    --[특별소득공제-주택자금]2015년15년이상(고정금리AND 비거치식)
			SET @MortageReturnI7    = 0                    --[특별소득공제-주택자금]2015년15년이상(고정금리OR비거치식)
			SET @MortageReturnI8    = 0                    --[특별소득공제-주택자금]2015년15년이상(그밖의대출)
			SET @MortageReturnI9    = 0                    --[특별소득공제-주택자금]2015년10년이상(고정금리OR비거치식)
	    
			SET @GiftDedI           = 0                    --[특별소득공제-기부금]
			SET @LegalGiftDedI      = 0                    --[특별소득공제-기부금]법정기부금
			SET @PrivGiftDedI       = 0                    --[특별소득공제-기부금]특례기부금
			SET @PublicGiftDedI     = 0                    --[특별소득공제-기부금]공익법인신탁기부금
			SET @AppointGiftDedI    = 0                    --[특별소득공제-기부금]지정기부금
			SET @AssGiftDedI        = 0                    --[특별소득공제-기부금]종교단체기부금
	    
			SET @PrivPensI          = 0                    --[그밖소득공제-연금저축]개인연금저축
	    
			SET @HousBuAmt          = 0                    --[그밖소득공제-주택마련]청약저축(240만원한도)
			SET @HousBuAddAmt       = 0                    --[그밖소득공제-주택마련]청약저축(120만원한도)
			SET @HousWorkAmt        = 0                    --[그밖소득공제-주택마련]근로자주택마련저축
			SET @HousBuAmountI      = 0                    --[그밖소득공제-주택마련]주택청약종합저축(240만원한도)
			SET @HousBuAmountAddI   = 0                    --[그밖소득공제-주택마련]주택청약종합저축(120만원한도)
	    
			SET @CardDedI           = 0                    --[그밖소득공제-신용카드]신용카드등
	    
			SET @CompPreminumDedI   = 0                    --[그밖소득공제-기타]소기업,소상공인공제부금소득공제
			SET @InvestmentDedI     = 0                    --[그밖소득공제-기타]투자조합출자공제
			SET @InvestmentDedI2    = 0                    --[그밖소득공제-기타]투자조합출자공제(2013년분)
			SET @InvestmentDedI3    = 0                    --[그밖소득공제-기타]투자조합출자공제(2014년분)
			SET @InvestmentDedI4    = 0                    --[그밖소득공제-기타]투자조합출자공제(2015년이후분)
			SET @StaffStockDedI     = @StaffStockDedI      --[그밖소득공제-기타]우리사주조합출연금액
			SET @StaffGiftDedI      = 0                    --[그밖소득공제-기타]우리사주기부금
			SET @EmployWorkerDedI   = 0                    --[그밖소득공제-기타]고용유지중소기업근로자소득공제
			SET @NotAmountLoanDedI  = 0                    --[그밖소득공제-기타]목돈안드는전세이자상환액공제
			SET @LongInvestStockDedI= 0                    --[그밖소득공제-기타]장기집합투자증권저축
	    
			SET @DedIncomeI         = @EarnIncomeI
									- @PerDedI
									- @AnuDedI
									- @PublicPensI
									- @SoldierPensI
									- @SchPensI
									- @PostPensI           --차감근로소득
			SET @DedIncomeI1        = @DedIncomeI          --차감근로소득(표준세액공제계산용):특별소득공제포함
			SET @DedIncomeI2        = @DedIncomeI          --차감근로소득(표준세액공제계산용):특별소득공제제외
	    
			SET @TaxStdI            = @DedIncomeI
									- @StaffStockDedI      --소득과세표준
	    
			SET @TaxStdI1           = @TaxStdI             --소득과세표준(표준세액공제계산용):특별소득공제포함
			SET @TaxStdI2           = @TaxStdI             --소득과세표준(표준세액공제계산용):특별소득공제제외
	    
			--(계산)산출세액
			SELECT @CompTaxI  = COMP_TAX_I
				 , @CompTaxI1 = COMP_TAX_I1
				 , @CompTaxI2 = COMP_TAX_I2
			  FROM uniLITE.fn2017YearEndTax240CalCalculatedTaxAmount(@CompCode, @YearYyyy, @ForeignNum, @ForeSingleYn, @TaxStdI, @TaxStdI1, @TaxStdI2)
	    
			--결정세액
			SET @DefInTaxI          = @CompTaxI
	        
			SELECT @DefLocalTaxI = (CASE WHEN @DefInTaxI &gt; 0
										 THEN ROUND((@DefInTaxI * LOCAL_TAX_RATE / 100), 0, 1)      --@DefInTaxI(결정소득세) * LOCAL_TAX_RATE(10%) / 100
										 ELSE 0
									END)
			  FROM HAD200T WITH (NOLOCK)
			 WHERE COMP_CODE    = @CompCode
			   AND TAX_YEAR     = @YearYyyy
			   AND COMPANY_CODE = '2'
	       
			SET @DefSpTaxI          = 0
			SET @DefTaxSum          = ISNULL(@DefInTaxI + @DefLocalTaxI + @DefSpTaxI,0)
	    
			SET @IncomeReduI        = 0                    --[세액감면]소득세법
			SET @YouthDedI          = 0                    --[세액감면]중소기업청년소득세감면금액(100%)
			SET @YouthDedI3         = 0                    --[세액감면]중소기업청년소득세감면금액(70%)
			SET @YouthDedI2         = 0                    --[세액감면]중소기업청년소득세감면금액(50%)
			SET @SkillDedI          = 0                    --[세액감면]외국인기술공제
			SET @TaxesReduI         = 0                    --[세액감면]조감법
	    
			SET @InTaxDedI          = 0                    --[세액공제-근로소득/자녀]근로소득
			SET @ChildTaxDedI       = 0                    --[세액공제-근로소득/자녀]자녀
			SET @BringChildDedI     = 0                    --[세액공제-근로소득/자녀]자녀양육
			SET @BirthAdoptI        = 0                    --[세액공제-근로소득/자녀]출산입양
	    
			SET @SciTaxDedI         = @SciTaxDedI          --[특별세액공제-연금계좌]과학기술인    (급여5,500만원이상 12% 적용)
			SET @SciTaxDedI1        = @SciTaxDedI1         --[특별세액공제-연금계좌]과학기술인    (급여5,500만원이하 15% 적용)
			SET @RetireTaxDedI      = @RetireTaxDedI       --[특별세액공제-연금계좌]퇴직연금불입액(급여5,500만원이상 12% 적용)
			SET @RetireTaxDedI1     = @RetireTaxDedI1      --[특별세액공제-연금계좌]퇴직연금불입액(급여5,500만원이하 15% 적용)
			SET @PensTaxDedI        = @PensTaxDedI         --[특별세액공제-연금계좌]연금저축      (급여5,500만원이상 12% 적용)
			SET @PensTaxDedI1       = @PensTaxDedI1        --[특별세액공제-연금계좌]연금저축      (급여5,500만원이하 15% 적용)
	    
			SET @EtcInsurTaxDedI    = 0                    --[특별세액공제-보장성보험]기타보험료
			SET @DeformInsurTaxDedI = 0                    --[특별세액공제-보장성보험]장애인전용보장보험료
	    
			SET @MedTaxDedI         = 0                    --[특별세액공제-의료비]의료비
			SET @MyMedTaxDedI       = 0                    --[특별세액공제-의료비]본인의료비
			SET @SeniorMedTaxDedI   = 0                    --[특별세액공제-의료비]경료의료비
			SET @DeformMedTaxDedI   = 0                    --[특별세액공제-의료비]장애의료비
			SET @MedTotalTaxDedI    = 0                    --[특별세액공제-의료비]그밖의공제대상자의료비
	    
			SET @EducTaxDedI        = 0                    --[특별세액공제-교육비]교육비
			SET @PerEducTaxDedI     = 0                    --[특별세액공제-교육비]본인교육비
			SET @UnivEducTaxDedI    = 0                    --[특별세액공제-교육비]대학교교육비
			SET @StudEducTaxDedI    = 0                    --[특별세액공제-교육비]초중고교육비
			SET @KindEducTaxDedI    = 0                    --[특별세액공제-교육비]유치원교육비
			SET @DeformEducTaxDedI  = 0                    --[특별세액공제-교육비]장애인특수교육비
			SET @FieldEducTaxDedI   = 0                    --[특별세액공제-교육비]체험학습비
	    
			SET @PolicyIndedDedAmt  = 0                    --[특별세액공제-기부금](공제대상)정치자금기부금(10만원미만)
			SET @PolicyGiftDedAmt   = 0                    --[특별세액공제-기부금](공제대상)정치자금기부금(10만원초과)
			SET @LegalDedAmt        = 0                    --[특별세액공제-기부금](공제대상)법정기부금
			SET @StaffDedAmt        = 0                    --[특별세액공제-기부금](공제대상)우리사주기부금
			SET @AppointAssTaxDedAmt= 0                    --[특별세액공제-기부금](공제대상)지정기부금
	    
			SET @GiftTaxDedI        = 0                    --[특별세액공제-기부금]기부금
			SET @PolicyIndedTaxDedI = 0                    --[특별세액공제-기부금]정치자금기부금(10만원미만)
			SET @PolicyGiftTaxDedI  = 0                    --[특별세액공제-기부금]정치자금기부금(10만원초과)
			SET @LegalGiftTaxDedI   = 0                    --[특별세액공제-기부금]법정기부금
			SET @StaffGiftTaxDedI   = 0                    --[특별세액공제-기부금]우리사주기부금
			SET @AppointGiftTaxDedI = 0                    --[특별세액공제-기부금]지정기부금
			SET @AssGiftTaxDedI     = 0                    --[특별세액공제-기부금]종교단체기부금
	    
			SET @StdTaxDedI         = 0                    --[표준세액공제]
	    
			SET @NapTaxDedI         = 0                    --[세액공제]납세조합세액
			SET @HousInterI         = 0                    --[세액공제]주택자금상환액
			SET @OutsideIncomeI     = 0                    --[세액공제]외국납부세액
			SET @MonRentI           = 0                    --[세액공제]월세액
		END
	
		--(집계)기납부세액
		SELECT @NowInTaxI       = NOW_IN_TAX_I
			 , @NowLocalTaxI    = NOW_LOCAL_TAX_I
			 , @NowSpTaxI       = NOW_SP_TAX_I
			 , @PreInTaxI       = PRE_IN_TAX_I
			 , @PreLocalTaxI    = PRE_LOCAL_TAX_I
			 , @PreSpTaxI       = PRE_SP_TAX_I
			 , @NapInTaxI       = NAP_IN_TAX_I
			 , @NapLocalTaxI    = NAP_LOCAL_TAX_I
			 , @NapSpTaxI       = NAP_SP_TAX_I
			 , @NowTaxSum       = NOW_TAX_SUM
			 , @PreTaxSum       = PRE_TAX_SUM
			 , @NapTaxSum       = NAP_TAX_SUM
			 , @PaidInTaxSum    = PAID_IN_TAX_SUM
			 , @PaidLocalTaxSum = PAID_LOCAL_TAX_SUM
			 , @PaidSpTaxSum    = PAID_SP_TAX_SUM
			 , @PaidTaxSum      = PAID_TAX_SUM
		  FROM uniLITE.fn2017YearEndTax290GetPaidTaxAmount(@CompCode, @YearYyyy, @PersonNumb)
	
		--(계산)차감징수세액
		SELECT @InTaxI    = IN_TAX_I
			 , @LocalTaxI = LOCAL_TAX_I
			 , @SpTaxI    = SP_TAX_I
			 , @TaxSum    = TAX_SUM
		  FROM uniLITE.fn2017YearEndTax295CalBalanceTaxAmount(@CompCode, @YearYyyy, @DefInTaxI
																				  , @DefLocalTaxI
																				  , @DefSpTaxI
																				  , @NowInTaxI
																				  , @NowLocalTaxI
																				  , @NowSpTaxI
																				  , @PreInTaxI
																				  , @PreLocalTaxI
																				  , @PreSpTaxI
																				  , @NapInTaxI
																				  , @NapLocalTaxI
																				  , @NapSpTaxI)
	
		--(계산)세액산출요약 합계
		SET @Tab1DedAmt  = @PerDedI           + @SpouseDedI      + @SuppSubI                                                   --(세액산출요약)기본공제                                                                                                                                                   --(조회용)기본공제
		SET @Tab2DedAmt  = @AgedDedI          + @DeformDedI      + @WomanDedI       + @OneParentDedI                           --(세액산출요약)추가공제
		SET @Tab3DedAmt  = @AnuDedI           + @PublicPensI     + @SoldierPensI    + @SchPensI         + @PostPensI           --(세액산출요약)연금보험료공제
		SET @Tab4DedAmt  = @MedPreMinmI       + @HireInsurI                                                                    --(세액산출요약)특별소득공제-보험료
		SET @Tab5DedAmt  = @HousAmountI       + @HousAmountI2    + @MortageReturnI2
						 + @MortageReturnI    + @MortageReturnI3 + @MortageReturnI5 + @MortageReturnI4
						 + @MortageReturnI6   + @MortageReturnI7 + @MortageReturnI8 + @MortageReturnI9                         --(세액산출요약)특별소득공제-주택자금
		SET @Tab6DedAmt  = @PrivPensI                                                                                          --(세액산출요약)그밖소득공제-연금저축
		SET @Tab7DedAmt  = @HousBuAmt         + @HousBuAddAmt    + @HousWorkAmt     + @HousBuAmountI    + @HousBuAmountAddI    --(세액산출요약)그밖소득공제-주택마련
		SET @Tab8DedAmt  = @CardDedI                                                                                           --(세액산출요약)그밖소득공제-신용카드
		SET @Tab9DedAmt  = @CompPreminumDedI  + @InvestmentDedI  + @StaffStockDedI  + @EmployWorkerDedI
						 + @NotAmountLoanDedI + @LongInvestStockDedI                                                           --(세액산출요약)그밖소득공제-기타
		SET @Tab10DedAmt = @IncomeReduI       + @YouthDedI       + @YouthDedI3      + @YouthDedI2      + @SkillDedI        + @TaxesReduI          --(세액산출요약)세액감면
		SET @Tab11DedAmt = @InTaxDedI         + @ChildTaxDedI    + @BringChildDedI  + @BirthAdoptI                             --(세액산출요약)세액공제-근로소득/자녀
		SET @Tab12DedAmt = @SciTaxDedI        + @RetireTaxDedI   + @PensTaxDedI
						 + @SciTaxDedI1       + @RetireTaxDedI1  + @PensTaxDedI1                                               --(세액산출요약)특별세액공제-연금계좌
		SET @Tab13DedAmt = @EtcInsurTaxDedI   + @DeformInsurTaxDedI                                                            --(세액산출요약)특별세액공제-보장성보험
		SET @Tab14DedAmt = @MedTaxDedI                                                                                         --(세액산출요약)특별세액공제-의료비
		SET @Tab15DedAmt = @EducTaxDedI                                                                                        --(세액산출요약)특별세액공제-교육비
		SET @Tab16DedAmt = @GiftTaxDedI                                                                                        --(세액산출요약)특별세액공제-기부금
		SET @Tab17DedAmt = @NapTaxDedI        + @HousInterI      + @OutsideIncomeI  + @MonRentI                                --(세액산출요약)특별세액공제-기타
         
    
    
		--개별자료등록에서 호출시:N, 일괄자료등록에서 호출시:Y

        --정산세액계산 조회
        SELECT A.PERSON_NUMB
			 , (CASE WHEN ISNULL(A.ORI_JOIN_DATE,'00000000') = '00000000'
					 THEN A.JOIN_DATE
					 ELSE A.ORI_JOIN_DATE
				 END)                                           AS JOIN_DATE                   --[숨김]입사일
			 , CASE WHEN A.RETR_DATE != '0000000' AND LEFT(A.RETR_DATE, 4) &lt;= @YearYyyy 
					THEN ISNULL(A.RETR_DATE,'00000000')   
					ELSE '00000000' 
				END                                             AS RETR_DATE                   --[숨김]퇴사일
			 , A.DEPT_CODE                                                                     --[숨김]부서코드
			 , A.DEPT_NAME                                                                     --[숨김]부서명
			 , @YearYyyy                                        AS YEAR_YYYY
			 , @HalfwayType                                     AS HALFWAY_TYPE                --[숨김]중도퇴사자정산
			 , @ForeSingleYn                                    AS FORE_SINGLE_YN              --[숨김]외국인단일세율적용
			 , @ForeDispachYn                                   AS FOREIGN_DISPATCH_YN         --[숨김]외국인단일세율적용
			 , @HouseholderYn                                   AS HOUSEHOLDER_YN              --[숨김]세대주여부
    
			 , @IncomeSuppTotalI                                AS INCOME_SUPP_TOTAL_I         --총급여액
			 , @PayTotalI                                       AS PAY_TOTAL_I                 --[숨김]급여총액
			 , @BonusTotalI                                     AS BONUS_TOTAL_I               --[숨김]상여총액
			 , @AddBonusI                                       AS ADD_BONUS_I                 --[숨김]인정상여금액
			 , @StockProfitI                                    AS STOCK_PROFIT_I              --[숨김]주식매수선택행사이익
			 , @OwnerStockDrawI                                 AS OWNER_STOCK_DRAW_I          --[숨김]우리사주조합인출금
			 , @OfRetrOverI                                     AS OF_RETR_OVER_I              --[숨김]임원퇴직한도초과액
    
			 , @NowPayTotI                                      AS NOW_PAY_TOT_I               --[숨김]주(현)급여총액
			 , @NowBonusTotalI                                  AS NOW_BONUS_TOTAL_I           --[숨김]주(현)상여총액
			 , @NowAddBonusI                                    AS NOW_ADD_BONUS_I             --[숨김]주(현)인정상여금액
			 , @NowStockProfitI                                 AS NOW_STOCK_PROFIT_I          --[숨김]주(현)주식매수선택행사이익
			 , @NowOwnerStockDrawI                              AS NOW_OWNER_STOCK_DRAW_I      --[숨김]주(현)우리사주조합인출금
			 , @NowOfRetrOverI                                  AS NOW_OF_RETR_OVER_I          --[숨김]주(현)임원퇴직한도초과액
    
			 , @OldPayTotI                                      AS OLD_PAY_TOT_I               --[숨김]종(전)급여총액
			 , @OldBonusTotalI                                  AS OLD_BONUS_TOTAL_I           --[숨김]종(전)상여총액
			 , @OldAddBonusI                                    AS OLD_ADD_BONUS_I             --[숨김]종(전)인정상여금액
			 , @OldStockProfitI                                 AS OLD_STOCK_PROFIT_I          --[숨김]종(전)주식매수선택행사이익
			 , @OldOwnerStockDrawI                              AS OLD_OWNER_STOCK_DRAW_I      --[숨김]종(전)우리사주조합인출금
			 , @OldOfRetrOverI                                  AS OLD_OF_RETR_OVER_I          --[숨김]종(전)임원퇴직한도초과액
    
			 , @NapPayTotI                                      AS NAP_PAY_TOT_I               --[숨김](납)급여총액
			 , @NapBonusTotalI                                  AS NAP_BONUS_TOTAL_I           --[숨김](납)상여총액
    
			 , @IncomeDedI                                      AS INCOME_DED_I                --근로소득공제
			 , @EarnIncomeI                                     AS EARN_INCOME_I               --근로소득금액
    
			 , @PerDedI                                         AS PER_DED_I                   --본인공제
			 , @SpouseDedI                                      AS SPOUSE_DED_I                --[숨김]배우자공제
			 , @Spouse                                          AS SPOUSE                      --배우자유무
			 , @SuppNum                                         AS SUPP_NUM                    --부양자
			 , @SuppSubI                                        AS SUPP_SUB_I                  --부양자공제
    
			 , @AgedNum                                         AS AGED_NUM                    --경로자
			 , @DeformNum                                       AS DEFORM_NUM                  --장애자
			 , @ManyChildNum                                    AS MANY_CHILD_NUM              --자녀
			 , @BringChildNum                                   AS BRING_CHILD_NUM             --자녀양육
			 , @BirthAdoptNum                                   AS BIRTH_ADOPT_NUM             --출산입양
			 , @Woman                                           AS WOMAN                       --[숨김]부녀자유무
			 , @OneParent                                       AS ONE_PARENT                  --[숨김]한부모
    		 , @BirthAdoptNum1                                  AS BIRTH_ADOPT_NUM1			   -- 출산입양첫째				
			 , @BirthAdoptNum2                                  AS BIRTH_ADOPT_NUM2			   -- 출산입양둘째
			 , @BirthAdoptNum3                                  AS BIRTH_ADOPT_NUM3			   -- 출산입양셋째	
			 , @AgedDedI                                        AS AGED_DED_I                  --경로공제
			 , @DeformDedI                                      AS DEFORM_DED_I                --장애인공제
			 , @WomanDedI                                       AS WOMAN_DED_I                 --부녀자공제
			 , @OneParentDedI                                   AS ONE_PARENT_DED_I            --한부모공제
    
			 , @AnuI                                            AS ANU_I                       --[숨김]국민연금
			 , @AnuAddI                                         AS ANU_ADD_I                   --[숨김]국민연금(개별입력)
			 , @AnuDedI                                         AS ANU_DED_I                   --국민연금공제
			 , @PublicPensI                                     AS PUBLIC_PENS_I               --공무원연금
			 , @SoldierPensI                                    AS SOLDIER_PENS_I              --군인연금
			 , @SchPensI                                        AS SCH_PENS_I                  --사립학교교직원연금
			 , @PostPensI                                       AS POST_PENS_I                 --별정우체국연금
    
			 , @MedPreMinmI                                     AS MED_PREMINM_I               --의료보험
			 , @HireInsurI                                      AS HIRE_INSUR_I                --고용보험
    
			 , @HousAmountI                                     AS HOUS_AMOUNT_I               --주택자금불입액(대출기관)
			 , @HousAmountI2                                    AS HOUS_AMOUNT_I_2             --주택자금불입액(거주자)
			 , @MortageReturnI2                                 AS MORTGAGE_RETURN_I_2         --장기주택저당차입금이자상환액(15년미만)
			 , @MortageReturnI                                  AS MORTGAGE_RETURN_I           --장기주택저당차입금이자상환액(15년~29년)
			 , @MortageReturnI3                                 AS MORTGAGE_RETURN_I_3         --장기주택저당차입금이자상환액(30년이상)
			 , @MortageReturnI5                                 AS MORTGAGE_RETURN_I_5         --고정금리비거치상환대출(1500만원한도)
			 , @MortageReturnI4                                 AS MORTGAGE_RETURN_I_4         --기타대출(500만원한도)
			 , @MortageReturnI6                                 AS MORTGAGE_RETURN_I_6         --2015년15년이상(고정금리AND 비거치식)
			 , @MortageReturnI7                                 AS MORTGAGE_RETURN_I_7         --2015년15년이상(고정금리OR비거치식)
			 , @MortageReturnI8                                 AS MORTGAGE_RETURN_I_8         --2015년15년이상(그밖의대출)
			 , @MortageReturnI9                                 AS MORTGAGE_RETURN_I_9         --2015년10년이상(고정금리OR비거치식)
    
			 , @PrivPensI                                       AS PRIV_PENS_I                 --개인연금저축
    
			 , @HousBuAmt                                       AS HOUS_BU_AMT                 --청약저축
			 , @HousBuAddAmt                                    AS HOUS_BU_ADD_AMT             --청약저축
			 , @HousWorkAmt                                     AS HOUS_WORK_AMT               --근로자주택마련저축
			 , @HousBuAmountI                                   AS HOUS_BU_AMOUNT_I            --주택청약종합저축
			 , @HousBuAmountAddI                                AS HOUS_BU_AMOUNT_ADD_I        --주택청약종합저축
    
			 , @CardDedI                                        AS CARD_DED_I                  --신용카드공제
			 , @CardUseI                                        AS CARD_USE_I                  --[숨김]신용카드사용액
			 , @CashUseI                                        AS CASH_USE_I                  --[숨김]현금영수증사용액
			 , @DebitCardUseI                                   AS DEBIT_CARD_USE_I            --[숨김]직불카드사용액
			 , @TraMarketUseI                                   AS TRA_MARKET_USE_I            --[숨김]전통시장사용액
			 , @TrafficUseI                                     AS TRAFFIC_USE_I               --[숨김]대중교통이용액
			
    
			 , @CompPreminum                                    AS COMP_PREMINUM               --소기업,소상공인공제부금소득공제
			 , @CompPreminumDedI                                AS COMP_PREMINUM_DED_I         --소기업,소상공인공제부금소득공제
			 , @InvestmentDedI                                  AS INVESTMENT_DED_I            --투자조합출자공제
			 , @InvestmentDedI2                                 AS INVESTMENT_DED_I2           --투자조합출자공제(2013년분)
			 , @InvestmentDedI3                                 AS INVESTMENT_DED_I3           --투자조합출자공제(2014년분)
			 , @InvestmentDedI4                                 AS INVESTMENT_DED_I4           --투자조합출자공제(2015년이후분)
			 , @StaffStockDedI                                  AS STAFF_STOCK_DED_I           --우리사주조합출연금액
			 , @EmployWorkerDedI                                AS EMPLOY_WORKER_DED_I         --고용유지중소기업근로자소득공제
			 , @NotAmountLoanDedI                               AS NOT_AMOUNT_LOAN_DED_I       --목돈안드는전세이자상환
			 , @LongInvestStockDedI                             AS LONG_INVEST_STOCK_DED_I     --장기집합투자증권저축
    
			 , @IncomeReduI                                     AS INCOME_REDU_I               --소득세법
			 , @YouthDedI                                       AS YOUTH_DED_I                 --중소기업청년소득세감면금액(100%)
			 , @YouthDedI3                                      AS YOUTH_DED_I3                --중소기업청년소득세감면금액(70%)
			 , @YouthDedI2                                      AS YOUTH_DED_I2                --중소기업청년소득세감면금액(50%)
			 , @YouthDedISum                                    AS YOUTH_DED_I_SUM             --중소기업청년소득세감면금액(50%)
			 , @SkillDedI                                       AS SKILL_DED_I                 --외국인기술공제
			 , @TaxesReduI                                      AS TAXES_REDU_I                --조감법
    
			 , @InTaxDedI                                       AS IN_TAX_DED_I                --근로소득세액공제
			 , @ChildTaxDedI                                    AS CHILD_TAX_DED_I             --자녀세액공제
			 , @BringChildDedI                                  AS BRING_CHILD_DED_I           --자녀양육공제
			 , @BirthAdoptI                                     AS BIRTH_ADOPT_I               --출산입양공제
    
			 , @SciDeducI                                       AS SCI_DEDUC_I                 --(공제대상)과학기술인공제
			 , @RetirePensI                                     AS RETIRE_PENS_I               --(공제대상)근로자퇴직급여보장법
			 , @PensI                                           AS PENS_I                      --(공제대상)연금저축
			 , @SciTaxDedI                                      AS SCI_TAX_DED_I               --과학기술인공제      (급여5,500만원이상 12% 적용)
			 , @SciTaxDedI1                                     AS SCI_TAX_DED_I1              --과학기술인공제      (급여5,500만원이하 15% 적용)
			 , @RetireTaxDedI                                   AS RETIRE_TAX_DED_I            --근로자퇴직급여보장법(급여5,500만원이상 12% 적용)
			 , @RetireTaxDedI1                                  AS RETIRE_TAX_DED_I1           --근로자퇴직급여보장법(급여5,500만원이하 15% 적용)
			 , @PensTaxDedI                                     AS PENS_TAX_DED_I              --연금저축            (급여5,500만원이상 12% 적용)
			 , @PensTaxDedI1                                    AS PENS_TAX_DED_I1             --연금저축            (급여5,500만원이하 15% 적용)
    
			 , @EtcInsurI                                       AS ETC_INSUR_I                 --(공제대상)보장성보험
			 , @DeformInsurI                                    AS DEFORM_INSUR_I              --(공제대상)장애인전용보장성보험
			 , @EtcInsurTaxDedI                                 AS ETC_INSUR_TAX_DED_I         --보장성보험
			 , @DeformInsurTaxDedI                              AS DEFORM_INSUR_TAX_DED_I      --장애인전용보장성보험
    
			 , @MedDedI                                         AS MED_DED_I                   --(공제대상)[숨김]의료비공제금액
			 , @MyMedDedI                                       AS MY_MED_DED_I                --(공제대상)[숨김]본인의료비
			 , @SeniorMedI                                      AS SENIOR_MED_I                --(공제대상)[숨김]경로의료비
			 , @DeformMedI                                      AS DEFORM_MED_I                --(공제대상)[숨김]난임시술비
			 , @SurgeryMedI                                     AS SURGERY_MED_I               --(공제대상)[숨김]장애의료비
			 , @MedTotalI                                       AS MED_TOTAL_I                 --(공제대상)그밖의 공제대상자 의료비
			 , @MedTaxDedI                                      AS MED_TAX_DED_I               --의료비공제금액
			 , @MyMedTaxDedI                                    AS MY_MED_TAX_DED_I            --[숨김]본인의료비
			 , @SeniorMedTaxDedI                                AS SENIOR_MED_TAX_DED_I        --[숨김]경로의료비
			 , @DeformMedTaxDedI                                AS DEFORM_MED_TAX_DED_I        --[숨김]장애의료비
			 , @SurgeryMedTaxDedI                               AS SURGERY_MED_TAX_DED_I       --[숨김]난임시술비
			 , @MedTotalTaxDedI                                 AS MED_TOTAL_TAX_DED_I         --[숨김]그밖의 공제대상자 의료비
    
			 , @EducDedI                                        AS EDUC_DED_I                  --(공제대상)[숨김]교육비공제
			 , @UnivEducNum                                     AS UNIV_EDUC_NUM               --대학교자녀수
			 , @StudEducNum                                     AS STUD_EDUC_NUM               --초중고자녀수
			 , @KindEduNum                                      AS KIND_EDU_NUM                --유치원자녀수
			 , @PerEducDedI                                     AS PER_EDUC_DED_I              --(공제대상)본인교육비공제
			 , @UnivEducDedI                                    AS UNIV_EDUC_DED_I             --(공제대상)대학교교육비공제
			 , @StudEducDedI                                    AS STUD_EDUC_DED_I             --(공제대상)초중고교육비공제
			 , @KindEducDedI                                    AS KIND_EDUC_DED_I             --(공제대상)유치원교육비공제
			 , @DeformEducDedI                                  AS DEFORM_EDUC_DED_I           --(공제대상)장애인특수교육비공제
			 , @FieldEducDedI                                   AS FIELD_EDUC_DED_I           --(공제대상)체험학습비공제
			 , @EducTaxDedI                                     AS EDUC_TAX_DED_I              --교육비공제
			 , @PerEducTaxDedI                                  AS PER_EDUC_TAX_DED_I          --본인교육비공제
			 , @UnivEducTaxDedI                                 AS UNIV_EDUC_TAX_DED_I         --대학교교육비공제
			 , @StudEducTaxDedI                                 AS STUD_EDUC_TAX_DED_I         --초중고교육비공제
			 , @KindEducTaxDedI                                 AS KIND_EDUC_TAX_DED_I         --유치원교육비공제
			 , @DeformEducTaxDedI                               AS DEFORM_EDUC_TAX_DED_I       --장애인특수교육비공제
			 , @FieldEducTaxDedI                                AS FIELD_EDUC_TAX_DED_I        --체험학습비공제
    
			 , @PolicyInded                                     AS POLICY_INDED                --(입력금액)정치자금기부금(10만원미만)
			 , @PolicyGiftI                                     AS POLICY_GIFT_I               --(입력금액)정치자금기부금(10만원초과)
			 , @LegalGiftIPrev                                  AS LEGAL_GIFT_I_PREV           --(입력금액)법정기부금이월-2013
			 , @LegalGiftIPrev14                                AS LEGAL_GIFT_I_PREV_14        --(입력금액)법정기부금이월-2014
			 , @LegalGiftI                                      AS LEGAL_GIFT_I                --(입력금액)법정기부금
			 , @PrivGiftIPrev                                   AS PRIV_GIFT_I_PREV            --(입력금액)특례기부금이월액
			 , @PrivGiftI                                       AS PRIV_GIFT_I                 --(입력금액)특례기부금
			 , @PublicGiftIPrev                                 AS PUBLIC_GIFT_I_PREV          --(입력금액)공익법인신탁기부금이월액
			 , @PublicGiftI                                     AS PUBLIC_GIFT_I               --(입력금액)공익법인신탁기부금
			 , @StaffGiftI                                      AS STAFF_GIFT_I                --(입력금액)우리사주기부금
			 , @AppointGiftIPrev                                AS APPOINT_GIFT_I_PREV         --(입력금액)지정기부금이월액-2013
			 , @AppointGiftIPrev14                              AS APPOINT_GIFT_I_PREV_14      --(입력금액)지정기부금이월액-2014
			 , @AppointGiftI                                    AS APPOINT_GIFT_I              --(입력금액)지정기부금
			 , @AssGiftIPrev                                    AS ASS_GIFT_I_PREV             --(입력금액)종교단체기부금이월액-2013
			 , @AssGiftIPrev14                                  AS ASS_GIFT_I_PREV_14          --(입력금액)종교단체기부금이월액-2014
			 , @AssGiftI                                        AS ASS_GIFT_I                  --(입력금액)종교단체기부금
    
			 , @PolicyIndedDedAmt                               AS POLICY_INDED_DED_AMT        --(공제대상)정치자금기부금(10만원미만)
			 , @PolicyGiftDedAmt                                AS POLICY_GIFT_DED_AMT         --(공제대상)정치자금기부금(10만원초과)
			 , @LegalDedAmt                                     AS LEGAL_DED_AMT               --(공제대상)법정기부금
			 , @StaffDedAmt                                     AS STAFF_DED_AMT               --(공제대상)우리사주기부금
			 , @AppointAssTaxDedAmt                             AS APPOINT_ASS_TAX_DED_AMT     --(공제대상)지정기부금
    
			 , @GiftDedI                                        AS GIFT_DED_I                  --(소득공제)기부금소득공제합계
			 , @LegalGiftDedI                                   AS LEGAL_GIFT_DED_I            --(소득공제)법정기부금
			 , @PrivGiftDedI                                    AS PRIV_GIFT_DED_I             --(소득공제)특례기부금
			 , @PublicGiftDedI                                  AS PUBLIC_GIFT_DED_I           --(소득공제)공익법인신탁기부금
			 , @StaffGiftDedI                                   AS STAFF_GIFT_DED_I            --(소득공제)우리사주기부금
			 , @AppointGiftDedI                                 AS APPOINT_GIFT_DED_I          --(소득공제)지정기부금
			 , @AssGiftDedI                                     AS ASS_GIFT_DED_I              --(소득공제)종교단체기부금
    
			 , @GiftTaxDedI                                     AS GIFT_TAX_DED_I              --(세액공제)기부금세액공제합계
			 , @PolicyIndedTaxDedI                              AS POLICY_INDED_TAX_DED_I      --(세액공제)정치자금기부금(10만원미만)
			 , @PolicyGiftTaxDedI                               AS POLICY_GIFT_TAX_DED_I       --(세액공제)정치자금기부금(10만원초과)
			 , @LegalGiftTaxDedI                                AS LEGAL_GIFT_TAX_DED_I        --(세액공제)법정기부금
			 , @StaffGiftTaxDedI                                AS STAFF_GIFT_TAX_DED_I        --(세액공제)우리사주기부금
			 , @AppointGiftTaxDedI                              AS APPOINT_GIFT_TAX_DED_I      --(세액공제)지정기부금
			 , @AssGiftTaxDedI                                  AS ASS_GIFT_TAX_DED_I          --(세액공제)종교단체기부금
    
			 , @NapTaxDedI                                      AS NAP_TAX_DED_I               --납세조합세액공제
			 , @HousInterI                                      AS HOUS_INTER_I                --주택자금상환액
			 , @OutsideIncomeI                                  AS OUTSIDE_INCOME_I            --외국납부세액
			 , @MonRentI                                        AS MON_RENT_I                  --월세액
    
			 , @DedIncomeI                                      AS DED_INCOME_I                --차감근로소득
			 , @DedIncomeI1                                     AS DED_INCOME_I1               --차감근로소득(표준세액공제계산용):특별소득공제포함
			 , @DedIncomeI2                                     AS DED_INCOME_I2               --차감근로소득(표준세액공제계산용):특별소득공제제외
			 , @OverIncomeDedLmt                                AS OVER_INCOME_DED_LMT         --특별공제 종합한도 초과액
			 , @TaxStdI                                         AS TAX_STD_I                   --소득과세표준
			 , @TaxStdI1                                        AS TAX_STD_I1                  --소득과세표준(표준세액공제계산용):특별소득공제포함
			 , @TaxStdI2                                        AS TAX_STD_I2                  --소득과세표준(표준세액공제계산용):특별소득공제제외
			 , @CompTaxI                                        AS COMP_TAX_I                  --산출세액
			 , @CompTaxI1                                       AS COMP_TAX_I1                 --산출세액(표준세액공제계산용):특별소득공제포함
			 , @CompTaxI2                                       AS COMP_TAX_I2                 --산출세액(표준세액공제계산용):특별소득공제제외
			 , @StdTaxDedI                                      AS STD_TAX_DED_I               --표준세액공제
    
			 , @Tab1DedAmt                                      AS TAB1_DED_AMT                --(세액산출요약)기본공제
			 , @Tab2DedAmt                                      AS TAB2_DED_AMT                --(세액산출요약)추가공제
			 , @Tab3DedAmt                                      AS TAB3_DED_AMT                --(세액산출요약)연금보험료공제
			 , @Tab4DedAmt                                      AS TAB4_DED_AMT                --(세액산출요약)특별소득공제-보험료
			 , @Tab5DedAmt                                      AS TAB5_DED_AMT                --(세액산출요약)특별소득공제-주택마련
			 , @Tab6DedAmt                                      AS TAB6_DED_AMT                --(세액산출요약)그밖소득공제-연금저축
			 , @Tab7DedAmt                                      AS TAB7_DED_AMT                --(세액산출요약)그밖소득공제-주택마련
			 , @Tab8DedAmt                                      AS TAB8_DED_AMT                --(세액산출요약)그밖소득공제-신용카드
			 , @Tab9DedAmt                                      AS TAB9_DED_AMT                --(세액산출요약)그밖소득공제-기타
			 , @Tab10DedAmt                                     AS TAB10_DED_AMT               --(세액산출요약)세액감면
			 , @Tab11DedAmt                                     AS TAB11_DED_AMT               --(세액산출요약)세액공제-근로소득/자녀
			 , @Tab12DedAmt                                     AS TAB12_DED_AMT               --(세액산출요약)세액공제-연금계좌
			 , @Tab13DedAmt                                     AS TAB13_DED_AMT               --(세액산출요약)특별세액공제-보험료
			 , @Tab14DedAmt                                     AS TAB14_DED_AMT               --(세액산출요약)특별세액공제-의료비
			 , @Tab15DedAmt                                     AS TAB15_DED_AMT               --(세액산출요약)특별세액공제-교육비
			 , @Tab16DedAmt                                     AS TAB16_DED_AMT               --(세액산출요약)특별세액공제-기부금
			 , @Tab17DedAmt                                     AS TAB17_DED_AMT               --(세액산출요약)세액공제-기타
    
			 , @DefInTaxI                                       AS DEF_IN_TAX_I                --결정소득세
			 , @DefLocalTaxI                                    AS DEF_LOCAL_TAX_I             --결정주민세
			 , @DefSpTaxI                                       AS DEF_SP_TAX_I                --결정농특세
			 , @DefTaxSum                                       AS DEF_TAX_SUM                 --(조회용)결정세액합계
			 , @NowInTaxI                                       AS NOW_IN_TAX_I                --주(현)소득세
			 , @NowLocalTaxI                                    AS NOW_LOCAL_TAX_I             --주(현)주민세
			 , @NowSpTaxI                                       AS NOW_SP_TAX_I                --주(현)농특세
			 , @PreInTaxI                                       AS PRE_IN_TAX_I                --종(전)소득세
			 , @PreLocalTaxI                                    AS PRE_LOCAL_TAX_I             --종(전)주민세
			 , @PreSpTaxI                                       AS PRE_SP_TAX_I                --종(전)농특세
			 , @NapInTaxI                                       AS NAP_IN_TAX_I                --(납)소득세
			 , @NapLocalTaxI                                    AS NAP_LOCAL_TAX_I             --(납)주민세
			 , @NapSpTaxI                                       AS NAP_SP_TAX_I                --(납)농특세
			 , @NowTaxSum                                       AS NOW_TAX_SUM                 --(조회용)주(현)기납부세액합계
			 , @PreTaxSum                                       AS PRE_TAX_SUM                 --(조회용)종(전)기납부세액합계
			 , @NapTaxSum                                       AS NAP_TAX_SUM                 --(조회용)(납)기납부세액합계
			 , @PaidInTaxSum                                    AS PAID_IN_TAX_SUM             --(조회용)기납부소득세합계
			 , @PaidLocalTaxSum                                 AS PAID_LOCAL_TAX_SUM          --(조회용)기납부주민세합계
			 , @PaidSpTaxSum                                    AS PAID_SP_TAX_SUM             --(조회용)기납부농특세합계
			 , @PaidTaxSum                                      AS PAID_TAX_SUM                --(조회용)기납부세액합계
			 , @InTaxI                                          AS IN_TAX_I                    --정산소득세
			 , @LocalTaxI                                       AS LOCAL_TAX_I                 --정산주민세
			 , @SpTaxI                                          AS SP_TAX_I                    --정산농특세
			 , @TaxSum                                          AS TAX_SUM                     --(조회용)정산세액합계
          FROM            HUM100T A  WITH (NOLOCK)
               LEFT  JOIN BSA100T M1 WITH (NOLOCK) ON M1.COMP_CODE  = A.COMP_CODE
                                                  AND M1.MAIN_CODE  = N'H005'
                                                  AND M1.SUB_CODE   = A.POST_CODE
         WHERE A.COMP_CODE   = @CompCode
           AND A.PERSON_NUMB = @PersonNumb
	 END

	</select>
	<update id="had617ukrServiceImpl.batchCalculateTax" parameterType="Map">
	--Had617UKr.CHad617UKr[fnHad617QCal] Query03
    /**********************************************************************************************************************
     개인연말정산 계산/저장
    **********************************************************************************************************************/
    BEGIN
        DECLARE @CompCode           NVARCHAR(08)                -- (필수) 법인코드
              , @YearYyyy           NVARCHAR(04)                -- (필수) 정산년도
              , @PersonNumb         NVARCHAR(10)                -- (필수) 사번
              , @UserId             NVARCHAR(100)                -- (필수) 사용자ID
    
        DECLARE @IncomeSuppTotalI   NUMERIC(30,6)
    
		  , @PayTotalI          NUMERIC(30,6), @BonusTotalI        NUMERIC(30,6), @AddBonusI          NUMERIC(30,6)
		  , @StockProfitI       NUMERIC(30,6), @OwnerStockDrawI    NUMERIC(30,6), @OfRetrOverI        NUMERIC(30,6)
		  , @NowPayTotI         NUMERIC(30,6), @NowBonusTotalI     NUMERIC(30,6), @NowAddBonusI       NUMERIC(30,6)
		  , @NowStockProfitI    NUMERIC(30,6), @NowOwnerStockDrawI NUMERIC(30,6), @NowOfRetrOverI     NUMERIC(30,6)
		  , @OldPayTotI         NUMERIC(30,6), @OldBonusTotalI     NUMERIC(30,6), @OldAddBonusI       NUMERIC(30,6)
		  , @OldStockProfitI    NUMERIC(30,6), @OldOwnerStockDrawI NUMERIC(30,6), @OldOfRetrOverI     NUMERIC(30,6)
		  , @NapPayTotI         NUMERIC(30,6), @NapBonusTotalI     NUMERIC(30,6)
    
		  , @IncomeDedI         NUMERIC(30,6), @EarnIncomeI        NUMERIC(30,6)
    
		  , @Spouse             NVARCHAR(01) , @SuppNum            NUMERIC(30,6)
		  , @AgedNum            NUMERIC(30,6), @DeformNum          NUMERIC(30,6), @ManyChildNum       NUMERIC(30,6)
		  , @BringChildNum      NUMERIC(30,6), @BirthAdoptNum      NUMERIC(30,6), @Woman              NVARCHAR(01)
		  , @OneParent          NVARCHAR(01)
          , @BirthAdoptNum1     NUMERIC(30,6), @BirthAdoptNum2     NUMERIC(30,6), @BirthAdoptNum3     NUMERIC(30,6)

		  , @PerDedI            NUMERIC(30,6), @SpouseDedI         NUMERIC(30,6), @SuppSubI           NUMERIC(30,6)
		  , @AgedDedI           NUMERIC(30,6), @DeformDedI         NUMERIC(30,6), @WomanDedI          NUMERIC(30,6)
		  , @OneParentDedI      NUMERIC(30,6)
    
		  , @AnuI               NUMERIC(30,6), @AnuAddI            NUMERIC(30,6), @AnuDedI            NUMERIC(30,6)
		  , @PublicPensI        NUMERIC(30,6), @SoldierPensI       NUMERIC(30,6), @SchPensI           NUMERIC(30,6)
		  , @PostPensI          NUMERIC(30,6)
		  , @MedPreMinmI        NUMERIC(30,6), @MedPreMinmAddI     NUMERIC(30,6), @HireInsurI         NUMERIC(30,6)
    
		  , @HousAmountTotI     NUMERIC(30,6), @HousAmountTotI2    NUMERIC(30,6)
		  , @HousAmountInterI2  NUMERIC(30,6), @HousAmountInterI   NUMERIC(30,6), @HousAmountInterI3  NUMERIC(30,6)
		  , @FixedRateLoan      NUMERIC(30,6), @EtcLoan            NUMERIC(30,6), @HousAmountInterI6  NUMERIC(30,6)
		  , @HousAmountInterI7  NUMERIC(30,6), @HousAmountInterI8  NUMERIC(30,6), @HousAmountInterI9  NUMERIC(30,6)
    
		  , @HousAmountI        NUMERIC(30,6), @HousAmountI2       NUMERIC(30,6), @MonRentI           NUMERIC(30,6)
		  , @MortageReturnI2    NUMERIC(30,6), @MortageReturnI     NUMERIC(30,6), @MortageReturnI3    NUMERIC(30,6)
		  , @MortageReturnI5    NUMERIC(30,6), @MortageReturnI4    NUMERIC(30,6), @MortageReturnI6    NUMERIC(30,6)
		  , @MortageReturnI7    NUMERIC(30,6), @MortageReturnI8    NUMERIC(30,6), @MortageReturnI9    NUMERIC(30,6)
    
		  , @PrivPensI          NUMERIC(30,6)
		  , @HousBuAmt          NUMERIC(30,6), @HousBuAddAmt       NUMERIC(30,6), @HousWorkAmt        NUMERIC(30,6)
		  , @HousAmountI400     NUMERIC(30,6), @HousAmountAddI     NUMERIC(30,6)
		  , @HousBuAmountI      NUMERIC(30,6), @HousBuAmountAddI   NUMERIC(30,6)
    
		  , @CardUseI           NUMERIC(30,6), @CashUseI           NUMERIC(30,6), @DebitCardUseI      NUMERIC(30,6)
		  , @TraMarketUseI      NUMERIC(30,6), @TrafficUseI        NUMERIC(30,6), @CardDedI           NUMERIC(30,6)
		  --, @CardSelfUse2014I   NUMERIC(30,6), @CardSelfUse2015I   NUMERIC(30,6)
		  --, @AddSelfUse2014I    NUMERIC(30,6), @AddSelfUse2015FI   NUMERIC(30,6)
    
		  , @CompPreminum       NVARCHAR(01)
		  , @CompPreminumI      NUMERIC(30,6), @InvestmentI        NUMERIC(30,6), @InvestmentI3       NUMERIC(30,6)
		  , @InvestmentI4       NUMERIC(30,6), @InvestmentI2       NUMERIC(30,6), @InvestmentI5       NUMERIC(30,6)
		  , @InvestmentI6       NUMERIC(30,6), @InvestmentI7       NUMERIC(30,6), @InvestmentI8       NUMERIC(30,6)
		  , @InvestmentI9       NUMERIC(30,6), @InvestmentI10      NUMERIC(30,6), @InvestmentI11      NUMERIC(30,6)
		  , @StaffStockI        NUMERIC(30,6), @EmployWorkerI      NUMERIC(30,6), @NotAmountLoanI     NUMERIC(30,6)
		  , @LongInvestStockI   NUMERIC(30,6)
     
		  , @CompPreminumDedI   NUMERIC(30,6), @InvestmentDedI     NUMERIC(30,6), @InvestmentDedI2    NUMERIC(30,6)
		  , @InvestmentDedI3    NUMERIC(30,6), @InvestmentDedI4    NUMERIC(30,6), @StaffStockDedI     NUMERIC(30,6)
		  , @EmployWorkerDedI   NUMERIC(30,6), @NotAmountLoanDedI  NUMERIC(30,6), @LongInvestStockDedI NUMERIC(30,6)
    
		  , @DedIncomeI         NUMERIC(30,6), @DedIncomeI1        NUMERIC(30,6), @DedIncomeI2        NUMERIC(30,6)
		  , @OverIncomeDedLmt   NUMERIC(30,6)
		  , @TaxStdI            NUMERIC(30,6), @TaxStdI1           NUMERIC(30,6), @TaxStdI2           NUMERIC(30,6)
		  , @CompTaxI           NUMERIC(30,6), @CompTaxI1          NUMERIC(30,6), @CompTaxI2          NUMERIC(30,6)
    
		  , @IncomeReduI        NUMERIC(30,6), @YouthDedI          NUMERIC(30,6), @YouthDedI2         NUMERIC(30,6)
		  , @YouthDedI3         NUMERIC(30,6), @YouthDedISum       NUMERIC(30,6), @SkillDedI          NUMERIC(30,6)
		  , @TaxesReduI         NUMERIC(30,6), @InTaxDedI          NUMERIC(30,6), @ChildTaxDedI       NUMERIC(30,6)
		  , @BringChildDedI     NUMERIC(30,6), @BirthAdoptI        NUMERIC(30,6)
    
		  , @SciDeducI          NUMERIC(30,6), @RetirePensI        NUMERIC(30,6), @PensI              NUMERIC(30,6)
		  , @SciTaxDedI         NUMERIC(30,6), @SciTaxDedI1        NUMERIC(30,6)
		  , @RetireTaxDedI      NUMERIC(30,6), @RetireTaxDedI1     NUMERIC(30,6)
		  , @PensTaxDedI        NUMERIC(30,6), @PensTaxDedI1       NUMERIC(30,6)
    
		  , @EtcInsurI          NUMERIC(30,6), @DeformInsurI       NUMERIC(30,6)
		  , @EtcInsurTaxDedI    NUMERIC(30,6), @DeformInsurTaxDedI NUMERIC(30,6)
    
		  , @MedDedI            NUMERIC(30,6), @MyMedDedI          NUMERIC(30,6), @SeniorMedI         NUMERIC(30,6)
		  , @DeformMedI         NUMERIC(30,6), @SurgeryMedI        NUMERIC(30,6), @MedTotalI          NUMERIC(30,6)
		  , @MedTaxDedI         NUMERIC(30,6), @MyMedTaxDedI       NUMERIC(30,6), @SeniorMedTaxDedI   NUMERIC(30,6)
		  , @DeformMedTaxDedI   NUMERIC(30,6), @SurgeryMedTaxDedI  NUMERIC(30,6), @MedTotalTaxDedI    NUMERIC(30,6)
    
		  , @EducDedI           NUMERIC(30,6), @PerEducDedI        NUMERIC(30,6), @UnivEducDedI       NUMERIC(30,6)
		  , @StudEducDedI       NUMERIC(30,6), @KindEducDedI       NUMERIC(30,6), @DeformEducDedI     NUMERIC(30,6)
		  , @FieldEducDedI      NUMERIC(30,6)
		  , @EducTaxDedI        NUMERIC(30,6), @PerEducTaxDedI     NUMERIC(30,6), @UnivEducTaxDedI    NUMERIC(30,6)
		  , @StudEducTaxDedI    NUMERIC(30,6), @KindEducTaxDedI    NUMERIC(30,6), @DeformEducTaxDedI  NUMERIC(30,6)
		  , @FieldEducTaxDedI   NUMERIC(30,6)
		  , @UnivEducNum        NUMERIC(30,6), @StudEducNum        NUMERIC(30,6), @KindEduNum         NUMERIC(30,6)
    
		  , @PolicyInded        NUMERIC(30,6), @PolicyGiftI        NUMERIC(30,6), @LegalGiftIPrev     NUMERIC(30,6)
		  , @LegalGiftIPrev14   NUMERIC(30,6), @LegalGiftI         NUMERIC(30,6), @PrivGiftIPrev      NUMERIC(30,6)
		  , @PrivGiftI          NUMERIC(30,6), @PublicGiftIPrev    NUMERIC(30,6), @PublicGiftI        NUMERIC(30,6)
		  , @StaffGiftI         NUMERIC(30,6), @AppointGiftIPrev   NUMERIC(30,6), @AppointGiftIPrev14 NUMERIC(30,6)
		  , @AppointGiftI       NUMERIC(30,6), @AssGiftIPrev       NUMERIC(30,6), @AssGiftIPrev14     NUMERIC(30,6)
		  , @AssGiftI           NUMERIC(30,6)
    
		  , @PolicyIndedDedAmt  NUMERIC(30,6), @PolicyGiftDedAmt   NUMERIC(30,6), @LegalDedAmt        NUMERIC(30,6)
		  , @StaffDedAmt        NUMERIC(30,6), @AppointAssTaxDedAmt NUMERIC(30,6)
    
		  , @GiftDedI           NUMERIC(30,6), @LegalGiftDedI      NUMERIC(30,6), @PrivGiftDedI       NUMERIC(30,6)
		  , @PublicGiftDedI     NUMERIC(30,6), @StaffGiftDedI      NUMERIC(30,6), @AppointGiftDedI    NUMERIC(30,6)
		  , @AssGiftDedI        NUMERIC(30,6)

		  , @GiftTaxDedI        NUMERIC(30,6), @PolicyIndedTaxDedI NUMERIC(30,6), @PolicyGiftTaxDedI  NUMERIC(30,6)
		  , @LegalGiftTaxDedI   NUMERIC(30,6), @StaffGiftTaxDedI   NUMERIC(30,6), @AppointGiftTaxDedI NUMERIC(30,6)
		  , @AssGiftTaxDedI     NUMERIC(30,6)
    
		  , @StdTaxDedI         NUMERIC(30,6)
		  , @NapTaxDedI         NUMERIC(30,6), @HousInterI         NUMERIC(30,6), @OutsideIncomeI     NUMERIC(30,6)
    
		  , @P3TaxDedI          NUMERIC(30,6), @ForeIncomeI        NUMERIC(30,6), @ForeTaxI           NUMERIC(30,6)
    
		  , @DefInTaxI          NUMERIC(30,6), @DefLocalTaxI       NUMERIC(30,6), @DefSpTaxI          NUMERIC(30,6)
		  , @DefTaxSum          NUMERIC(30,6)

		  , @NowInTaxI          NUMERIC(30,6), @NowLocalTaxI       NUMERIC(30,6), @NowSpTaxI          NUMERIC(30,6)
		  , @PreInTaxI          NUMERIC(30,6), @PreLocalTaxI       NUMERIC(30,6), @PreSpTaxI          NUMERIC(30,6)
		  , @NapInTaxI          NUMERIC(30,6), @NapLocalTaxI       NUMERIC(30,6), @NapSpTaxI          NUMERIC(30,6)
		  , @NowTaxSum          NUMERIC(30,6), @PreTaxSum          NUMERIC(30,6), @NapTaxSum          NUMERIC(30,6)
		  , @PaidInTaxSum       NUMERIC(30,6), @PaidLocalTaxSum    NUMERIC(30,6), @PaidSpTaxSum       NUMERIC(30,6)
		  , @PaidTaxSum         NUMERIC(30,6)

		  , @InTaxI             NUMERIC(30,6), @LocalTaxI          NUMERIC(30,6), @SpTaxI             NUMERIC(30,6)
		  , @TaxSum             NUMERIC(30,6)

	DECLARE @Tab1DedAmt         NUMERIC(30,6)      --(세액산출요약)기본공제
		  , @Tab2DedAmt         NUMERIC(30,6)      --(세액산출요약)추가공제
		  , @Tab3DedAmt         NUMERIC(30,6)      --(세액산출요약)연금보험료공제
		  , @Tab4DedAmt         NUMERIC(30,6)      --(세액산출요약)특별공제-보험료
		  , @Tab5DedAmt         NUMERIC(30,6)      --(세액산출요약)특별공제-주택자금
		  , @Tab6DedAmt         NUMERIC(30,6)      --(세액산출요약)그밖소득공제-연금저출
		  , @Tab7DedAmt         NUMERIC(30,6)      --(세액산출요약)그밖소득공제-주택마련
		  , @Tab8DedAmt         NUMERIC(30,6)      --(세액산출요약)그밖소득공제-신용카드
		  , @Tab9DedAmt         NUMERIC(30,6)      --(세액산출요약)그밖소득공제-기타
		  , @Tab10DedAmt        NUMERIC(30,6)      --(세액산출요약)세액감면
		  , @Tab11DedAmt        NUMERIC(30,6)      --(세액산출요약)세액공제-근로소득/자녀
		  , @Tab12DedAmt        NUMERIC(30,6)      --(세액산출요약)세액공제-연금계좌
		  , @Tab13DedAmt        NUMERIC(30,6)      --(세액산출요약)특별세액공제-보장성보험
		  , @Tab14DedAmt        NUMERIC(30,6)      --(세액산출요약)특별세액공제-의료비
		  , @Tab15DedAmt        NUMERIC(30,6)      --(세액산출요약)특별세액공제-교육비
		  , @Tab16DedAmt        NUMERIC(30,6)      --(세액산출요약)특별세액공제-기부금
		  , @Tab17DedAmt        NUMERIC(30,6)      --(세액산출요약)세액공제-기타

	DECLARE @ForeSingleYn       NVARCHAR(01) , @ForeDispachYn      NVARCHAR(01), @HouseholderYn       NVARCHAR(01)
		  , @ForeignNum         NVARCHAR(20) , @LiveGubun          NVARCHAR(01), @ForeignSkillYn      NVARCHAR(01)
		  , @HalfwayType        NVARCHAR(01) , @BaseDateFr         NVARCHAR(08), @BaseDateTo          NVARCHAR(08)

	DECLARE @NowIncomeI1        NUMERIC(30,6), @NowIncomeI2        NUMERIC(30,6) , @NowIncomeI3        NUMERIC(30,6)
		  , @OldIncomeI1        NUMERIC(30,6), @OldIncomeI2        NUMERIC(30,6)
		  , @P1NonTaxFr         NVARCHAR(08) , @P1NonTaxTo         NVARCHAR(08) , @P1ExempRate        NVARCHAR(01)
		  , @P2NonTaxFr         NVARCHAR(08) , @P2NonTaxTo         NVARCHAR(08) , @P2ExempRate        NVARCHAR(01)
    
        SET NOCOUNT ON
        SET ARITHABORT ON
    
    --  1. 변수 값 할당 -------------------------------------------------------------------------------------------------
        SET @CompCode    = #{S_COMP_CODE}
        SET @YearYyyy    = #{YEAR_YYYY}
        SET @PersonNumb  = #{PERSON_NUMB}
        SET @UserId      = #{S_USER_ID}
    
    --  2. 데이터 조회 --------------------------------------------------------------------------------------------------
		--(참조)연말정산입력자료-HAD400T 참조
		SELECT @IncomeSuppTotalI   = INCOME_SUPP_TOTAL_I   --총급여액
			 , @PayTotalI          = PAY_TOTAL_I
			 , @BonusTotalI        = BONUS_TOTAL_I
			 , @AddBonusI          = ADD_BONUS_I
			 , @StockProfitI       = STOCK_PROFIT_I
			 , @OwnerStockDrawI    = OWNER_STOCK_DRAW_I
			 , @OfRetrOverI        = OF_RETR_OVER_I
			 , @NowPayTotI         = NOW_PAY_TOT_I
			 , @NowBonusTotalI     = NOW_BONUS_TOTAL_I
			 , @NowAddBonusI       = NOW_ADD_BONUS_I
			 , @NowStockProfitI    = NOW_STOCK_PROFIT_I
			 , @NowOwnerStockDrawI = NOW_OWNER_STOCK_DRAW_I
			 , @NowOfRetrOverI     = NOW_OF_RETR_OVER_I
			 , @OldPayTotI         = OLD_PAY_TOT_I
			 , @OldBonusTotalI     = OLD_BONUS_TOTAL_I
			 , @OldAddBonusI       = OLD_ADD_BONUS_I
			 , @OldStockProfitI    = OLD_STOCK_PROFIT_I
			 , @OldOwnerStockDrawI = OLD_OWNER_STOCK_DRAW_I
			 , @OldOfRetrOverI     = OLD_OF_RETR_OVER_I
			 , @NapPayTotI         = NAP_PAY_TOT_I
			 , @NapBonusTotalI     = NAP_BONUS_TOTAL_I
			 , @Spouse             = SPOUSE                --기본공제/추가공제
			 , @SuppNum            = SUPP_NUM
			 , @AgedNum            = AGED_NUM
			 , @DeformNum          = DEFORM_NUM
			 , @ManyChildNum       = MANY_CHILD_NUM
			 , @BringChildNum      = BRING_CHILD_NUM
			 , @BirthAdoptNum      = BIRTH_ADOPT_NUM
			 , @Woman              = WOMAN
			 , @BirthAdoptNum1     = BIRTH_ADOPT_NUM1
			 , @BirthAdoptNum2     = BIRTH_ADOPT_NUM2
			 , @BirthAdoptNum3     = BIRTH_ADOPT_NUM3
			 , @OneParent          = ONE_PARENT
			 , @AnuI               = ANU_I                 --연금보험료공제
			 , @AnuAddI            = ANU_ADD_I
			 , @PublicPensI        = PUBLIC_PENS_I
			 , @SoldierPensI       = SOLDIER_PENS_I
			 , @SchPensI           = SCH_PENS_I
			 , @PostPensI          = POST_PENS_I
			 , @MedPreMinmI        = MED_PREMINM_I         --특별공제-보험료
			 , @MedPreMinmAddI     = MED_PREMINM_ADD_I
			 , @HireInsurI         = HIRE_INSUR_I
			 , @HousAmountTotI     = HOUS_AMOUNT_TOT_I     --특별공제-주택자금
			 , @HousAmountTotI2    = HOUS_AMOUNT_TOT_I_2
			 , @MonRentI           = MON_RENT_I
			 , @HousAmountInterI2  = HOUS_AMOUNT_INTER_I_2
			 , @HousAmountInterI   = HOUS_AMOUNT_INTER_I
			 , @HousAmountInterI3  = HOUS_AMOUNT_INTER_I_3
			 , @FixedRateLoan      = FIXED_RATE_LOAN
			 , @EtcLoan            = ETC_LOAN
			 , @HousAmountInterI6  = HOUS_AMOUNT_INTER_I_6
			 , @HousAmountInterI7  = HOUS_AMOUNT_INTER_I_7
			 , @HousAmountInterI8  = HOUS_AMOUNT_INTER_I_8
			 , @HousAmountInterI9  = HOUS_AMOUNT_INTER_I_9
			 , @PrivPensI          = PRIV_PENS_I           --그밖의소득공제-연금저축
			 , @HousBuAmt          = HOUS_BU_AMT           --그밖의소득공제-주택마련
			 , @HousBuAddAmt       = HOUS_BU_ADD_AMT
			 , @HousWorkAmt        = HOUS_WORK_AMT
			 , @HousAmountI400     = HOUS_AMOUNT_I         --HAD400T의 HOUS_AMOUNT_I(주택청약종합저축)은 @HousAmountI400 에 저장
			 , @HousAmountAddI     = HOUS_AMOUNT_ADD_I
			 , @CardUseI           = CARD_USE_I            --그밖의소득공제-신용카드
			 , @CashUseI           = CASH_USE_I
			 , @DebitCardUseI      = DEBIT_CARD_USE_I
			 , @TraMarketUseI      = TRA_MARKET_USE_I
			 , @TrafficUseI        = TRAFFIC_USE_I
			
			 , @CompPreminum       = COMP_PREMINUM         --그밖의소득공제-기타
			 , @CompPreminumI      = COMP_PREMINUM_I
			 , @InvestmentI        = INVESTMENT_I
			 , @InvestmentI3       = INVESTMENT_I3
			 , @InvestmentI4       = INVESTMENT_I4
			 , @InvestmentI2       = INVESTMENT_I2
			 , @InvestmentI5       = INVESTMENT_I5
			 , @InvestmentI6       = INVESTMENT_I6
			 , @InvestmentI7       = INVESTMENT_I7
			 , @InvestmentI8       = INVESTMENT_I8
			 , @InvestmentI9       = INVESTMENT_I9
			 , @InvestmentI10      = INVESTMENT_I10
			 , @InvestmentI11      = INVESTMENT_I11
			 , @StaffStockI        = STAFF_STOCK_I
			 , @EmployWorkerI      = EMPLOY_WORKER_I
			 , @NotAmountLoanI     = NOT_AMOUNT_LOAN_I
			 , @LongInvestStockI   = LONG_INVEST_STOCK_I
			 , @IncomeReduI        = INCOME_REDU_I         --세액감면
			 , @TaxesReduI         = TAXES_REDU_I
			 , @SciDeducI          = SCI_DEDUC_I           --세액공제-연금계좌
			 , @RetirePensI        = RETIRE_PENS_I
			 , @PensI              = PENS_I
			 , @EtcInsurI          = ETC_INSUR_I           --특별세액공제-보장성보험
			 , @DeformInsurI       = DEFORM_INSUR_I
			 , @MyMedDedI          = MY_MED_DED_I          --특별세액공제-의료비
			 , @SeniorMedI         = SENIOR_MED_I
			 , @DeformMedI         = DEFORM_MED_I
			 , @SurgeryMedI        = SURGERY_MED_I
			 , @MedTotalI          = MED_TOTAL_I
			 , @EducDedI           = EDUC_DED_I            --특별세액공제-교육비
			 , @PerEducDedI        = PER_EDUC_DED_I
			 , @UnivEducNum        = UNIV_EDUC_NUM
			 , @UnivEducDedI       = UNIV_EDUC_DED_I
			 , @StudEducNum        = STUD_EDUC_NUM
			 , @StudEducDedI       = STUD_EDUC_DED_I
			 , @KindEduNum         = KIND_EDU_NUM
			 , @KindEducDedI       = KIND_EDUC_DED_I
			 , @DeformEducDedI     = DEFORM_EDUC_DED_I
			 , @FieldEducDedI      = FIELD_EDUC_DED_I
			 , @PolicyInded        = POLICY_INDED          --특별세액공제-기부금
			 , @PolicyGiftI        = POLICY_GIFT_I
			 , @LegalGiftIPrev     = LEGAL_GIFT_I_PREV
			 , @LegalGiftIPrev14   = LEGAL_GIFT_I_PREV_14
			 , @LegalGiftI         = LEGAL_GIFT_I
			 , @PrivGiftIPrev      = PRIV_GIFT_I_PREV
			 , @PrivGiftI          = PRIV_GIFT_I
			 , @PublicGiftIPrev    = PUBLIC_GIFT_I_PREV
			 , @PublicGiftI        = PUBLIC_GIFT_I
			 , @StaffGiftI         = STAFF_GIFT_I
			 , @AppointGiftIPrev   = APPOINT_GIFT_I_PREV
			 , @AppointGiftIPrev14 = APPOINT_GIFT_I_PREV_14
			 , @AppointGiftI       = APPOINT_GIFT_I
			 , @AssGiftIPrev       = ASS_GIFT_I_PREV
			 , @AssGiftIPrev14     = ASS_GIFT_I_PREV_14
			 , @AssGiftI           = ASS_GIFT_I
			 , @P3TaxDedI          = P3_TAX_DED_I          --세액공제
			 , @HousInterI         = HOUS_INTER_I
			 , @ForeIncomeI        = FORE_INCOME_I
			 , @ForeTaxI           = FORE_TAX_I
			 , @ForeSingleYn       = FORE_SINGLE_YN        --외국인단일세율적용여부
			 , @ForeDispachYn      = FOREIGN_DISPATCH_YN   --외국법인소속 파견근로자여부
			 , @HouseholderYn      = HOUSEHOLDER_YN        --세대주여부
			 , @ForeignNum         = FOREIGN_NUM           --(참조)외국인번호
			 , @LiveGubun          = LIVE_GUBUN            --(참조)거주여부
			 , @ForeignSkillYn     = FOREIGN_SKILL_YN      --(참조)외국인기술자여부
			 , @HalfwayType        = HALFWAY_TYPE          --정산구분:중도퇴사자정산(=Y)/연말정산(=N)
			 , @BaseDateFr         = BASE_DATE_FR          --입사일
			 , @BaseDateTo         = BASE_DATE_TO          --퇴사자가아닌경우:정산년도+1231,퇴사자인경우:퇴사일
			 , @NowIncomeI1        = NOW_INCOME_I1         --(참조)중소기업취업세액감면월까지의총급여액(2013-100%)
			 , @NowIncomeI3        = NOW_INCOME_I3         --(참조)중소기업취업세액감면월까지의총급여액(2016-70%)
			 , @NowIncomeI2        = NOW_INCOME_I2         --(참조)중소기업취업세액감면월까지의총급여액(2014-50%)
			 , @OldIncomeI1        = OLD_INCOME_I1         --(참조)종전근무지1총급여액
			 , @OldIncomeI2        = OLD_INCOME_I2         --(참조)종전근무지2총급여액
			 , @P1NonTaxFr         = P1_NONTAX_FR          --(참조)종전근무지1세액감면기간(FR)
			 , @P1NonTaxTo         = P1_NONTAX_TO          --(참조)종전근무지1세액감면기간(TO)
			 , @P1ExempRate        = P1_EXEMP_RATE         --(참조)종전근무지1중소기업취업세액감면비율
			 , @P2NonTaxFr         = P2_NONTAX_FR          --(참조)종전근무지2세액감면기간(FR)
			 , @P2NonTaxTo         = P2_NONTAX_TO          --(참조)종전근무지2세액감면기간(TO)
			 , @P2ExempRate        = P2_EXEMP_RATE         --(참조)종전근무지1중소기업취업세액감면비율
		  FROM uniLITE.fn2017YearEndTax201ReferenceData(@CompCode, @YearYyyy, @PersonNumb)
	
		--(계산)근로소득공제/근로소득금액
		SELECT @IncomeDedI  = INCOME_DED_I
			 , @EarnIncomeI = EARN_INCOME_I
		  FROM uniLITE.fn2017YearEndTax205CalIncomeDed(@CompCode, @YearYyyy, @IncomeSuppTotalI)
	
		--(계산)기본공제/추가공제
		SELECT @PerDedI        = PER_DED_I
			 , @SpouseDedI     = SPOUSE_DED_I
			 , @SuppSubI       = SUPP_SUB_I
			 , @AgedDedI       = AGED_DED_I
			 , @DeformDedI     = DEFORM_DED_I
			 , @WomanDedI      = WOMAN_DED_I
			 , @OneParentDedI  = ONE_PARENT_DED_I
		  FROM uniLITE.fn2017YearEndTax210CalPersonlDed(@CompCode, @YearYyyy, @Spouse
																			, @SuppNum
																			, @AgedNum
																			, @DeformNum
																			, @Woman
																			, @OneParent
																			, @EarnIncomeI)
		--(계산)연금보험료공제/특별소득공제-보험료/그밖의소득공제-연금저축
		SELECT @AnuDedI      = ANU_DED_I
			 , @PublicPensI  = PUBLIC_PENS_DED_I       --입력금액과 정산금액 변수 동일하게 사용함
			 , @SoldierPensI = SOLDIER_PENS_DED_I      --입력금액과 정산금액 변수 동일하게 사용함
			 , @SchPensI     = SCH_PENS_DED_I          --입력금액과 정산금액 변수 동일하게 사용함
			 , @PostPensI    = POST_PENS_DED_I         --입력금액과 정산금액 변수 동일하게 사용함
			 , @MedPreMinmI  = MED_PREMINM_DED_I       --입력금액과 정산금액 변수 동일하게 사용함
			 , @HireInsurI   = HIRE_INSUR_DED_I        --입력금액과 정산금액 변수 동일하게 사용함
			 , @PrivPensI    = PRIV_PENS_DED_I         --입력금액과 정산금액 변수 동일하게 사용함
		  FROM uniLITE.fn2017YearEndTax215CalInsuranceSavings(@CompCode, @YearYyyy, @AnuI
																				  , @AnuAddI
																				  , @PublicPensI
																				  , @SoldierPensI
																				  , @SchPensI
																				  , @PostPensI
																				  , @MedPreMinmI
																				  , @MedPreMinmAddI
																				  , @HireInsurI
																				  , @PrivPensI)
		--(계산)특별소득공제-주택마련/그밖의소득공제-주택마련
		--HAD400T의 HOUS_AMOUNT_I는 주택청약종합저축         - @HousAmountI400
		--HAD600T의 HOUS_AMOUNT_I는 주택자금불입액(대출기관) - @HousAmountI
		SELECT @HousAmountI      = HOUS_AMOUNT_I
			 , @HousAmountI2     = HOUS_AMOUNT_I_2
			 , @MortageReturnI2  = MORTGAGE_RETURN_I_2
			 , @MortageReturnI   = MORTGAGE_RETURN_I
			 , @MortageReturnI3  = MORTGAGE_RETURN_I_3
			 , @MortageReturnI5  = MORTGAGE_RETURN_I_5
			 , @MortageReturnI4  = MORTGAGE_RETURN_I_4
			 , @MortageReturnI6  = MORTGAGE_RETURN_I_6
			 , @MortageReturnI7  = MORTGAGE_RETURN_I_7
			 , @MortageReturnI8  = MORTGAGE_RETURN_I_8
			 , @MortageReturnI9  = MORTGAGE_RETURN_I_9
			 , @HousBuAmt        = HOUS_BU_AMT          --입력금액과 정산금액 변수 동일하게 사용함
			 , @HousBuAddAmt     = HOUS_BU_ADD_AMT      --입력금액과 정산금액 변수 동일하게 사용함
			 , @HousWorkAmt      = HOUS_WORK_AMT        --입력금액과 정산금액 변수 동일하게 사용함
			 , @HousBuAmountI    = HOUS_BU_AMOUNT_I
			 , @HousBuAmountAddI = HOUS_BU_AMOUNT_ADD_I
		  FROM uniLITE.fn2017YearEndTax220CalHousingSavings(@CompCode, @YearYyyy, @IncomeSuppTotalI
																				, @HouseholderYn
																				, @HousAmountTotI
																				, @HousAmountTotI2
																				, @HousAmountInterI2
																				, @HousAmountInterI
																				, @HousAmountInterI3
																				, @FixedRateLoan
																				, @EtcLoan
																				, @HousAmountInterI6
																				, @HousAmountInterI7
																				, @HousAmountInterI8
																				, @HousAmountInterI9
																				, @HousBuAmt
																				, @HousBuAddAmt
																				, @HousWorkAmt
																				, @HousAmountI400
																				, @HousAmountAddI)
		--(계산)특별소득공제-기부금
		SELECT @GiftDedI           = GIFT_DED_I
			 , @LegalGiftDedI      = LEGAL_GIFT_DED_I
			 , @PrivGiftDedI       = PRIV_GIFT_DED_I
			 , @PublicGiftDedI     = PUBLIC_GIFT_DED_I
			 , @StaffGiftDedI      = STAFF_GIFT_DED_I
			 , @AppointGiftDedI    = APPOINT_GIFT_DED_I
			 , @AssGiftDedI        = ASS_GIFT_DED_I
		  FROM uniLITE.fn2017YearEndTax275CalContribution(@CompCode, @YearYyyy, @PersonNumb
		  																	  , @EarnIncomeI
																			  , @PolicyInded
																			  , @PolicyGiftI
																			  )
		--(계산)신용카드등
		SELECT @CardDedI = CARD_DED_I
		  FROM uniLITE.fn2017YearEndTax225CalCreditEtc(@CompCode, @YearYyyy, @IncomeSuppTotalI
		                                                                   , @EarnIncomeI
																		   , @CardUseI
																		   , @CashUseI
																		   , @DebitCardUseI
																		   , @TraMarketUseI
																		   , @TrafficUseI)
	  																     --, @CardSelfUse2014I, @CardSelfUse2015I, @AddSelfUse2014I, @AddSelfUse2015FI
		--(계산)그밖의소득공제-기타
		SELECT @CompPreminumDedI    = COMP_PREMINUM_DED_I
			 , @InvestmentDedI      = INVESTMENT_DED_I
			 , @InvestmentDedI2     = INVESTMENT_DED_I2
			 , @InvestmentDedI3     = INVESTMENT_DED_I3
			 , @InvestmentDedI4     = INVESTMENT_DED_I4
			 , @StaffStockDedI      = STAFF_STOCK_DED_I
			 , @EmployWorkerDedI    = EMPLOY_WORKER_DED_I
			 , @NotAmountLoanDedI   = NOT_AMOUNT_LOAN_DED_I
			 , @LongInvestStockDedI = LONG_INVEST_STOCK_DED_I
		  FROM uniLITE.fn2017YearEndTax230CalEtcIncomeDeduction(@CompCode, @YearYyyy, @IncomeSuppTotalI
																					, @EarnIncomeI
																					, @CompPreminum
																					, @CompPreminumI
																					, @InvestmentI
																					, @InvestmentI3
																					, @InvestmentI4
																					, @InvestmentI2
																					, @InvestmentI5
																					, @InvestmentI6
																					, @InvestmentI7
																					, @InvestmentI8
																					, @InvestmentI9
																					, @InvestmentI10
																					, @InvestmentI11
																					, @StaffStockI
																					, @EmployWorkerI
																					, @NotAmountLoanI
																					, @LongInvestStockI)
		--(계산)차감근로소득/특별공제한도초과액/과세표준
		SELECT @PerDedI             = PER_DED_I                   -- 1[기본공제]본인공제
			 , @SpouseDedI          = SPOUSE_DED_I                -- 2[기본공제]배우자공제
			 , @SuppSubI            = SUPP_SUB_I                  -- 3[기본공제]부양자공제
			 , @AgedDedI            = AGED_DED_I                  -- 4[추가공제]경로자공제
			 , @DeformDedI          = DEFORM_DED_I                -- 5[추가공제]장애인공제
			 , @WomanDedI           = WOMAN_DED_I                 -- 6[추가공제]부녀자공제
			 , @OneParentDedI       = ONE_PARENT_DED_I            -- 7[추가공제]한부모공제
			 , @AnuDedI             = ANU_DED_I                   -- 8[연금보험료공제]국민연금
			 , @PublicPensI         = PUBLIC_PENS_I               -- 9[연금보험료공제]공무원연금
			 , @SoldierPensI        = SOLDIER_PENS_I              --10[연금보험료공제]군인연금
			 , @SchPensI            = SCH_PENS_I                  --11[연금보험료공제]사립학교교직원연금
			 , @PostPensI           = POST_PENS_I                 --12[연금보험료공제]별정우체국연금
			 , @MedPreMinmI         = MED_PREMINM_I               --13[특별소득공제-보험료]건강보험료
			 , @HireInsurI          = HIRE_INSUR_I                --14[특별소득공제-보험료]고용보험료
			 , @HousAmountI         = HOUS_AMOUNT_I               --15[특별소득공제-주택자금]주택자금불입액(대출기관)
			 , @HousAmountI2        = HOUS_AMOUNT_I_2             --16[특별소득공제-주택자금]주택자금불입액(거주자)
			 , @MortageReturnI2     = MORTGAGE_RETURN_I_2         --17[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년미만)
			 , @MortageReturnI      = MORTGAGE_RETURN_I           --18[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년~29년)
			 , @MortageReturnI3     = MORTGAGE_RETURN_I_3         --19[특별소득공제-주택자금]장기주택저당차입금이자상환액(30년이상)
			 , @MortageReturnI5     = MORTGAGE_RETURN_I_5         --20[특별소득공제-주택자금]장기주택저당차입금이자상환액(30년이상)
			 , @MortageReturnI4     = MORTGAGE_RETURN_I_4         --21[특별소득공제-주택자금]기타대출(500만원한도)
			 , @MortageReturnI6     = MORTGAGE_RETURN_I_6         --22[특별소득공제-주택자금]2015년15년이상(고정금리AND 비거치식)
			 , @MortageReturnI7     = MORTGAGE_RETURN_I_7         --23[특별소득공제-주택자금]2015년15년이상(고정금리OR비거치식)
			 , @MortageReturnI8     = MORTGAGE_RETURN_I_8         --24[특별소득공제-주택자금]2015년15년이상(그밖의대출)
			 , @MortageReturnI9     = MORTGAGE_RETURN_I_9         --25[특별소득공제-주택자금]2015년10년이상(고정금리OR비거치식)
			 , @GiftDedI            = GIFT_DED_I                  --26[특별소득공제-기부금]기부금
			 , @LegalGiftDedI       = LEGAL_GIFT_DED_I            --27[특별소득공제-기부금]법정기부금
			 , @PrivGiftDedI        = PRIV_GIFT_DED_I             --28[특별소득공제-기부금]특례기부금
			 , @PublicGiftDedI      = PUBLIC_GIFT_DED_I           --29[특별소득공제-기부금]공익신탁기부금
			 , @AppointGiftDedI     = APPOINT_GIFT_DED_I          --30[특별소득공제-기부금]지정기부금
			 , @AssGiftDedI         = ASS_GIFT_DED_I              --31[특별소득공제-기부금]지정기부금-종교단체기부금
			 , @PrivPensI           = PRIV_PENS_I                 --32[그밖소득공제-연금저축]개인연금저축
			 , @HousBuAmt           = HOUS_BU_AMT                 --33[그밖소득공제-주택마련]청약저축(240만원한도)
			 , @HousBuAddAmt        = HOUS_BU_ADD_AMT             --34[그밖소득공제-주택마련]청약저축(120만원한도)
			 , @HousWorkAmt         = HOUS_WORK_AMT               --35[그밖소득공제-주택마련]근로자주택마련저축
			 , @HousBuAmountI       = HOUS_BU_AMOUNT_I            --36[그밖소득공제-주택마련]주택청약종합저축(240만원한도)
			 , @HousBuAmountAddI    = HOUS_BU_AMOUNT_ADD_I        --37[그밖소득공제-주택마련]주택청약종합저축(120만원한도)
			 , @CardDedI            = CARD_DED_I                  --38[그밖소득공제-신용카드]신용카드
			 , @CompPreminumDedI    = COMP_PREMINUM_DED_I         --39[그밖소득공제-기타]소기업,소상공인공제부금소득공제
			 , @InvestmentDedI      = INVESTMENT_DED_I            --40[그밖소득공제-기타]투자조합출자공제
			 , @InvestmentDedI2     = INVESTMENT_DED_I2           --41[그밖소득공제-기타]투자조합출자공제(2013년분)
			 , @InvestmentDedI3     = INVESTMENT_DED_I3           --42[그밖소득공제-기타]투자조합출자공제(2014년분)
			 , @InvestmentDedI4     = INVESTMENT_DED_I4           --43[그밖소득공제-기타]투자조합출자공제(2015년분)
			 , @StaffStockDedI      = STAFF_STOCK_DED_I           --44[그밖소득공제-기타]우리사주조합출연금액
			 , @StaffGiftDedI       = STAFF_GIFT_DED_I            --45[그밖소득공제-기타]우리사주조합기부금
			 , @EmployWorkerDedI    = EMPLOY_WORKER_DED_I         --46[그밖소득공제-기타]고용유지중소기업근로자소득공제
			 , @NotAmountLoanDedI   = NOT_AMOUNT_LOAN_DED_I       --47[그밖소득공제-기타]목돈안드는전세이자상환액공제
			 , @LongInvestStockDedI = LONG_INVEST_STOCK_DED_I     --48[그밖소득공제-기타]장기집합투자증권저축
			 , @DedIncomeI          = DED_INCOME_I                --49 차감근로소득
			 , @DedIncomeI1         = DED_INCOME_I1               --50 차감근로소득(표준세액공제계산용):특별소득공제포함
			 , @DedIncomeI2         = DED_INCOME_I2               --51 차감근로소득(표준세액공제계산용):특별소득공제제외
			 , @OverIncomeDedLmt    = OVER_INCOME_DED_LMT         --52 특별공제종합한도초과액
			 , @TaxStdI             = TAX_STD_I                   --53 소득과세표준
			 , @TaxStdI1            = TAX_STD_I1                  --54 소득과세표준(표준세액공제계산용):특별소득공제포함
			 , @TaxStdI2            = TAX_STD_I2                  --55 소득과세표준(표준세액공제계산용):특별소득공제제외
		  FROM uniLITE.fn2017YearEndTax235CalAssessmentStandard(@CompCode, @YearYyyy, @EarnIncomeI             -- 1
																					, @PerDedI                 -- 2
																					, @SpouseDedI              -- 3
																					, @SuppSubI                -- 4
																					, @AgedDedI                -- 5
																					, @DeformDedI              -- 6
																					, @WomanDedI               -- 7
																					, @OneParentDedI           -- 8
																					, @AnuDedI                 -- 9
																					, @PublicPensI             --10
																					, @SoldierPensI            --11
																					, @SchPensI                --12
																					, @PostPensI               --13
																					, @MedPreMinmI             --14
																					, @HireInsurI              --15
																					, @HousAmountI             --16
																					, @HousAmountI2            --17
																					, @MortageReturnI2         --18
																					, @MortageReturnI          --19
																					, @MortageReturnI3         --20
																					, @MortageReturnI5         --21
																					, @MortageReturnI4         --22
																					, @MortageReturnI6         --23
																					, @MortageReturnI7         --24
																					, @MortageReturnI8         --25
																					, @MortageReturnI9         --26
																					, @GiftDedI                --27
																					, @LegalGiftDedI           --28
																					, @PrivGiftDedI            --29
																					, @PublicGiftDedI          --30
																					, @AppointGiftDedI         --31
																					, @AssGiftDedI             --32
																					, @PrivPensI               --33
																					, @HousBuAmt               --34
																					, @HousBuAddAmt            --35
																					, @HousWorkAmt             --36
																					, @HousBuAmountI           --37
																					, @HousBuAmountAddI        --38
																					, @CardDedI                --39
																					, @CompPreminumDedI        --40
																					, @InvestmentDedI          --41
																					, @InvestmentDedI2         --42
																					, @InvestmentDedI3         --43
																					, @InvestmentDedI4         --44
																					, @StaffStockDedI          --45
																					, @StaffGiftDedI           --46
																					, @EmployWorkerDedI        --47
																					, @NotAmountLoanDedI       --48
																					, @LongInvestStockDedI)    --49
		--(계산)산출세액
		SELECT @CompTaxI  = COMP_TAX_I
			 , @CompTaxI1 = COMP_TAX_I1
			 , @CompTaxI2 = COMP_TAX_I2
		  FROM uniLITE.fn2017YearEndTax240CalCalculatedTaxAmount(@CompCode, @YearYyyy, @ForeignNum
																					 , @ForeSingleYn
																					 , @TaxStdI
																					 , @TaxStdI1
																					 , @TaxStdI2)
	
		--(계산)세액감면
		SELECT @IncomeReduI  = INCOME_REDU_I            --입력금액과 정산금액 변수 동일하게 사용함
			 , @YouthDedI    = YOUTH_DED_I
			 , @YouthDedI3   = YOUTH_DED_I3
			 , @YouthDedI2   = YOUTH_DED_I2
			 , @YouthDedISum = YOUTH_DED_I_SUM
			 , @SkillDedI    = SKILL_DED_I
			 , @TaxesReduI   = TAXES_REDU_I             --입력금액과 정산금액 변수 동일하게 사용함
		  FROM uniLITE.fn2017YearEndTax245CalTaxReduction(@CompCode, @YearYyyy, @PersonNumb
																			  , @ForeignNum
																			  , @LiveGubun
																			  , @ForeignSkillYn
																			  , @EarnIncomeI
																			  , @CompTaxI
																			  , @IncomeReduI
																			  , @TaxesReduI
																			  , @BaseDateFr
																			  , @BaseDateTo
																			  , @IncomeSuppTotalI
																			  , @NowIncomeI1
																			  , @NowIncomeI3
																			  , @NowIncomeI2
																			  , @OldIncomeI1
																			  , @OldIncomeI2
																			  , @P1NonTaxFr
																			  , @P1NonTaxTo
																			  , @P1ExempRate
																			  , @P2NonTaxFr
																			  , @P2NonTaxTo
																			  , @P2ExempRate)
		--(계산)세액공제-근로소득/자녀
		SELECT @InTaxDedI      = IN_TAX_DED_I
			 , @ChildTaxDedI   = CHILD_TAX_DED_I
			 , @BringChildDedI = BRING_CHILD_DED_I
			 , @BirthAdoptI    = BIRTH_ADOPT_I
		  FROM uniLITE.fn2017YearEndTax250CalTaxCreditIncomeChild(@CompCode, @YearYyyy, @PersonNumb
																					  , @IncomeSuppTotalI
																					  , @NowIncomeI1
																					  , @NowIncomeI3
																					  , @NowIncomeI2
																					  , @OldIncomeI1
																					  , @OldIncomeI2
																					  , @P1NonTaxFr
																					  , @P1NonTaxTo
																					  , @P1ExempRate
																					  , @P2NonTaxFr
																					  , @P2NonTaxTo
																					  , @P2ExempRate
																					  , @CompTaxI
																					  , @YouthDedI
																					  , @YouthDedI3
																					  , @YouthDedI2
																					  , @ManyChildNum
																					  , @BringChildNum
																					  , @BirthAdoptNum1
																					  , @BirthAdoptNum2
																					  , @BirthAdoptNum3)
		--(계산)특별세액공제-연금계좌
		SELECT @SciTaxDedI     = SCI_TAX_DED_I
			 , @SciTaxDedI1    = SCI_TAX_DED_I1
			 , @RetireTaxDedI  = RETIRE_TAX_DED_I
			 , @RetireTaxDedI1 = RETIRE_TAX_DED_I1
			 , @PensTaxDedI    = PENS_TAX_DED_I
			 , @PensTaxDedI1   = PENS_TAX_DED_I1
			 , @SciDeducI      = SCI_DEDUC_I
			 , @RetirePensI    = RETIRE_PENS_I
			 , @PensI          = PENS_I
		  FROM uniLITE.fn2017YearEndTax255CalAnnuitySavings(@CompCode, @YearYyyy, @IncomeSuppTotalI
																				, @SciDeducI
																				, @RetirePensI
																				, @PensI)
		--(계산)특별세액공제-보장성보험
		SELECT @EtcInsurTaxDedI    = ETC_INSUR_TAX_DED_I
			 , @DeformInsurTaxDedI = DEFORM_INSUR_TAX_DED_I
			 , @EtcInsurI          = ETC_INSUR_I
			 , @DeformInsurI       = DEFORM_INSUR_I
		  FROM uniLITE.fn2017YearEndTax260CalEtcInsurance(@CompCode, @YearYyyy, @EtcInsurI
																			  , @DeformInsurI)
		--(계산)특별세액공제-의료비
		SELECT @MedDedI           = MED_DED_I
			 , @MedTaxDedI        = MED_TAX_DED_I
			 , @MyMedTaxDedI      = MY_MED_TAX_DED_I
			 , @SeniorMedTaxDedI  = SENIOR_MED_TAX_DED_I
			 , @DeformMedTaxDedI  = DEFORM_MED_TAX_DED_I
			 , @SurgeryMedTaxDedI = SURGERY_MED_TAX_DED_I
			 , @MedTotalTaxDedI   = MED_TOTAL_TAX_DED_I
		  FROM uniLITE.fn2017YearEndTax265CalMedicalExpenses(@CompCode, @YearYyyy, @IncomeSuppTotalI
																				 , @MyMedDedI
																				 , @SeniorMedI
																				 , @DeformMedI
																				 , @SurgeryMedI
																				 , @MedTotalI)
		--(계산)특별세액공제-교육비
		SELECT @EducTaxDedI       = EDUC_TAX_DED_I
			 , @PerEducTaxDedI    = PER_EDUC_TAX_DED_I
			 , @UnivEducTaxDedI   = UNIV_EDUC_TAX_DED_I
			 , @StudEducTaxDedI   = STUD_EDUC_TAX_DED_I
			 , @KindEducTaxDedI   = KIND_EDUC_TAX_DED_I
			 , @DeformEducTaxDedI = DEFORM_EDUC_TAX_DED_I
			 , @FieldEducTaxDedI  = FIELD_EDUC_TAX_DED_I
		  FROM uniLITE.fn2017YearEndTax270CalEducationExpenses(@CompCode, @YearYyyy, @PersonNumb)
	
	
		--(계산)특별세액공제-기부금
		SELECT @GiftTaxDedI         = GIFT_TAX_DED_I
			 , @PolicyIndedTaxDedI  = POLICY_INDED_TAX_DED_I
			 , @PolicyGiftTaxDedI   = POLICY_GIFT_TAX_DED_I
			 , @LegalGiftTaxDedI    = LEGAL_GIFT_TAX_DED_I
			 , @StaffGiftTaxDedI    = STAFF_GIFT_TAX_DED_I
			 , @AppointGiftTaxDedI  = APPOINT_GIFT_TAX_DED_I
			 , @AssGiftTaxDedI      = ASS_GIFT_TAX_DED_I
			 , @PolicyIndedDedAmt   = POLICY_INDED_DED_AMT
			 , @PolicyGiftDedAmt    = POLICY_GIFT_DED_AMT
			 , @LegalDedAmt         = LEGAL_DED_AMT
			 , @StaffDedAmt         = STAFF_DED_AMT
			 , @AppointAssTaxDedAmt = APPOINT_ASS_TAX_DED_AMT
		  FROM uniLITE.fn2017YearEndTax275CalContribution(@CompCode, @YearYyyy, @PersonNumb
		  																	  , @EarnIncomeI
																			  , @PolicyInded
																			  , @PolicyGiftI )
		--(계산)세액공제
		SELECT @NapTaxDedI     = NAP_TAX_DED_I
			 , @HousInterI     = HOUS_INTER_I         --입력금액과 정산금액 변수 동일하게 사용함
			 , @OutsideIncomeI = OUTSIDE_INCOME_I
			 , @MonRentI       = MON_RENT_I           --입력금액과 정산금액 변수 동일하게 사용함
		  FROM uniLITE.fn2017YearEndTax280CalTaxDeduction (@CompCode, @YearYyyy, @IncomeSuppTotalI
																			   , @EarnIncomeI
																			   , @CompTaxI
																			   , @P3TaxDedI
																			   , @HousInterI
																			   , @ForeIncomeI
																			   , @ForeTaxI
																			   , @MonRentI)
	
		--(계산)표준세액공제/결정세액
		SELECT @MedPreMinmI        = MED_PREMINM_I
			 , @HireInsurI         = HIRE_INSUR_I
			 , @HousAmountI        = HOUS_AMOUNT_I
			 , @HousAmountI2       = HOUS_AMOUNT_I_2
			 , @MortageReturnI2    = MORTGAGE_RETURN_I_2
			 , @MortageReturnI     = MORTGAGE_RETURN_I
			 , @MortageReturnI3    = MORTGAGE_RETURN_I_3
			 , @MortageReturnI5    = MORTGAGE_RETURN_I_5
			 , @MortageReturnI4    = MORTGAGE_RETURN_I_4
			 , @MortageReturnI6    = MORTGAGE_RETURN_I_6
			 , @MortageReturnI7    = MORTGAGE_RETURN_I_7
			 , @MortageReturnI8    = MORTGAGE_RETURN_I_8
			 , @MortageReturnI9    = MORTGAGE_RETURN_I_9
			 , @GiftDedI           = GIFT_DED_I
			 , @DedIncomeI         = DED_INCOME_I
			 , @DedIncomeI1        = DED_INCOME_I1
			 , @DedIncomeI2        = DED_INCOME_I2
			 , @TaxStdI            = TAX_STD_I
			 , @TaxStdI1           = TAX_STD_I1
			 , @TaxStdI2           = TAX_STD_I2
			 , @CompTaxI           = COMP_TAX_I
			 , @CompTaxI1          = COMP_TAX_I1
			 , @CompTaxI2          = COMP_TAX_I2
			 , @IncomeReduI        = INCOME_REDU_I
			 , @YouthDedI          = YOUTH_DED_I
			 , @YouthDedI3         = YOUTH_DED_I3
			 , @YouthDedI2         = YOUTH_DED_I2
			 , @YouthDedISum       = YOUTH_DED_I_SUM
			 , @SkillDedI          = SKILL_DED_I
			 , @TaxesReduI         = TAXES_REDU_I
			 , @InTaxDedI          = IN_TAX_DED_I
			 , @ChildTaxDedI       = CHILD_TAX_DED_I
			 , @BringChildDedI     = BRING_CHILD_DED_I
			 , @BirthAdoptI        = BIRTH_ADOPT_I
			 , @SciTaxDedI         = SCI_TAX_DED_I
			 , @SciTaxDedI1        = SCI_TAX_DED_I1
			 , @RetireTaxDedI      = RETIRE_TAX_DED_I
			 , @RetireTaxDedI1     = RETIRE_TAX_DED_I1
			 , @PensTaxDedI        = PENS_TAX_DED_I
			 , @PensTaxDedI1       = PENS_TAX_DED_I1
			 , @EtcInsurTaxDedI    = ETC_INSUR_TAX_DED_I
			 , @DeformInsurTaxDedI = DEFORM_INSUR_TAX_DED_I
			 , @MedTaxDedI         = MED_TAX_DED_I
			 , @EducTaxDedI        = EDUC_TAX_DED_I
			 , @GiftTaxDedI        = GIFT_TAX_DED_I
			 , @PolicyIndedTaxDedI = POLICY_INDED_TAX_DED_I
			 , @PolicyGiftTaxDedI  = POLICY_GIFT_TAX_DED_I
			 , @LegalGiftTaxDedI   = LEGAL_GIFT_TAX_DED_I
			 , @StaffGiftTaxDedI   = STAFF_GIFT_TAX_DED_I
			 , @AppointGiftTaxDedI = APPOINT_GIFT_TAX_DED_I
			 , @AssGiftTaxDedI     = ASS_GIFT_TAX_DED_I
			 , @StdTaxDedI         = STD_TAX_DED_I
			 , @NapTaxDedI         = NAP_TAX_DED_I
			 , @HousInterI         = HOUS_INTER_I
			 , @OutsideIncomeI     = OUTSIDE_INCOME_I
			 , @MonRentI           = MON_RENT_I
			 , @DefInTaxI          = DEF_IN_TAX_I                  --결정소득세
			 , @DefLocalTaxI       = DEF_LOCAL_TAX_I               --결정주민세
			 , @DefSpTaxI          = DEF_SP_TAX_I                  --결정농특세
			 , @DefTaxSum          = DEF_TAX_SUM                   --결정세액합계
		  FROM uniLITE.fn2017YearEndTax285CalFinalizedTaxAmount(@CompCode, @YearYyyy, @IncomeSuppTotalI
																					, @InvestmentDedI
																					, @LongInvestStockDedI
																					, @MedPreMinmI
																					, @HireInsurI
																					, @HousAmountI
																					, @HousAmountI2
																					, @MortageReturnI2
																					, @MortageReturnI
																					, @MortageReturnI3
																					, @MortageReturnI5
																					, @MortageReturnI4
																					, @MortageReturnI6
																					, @MortageReturnI7
																					, @MortageReturnI8
																					, @MortageReturnI9
																					, @GiftDedI
																					, @DedIncomeI
																					, @DedIncomeI1
																					, @DedIncomeI2
																					, @TaxStdI
																					, @TaxStdI1
																					, @TaxStdI2
																					, @CompTaxI
																					, @CompTaxI1
																					, @CompTaxI2
																					, @IncomeReduI
																					, @YouthDedI
																					, @YouthDedI3
																					, @YouthDedI2
																					, @YouthDedISum
																					, @SkillDedI
																					, @TaxesReduI
																					, @InTaxDedI
																					, @ChildTaxDedI
																					, @BringChildDedI
																					, @BirthAdoptI
																					, @SciTaxDedI
																					, @SciTaxDedI1
																					, @RetireTaxDedI
																					, @RetireTaxDedI1
																					, @PensTaxDedI
																					, @PensTaxDedI1
																					, @EtcInsurTaxDedI
																					, @DeformInsurTaxDedI
																					, @MedTaxDedI
																					, @EducTaxDedI
																					, @GiftTaxDedI
																					, @PolicyIndedTaxDedI
																					, @PolicyGiftTaxDedI
																					, @LegalGiftTaxDedI
																					, @StaffGiftTaxDedI
																					, @AppointGiftTaxDedI
																					, @AssGiftTaxDedI
																					, @StdTaxDedI
																					, @NapTaxDedI
																					, @HousInterI
																					, @OutsideIncomeI
																					, @MonRentI
																					, @ForeignNum
																					, @ForeSingleYn
																					, @PersonNumb
																					, @LiveGubun
																					, @ForeignSkillYn
																					, @EarnIncomeI
																					, @BaseDateFr
																					, @BaseDateTo
																					, @NowIncomeI1
																					, @NowIncomeI3
																					, @NowIncomeI2
																					, @OldIncomeI1
																					, @OldIncomeI2
																					, @P1NonTaxFr
																					, @P1NonTaxTo
																					, @P1ExempRate
																					, @P2NonTaxFr
																					, @P2NonTaxTo
																					, @P2ExempRate
																					, @ManyChildNum
																					, @BringChildNum
																					, @BirthAdoptNum1
																					, @BirthAdoptNum2
																					, @BirthAdoptNum3)
		 /*
		  외국인세액계산
		  Case 1) 외국인(FOREIGN_NUM != ''), 단일세율적용  (FORE_SINGLE_YN='Y')                           = 공제없음,단일세율15%
		  Case 2) 외국인(FOREIGN_NUM != ''), 단일세율미적용(FORE_SINGLE_YN='N'), 비거주자(LIVE_GUBUN='2') = 본인공제,연금보험료공제,우리사주조합소득공제
		  Case 3) 외국인(FOREIGN_NUM != ''), 단일세율미적용(FORE_SINGLE_YN='N'),   거주자(LIVE_GUBUN='1') = 내국인과 동일하게 처리
		*/
		--Case 1) 외국인(FOREIGN_NUM != ''), 단일세율적용  (FORE_SINGLE_YN='Y')                           = 공제없음,단일세율15%
		IF @ForeignNum !=  '' AND @ForeSingleYn = 'Y'
		BEGIN
			SET @IncomeDedI         = 0                    --근로소득공제
			SET @EarnIncomeI        = @IncomeSuppTotalI    --근로소득금액
	    
			SET @PerDedI            = 0                    --[기본공제]본인공제
			SET @SpouseDedI         = 0                    --[기본공제]배우자공제
			SET @SuppSubI           = 0                    --[기본공제]부양자공제
	    
			SET @AgedDedI           = 0                    --[추가공제]경로자공제
			SET @DeformDedI         = 0                    --[추가공제]장애인공제
			SET @WomanDedI          = 0                    --[추가공제]부녀자공제
			SET @OneParentDedI      = 0                    --[추가공제]한부모공제
	    
			SET @AnuDedI            = 0                    --[연금보험료공제]국민연금
			SET @PublicPensI        = 0                    --[연금보험료공제]공무원연금
			SET @SoldierPensI       = 0                    --[연금보험료공제]군인연금
			SET @SchPensI           = 0                    --[연금보험료공제]사립학교교직원연금
			SET @PostPensI          = 0                    --[연금보험료공제]별정우체국연금
	    
			SET @MedPreMinmI        = 0                    --[특별소득공제-보험료]건강보험료
			SET @HireInsurI         = 0                    --[특별소득공제-보험료]고용보험료
	    
			SET @HousAmountI        = 0                    --[특별소득공제-주택자금]주택자금불입액(대출기관)
			SET @HousAmountI2       = 0                    --[특별소득공제-주택자금]주택자금불입액(거주자)
			SET @MortageReturnI2    = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년미만)
			SET @MortageReturnI     = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년~29년)
			SET @MortageReturnI3    = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(30년이상)
			SET @MortageReturnI5    = 0                    --[특별소득공제-주택자금]고정금리비거치상환대출(1500만원한도)
			SET @MortageReturnI4    = 0                    --[특별소득공제-주택자금]기타대출(500만원한도)
			SET @MortageReturnI6    = 0                    --[특별소득공제-주택자금]2015년15년이상(고정금리and 비거치식)
			SET @MortageReturnI7    = 0                    --[특별소득공제-주택자금]2015년15년이상(고정금리OR비거치식)
			SET @MortageReturnI8    = 0                    --[특별소득공제-주택자금]2015년15년이상(그밖의대출)
			SET @MortageReturnI9    = 0                    --[특별소득공제-주택자금]2015년10년이상(고정금리OR비거치식)
	    
			SET @GiftDedI           = 0                    --[특별소득공제-기부금]
			SET @LegalGiftDedI      = 0                    --[특별소득공제-기부금]법정기부금
			SET @PrivGiftDedI       = 0                    --[특별소득공제-기부금]특례기부금
			SET @PublicGiftDedI     = 0                    --[특별소득공제-기부금]공익법인신탁기부금
			SET @AppointGiftDedI    = 0                    --[특별소득공제-기부금]지정기부금
			SET @AssGiftDedI        = 0                    --[특별소득공제-기부금]종교단체기부금
	    
			SET @PrivPensI          = 0                    --[그밖소득공제-연금저축]개인연금저축
	    
			SET @HousBuAmt          = 0                    --[그밖소득공제-주택마련]청약저축(240만원한도)
			SET @HousBuAddAmt       = 0                    --[그밖소득공제-주택마련]청약저축(120만원한도)
			SET @HousWorkAmt        = 0                    --[그밖소득공제-주택마련]근로자주택마련저축
			SET @HousBuAmountI      = 0                    --[그밖소득공제-주택마련]주택청약종합저축(240만원한도)
			SET @HousBuAmountAddI   = 0                    --[그밖소득공제-주택마련]주택청약종합저축(120만원한도)
	    
			SET @CardDedI           = 0                    --[그밖소득공제-신용카드]신용카드등
	    
			SET @CompPreminumDedI   = 0                    --[그밖소득공제-기타]소기업,소상공인공제부금소득공제
			SET @InvestmentDedI     = 0                    --[그밖소득공제-기타]투자조합출자공제
			SET @InvestmentDedI2    = 0                    --[그밖소득공제-기타]투자조합출자공제(2013년분)
			SET @InvestmentDedI3    = 0                    --[그밖소득공제-기타]투자조합출자공제(2014년분)
			SET @InvestmentDedI4    = 0                    --[그밖소득공제-기타]투자조합출자공제(2015년이후분)
			SET @StaffStockDedI     = 0                    --[그밖소득공제-기타]우리사주조합출연금액
			SET @StaffGiftDedI      = 0                    --[그밖소득공제-기타]우리사주기부금
			SET @EmployWorkerDedI   = 0                    --[그밖소득공제-기타]고용유지중소기업근로자소득공제
			SET @NotAmountLoanDedI  = 0                    --[그밖소득공제-기타]목돈안드는전세이자상환액공제
			SET @LongInvestStockDedI= 0                    --[그밖소득공제-기타]장기집합투자증권저축
	    
			SET @DedIncomeI         = @IncomeSuppTotalI    --차감근로소득
			SET @DedIncomeI1        = @IncomeSuppTotalI    --차감근로소득(표준세액공제계산용):특별소득공제포함
			SET @DedIncomeI2        = @IncomeSuppTotalI    --차감근로소득(표준세액공제계산용):특별소득공제제외
	    
			SET @OverIncomeDedLmt   = 0                    --특별공제종합한도초과액
	    
			SET @TaxStdI            = @IncomeSuppTotalI    --소득과세표준
			SET @TaxStdI1           = @IncomeSuppTotalI    --소득과세표준(표준세액공제계산용):특별소득공제포함
			SET @TaxStdI2           = @IncomeSuppTotalI    --소득과세표준(표준세액공제계산용):특별소득공제제외
	    
			--(계산)산출세액
			SELECT @CompTaxI  = COMP_TAX_I
				 , @CompTaxI1 = COMP_TAX_I1
				 , @CompTaxI2 = COMP_TAX_I2
			  FROM uniLITE.fn2017YearEndTax240CalCalculatedTaxAmount(@CompCode, @YearYyyy, @ForeignNum, @ForeSingleYn, @TaxStdI, @TaxStdI1, @TaxStdI2)
	    
			--결정세액
			SET @DefInTaxI          = @CompTaxI
	        
			SELECT @DefLocalTaxI = (CASE WHEN @DefInTaxI &gt; 0
										 THEN ROUND((@DefInTaxI * LOCAL_TAX_RATE / 100), 0, 1)      --@DefInTaxI(결정소득세) * LOCAL_TAX_RATE(10%) / 100
										 ELSE 0
									END)
			  FROM HAD200T WITH (NOLOCK)
			 WHERE COMP_CODE    = @CompCode
			   AND TAX_YEAR     = @YearYyyy
			   AND COMPANY_CODE = '2'
	       
			SET @DefSpTaxI          = 0
			SET @DefTaxSum          = ISNULL(@DefInTaxI + @DefLocalTaxI + @DefSpTaxI,0)
	    
			SET @IncomeReduI        = 0                    --[세액감면]소득세법
			SET @YouthDedI          = 0                    --[세액감면]중소기업청년소득세감면금액(100%)
			SET @YouthDedI3         = 0                    --[세액감면]중소기업청년소득세감면금액(70%)
			SET @YouthDedI2         = 0                    --[세액감면]중소기업청년소득세감면금액(50%)
			SET @SkillDedI          = 0                    --[세액감면]외국인기술공제
			SET @TaxesReduI         = 0                    --[세액감면]조감법
	    
			SET @InTaxDedI          = 0                    --[세액공제-근로소득/자녀]근로소득
			SET @ChildTaxDedI       = 0                    --[세액공제-근로소득/자녀]자녀
			SET @BringChildDedI     = 0                    --[세액공제-근로소득/자녀]자녀양육
			SET @BirthAdoptI        = 0                    --[세액공제-근로소득/자녀]출산입양
	    
			SET @SciTaxDedI         = 0                    --[특별세액공제-연금계좌]과학기술인    (급여5,500만원이상 12% 적용)
			SET @SciTaxDedI1        = 0                    --[특별세액공제-연금계좌]과학기술인    (급여5,500만원이하 15% 적용)
			SET @RetireTaxDedI      = 0                    --[특별세액공제-연금계좌]퇴직연금불입액(급여5,500만원이상 12% 적용)
			SET @RetireTaxDedI1     = 0                    --[특별세액공제-연금계좌]퇴직연금불입액(급여5,500만원이하 15% 적용)
			SET @PensTaxDedI        = 0                    --[특별세액공제-연금계좌]연금저축      (급여5,500만원이상 12% 적용)
			SET @PensTaxDedI1       = 0                    --[특별세액공제-연금계좌]연금저축      (급여5,500만원이하 15% 적용)
	    
			SET @EtcInsurTaxDedI    = 0                    --[특별세액공제-보장성보험]기타보험료
			SET @DeformInsurTaxDedI = 0                    --[특별세액공제-보장성보험]장애인전용보장보험료
	    
			SET @MedTaxDedI         = 0                    --[특별세액공제-의료비]의료비
			SET @MyMedTaxDedI       = 0                    --[특별세액공제-의료비]본인의료비
			SET @SeniorMedTaxDedI   = 0                    --[특별세액공제-의료비]경료의료비
			SET @DeformMedTaxDedI   = 0                    --[특별세액공제-의료비]장애의료비
			SET @MedTotalTaxDedI    = 0                    --[특별세액공제-의료비]그밖의공제대상자의료비
	    
			SET @EducTaxDedI        = 0                    --[특별세액공제-교육비]교육비
			SET @PerEducTaxDedI     = 0                    --[특별세액공제-교육비]본인교육비
			SET @UnivEducTaxDedI    = 0                    --[특별세액공제-교육비]대학교교육비
			SET @StudEducTaxDedI    = 0                    --[특별세액공제-교육비]초중고교육비
			SET @KindEducTaxDedI    = 0                    --[특별세액공제-교육비]유치원교육비
			SET @DeformEducTaxDedI  = 0                    --[특별세액공제-교육비]장애인특수교육비
			SET @FieldEducTaxDedI   = 0                    --[특별세액공제-교육비]체험학습비
	    
			SET @PolicyIndedDedAmt  = 0                    --[특별세액공제-기부금](공제대상)정치자금기부금(10만원미만)
			SET @PolicyGiftDedAmt   = 0                    --[특별세액공제-기부금](공제대상)정치자금기부금(10만원초과)
			SET @LegalDedAmt        = 0                    --[특별세액공제-기부금](공제대상)법정기부금
			SET @StaffDedAmt        = 0                    --[특별세액공제-기부금](공제대상)우리사주기부금
			SET @AppointAssTaxDedAmt= 0                    --[특별세액공제-기부금](공제대상)지정기부금
	    
			SET @GiftTaxDedI        = 0                    --[특별세액공제-기부금]기부금
			SET @PolicyIndedTaxDedI = 0                    --[특별세액공제-기부금]정치자금기부금(10만원미만)
			SET @PolicyGiftTaxDedI  = 0                    --[특별세액공제-기부금]정치자금기부금(10만원초과)
			SET @LegalGiftTaxDedI   = 0                    --[특별세액공제-기부금]법정기부금
			SET @StaffGiftTaxDedI   = 0                    --[특별세액공제-기부금]우리사주기부금
			SET @AppointGiftTaxDedI = 0                    --[특별세액공제-기부금]지정기부금
			SET @AssGiftTaxDedI     = 0                    --[특별세액공제-기부금]종교단체기부금
	    
			SET @StdTaxDedI         = 0                    --[표준세액공제]
	    
			SET @NapTaxDedI         = 0                    --[세액공제]납세조합세액
			SET @HousInterI         = 0                    --[세액공제]주택자금상환액
			SET @OutsideIncomeI     = 0                    --[세액공제]외국납부세액
			SET @MonRentI           = 0                    --[세액공제]월세액
		END
	
		--Case 2) 외국인(FOREIGN_NUM != ''), 단일세율미적용(FORE_SINGLE_YN='N'), 비거주자(LIVE_GUBUN='2') - 본인공제,연금보험료공제,우리사주조합소득공제
		IF @ForeignNum !=  '' AND @ForeSingleYn = 'N' AND @LiveGubun = '2'
		BEGIN
			SET @IncomeDedI         = @IncomeDedI          --근로소득공제
			SET @EarnIncomeI        = @EarnIncomeI         --근로소득금액
	    
			SET @PerDedI            = @PerDedI             --[기본공제]본인공제
			SET @SpouseDedI         = 0                    --[기본공제]배우자공제
			SET @SuppSubI           = 0                    --[기본공제]부양자공제
	    
			SET @AgedDedI           = 0                    --[추가공제]경로자공제
			SET @DeformDedI         = 0                    --[추가공제]장애인공제
			SET @WomanDedI          = 0                    --[추가공제]부녀자공제
			SET @OneParentDedI      = 0                    --[추가공제]한부모공제
	    
			SET @AnuDedI            = @AnuDedI             --[연금보험료공제]국민연금
			SET @PublicPensI        = @PublicPensI         --[연금보험료공제]공무원연금
			SET @SoldierPensI       = @SoldierPensI        --[연금보험료공제]군인연금
			SET @SchPensI           = @SchPensI            --[연금보험료공제]사립학교교직원연금
			SET @PostPensI          = @PostPensI           --[연금보험료공제]별정우체국연금
	    
			SET @MedPreMinmI        = 0                    --[특별소득공제-보험료]건강보험료
			SET @HireInsurI         = 0                    --[특별소득공제-보험료]고용보험료
	    
			SET @HousAmountI        = 0                    --[특별소득공제-주택자금]주택자금불입액(대출기관)
			SET @HousAmountI2       = 0                    --[특별소득공제-주택자금]주택자금불입액(거주자)
			SET @MortageReturnI2    = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년미만)
			SET @MortageReturnI     = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(15년~29년)
			SET @MortageReturnI3    = 0                    --[특별소득공제-주택자금]장기주택저당차입금이자상환액(30년이상)
			SET @MortageReturnI5    = 0                    --[특별소득공제-주택자금]고정금리비거치상환대출(1500만원한도)
			SET @MortageReturnI4    = 0                    --[특별소득공제-주택자금]기타대출(500만원한도)
			SET @MortageReturnI6    = 0                    --[특별소득공제-주택자금]2015년15년이상(고정금리AND 비거치식)
			SET @MortageReturnI7    = 0                    --[특별소득공제-주택자금]2015년15년이상(고정금리OR비거치식)
			SET @MortageReturnI8    = 0                    --[특별소득공제-주택자금]2015년15년이상(그밖의대출)
			SET @MortageReturnI9    = 0                    --[특별소득공제-주택자금]2015년10년이상(고정금리OR비거치식)
	    
			SET @GiftDedI           = 0                    --[특별소득공제-기부금]
			SET @LegalGiftDedI      = 0                    --[특별소득공제-기부금]법정기부금
			SET @PrivGiftDedI       = 0                    --[특별소득공제-기부금]특례기부금
			SET @PublicGiftDedI     = 0                    --[특별소득공제-기부금]공익법인신탁기부금
			SET @AppointGiftDedI    = 0                    --[특별소득공제-기부금]지정기부금
			SET @AssGiftDedI        = 0                    --[특별소득공제-기부금]종교단체기부금
	    
			SET @PrivPensI          = 0                    --[그밖소득공제-연금저축]개인연금저축
	    
			SET @HousBuAmt          = 0                    --[그밖소득공제-주택마련]청약저축(240만원한도)
			SET @HousBuAddAmt       = 0                    --[그밖소득공제-주택마련]청약저축(120만원한도)
			SET @HousWorkAmt        = 0                    --[그밖소득공제-주택마련]근로자주택마련저축
			SET @HousBuAmountI      = 0                    --[그밖소득공제-주택마련]주택청약종합저축(240만원한도)
			SET @HousBuAmountAddI   = 0                    --[그밖소득공제-주택마련]주택청약종합저축(120만원한도)
	    
			SET @CardDedI           = 0                    --[그밖소득공제-신용카드]신용카드등
	    
			SET @CompPreminumDedI   = 0                    --[그밖소득공제-기타]소기업,소상공인공제부금소득공제
			SET @InvestmentDedI     = 0                    --[그밖소득공제-기타]투자조합출자공제
			SET @InvestmentDedI2    = 0                    --[그밖소득공제-기타]투자조합출자공제(2013년분)
			SET @InvestmentDedI3    = 0                    --[그밖소득공제-기타]투자조합출자공제(2014년분)
			SET @InvestmentDedI4    = 0                    --[그밖소득공제-기타]투자조합출자공제(2015년이후분)
			SET @StaffStockDedI     = @StaffStockDedI      --[그밖소득공제-기타]우리사주조합출연금액
			SET @StaffGiftDedI      = 0                    --[그밖소득공제-기타]우리사주기부금
			SET @EmployWorkerDedI   = 0                    --[그밖소득공제-기타]고용유지중소기업근로자소득공제
			SET @NotAmountLoanDedI  = 0                    --[그밖소득공제-기타]목돈안드는전세이자상환액공제
			SET @LongInvestStockDedI= 0                    --[그밖소득공제-기타]장기집합투자증권저축
	    
			SET @DedIncomeI         = @EarnIncomeI
									- @PerDedI
									- @AnuDedI
									- @PublicPensI
									- @SoldierPensI
									- @SchPensI
									- @PostPensI           --차감근로소득
			SET @DedIncomeI1        = @DedIncomeI          --차감근로소득(표준세액공제계산용):특별소득공제포함
			SET @DedIncomeI2        = @DedIncomeI          --차감근로소득(표준세액공제계산용):특별소득공제제외
	    
			SET @TaxStdI            = @DedIncomeI
									- @StaffStockDedI      --소득과세표준
	    
			SET @TaxStdI1           = @TaxStdI             --소득과세표준(표준세액공제계산용):특별소득공제포함
			SET @TaxStdI2           = @TaxStdI             --소득과세표준(표준세액공제계산용):특별소득공제제외
	    
			--(계산)산출세액
			SELECT @CompTaxI  = COMP_TAX_I
				 , @CompTaxI1 = COMP_TAX_I1
				 , @CompTaxI2 = COMP_TAX_I2
			  FROM uniLITE.fn2017YearEndTax240CalCalculatedTaxAmount(@CompCode, @YearYyyy, @ForeignNum, @ForeSingleYn, @TaxStdI, @TaxStdI1, @TaxStdI2)
	    
			--결정세액
			SET @DefInTaxI          = @CompTaxI
	        
			SELECT @DefLocalTaxI = (CASE WHEN @DefInTaxI &gt; 0
										 THEN ROUND((@DefInTaxI * LOCAL_TAX_RATE / 100), 0, 1)      --@DefInTaxI(결정소득세) * LOCAL_TAX_RATE(10%) / 100
										 ELSE 0
									END)
			  FROM HAD200T WITH (NOLOCK)
			 WHERE COMP_CODE    = @CompCode
			   AND TAX_YEAR     = @YearYyyy
			   AND COMPANY_CODE = '2'
	       
			SET @DefSpTaxI          = 0
			SET @DefTaxSum          = ISNULL(@DefInTaxI + @DefLocalTaxI + @DefSpTaxI,0)
	    
			SET @IncomeReduI        = 0                    --[세액감면]소득세법
			SET @YouthDedI          = 0                    --[세액감면]중소기업청년소득세감면금액(100%)
			SET @YouthDedI3         = 0                    --[세액감면]중소기업청년소득세감면금액(70%)
			SET @YouthDedI2         = 0                    --[세액감면]중소기업청년소득세감면금액(50%)
			SET @SkillDedI          = 0                    --[세액감면]외국인기술공제
			SET @TaxesReduI         = 0                    --[세액감면]조감법
	    
			SET @InTaxDedI          = 0                    --[세액공제-근로소득/자녀]근로소득
			SET @ChildTaxDedI       = 0                    --[세액공제-근로소득/자녀]자녀
			SET @BringChildDedI     = 0                    --[세액공제-근로소득/자녀]자녀양육
			SET @BirthAdoptI        = 0                    --[세액공제-근로소득/자녀]출산입양
	    
			SET @SciTaxDedI         = @SciTaxDedI          --[특별세액공제-연금계좌]과학기술인    (급여5,500만원이상 12% 적용)
			SET @SciTaxDedI1        = @SciTaxDedI1         --[특별세액공제-연금계좌]과학기술인    (급여5,500만원이하 15% 적용)
			SET @RetireTaxDedI      = @RetireTaxDedI       --[특별세액공제-연금계좌]퇴직연금불입액(급여5,500만원이상 12% 적용)
			SET @RetireTaxDedI1     = @RetireTaxDedI1      --[특별세액공제-연금계좌]퇴직연금불입액(급여5,500만원이하 15% 적용)
			SET @PensTaxDedI        = @PensTaxDedI         --[특별세액공제-연금계좌]연금저축      (급여5,500만원이상 12% 적용)
			SET @PensTaxDedI1       = @PensTaxDedI1        --[특별세액공제-연금계좌]연금저축      (급여5,500만원이하 15% 적용)
	    
			SET @EtcInsurTaxDedI    = 0                    --[특별세액공제-보장성보험]기타보험료
			SET @DeformInsurTaxDedI = 0                    --[특별세액공제-보장성보험]장애인전용보장보험료
	    
			SET @MedTaxDedI         = 0                    --[특별세액공제-의료비]의료비
			SET @MyMedTaxDedI       = 0                    --[특별세액공제-의료비]본인의료비
			SET @SeniorMedTaxDedI   = 0                    --[특별세액공제-의료비]경료의료비
			SET @DeformMedTaxDedI   = 0                    --[특별세액공제-의료비]장애의료비
			SET @MedTotalTaxDedI    = 0                    --[특별세액공제-의료비]그밖의공제대상자의료비
	    
			SET @EducTaxDedI        = 0                    --[특별세액공제-교육비]교육비
			SET @PerEducTaxDedI     = 0                    --[특별세액공제-교육비]본인교육비
			SET @UnivEducTaxDedI    = 0                    --[특별세액공제-교육비]대학교교육비
			SET @StudEducTaxDedI    = 0                    --[특별세액공제-교육비]초중고교육비
			SET @KindEducTaxDedI    = 0                    --[특별세액공제-교육비]유치원교육비
			SET @DeformEducTaxDedI  = 0                    --[특별세액공제-교육비]장애인특수교육비
			SET @FieldEducTaxDedI   = 0                    --[특별세액공제-교육비]체험학습비
	    
			SET @PolicyIndedDedAmt  = 0                    --[특별세액공제-기부금](공제대상)정치자금기부금(10만원미만)
			SET @PolicyGiftDedAmt   = 0                    --[특별세액공제-기부금](공제대상)정치자금기부금(10만원초과)
			SET @LegalDedAmt        = 0                    --[특별세액공제-기부금](공제대상)법정기부금
			SET @StaffDedAmt        = 0                    --[특별세액공제-기부금](공제대상)우리사주기부금
			SET @AppointAssTaxDedAmt= 0                    --[특별세액공제-기부금](공제대상)지정기부금
	    
			SET @GiftTaxDedI        = 0                    --[특별세액공제-기부금]기부금
			SET @PolicyIndedTaxDedI = 0                    --[특별세액공제-기부금]정치자금기부금(10만원미만)
			SET @PolicyGiftTaxDedI  = 0                    --[특별세액공제-기부금]정치자금기부금(10만원초과)
			SET @LegalGiftTaxDedI   = 0                    --[특별세액공제-기부금]법정기부금
			SET @StaffGiftTaxDedI   = 0                    --[특별세액공제-기부금]우리사주기부금
			SET @AppointGiftTaxDedI = 0                    --[특별세액공제-기부금]지정기부금
			SET @AssGiftTaxDedI     = 0                    --[특별세액공제-기부금]종교단체기부금
	    
			SET @StdTaxDedI         = 0                    --[표준세액공제]
	    
			SET @NapTaxDedI         = 0                    --[세액공제]납세조합세액
			SET @HousInterI         = 0                    --[세액공제]주택자금상환액
			SET @OutsideIncomeI     = 0                    --[세액공제]외국납부세액
			SET @MonRentI           = 0                    --[세액공제]월세액
		END
	
		--(집계)기납부세액
		SELECT @NowInTaxI       = NOW_IN_TAX_I
			 , @NowLocalTaxI    = NOW_LOCAL_TAX_I
			 , @NowSpTaxI       = NOW_SP_TAX_I
			 , @PreInTaxI       = PRE_IN_TAX_I
			 , @PreLocalTaxI    = PRE_LOCAL_TAX_I
			 , @PreSpTaxI       = PRE_SP_TAX_I
			 , @NapInTaxI       = NAP_IN_TAX_I
			 , @NapLocalTaxI    = NAP_LOCAL_TAX_I
			 , @NapSpTaxI       = NAP_SP_TAX_I
			 , @NowTaxSum       = NOW_TAX_SUM
			 , @PreTaxSum       = PRE_TAX_SUM
			 , @NapTaxSum       = NAP_TAX_SUM
			 , @PaidInTaxSum    = PAID_IN_TAX_SUM
			 , @PaidLocalTaxSum = PAID_LOCAL_TAX_SUM
			 , @PaidSpTaxSum    = PAID_SP_TAX_SUM
			 , @PaidTaxSum      = PAID_TAX_SUM
		  FROM uniLITE.fn2017YearEndTax290GetPaidTaxAmount(@CompCode, @YearYyyy, @PersonNumb)
	
		--(계산)차감징수세액
		SELECT @InTaxI    = IN_TAX_I
			 , @LocalTaxI = LOCAL_TAX_I
			 , @SpTaxI    = SP_TAX_I
			 , @TaxSum    = TAX_SUM
		  FROM uniLITE.fn2017YearEndTax295CalBalanceTaxAmount(@CompCode, @YearYyyy, @DefInTaxI
																				  , @DefLocalTaxI
																				  , @DefSpTaxI
																				  , @NowInTaxI
																				  , @NowLocalTaxI
																				  , @NowSpTaxI
																				  , @PreInTaxI
																				  , @PreLocalTaxI
																				  , @PreSpTaxI
																				  , @NapInTaxI
																				  , @NapLocalTaxI
																				  , @NapSpTaxI)
	
		--(계산)세액산출요약 합계
		SET @Tab1DedAmt  = @PerDedI           + @SpouseDedI      + @SuppSubI                                                   --(세액산출요약)기본공제                                                                                                                                                   --(조회용)기본공제
		SET @Tab2DedAmt  = @AgedDedI          + @DeformDedI      + @WomanDedI       + @OneParentDedI                           --(세액산출요약)추가공제
		SET @Tab3DedAmt  = @AnuDedI           + @PublicPensI     + @SoldierPensI    + @SchPensI         + @PostPensI           --(세액산출요약)연금보험료공제
		SET @Tab4DedAmt  = @MedPreMinmI       + @HireInsurI                                                                    --(세액산출요약)특별소득공제-보험료
		SET @Tab5DedAmt  = @HousAmountI       + @HousAmountI2    + @MortageReturnI2
						 + @MortageReturnI    + @MortageReturnI3 + @MortageReturnI5 + @MortageReturnI4
						 + @MortageReturnI6   + @MortageReturnI7 + @MortageReturnI8 + @MortageReturnI9                         --(세액산출요약)특별소득공제-주택자금
		SET @Tab6DedAmt  = @PrivPensI                                                                                          --(세액산출요약)그밖소득공제-연금저축
		SET @Tab7DedAmt  = @HousBuAmt         + @HousBuAddAmt    + @HousWorkAmt     + @HousBuAmountI    + @HousBuAmountAddI    --(세액산출요약)그밖소득공제-주택마련
		SET @Tab8DedAmt  = @CardDedI                                                                                           --(세액산출요약)그밖소득공제-신용카드
		SET @Tab9DedAmt  = @CompPreminumDedI  + @InvestmentDedI  + @StaffStockDedI  + @EmployWorkerDedI
						 + @NotAmountLoanDedI + @LongInvestStockDedI                                                           --(세액산출요약)그밖소득공제-기타
		SET @Tab10DedAmt = @IncomeReduI       + @YouthDedI       + @YouthDedI3      + @YouthDedI2      + @SkillDedI        + @TaxesReduI          --(세액산출요약)세액감면
		SET @Tab11DedAmt = @InTaxDedI         + @ChildTaxDedI    + @BringChildDedI  + @BirthAdoptI                             --(세액산출요약)세액공제-근로소득/자녀
		SET @Tab12DedAmt = @SciTaxDedI        + @RetireTaxDedI   + @PensTaxDedI
						 + @SciTaxDedI1       + @RetireTaxDedI1  + @PensTaxDedI1                                               --(세액산출요약)특별세액공제-연금계좌
		SET @Tab13DedAmt = @EtcInsurTaxDedI   + @DeformInsurTaxDedI                                                            --(세액산출요약)특별세액공제-보장성보험
		SET @Tab14DedAmt = @MedTaxDedI                                                                                         --(세액산출요약)특별세액공제-의료비
		SET @Tab15DedAmt = @EducTaxDedI                                                                                        --(세액산출요약)특별세액공제-교육비
		SET @Tab16DedAmt = @GiftTaxDedI                                                                                        --(세액산출요약)특별세액공제-기부금
		SET @Tab17DedAmt = @NapTaxDedI        + @HousInterI      + @OutsideIncomeI  + @MonRentI                                --(세액산출요약)특별세액공제-기타
    
    	IF EXISTS (SELECT TOP 1 1
                     FROM HAD600T WITH (NOLOCK)
                    WHERE COMP_CODE   = @CompCode
                      AND YEAR_YYYY   = @YearYyyy
                      AND PERSON_NUMB = @PersonNumb)
        BEGIN
            DELETE HAD600T
             WHERE COMP_CODE   = @CompCode
               AND YEAR_YYYY   = @YearYyyy
               AND PERSON_NUMB = @PersonNumb
        END
    
        --정산세액계산 저장
        INSERT INTO HAD600T
			 ( COMP_CODE            , YEAR_YYYY             , PERSON_NUMB           , HALFWAY_TYPE          , FORE_SINGLE_YN            ,FOREIGN_DISPATCH_YN
			 , HOUSEHOLDER_YN       , JOIN_DATE             , RETR_DATE             , DEPT_CODE             , DEPT_NAME
			 , NOW_PAY_TOT_I        , NOW_BONUS_TOTAL_I     , NOW_ADD_BONUS_I       , NOW_STOCK_PROFIT_I    , NOW_OWNER_STOCK_DRAW_I
			 , OLD_PAY_TOT_I        , OLD_BONUS_TOTAL_I     , OLD_ADD_BONUS_I       , OLD_STOCK_PROFIT_I    , OLD_OWNER_STOCK_DRAW_I
			 , NOW_OF_RETR_OVER_I   , OLD_OF_RETR_OVER_I
			 , NAP_PAY_TOT_I        , NAP_BONUS_TOTAL_I     , PAY_TOTAL_I           , BONUS_TOTAL_I         , ADD_BONUS_I
			 , STOCK_PROFIT_I       , OWNER_STOCK_DRAW_I    , OF_RETR_OVER_I
			 , INCOME_SUPP_TOTAL_I  , INCOME_DED_I          , EARN_INCOME_I
			 , PER_DED_I            , SPOUSE_DED_I          , SPOUSE                , SUPP_NUM              , SUPP_SUB_I
			 , AGED_NUM             , DEFORM_NUM            , MANY_CHILD_NUM        , BRING_CHILD_NUM       , BIRTH_ADOPT_NUM
			 , WOMAN                , ONE_PARENT			, BIRTH_ADOPT_NUM1		, BIRTH_ADOPT_NUM2		, BIRTH_ADOPT_NUM3
			 , AGED_DED_I           , DEFORM_DED_I          , WOMAN_DED_I           , ONE_PARENT_DED_I
			 , ANU_I                , ANU_ADD_I             , ANU_DED_I             , PUBLIC_PENS_I         , SOLDIER_PENS_I
			 , SCH_PENS_I           , POST_PENS_I
			 , MED_PREMINM_I        , HIRE_INSUR_I
			 , HOUS_AMOUNT_I        , HOUS_AMOUNT_I_2       , MORTGAGE_RETURN_I_2   , MORTGAGE_RETURN_I     , MORTGAGE_RETURN_I_3
			 , MORTGAGE_RETURN_I_5  , MORTGAGE_RETURN_I_4   , MORTGAGE_RETURN_I_6   , MORTGAGE_RETURN_I_7   , MORTGAGE_RETURN_I_8
			 , MORTGAGE_RETURN_I_9
			 , PRIV_PENS_I
			 , HOUS_BU_AMT          , HOUS_BU_ADD_AMT       , HOUS_WORK_AMT         , HOUS_BU_AMOUNT_I      , HOUS_BU_AMOUNT_ADD_I
			 , CARD_DED_I           , CARD_USE_I            , CASH_USE_I            , DEBIT_CARD_USE_I      , TRA_MARKET_USE_I
			 , TRAFFIC_USE_I
			 , COMP_PREMINUM        , COMP_PREMINUM_DED_I   , INVESTMENT_DED_I      , INVESTMENT_DED_I2     , INVESTMENT_DED_I3     , INVESTMENT_DED_I4
			 , STAFF_STOCK_DED_I    , EMPLOY_WORKER_DED_I   , NOT_AMOUNT_LOAN_DED_I , LONG_INVEST_STOCK_DED_I
			 , INCOME_REDU_I        , YOUTH_DED_I           , YOUTH_DED_I3          , YOUTH_DED_I2          , YOUTH_DED_I_SUM
			 , SKILL_DED_I          , TAXES_REDU_I          , IN_TAX_DED_I          , CHILD_TAX_DED_I       , BRING_CHILD_DED_I
			 , BIRTH_ADOPT_I        , SCI_DEDUC_I           , RETIRE_PENS_I         , PENS_I
			 , SCI_TAX_DED_I        , SCI_TAX_DED_I1
			 , RETIRE_TAX_DED_I     , RETIRE_TAX_DED_I1
			 , PENS_TAX_DED_I       , PENS_TAX_DED_I1
			 , ETC_INSUR_I          , DEFORM_INSUR_I        , ETC_INSUR_TAX_DED_I   , DEFORM_INSUR_TAX_DED_I
			 , MED_DED_I            , MY_MED_DED_I          , SENIOR_MED_I          , DEFORM_MED_I          , SURGERY_MED_I
			 , MED_TOTAL_I
			 , MED_TAX_DED_I        , MY_MED_TAX_DED_I      , SENIOR_MED_TAX_DED_I  , DEFORM_MED_TAX_DED_I  , SURGERY_MED_TAX_DED_I
			 , MED_TOTAL_TAX_DED_I
			 , EDUC_DED_I           , UNIV_EDUC_NUM         , STUD_EDUC_NUM         , KIND_EDU_NUM
			 , PER_EDUC_DED_I       , UNIV_EDUC_DED_I       , STUD_EDUC_DED_I       , KIND_EDUC_DED_I       , DEFORM_EDUC_DED_I
			 , FIELD_EDUC_DED_I
			 , EDUC_TAX_DED_I
			 , PER_EDUC_TAX_DED_I   , UNIV_EDUC_TAX_DED_I   , STUD_EDUC_TAX_DED_I   , KIND_EDUC_TAX_DED_I   , DEFORM_EDUC_TAX_DED_I
			 , FIELD_EDUC_TAX_DED_I
			 , POLICY_INDED         , POLICY_GIFT_I         , LEGAL_GIFT_I_PREV     , LEGAL_GIFT_I_PREV_14  , LEGAL_GIFT_I
			 , PRIV_GIFT_I_PREV     , PRIV_GIFT_I           , PUBLIC_GIFT_I_PREV    , PUBLIC_GIFT_I         , STAFF_GIFT_I
			 , APPOINT_GIFT_I_PREV  , APPOINT_GIFT_I_PREV_14, APPOINT_GIFT_I        , ASS_GIFT_I_PREV       , ASS_GIFT_I_PREV_14
			 , ASS_GIFT_I
			 , POLICY_INDED_DED_AMT , POLICY_GIFT_DED_AMT   , LEGAL_DED_AMT         , STAFF_DED_AMT         , APPOINT_ASS_TAX_DED_AMT
			 , GIFT_DED_I           , LEGAL_GIFT_DED_I      , PRIV_GIFT_DED_I       , PUBLIC_GIFT_DED_I     , STAFF_GIFT_DED_I
			 , APPOINT_GIFT_DED_I   , ASS_GIFT_DED_I
			 , GIFT_TAX_DED_I       , POLICY_INDED_TAX_DED_I, POLICY_GIFT_TAX_DED_I , LEGAL_GIFT_TAX_DED_I  , STAFF_GIFT_TAX_DED_I
			 , APPOINT_GIFT_TAX_DED_I,ASS_GIFT_TAX_DED_I
			 , NAP_TAX_DED_I        , HOUS_INTER_I          , OUTSIDE_INCOME_I      , MON_RENT_I
			 , DED_INCOME_I         , DED_INCOME_I1         , DED_INCOME_I2
			 , OVER_INCOME_DED_LMT
			 , TAX_STD_I            , TAX_STD_I1            , TAX_STD_I2
			 , COMP_TAX_I           , COMP_TAX_I1           , COMP_TAX_I2
			 , STD_TAX_DED_I
			 , DEF_IN_TAX_I         , DEF_SP_TAX_I          , DEF_LOCAL_TAX_I       , NOW_IN_TAX_I          , NOW_LOCAL_TAX_I
			 , NOW_SP_TAX_I         , PRE_IN_TAX_I          , PRE_LOCAL_TAX_I       , PRE_SP_TAX_I          , NAP_IN_TAX_I
			 , NAP_LOCAL_TAX_I      , NAP_SP_TAX_I          , IN_TAX_I              , LOCAL_TAX_I           , SP_TAX_I
			 , INSERT_DB_USER       , INSERT_DB_TIME        , UPDATE_DB_USER        , UPDATE_DB_TIME )
		SELECT @CompCode            , @YearYyyy             , @PersonNumb           , @HalfwayType          , @ForeSingleYn         ,@ForeDispachYn
			 , @HouseholderYn
			 , (CASE WHEN ISNULL(A.ORI_JOIN_DATE,'00000000') = '00000000'
					 THEN A.JOIN_DATE
					 ELSE A.ORI_JOIN_DATE
				 END)                                           AS JOIN_DATE                   --입사일
			 , CASE WHEN A.RETR_DATE != '0000000' AND LEFT(A.RETR_DATE, 4) &lt;= @YearYyyy 
					THEN ISNULL(A.RETR_DATE,'00000000')   
					ELSE '00000000' 
				END                                             AS RETR_DATE                   --퇴사일
			 , A.DEPT_CODE                                                                     --부서코드
			 , A.DEPT_NAME                                                                     --부서명
			 , @NowPayTotI          , @NowBonusTotalI       , @NowAddBonusI         , @NowStockProfitI      , @NowOwnerStockDrawI
			 , @OldPayTotI          , @OldBonusTotalI       , @OldAddBonusI         , @OldStockProfitI      , @OldOwnerStockDrawI
			 , @NowOfRetrOverI      , @OldOfRetrOverI
			 , @NapPayTotI          , @NapBonusTotalI       , @PayTotalI            , @BonusTotalI          , @AddBonusI
			 , @StockProfitI        , @OwnerStockDrawI      , @OfRetrOverI
			 , @IncomeSuppTotalI    , @IncomeDedI           , @EarnIncomeI
			 , @PerDedI             , @SpouseDedI           , @Spouse               , @SuppNum              , @SuppSubI
			 , @AgedNum             , @DeformNum            , @ManyChildNum         , @BringChildNum        , @BirthAdoptNum
			 , @Woman               , @OneParent			, @BirthAdoptNum1       , @BirthAdoptNum2	    , @BirthAdoptNum3
			 , @AgedDedI            , @DeformDedI           , @WomanDedI            , @OneParentDedI
			 , @AnuI                , @AnuAddI              , @AnuDedI              , @PublicPensI          , @SoldierPensI
			 , @SchPensI            , @PostPensI
			 , @MedPreMinmI         , @HireInsurI
			 , @HousAmountI         , @HousAmountI2         , @MortageReturnI2      , @MortageReturnI       , @MortageReturnI3
			 , @MortageReturnI5     , @MortageReturnI4      , @MortageReturnI6      , @MortageReturnI7      , @MortageReturnI8 
			 , @MortageReturnI9
			 , @PrivPensI
			 , @HousBuAmt           , @HousBuAddAmt         , @HousWorkAmt          , @HousBuAmountI        , @HousBuAmountAddI
			 , @CardDedI            , @CardUseI             , @CashUseI             , @DebitCardUseI        , @TraMarketUseI
			 , @TrafficUseI
			 , @CompPreminum        , @CompPreminumDedI     , @InvestmentDedI       , @InvestmentDedI2      , @InvestmentDedI3      , @InvestmentDedI4
			 , @StaffStockDedI      , @EmployWorkerDedI     , @NotAmountLoanDedI    , @LongInvestStockDedI
			 , @IncomeReduI         , @YouthDedI            , @YouthDedI3           , @YouthDedI2           , @YouthDedISum
			 , @SkillDedI           , @TaxesReduI           , @InTaxDedI            , @ChildTaxDedI         , @BringChildDedI
			 , @BirthAdoptI         , @SciDeducI            , @RetirePensI          , @PensI
			 , @SciTaxDedI          , @SciTaxDedI1
			 , @RetireTaxDedI       , @RetireTaxDedI1
			 , @PensTaxDedI         , @PensTaxDedI1
			 , @EtcInsurI           , @DeformInsurI         , @EtcInsurTaxDedI      , @DeformInsurTaxDedI
			 , @MedDedI             , @MyMedDedI            , @SeniorMedI           , @DeformMedI           , @SurgeryMedI
			 , @MedTotalI
			 , @MedTaxDedI          , @MyMedTaxDedI         , @SeniorMedTaxDedI     , @DeformMedTaxDedI     , @SurgeryMedTaxDedI
			 , @MedTotalTaxDedI
			 , @EducDedI            , @UnivEducNum          , @StudEducNum          , @KindEduNum
			 , @PerEducDedI         , @UnivEducDedI         , @StudEducDedI         , @KindEducDedI         , @DeformEducDedI
			 , @FieldEducDedI
			 , @EducTaxDedI
			 , @PerEducTaxDedI      , @UnivEducTaxDedI      , @StudEducTaxDedI      , @KindEducTaxDedI      , @DeformEducTaxDedI
			 , @FieldEducTaxDedI
			 , @PolicyInded         , @PolicyGiftI          , @LegalGiftIPrev       , @LegalGiftIPrev14     , @LegalGiftI
			 , @PrivGiftIPrev       , @PrivGiftI            , @PublicGiftIPrev      , @PublicGiftI          , @StaffGiftI
			 , @AppointGiftIPrev    , @AppointGiftIPrev14   , @AppointGiftI         , @AssGiftIPrev         , @AssGiftIPrev14
			 , @AssGiftI
			 , @PolicyIndedDedAmt   , @PolicyGiftDedAmt     , @LegalDedAmt          , @StaffDedAmt          , @AppointAssTaxDedAmt
			 , @GiftDedI            , @LegalGiftDedI        , @PrivGiftDedI         , @PublicGiftDedI       , @StaffGiftDedI
			 , @AppointGiftDedI     , @AssGiftDedI
			 , @GiftTaxDedI         , @PolicyIndedTaxDedI   , @PolicyGiftTaxDedI    , @LegalGiftTaxDedI     , @StaffGiftTaxDedI
			 , @AppointGiftTaxDedI  , @AssGiftTaxDedI
			 , @NapTaxDedI          , @HousInterI           , @OutsideIncomeI       , @MonRentI
			 , @DedIncomeI          , @DedIncomeI1          , @DedIncomeI2
			 , @OverIncomeDedLmt
			 , @TaxStdI             , @TaxStdI1             , @TaxStdI2
			 , @CompTaxI            , @CompTaxI1            , @CompTaxI2
			 , @StdTaxDedI
			 , @DefInTaxI           , @DefSpTaxI            , @DefLocalTaxI         , @NowInTaxI            , @NowLocalTaxI
			 , @NowSpTaxI           , @PreInTaxI            , @PreLocalTaxI         , @PreSpTaxI            , @NapInTaxI
			 , @NapLocalTaxI        , @NapSpTaxI            , @InTaxI               , @LocalTaxI            , @SpTaxI
			 , @UserId              , GETDATE()             , @UserId               , GETDATE()
          FROM            HUM100T A  WITH (NOLOCK)
               LEFT  JOIN BSA100T M1 WITH (NOLOCK) ON M1.COMP_CODE  = A.COMP_CODE
                                                  AND M1.MAIN_CODE  = N'H005'
                                                  AND M1.SUB_CODE   = A.POST_CODE
         WHERE A.COMP_CODE   = @CompCode
           AND A.PERSON_NUMB = @PersonNumb
    
        --기부금 조정
        EXEC sp2017YearEndTax315SetContributionDeduction @CompCode
													   , @YearYyyy
													   , @PersonNumb
													   , @EarnIncomeI           --근로소득금액
													   , @PolicyInded           --정치자금기부금(10만원미만)
													   , @PolicyGiftI           --정치자금기부금(10만원초과)
													   , @LegalGiftIPrev        --법정기부금이월금-2013
													   , @LegalGiftIPrev14      --법정기부금이월금-2014
													   , @LegalGiftI            --법정기부금
													   , @PrivGiftIPrev         --특례기부금이월금
													   , @PrivGiftI             --특례기부금
													   , @PublicGiftIPrev       --공익법인신탁기부금이월금
													   , @PublicGiftI           --공익법인신탁기부금
													   , @StaffGiftI            --우리사주기부금
													   , @AppointGiftIPrev      --지정기부금이월금-2013
													   , @AppointGiftIPrev14    --지정기부금이월금-2014
													   , @AppointGiftI          --지정기부금
													   , @AssGiftIPrev          --종교단체기부금이월금-2013
													   , @AssGiftIPrev14        --종교단체기부금이월금-2014
													   , @AssGiftI              --종교단체기부금
													   , @GiftDedI              --기부금공제(특별소득공제)
													   , @StaffGiftDedI         --기부금공제(기타소득공제)
													   , @GiftTaxDedI           --기부금공제(특별세액공제)
													   , @UserId

		SET @SciTaxDedI          = @SciTaxDedI    + @SciTaxDedI1
		SET @RetireTaxDedI       = @RetireTaxDedI + @RetireTaxDedI1
		SET @PensTaxDedI         = @PensTaxDedI   + @PensTaxDedI1

		--연금저축소득공제금액 업데이트
		EXEC sp2017YearEndTax320SetAnnuitySavingsDeduction @CompCode
														 , @YearYyyy
														 , @PersonNumb
														 , @IncomeSuppTotalI                    --총급여액
														 , @PrivPensI                           --(소득공제)21-개인연금저축
														 , @HousBuAmt                           --(소득공제)31-청약저축(240만원한도)
														 , @HousBuAddAmt                        --(소득공제)35-청약저축(120만원한도)
														 , @HousWorkAmt                         --(소득공제)34-근로자주택마련저축
														 , @HousBuAmountI                       --(소득공제)32-주택청약종합저축(240만원한도)
														 , @HousBuAmountAddI                    --(소득공제)36-주택청약종합저축(120만원한도)
														 , @LongInvestStockDedI                 --(소득공제)51-장기집합투자증권저축
														 , @SciTaxDedI                          --(세액공제)12-과학기술인공제
														 , @RetireTaxDedI                       --(세액공제)11-근로자퇴직급여보장법
														 , @PensTaxDedI                         --(세액공제)22-연금저축
		--비과세소득금액 생성
		EXEC sp2017YearEndTax325SumNontaxableIncome @CompCode
												  , @YearYyyy
												  , @PersonNumb
												  , @ForeSingleYn
												  , @UserId
    
        SET NOCOUNT OFF
        SET ARITHABORT OFF
	END
	</update>
	<select  id="had617ukrServiceImpl.selectNap" parameterType="Map" resultType="rMap">
	--Had617UKr.CHad617UKr[fnHad617QNap] Query01
     /**********************************************************************************************************************
      개인연말정산 조회(납세조합내역)
     **********************************************************************************************************************/
         DECLARE @CompCode          NVARCHAR(08)                -- (필수) 법인코드
               , @YearYyyy          NVARCHAR(04)                -- (필수) 정산년도
               , @PersonNumb        NVARCHAR(10)                -- (필수) 사번
     
         SET NOCOUNT ON
         SET ARITHABORT ON
     
     --  1. 변수 값 할당 -------------------------------------------------------------------------------------------------
         SET @CompCode   = #{S_COMP_CODE}
         SET @YearYyyy   = #{YEAR_YYYY}
         SET @PersonNumb = #{PERSON_NUMB}
     
     --  2. 데이터 조회 --------------------------------------------------------------------------------------------------
         SELECT  
                A.PERSON_NUMB
              , A.NAME
              , A.DEPT_CODE
              , A.DEPT_NAME
              , A.POST_CODE
              , ISNULL(M1.CODE_NAME           , '')                              AS POST_NAME
              , ISNULL(B.YEAR_YYYY            , @YearYyyy)                       AS YEAR_YYYY
              , ISNULL(B.P3_COMPANY_NAME      , '')                              AS P3_COMPANY_NAME
              , ISNULL(B.P3_COMPANY_NUM       , '')                              AS P3_COMPANY_NUM
              , CASE WHEN ISNULL(B.P3_WORKDATE_FR, '') = '' OR ISNULL(B.P3_WORKDATE_FR, '') = '0'
                     THEN ''
                     ELSE B.P3_WORKDATE_FR
                END                                                              AS P3_WORKDATE_FR
              , CASE WHEN ISNULL(B.P3_WORKDATE_TO, '') = '' OR ISNULL(B.P3_WORKDATE_TO, '') = '0'
                     THEN ''
                     ELSE B.P3_WORKDATE_TO
                END                                                              AS P3_WORKDATE_TO
              , CASE WHEN ISNULL(B.P3_NONTAX_FR  , '') = '' OR ISNULL(B.P3_NONTAX_FR  , '') = '0'
                     THEN ''
                     ELSE B.P3_NONTAX_FR
                END                                                              AS P3_NONTAX_FR
              , CASE WHEN ISNULL(B.P3_NONTAX_TO  , '') = '' OR ISNULL(B.P3_NONTAX_TO  , '') = '0'
                     THEN ''
                     ELSE B.P3_NONTAX_TO
                END                                                              AS P3_NONTAX_TO
              , ISNULL(B.P3_PAY_TOTAL_I       , 0 )                              AS P3_PAY_TOTAL_I
              , ISNULL(B.P3_BONUS_I_TOTAL_I   , 0 )                              AS P3_BONUS_I_TOTAL_I
              , ISNULL(B.P3_IN_TAX_I          , 0 )                              AS P3_IN_TAX_I
              , ISNULL(B.P3_LOCAL_TAX_I       , 0 )                              AS P3_LOCAL_TAX_I
              , ISNULL(B.P3_SP_TAX_I          , 0 )                              AS P3_SP_TAX_I
              , CASE WHEN ISNULL(B.PERSON_NUMB, '') = '' THEN 'Y' ELSE 'N' END   AS NEW_DATA_YN          -- 개인연말정산기초자료 존재여부
           FROM            HUM100T A  WITH (NOLOCK)
                LEFT  JOIN HAD400T B  WITH (NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
                                                   AND B.YEAR_YYYY   = @YearYyyy
                                                   AND B.PERSON_NUMB = A.PERSON_NUMB
                LEFT  JOIN BSA100T M1 WITH (NOLOCK) ON M1.COMP_CODE  = A.COMP_CODE
                                                   AND M1.MAIN_CODE  = 'H005'
                                                   AND M1.SUB_CODE   = A.POST_CODE
          WHERE A.COMP_CODE   = @CompCode
            AND A.PERSON_NUMB = @PersonNumb
     
         SET NOCOUNT OFF
         SET ARITHABORT OFF
	</select>
	<update id="had617ukrServiceImpl.updateNap" parameterType="foren.unilite.modules.human.had.Had617ukrNapModel">
		   UPDATE HAD400T
		   		SET P3_COMPANY_NAME    = #{P3_COMPANY_NAME}
                  , P3_COMPANY_NUM     = #{P3_COMPANY_NUM}
                  , P3_WORKDATE_FR     = #{P3_WORKDATE_FR}
                  , P3_WORKDATE_TO     = #{P3_WORKDATE_TO}
                  , P3_NONTAX_FR       = #{P3_NONTAX_FR}
                  , P3_NONTAX_TO       = #{P3_NONTAX_TO}
                  , P3_PAY_TOTAL_I     = #{P3_PAY_TOTAL_I}
                  , P3_BONUS_I_TOTAL_I = #{P3_BONUS_I_TOTAL_I}
                  , P3_IN_TAX_I        = #{P3_IN_TAX_I}
                  , P3_LOCAL_TAX_I     = #{P3_LOCAL_TAX_I}
                  , P3_SP_TAX_I        = #{P3_SP_TAX_I}
              WHERE COMP_CODE   = #{S_COMP_CODE}
                AND YEAR_YYYY   = #{YEAR_YYYY}
                AND PERSON_NUMB = #{PERSON_NUMB}
	</update>
	<update id="had617ukrServiceImpl.deleteNap" parameterType="Map">
		UPDATE HAD400T
                SET P3_COMPANY_NAME    = ''
                  , P3_COMPANY_NUM     = ''
                  , P3_WORKDATE_FR     = ''
                  , P3_WORKDATE_TO     = ''
                  , P3_NONTAX_FR       = ''
                  , P3_NONTAX_TO       = ''
                  , P3_PAY_TOTAL_I     = 0
                  , P3_BONUS_I_TOTAL_I = 0
                  , P3_IN_TAX_I        = 0
                  , P3_LOCAL_TAX_I     = 0
                  , P3_SP_TAX_I        = 0
              WHERE COMP_CODE   = #{S_COMP_CODE}
                AND YEAR_YYYY   = #{YEAR_YYYY}
                AND PERSON_NUMB = #{PERSON_NUMB}
	</update>
	<select id="had617ukrServiceImpl.selectFamliy" parameterType="Map" resultType="rMap">
		--uniLITE5Popup.CPopup[getHumanFamily] Query01
    
        SET NOCOUNT ON
        SET ARITHABORT ON
    
        IF EXISTS (SELECT TOP 1 1 FROM tempdb..sysobjects WHERE ID=OBJECT_ID('tempdb..#HUM_FAMILY'))
            DROP TABLE #HUM_FAMILY
    
        SELECT FAMILY_NAME
             , uniLITE.fnCipherDecrypt(A.REPRE_NUM, 'A')    AS REPRE_NUM
             , C.CODE_NAME                                  AS REL_NAME
             , D.CODE_NAME                                  AS IN_FORE_NAME
             , REL_CODE
             , IN_FORE
             , DEFAULT_DED_YN
             , DEFORM_DED_YN
             , OLD_DED_YN
        INTO   #HUM_FAMILY
        FROM              HAD430T   A  WITH (NOLOCK)
               INNER JOIN HUM100T   B  WITH (NOLOCK) ON B.COMP_CODE     = A.COMP_CODE
                                                    AND B.PERSON_NUMB   = A.PERSON_NUMB
               LEFT  JOIN BSA100T   C  WITH (NOLOCK) ON C.COMP_CODE     = A.COMP_CODE
                                                    AND C.MAIN_CODE     = 'H115'
                                                    AND C.SUB_CODE      = A.REL_CODE
               LEFT  JOIN BSA100T   D  WITH (NOLOCK) ON D.COMP_CODE     = A.COMP_CODE
                                                    AND D.MAIN_CODE     = 'H118'
                                                    AND D.SUB_CODE      = A.IN_FORE
        

            WHERE  A.COMP_CODE                                 = #{S_COMP_CODE}
            AND    A.SEQ_NUM                                   = '1'
            AND    A.YEAR_YYYY                                 = #{YEAR_YYYY}
            AND    A.PERSON_NUMB                               = #{PERSON_NUMB}  
            <if test="@foren.Ognl@isNotEmpty(FAMILY_NAME)"> 
            AND    A.FAMILY_NAME                            LIKE '% + #{FAMILY_NAME} + %'
            </if>
            <if test="@foren.Ognl@isNotEmpty(REPRE_NUM)">  
            AND    uniLITE.fnCipherDecrypt(A.REPRE_NUM,'')  LIKE '% + #{REPRE_NUM} + %'  
            </if>
    	select * from #HUM_FAMILY
	</select>
	<select id="had617ukrServiceImpl.selectPDFSummary" parameterType="Map" resultType="rMap">
			--HadPdfukrv.CPdf2017[fnHadPdfQStd] Query01 
		    
            SELECT    ISNULL(MAX(A102Y_AMT),0) AS A102Y_AMT
		            , ISNULL(MAX(B101Y_AMT),0) AS B101Y_AMT
		            , ISNULL(MAX(G106Y_AMT),0) AS G106Y_AMT
		            , ISNULL(MAX(G206Y_AMT),0) AS G206Y_AMT
		            , ISNULL(MAX(G306Y_AMT),0) AS G306Y_AMT
		            , ISNULL(MAX(L102Y_AMT),0) AS L102Y_AMT
		            , ISNULL(MAX(J301Y_AMT),0) AS J301Y_AMT
		            , ISNULL(MAX(N101Y_AMT),0) AS N101Y_AMT
		            , ISNULL(MAX(K101M_AMT),0) AS K101M_AMT
		    --교육비
		            , ISNULL(MAX(C102Y_AMT),0) AS C102Y_AMT
		            , ISNULL(MAX(C202Y_AMT),0) AS C202Y_AMT
		            , ISNULL(MAX(C301Y_AMT),0) AS C301Y_AMT
		            , ISNULL(MAX(C401Y_AMT),0) AS C401Y_AMT
		            , ISNULL(MAX(C102Y_AMT),0) + ISNULL(MAX(C202Y_AMT),0) + ISNULL(MAX(C301Y_AMT),0) + ISNULL(MAX(C401Y_AMT),0) AS EDU_AMT_SUM
		    --개인연금/연금계좌
		            , ISNULL(MAX(D101Y_AMT),0) AS D101Y_AMT
		            , ISNULL(MAX(E102Y_AMT),0) AS E102Y_AMT
		            , ISNULL(MAX(F102Y_AMT),0) AS F102Y_AMT
		            , ISNULL(MAX(D101Y_AMT),0) + ISNULL(MAX(E102Y_AMT),0) + ISNULL(MAX(F102Y_AMT),0) AS PENSION_AMT_SUM
		    --주택자금
		            , ISNULL(MAX(J203Y_AMT),0) AS J203Y_AMT
		            , ISNULL(MAX(J101Y_AMT),0) AS J101Y_AMT
		            , ISNULL(MAX(J401Y_AMT),0) AS J401Y_AMT
		            , ISNULL(MAX(J203Y_AMT),0) + ISNULL(MAX(J101Y_AMT),0) + ISNULL(MAX(J401Y_AMT),0) AS HOUSING_FUNDS_SUM
    		FROM (
                SELECT  COMP_CODE
                		, GUBUN_CODE
                        , SUM(CASE GUBUN_CODE WHEN 'A102Y' THEN USE_AMT ELSE 0 END) AS A102Y_AMT   --보험
                        , SUM(CASE GUBUN_CODE WHEN 'B101Y' THEN USE_AMT ELSE 0 END) AS B101Y_AMT   --의료비
                        , SUM(CASE GUBUN_CODE WHEN 'G106Y' THEN USE_AMT ELSE 0 END) AS G106Y_AMT   --신용카드
                        , SUM(CASE GUBUN_CODE WHEN 'G206Y' THEN USE_AMT ELSE 0 END) AS G206Y_AMT   --현금영수증
                        , SUM(CASE GUBUN_CODE WHEN 'G306Y' THEN USE_AMT ELSE 0 END) AS G306Y_AMT   --직불카드
                        , SUM(CASE GUBUN_CODE WHEN 'L102Y' THEN USE_AMT ELSE 0 END) AS L102Y_AMT   --기부금
                        , SUM(CASE GUBUN_CODE WHEN 'J301Y' THEN USE_AMT ELSE 0 END) AS J301Y_AMT   --주택마련저축
                        , SUM(CASE GUBUN_CODE WHEN 'N101Y' THEN USE_AMT ELSE 0 END) AS N101Y_AMT   --장기집합투자증권저축
                        , SUM(CASE GUBUN_CODE WHEN 'K101M' THEN USE_AMT ELSE 0 END) AS K101M_AMT   --소기업/소상공인공제부금
    
    		--교육비
                        , SUM(CASE GUBUN_CODE WHEN 'C102Y' THEN USE_AMT ELSE 0 END) AS C102Y_AMT   --교육비
                        , SUM(CASE GUBUN_CODE WHEN 'C202Y' THEN USE_AMT ELSE 0 END) AS C202Y_AMT   --직업훈련비
                        , SUM(CASE GUBUN_CODE WHEN 'C301Y' THEN USE_AMT ELSE 0 END) AS C301Y_AMT   --교복구입비
                        , SUM(CASE GUBUN_CODE WHEN 'C401Y' THEN USE_AMT ELSE 0 END) AS C401Y_AMT   --학자금대출

    		--개인연금/연금계좌
                        , SUM(CASE GUBUN_CODE WHEN 'D101Y' THEN USE_AMT ELSE 0 END) AS D101Y_AMT   --개인연금저축
                        , SUM(CASE GUBUN_CODE WHEN 'E102Y' THEN USE_AMT ELSE 0 END) AS E102Y_AMT   --연금저축
                        , SUM(CASE GUBUN_CODE WHEN 'F102Y' THEN USE_AMT ELSE 0 END) AS F102Y_AMT   --퇴직연금
    
    		--주택자금
                        , SUM(CASE GUBUN_CODE WHEN 'J203Y' THEN USE_AMT ELSE 0 END) AS J203Y_AMT   --장기주택저당차입금 이자상환액
                        , SUM(CASE GUBUN_CODE WHEN 'J101Y' THEN USE_AMT ELSE 0 END) AS J101Y_AMT   --주택임차차입금 원기금 상환액
                        , SUM(CASE GUBUN_CODE WHEN 'J401Y' THEN USE_AMT ELSE 0 END) AS J401Y_AMT   --목돈 안드는 전세 아지상환액
		    
		                FROM HADPDFT WITH (NOLOCK)
		                WHERE   COMP_CODE = #{S_COMP_CODE}
		                AND     BASE_YEAR = #{YEAR_YYYY}
		                AND     PERSON_NUMB=#{PERSON_NUMB}
		                AND     TARGET_YN = 'Y'
		                GROUP BY COMP_CODE, GUBUN_CODE, GUBUN_NAME
		    ) M
	</select>
	<select id="had617ukrServiceImpl.selectPdfList" parameterType="Map" resultType="rMap">
		--HadPdfukrv.CPdf2017[fnHadPdfQStd] Query02
		SELECT  
		       CASE WHEN A.TARGET_YN='Y' THEN 'true' ELSE 'false' END AS TARGET_YN
		     , A.GUBUN_CODE
		     , CASE WHEN A.GUBUN_CODE = 'C102Y' AND ISNULL(A.EDU_CL,'') = 'B' THEN '현장체험학습비' ELSE A.GUBUN_NAME END AS GUBUN_NAME
		     , A.D_NAME
		     , uniLITE.fnCipherDecrypt(A.D_REPRE_NUM, 'RR') AS D_REPRE_NUM
		     , A.DATA_CD
		     , B.CODE_NAME AS DATA_NAME
		     , (CASE WHEN LEFT(A.GUBUN_CODE,1)='G' THEN ISNULL(C.CODE_NAME,'') ELSE '' END) AS CARD_TYPE_NAME
		     , SUM(A.USE_AMT) AS USE_AMT
		     , SUM(A.SBDY_APLN_SUM) AS SBDY_APLN_SUM
		     , SUM(A.CONB_SUM)      AS CONB_SUM
		     , uniLITE.fnCipherDecrypt(A.D_REPRE_NUM,'') AS D_RES_NO
		     , A.BASE_YEAR AS YEAR_YYYY
		     , A.PERSON_NUMB
		 FROM  HADPDFT A WITH (NOLOCK)
		       LEFT JOIN BSA100T B WITH (NOLOCK) ON A.COMP_CODE=B.COMP_CODE 
		       									AND A.DATA_CD=B.SUB_CODE 
		       									AND B.MAIN_CODE='H191'
		       LEFT JOIN BSA100T C WITH (NOLOCK) ON A.COMP_CODE=C.COMP_CODE 
		       									AND A.USE_PLACE_CD=C.SUB_CODE 
		       									AND C.MAIN_CODE='H192'
		 WHERE A.COMP_CODE 		= #{S_COMP_CODE}
		 AND   A.BASE_YEAR 		= #{YEAR_YYYY}
		 AND   A.PERSON_NUMB 	= #{PERSON_NUMB}
		 <if test="@foren.Ognl@isNotEmpty(GUBUN_CODE)">   
			AND A.GUBUN_CODE IN 
			 <foreach collection="GUBUN_CODE" item="item" separator="," close=")" open="(">
						  #{item}
			</foreach>
		</if>
		 GROUP BY A.TARGET_YN, A.GUBUN_CODE
		 		, A.GUBUN_NAME
		 		, A.D_NAME
		 		, uniLITE.fnCipherDecrypt(A.D_REPRE_NUM, 'RR')
		 		, uniLITE.fnCipherDecrypt(A.D_REPRE_NUM,'')
		        , A.DATA_CD
		        , B.CODE_NAME
		        , A.USE_PLACE_CD
		        , (CASE WHEN LEFT(A.GUBUN_CODE,1)='G' THEN ISNULL(C.CODE_NAME,'') ELSE '' END)
		        , (CASE WHEN SUBSTRING(uniLITE.fnCipherDecrypt(A.D_REPRE_NUM, ''),7,1) &gt; '2' THEN '20' ELSE '19' END) + uniLITE.fnCipherDecrypt(A.D_REPRE_NUM, 'RR')   --sql2000으로 인해 추가
		        , ISNULL(A.EDU_CL,'')
		        , A.BASE_YEAR
		 		, A.PERSON_NUMB 
		 ORDER BY A.GUBUN_CODE
		 		, (CASE WHEN SUBSTRING(uniLITE.fnCipherDecrypt(A.D_REPRE_NUM, ''),7,1) &gt; '2' THEN '20' ELSE '19' END) + uniLITE.fnCipherDecrypt(A.D_REPRE_NUM, 'RR') 
		 		, A.USE_PLACE_CD
		 		, A.DATA_CD
	</select>
	<update id="had617ukrServiceImpl.updatePdf" parameterType="Map">
		--HadPdfukrv.CPdfUpload[fnHadPdfTempSave] Query01 
        UPDATE HADPDFT 
           SET TARGET_YN = #{TARGET_YN}
         WHERE COMP_CODE = #{S_COMP_CODE}
           AND BASE_YEAR = #{YEAR_YYYY}
           AND PERSON_NUMB = #{PERSON_NUMB}
           AND GUBUN_CODE = #{GUBUN_CODE}
           AND uniLITE.fnCipherDecrypt(D_REPRE_NUM,'') = #{D_RES_NO}
           AND DATA_CD = #{DATA_CD}
	</update>
	<update id="had617ukrServiceImpl.sp2017YearTaxPDF" parameterType="Map" statementType="CALLABLE">

        {call UNILITE.sp2017YearTaxPDFUpload (
            #{S_COMP_CODE, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
            #{YEAR_YYYY, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
            #{PERSON_NUMB, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String},
            #{ErrorDesc, mode=OUT, jdbcType=VARCHAR, javaType=java.lang.String}
        )}
       
     </update>
     <delete id="had617ukrServiceImpl.deletePDF" parameterType="Map">
     	DELETE FROM HADPDFT
     	WHERE COMP_CODE= #{S_COMP_CODE}
     	  AND BASE_YEAR = #{YEAR_YYYY}
     	  AND PERSON_NUMB = #{PERSON_NUMB}
     	  AND GUBUN_CODE = #{GUBUN_CODE}
     	  AND uniLITE.fnCipherDecrypt(D_REPRE_NUM,'') = #{D_REPRE_NUM}
     </delete>
     <insert id="had617ukrServiceImpl.applyPDF" parameterType="Map">
 		--hdapdfukr.CPdf2014(PDF2DB) - PDF 반영
        INSERT INTO HADPDFT (
        	  COMP_CODE
        	, BASE_YEAR
        	, PERSON_NUMB
        	, PERSON_NAME
        	, GUBUN_CODE
        	, GUBUN_NAME
        	, D_NAME
        	, D_REPRE_NUM
            , USE_AMT
            , FTYR_TMONEY_TOT_AMT, FTYR_MARKET_TOT_AMT, FTYR_TOT_AMT  --전전년도
            , PRE_TMONEY_TOT_AMT, PRE_MARKET_TOT_AMT, PRE_TOT_AMT  --직전년도
            , SUM_AMT
            , TRADE_NM, BUSI_NO, EDU_TYPE, EDU_CL, USE_PLACE_CD
            , DATA_CD
            , SAVING_GUBUN
            , COM_CD
            , ACC_NO
            , PENSION_CD
            , DONATION_CD
            , G_FIRST_YEAR_TOT_AMT, G_SECOND_YEAR_TOT_AMT
            , J203Y_START_DT, J203Y_REPAY_YEARS, J203Y_FIXED_RATE_DEBT, J203Y_NOT_DEFER_DEBT, J203Y_DDCT
            , PDF_FILE
            , START_DT
            , END_DT
            , SBDY_APLN_SUM
            , CONB_SUM
            , INSERT_DB_USER, UPDATE_DB_USER
       ) VALUES (
       		  #{S_COMP_CODE}
            , #{YEAR_YYYY}
            , #{PERSON_NUMB} 
            , #{NAME}
            , #{GUBUN_CODE} 					--현금영수증서식코드는 G204M 만 존재. 저장시에는 G204Y 로 저장
            , #{GUBUN_NAME}    
            , #{D_NAME}        					 --대상자
            , uniLITE.fnCipherEncrypt(#{D_REPRE_NUM},'')  --대상자 주민번호
            , #{USE_AMT}        --사용금액
            , #{FTYR_TMONEY_TOT_AMT}         	--전전년 대중교통대상금액합계
            , #{FTYR_MARKET_TOT_AMT}           	--전전년 전통시장공제대상금액
            , #{FTYR_TOT_AMT}                 	--전전년 일반공제공제대상금액
    
            , #{PRE_TMONEY_TOT_AMT}          	--직전년 대중교통대상금액합계
            , #{PRE_MARKET_TOT_AMT}           	--직전년 전통시장공제대상금액
            , #{PRE_TOT_AMT}                 	--직전년 일반공제공제대상금액
            , #{SUM_AMT}                  		--납입금액
            , #{TRADE_NM}   					--상호
            , #{BUSI_NO}    					--사업자번호
            , #{EDU_TYPE} 
            , #{EDU_CL}     					--2017추가
            , #{USE_PLACE_CD}
            , #{DATA_CD} 
            , #{SAVING_GUBUN}
            , #{COM_CD}      					--금융회사등 코드
            , uniLITE.fnCipherEncrypt(#{ACC_NO}, '')       --계좌번호
            , #{PENSION_CD}    					--계좌유형
            , #{DONATION_CD}
    	-- 신용카드, 현금영수증, 직불카드
            , #{G_FIRST_YEAR_TOT_AMT} 
            , #{G_SECOND_YEAR_TOT_AMT}
    
    	--J203Y 장기주책저당차입금 이자상환액 
            , #{J203Y_START_DT}
            , #{J203Y_REPAY_YEARS}
            , #{J203Y_FIXED_RATE_DEBT} 
            , #{J203Y_NOT_DEFER_DEBT}
            , #{J203Y_DDCT}
            , #{PDF_FILE}
            , #{START_DT}						--소기업.소상공인공제 대상기간 FROM
            , #{END_DT}    						--소기업,소상공인공제 대상기간 TO
            , #{SBDY_APLN_SUM}    				--기부장려금
            , #{CONB_SUM}       				--기부대상금액 + 기부장려금 = 합계
            , #{S_USER_ID}
            , #{S_USER_ID}
        )
     </insert>
     <select id="had617ukrServiceImpl.checkFamily" parameterType="Map" resultType="rMap">
	    --HdaPdfukrv.CPdf2017[PDFConvertData] Query02 
	    SELECT *
	    FROM (
	            SELECT  COMP_CODE, PERSON_NUMB, D_NAME, REPLACE(uniLITE.fnCipherDecrypt(D_REPRE_NUM, ''),'-','') AS REPRE_NUM
	            FROM    HADPDFT WITH (NOLOCK)
	            WHERE   COMP_CODE = #{S_COMP_CODE}
	            AND     BASE_YEAR = #{YEAR_YYYY}
	            AND     PERSON_NUMB = #{PERSON_NUMB}
	            GROUP BY COMP_CODE, PERSON_NUMB, D_NAME, REPLACE(uniLITE.fnCipherDecrypt(D_REPRE_NUM, ''),'-','')
	          ) A
	          LEFT JOIN (
	            SELECT  COMP_CODE, PERSON_NUMB, FAMILY_NAME, REPLACE(uniLITE.fnCipherDecrypt(REPRE_NUM, ''),'-','') AS REPRE_NUM
	            FROM    HAD430T WITH (NOLOCK) 
	            WHERE   COMP_CODE = #{S_COMP_CODE}
	            AND     YEAR_YYYY = #{YEAR_YYYY}
	            AND     PERSON_NUMB = #{PERSON_NUMB}
	            GROUP BY COMP_CODE, PERSON_NUMB, FAMILY_NAME, REPLACE(uniLITE.fnCipherDecrypt(REPRE_NUM, '') ,'-','')
	          ) B ON A.COMP_CODE=B.COMP_CODE AND A.PERSON_NUMB=B.PERSON_NUMB AND A.REPRE_NUM=B.REPRE_NUM
	    WHERE B.PERSON_NUMB IS NULL
     </select>
     <update id="had617ukrServiceImpl.updateMedI" parameterType="Map">
     	UPDATE A
		SET    A.MED_USE_I      = ISNULL(B.MED_USE_I     , 0.0)         -- 의료비
		     , A.SURGERY_MED_I  = ISNULL(B.SURGERY_MED_I , 0.0)         -- 난임시술비
		FROM              HAD430T  A  WITH (NOLOCK)
		       LEFT  JOIN (
		                  SELECT S1.COMP_CODE, S1.YEAR_YYYY, S1.PERSON_NUMB, REPLACE(unilite.fnCipherDecrypt(S1.REPRE_NUM, ''),'-','') AS REPRE_NUM, S1.MED_RELATION, S1.TAX_GU
		                       , SUM(CASE WHEN S1.MED_CODE != 'P' THEN S1.SEND_USE_I ELSE 0.0 END)   AS MED_USE_I
		                       , SUM(CASE WHEN S1.MED_CODE = 'P'  THEN S1.SEND_USE_I ELSE 0.0 END)   AS SURGERY_MED_I
		                  FROM   HAD410T  S1 WITH (NOLOCK)
		                  WHERE  S1.COMP_CODE   = #{S_COMP_CODE}
		                  AND    S1.YEAR_YYYY   = #{YEAR_YYYY}
		                  AND    S1.PERSON_NUMB = #{PERSON_NUMB}
		                  GROUP  BY
		                         S1.COMP_CODE, S1.YEAR_YYYY, S1.PERSON_NUMB, REPLACE(unilite.fnCipherDecrypt(S1.REPRE_NUM, ''),'-',''), S1.MED_RELATION, S1.TAX_GU
		                  ) B                      ON B.COMP_CODE       = A.COMP_CODE
		                                          AND B.YEAR_YYYY       = A.YEAR_YYYY
 		                                          AND B.PERSON_NUMB     = A.PERSON_NUMB
		                                          AND B.REPRE_NUM = REPLACE(unilite.fnCipherDecrypt(A.REPRE_NUM, ''),'-','')
		                                          AND B.MED_RELATION    = A.REL_CODE
		                                          AND B.TAX_GU          = A.SEQ_NUM
		WHERE  A.COMP_CODE      = #{S_COMP_CODE}
		AND    A.YEAR_YYYY      = #{YEAR_YYYY}
		AND    A.PERSON_NUMB    = #{PERSON_NUMB}
     </update>
</mapper>