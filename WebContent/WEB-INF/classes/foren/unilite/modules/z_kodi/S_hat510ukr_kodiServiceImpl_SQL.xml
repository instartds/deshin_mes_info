<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="s_hat510ukr_kodiServiceImpl">
	<select id="s_hat510ukr_kodiServiceImpl.selectDutycode_BAK" parameterType="String" resultType="rMap">
		SELECT 'BASE_' + CAL_DATE AS BASE_DATE
		     , 'BASE_CODE_' + CAL_DATE AS BASE_CODE
		     , 'C51_'  + CAL_DATE AS C51_DATE
			 , 'C52_'  + CAL_DATE AS C52_DATE
			 , 'C54_'  + CAL_DATE AS C54_DATE
			 , 'C56_'  + CAL_DATE AS C56_DATE
			 , CAL_DATE           AS DATE
			 , RIGHT(CAL_DATE, 2) AS DATE_DAY
		 	 , CASE WHEN WEEK_DAY =  '1'
		            THEN '일'
					WHEN WEEK_DAY =  '2'
		        	THEN '월'
					WHEN WEEK_DAY =  '3'
		        	THEN '화'
					WHEN WEEK_DAY =  '4'
		        	THEN '수'
					WHEN WEEK_DAY =  '5'
		        	THEN '목'
					WHEN WEEK_DAY =  '6'
		        	THEN '금'
					WHEN WEEK_DAY =  '7'
		        	THEN '토'
				END               AS WEEK_DAY
		  FROM HBS600T
		 WHERE COMP_CODE = #{S_COMP_CODE}
		   AND DIV_CODE  = '00'
	  	   AND LEFT(CAL_DATE, 6) = CONVERT(NVARCHAR(06), GETDATE(), 112)
	</select>
	<select id="s_hat510ukr_kodiServiceImpl.selectDutycode" parameterType="String" resultType="rMap">
		SELECT 'DUTY_NUM_BASE_' + RIGHT(CAL_DATE, 2) AS BASE_DATE
		     , 'DUTY_CODE_'     + RIGHT(CAL_DATE, 2) AS BASE_CODE
		     , 'DUTY_NUM_51_'   + RIGHT(CAL_DATE, 2) AS C51_DATE
			 , 'DUTY_NUM_52_'   + RIGHT(CAL_DATE, 2) AS C52_DATE
			 , 'DUTY_NUM_54_'   + RIGHT(CAL_DATE, 2) AS C54_DATE
			 , 'DUTY_NUM_56_'   + RIGHT(CAL_DATE, 2) AS C56_DATE
			 , CAL_DATE           AS DATE
			 , RIGHT(CAL_DATE, 2) AS DATE_DAY
		 	 , CASE WHEN WEEK_DAY =  '1'
		            THEN '일'
					WHEN WEEK_DAY =  '2'
		        	THEN '월'
					WHEN WEEK_DAY =  '3'
		        	THEN '화'
					WHEN WEEK_DAY =  '4'
		        	THEN '수'
					WHEN WEEK_DAY =  '5'
		        	THEN '목'
					WHEN WEEK_DAY =  '6'
		        	THEN '금'
					WHEN WEEK_DAY =  '7'
		        	THEN '토'
				END               AS WEEK_DAY
		  FROM HBS600T WITH(NOLOCK)
		 WHERE COMP_CODE = #{S_COMP_CODE}
		   AND DIV_CODE  = '00'
	  	   AND LEFT(CAL_DATE, 6) = CONVERT(NVARCHAR(06), GETDATE(), 112)
	</select>
	
	<select id="s_hat510ukr_kodiServiceImpl.selectDutycode1" parameterType="String" resultType="rMap">
		SELECT 'DUTY_NUM_BASE_' + RIGHT(CAL_DATE, 2) AS BASE_DATE
		     , 'DUTY_CODE_'     + RIGHT(CAL_DATE, 2) AS BASE_CODE
		     , 'DUTY_NUM_51_'   + RIGHT(CAL_DATE, 2) AS C51_DATE
			 , 'DUTY_NUM_52_'   + RIGHT(CAL_DATE, 2) AS C52_DATE
			 , 'DUTY_NUM_54_'   + RIGHT(CAL_DATE, 2) AS C54_DATE
			 , 'DUTY_NUM_56_'   + RIGHT(CAL_DATE, 2) AS C56_DATE
			 , CAL_DATE           AS DATE
			 , RIGHT(CAL_DATE, 2) AS DATE_DAY
		 	 , CASE WHEN WEEK_DAY =  '1'
		            THEN '일'
					WHEN WEEK_DAY =  '2'
		        	THEN '월'
					WHEN WEEK_DAY =  '3'
		        	THEN '화'
					WHEN WEEK_DAY =  '4'
		        	THEN '수'
					WHEN WEEK_DAY =  '5'
		        	THEN '목'
					WHEN WEEK_DAY =  '6'
		        	THEN '금'
					WHEN WEEK_DAY =  '7'
		        	THEN '토'
				END               AS WEEK_DAY
		  FROM HBS600T
		 WHERE COMP_CODE = #{S_COMP_CODE}
		 <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
		   AND DIV_CODE  = '00'
		  </if>
          <if test="@foren.Ognl@isNotEmpty(DUTY_YYYYMMDD)">
	  	   AND LEFT(CAL_DATE, 6) = #{DUTY_YYYYMMDD}
          </if>

	</select>
	
	<select id="s_hat510ukr_kodiServiceImpl.selectDutycode2" parameterType="String" resultType="rMap">
		SELECT 'DUTY_NUM_BASE_' + RIGHT(CAL_DATE, 2) AS BASE_DATE
		     , 'DUTY_CODE_'     + RIGHT(CAL_DATE, 2) AS BASE_CODE
		     , 'DUTY_NUM_51_'   + RIGHT(CAL_DATE, 2) AS C51_DATE
			 , 'DUTY_NUM_52_'   + RIGHT(CAL_DATE, 2) AS C52_DATE
			 , 'DUTY_NUM_54_'   + RIGHT(CAL_DATE, 2) AS C54_DATE
			 , 'DUTY_NUM_56_'   + RIGHT(CAL_DATE, 2) AS C56_DATE
			 , CAL_DATE           AS DATE
			 , RIGHT(CAL_DATE, 2) AS DATE_DAY
		 	 , CASE WHEN WEEK_DAY =  '1'
		            THEN '일'
					WHEN WEEK_DAY =  '2'
		        	THEN '월'
					WHEN WEEK_DAY =  '3'
		        	THEN '화'
					WHEN WEEK_DAY =  '4'
		        	THEN '수'
					WHEN WEEK_DAY =  '5'
		        	THEN '목'
					WHEN WEEK_DAY =  '6'
		        	THEN '금'
					WHEN WEEK_DAY =  '7'
		        	THEN '토'
				END               AS WEEK_DAY
		  FROM HBS600T
		 WHERE COMP_CODE = #{S_COMP_CODE}
		 <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
		   AND DIV_CODE  = '00'
		  </if>
          <if test="@foren.Ognl@isNotEmpty(DUTY_YYYYMM)">
	  	   AND LEFT(CAL_DATE, 6) = #{DUTY_YYYYMM}
          </if>
          
	</select>
	
	<select id="s_hat510ukr_kodiServiceImpl.selectDate" parameterType="String" resultType="rMap">
		   
		SELECT CAL_DATE
		  FROM HBS600T
		 WHERE COMP_CODE = #{S_COMP_CODE}
		   AND DIV_CODE  = '00'
		   AND LEFT(CAL_DATE, 6) = #{DUTY_YYYYMMDD} 
	</select>
	
	
	<select id="s_hat510ukr_kodiServiceImpl.selectDataList" parameterType="rMap" resultType="rMap">
		IF EXISTS (SELECT * FROM SYSOBJECTS WHERE ID = OBJECT_ID('HAT510UKR_TEMP'))
	    	DROP TABLE HAT510UKR_TEMP
 
		 CREATE TABLE HAT510UKR_TEMP
		 (
		    COMP_CODE			NVARCHAR(08)	NULL
		  , DIV_CODE			NVARCHAR(08)	NULL
		  , DEPT_CODE			NVARCHAR(08)	NULL
		  , DEPT_NAME			NVARCHAR(30)	NULL
		  , PERSON_NUMB			NVARCHAR(10)	NULL
		  , NAME   				NVARCHAR(30)	NULL
		  , JOIN_DATE   		NVARCHAR(08)	NULL
		  ,	DUTY_YYYYMMDD		NVARCHAR(08)	NULL
		  ,	DUTY_CODE			NVARCHAR(02)    NOT NULL
		  ,	DUTY_NUM			NUMERIC(5,2)    NOT NULL DEFAULT 0
		
		 )
		 
		 CREATE INDEX HAT510UKR_TEMP_IDX01 ON HAT510UKR_TEMP(COMP_CODE, PERSON_NUMB, DUTY_YYYYMMDD, DUTY_CODE)
		
		 INSERT INTO HAT510UKR_TEMP
		 (
			   COMP_CODE
			 , DIV_CODE
			 , DEPT_CODE
			 , DEPT_NAME
			 , PERSON_NUMB
			 , NAME
			 , JOIN_DATE
			 , DUTY_YYYYMMDD
			 , DUTY_CODE
			 , DUTY_NUM
		 )
		
		 SELECT A.COMP_CODE
		      , C.DIV_CODE
			  , C.DEPT_CODE
			  , C.DEPT_NAME
		      , A.PERSON_NUMB
			  , C.NAME
			  , C.JOIN_DATE									--입사일
		      , A.DUTY_YYYYMMDD								--근태일자
		      , A.DUTY_CODE									--근태코드
  		      , A.DUTY_NUM + A.DUTY_TIME 
			  + CASE WHEN A.DUTY_MINU = 30
			         THEN 0.5
					 ELSE 0
				END 
		  FROM      HAT600T A WITH(NOLOCK)
		 INNER JOIN HBS600T B WITH(NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
										  AND B.DIV_CODE    = '00'
		                                  AND B.CAL_DATE    = A.DUTY_YYYYMMDD
		 INNER JOIN HUM100T C WITH(NOLOCK) ON C.COMP_CODE   = A.COMP_CODE
		                                  AND C.DIV_CODE    = #{DIV_CODE}
										  AND C.PERSON_NUMB = A.PERSON_NUMB
		 WHERE A.COMP_CODE               = #{S_COMP_CODE}
		 
		   <if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">
		   AND A.PERSON_NUMB  = #{PERSON_NUMB} 
		   </if>
		 
		   AND LEFT(A.DUTY_YYYYMMDD, 6)  = #{DUTY_YYYYMMDD} 
		   AND A.DUTY_CODE     IN ('10', '12' ,'13'			--10:경조, 12:결근, 13:무결
		                         , '20', '26' ,'27'			--20:년차, 26:반차, 27:반반차
								 , '58', '59'				--58:공가, 59:교육
								 , '51', '52', '54', '56'	--51:연장, 52:야간, 54:특근, 56:특근연장
								 , '61', '64'				--61:훈련, 64:지각
								 , 'XX')
		
		SELECT J1.DIV_CODE
			 , J1.DEPT_CODE
			 , J1.DEPT_NAME
			 , J1.PERSON_NUMB
			 , J1.NAME
			 , J1.JOIN_DATE
			-- , J1.DUTY_CODE
			
			 <foreach collection="DUTY_CODE" item="item" index="index">
			 , J6.DAY${index+1} AS ${item.BASE_CODE}
			 </foreach>	 			 
			 
			 <foreach collection="DUTY_CODE" item="item" index="index">
			 , J1.DAY${index+1} AS ${item.BASE_DATE}
			 </foreach>
			 
			 <foreach collection="DUTY_CODE" item="item" index="index">
			 , J2.DAY${index+1} AS ${item.C51_DATE}
			 </foreach> 
			 
			 <foreach collection="DUTY_CODE" item="item" index="index">
			 , J3.DAY${index+1} AS ${item.C52_DATE}
			 </foreach> 
			 
			 <foreach collection="DUTY_CODE" item="item" index="index">
			 , J4.DAY${index+1} AS ${item.C54_DATE}
			 </foreach> 
			 
			 <foreach collection="DUTY_CODE" item="item" index="index">
			 , J5.DAY${index+1} AS ${item.C56_DATE}
			 </foreach>			 
			 
			 <foreach collection="DUTY_CODE" item="item" index="index" open="," separator="+" close=" AS DUTY_51_SUM">
			 	J2.DAY${index+1}
			 </foreach>	
			 
			 <foreach collection="DUTY_CODE" item="item" index="index" open="," separator="+" close=" AS DUTY_52_SUM">
			 	J3.DAY${index+1}
			 </foreach>	
			 
			 <foreach collection="DUTY_CODE" item="item" index="index" open="," separator="+" close=" AS DUTY_54_SUM">
			 	J4.DAY${index+1}
			 </foreach>		
			 
			 <foreach collection="DUTY_CODE" item="item" index="index" open="," separator="+" close=" AS DUTY_56_SUM">
			 	J5.DAY${index+1}
			 </foreach>			    					   						  
			 	
		FROM
		(	
			 -- 기본 
			SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						--, 'DAY' AS  DUTY_CODE
						
						<foreach collection="DUTY_CODE" item="item" index="index">
						, [${item.DATE}] AS DAY${index+1}
						</foreach> 		
						
				FROM (
						SELECT DIV_CODE
							, DEPT_CODE
							, DEPT_NAME
							, PERSON_NUMB
							, NAME
							, JOIN_DATE
							, DUTY_YYYYMMDD
							, DUTY_NUM
					 
						FROM HAT510UKR_TEMP
						WHERE DUTY_CODE     IN ('10', '12' ,'13'		--10:경조, 12:결근, 13:무결
											  , '20', '26' ,'27'		--20:년차, 26:반차, 27:반반차
											  , '58', '59'				--58:공가, 59:교육
											  , '61', '64'				--61:훈련, 64:지각
											  , 'XX')
						GROUP BY DIV_CODE , DEPT_CODE , DEPT_NAME , PERSON_NUMB , NAME , JOIN_DATE, DUTY_YYYYMMDD, DUTY_NUM
				) AS T1
			PIVOT (
						SUM(DUTY_NUM) 
					FOR DUTY_YYYYMMDD IN (
						<foreach collection="DUTY_CODE" item="item"  separator=",">
						   [${item.DATE}]
						</foreach> 
					)
			) as TP1
		) AS J1
		
		LEFT JOIN (
			-- 연장
			SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						, DUTY_CODE
						<foreach collection="DUTY_CODE" item="item" index="index">
						, [${item.DATE}] AS DAY${index+1}
						</foreach> 
				FROM (
					SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						, DUTY_YYYYMMDD
						, DUTY_CODE
						, DUTY_NUM
				 
					FROM HAT510UKR_TEMP
					WHERE DUTY_CODE    = '51' -- 연장
				) AS T2
			PIVOT (
						SUM(DUTY_NUM) 
					FOR DUTY_YYYYMMDD IN (
						<foreach collection="DUTY_CODE" item="item"  separator=",">
						   [${item.DATE}]
						</foreach> 
					)
			) as TP2
		) AS J2 ON J1.PERSON_NUMB = J2.PERSON_NUMB
		
		LEFT JOIN (
			-- 야간
			SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						, DUTY_CODE
						<foreach collection="DUTY_CODE" item="item" index="index">
						, [${item.DATE}] AS DAY${index+1}
						</foreach> 		
				FROM (
					SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						, DUTY_YYYYMMDD
						, DUTY_CODE
						, DUTY_NUM
				 
					FROM HAT510UKR_TEMP
					WHERE DUTY_CODE    = '52' --  52:야간
				) AS T3
			PIVOT (
						SUM(DUTY_NUM) 
					FOR DUTY_YYYYMMDD IN (
						<foreach collection="DUTY_CODE" item="item"  separator=",">
						   [${item.DATE}]
						</foreach> 
					)
			) as TP3
		)J3 ON J1.PERSON_NUMB = J3.PERSON_NUMB
		
		LEFT JOIN (
			-- 휴일정상
			SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						, DUTY_CODE
						<foreach collection="DUTY_CODE" item="item" index="index">
						, [${item.DATE}] AS DAY${index+1}
						</foreach> 		
				FROM (
					SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						, DUTY_YYYYMMDD
						, DUTY_CODE
						, DUTY_NUM
				 
					FROM HAT510UKR_TEMP
					WHERE DUTY_CODE    = '54' --   54:특근
				) AS T4
			PIVOT (
						SUM(DUTY_NUM) 
					FOR DUTY_YYYYMMDD IN (
						<foreach collection="DUTY_CODE" item="item"  separator=",">
						   [${item.DATE}]
						</foreach> 
					)
			) as TP4
		) J4 ON J1.PERSON_NUMB = J4.PERSON_NUMB
		
		LEFT JOIN (
			--휴일연장
			SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						, DUTY_CODE
						<foreach collection="DUTY_CODE" item="item" index="index">
						, [${item.DATE}] AS DAY${index+1}
						</foreach> 		
				FROM (
					SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE
						, DUTY_YYYYMMDD
						, DUTY_CODE
						, DUTY_NUM
					FROM HAT510UKR_TEMP
					WHERE DUTY_CODE    = '56' --    56:특근연장
				) AS T5
			PIVOT (
						SUM(DUTY_NUM) 
					FOR DUTY_YYYYMMDD IN (
						<foreach collection="DUTY_CODE" item="item"  separator=",">
						   [${item.DATE}]
						</foreach> 
					)	
			) as TP5
		) AS J5 ON J1.PERSON_NUMB = J5.PERSON_NUMB
		
		
	LEFT JOIN (	
				 -- 근태코드(기본) 
				SELECT DIV_CODE
						, DEPT_CODE
						, DEPT_NAME
						, PERSON_NUMB
						, NAME
						, JOIN_DATE	  	
					  
						<foreach collection="DUTY_CODE" item="item" index="index">
						, [${item.DATE}] AS DAY${index+1}
						</foreach> 						  		
						
					FROM (
					
	
						  SELECT DIV_CODE
								, DEPT_CODE
								, DEPT_NAME
								, PERSON_NUMB
								, NAME
								, JOIN_DATE
								, DUTY_YYYYMMDD
								--, SUM(DUTY_NUM) AS DUTY_NUM
								, DUTY_CODE
								FROM (
									SELECT DIV_CODE
										, DEPT_CODE
										, DEPT_NAME
										, PERSON_NUMB
										, NAME
										, JOIN_DATE
										, DUTY_YYYYMMDD
										, CASE WHEN DUTY_NUM > 0
											   THEN B.CODE_NAME 
											   ELSE ''
											END AS DUTY_CODE
		
									FROM      HAT510UKR_TEMP A
									LEFT JOIN BSA100T        B ON B.COMP_CODE = A.COMP_CODE
									                          AND B.MAIN_CODE = 'H033'
															  AND B.SUB_CODE != '$'
															  AND B.SUB_CODE  = A.DUTY_CODE
									WHERE DUTY_CODE     IN ('10', '12' ,'13'		--10:경조, 12:결근, 13:무결
								    					  , '20', '26' ,'27'		--20:년차, 26:반차, 27:반반차
								    					  , '58', '59'				--58:공가, 59:교육
								    					  , '61', '64'				--61:훈련, 64:지각
								    					  , 'XX')
								    					  
								
									) X
								GROUP BY DIV_CODE, DEPT_CODE, DEPT_NAME, PERSON_NUMB, NAME, JOIN_DATE, DUTY_YYYYMMDD, DUTY_CODE
						
					) AS T1
				PIVOT (
							MAX(DUTY_CODE) 
						FOR DUTY_YYYYMMDD IN (
						  
						   <foreach collection="DUTY_CODE" item="item"  separator=",">
						   [${item.DATE}]
						</foreach> 
						  
						)
				) as TP1



			) AS J6 ON J1.PERSON_NUMB = J6.PERSON_NUMB
		 ORDER BY  PERSON_NUMB--, DUTY_CODE

	</select>
	
	
	
	
	
	
	
	
	
	
	
	
	<select id="s_hat510ukr_kodiServiceImpl.selectExcelUploadSheet" parameterType="Map" resultType="rMap">
        /* s_hat510ukr_kodiServiceImpl.selectExcelUploadSheet */
	SELECT _EXCEL_JOBID	
		 , _EXCEL_ROWNUM	
		   
         
		 , A.COMP_CODE       
		 , B.DIV_CODE
		 , B.DEPT_CODE
		 , B.DEPT_NAME
		 , A.DUTY_YYYYMM		
		 , A.PERSON_NUMB     
		 , B.NAME		
		 , B.JOIN_DATE	
		   
		 		   
		 , A.DUTY_CODE_01	   
		 , A.DUTY_CODE_02	   
		 , A.DUTY_CODE_03	   
		 , A.DUTY_CODE_04	   
		 , A.DUTY_CODE_05	   
		 , A.DUTY_CODE_06	   
		 , A.DUTY_CODE_07
		 , A.DUTY_CODE_08	   
		 , A.DUTY_CODE_09	   
		 , A.DUTY_CODE_10	   
		 , A.DUTY_CODE_11	   
		 , A.DUTY_CODE_12	   
		 , A.DUTY_CODE_13	   
		 , A.DUTY_CODE_14	   
		 , A.DUTY_CODE_15	   
		 , A.DUTY_CODE_16	   
		 , A.DUTY_CODE_17	   
		 , A.DUTY_CODE_18	   
		 , A.DUTY_CODE_19	   
		 , A.DUTY_CODE_20	   
		 , A.DUTY_CODE_21	   
		 , A.DUTY_CODE_22	   
		 , A.DUTY_CODE_23	   
		 , A.DUTY_CODE_24	   
		 , A.DUTY_CODE_25	   
		 , A.DUTY_CODE_26	 
		 , A.DUTY_CODE_27	   
		 , A.DUTY_CODE_28  
		 , A.DUTY_CODE_29	   
		 , A.DUTY_CODE_30		   
		 , A.DUTY_CODE_31
		 
		 , A.DUTY_NUM_BASE_01
		 , A.DUTY_NUM_BASE_02
		 , A.DUTY_NUM_BASE_03
		 , A.DUTY_NUM_BASE_04
		 , A.DUTY_NUM_BASE_05
		 , A.DUTY_NUM_BASE_06
		 , A.DUTY_NUM_BASE_07
		 , A.DUTY_NUM_BASE_08
		 , A.DUTY_NUM_BASE_09
		 , A.DUTY_NUM_BASE_10
		 , A.DUTY_NUM_BASE_11
		 , A.DUTY_NUM_BASE_12
		 , A.DUTY_NUM_BASE_13
		 , A.DUTY_NUM_BASE_14
		 , A.DUTY_NUM_BASE_15
		 , A.DUTY_NUM_BASE_16
		 , A.DUTY_NUM_BASE_17
		 , A.DUTY_NUM_BASE_18
		 , A.DUTY_NUM_BASE_19
		 , A.DUTY_NUM_BASE_20
		 , A.DUTY_NUM_BASE_21
		 , A.DUTY_NUM_BASE_22
		 , A.DUTY_NUM_BASE_23
		 , A.DUTY_NUM_BASE_24
		 , A.DUTY_NUM_BASE_25
		 , A.DUTY_NUM_BASE_26
		 , A.DUTY_NUM_BASE_27
		 , A.DUTY_NUM_BASE_28
		 , A.DUTY_NUM_BASE_29
		 , A.DUTY_NUM_BASE_30
		 , A.DUTY_NUM_BASE_31
		 
		 , A.DUTY_NUM_51_01
		 , A.DUTY_NUM_51_02
		 , A.DUTY_NUM_51_03
		 , A.DUTY_NUM_51_04
		 , A.DUTY_NUM_51_05
		 , A.DUTY_NUM_51_06
		 , A.DUTY_NUM_51_07
		 , A.DUTY_NUM_51_08
		 , A.DUTY_NUM_51_09
		 , A.DUTY_NUM_51_10
		 , A.DUTY_NUM_51_11
		 , A.DUTY_NUM_51_12
		 , A.DUTY_NUM_51_13
		 , A.DUTY_NUM_51_14
		 , A.DUTY_NUM_51_15
		 , A.DUTY_NUM_51_16
		 , A.DUTY_NUM_51_17
		 , A.DUTY_NUM_51_18
		 , A.DUTY_NUM_51_19
		 , A.DUTY_NUM_51_20
		 , A.DUTY_NUM_51_21
		 , A.DUTY_NUM_51_22
		 , A.DUTY_NUM_51_23
		 , A.DUTY_NUM_51_24
		 , A.DUTY_NUM_51_25
		 , A.DUTY_NUM_51_26
		 , A.DUTY_NUM_51_27
		 , A.DUTY_NUM_51_28
		 , A.DUTY_NUM_51_29
		 , A.DUTY_NUM_51_30
		 , A.DUTY_NUM_51_31
		 
		 , A.DUTY_NUM_52_01
		 , A.DUTY_NUM_52_02
		 , A.DUTY_NUM_52_03
		 , A.DUTY_NUM_52_04
		 , A.DUTY_NUM_52_05
		 , A.DUTY_NUM_52_06
		 , A.DUTY_NUM_52_07
		 , A.DUTY_NUM_52_08
		 , A.DUTY_NUM_52_09
		 , A.DUTY_NUM_52_10
		 , A.DUTY_NUM_52_11
		 , A.DUTY_NUM_52_12
		 , A.DUTY_NUM_52_13
		 , A.DUTY_NUM_52_14
		 , A.DUTY_NUM_52_15
		 , A.DUTY_NUM_52_16
		 , A.DUTY_NUM_52_17
		 , A.DUTY_NUM_52_18
		 , A.DUTY_NUM_52_19
		 , A.DUTY_NUM_52_20
		 , A.DUTY_NUM_52_21
		 , A.DUTY_NUM_52_22
		 , A.DUTY_NUM_52_23
		 , A.DUTY_NUM_52_24
		 , A.DUTY_NUM_52_25
		 , A.DUTY_NUM_52_26
		 , A.DUTY_NUM_52_27
		 , A.DUTY_NUM_52_28
		 , A.DUTY_NUM_52_29
		 , A.DUTY_NUM_52_30
		 , A.DUTY_NUM_52_31

		 , A.DUTY_NUM_54_01
		 , A.DUTY_NUM_54_02
		 , A.DUTY_NUM_54_03
		 , A.DUTY_NUM_54_04
		 , A.DUTY_NUM_54_05
		 , A.DUTY_NUM_54_06
		 , A.DUTY_NUM_54_07
		 , A.DUTY_NUM_54_08
		 , A.DUTY_NUM_54_09
		 , A.DUTY_NUM_54_10
		 , A.DUTY_NUM_54_11
		 , A.DUTY_NUM_54_12
		 , A.DUTY_NUM_54_13
		 , A.DUTY_NUM_54_14
		 , A.DUTY_NUM_54_15
		 , A.DUTY_NUM_54_16
		 , A.DUTY_NUM_54_17
		 , A.DUTY_NUM_54_18
		 , A.DUTY_NUM_54_19
		 , A.DUTY_NUM_54_20
		 , A.DUTY_NUM_54_21
		 , A.DUTY_NUM_54_22
		 , A.DUTY_NUM_54_23
		 , A.DUTY_NUM_54_24
		 , A.DUTY_NUM_54_25
		 , A.DUTY_NUM_54_26
		 , A.DUTY_NUM_54_27
		 , A.DUTY_NUM_54_28
		 , A.DUTY_NUM_54_29
		 , A.DUTY_NUM_54_30
		 , A.DUTY_NUM_54_31
		 
		 , A.DUTY_NUM_56_01
		 , A.DUTY_NUM_56_02
		 , A.DUTY_NUM_56_03
		 , A.DUTY_NUM_56_04
		 , A.DUTY_NUM_56_05
		 , A.DUTY_NUM_56_06
		 , A.DUTY_NUM_56_07
		 , A.DUTY_NUM_56_08
		 , A.DUTY_NUM_56_09
		 , A.DUTY_NUM_56_10
		 , A.DUTY_NUM_56_11
		 , A.DUTY_NUM_56_12
		 , A.DUTY_NUM_56_13
		 , A.DUTY_NUM_56_14
		 , A.DUTY_NUM_56_15
		 , A.DUTY_NUM_56_16
		 , A.DUTY_NUM_56_17
		 , A.DUTY_NUM_56_18
		 , A.DUTY_NUM_56_19
		 , A.DUTY_NUM_56_20
		 , A.DUTY_NUM_56_21
		 , A.DUTY_NUM_56_22
		 , A.DUTY_NUM_56_23
		 , A.DUTY_NUM_56_24
		 , A.DUTY_NUM_56_25
		 , A.DUTY_NUM_56_26
		 , A.DUTY_NUM_56_27
		 , A.DUTY_NUM_56_28
		 , A.DUTY_NUM_56_29
		 , A.DUTY_NUM_56_30
		 , A.DUTY_NUM_56_31	
	
	  FROM    L_HAT600T A WITH(NOLOCK)
	  LEFT JOIN HUM100T B WITH(NOLOCK) ON B.COMP_CODE   = A.COMP_CODE
	                                  AND B.PERSON_NUMB = A.PERSON_NUMB
		 WHERE _EXCEL_JOBID = #{_EXCEL_JOBID}
		 ORDER BY _EXCEL_JOBID, _EXCEL_ROWNUM
    </select>
	
	    <!-- Excel Upload-->
    <update id="s_hat510ukr_kodiServiceImpl.insertExcelUpload" parameterType="Map">
        /* s_hat510ukr_kodiServiceImpl.insertExcelUpload*/
        /* temp Table에 insert */    
         INSERT INTO L_HAT600T
            (
               _EXCEL_JOBID 
             , _EXCEL_ROWNUM 
             , _EXCEL_HAS_ERROR 
             , _EXCEL_ERROR_MSG
             
             , COMP_CODE       
			 , DUTY_YYYYMM		
			 , PERSON_NUMB     
			 , NAME			
	   
			, DUTY_CODE_01
			, DUTY_CODE_02
			, DUTY_CODE_03
			, DUTY_CODE_04
			, DUTY_CODE_05
			, DUTY_CODE_06
			, DUTY_CODE_07
			, DUTY_CODE_08
			, DUTY_CODE_09
			, DUTY_CODE_10
			, DUTY_CODE_11
			, DUTY_CODE_12
			, DUTY_CODE_13
			, DUTY_CODE_14
			, DUTY_CODE_15
			, DUTY_CODE_16
			, DUTY_CODE_17
			, DUTY_CODE_18
			, DUTY_CODE_19
			, DUTY_CODE_20
			, DUTY_CODE_21
			, DUTY_CODE_22
			, DUTY_CODE_23
			, DUTY_CODE_24
			, DUTY_CODE_25
			, DUTY_CODE_26
			, DUTY_CODE_27
			, DUTY_CODE_28
			, DUTY_CODE_29
			, DUTY_CODE_30
			, DUTY_CODE_31

			 , A.DUTY_NUM_BASE_01
			 , A.DUTY_NUM_BASE_02
			 , A.DUTY_NUM_BASE_03
			 , A.DUTY_NUM_BASE_04
			 , A.DUTY_NUM_BASE_05
			 , A.DUTY_NUM_BASE_06
			 , A.DUTY_NUM_BASE_07
			 , A.DUTY_NUM_BASE_08
			 , A.DUTY_NUM_BASE_09
			 , A.DUTY_NUM_BASE_10
			 , A.DUTY_NUM_BASE_11
			 , A.DUTY_NUM_BASE_12
			 , A.DUTY_NUM_BASE_13
			 , A.DUTY_NUM_BASE_14
			 , A.DUTY_NUM_BASE_15
			 , A.DUTY_NUM_BASE_16
			 , A.DUTY_NUM_BASE_17
			 , A.DUTY_NUM_BASE_18
			 , A.DUTY_NUM_BASE_19
			 , A.DUTY_NUM_BASE_20
			 , A.DUTY_NUM_BASE_21
			 , A.DUTY_NUM_BASE_22
			 , A.DUTY_NUM_BASE_23
			 , A.DUTY_NUM_BASE_24
			 , A.DUTY_NUM_BASE_25
			 , A.DUTY_NUM_BASE_26
			 , A.DUTY_NUM_BASE_27
			 , A.DUTY_NUM_BASE_28
			 , A.DUTY_NUM_BASE_29
			 , A.DUTY_NUM_BASE_30
			 , A.DUTY_NUM_BASE_31
			   
			   

			, DUTY_NUM_51_01
			, DUTY_NUM_51_02
			, DUTY_NUM_51_03
			, DUTY_NUM_51_04
			, DUTY_NUM_51_05
			, DUTY_NUM_51_06
			, DUTY_NUM_51_07
			, DUTY_NUM_51_08
			, DUTY_NUM_51_09
			, DUTY_NUM_51_10
			, DUTY_NUM_51_11
			, DUTY_NUM_51_12
			, DUTY_NUM_51_13
			, DUTY_NUM_51_14
			, DUTY_NUM_51_15
			, DUTY_NUM_51_16
			, DUTY_NUM_51_17
			, DUTY_NUM_51_18
			, DUTY_NUM_51_19
			, DUTY_NUM_51_20
			, DUTY_NUM_51_21
			, DUTY_NUM_51_22
			, DUTY_NUM_51_23
			, DUTY_NUM_51_24
			, DUTY_NUM_51_25
			, DUTY_NUM_51_26
			, DUTY_NUM_51_27
			, DUTY_NUM_51_28
			, DUTY_NUM_51_29
			, DUTY_NUM_51_30
			, DUTY_NUM_51_31

			, DUTY_NUM_52_01
			, DUTY_NUM_52_02
			, DUTY_NUM_52_03
			, DUTY_NUM_52_04
			, DUTY_NUM_52_05
			, DUTY_NUM_52_06
			, DUTY_NUM_52_07
			, DUTY_NUM_52_08
			, DUTY_NUM_52_09
			, DUTY_NUM_52_10
			, DUTY_NUM_52_11
			, DUTY_NUM_52_12
			, DUTY_NUM_52_13
			, DUTY_NUM_52_14
			, DUTY_NUM_52_15
			, DUTY_NUM_52_16
			, DUTY_NUM_52_17
			, DUTY_NUM_52_18
			, DUTY_NUM_52_19
			, DUTY_NUM_52_20
			, DUTY_NUM_52_21
			, DUTY_NUM_52_22
			, DUTY_NUM_52_23
			, DUTY_NUM_52_24
			, DUTY_NUM_52_25
			, DUTY_NUM_52_26
			, DUTY_NUM_52_27
			, DUTY_NUM_52_28
			, DUTY_NUM_52_29
			, DUTY_NUM_52_30
			, DUTY_NUM_52_31

			, DUTY_NUM_54_01
			, DUTY_NUM_54_02
			, DUTY_NUM_54_03
			, DUTY_NUM_54_04
			, DUTY_NUM_54_05
			, DUTY_NUM_54_06
			, DUTY_NUM_54_07
			, DUTY_NUM_54_08
			, DUTY_NUM_54_09
			, DUTY_NUM_54_10
			, DUTY_NUM_54_11
			, DUTY_NUM_54_12
			, DUTY_NUM_54_13
			, DUTY_NUM_54_14
			, DUTY_NUM_54_15
			, DUTY_NUM_54_16
			, DUTY_NUM_54_17
			, DUTY_NUM_54_18
			, DUTY_NUM_54_19
			, DUTY_NUM_54_20
			, DUTY_NUM_54_21
			, DUTY_NUM_54_22
			, DUTY_NUM_54_23
			, DUTY_NUM_54_24
			, DUTY_NUM_54_25
			, DUTY_NUM_54_26
			, DUTY_NUM_54_27
			, DUTY_NUM_54_28
			, DUTY_NUM_54_29
			, DUTY_NUM_54_30
			, DUTY_NUM_54_31

			, DUTY_NUM_56_01
			, DUTY_NUM_56_02
			, DUTY_NUM_56_03
			, DUTY_NUM_56_04
			, DUTY_NUM_56_05
			, DUTY_NUM_56_06
			, DUTY_NUM_56_07
			, DUTY_NUM_56_08
			, DUTY_NUM_56_09
			, DUTY_NUM_56_10
			, DUTY_NUM_56_11
			, DUTY_NUM_56_12
			, DUTY_NUM_56_13
			, DUTY_NUM_56_14
			, DUTY_NUM_56_15
			, DUTY_NUM_56_16
			, DUTY_NUM_56_17
			, DUTY_NUM_56_18
			, DUTY_NUM_56_19
			, DUTY_NUM_56_20
			, DUTY_NUM_56_21
			, DUTY_NUM_56_22
			, DUTY_NUM_56_23
			, DUTY_NUM_56_24
			, DUTY_NUM_56_25
			, DUTY_NUM_56_26
			, DUTY_NUM_56_27
			, DUTY_NUM_56_28
			, DUTY_NUM_56_29
			, DUTY_NUM_56_30
			, DUTY_NUM_56_31
            
             , INSERT_DB_USER
             , INSERT_DB_TIME
        )
        VALUES (
               #{_EXCEL_JOBID} 
             , #{_EXCEL_ROWNUM} 
             , #{_EXCEL_HAS_ERROR ,jdbcType=VARCHAR} 
             , #{_EXCEL_ERROR     ,jdbcType=VARCHAR}

			 , #{S_COMP_CODE}
			 , #{DUTY_YYYYMM}
			 , #{PERSON_NUMB}
			 , #{NAME}
                  
             , #{DUTY_CODE_01}
			 , #{DUTY_CODE_02}
			 , #{DUTY_CODE_03}
			 , #{DUTY_CODE_04}
			 , #{DUTY_CODE_05}
			 , #{DUTY_CODE_06}
			 , #{DUTY_CODE_07}
			 , #{DUTY_CODE_08}
			 , #{DUTY_CODE_09}
			 , #{DUTY_CODE_10}
			 , #{DUTY_CODE_11}
			 , #{DUTY_CODE_12}
			 , #{DUTY_CODE_13}
			 , #{DUTY_CODE_14}
			 , #{DUTY_CODE_15}
			 , #{DUTY_CODE_16}
			 , #{DUTY_CODE_17}
			 , #{DUTY_CODE_18}
			 , #{DUTY_CODE_19}
			 , #{DUTY_CODE_20}
			 , #{DUTY_CODE_21}
			 , #{DUTY_CODE_22}
			 , #{DUTY_CODE_23}
			 , #{DUTY_CODE_24}
			 , #{DUTY_CODE_25}
			 , #{DUTY_CODE_26}
			 , #{DUTY_CODE_27}
			 , #{DUTY_CODE_28}
			 , #{DUTY_CODE_29}
			 , #{DUTY_CODE_30}
			 , #{DUTY_CODE_31}
			
			
			
			, CASE WHEN #{DUTY_CODE_01} = '년차'
			       THEN '1'
			       WHEN #{DUTY_CODE_01} = '반차'
			       THEN '0.5'
			       WHEN #{DUTY_CODE_01} = '반반차'
			       THEN '0.25'
			       WHEN #{DUTY_CODE_01} = '경조'
			       THEN '1'
			       WHEN #{DUTY_CODE_01} = '무결'
			       THEN '1'
			       WHEN #{DUTY_CODE_01} = '결근'
			       THEN '1'
			       WHEN #{DUTY_CODE_01} = '공가'
			       THEN '1'
			       WHEN #{DUTY_CODE_01} = '교육'
			       THEN '1'
			       WHEN #{DUTY_CODE_01} = '훈련'
			       THEN '1'
			       WHEN #{DUTY_CODE_01} = '지각'
			       THEN '1'
			   END
			       
			, CASE WHEN  #{DUTY_CODE_02} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_02} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_02} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_02} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_02} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_02} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_02} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_02} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_02} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_02} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_03} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_03} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_03} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_03} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_03} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_03} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_03} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_03} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_03} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_03} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_04} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_04} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_04} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_04} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_04} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_04} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_04} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_04} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_04} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_04} = '지각'
			       THEN '1'
			   END 

			, CASE WHEN  #{DUTY_CODE_05} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_05} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_05} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_05} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_05} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_05} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_05} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_05} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_05} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_05} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_06} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_06} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_06} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_06} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_06} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_06} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_06} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_06} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_06} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_06} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_07} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_07} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_07} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_07} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_07} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_07} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_07} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_07} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_07} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_07} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_08} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_08} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_08} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_08} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_08} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_08} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_08} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_08} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_08} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_08} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_09} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_09} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_09} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_09} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_09} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_09} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_09} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_09} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_09} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_09} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_10} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_10} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_10} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_10} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_10} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_10} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_10} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_10} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_10} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_10} = '지각'
			       THEN '1'
			   END 

			, CASE WHEN  #{DUTY_CODE_11} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_11} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_11} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_11} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_11} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_11} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_11} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_11} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_11} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_11} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_12} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_12} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_12} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_12} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_12} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_12} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_12} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_12} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_12} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_12} = '지각'
			       THEN '1'
			   END 

			, CASE WHEN  #{DUTY_CODE_13} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_13} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_13} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_13} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_13} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_13} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_13} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_13} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_13} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_13} = '지각'
			       THEN '1'
			   END
			   
			, CASE WHEN  #{DUTY_CODE_14} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_14} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_14} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_14} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_14} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_14} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_14} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_14} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_14} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_14} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_15} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_15} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_15} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_15} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_15} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_15} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_15} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_15} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_15} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_15} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_16} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_16} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_16} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_16} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_16} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_16} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_16} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_16} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_16} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_16} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_17} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_17} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_17} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_17} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_17} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_17} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_17} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_17} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_17} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_17} = '지각'
			       THEN '1'
			   END

			, CASE WHEN  #{DUTY_CODE_18} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_18} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_18} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_18} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_18} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_18} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_18} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_18} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_18} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_18} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_19} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_19} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_19} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_19} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_19} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_19} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_19} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_19} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_19} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_19} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_20} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_20} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_20} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_20} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_20} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_20} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_20} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_20} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_20} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_20} = '지각'
			       THEN '1'
			   END
			   
			, CASE WHEN  #{DUTY_CODE_21} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_21} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_21} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_21} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_21} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_21} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_21} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_21} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_21} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_21} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_22} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_22} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_22} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_22} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_22} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_22} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_22} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_22} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_22} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_22} = '지각'
			       THEN '1'
			   END
			   
			, CASE WHEN  #{DUTY_CODE_23} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_23} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_23} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_23} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_23} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_23} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_23} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_23} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_23} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_23} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_24} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_24} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_24} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_24} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_24} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_24} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_24} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_24} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_24} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_24} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_25} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_25} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_25} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_25} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_25} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_25} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_25} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_25} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_25} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_25} = '지각'
			       THEN '1'
			   END 

			, CASE WHEN  #{DUTY_CODE_26} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_26} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_26} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_26} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_26} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_26} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_26} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_26} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_26} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_26} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_27} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_27} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_27} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_27} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_27} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_27} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_27} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_27} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_27} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_27} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_28} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_28} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_28} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_28} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_28} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_28} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_28} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_28} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_28} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_28} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_29} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_29} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_29} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_29} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_29} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_29} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_29} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_29} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_29} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_29} = '지각'
			       THEN '1'
			   END 
			   
			, CASE WHEN  #{DUTY_CODE_30} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_30} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_30} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_30} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_30} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_30} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_30} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_30} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_30} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_30} = '지각'
			       THEN '1'
			   END
			   
			, CASE WHEN  #{DUTY_CODE_31} = '년차'
			       THEN '1'
			       WHEN  #{DUTY_CODE_31} = '반차'
			       THEN '0.5'
			       WHEN  #{DUTY_CODE_31} = '반반차'
			       THEN '0.25'
			       WHEN  #{DUTY_CODE_31} = '경조'
			       THEN '1'
			       WHEN  #{DUTY_CODE_31} = '무결'
			       THEN '1'
			       WHEN  #{DUTY_CODE_31} = '결근'
			       THEN '1'
			       WHEN  #{DUTY_CODE_31} = '공가'
			       THEN '1'
			       WHEN  #{DUTY_CODE_31} = '교육'
			       THEN '1'
			       WHEN  #{DUTY_CODE_31} = '훈련'
			       THEN '1'
			       WHEN  #{DUTY_CODE_31} = '지각'
			       THEN '1'
			   END 
			
			, #{DUTY_NUM_51_01}
			, #{DUTY_NUM_51_02}
			, #{DUTY_NUM_51_03}
			, #{DUTY_NUM_51_04}
			, #{DUTY_NUM_51_05}
			, #{DUTY_NUM_51_06}
			, #{DUTY_NUM_51_07}
			, #{DUTY_NUM_51_08}
			, #{DUTY_NUM_51_09}
			, #{DUTY_NUM_51_10}
			, #{DUTY_NUM_51_11}
			, #{DUTY_NUM_51_12}
			, #{DUTY_NUM_51_13}
			, #{DUTY_NUM_51_14}
			, #{DUTY_NUM_51_15}
			, #{DUTY_NUM_51_16}
			, #{DUTY_NUM_51_17}
			, #{DUTY_NUM_51_18}
			, #{DUTY_NUM_51_19}
			, #{DUTY_NUM_51_20}
			, #{DUTY_NUM_51_21}
			, #{DUTY_NUM_51_22}
			, #{DUTY_NUM_51_23}
			, #{DUTY_NUM_51_24}
			, #{DUTY_NUM_51_25}
			, #{DUTY_NUM_51_26}
			, #{DUTY_NUM_51_27}
			, #{DUTY_NUM_51_28}
			, #{DUTY_NUM_51_29}
			, #{DUTY_NUM_51_30}
			, #{DUTY_NUM_51_31}
			
			, #{DUTY_NUM_52_01}
			, #{DUTY_NUM_52_02}
			, #{DUTY_NUM_52_03}
			, #{DUTY_NUM_52_04}
			, #{DUTY_NUM_52_05}
			, #{DUTY_NUM_52_06}
			, #{DUTY_NUM_52_07}
			, #{DUTY_NUM_52_08}
			, #{DUTY_NUM_52_09}
			, #{DUTY_NUM_52_10}
			, #{DUTY_NUM_52_11}
			, #{DUTY_NUM_52_12}
			, #{DUTY_NUM_52_13}
			, #{DUTY_NUM_52_14}
			, #{DUTY_NUM_52_15}
			, #{DUTY_NUM_52_16}
			, #{DUTY_NUM_52_17}
			, #{DUTY_NUM_52_18}
			, #{DUTY_NUM_52_19}
			, #{DUTY_NUM_52_20}
			, #{DUTY_NUM_52_21}
			, #{DUTY_NUM_52_22}
			, #{DUTY_NUM_52_23}
			, #{DUTY_NUM_52_24}
			, #{DUTY_NUM_52_25}
			, #{DUTY_NUM_52_26}
			, #{DUTY_NUM_52_27}
			, #{DUTY_NUM_52_28}
			, #{DUTY_NUM_52_29}
			, #{DUTY_NUM_52_30}
			, #{DUTY_NUM_52_31}
			
			, #{DUTY_NUM_54_01}
			, #{DUTY_NUM_54_02}
			, #{DUTY_NUM_54_03}
			, #{DUTY_NUM_54_04}
			, #{DUTY_NUM_54_05}
			, #{DUTY_NUM_54_06}
			, #{DUTY_NUM_54_07}
			, #{DUTY_NUM_54_08}
			, #{DUTY_NUM_54_09}
			, #{DUTY_NUM_54_10}
			, #{DUTY_NUM_54_11}
			, #{DUTY_NUM_54_12}
			, #{DUTY_NUM_54_13}
			, #{DUTY_NUM_54_14}
			, #{DUTY_NUM_54_15}
			, #{DUTY_NUM_54_16}
			, #{DUTY_NUM_54_17}
			, #{DUTY_NUM_54_18}
			, #{DUTY_NUM_54_19}
			, #{DUTY_NUM_54_20}
			, #{DUTY_NUM_54_21}
			, #{DUTY_NUM_54_22}
			, #{DUTY_NUM_54_23}
			, #{DUTY_NUM_54_24}
			, #{DUTY_NUM_54_25}
			, #{DUTY_NUM_54_26}
			, #{DUTY_NUM_54_27}
			, #{DUTY_NUM_54_28}
			, #{DUTY_NUM_54_29}
			, #{DUTY_NUM_54_30}
			, #{DUTY_NUM_54_31}
			
			, #{DUTY_NUM_56_01}
			, #{DUTY_NUM_56_02}
			, #{DUTY_NUM_56_03}
			, #{DUTY_NUM_56_04}
			, #{DUTY_NUM_56_05}
			, #{DUTY_NUM_56_06}
			, #{DUTY_NUM_56_07}
			, #{DUTY_NUM_56_08}
			, #{DUTY_NUM_56_09}
			, #{DUTY_NUM_56_10}
			, #{DUTY_NUM_56_11}
			, #{DUTY_NUM_56_12}
			, #{DUTY_NUM_56_13}
			, #{DUTY_NUM_56_14}
			, #{DUTY_NUM_56_15}
			, #{DUTY_NUM_56_16}
			, #{DUTY_NUM_56_17}
			, #{DUTY_NUM_56_18}
			, #{DUTY_NUM_56_19}
			, #{DUTY_NUM_56_20}
			, #{DUTY_NUM_56_21}
			, #{DUTY_NUM_56_22}
			, #{DUTY_NUM_56_23}
			, #{DUTY_NUM_56_24}
			, #{DUTY_NUM_56_25}
			, #{DUTY_NUM_56_26}
			, #{DUTY_NUM_56_27}
			, #{DUTY_NUM_56_28}
			, #{DUTY_NUM_56_29}
			, #{DUTY_NUM_56_30}
			, #{DUTY_NUM_56_31}
                       
             , #{S_USER_ID}
             , GETDATE()
        )
    </update>
    
    <!-- 임시 테이블에 insert된 데이터 조회 --> 
    <select id="s_hat510ukr_kodiServiceImpl.getData" parameterType="Map" resultType="rMap">
    	--s_hat510ukr_kodiServiceImpl.getData
        SELECT  * FROM L_HAT600T WITH(NOLOCK)
         WHERE _EXCEL_JOBID  = #{_EXCEL_JOBID}
    </select>
    
    <update id="s_hat510ukr_kodiServiceImpl.deleteDetail" parameterType="Map">
    	DELETE FROM HAT600T
		 WHERE COMP_CODE              = #{S_COMP_CODE}
		   AND LEFT(DUTY_YYYYMMDD, 6) = #{DUTY_YYYYMMDD}
    </update>
    
    
    <update id="s_hat510ukr_kodiServiceImpl.insertDetail" parameterType="Map">
    	/* s_hat510ukr_kodiServiceImpl.insertDetail */
    	
    		--근태생성
			IF NOT EXISTS (SELECT TOP 1 * FROM HAT600T WHERE COMP_CODE = #{S_COMP_CODE} AND DUTY_YYYYMMDD = #{DUTY_YYYYMMDD})
			BEGIN
    			INSERT INTO HAT600T
					(
					  COMP_CODE
					, PERSON_NUMB
					, DUTY_YYYYMMDD
					, DUTY_CODE
					, DUTY_NUM
					, DUTY_TIME
					, DUTY_MINU
					, WORK_TEAM
					, INSERT_DB_USER
					, INSERT_DB_TIME
					, UPDATE_DB_USER
					, UPDATE_DB_TIME
					)
				
					SELECT A.COMP_CODE
						,  A.PERSON_NUMB
						, #{DUTY_YYYYMMDD}
						, B.SUB_CODE
						, 0
						, 0
						, 0
						, '1'
						, #{S_USER_ID}
						, GETDATE()
						, #{S_USER_ID}
						, GETDATE()
				
					 FROM      HUM100T A 
					 LEFT JOIN BSA100T B WITH(NOLOCK) ON B.COMP_CODE = A.COMP_CODE
													 AND B.MAIN_CODE = 'H033'
													 AND B.SUB_CODE != '$'
													 AND B.USE_YN    = 'Y'
					 WHERE A.COMP_CODE     = #{S_COMP_CODE}
					   AND A.JOIN_DATE &lt;= #{DUTY_YYYYMMDD}
					   AND (A.RETR_DATE    = '00000000' OR A.RETR_DATE &gt;= #{DUTY_YYYYMMDD})          
					   AND B.SUB_CODE   IN ('10', '12' ,'13'		--10:경조, 12:결근, 13:무결
										   , '20', '26' ,'27'		--20:년차, 26:반차, 27:반반차
										   , '58', '59'				--58:공가, 59:교육
										   , '51', '52', '54', '56'	--51:연장, 52:야간, 54:특근, 56:특근연장
										   , '61', '64')			--61:훈련, 64:지각)
				
					UNION 
				
					SELECT A.COMP_CODE
						,  A.PERSON_NUMB
						, #{DUTY_YYYYMMDD}
						, 'XX'
						, 0
						, 0
						, 0
						, '1'
						, #{S_USER_ID}
						, GETDATE()
						, #{S_USER_ID}
						, GETDATE()
					 FROM HUM100T A
					WHERE A.COMP_CODE     = #{S_COMP_CODE}
					  AND A.RETR_DATE     = '00000000'
					  AND A.JOIN_DATE &lt;= #{DUTY_YYYYMMDD}
					  AND (A.RETR_DATE    = '00000000' OR A.RETR_DATE &gt;= #{DUTY_YYYYMMDD})

			END
  
    		
    	
			IF EXISTS (SELECT TOP 1 * FROM HUM100T WHERE COMP_CODE = #{S_COMP_CODE} AND PERSON_NUMB = #{PERSON_NUMB})
			BEGIN
		   		   	
				--기본근태
				IF EXISTS (SELECT TOP 1 * FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE=N'H033' AND CODE_NAME = #{DUTY_CODE_NAME})
				BEGIN
			 
					UPDATE HAT600T
					   SET DUTY_NUM = #{DUTY_NUM_BASE}
					 WHERE COMP_CODE		= #{S_COMP_CODE}
					   AND PERSON_NUMB		= #{PERSON_NUMB}
					   AND DUTY_YYYYMMDD    = #{DUTY_YYYYMMDD}
					   AND DUTY_CODE = (SELECT SUB_CODE
						  			 	  FROM BSA100T 
						  				 WHERE COMP_CODE = #{S_COMP_CODE}
						   				   AND MAIN_CODE = 'H033'
						   				   AND SUB_CODE != '$'
						   				   AND CODE_NAME = #{DUTY_CODE_NAME})
									     
			    END
			    
			    --연장
			    UPDATE HAT600T
					   SET DUTY_TIME = CONVERT(INT, #{DUTY_NUM_51})
					     , DUTY_MINU = CASE WHEN SUBSTRING(CONVERT(NVARCHAR(05), #{DUTY_NUM_51}), CHARINDEX('.', CONVERT(NVARCHAR(05), #{DUTY_NUM_51})) + 1, LEN(CONVERT(NVARCHAR(05), #{DUTY_NUM_51}))) = '5'
									        THEN 30
											ELSE 0
										END	 
					 WHERE COMP_CODE		= #{S_COMP_CODE}
					   AND PERSON_NUMB		= #{PERSON_NUMB}
					   AND DUTY_YYYYMMDD    = #{DUTY_YYYYMMDD}
					   AND DUTY_CODE        = '51'
					   
			    

			    
			    --야간
			    UPDATE HAT600T
				   SET DUTY_TIME = CONVERT(INT, #{DUTY_NUM_52})
				     , DUTY_MINU = CASE WHEN SUBSTRING(CONVERT(NVARCHAR(05), #{DUTY_NUM_52}), CHARINDEX('.', CONVERT(NVARCHAR(05), #{DUTY_NUM_52})) + 1, LEN(CONVERT(NVARCHAR(05), #{DUTY_NUM_52}))) = '5'
								        THEN 30
										ELSE 0
									END	 
				 WHERE COMP_CODE		= #{S_COMP_CODE}
				   AND PERSON_NUMB		= #{PERSON_NUMB}
				   AND DUTY_YYYYMMDD    = #{DUTY_YYYYMMDD}
				   AND DUTY_CODE        = '52'
					   
			
			    --휴일정상
		    	UPDATE HAT600T
				   SET DUTY_TIME = CONVERT(INT, #{DUTY_NUM_54})
				     , DUTY_MINU = CASE WHEN SUBSTRING(CONVERT(NVARCHAR(05), #{DUTY_NUM_54}), CHARINDEX('.', CONVERT(NVARCHAR(05), #{DUTY_NUM_54})) + 1, LEN(CONVERT(NVARCHAR(05), #{DUTY_NUM_54}))) = '5'
								        THEN 30
										ELSE 0
									END	 
				 WHERE COMP_CODE		= #{S_COMP_CODE}
				   AND PERSON_NUMB		= #{PERSON_NUMB}
				   AND DUTY_YYYYMMDD    = #{DUTY_YYYYMMDD}
				   AND DUTY_CODE        = '54'
			  

			    --휴일연장
			    UPDATE HAT600T
				   SET DUTY_TIME = CONVERT(INT, #{DUTY_NUM_56})
				     , DUTY_MINU = CASE WHEN SUBSTRING(CONVERT(NVARCHAR(05), #{DUTY_NUM_56}), CHARINDEX('.', CONVERT(NVARCHAR(05), #{DUTY_NUM_56})) + 1, LEN(CONVERT(NVARCHAR(05), #{DUTY_NUM_56}))) = '5'
								        THEN 30
										ELSE 0
									END	 
				 WHERE COMP_CODE		= #{S_COMP_CODE}
				   AND PERSON_NUMB		= #{PERSON_NUMB}
				   AND DUTY_YYYYMMDD    = #{DUTY_YYYYMMDD}
				   AND DUTY_CODE        = '56'
					   
			END


	</update>
    
    
    
</mapper>