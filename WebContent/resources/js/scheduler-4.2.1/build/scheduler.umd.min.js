/*!
 *
 * Bryntum Scheduler 4.2.1
 *
 * Copyright(c) 2021 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("scheduler",[],t):"object"==typeof exports?exports.scheduler=t():(e.bryntum=e.bryntum||{},e.bryntum.scheduler=t())}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=454)}([function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(276);function i(t,n,o){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},e.exports.default=e.exports,e.exports.__esModule=!0),i(t,n,o||t)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(219);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(13).default,i=n(137);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){e.exports=n(31)},function(e,t,n){var r=n(438),i=n(439),o=n(274),a=n(440);e.exports=function(e){return r(e)||i(e)||o(e)||a()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));n(17),n(23),n(253),n(16),n(117),n(32),n(88),n(22),n(124),n(181),n(85),n(446),n(18),n(218);var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=function(){function t(){i()(this,t)}return a()(t,null,[{key:"cacheFlags",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.platform,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:navigator.userAgent,n=this;n._isLinux=Boolean(e.match(/Linux/)),n._isMac=Boolean(e.match(/Mac/)),n._isWindows=Boolean(e.match(/Win32/)),n._isIE11=Boolean(t.match(/rv:11/)),n._edgeVersion=n.getVersion(t,/Edge?\/(\d+)\./),n._isEdge=n._edgeVersion>0&&n._edgeVersion<80,n._isEdge||(n._edgeVersion=0),n._isWebkit=Boolean(t.match(/WebKit/))&&!n._isEdge,n._firefoxVersion=n.getVersion(t,/Firefox\/(\d+)\./),n._isFirefox=n._firefoxVersion>0,n._chromeVersion=n._isEdge?0:n.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),n._isChrome=n._chromeVersion>0,n._isSafari=Boolean(t.match(/Safari/))&&!n._isChrome&&!n._isEdge,n._isMobileSafari=Boolean(t.match(/Mobile.*Safari/)),n._isAndroid=Boolean(t.match(/Android/g));try{document.querySelector(":scope"),n.supportsQueryScope=!n._isFirefox}catch(e){n.supportsQueryScope=!1}n._supportsPassive=!1;try{document.addEventListener("__notvalid__",null,{get passive(){n._supportsPassive=!0}})}catch(e){}}},{key:"supportsSticky",get:function(){return!this._isIE11}},{key:"getVersion",value:function(e,t){var n=e.match(t);return n?parseInt(n[1]):0}},{key:"isTouchDevice",get:function(){return"_isTouchDevice"in this?this._isTouchDevice:"ontouchstart"in window||!this.isEdge&&navigator.maxTouchPoints>0||this.isEdge&&window.TouchEvent||navigator.msMaxTouchPoints>0},set:function(e){this._isTouchDevice=e}},{key:"supportsPointerEvents",get:function(){return Boolean(window.PointerEvent||window.MSPointerEvent)}},{key:"isHoverableDevice",get:function(){return void 0===this._isHoverableDevice&&(this._isHoverableDevice=window.matchMedia("(any-hover: hover)").matches),this._isHoverableDevice}},{key:"isBrowserEnv",get:function(){return"undefined"!=typeof window}},{key:"isMac",get:function(){return this._isMac}},{key:"isWindows",get:function(){return this._isWindows}},{key:"isLinux",get:function(){return this._isLinux}},{key:"isAndroid",get:function(){return this._isAndroid}},{key:"isIE11",get:function(){return this._isIE11}},{key:"isEdge",get:function(){return this._isEdge}},{key:"edgeVersion",get:function(){return this._edgeVersion}},{key:"isWebkit",get:function(){return this._isWebkit}},{key:"isChrome",get:function(){return this._isChrome}},{key:"chromeVersion",get:function(){return this._chromeVersion}},{key:"isFirefox",get:function(){return this._isFirefox}},{key:"firefoxVersion",get:function(){return this._firefoxVersion}},{key:"isSafari",get:function(){return this._isSafari}},{key:"isMobileSafari",get:function(){return this._isMobileSafari}},{key:"supportsPassive",get:function(){return this._supportsPassive}},{key:"storageAvailable",get:function(){var e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}},{key:"setLocalStorageItem",value:function(e,t){this.storageAvailable&&localStorage.setItem(e,t)}},{key:"getLocalStorageItem",value:function(e){return this.storageAvailable&&localStorage.getItem(e)}},{key:"removeLocalStorageItem",value:function(e){this.storageAvailable&&localStorage.removeItem(e)}},{key:"searchParam",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.location.search,r=new RegExp("[?&]".concat(e,"=([^&]*)")),i=n.match(r);return i&&i[1]||t}},{key:"getCookie",value:function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""}},{key:"download",value:function(e,t){var n=document.createElement("a");n.download=e,n.href=t||e,n.style.cssText="display:none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"downloadBlob",value:function(e,t){var n=window.URL.createObjectURL(e);this.download(t,n),window.URL.revokeObjectURL(n)}},{key:"queryString",get:function(){if(this.isBrowserEnv){var e,t=new URL(window.location.href).searchParams;return null===(e=Object.fromEntries)||void 0===e?void 0:e.call(Object,t.entries())}}},{key:"global",get:function(){return this.isBrowserEnv?window:void 0!==e?e:globalThis||{}}},{key:"copyToClipboard",value:function(e){var t=!0,n=document.createElement("textarea");n.value=e,n.style.height=n.style.width=0,document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(e){t=!1}return n.remove(),t}}]),t}();s.isBrowserEnv&&s.cacheFlags(),s._$name="BrowserHelper"}).call(this,n(184))},function(e,t,n){var r=n(55),i=n(96).f,o=n(98),a=n(99),s=n(186),l=n(222),u=n(150);e.exports=function(e,t){var n,c,f,d,h,v=e.target,p=e.global,g=e.stat;if(n=p?r:g?r[v]||s(v,{}):(r[v]||{}).prototype)for(c in t){if(d=t[c],f=e.noTargetGet?(h=i(n,c))&&h.value:n[c],!u(p?c:v+(g?".":"#")+c,e.forced)&&void 0!==f){if(typeof d==typeof f)continue;l(d,f)}(e.sham||f&&f.sham)&&o(d,"sham",!0),a(n,c,d,e)}}},function(e,t,n){"use strict";var r=n(11),i=n(30),o=n(131),a=n(57),s=n(86),l=n(78),u=n(132),c=n(153),f=n(157),d=n(63),h=n(139),v=d("isConcatSpreadable"),p=9007199254740991,g="Maximum allowed index exceeded",y=h>=51||!i((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),m=f("concat"),b=function(e){if(!a(e))return!1;var t=e[v];return void 0!==t?!!t:o(e)};r({target:"Array",proto:!0,forced:!y||!m},{concat:function(e){var t,n,r,i,o,a=s(this),f=c(a,0),d=0;for(t=-1,r=arguments.length;t<r;t++)if(b(o=-1===t?a:arguments[t])){if(d+(i=l(o.length))>p)throw TypeError(g);for(n=0;n<i;n++,d++)n in o&&u(f,d,o[n])}else{if(d>=p)throw TypeError(g);u(f,d++,o)}return f.length=d,f}})},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(55),i=n(272),o=n(233),a=n(98);for(var s in i){var l=r[s],u=l&&l.prototype;if(u&&u.forEach!==o)try{a(u,"forEach",o)}catch(e){u.forEach=o}}},function(e,t,n){var r=n(442),i=n(443),o=n(274),a=n(444);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(197),i=n(99),o=n(362);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(e,t,n){"use strict";var r=n(108),i=n(127),o=n(154),a=n(102),s=n(200),l="Array Iterator",u=a.set,c=a.getterFor(l);e.exports=s(Array,"Array",(function(e,t){u(this,{type:l,target:r(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,n){var r=n(55),i=n(272),o=n(17),a=n(98),s=n(63),l=s("iterator"),u=s("toStringTag"),c=o.values;for(var f in i){var d=r[f],h=d&&d.prototype;if(h){if(h[l]!==c)try{a(h,l,c)}catch(e){h[l]=c}if(h[u]||a(h,u,f),i[f])for(var v in o)if(h[v]!==o[v])try{a(h,v,o[v])}catch(e){h[v]=o[v]}}}},function(e,t,n){"use strict";var r=n(11),i=n(95).map;r({target:"Array",proto:!0,forced:!n(157)("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(11),i=n(250);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));n(12),n(32),n(84);var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(10),l="scheduler",u=!1;try{u=Boolean(s.a.global.parent&&s.a.global.parent.Siesta||void 0!==e&&(s.a.global.StartTest||s.a.global.Siesta))}catch(e){}u&&(s.a._isHoverableDevice=!0);var c=function(){function e(){i()(this,e)}return a()(e,null,[{key:"setVersion",value:function(e,t){e=e.toLowerCase(),f[e]={version:t,isNewerThan:function(e){return e<t},isOlderThan:function(e){return e>t}};var n="".concat(l,".").concat(e).concat(t.replace(/\./g,"-"));if(s.a.isBrowserEnv&&!s.a.global.bryntum.silenceBundleException)if(!0===window.bryntum[n]){if(!u)throw new Error('Bryntum bundle included twice, check cache-busters and file types (.js).\nSimultaneous imports from "*.module.js" and "*.umd.js" bundles are not allowed.');window.BUNDLE_EXCEPTION=!0}else window.bryntum[n]=!0}},{key:"getVersion",value:function(e){if(e=e.toLowerCase(),!f[e])throw new Error("No version specified! Please check that you import VersionHelper right into the class from where you call `deprecate` function.");return f[e].version}},{key:"checkVersion",value:function(e,t,n){var r,i=f.getVersion(e);switch(n){case"<":r=i<t;break;case"<=":r=i<=t;break;case"=":r=i===t;break;case">=":r=i>=t;break;case">":r=i>t}return r}},{key:"deprecate",value:function(e,t,n){if(!f.checkVersion(e,t,"<"))throw new Error("Deprecated API use. ".concat(n));console.warn("Deprecation warning: You are using a deprecated API which will change in v".concat(t,". ").concat(n))}},{key:"isTestEnv",get:function(){return u}},{key:"isDebug",get:function(){return!1}}]),e}(),f=c;s.a.isBrowserEnv&&((window.bryntum||(window.bryntum={})).getVersion=f.getVersion.bind(f),window.bryntum.checkVersion=f.checkVersion.bind(f),window.bryntum.deprecate=f.deprecate.bind(f),window.bryntum.isTestEnv=f.isTestEnv),c._$name="VersionHelper"}).call(this,n(445))},function(e,t,n){"use strict";var r=n(163).charAt,i=n(102),o=n(200),a="String Iterator",s=i.set,l=i.getterFor(a);o(String,"String",(function(e){s(this,{type:a,string:String(e),index:0})}),(function(){var e,t=l(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t,n){var r=n(62),i=n(82).f,o=Function.prototype,a=o.toString,s=/^\s*function ([^ (]*)/,l="name";r&&!(l in o)&&i(o,l,{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(11),i=n(149).includes,o=n(127);r({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(e,t,n){var r=n(57);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){"use strict";var r=n(11),i=n(212),o=n(97);r({target:"String",proto:!0,forced:!n(213)("includes")},{includes:function(e){return!!~String(o(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(11),i=n(95).filter;r({target:"Array",proto:!0,forced:!n(157)("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(276),i=n(6);function o(e,t,n,a){return(o="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,o){var a,s=r(e,t);if(s){if((a=Object.getOwnPropertyDescriptor(s,t)).set)return a.set.call(o,n),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(o,t)){if(!a.writable)return!1;a.value=n,Object.defineProperty(o,t,a)}else i(o,t,n);return!0})(e,t,n,a)}e.exports=function(e,t,n,r,i){if(!o(e,t,n,r||e)&&i)throw new Error("failed to set property");return n},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(11),i=n(57),o=n(131),a=n(126),s=n(78),l=n(108),u=n(132),c=n(63),f=n(157)("slice"),d=c("species"),h=[].slice,v=Math.max;r({target:"Array",proto:!0,forced:!f},{slice:function(e,t){var n,r,c,f=l(this),p=s(f.length),g=a(e,p),y=a(void 0===t?p:t,p);if(o(f)&&("function"!=typeof(n=f.constructor)||n!==Array&&!o(n.prototype)?i(n)&&null===(n=n[d])&&(n=void 0):n=void 0,n===Array||void 0===n))return h.call(f,g,y);for(r=new(void 0===n?Array:n)(v(y-g,0)),c=0;g<y;g++,c++)g in f&&u(r,c,f[g]);return r.length=c,r}})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),a=new T(r||[]);return o._invoke=function(e,t,n){var r=f;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===v){if("throw"===i)throw o;return M()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var l=c(e,t,n);if("normal"===l.type){if(r=n.done?v:d,l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=v,n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var f="suspendedStart",d="suspendedYield",h="executing",v="completed",p={};function g(){}function y(){}function m(){}var b={};b[o]=function(){return this};var k=Object.getPrototypeOf,w=k&&k(k(O([])));w&&w!==n&&r.call(w,o)&&(b=w);var C=m.prototype=g.prototype=Object.create(b);function R(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,o,a,s){var l=c(e[i],e,o);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(f).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function x(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=c(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function O(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:M}}function M(){return{value:t,done:!0}}return y.prototype=C.constructor=m,m.constructor=y,y.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,s,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},R(S.prototype),S.prototype[a]=function(){return this},e.AsyncIterator=S,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new S(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},R(C),l(C,s,"Generator"),C[o]=function(){return this},C.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=O,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;D(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";var r=n(11),i=n(177);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(e,t,n){"use strict";var r=n(11),i=n(59),o=n(86),a=n(30),s=n(123),l=[],u=l.sort,c=a((function(){l.sort(void 0)})),f=a((function(){l.sort(null)})),d=s("sort");r({target:"Array",proto:!0,forced:c||!f||!d},{sort:function(e){return void 0===e?u.call(o(this)):u.call(o(this),i(e))}})},function(e,t,n){"use strict";var r=n(11),i=n(95).find,o=n(127),a="find",s=!0;a in[]&&Array(1).find((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(a)},function(e,t,n){"use strict";var r=n(11),i=n(146),o=n(108),a=n(123),s=[].join,l=i!=Object,u=a("join",",");r({target:"Array",proto:!0,forced:l||!u},{join:function(e){return s.call(o(this),void 0===e?",":e)}})},function(e,t){e.exports=!1},function(e,t,n){"use strict";var r=n(170),i=n(241);e.exports=r("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(449);r({target:"Set",proto:!0,real:!0,forced:i},{addAll:function(){return o.apply(this,arguments)}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(217);r({target:"Set",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(94),u=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{difference:function(e){var t=a(this),n=new(l(t,o("Set")))(t),r=s(n.delete);return u(e,(function(e){r.call(n,e)})),n}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(93),s=n(136),l=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{every:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return!l(n,(function(e,n){if(!r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(93),u=n(94),c=n(136),f=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{filter:function(e){var t=a(this),n=c(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(u(t,o("Set"))),d=s(i.add);return f(n,(function(e){r(e,e,t)&&d.call(i,e)}),{IS_ITERATOR:!0}),i}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(93),s=n(136),l=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{find:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n){if(r(e,e,t))return n(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(94),u=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{intersection:function(e){var t=a(this),n=new(l(t,o("Set"))),r=s(t.has),i=s(n.add);return u(e,(function(e){r.call(t,e)&&i.call(n,e)})),n}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(59),s=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:function(e){var t=o(this),n=a(t.has);return!s(e,(function(e,r){if(!0===n.call(t,e))return r()}),{INTERRUPTED:!0}).stopped}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(182),u=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:function(e){var t=l(this),n=a(e),r=n.has;return"function"!=typeof r&&(n=new(o("Set"))(e),r=s(n.has)),!u(t,(function(e,t){if(!1===r.call(n,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(59),s=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:function(e){var t=o(this),n=a(t.has);return!s(e,(function(e,r){if(!1===n.call(t,e))return r()}),{INTERRUPTED:!0}).stopped}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(136),s=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{join:function(e){var t=o(this),n=a(t),r=void 0===e?",":String(e),i=[];return s(n,i.push,{that:i,IS_ITERATOR:!0}),i.join(r)}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(93),u=n(94),c=n(136),f=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{map:function(e){var t=a(this),n=c(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(u(t,o("Set"))),d=s(i.add);return f(n,(function(e){d.call(i,r(e,e,t))}),{IS_ITERATOR:!0}),i}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(59),s=n(136),l=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{reduce:function(e){var t=o(this),n=s(t),r=arguments.length<2,i=r?void 0:arguments[1];if(a(e),l(n,(function(n){r?(r=!1,i=n):i=e(i,n,n,t)}),{IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty set with no initial value");return i}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(93),s=n(136),l=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{some:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n){if(r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(94),u=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:function(e){var t=a(this),n=new(l(t,o("Set")))(t),r=s(n.delete),i=s(n.add);return u(e,(function(e){r.call(n,e)||i.call(n,e)})),n}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(94),u=n(60);r({target:"Set",proto:!0,real:!0,forced:i},{union:function(e){var t=a(this),n=new(l(t,o("Set")))(t);return u(e,s(n.add),{that:n}),n}})},function(e,t,n){"use strict";var r=n(11),i=n(126),o=n(111),a=n(78),s=n(86),l=n(153),u=n(132),c=n(157)("splice"),f=Math.max,d=Math.min,h=9007199254740991,v="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!c},{splice:function(e,t){var n,r,c,p,g,y,m=s(this),b=a(m.length),k=i(e,b),w=arguments.length;if(0===w?n=r=0:1===w?(n=0,r=b-k):(n=w-2,r=d(f(o(t),0),b-k)),b+n-r>h)throw TypeError(v);for(c=l(m,r),p=0;p<r;p++)(g=k+p)in m&&u(c,p,m[g]);if(c.length=r,n<r){for(p=k;p<b-r;p++)y=p+n,(g=p+r)in m?m[y]=m[g]:delete m[y];for(p=b;p>b-r+n;p--)delete m[p-1]}else if(n>r)for(p=b-r;p>k;p--)y=p+n-1,(g=p+r-1)in m?m[y]=m[g]:delete m[y];for(p=0;p<n;p++)m[p+k]=arguments[p+2];return m.length=b-r+n,c}})},function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n(184))},function(e,t,n){var r=n(11),i=n(86),o=n(152);r({target:"Object",stat:!0,forced:n(30)((function(){o(1)}))},{keys:function(e){return o(i(e))}})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";var r,i,o,a,s=n(11),l=n(36),u=n(55),c=n(89),f=n(257),d=n(99),h=n(142),v=n(122),p=n(115),g=n(141),y=n(57),m=n(59),b=n(128),k=n(187),w=n(60),C=n(167),R=n(94),S=n(258).set,x=n(365),E=n(260),D=n(367),T=n(176),O=n(209),M=n(102),A=n(150),I=n(63),P=n(368),F=n(158),L=n(139),B=I("species"),j="Promise",_=M.get,H=M.set,N=M.getterFor(j),z=f&&f.prototype,V=f,W=z,$=u.TypeError,U=u.document,G=u.process,Y=T.f,q=Y,K=!!(U&&U.createEvent&&u.dispatchEvent),X="function"==typeof PromiseRejectionEvent,Z="unhandledrejection",J=!1,Q=A(j,(function(){var e=k(V)!==String(V);if(!e&&66===L)return!0;if(l&&!W.finally)return!0;if(L>=51&&/native code/.test(V))return!1;var t=new V((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(t.constructor={})[B]=n,!(J=t.then((function(){}))instanceof n)||!e&&P&&!X})),ee=Q||!C((function(e){V.all(e).catch((function(){}))})),te=function(e){var t;return!(!y(e)||"function"!=typeof(t=e.then))&&t},ne=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;x((function(){for(var r=e.value,i=1==e.state,o=0;n.length>o;){var a,s,l,u=n[o++],c=i?u.ok:u.fail,f=u.resolve,d=u.reject,h=u.domain;try{c?(i||(2===e.rejection&&ae(e),e.rejection=1),!0===c?a=r:(h&&h.enter(),a=c(r),h&&(h.exit(),l=!0)),a===u.promise?d($("Promise-chain cycle")):(s=te(a))?s.call(a,f,d):f(a)):d(r)}catch(e){h&&!l&&h.exit(),d(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&ie(e)}))}},re=function(e,t,n){var r,i;K?((r=U.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),u.dispatchEvent(r)):r={promise:t,reason:n},!X&&(i=u["on"+e])?i(r):e===Z&&D("Unhandled promise rejection",n)},ie=function(e){S.call(u,(function(){var t,n=e.facade,r=e.value;if(oe(e)&&(t=O((function(){F?G.emit("unhandledRejection",r,n):re(Z,n,r)})),e.rejection=F||oe(e)?2:1,t.error))throw t.value}))},oe=function(e){return 1!==e.rejection&&!e.parent},ae=function(e){S.call(u,(function(){var t=e.facade;F?G.emit("rejectionHandled",t):re("rejectionhandled",t,e.value)}))},se=function(e,t,n){return function(r){e(t,r,n)}},le=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ne(e,!0))},ue=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw $("Promise can't be resolved itself");var r=te(t);r?x((function(){var n={done:!1};try{r.call(t,se(ue,n,e),se(le,n,e))}catch(t){le(n,t,e)}})):(e.value=t,e.state=1,ne(e,!1))}catch(t){le({done:!1},t,e)}}};if(Q&&(W=(V=function(e){b(this,V,j),m(e),r.call(this);var t=_(this);try{e(se(ue,t),se(le,t))}catch(e){le(t,e)}}).prototype,(r=function(e){H(this,{type:j,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=h(W,{then:function(e,t){var n=N(this),r=Y(R(this,V));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=F?G.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&ne(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=_(e);this.promise=e,this.resolve=se(ue,t),this.reject=se(le,t)},T.f=Y=function(e){return e===V||e===o?new i(e):q(e)},!l&&"function"==typeof f&&z!==Object.prototype)){a=z.then,J||(d(z,"then",(function(e,t){var n=this;return new V((function(e,t){a.call(n,e,t)})).then(e,t)}),{unsafe:!0}),d(z,"catch",W.catch,{unsafe:!0}));try{delete z.constructor}catch(e){}v&&v(z,W)}s({global:!0,wrap:!0,forced:Q},{Promise:V}),p(V,j,!1,!0),g(j),o=c(j),s({target:j,stat:!0,forced:Q},{reject:function(e){var t=Y(this);return t.reject.call(void 0,e),t.promise}}),s({target:j,stat:!0,forced:l||Q},{resolve:function(e){return E(l&&this===o?V:this,e)}}),s({target:j,stat:!0,forced:ee},{all:function(e){var t=this,n=Y(t),r=n.resolve,i=n.reject,o=O((function(){var n=m(t.resolve),o=[],a=0,s=1;w(e,(function(e){var l=a++,u=!1;o.push(void 0),s++,n.call(t,e).then((function(e){u||(u=!0,o[l]=e,--s||r(o))}),i)})),--s||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=Y(t),r=n.reject,i=O((function(){var i=m(t.resolve);w(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var r=n(25),i=n(196),o=n(78),a=n(93),s=n(155),l=n(230),u=function(e,t){this.stopped=e,this.result=t};e.exports=function(e,t,n){var c,f,d,h,v,p,g,y=n&&n.that,m=!(!n||!n.AS_ENTRIES),b=!(!n||!n.IS_ITERATOR),k=!(!n||!n.INTERRUPTED),w=a(t,y,1+m+k),C=function(e){return c&&l(c),new u(!0,e)},R=function(e){return m?(r(e),k?w(e[0],e[1],C):w(e[0],e[1])):k?w(e,C):w(e)};if(b)c=e;else{if("function"!=typeof(f=s(e)))throw TypeError("Target is not iterable");if(i(f)){for(d=0,h=o(e.length);h>d;d++)if((v=R(e[d]))&&v instanceof u)return v;return new u(!1)}c=f.call(e)}for(p=c.next;!(g=p.call(c)).done;){try{v=R(g.value)}catch(e){throw l(c),e}if("object"==typeof v&&v&&v instanceof u)return v}return new u(!1)}},function(e,t,n){"use strict";var r=n(170),i=n(241);e.exports=r("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,n){var r=n(30);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){var r=n(55),i=n(166),o=n(90),a=n(147),s=n(193),l=n(224),u=i("wks"),c=r.Symbol,f=l?c:c&&c.withoutSetter||a;e.exports=function(e){return o(u,e)&&(s||"string"==typeof u[e])||(s&&o(c,e)?u[e]=c[e]:u[e]=f("Symbol."+e)),u[e]}},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(217);r({target:"Map",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(93),s=n(118),l=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{every:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return!l(n,(function(e,n,i){if(!r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(93),u=n(94),c=n(118),f=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{filter:function(e){var t=a(this),n=c(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(u(t,o("Map"))),d=s(i.set);return f(n,(function(e,n){r(n,e,t)&&d.call(i,e,n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(93),s=n(118),l=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{find:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n,i){if(r(n,e,t))return i(n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(93),s=n(118),l=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{findKey:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n,i){if(r(n,e,t))return i(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(118),s=n(441),l=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{includes:function(e){return l(a(o(this)),(function(t,n,r){if(s(n,e))return r()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(118),s=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{keyOf:function(e){return s(a(o(this)),(function(t,n,r){if(n===e)return r(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(93),u=n(94),c=n(118),f=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{mapKeys:function(e){var t=a(this),n=c(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(u(t,o("Map"))),d=s(i.set);return f(n,(function(e,n){d.call(i,r(n,e,t),n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(89),a=n(25),s=n(59),l=n(93),u=n(94),c=n(118),f=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{mapValues:function(e){var t=a(this),n=c(t),r=l(e,arguments.length>1?arguments[1]:void 0,3),i=new(u(t,o("Map"))),d=s(i.set);return f(n,(function(e,n){d.call(i,e,r(n,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(59),s=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{merge:function(e){for(var t=o(this),n=a(t.set),r=0;r<arguments.length;)s(arguments[r++],n,{that:t,AS_ENTRIES:!0});return t}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(59),s=n(118),l=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{reduce:function(e){var t=o(this),n=s(t),r=arguments.length<2,i=r?void 0:arguments[1];if(a(e),l(n,(function(n,o){r?(r=!1,i=o):i=e(i,o,n,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty map with no initial value");return i}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(93),s=n(118),l=n(60);r({target:"Map",proto:!0,real:!0,forced:i},{some:function(e){var t=o(this),n=s(t),r=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n,i){if(r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(25),a=n(59);r({target:"Map",proto:!0,real:!0,forced:i},{update:function(e,t){var n=o(this),r=arguments.length;a(t);var i=n.has(e);if(!i&&r<3)throw TypeError("Updating absent value");var s=i?n.get(e):a(r>2?arguments[2]:void 0)(e,n);return n.set(e,t(s,e,n)),n}})},function(e,t,n){"use strict";var r,i=n(202),o=n(62),a=n(55),s=n(57),l=n(90),u=n(156),c=n(98),f=n(99),d=n(82).f,h=n(112),v=n(122),p=n(63),g=n(147),y=a.Int8Array,m=y&&y.prototype,b=a.Uint8ClampedArray,k=b&&b.prototype,w=y&&h(y),C=m&&h(m),R=Object.prototype,S=R.isPrototypeOf,x=p("toStringTag"),E=g("TYPED_ARRAY_TAG"),D=i&&!!v&&"Opera"!==u(a.opera),T=!1,O={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},M={BigInt64Array:8,BigUint64Array:8},A=function(e){if(!s(e))return!1;var t=u(e);return l(O,t)||l(M,t)};for(r in O)a[r]||(D=!1);if((!D||"function"!=typeof w||w===Function.prototype)&&(w=function(){throw TypeError("Incorrect invocation")},D))for(r in O)a[r]&&v(a[r],w);if((!D||!C||C===R)&&(C=w.prototype,D))for(r in O)a[r]&&v(a[r].prototype,C);if(D&&h(k)!==C&&v(k,C),o&&!l(C,x))for(r in T=!0,d(C,x,{get:function(){return s(this)?this[E]:void 0}}),O)a[r]&&c(a[r],E,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:D,TYPED_ARRAY_TAG:T&&E,aTypedArray:function(e){if(A(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(v){if(S.call(w,e))return e}else for(var t in O)if(l(O,r)){var n=a[t];if(n&&(e===n||S.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(o){if(n)for(var r in O){var i=a[r];if(i&&l(i.prototype,e))try{delete i.prototype[e]}catch(e){}}C[e]&&!n||f(C,e,n?t:D&&m[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(o){if(v){if(n)for(r in O)if((i=a[r])&&l(i,e))try{delete i[e]}catch(e){}if(w[e]&&!n)return;try{return f(w,e,n?t:D&&w[e]||t)}catch(e){}}for(r in O)!(i=a[r])||i[e]&&!n||f(i,e,t)}},isView:function(e){if(!s(e))return!1;var t=u(e);return"DataView"===t||l(O,t)||l(M,t)},isTypedArray:A,TypedArray:w,TypedArrayPrototype:C}},function(e,t,n){var r=n(111),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(11),i=n(234);r({target:"Array",stat:!0,forced:!n(167)((function(e){Array.from(e)}))},{from:i})},function(e,t,n){var r=n(11),i=n(252).values;r({target:"Object",stat:!0},{values:function(e){return i(e)}})},function(e,t,n){"use strict";var r=n(11),i=n(55),o=n(89),a=n(36),s=n(62),l=n(193),u=n(224),c=n(30),f=n(90),d=n(131),h=n(57),v=n(25),p=n(86),g=n(108),y=n(114),m=n(120),b=n(116),k=n(152),w=n(130),C=n(226),R=n(192),S=n(96),x=n(82),E=n(164),D=n(98),T=n(99),O=n(166),M=n(165),A=n(148),I=n(147),P=n(63),F=n(227),L=n(105),B=n(115),j=n(102),_=n(95).forEach,H=M("hidden"),N="Symbol",z=P("toPrimitive"),V=j.set,W=j.getterFor(N),$=Object.prototype,U=i.Symbol,G=o("JSON","stringify"),Y=S.f,q=x.f,K=C.f,X=E.f,Z=O("symbols"),J=O("op-symbols"),Q=O("string-to-symbol-registry"),ee=O("symbol-to-string-registry"),te=O("wks"),ne=i.QObject,re=!ne||!ne.prototype||!ne.prototype.findChild,ie=s&&c((function(){return 7!=b(q({},"a",{get:function(){return q(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=Y($,t);r&&delete $[t],q(e,t,n),r&&e!==$&&q($,t,r)}:q,oe=function(e,t){var n=Z[e]=b(U.prototype);return V(n,{type:N,tag:e,description:t}),s||(n.description=t),n},ae=u?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof U},se=function(e,t,n){e===$&&se(J,t,n),v(e);var r=y(t,!0);return v(n),f(Z,r)?(n.enumerable?(f(e,H)&&e[H][r]&&(e[H][r]=!1),n=b(n,{enumerable:m(0,!1)})):(f(e,H)||q(e,H,m(1,{})),e[H][r]=!0),ie(e,r,n)):q(e,r,n)},le=function(e,t){v(e);var n=g(t),r=k(n).concat(de(n));return _(r,(function(t){s&&!ue.call(n,t)||se(e,t,n[t])})),e},ue=function(e){var t=y(e,!0),n=X.call(this,t);return!(this===$&&f(Z,t)&&!f(J,t))&&(!(n||!f(this,t)||!f(Z,t)||f(this,H)&&this[H][t])||n)},ce=function(e,t){var n=g(e),r=y(t,!0);if(n!==$||!f(Z,r)||f(J,r)){var i=Y(n,r);return!i||!f(Z,r)||f(n,H)&&n[H][r]||(i.enumerable=!0),i}},fe=function(e){var t=K(g(e)),n=[];return _(t,(function(e){f(Z,e)||f(A,e)||n.push(e)})),n},de=function(e){var t=e===$,n=K(t?J:g(e)),r=[];return _(n,(function(e){!f(Z,e)||t&&!f($,e)||r.push(Z[e])})),r};(l||(T((U=function(){if(this instanceof U)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=I(e),n=function(e){this===$&&n.call(J,e),f(this,H)&&f(this[H],t)&&(this[H][t]=!1),ie(this,t,m(1,e))};return s&&re&&ie($,t,{configurable:!0,set:n}),oe(t,e)}).prototype,"toString",(function(){return W(this).tag})),T(U,"withoutSetter",(function(e){return oe(I(e),e)})),E.f=ue,x.f=se,S.f=ce,w.f=C.f=fe,R.f=de,F.f=function(e){return oe(P(e),e)},s&&(q(U.prototype,"description",{configurable:!0,get:function(){return W(this).description}}),a||T($,"propertyIsEnumerable",ue,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:U}),_(k(te),(function(e){L(e)})),r({target:N,stat:!0,forced:!l},{for:function(e){var t=String(e);if(f(Q,t))return Q[t];var n=U(t);return Q[t]=n,ee[n]=t,n},keyFor:function(e){if(!ae(e))throw TypeError(e+" is not a symbol");if(f(ee,e))return ee[e]},useSetter:function(){re=!0},useSimple:function(){re=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!s},{create:function(e,t){return void 0===t?b(e):le(b(e),t)},defineProperty:se,defineProperties:le,getOwnPropertyDescriptor:ce}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:fe,getOwnPropertySymbols:de}),r({target:"Object",stat:!0,forced:c((function(){R.f(1)}))},{getOwnPropertySymbols:function(e){return R.f(p(e))}}),G)&&r({target:"JSON",stat:!0,forced:!l||c((function(){var e=U();return"[null]"!=G([e])||"{}"!=G({a:e})||"{}"!=G(Object(e))}))},{stringify:function(e,t,n){for(var r,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);if(r=t,(h(t)||void 0!==e)&&!ae(e))return d(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!ae(t))return t}),i[1]=t,G.apply(null,i)}});U.prototype[z]||D(U.prototype,z,U.prototype.valueOf),B(U,N),A[H]=!0},function(e,t,n){var r=n(62),i=n(220),o=n(25),a=n(114),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var r=n(11),i=n(62),o=n(55),a=n(90),s=n(57),l=n(82).f,u=n(222),c=o.Symbol;if(i&&"function"==typeof c&&(!("description"in c.prototype)||void 0!==c().description)){var f={},d=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof d?new c(e):void 0===e?c():c(e);return""===e&&(f[t]=!0),t};u(d,c);var h=d.prototype=c.prototype;h.constructor=d;var v=h.toString,p="Symbol(test)"==String(c("test")),g=/^Symbol\((.*)\)[^)]+$/;l(h,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=v.call(e);if(a(f,e))return"";var n=p?t.slice(7,-1):t.replace(g,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:d})}},function(e,t,n){"use strict";var r=n(178),i=n(25),o=n(78),a=n(111),s=n(97),l=n(179),u=n(268),c=n(180),f=Math.max,d=Math.min;r("replace",2,(function(e,t,n,r){var h=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,v=r.REPLACE_KEEPS_$0,p=h?"$":"$0";return[function(n,r){var i=s(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!h&&v||"string"==typeof r&&-1===r.indexOf(p)){var s=n(t,e,this,r);if(s.done)return s.value}var g=i(e),y=String(this),m="function"==typeof r;m||(r=String(r));var b=g.global;if(b){var k=g.unicode;g.lastIndex=0}for(var w=[];;){var C=c(g,y);if(null===C)break;if(w.push(C),!b)break;""===String(C[0])&&(g.lastIndex=l(y,o(g.lastIndex),k))}for(var R,S="",x=0,E=0;E<w.length;E++){C=w[E];for(var D=String(C[0]),T=f(d(a(C.index),y.length),0),O=[],M=1;M<C.length;M++)O.push(void 0===(R=C[M])?R:String(R));var A=C.groups;if(m){var I=[D].concat(O,T,y);void 0!==A&&I.push(A);var P=String(r.apply(void 0,I))}else P=u(D,y,T,O,A,r);T>=x&&(S+=y.slice(x,T)+P,x=T+D.length)}return S+y.slice(x)}]}))},function(e,t,n){"use strict";var r=n(178),i=n(161),o=n(25),a=n(97),s=n(94),l=n(179),u=n(78),c=n(180),f=n(177),d=n(162).UNSUPPORTED_Y,h=[].push,v=Math.min,p=4294967295;r("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(a(this)),o=void 0===n?p:n>>>0;if(0===o)return[];if(void 0===e)return[r];if(!i(e))return t.call(r,e,o);for(var s,l,u,c=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),v=0,g=new RegExp(e.source,d+"g");(s=f.call(g,r))&&!((l=g.lastIndex)>v&&(c.push(r.slice(v,s.index)),s.length>1&&s.index<r.length&&h.apply(c,s.slice(1)),u=s[0].length,v=l,c.length>=o));)g.lastIndex===s.index&&g.lastIndex++;return v===r.length?!u&&g.test("")||c.push(""):c.push(r.slice(v)),c.length>o?c.slice(0,o):c}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=a(this),o=null==t?void 0:t[e];return void 0!==o?o.call(t,i,n):r.call(String(i),t,n)},function(e,i){var a=n(r,e,this,i,r!==t);if(a.done)return a.value;var f=o(e),h=String(this),g=s(f,RegExp),y=f.unicode,m=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(d?"g":"y"),b=new g(d?"^(?:"+f.source+")":f,m),k=void 0===i?p:i>>>0;if(0===k)return[];if(0===h.length)return null===c(b,h)?[h]:[];for(var w=0,C=0,R=[];C<h.length;){b.lastIndex=d?0:C;var S,x=c(b,d?h.slice(C):h);if(null===x||(S=v(u(b.lastIndex+(d?C:0)),h.length))===w)C=l(h,C,y);else{if(R.push(h.slice(w,C)),R.length===k)return R;for(var E=1;E<=x.length-1;E++)if(R.push(x[E]),R.length===k)return R;C=w=S}}return R.push(h.slice(w)),R}]}),d)},function(e,t,n){var r=n(97);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(62),i=n(55),o=n(150),a=n(99),s=n(90),l=n(121),u=n(171),c=n(114),f=n(30),d=n(116),h=n(130).f,v=n(96).f,p=n(82).f,g=n(143).trim,y="Number",m=i.Number,b=m.prototype,k=l(d(b))==y,w=function(e){var t,n,r,i,o,a,s,l,u=c(e,!1);if("string"==typeof u&&u.length>2)if(43===(t=(u=g(u)).charCodeAt(0))||45===t){if(88===(n=u.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(a=(o=u.slice(2)).length,s=0;s<a;s++)if((l=o.charCodeAt(s))<48||l>i)return NaN;return parseInt(o,r)}return+u};if(o(y,!m(" 0o1")||!m("0b1")||m("+0x1"))){for(var C,R=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof R&&(k?f((function(){b.valueOf.call(n)})):l(n)!=y)?u(new m(w(t)),n,R):w(t)},S=r?h(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),x=0;S.length>x;x++)s(m,C=S[x])&&!s(R,C)&&p(R,C,v(m,C));R.prototype=b,b.constructor=R,a(i,y,R)}},function(e,t,n){"use strict";var r=n(99),i=n(25),o=n(30),a=n(144),s="toString",l=RegExp.prototype,u=l.toString,c=o((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),f=u.name!=s;(c||f)&&r(RegExp.prototype,s,(function(){var e=i(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in l)?a.call(e):n)}),{unsafe:!0})},function(e,t,n){var r=n(190),i=n(55),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e])||o(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},function(e,t,n){var r=n(86),i={}.hasOwnProperty;e.exports=Object.hasOwn||function(e,t){return i.call(r(e),t)}},function(e,t,n){var r=n(11),i=n(252).entries;r({target:"Object",stat:!0},{entries:function(e){return i(e)}})},function(e,t){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(59);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(25),i=n(59),o=n(63)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},function(e,t,n){var r=n(93),i=n(146),o=n(86),a=n(78),s=n(153),l=[].push,u=function(e){var t=1==e,n=2==e,u=3==e,c=4==e,f=6==e,d=7==e,h=5==e||f;return function(v,p,g,y){for(var m,b,k=o(v),w=i(k),C=r(p,g,3),R=a(w.length),S=0,x=y||s,E=t?x(v,R):n||d?x(v,0):void 0;R>S;S++)if((h||S in w)&&(b=C(m=w[S],S,k),e))if(t)E[S]=b;else if(b)switch(e){case 3:return!0;case 5:return m;case 6:return S;case 2:l.call(E,m)}else switch(e){case 4:return!1;case 7:l.call(E,m)}return f?-1:u||c?c:E}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterOut:u(7)}},function(e,t,n){var r=n(62),i=n(164),o=n(120),a=n(108),s=n(114),l=n(90),u=n(220),c=Object.getOwnPropertyDescriptor;t.f=r?c:function(e,t){if(e=a(e),t=s(t,!0),u)try{return c(e,t)}catch(e){}if(l(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){var r=n(62),i=n(82),o=n(120);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(55),i=n(98),o=n(90),a=n(186),s=n(187),l=n(102),u=l.get,c=l.enforce,f=String(String).split("String");(e.exports=function(e,t,n,s){var l,u=!!s&&!!s.unsafe,d=!!s&&!!s.enumerable,h=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||o(n,"name")||i(n,"name",t),(l=c(n)).source||(l.source=f.join("string"==typeof t?t:""))),e!==r?(u?!h&&e[t]&&(d=!0):delete e[t],d?e[t]=n:i(e,t,n)):d?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||s(this)}))},function(e,t,n){var r=n(11),i=n(159),o=n(30),a=n(57),s=n(133).onFreeze,l=Object.freeze;r({target:"Object",stat:!0,forced:o((function(){l(1)})),sham:!i},{freeze:function(e){return l&&a(e)?l(s(e)):e}})},function(e,t,n){"use strict";var r=n(11),i=n(143).trim;r({target:"String",proto:!0,forced:n(214)("trim")},{trim:function(){return i(this)}})},function(e,t,n){var r,i,o,a=n(221),s=n(55),l=n(57),u=n(98),c=n(90),f=n(188),d=n(165),h=n(148),v="Object already initialized",p=s.WeakMap;if(a||f.state){var g=f.state||(f.state=new p),y=g.get,m=g.has,b=g.set;r=function(e,t){if(m.call(g,e))throw new TypeError(v);return t.facade=e,b.call(g,e,t),t},i=function(e){return y.call(g,e)||{}},o=function(e){return m.call(g,e)}}else{var k=d("state");h[k]=!0,r=function(e,t){if(c(e,k))throw new TypeError(v);return t.facade=e,u(e,k,t),t},i=function(e){return c(e,k)?e[k]:{}},o=function(e){return c(e,k)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var r=n(11),i=n(30),o=n(86),a=n(112),s=n(195);r({target:"Object",stat:!0,forced:i((function(){a(1)})),sham:!s},{getPrototypeOf:function(e){return a(o(e))}})},function(e,t,n){"use strict";var r,i=n(11),o=n(96).f,a=n(78),s=n(212),l=n(97),u=n(213),c=n(36),f="".startsWith,d=Math.min,h=u("startsWith");i({target:"String",proto:!0,forced:!!(c||h||(r=o(String.prototype,"startsWith"),!r||r.writable))&&!h},{startsWith:function(e){var t=String(l(this));s(e);var n=a(d(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return f?f.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){var r=n(190),i=n(90),o=n(227),a=n(82).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||a(t,e,{value:o.f(e)})}},function(e,t,n){"use strict";var r=n(11),i=n(95).findIndex,o=n(127),a="findIndex",s=!0;a in[]&&Array(1).findIndex((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(a)},function(e,t,n){var r=n(11),i=n(62),o=n(25),a=n(114),s=n(82);r({target:"Reflect",stat:!0,forced:n(30)((function(){Reflect.defineProperty(s.f({},1,{value:1}),1,{value:2})})),sham:!i},{defineProperty:function(e,t,n){o(e);var r=a(t,!0);o(n);try{return s.f(e,r,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(146),i=n(97);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(97),i=/"/g;e.exports=function(e,t,n,o){var a=String(r(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(o).replace(i,"&quot;")+'"'),s+">"+a+"</"+t+">"}},function(e,t,n){var r=n(30);e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(90),i=n(86),o=n(165),a=n(195),s=o("IE_PROTO"),l=Object.prototype;e.exports=a?Object.getPrototypeOf:function(e){return e=i(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},function(e,t,n){"use strict";var r,i=n(11),o=n(96).f,a=n(78),s=n(212),l=n(97),u=n(213),c=n(36),f="".endsWith,d=Math.min,h=u("endsWith");i({target:"String",proto:!0,forced:!!(c||h||(r=o(String.prototype,"endsWith"),!r||r.writable))&&!h},{endsWith:function(e){var t=String(l(this));s(e);var n=arguments.length>1?arguments[1]:void 0,r=a(t.length),i=void 0===n?r:d(a(n),r),o=String(e);return f?f.call(t,o,i):t.slice(i-o.length,i)===o}})},function(e,t,n){var r=n(57);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(82).f,i=n(90),o=n(63)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r,i=n(25),o=n(194),a=n(191),s=n(148),l=n(225),u=n(185),c=n(165),f=c("IE_PROTO"),d=function(){},h=function(e){return"<script>"+e+"</"+"script>"},v=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;v=r?function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t}(r):((t=u("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F);for(var n=a.length;n--;)delete v.prototype[a[n]];return v()};s[f]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=i(e),n=new d,d.prototype=null,n[f]=e):n=v(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(62),i=n(55),o=n(150),a=n(171),s=n(82).f,l=n(130).f,u=n(161),c=n(144),f=n(162),d=n(99),h=n(30),v=n(102).enforce,p=n(141),g=n(63)("match"),y=i.RegExp,m=y.prototype,b=/a/g,k=/a/g,w=new y(b)!==b,C=f.UNSUPPORTED_Y;if(r&&o("RegExp",!w||C||h((function(){return k[g]=!1,y(b)!=b||y(k)==k||"/a/i"!=y(b,"i")})))){for(var R=function(e,t){var n,r=this instanceof R,i=u(e),o=void 0===t;if(!r&&i&&e.constructor===R&&o)return e;w?i&&!o&&(e=e.source):e instanceof R&&(o&&(t=c.call(e)),e=e.source),C&&(n=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var s=a(w?new y(e,t):y(e,t),r?this:m,R);C&&n&&(v(s).sticky=!0);return s},S=function(e){e in R||s(R,e,{configurable:!0,get:function(){return y[e]},set:function(t){y[e]=t}})},x=l(y),E=0;x.length>E;)S(x[E++]);m.constructor=R,R.prototype=m,d(i,"RegExp",R)}p("RegExp")},function(e,t,n){var r=n(36),i=n(182);e.exports=r?i:function(e){return Map.prototype.entries.call(e)}},function(e,t,n){var r=n(278);e.exports=function(e){return new r(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(25),i=n(229);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,o){return r(n),i(o),t?e.call(n,o):n.__proto__=o,n}}():void 0)},function(e,t,n){"use strict";var r=n(30);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},function(e,t,n){"use strict";var r=n(178),i=n(25),o=n(78),a=n(97),s=n(179),l=n(180);r("match",1,(function(e,t,n){return[function(t){var n=a(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var a=i(e),u=String(this);if(!a.global)return l(a,u);var c=a.unicode;a.lastIndex=0;for(var f,d=[],h=0;null!==(f=l(a,u));){var v=String(f[0]);d[h]=v,""===v&&(a.lastIndex=s(u,o(a.lastIndex),c)),h++}return 0===h?null:d}]}))},function(e,t,n){"use strict";var r=n(11),i=n(55),o=n(62),a=n(215),s=n(77),l=n(169),u=n(128),c=n(120),f=n(98),d=n(78),h=n(237),v=n(269),p=n(114),g=n(90),y=n(156),m=n(57),b=n(116),k=n(122),w=n(130).f,C=n(270),R=n(95).forEach,S=n(141),x=n(82),E=n(96),D=n(102),T=n(171),O=D.get,M=D.set,A=x.f,I=E.f,P=Math.round,F=i.RangeError,L=l.ArrayBuffer,B=l.DataView,j=s.NATIVE_ARRAY_BUFFER_VIEWS,_=s.TYPED_ARRAY_TAG,H=s.TypedArray,N=s.TypedArrayPrototype,z=s.aTypedArrayConstructor,V=s.isTypedArray,W="BYTES_PER_ELEMENT",$="Wrong length",U=function(e,t){for(var n=0,r=t.length,i=new(z(e))(r);r>n;)i[n]=t[n++];return i},G=function(e,t){A(e,t,{get:function(){return O(this)[t]}})},Y=function(e){var t;return e instanceof L||"ArrayBuffer"==(t=y(e))||"SharedArrayBuffer"==t},q=function(e,t){return V(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},K=function(e,t){return q(e,t=p(t,!0))?c(2,e[t]):I(e,t)},X=function(e,t,n){return!(q(e,t=p(t,!0))&&m(n)&&g(n,"value"))||g(n,"get")||g(n,"set")||n.configurable||g(n,"writable")&&!n.writable||g(n,"enumerable")&&!n.enumerable?A(e,t,n):(e[t]=n.value,e)};o?(j||(E.f=K,x.f=X,G(N,"buffer"),G(N,"byteOffset"),G(N,"byteLength"),G(N,"length")),r({target:"Object",stat:!0,forced:!j},{getOwnPropertyDescriptor:K,defineProperty:X}),e.exports=function(e,t,n){var o=e.match(/\d+$/)[0]/8,s=e+(n?"Clamped":"")+"Array",l="get"+e,c="set"+e,p=i[s],g=p,y=g&&g.prototype,x={},E=function(e,t){A(e,t,{get:function(){return function(e,t){var n=O(e);return n.view[l](t*o+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var i=O(e);n&&(r=(r=P(r))<0?0:r>255?255:255&r),i.view[c](t*o+i.byteOffset,r,!0)}(this,t,e)},enumerable:!0})};j?a&&(g=t((function(e,t,n,r){return u(e,g,s),T(m(t)?Y(t)?void 0!==r?new p(t,v(n,o),r):void 0!==n?new p(t,v(n,o)):new p(t):V(t)?U(g,t):C.call(g,t):new p(h(t)),e,g)})),k&&k(g,H),R(w(p),(function(e){e in g||f(g,e,p[e])})),g.prototype=y):(g=t((function(e,t,n,r){u(e,g,s);var i,a,l,c=0,f=0;if(m(t)){if(!Y(t))return V(t)?U(g,t):C.call(g,t);i=t,f=v(n,o);var p=t.byteLength;if(void 0===r){if(p%o)throw F($);if((a=p-f)<0)throw F($)}else if((a=d(r)*o)+f>p)throw F($);l=a/o}else l=h(t),i=new L(a=l*o);for(M(e,{buffer:i,byteOffset:f,byteLength:a,length:l,view:new B(i)});c<l;)E(e,c++)})),k&&k(g,H),y=g.prototype=b(N)),y.constructor!==g&&f(y,"constructor",g),_&&f(y,_,s),x[s]=g,r({global:!0,forced:g!=p,sham:!j},x),W in g||f(g,W,o),W in y||f(y,W,o),S(s)}):e.exports=function(){}},function(e,t,n){var r=n(111),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t,n){var r=n(63),i=n(116),o=n(82),a=r("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},function(e,t,n){var r=n(451);e.exports=function(e){return function(){return new r(e.apply(this,arguments))}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(223),i=n(191).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(121);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(114),i=n(82),o=n(120);e.exports=function(e,t,n){var a=r(t);a in e?i.f(e,a,o(0,n)):e[a]=n}},function(e,t,n){var r=n(148),i=n(57),o=n(90),a=n(82).f,s=n(147),l=n(159),u=s("meta"),c=0,f=Object.isExtensible||function(){return!0},d=function(e){a(e,u,{value:{objectID:"O"+ ++c,weakData:{}}})},h=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,u)){if(!f(e))return"F";if(!t)return"E";d(e)}return e[u].objectID},getWeakData:function(e,t){if(!o(e,u)){if(!f(e))return!0;if(!t)return!1;d(e)}return e[u].weakData},onFreeze:function(e){return l&&h.REQUIRED&&f(e)&&!o(e,u)&&d(e),e}};r[u]=!0},function(e,t,n){var r=n(11),i=n(30),o=n(108),a=n(96).f,s=n(62),l=i((function(){a(1)}));r({target:"Object",stat:!0,forced:!s||l,sham:!s},{getOwnPropertyDescriptor:function(e,t){return a(o(e),t)}})},function(e,t,n){n(11)({target:"String",proto:!0},{repeat:n(204)})},function(e,t,n){var r=n(36),i=n(182);e.exports=r?i:function(e){return Set.prototype.values.call(e)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(219),i=n(450);function o(t,n,a){return i()?(e.exports=o=Reflect.construct,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},e.exports.default=e.exports,e.exports.__esModule=!0),o.apply(null,arguments)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r,i,o=n(55),a=n(151),s=o.process,l=s&&s.versions,u=l&&l.v8;u?i=(r=u.split("."))[0]<4?1:r[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=r[1]),e.exports=i&&+i},function(e,t,n){n(105)("iterator")},function(e,t,n){"use strict";var r=n(89),i=n(82),o=n(63),a=n(62),s=o("species");e.exports=function(e){var t=r(e),n=i.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(99);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){var r=n(97),i="["+n(173)+"]",o=RegExp("^"+i+i+"*"),a=RegExp(i+i+"*$"),s=function(e){return function(t){var n=String(r(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(a,"")),n}};e.exports={start:s(1),end:s(2),trim:s(3)}},function(e,t,n){"use strict";var r=n(25);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("anchor")},{anchor:function(e){return i(this,"a","name",e)}})},function(e,t,n){var r=n(30),i=n(121),o="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t){e.exports={}},function(e,t,n){var r=n(108),i=n(78),o=n(126),a=function(e){return function(t,n,a){var s,l=r(t),u=i(l.length),c=o(a,u);if(e&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var r=n(30),i=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==u||n!=l&&("function"==typeof t?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},function(e,t,n){var r=n(89);e.exports=r("navigator","userAgent")||""},function(e,t,n){var r=n(223),i=n(191);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(57),i=n(131),o=n(63)("species");e.exports=function(e,t){var n;return i(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!i(n.prototype)?r(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t){e.exports={}},function(e,t,n){var r=n(156),i=n(154),o=n(63)("iterator");e.exports=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(197),i=n(121),o=n(63)("toStringTag"),a="Arguments"==i(function(){return arguments}());e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:a?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},function(e,t,n){var r=n(30),i=n(63),o=n(139),a=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){var r=n(121),i=n(55);e.exports="process"==r(i.process)},function(e,t,n){var r=n(30);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,n){var r=n(11),i=n(62),o=n(25),a=n(96);r({target:"Reflect",stat:!0,sham:!i},{getOwnPropertyDescriptor:function(e,t){return a.f(o(e),t)}})},function(e,t,n){var r=n(57),i=n(121),o=n(63)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){"use strict";var r=n(30);function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},function(e,t,n){var r=n(111),i=n(97),o=function(e){return function(t,n){var o,a,s=String(i(t)),l=r(n),u=s.length;return l<0||l>=u?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(166),i=n(147),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t,n){var r=n(36),i=n(188);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.13.1",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(63)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},function(e,t,n){var r=n(59),i=n(86),o=n(146),a=n(78),s=function(e){return function(t,n,s,l){r(n);var u=i(t),c=o(u),f=a(u.length),d=e?f-1:0,h=e?-1:1;if(s<2)for(;;){if(d in c){l=c[d],d+=h;break}if(d+=h,e?d<0:f<=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?d>=0:f>d;d+=h)d in c&&(l=n(l,c[d],d,u));return l}};e.exports={left:s(!1),right:s(!0)}},function(e,t,n){"use strict";var r=n(55),i=n(62),o=n(202),a=n(98),s=n(142),l=n(30),u=n(128),c=n(111),f=n(78),d=n(237),h=n(311),v=n(112),p=n(122),g=n(130).f,y=n(82).f,m=n(199),b=n(115),k=n(102),w=k.get,C=k.set,R="ArrayBuffer",S="DataView",x="Wrong index",E=r.ArrayBuffer,D=E,T=r.DataView,O=T&&T.prototype,M=Object.prototype,A=r.RangeError,I=h.pack,P=h.unpack,F=function(e){return[255&e]},L=function(e){return[255&e,e>>8&255]},B=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},j=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},_=function(e){return I(e,23,4)},H=function(e){return I(e,52,8)},N=function(e,t){y(e.prototype,t,{get:function(){return w(this)[t]}})},z=function(e,t,n,r){var i=d(n),o=w(e);if(i+t>o.byteLength)throw A(x);var a=w(o.buffer).bytes,s=i+o.byteOffset,l=a.slice(s,s+t);return r?l:l.reverse()},V=function(e,t,n,r,i,o){var a=d(n),s=w(e);if(a+t>s.byteLength)throw A(x);for(var l=w(s.buffer).bytes,u=a+s.byteOffset,c=r(+i),f=0;f<t;f++)l[u+f]=c[o?f:t-f-1]};if(o){if(!l((function(){E(1)}))||!l((function(){new E(-1)}))||l((function(){return new E,new E(1.5),new E(NaN),E.name!=R}))){for(var W,$=(D=function(e){return u(this,D),new E(d(e))}).prototype=E.prototype,U=g(E),G=0;U.length>G;)(W=U[G++])in D||a(D,W,E[W]);$.constructor=D}p&&v(O)!==M&&p(O,M);var Y=new T(new D(2)),q=O.setInt8;Y.setInt8(0,2147483648),Y.setInt8(1,2147483649),!Y.getInt8(0)&&Y.getInt8(1)||s(O,{setInt8:function(e,t){q.call(this,e,t<<24>>24)},setUint8:function(e,t){q.call(this,e,t<<24>>24)}},{unsafe:!0})}else D=function(e){u(this,D,R);var t=d(e);C(this,{bytes:m.call(new Array(t),0),byteLength:t}),i||(this.byteLength=t)},T=function(e,t,n){u(this,T,S),u(e,D,S);var r=w(e).byteLength,o=c(t);if(o<0||o>r)throw A("Wrong offset");if(o+(n=void 0===n?r-o:f(n))>r)throw A("Wrong length");C(this,{buffer:e,byteLength:n,byteOffset:o}),i||(this.buffer=e,this.byteLength=n,this.byteOffset=o)},i&&(N(D,"byteLength"),N(T,"buffer"),N(T,"byteLength"),N(T,"byteOffset")),s(T.prototype,{getInt8:function(e){return z(this,1,e)[0]<<24>>24},getUint8:function(e){return z(this,1,e)[0]},getInt16:function(e){var t=z(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=z(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return j(z(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return j(z(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return P(z(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return P(z(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){V(this,1,e,F,t)},setUint8:function(e,t){V(this,1,e,F,t)},setInt16:function(e,t){V(this,2,e,L,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){V(this,2,e,L,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){V(this,4,e,B,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){V(this,4,e,B,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){V(this,4,e,_,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){V(this,8,e,H,t,arguments.length>2?arguments[2]:void 0)}});b(D,R),b(T,S),e.exports={ArrayBuffer:D,DataView:T}},function(e,t,n){"use strict";var r=n(11),i=n(55),o=n(150),a=n(99),s=n(133),l=n(60),u=n(128),c=n(57),f=n(30),d=n(167),h=n(115),v=n(171);e.exports=function(e,t,n){var p=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),y=p?"set":"add",m=i[e],b=m&&m.prototype,k=m,w={},C=function(e){var t=b[e];a(b,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!c(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!c(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(o(e,"function"!=typeof m||!(g||b.forEach&&!f((function(){(new m).entries().next()})))))k=n.getConstructor(t,e,p,y),s.REQUIRED=!0;else if(o(e,!0)){var R=new k,S=R[y](g?{}:-0,1)!=R,x=f((function(){R.has(1)})),E=d((function(e){new m(e)})),D=!g&&f((function(){for(var e=new m,t=5;t--;)e[y](t,t);return!e.has(-0)}));E||((k=t((function(t,n){u(t,k,e);var r=v(new m,t,k);return null!=n&&l(n,r[y],{that:r,AS_ENTRIES:p}),r}))).prototype=b,b.constructor=k),(x||D)&&(C("delete"),C("has"),p&&C("get")),(D||S)&&C(y),g&&b.clear&&delete b.clear}return w[e]=k,r({global:!0,forced:k!=m},w),h(k,e),g||n.setStrong(k,e,p),k}},function(e,t,n){var r=n(57),i=n(122);e.exports=function(e,t,n){var o,a;return i&&"function"==typeof(o=t.constructor)&&o!==n&&r(a=o.prototype)&&a!==n.prototype&&i(e,a),e}},function(e,t){var n=Math.expm1,r=Math.exp;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:r(e)-1}:n},function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(e,t,n){n(11)({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){"use strict";var r=n(36),i=n(55),o=n(30),a=n(151);e.exports=r||!o((function(){var e=a.match(/AppleWebKit\/(\d+)\./);if(!(e&&+e[1]<535)){var t=Math.random();__defineSetter__.call(null,t,(function(){})),delete i[t]}}))},function(e,t,n){"use strict";var r=n(59),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},function(e,t,n){"use strict";var r,i,o=n(144),a=n(162),s=n(166),l=RegExp.prototype.exec,u=s("native-string-replace",String.prototype.replace),c=l,f=(r=/a/,i=/b*/g,l.call(r,"a"),l.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),d=a.UNSUPPORTED_Y||a.BROKEN_CARET,h=void 0!==/()??/.exec("")[1];(f||h||d)&&(c=function(e){var t,n,r,i,a=this,s=d&&a.sticky,c=o.call(a),v=a.source,p=0,g=e;return s&&(-1===(c=c.replace("y","")).indexOf("g")&&(c+="g"),g=String(e).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(v="(?: "+v+")",g=" "+g,p++),n=new RegExp("^(?:"+v+")",c)),h&&(n=new RegExp("^"+v+"$(?!\\s)",c)),f&&(t=a.lastIndex),r=l.call(s?n:a,g),s?r?(r.input=r.input.slice(p),r[0]=r[0].slice(p),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:f&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),h&&r&&r.length>1&&u.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=c},function(e,t,n){"use strict";n(32);var r=n(99),i=n(177),o=n(30),a=n(63),s=n(98),l=a("species"),u=RegExp.prototype,c=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f="$0"==="a".replace(/./,"$0"),d=a("replace"),h=!!/./[d]&&""===/./[d]("a","$0"),v=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,d){var p=a(e),g=!o((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),y=g&&!o((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return t=!0,null},n[p](""),!t}));if(!g||!y||"replace"===e&&(!c||!f||h)||"split"===e&&!v){var m=/./[p],b=n(p,""[e],(function(e,t,n,r,o){var a=t.exec;return a===i||a===u.exec?g&&!o?{done:!0,value:m.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:f,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:h}),k=b[0],w=b[1];r(String.prototype,e,k),r(u,p,2==t?function(e,t){return w.call(e,this,t)}:function(e){return w.call(e,this)})}d&&s(u[p],"sham",!0)}},function(e,t,n){"use strict";var r=n(163).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r=n(121),i=n(177);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";var r=n(178),i=n(25),o=n(97),a=n(255),s=n(180);r("search",1,(function(e,t,n){return[function(t){var n=o(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var o=i(e),l=String(this),u=o.lastIndex;a(u,0)||(o.lastIndex=0);var c=s(o,l);return a(o.lastIndex,u)||(o.lastIndex=u),null===c?-1:c.index}]}))},function(e,t,n){var r=n(25),i=n(155);e.exports=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return r(t.call(e))}},function(e,t,n){"use strict";n(11)({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(55),i=n(57),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(55),i=n(98);e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},function(e,t,n){var r=n(188),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},function(e,t,n){var r=n(55),i=n(186),o="__core-js_shared__",a=r[o]||i(o,{});e.exports=a},function(e,t,n){var r=n(89),i=n(130),o=n(192),a=n(25);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(55);e.exports=r},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(139),i=n(30);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(e,t,n){var r=n(62),i=n(82),o=n(25),a=n(152);e.exports=r?Object.defineProperties:function(e,t){o(e);for(var n,r=a(t),s=r.length,l=0;s>l;)i.f(e,n=r[l++],t[n]);return e}},function(e,t,n){var r=n(30);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){var r=n(63),i=n(154),o=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},function(e,t,n){var r={};r[n(63)("toStringTag")]="z",e.exports="[object z]"===String(r)},function(e,t,n){var r=n(11),i=n(199),o=n(127);r({target:"Array",proto:!0},{fill:i}),o("fill")},function(e,t,n){"use strict";var r=n(86),i=n(126),o=n(78);e.exports=function(e){for(var t=r(this),n=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:i(l,n);u>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(11),i=n(201),o=n(112),a=n(122),s=n(115),l=n(98),u=n(99),c=n(63),f=n(36),d=n(154),h=n(235),v=h.IteratorPrototype,p=h.BUGGY_SAFARI_ITERATORS,g=c("iterator"),y="keys",m="values",b="entries",k=function(){return this};e.exports=function(e,t,n,c,h,w,C){i(n,t,c);var R,S,x,E=function(e){if(e===h&&A)return A;if(!p&&e in O)return O[e];switch(e){case y:case m:case b:return function(){return new n(this,e)}}return function(){return new n(this)}},D=t+" Iterator",T=!1,O=e.prototype,M=O[g]||O["@@iterator"]||h&&O[h],A=!p&&M||E(h),I="Array"==t&&O.entries||M;if(I&&(R=o(I.call(new e)),v!==Object.prototype&&R.next&&(f||o(R)===v||(a?a(R,v):"function"!=typeof R[g]&&l(R,g,k)),s(R,D,!0,!0),f&&(d[D]=k))),h==m&&M&&M.name!==m&&(T=!0,A=function(){return M.call(this)}),f&&!C||O[g]===A||l(O,g,A),d[t]=A,h)if(S={values:E(m),keys:w?A:E(y),entries:E(b)},C)for(x in S)(p||T||!(x in O))&&u(O,x,S[x]);else r({target:t,proto:!0,forced:p||T},S);return S}},function(e,t,n){"use strict";var r=n(235).IteratorPrototype,i=n(116),o=n(120),a=n(115),s=n(154),l=function(){return this};e.exports=function(e,t,n){var u=t+" Iterator";return e.prototype=i(r,{next:o(1,n)}),a(e,u,!1,!0),s[u]=l,e}},function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(e,t,n){var r=n(78),i=n(204),o=n(97),a=Math.ceil,s=function(e){return function(t,n,s){var l,u,c=String(o(t)),f=c.length,d=void 0===s?" ":String(s),h=r(n);return h<=f||""==d?c:(l=h-f,(u=i.call(d,a(l/d.length))).length>l&&(u=u.slice(0,l)),e?c+u:u+c)}};e.exports={start:s(!1),end:s(!0)}},function(e,t,n){"use strict";var r=n(111),i=n(97);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t,n){n(11)({target:"Math",stat:!0},{sign:n(205)})},function(e,t,n){n(11)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(11),i=n(30),o=n(57),a=Object.isFrozen;r({target:"Object",stat:!0,forced:i((function(){a(1)}))},{isFrozen:function(e){return!o(e)||!!a&&a(e)}})},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},function(e,t,n){var r=n(11),i=n(25),o=n(96).f;r({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var n=o(i(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){n(11)({target:"Reflect",stat:!0},{ownKeys:n(189)})},function(e,t,n){var r=n(161);e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},function(e,t,n){var r=n(63)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,n){var r=n(30),i=n(173);e.exports=function(e){return r((function(){return!!i[e]()||"​᠎"!="​᠎"[e]()||i[e].name!==e}))}},function(e,t,n){var r=n(55),i=n(30),o=n(167),a=n(77).NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,l=r.Int8Array;e.exports=!a||!i((function(){l(1)}))||!i((function(){new l(-1)}))||!o((function(e){new l,new l(null),new l(1.5),new l(e)}),!0)||i((function(){return 1!==new l(new s(2),1,void 0).length}))},function(e,t,n){"use strict";var r,i=n(55),o=n(142),a=n(133),s=n(170),l=n(271),u=n(57),c=n(102).enforce,f=n(221),d=!i.ActiveXObject&&"ActiveXObject"in i,h=Object.isExtensible,v=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},p=e.exports=s("WeakMap",v,l);if(f&&d){r=l.getConstructor(v,"WeakMap",!0),a.REQUIRED=!0;var g=p.prototype,y=g.delete,m=g.has,b=g.get,k=g.set;o(g,{delete:function(e){if(u(e)&&!h(e)){var t=c(this);return t.frozen||(t.frozen=new r),y.call(this,e)||t.frozen.delete(e)}return y.call(this,e)},has:function(e){if(u(e)&&!h(e)){var t=c(this);return t.frozen||(t.frozen=new r),m.call(this,e)||t.frozen.has(e)}return m.call(this,e)},get:function(e){if(u(e)&&!h(e)){var t=c(this);return t.frozen||(t.frozen=new r),m.call(this,e)?b.call(this,e):t.frozen.get(e)}return b.call(this,e)},set:function(e,t){if(u(e)&&!h(e)){var n=c(this);n.frozen||(n.frozen=new r),m.call(this,e)?k.call(this,e,t):n.frozen.set(e,t)}else k.call(this,e,t);return this}})}},function(e,t,n){"use strict";var r=n(25),i=n(59);e.exports=function(){for(var e,t=r(this),n=i(t.delete),o=!0,a=0,s=arguments.length;a<s;a++)e=n.call(t,arguments[a]),o=o&&e;return!!o}},function(e,t,n){"use strict";n(22);var r,i=n(11),o=n(62),a=n(275),s=n(55),l=n(194),u=n(99),c=n(128),f=n(90),d=n(250),h=n(234),v=n(163).codeAt,p=n(447),g=n(115),y=n(448),m=n(102),b=s.URL,k=y.URLSearchParams,w=y.getState,C=m.set,R=m.getterFor("URL"),S=Math.floor,x=Math.pow,E="Invalid scheme",D="Invalid host",T="Invalid port",O=/[A-Za-z]/,M=/[\d+-.A-Za-z]/,A=/\d/,I=/^(0x|0X)/,P=/^[0-7]+$/,F=/^\d+$/,L=/^[\dA-Fa-f]+$/,B=/[\0\t\n\r #%/:?@[\\]]/,j=/[\0\t\n\r #/:?@[\\]]/,_=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,H=/[\t\n\r]/g,N=function(e,t){var n,r,i;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return D;if(!(n=V(t.slice(1,-1))))return D;e.host=n}else if(X(e)){if(t=p(t),B.test(t))return D;if(null===(n=z(t)))return D;e.host=n}else{if(j.test(t))return D;for(n="",r=h(t),i=0;i<r.length;i++)n+=q(r[i],$);e.host=n}},z=function(e){var t,n,r,i,o,a,s,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),(t=l.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=l[r]))return e;if(o=10,i.length>1&&"0"==i.charAt(0)&&(o=I.test(i)?16:8,i=i.slice(8==o?1:2)),""===i)a=0;else{if(!(10==o?F:8==o?P:L).test(i))return e;a=parseInt(i,o)}n.push(a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=x(256,5-t))return null}else if(a>255)return null;for(s=n.pop(),r=0;r<n.length;r++)s+=n[r]*x(256,3-r);return s},V=function(e){var t,n,r,i,o,a,s,l=[0,0,0,0,0,0,0,0],u=0,c=null,f=0,d=function(){return e.charAt(f)};if(":"==d()){if(":"!=e.charAt(1))return;f+=2,c=++u}for(;d();){if(8==u)return;if(":"!=d()){for(t=n=0;n<4&&L.test(d());)t=16*t+parseInt(d(),16),f++,n++;if("."==d()){if(0==n)return;if(f-=n,u>6)return;for(r=0;d();){if(i=null,r>0){if(!("."==d()&&r<4))return;f++}if(!A.test(d()))return;for(;A.test(d());){if(o=parseInt(d(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;f++}l[u]=256*l[u]+i,2!=++r&&4!=r||u++}if(4!=r)return;break}if(":"==d()){if(f++,!d())return}else if(d())return;l[u++]=t}else{if(null!==c)return;f++,c=++u}}if(null!==c)for(a=u-c,u=7;0!=u&&a>0;)s=l[u],l[u--]=l[c+a-1],l[c+--a]=s;else if(8!=u)return;return l},W=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)t.unshift(e%256),e=S(e/256);return t.join(".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=e[n].toString(16),n<7&&(t+=":")));return"["+t+"]"}return e},$={},U=d({},$,{" ":1,'"':1,"<":1,">":1,"`":1}),G=d({},U,{"#":1,"?":1,"{":1,"}":1}),Y=d({},G,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),q=function(e,t){var n=v(e,0);return n>32&&n<127&&!f(t,e)?e:encodeURIComponent(e)},K={ftp:21,file:null,http:80,https:443,ws:80,wss:443},X=function(e){return f(K,e.scheme)},Z=function(e){return""!=e.username||""!=e.password},J=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},Q=function(e,t){var n;return 2==e.length&&O.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!t&&"|"==n)},ee=function(e){var t;return e.length>1&&Q(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},te=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&Q(t[0],!0)||t.pop()},ne=function(e){return"."===e||"%2e"===e.toLowerCase()},re={},ie={},oe={},ae={},se={},le={},ue={},ce={},fe={},de={},he={},ve={},pe={},ge={},ye={},me={},be={},ke={},we={},Ce={},Re={},Se=function(e,t,n,i){var o,a,s,l,u,c=n||re,d=0,v="",p=!1,g=!1,y=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(_,"")),t=t.replace(H,""),o=h(t);d<=o.length;){switch(a=o[d],c){case re:if(!a||!O.test(a)){if(n)return E;c=oe;continue}v+=a.toLowerCase(),c=ie;break;case ie:if(a&&(M.test(a)||"+"==a||"-"==a||"."==a))v+=a.toLowerCase();else{if(":"!=a){if(n)return E;v="",c=oe,d=0;continue}if(n&&(X(e)!=f(K,v)||"file"==v&&(Z(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=v,n)return void(X(e)&&K[e.scheme]==e.port&&(e.port=null));v="","file"==e.scheme?c=ge:X(e)&&i&&i.scheme==e.scheme?c=ae:X(e)?c=ce:"/"==o[d+1]?(c=se,d++):(e.cannotBeABaseURL=!0,e.path.push(""),c=we)}break;case oe:if(!i||i.cannotBeABaseURL&&"#"!=a)return E;if(i.cannotBeABaseURL&&"#"==a){e.scheme=i.scheme,e.path=i.path.slice(),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,c=Re;break}c="file"==i.scheme?ge:le;continue;case ae:if("/"!=a||"/"!=o[d+1]){c=le;continue}c=fe,d++;break;case se:if("/"==a){c=de;break}c=ke;continue;case le:if(e.scheme=i.scheme,a==r)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query;else if("/"==a||"\\"==a&&X(e))c=ue;else if("?"==a)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query="",c=Ce;else{if("#"!=a){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.path.pop(),c=ke;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query,e.fragment="",c=Re}break;case ue:if(!X(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,c=ke;continue}c=de}else c=fe;break;case ce:if(c=fe,"/"!=a||"/"!=v.charAt(d+1))continue;d++;break;case fe:if("/"!=a&&"\\"!=a){c=de;continue}break;case de:if("@"==a){p&&(v="%40"+v),p=!0,s=h(v);for(var m=0;m<s.length;m++){var b=s[m];if(":"!=b||y){var k=q(b,Y);y?e.password+=k:e.username+=k}else y=!0}v=""}else if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&X(e)){if(p&&""==v)return"Invalid authority";d-=h(v).length+1,v="",c=he}else v+=a;break;case he:case ve:if(n&&"file"==e.scheme){c=me;continue}if(":"!=a||g){if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&X(e)){if(X(e)&&""==v)return D;if(n&&""==v&&(Z(e)||null!==e.port))return;if(l=N(e,v))return l;if(v="",c=be,n)return;continue}"["==a?g=!0:"]"==a&&(g=!1),v+=a}else{if(""==v)return D;if(l=N(e,v))return l;if(v="",c=pe,n==ve)return}break;case pe:if(!A.test(a)){if(a==r||"/"==a||"?"==a||"#"==a||"\\"==a&&X(e)||n){if(""!=v){var w=parseInt(v,10);if(w>65535)return T;e.port=X(e)&&w===K[e.scheme]?null:w,v=""}if(n)return;c=be;continue}return T}v+=a;break;case ge:if(e.scheme="file","/"==a||"\\"==a)c=ye;else{if(!i||"file"!=i.scheme){c=ke;continue}if(a==r)e.host=i.host,e.path=i.path.slice(),e.query=i.query;else if("?"==a)e.host=i.host,e.path=i.path.slice(),e.query="",c=Ce;else{if("#"!=a){ee(o.slice(d).join(""))||(e.host=i.host,e.path=i.path.slice(),te(e)),c=ke;continue}e.host=i.host,e.path=i.path.slice(),e.query=i.query,e.fragment="",c=Re}}break;case ye:if("/"==a||"\\"==a){c=me;break}i&&"file"==i.scheme&&!ee(o.slice(d).join(""))&&(Q(i.path[0],!0)?e.path.push(i.path[0]):e.host=i.host),c=ke;continue;case me:if(a==r||"/"==a||"\\"==a||"?"==a||"#"==a){if(!n&&Q(v))c=ke;else if(""==v){if(e.host="",n)return;c=be}else{if(l=N(e,v))return l;if("localhost"==e.host&&(e.host=""),n)return;v="",c=be}continue}v+=a;break;case be:if(X(e)){if(c=ke,"/"!=a&&"\\"!=a)continue}else if(n||"?"!=a)if(n||"#"!=a){if(a!=r&&(c=ke,"/"!=a))continue}else e.fragment="",c=Re;else e.query="",c=Ce;break;case ke:if(a==r||"/"==a||"\\"==a&&X(e)||!n&&("?"==a||"#"==a)){if(".."===(u=(u=v).toLowerCase())||"%2e."===u||".%2e"===u||"%2e%2e"===u?(te(e),"/"==a||"\\"==a&&X(e)||e.path.push("")):ne(v)?"/"==a||"\\"==a&&X(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&Q(v)&&(e.host&&(e.host=""),v=v.charAt(0)+":"),e.path.push(v)),v="","file"==e.scheme&&(a==r||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",c=Ce):"#"==a&&(e.fragment="",c=Re)}else v+=q(a,G);break;case we:"?"==a?(e.query="",c=Ce):"#"==a?(e.fragment="",c=Re):a!=r&&(e.path[0]+=q(a,$));break;case Ce:n||"#"!=a?a!=r&&("'"==a&&X(e)?e.query+="%27":e.query+="#"==a?"%23":q(a,$)):(e.fragment="",c=Re);break;case Re:a!=r&&(e.fragment+=q(a,U))}d++}},xe=function(e){var t,n,r=c(this,xe,"URL"),i=arguments.length>1?arguments[1]:void 0,a=String(e),s=C(r,{type:"URL"});if(void 0!==i)if(i instanceof xe)t=R(i);else if(n=Se(t={},String(i)))throw TypeError(n);if(n=Se(s,a,null,t))throw TypeError(n);var l=s.searchParams=new k,u=w(l);u.updateSearchParams(s.query),u.updateURL=function(){s.query=String(l)||null},o||(r.href=De.call(r),r.origin=Te.call(r),r.protocol=Oe.call(r),r.username=Me.call(r),r.password=Ae.call(r),r.host=Ie.call(r),r.hostname=Pe.call(r),r.port=Fe.call(r),r.pathname=Le.call(r),r.search=Be.call(r),r.searchParams=je.call(r),r.hash=_e.call(r))},Ee=xe.prototype,De=function(){var e=R(this),t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,a=e.path,s=e.query,l=e.fragment,u=t+":";return null!==i?(u+="//",Z(e)&&(u+=n+(r?":"+r:"")+"@"),u+=W(i),null!==o&&(u+=":"+o)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?a[0]:a.length?"/"+a.join("/"):"",null!==s&&(u+="?"+s),null!==l&&(u+="#"+l),u},Te=function(){var e=R(this),t=e.scheme,n=e.port;if("blob"==t)try{return new xe(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&X(e)?t+"://"+W(e.host)+(null!==n?":"+n:""):"null"},Oe=function(){return R(this).scheme+":"},Me=function(){return R(this).username},Ae=function(){return R(this).password},Ie=function(){var e=R(this),t=e.host,n=e.port;return null===t?"":null===n?W(t):W(t)+":"+n},Pe=function(){var e=R(this).host;return null===e?"":W(e)},Fe=function(){var e=R(this).port;return null===e?"":String(e)},Le=function(){var e=R(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},Be=function(){var e=R(this).query;return e?"?"+e:""},je=function(){return R(this).searchParams},_e=function(){var e=R(this).fragment;return e?"#"+e:""},He=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(o&&l(Ee,{href:He(De,(function(e){var t=R(this),n=String(e),r=Se(t,n);if(r)throw TypeError(r);w(t.searchParams).updateSearchParams(t.query)})),origin:He(Te),protocol:He(Oe,(function(e){var t=R(this);Se(t,String(e)+":",re)})),username:He(Me,(function(e){var t=R(this),n=h(String(e));if(!J(t)){t.username="";for(var r=0;r<n.length;r++)t.username+=q(n[r],Y)}})),password:He(Ae,(function(e){var t=R(this),n=h(String(e));if(!J(t)){t.password="";for(var r=0;r<n.length;r++)t.password+=q(n[r],Y)}})),host:He(Ie,(function(e){var t=R(this);t.cannotBeABaseURL||Se(t,String(e),he)})),hostname:He(Pe,(function(e){var t=R(this);t.cannotBeABaseURL||Se(t,String(e),ve)})),port:He(Fe,(function(e){var t=R(this);J(t)||(""==(e=String(e))?t.port=null:Se(t,e,pe))})),pathname:He(Le,(function(e){var t=R(this);t.cannotBeABaseURL||(t.path=[],Se(t,e+"",be))})),search:He(Be,(function(e){var t=R(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",Se(t,e,Ce)),w(t.searchParams).updateSearchParams(t.query)})),searchParams:He(je),hash:He(_e,(function(e){var t=R(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",Se(t,e,Re)):t.fragment=null}))}),u(Ee,"toJSON",(function(){return De.call(this)}),{enumerable:!0}),u(Ee,"toString",(function(){return De.call(this)}),{enumerable:!0}),b){var Ne=b.createObjectURL,ze=b.revokeObjectURL;Ne&&u(xe,"createObjectURL",(function(e){return Ne.apply(b,arguments)})),ze&&u(xe,"revokeObjectURL",(function(e){return ze.apply(b,arguments)}))}g(xe,"URL"),i({global:!0,forced:!a,sham:!o},{URL:xe})},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,n(t,r)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(62),i=n(30),o=n(185);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(55),i=n(187),o=r.WeakMap;e.exports="function"==typeof o&&/native code/.test(i(o))},function(e,t,n){var r=n(90),i=n(189),o=n(96),a=n(82);e.exports=function(e,t){for(var n=i(t),s=a.f,l=o.f,u=0;u<n.length;u++){var c=n[u];r(e,c)||s(e,c,l(t,c))}}},function(e,t,n){var r=n(90),i=n(108),o=n(149).indexOf,a=n(148);e.exports=function(e,t){var n,s=i(e),l=0,u=[];for(n in s)!r(a,n)&&r(s,n)&&u.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var r=n(193);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(89);e.exports=r("document","documentElement")},function(e,t,n){var r=n(108),i=n(130).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){var r=n(63);t.f=r},function(e,t,n){n(105)("hasInstance")},function(e,t,n){var r=n(57);e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,n){var r=n(25);e.exports=function(e){var t=e.return;if(void 0!==t)return r(t.call(e)).value}},function(e,t,n){"use strict";var r=n(86),i=n(126),o=n(78),a=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),s=o(n.length),l=i(e,s),u=i(t,s),c=arguments.length>2?arguments[2]:void 0,f=a((void 0===c?s:i(c,s))-u,s-l),d=1;for(u<l&&l<u+f&&(d=-1,u+=f-1,l+=f-1);f-- >0;)u in n?n[l]=n[u]:delete n[l],l+=d,u+=d;return n}},function(e,t,n){"use strict";var r=n(131),i=n(78),o=n(93),a=function(e,t,n,s,l,u,c,f){for(var d,h=l,v=0,p=!!c&&o(c,f,3);v<s;){if(v in n){if(d=p?p(n[v],v,t):n[v],u>0&&r(d))h=a(e,t,d,i(d.length),h,u-1)-1;else{if(h>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[h]=d}h++}v++}return h};e.exports=a},function(e,t,n){"use strict";var r=n(95).forEach,i=n(123)("forEach");e.exports=i?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},function(e,t,n){"use strict";var r=n(93),i=n(86),o=n(298),a=n(196),s=n(78),l=n(132),u=n(155);e.exports=function(e){var t,n,c,f,d,h,v=i(e),p="function"==typeof this?this:Array,g=arguments.length,y=g>1?arguments[1]:void 0,m=void 0!==y,b=u(v),k=0;if(m&&(y=r(y,g>2?arguments[2]:void 0,2)),null==b||p==Array&&a(b))for(n=new p(t=s(v.length));t>k;k++)h=m?y(v[k],k):v[k],l(n,k,h);else for(d=(f=b.call(v)).next,n=new p;!(c=d.call(f)).done;k++)h=m?o(f,y,[c.value,k],!0):c.value,l(n,k,h);return n.length=k,n}},function(e,t,n){"use strict";var r,i,o,a=n(30),s=n(112),l=n(98),u=n(90),c=n(63),f=n(36),d=c("iterator"),h=!1;[].keys&&("next"in(o=[].keys())?(i=s(s(o)))!==Object.prototype&&(r=i):h=!0);var v=null==r||a((function(){var e={};return r[d].call(e)!==e}));v&&(r={}),f&&!v||u(r,d)||l(r,d,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},function(e,t,n){"use strict";var r=n(108),i=n(111),o=n(78),a=n(123),s=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,c=a("lastIndexOf"),f=u||!c;e.exports=f?function(e){if(u)return l.apply(this,arguments)||0;var t=r(this),n=o(t.length),a=n-1;for(arguments.length>1&&(a=s(a,i(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in t&&t[a]===e)return a||0;return-1}:l},function(e,t,n){var r=n(111),i=n(78);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length or index");return n}},function(e,t,n){"use strict";var r=n(59),i=n(57),o=[].slice,a={},s=function(e,t,n){if(!(t in a)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";a[t]=Function("C,a","return new C("+r.join(",")+")")}return a[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=o.call(arguments,1),a=function(){var r=n.concat(o.call(arguments));return this instanceof a?s(t,r.length,r):t.apply(e,r)};return i(t.prototype)&&(a.prototype=t.prototype),a}},function(e,t,n){"use strict";var r=n(57),i=n(82),o=n(112),a=n(63)("hasInstance"),s=Function.prototype;a in s||i.f(s,a,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=o(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){n(11)({global:!0},{globalThis:n(55)})},function(e,t,n){"use strict";var r=n(82).f,i=n(116),o=n(142),a=n(93),s=n(128),l=n(60),u=n(200),c=n(141),f=n(62),d=n(133).fastKey,h=n(102),v=h.set,p=h.getterFor;e.exports={getConstructor:function(e,t,n,u){var c=e((function(e,r){s(e,c,t),v(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),f||(e.size=0),null!=r&&l(r,e[u],{that:e,AS_ENTRIES:n})})),h=p(t),g=function(e,t,n){var r,i,o=h(e),a=y(e,t);return a?a.value=n:(o.last=a={index:i=d(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),f?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},y=function(e,t){var n,r=h(e),i=d(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(c.prototype,{clear:function(){for(var e=h(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,f?e.size=0:this.size=0},delete:function(e){var t=this,n=h(t),r=y(t,e);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),f?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=h(this),r=a(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!y(this,e)}}),o(c.prototype,n?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),f&&r(c.prototype,"size",{get:function(){return h(this).size}}),c},setStrong:function(e,t,n){var r=t+" Iterator",i=p(t),o=p(r);u(e,t,(function(e,t){v(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),c(t)}}},function(e,t){var n=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:n(1+e)}},function(e,t,n){var r=n(11),i=Math.ceil,o=Math.floor;r({target:"Math",stat:!0},{trunc:function(e){return(e>0?o:i)(e)}})},function(e,t,n){var r=n(57),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){var r=n(55),i=n(143).trim,o=n(173),a=r.parseFloat,s=1/a(o+"-0")!=-1/0;e.exports=s?function(e){var t=i(String(e)),n=a(t);return 0===n&&"-"==t.charAt(0)?-0:n}:a},function(e,t,n){var r=n(11),i=n(247);r({target:"Number",stat:!0,forced:Number.parseInt!=i},{parseInt:i})},function(e,t,n){var r=n(55),i=n(143).trim,o=n(173),a=r.parseInt,s=/^[+-]?0[Xx]/,l=8!==a(o+"08")||22!==a(o+"0x16");e.exports=l?function(e,t){var n=i(String(e));return a(n,t>>>0||(s.test(n)?16:10))}:a},function(e,t,n){"use strict";var r=n(11),i=n(111),o=n(249),a=n(204),s=n(30),l=1..toFixed,u=Math.floor,c=function(e,t,n){return 0===t?n:t%2==1?c(e,t-1,n*e):c(e*e,t/2,n)},f=function(e,t,n){for(var r=-1,i=n;++r<6;)i+=t*e[r],e[r]=i%1e7,i=u(i/1e7)},d=function(e,t){for(var n=6,r=0;--n>=0;)r+=e[n],e[n]=u(r/t),r=r%t*1e7},h=function(e){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==e[t]){var r=String(e[t]);n=""===n?r:n+a.call("0",7-r.length)+r}return n};r({target:"Number",proto:!0,forced:l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){l.call({})}))},{toFixed:function(e){var t,n,r,s,l=o(this),u=i(e),v=[0,0,0,0,0,0],p="",g="0";if(u<0||u>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(p="-",l=-l),l>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(l*c(2,69,1))-69)<0?l*c(2,-t,1):l/c(2,t,1),n*=4503599627370496,(t=52-t)>0){for(f(v,0,n),r=u;r>=7;)f(v,1e7,0),r-=7;for(f(v,c(10,r,1),0),r=t-1;r>=23;)d(v,1<<23),r-=23;d(v,1<<r),f(v,1,1),d(v,2),g=h(v)}else f(v,0,n),f(v,1<<-t,0),g=h(v)+a.call("0",u);return g=u>0?p+((s=g.length)<=u?"0."+a.call("0",u-s)+g:g.slice(0,s-u)+"."+g.slice(s-u)):p+g}})},function(e,t,n){var r=n(121);e.exports=function(e){if("number"!=typeof e&&"Number"!=r(e))throw TypeError("Incorrect invocation");return+e}},function(e,t,n){"use strict";var r=n(62),i=n(30),o=n(152),a=n(192),s=n(164),l=n(86),u=n(146),c=Object.assign,f=Object.defineProperty;e.exports=!c||i((function(){if(r&&1!==c({b:1},c(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=c({},e)[n]||o(c({},t)).join("")!=i}))?function(e,t){for(var n=l(e),i=arguments.length,c=1,f=a.f,d=s.f;i>c;)for(var h,v=u(arguments[c++]),p=f?o(v).concat(f(v)):o(v),g=p.length,y=0;g>y;)h=p[y++],r&&!d.call(v,h)||(n[h]=v[h]);return n}:c},function(e,t,n){"use strict";var r=n(11),i=n(62),o=n(175),a=n(86),s=n(59),l=n(82);i&&r({target:"Object",proto:!0,forced:o},{__defineGetter__:function(e,t){l.f(a(this),e,{get:s(t),enumerable:!0,configurable:!0})}})},function(e,t,n){var r=n(62),i=n(152),o=n(108),a=n(164).f,s=function(e){return function(t){for(var n,s=o(t),l=i(s),u=l.length,c=0,f=[];u>c;)n=l[c++],r&&!a.call(s,n)||f.push(e?[n,s[n]]:s[n]);return f}};e.exports={entries:s(!0),values:s(!1)}},function(e,t,n){var r=n(11),i=n(60),o=n(132);r({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,(function(e,n){o(t,e,n)}),{AS_ENTRIES:!0}),t}})},function(e,t,n){var r=n(11),i=n(30),o=n(226).f;r({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:o})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(11),i=n(30),o=n(57),a=Object.isExtensible;r({target:"Object",stat:!0,forced:i((function(){a(1)}))},{isExtensible:function(e){return!!o(e)&&(!a||a(e))}})},function(e,t,n){var r=n(55);e.exports=r.Promise},function(e,t,n){var r,i,o,a=n(55),s=n(30),l=n(93),u=n(225),c=n(185),f=n(259),d=n(158),h=a.location,v=a.setImmediate,p=a.clearImmediate,g=a.process,y=a.MessageChannel,m=a.Dispatch,b=0,k={},w="onreadystatechange",C=function(e){if(k.hasOwnProperty(e)){var t=k[e];delete k[e],t()}},R=function(e){return function(){C(e)}},S=function(e){C(e.data)},x=function(e){a.postMessage(e+"",h.protocol+"//"+h.host)};v&&p||(v=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return k[++b]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},r(b),b},p=function(e){delete k[e]},d?r=function(e){g.nextTick(R(e))}:m&&m.now?r=function(e){m.now(R(e))}:y&&!f?(o=(i=new y).port2,i.port1.onmessage=S,r=l(o.postMessage,o,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts&&h&&"file:"!==h.protocol&&!s(x)?(r=x,a.addEventListener("message",S,!1)):r=w in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),C(e)}}:function(e){setTimeout(R(e),0)}),e.exports={set:v,clear:p}},function(e,t,n){var r=n(151);e.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(r)},function(e,t,n){var r=n(25),i=n(57),o=n(176);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(257),a=n(30),s=n(89),l=n(94),u=n(260),c=n(99);if(r({target:"Promise",proto:!0,real:!0,forced:!!o&&a((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=l(this,s("Promise")),n="function"==typeof e;return this.then(n?function(n){return u(t,e()).then((function(){return n}))}:e,n?function(n){return u(t,e()).then((function(){throw n}))}:e)}}),!i&&"function"==typeof o){var f=s("Promise").prototype.finally;o.prototype.finally!==f&&c(o.prototype,"finally",f,{unsafe:!0})}},function(e,t,n){var r=n(11),i=n(57),o=n(25),a=n(90),s=n(96),l=n(112);r({target:"Reflect",stat:!0},{get:function e(t,n){var r,u,c=arguments.length<3?t:arguments[2];return o(t)===c?t[n]:(r=s.f(t,n))?a(r,"value")?r.value:void 0===r.get?void 0:r.get.call(c):i(u=l(t))?e(u,n,c):void 0}})},function(e,t,n){n(11)({target:"Reflect",stat:!0},{has:function(e,t){return t in e}})},function(e,t,n){var r=n(11),i=n(25),o=n(57),a=n(90),s=n(30),l=n(82),u=n(96),c=n(112),f=n(120);r({target:"Reflect",stat:!0,forced:s((function(){var e=function(){},t=l.f(new e,"a",{configurable:!0});return!1!==Reflect.set(e.prototype,"a",1,t)}))},{set:function e(t,n,r){var s,d,h=arguments.length<4?t:arguments[3],v=u.f(i(t),n);if(!v){if(o(d=c(t)))return e(d,n,r,h);v=f(0)}if(a(v,"value")){if(!1===v.writable||!o(h))return!1;if(s=u.f(h,n)){if(s.get||s.set||!1===s.writable)return!1;s.value=r,l.f(h,n,s)}else l.f(h,n,f(0,r));return!0}return void 0!==v.set&&(v.set.call(h,r),!0)}})},function(e,t,n){"use strict";var r=n(11),i=n(203).end;r({target:"String",proto:!0,forced:n(266)},{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(151);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},function(e,t,n){"use strict";var r=n(11),i=n(203).start;r({target:"String",proto:!0,forced:n(266)},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(86),i=Math.floor,o="".replace,a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,s=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,l,u,c){var f=n+e.length,d=l.length,h=s;return void 0!==u&&(u=r(u),h=a),o.call(c,h,(function(r,o){var a;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(f);case"<":a=u[o.slice(1,-1)];break;default:var s=+o;if(0===s)return r;if(s>d){var c=i(s/10);return 0===c?r:c<=d?void 0===l[c-1]?o.charAt(1):l[c-1]+o.charAt(1):r}a=l[s-1]}return void 0===a?"":a}))}},function(e,t,n){var r=n(401);e.exports=function(e,t){var n=r(e);if(n%t)throw RangeError("Wrong offset");return n}},function(e,t,n){var r=n(86),i=n(78),o=n(155),a=n(196),s=n(93),l=n(77).aTypedArrayConstructor;e.exports=function(e){var t,n,u,c,f,d,h=r(e),v=arguments.length,p=v>1?arguments[1]:void 0,g=void 0!==p,y=o(h);if(null!=y&&!a(y))for(d=(f=y.call(h)).next,h=[];!(c=d.call(f)).done;)h.push(c.value);for(g&&v>2&&(p=s(p,arguments[2],2)),n=i(h.length),u=new(l(this))(n),t=0;n>t;t++)u[t]=g?p(h[t],t):h[t];return u}},function(e,t,n){"use strict";var r=n(142),i=n(133).getWeakData,o=n(25),a=n(57),s=n(128),l=n(60),u=n(95),c=n(90),f=n(102),d=f.set,h=f.getterFor,v=u.find,p=u.findIndex,g=0,y=function(e){return e.frozen||(e.frozen=new m)},m=function(){this.entries=[]},b=function(e,t){return v(e.entries,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=b(this,e);if(t)return t[1]},has:function(e){return!!b(this,e)},set:function(e,t){var n=b(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=p(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,u){var f=e((function(e,r){s(e,f,t),d(e,{type:t,id:g++,frozen:void 0}),null!=r&&l(r,e[u],{that:e,AS_ENTRIES:n})})),v=h(t),p=function(e,t,n){var r=v(e),a=i(o(t),!0);return!0===a?y(r).set(t,n):a[r.id]=n,e};return r(f.prototype,{delete:function(e){var t=v(this);if(!a(e))return!1;var n=i(e);return!0===n?y(t).delete(e):n&&c(n,t.id)&&delete n[t.id]},has:function(e){var t=v(this);if(!a(e))return!1;var n=i(e);return!0===n?y(t).has(e):n&&c(n,t.id)}}),r(f.prototype,n?{get:function(e){var t=v(this);if(a(e)){var n=i(e);return!0===n?y(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return p(this,e,t)}}:{add:function(e){return p(this,e,!0)}}),f}}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(273);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(30),i=n(63),o=n(36),a=i("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},function(e,t,n){var r=n(0);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(11),i=n(36),o=n(217);r({target:"WeakMap",proto:!0,real:!0,forced:i},{deleteAll:function(){return o.apply(this,arguments)}})},function(e,t){e.exports=function(e){this.wrapped=e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(0),i=n(219),o=n(452),a=n(138);function s(t){var n="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return a(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.default=e.exports,e.exports.__esModule=!0,s(t)}e.exports=s,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){n(81),n(83),n(281),n(228),n(282),n(140),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(12),n(293),n(294),n(198),n(27),n(34),n(106),n(295),n(296),n(297),n(79),n(24),n(299),n(300),n(17),n(35),n(301),n(19),n(302),n(303),n(304),n(305),n(29),n(306),n(33),n(307),n(54),n(308),n(309),n(310),n(312),n(313),n(314),n(315),n(316),n(318),n(319),n(321),n(322),n(239),n(23),n(240),n(323),n(324),n(61),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(334),n(335),n(336),n(337),n(338),n(206),n(339),n(340),n(341),n(243),n(87),n(342),n(343),n(345),n(207),n(346),n(174),n(347),n(348),n(246),n(248),n(349),n(20),n(350),n(251),n(351),n(352),n(353),n(91),n(100),n(253),n(134),n(354),n(254),n(103),n(355),n(256),n(208),n(356),n(56),n(357),n(358),n(359),n(360),n(361),n(16),n(80),n(363),n(364),n(58),n(369),n(370),n(261),n(371),n(372),n(107),n(210),n(262),n(160),n(373),n(263),n(374),n(211),n(375),n(264),n(376),n(377),n(117),n(32),n(378),n(379),n(380),n(88),n(37),n(381),n(113),n(382),n(26),n(22),n(124),n(383),n(265),n(267),n(384),n(135),n(84),n(385),n(181),n(85),n(104),n(101),n(386),n(387),n(145),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(396),n(397),n(398),n(399),n(400),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(216),n(436),e.exports=n(190)},function(e,t,n){n(105)("asyncIterator")},function(e,t,n){n(105)("isConcatSpreadable")},function(e,t,n){n(105)("match")},function(e,t,n){n(105)("matchAll")},function(e,t,n){n(105)("replace")},function(e,t,n){n(105)("search")},function(e,t,n){n(105)("species")},function(e,t,n){n(105)("split")},function(e,t,n){n(105)("toPrimitive")},function(e,t,n){n(105)("toStringTag")},function(e,t,n){n(105)("unscopables")},function(e,t,n){"use strict";var r=n(11),i=n(112),o=n(122),a=n(116),s=n(98),l=n(120),u=n(60),c=function(e,t){var n=this;if(!(n instanceof c))return new c(e,t);o&&(n=o(new Error(void 0),i(n))),void 0!==t&&s(n,"message",String(t));var r=[];return u(e,r.push,{that:r}),s(n,"errors",r),n};c.prototype=a(Error.prototype,{constructor:l(5,c),message:l(5,""),name:l(5,"AggregateError")}),r({global:!0},{AggregateError:c})},function(e,t,n){var r=n(11),i=n(231),o=n(127);r({target:"Array",proto:!0},{copyWithin:i}),o("copyWithin")},function(e,t,n){"use strict";var r=n(11),i=n(95).every;r({target:"Array",proto:!0,forced:!n(123)("every")},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(11),i=n(232),o=n(86),a=n(78),s=n(111),l=n(153);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=o(this),n=a(t.length),r=l(t,0);return r.length=i(r,t,t,n,0,void 0===e?1:s(e)),r}})},function(e,t,n){"use strict";var r=n(11),i=n(232),o=n(86),a=n(78),s=n(59),l=n(153);r({target:"Array",proto:!0},{flatMap:function(e){var t,n=o(this),r=a(n.length);return s(e),(t=l(n,0)).length=i(t,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},function(e,t,n){"use strict";var r=n(11),i=n(233);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(e,t,n){var r=n(25),i=n(230);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){throw i(e),t}}},function(e,t,n){"use strict";var r=n(11),i=n(149).indexOf,o=n(123),a=[].indexOf,s=!!a&&1/[1].indexOf(1,-0)<0,l=o("indexOf");r({target:"Array",proto:!0,forced:s||!l},{indexOf:function(e){return s?a.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){n(11)({target:"Array",stat:!0},{isArray:n(131)})},function(e,t,n){var r=n(11),i=n(236);r({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},function(e,t,n){"use strict";var r=n(11),i=n(30),o=n(132);r({target:"Array",stat:!0,forced:i((function(){function e(){}return!(Array.of.call(e)instanceof e)}))},{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)o(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(11),i=n(168).left,o=n(123),a=n(139),s=n(158);r({target:"Array",proto:!0,forced:!o("reduce")||!s&&a>79&&a<83},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(11),i=n(168).right,o=n(123),a=n(139),s=n(158);r({target:"Array",proto:!0,forced:!o("reduceRight")||!s&&a>79&&a<83},{reduceRight:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(11),i=n(131),o=[].reverse,a=[1,2];r({target:"Array",proto:!0,forced:String(a)===String(a.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),o.call(this)}})},function(e,t,n){"use strict";var r=n(11),i=n(95).some;r({target:"Array",proto:!0,forced:!n(123)("some")},{some:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){n(141)("Array")},function(e,t,n){n(127)("flat")},function(e,t,n){n(127)("flatMap")},function(e,t,n){"use strict";var r=n(11),i=n(55),o=n(169),a=n(141),s="ArrayBuffer",l=o.ArrayBuffer;r({global:!0,forced:i.ArrayBuffer!==l},{ArrayBuffer:l}),a(s)},function(e,t){var n=Math.abs,r=Math.pow,i=Math.floor,o=Math.log,a=Math.LN2;e.exports={pack:function(e,t,s){var l,u,c,f=new Array(s),d=8*s-t-1,h=(1<<d)-1,v=h>>1,p=23===t?r(2,-24)-r(2,-77):0,g=e<0||0===e&&1/e<0?1:0,y=0;for((e=n(e))!=e||e===1/0?(u=e!=e?1:0,l=h):(l=i(o(e)/a),e*(c=r(2,-l))<1&&(l--,c*=2),(e+=l+v>=1?p/c:p*r(2,1-v))*c>=2&&(l++,c/=2),l+v>=h?(u=0,l=h):l+v>=1?(u=(e*c-1)*r(2,t),l+=v):(u=e*r(2,v-1)*r(2,t),l=0));t>=8;f[y++]=255&u,u/=256,t-=8);for(l=l<<t|u,d+=t;d>0;f[y++]=255&l,l/=256,d-=8);return f[--y]|=128*g,f},unpack:function(e,t){var n,i=e.length,o=8*i-t-1,a=(1<<o)-1,s=a>>1,l=o-7,u=i-1,c=e[u--],f=127&c;for(c>>=7;l>0;f=256*f+e[u],u--,l-=8);for(n=f&(1<<-l)-1,f>>=-l,l+=t;l>0;n=256*n+e[u],u--,l-=8);if(0===f)f=1-s;else{if(f===a)return n?NaN:c?-1/0:1/0;n+=r(2,t),f-=s}return(c?-1:1)*n*r(2,f-t)}}},function(e,t,n){var r=n(11),i=n(77);r({target:"ArrayBuffer",stat:!0,forced:!i.NATIVE_ARRAY_BUFFER_VIEWS},{isView:i.isView})},function(e,t,n){"use strict";var r=n(11),i=n(30),o=n(169),a=n(25),s=n(126),l=n(78),u=n(94),c=o.ArrayBuffer,f=o.DataView,d=c.prototype.slice;r({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:i((function(){return!new c(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(void 0!==d&&void 0===t)return d.call(a(this),e);for(var n=a(this).byteLength,r=s(e,n),i=s(void 0===t?n:t,n),o=new(u(this,c))(l(i-r)),h=new f(this),v=new f(o),p=0;r<i;)v.setUint8(p++,h.getUint8(r++));return o}})},function(e,t,n){var r=n(11),i=n(169);r({global:!0,forced:!n(202)},{DataView:i.DataView})},function(e,t,n){n(11)({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}})},function(e,t,n){var r=n(11),i=n(317);r({target:"Date",proto:!0,forced:Date.prototype.toISOString!==i},{toISOString:i})},function(e,t,n){"use strict";var r=n(30),i=n(203).start,o=Math.abs,a=Date.prototype,s=a.getTime,l=a.toISOString;e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=l.call(new Date(-50000000000001))}))||!r((function(){l.call(new Date(NaN))}))?function(){if(!isFinite(s.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+i(o(t),r?6:4,0)+"-"+i(e.getUTCMonth()+1,2,0)+"-"+i(e.getUTCDate(),2,0)+"T"+i(e.getUTCHours(),2,0)+":"+i(e.getUTCMinutes(),2,0)+":"+i(e.getUTCSeconds(),2,0)+"."+i(n,3,0)+"Z"}:l},function(e,t,n){"use strict";var r=n(11),i=n(30),o=n(86),a=n(114);r({target:"Date",proto:!0,forced:i((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(e){var t=o(this),n=a(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(98),i=n(320),o=n(63)("toPrimitive"),a=Date.prototype;o in a||r(a,o,i)},function(e,t,n){"use strict";var r=n(25),i=n(114);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!==e)}},function(e,t,n){var r=n(99),i=Date.prototype,o="Invalid Date",a="toString",s=i.toString,l=i.getTime;new Date(NaN)+""!=o&&r(i,a,(function(){var e=l.call(this);return e==e?s.call(this):o}))},function(e,t,n){n(11)({target:"Function",proto:!0},{bind:n(238)})},function(e,t,n){var r=n(11),i=n(89),o=n(30),a=i("JSON","stringify"),s=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,u=/^[\uDC00-\uDFFF]$/,c=function(e,t,n){var r=n.charAt(t-1),i=n.charAt(t+1);return l.test(e)&&!u.test(i)||u.test(e)&&!l.test(r)?"\\u"+e.charCodeAt(0).toString(16):e},f=o((function(){return'"\\udf06\\ud834"'!==a("\udf06\ud834")||'"\\udead"'!==a("\udead")}));a&&r({target:"JSON",stat:!0,forced:f},{stringify:function(e,t,n){var r=a.apply(null,arguments);return"string"==typeof r?r.replace(s,c):r}})},function(e,t,n){var r=n(55);n(115)(r.JSON,"JSON",!0)},function(e,t,n){var r=n(11),i=n(242),o=Math.acosh,a=Math.log,s=Math.sqrt,l=Math.LN2;r({target:"Math",stat:!0,forced:!o||710!=Math.floor(o(Number.MAX_VALUE))||o(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?a(e)+l:i(e-1+s(e-1)*s(e+1))}})},function(e,t,n){var r=n(11),i=Math.asinh,o=Math.log,a=Math.sqrt;r({target:"Math",stat:!0,forced:!(i&&1/i(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):o(t+a(t*t+1)):t}})},function(e,t,n){var r=n(11),i=Math.atanh,o=Math.log;r({target:"Math",stat:!0,forced:!(i&&1/i(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:o((1+e)/(1-e))/2}})},function(e,t,n){var r=n(11),i=n(205),o=Math.abs,a=Math.pow;r({target:"Math",stat:!0},{cbrt:function(e){return i(e=+e)*a(o(e),1/3)}})},function(e,t,n){var r=n(11),i=Math.floor,o=Math.log,a=Math.LOG2E;r({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-i(o(e+.5)*a):32}})},function(e,t,n){var r=n(11),i=n(172),o=Math.cosh,a=Math.abs,s=Math.E;r({target:"Math",stat:!0,forced:!o||o(710)===1/0},{cosh:function(e){var t=i(a(e)-1)+1;return(t+1/(t*s*s))*(s/2)}})},function(e,t,n){var r=n(11),i=n(172);r({target:"Math",stat:!0,forced:i!=Math.expm1},{expm1:i})},function(e,t,n){n(11)({target:"Math",stat:!0},{fround:n(333)})},function(e,t,n){var r=n(205),i=Math.abs,o=Math.pow,a=o(2,-52),s=o(2,-23),l=o(2,127)*(2-s),u=o(2,-126);e.exports=Math.fround||function(e){var t,n,o=i(e),c=r(e);return o<u?c*(o/u/s+1/a-1/a)*u*s:(n=(t=(1+s/a)*o)-(t-o))>l||n!=n?c*(1/0):c*n}},function(e,t,n){var r=n(11),i=Math.hypot,o=Math.abs,a=Math.sqrt;r({target:"Math",stat:!0,forced:!!i&&i(1/0,NaN)!==1/0},{hypot:function(e,t){for(var n,r,i=0,s=0,l=arguments.length,u=0;s<l;)u<(n=o(arguments[s++]))?(i=i*(r=u/n)*r+1,u=n):i+=n>0?(r=n/u)*r:n;return u===1/0?1/0:u*a(i)}})},function(e,t,n){var r=n(11),i=n(30),o=Math.imul;r({target:"Math",stat:!0,forced:i((function(){return-5!=o(4294967295,5)||2!=o.length}))},{imul:function(e,t){var n=65535,r=+e,i=+t,o=n&r,a=n&i;return 0|o*a+((n&r>>>16)*a+o*(n&i>>>16)<<16>>>0)}})},function(e,t,n){var r=n(11),i=Math.log,o=Math.LOG10E;r({target:"Math",stat:!0},{log10:function(e){return i(e)*o}})},function(e,t,n){n(11)({target:"Math",stat:!0},{log1p:n(242)})},function(e,t,n){var r=n(11),i=Math.log,o=Math.LN2;r({target:"Math",stat:!0},{log2:function(e){return i(e)/o}})},function(e,t,n){var r=n(11),i=n(30),o=n(172),a=Math.abs,s=Math.exp,l=Math.E;r({target:"Math",stat:!0,forced:i((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return a(e=+e)<1?(o(e)-o(-e))/2:(s(e-1)-s(-e-1))*(l/2)}})},function(e,t,n){var r=n(11),i=n(172),o=Math.exp;r({target:"Math",stat:!0},{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},function(e,t,n){n(115)(Math,"Math",!0)},function(e,t,n){n(11)({target:"Number",stat:!0},{EPSILON:Math.pow(2,-52)})},function(e,t,n){n(11)({target:"Number",stat:!0},{isFinite:n(344)})},function(e,t,n){var r=n(55).isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&r(e)}},function(e,t,n){n(11)({target:"Number",stat:!0},{isInteger:n(244)})},function(e,t,n){var r=n(11),i=n(244),o=Math.abs;r({target:"Number",stat:!0},{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,n){n(11)({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(11),i=n(245);r({target:"Number",stat:!0,forced:Number.parseFloat!=i},{parseFloat:i})},function(e,t,n){"use strict";var r=n(11),i=n(30),o=n(249),a=1..toPrecision;r({target:"Number",proto:!0,forced:i((function(){return"1"!==a.call(1,void 0)}))||!i((function(){a.call({})}))},{toPrecision:function(e){return void 0===e?a.call(o(this)):a.call(o(this),e)}})},function(e,t,n){n(11)({target:"Object",stat:!0,sham:!n(62)},{create:n(116)})},function(e,t,n){var r=n(11),i=n(62);r({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperties:n(194)})},function(e,t,n){var r=n(11),i=n(62);r({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperty:n(82).f})},function(e,t,n){"use strict";var r=n(11),i=n(62),o=n(175),a=n(86),s=n(59),l=n(82);i&&r({target:"Object",proto:!0,forced:o},{__defineSetter__:function(e,t){l.f(a(this),e,{set:s(t),enumerable:!0,configurable:!0})}})},function(e,t,n){var r=n(11),i=n(62),o=n(189),a=n(108),s=n(96),l=n(132);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),i=s.f,u=o(r),c={},f=0;u.length>f;)void 0!==(n=i(r,t=u[f++]))&&l(c,t,n);return c}})},function(e,t,n){n(11)({target:"Object",stat:!0},{is:n(255)})},function(e,t,n){var r=n(11),i=n(30),o=n(57),a=Object.isSealed;r({target:"Object",stat:!0,forced:i((function(){a(1)}))},{isSealed:function(e){return!o(e)||!!a&&a(e)}})},function(e,t,n){"use strict";var r=n(11),i=n(62),o=n(175),a=n(86),s=n(114),l=n(112),u=n(96).f;i&&r({target:"Object",proto:!0,forced:o},{__lookupGetter__:function(e){var t,n=a(this),r=s(e,!0);do{if(t=u(n,r))return t.get}while(n=l(n))}})},function(e,t,n){"use strict";var r=n(11),i=n(62),o=n(175),a=n(86),s=n(114),l=n(112),u=n(96).f;i&&r({target:"Object",proto:!0,forced:o},{__lookupSetter__:function(e){var t,n=a(this),r=s(e,!0);do{if(t=u(n,r))return t.set}while(n=l(n))}})},function(e,t,n){var r=n(11),i=n(57),o=n(133).onFreeze,a=n(159),s=n(30),l=Object.preventExtensions;r({target:"Object",stat:!0,forced:s((function(){l(1)})),sham:!a},{preventExtensions:function(e){return l&&i(e)?l(o(e)):e}})},function(e,t,n){var r=n(11),i=n(57),o=n(133).onFreeze,a=n(159),s=n(30),l=Object.seal;r({target:"Object",stat:!0,forced:s((function(){l(1)})),sham:!a},{seal:function(e){return l&&i(e)?l(o(e)):e}})},function(e,t,n){n(11)({target:"Object",stat:!0},{setPrototypeOf:n(122)})},function(e,t,n){"use strict";var r=n(197),i=n(156);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,n){var r=n(11),i=n(245);r({global:!0,forced:parseFloat!=i},{parseFloat:i})},function(e,t,n){var r=n(11),i=n(247);r({global:!0,forced:parseInt!=i},{parseInt:i})},function(e,t,n){var r,i,o,a,s,l,u,c,f=n(55),d=n(96).f,h=n(258).set,v=n(259),p=n(366),g=n(158),y=f.MutationObserver||f.WebKitMutationObserver,m=f.document,b=f.process,k=f.Promise,w=d(f,"queueMicrotask"),C=w&&w.value;C||(r=function(){var e,t;for(g&&(e=b.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?a():o=void 0,e}}o=void 0,e&&e.enter()},v||g||p||!y||!m?k&&k.resolve?((u=k.resolve(void 0)).constructor=k,c=u.then,a=function(){c.call(u,r)}):a=g?function(){b.nextTick(r)}:function(){h.call(f,r)}:(s=!0,l=m.createTextNode(""),new y(r).observe(l,{characterData:!0}),a=function(){l.data=s=!s})),e.exports=C||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,a()),o=t}},function(e,t,n){var r=n(151);e.exports=/web0s(?!.*chrome)/i.test(r)},function(e,t,n){var r=n(55);e.exports=function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},function(e,t){e.exports="object"==typeof window},function(e,t,n){"use strict";var r=n(11),i=n(59),o=n(176),a=n(209),s=n(60);r({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=o.f(t),r=n.resolve,l=n.reject,u=a((function(){var n=i(t.resolve),o=[],a=0,l=1;s(e,(function(e){var i=a++,s=!1;o.push(void 0),l++,n.call(t,e).then((function(e){s||(s=!0,o[i]={status:"fulfilled",value:e},--l||r(o))}),(function(e){s||(s=!0,o[i]={status:"rejected",reason:e},--l||r(o))}))})),--l||r(o)}));return u.error&&l(u.value),n.promise}})},function(e,t,n){"use strict";var r=n(11),i=n(59),o=n(89),a=n(176),s=n(209),l=n(60),u="No one promise resolved";r({target:"Promise",stat:!0},{any:function(e){var t=this,n=a.f(t),r=n.resolve,c=n.reject,f=s((function(){var n=i(t.resolve),a=[],s=0,f=1,d=!1;l(e,(function(e){var i=s++,l=!1;a.push(void 0),f++,n.call(t,e).then((function(e){l||d||(d=!0,r(e))}),(function(e){l||d||(l=!0,a[i]=e,--f||c(new(o("AggregateError"))(a,u)))}))})),--f||c(new(o("AggregateError"))(a,u))}));return f.error&&c(f.value),n.promise}})},function(e,t,n){var r=n(11),i=n(89),o=n(59),a=n(25),s=n(30),l=i("Reflect","apply"),u=Function.apply;r({target:"Reflect",stat:!0,forced:!s((function(){l((function(){}))}))},{apply:function(e,t,n){return o(e),a(n),l?l(e,t,n):u.call(e,t,n)}})},function(e,t,n){var r=n(11),i=n(89),o=n(59),a=n(25),s=n(57),l=n(116),u=n(238),c=n(30),f=i("Reflect","construct"),d=c((function(){function e(){}return!(f((function(){}),[],e)instanceof e)})),h=!c((function(){f((function(){}))})),v=d||h;r({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(h&&!d)return f(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var i=n.prototype,c=l(s(i)?i:Object.prototype),v=Function.apply.call(e,c,t);return s(v)?v:c}})},function(e,t,n){var r=n(11),i=n(25),o=n(112);r({target:"Reflect",stat:!0,sham:!n(195)},{getPrototypeOf:function(e){return o(i(e))}})},function(e,t,n){var r=n(11),i=n(25),o=Object.isExtensible;r({target:"Reflect",stat:!0},{isExtensible:function(e){return i(e),!o||o(e)}})},function(e,t,n){var r=n(11),i=n(89),o=n(25);r({target:"Reflect",stat:!0,sham:!n(159)},{preventExtensions:function(e){o(e);try{var t=i("Object","preventExtensions");return t&&t(e),!0}catch(e){return!1}}})},function(e,t,n){var r=n(11),i=n(25),o=n(229),a=n(122);a&&r({target:"Reflect",stat:!0},{setPrototypeOf:function(e,t){i(e),o(t);try{return a(e,t),!0}catch(e){return!1}}})},function(e,t,n){var r=n(11),i=n(55),o=n(115);r({global:!0},{Reflect:{}}),o(i.Reflect,"Reflect",!0)},function(e,t,n){var r=n(62),i=n(82),o=n(144),a=n(162).UNSUPPORTED_Y;r&&("g"!=/./g.flags||a)&&i.f(RegExp.prototype,"flags",{configurable:!0,get:o})},function(e,t,n){var r=n(62),i=n(162).UNSUPPORTED_Y,o=n(82).f,a=n(102).get,s=RegExp.prototype;r&&i&&o(RegExp.prototype,"sticky",{configurable:!0,get:function(){if(this!==s){if(this instanceof RegExp)return!!a(this).sticky;throw TypeError("Incompatible receiver, RegExp required")}}})},function(e,t,n){"use strict";n(32);var r,i,o=n(11),a=n(57),s=(r=!1,(i=/[ac]/).exec=function(){return r=!0,/./.exec.apply(this,arguments)},!0===i.test("abc")&&r),l=/./.test;o({target:"RegExp",proto:!0,forced:!s},{test:function(e){if("function"!=typeof this.exec)return l.call(this,e);var t=this.exec(e);if(null!==t&&!a(t))throw new Error("RegExp exec method returned something other than an Object or null");return!!t}})},function(e,t,n){"use strict";var r=n(11),i=n(163).codeAt;r({target:"String",proto:!0},{codePointAt:function(e){return i(this,e)}})},function(e,t,n){var r=n(11),i=n(126),o=String.fromCharCode,a=String.fromCodePoint;r({target:"String",stat:!0,forced:!!a&&1!=a.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){"use strict";var r=n(11),i=n(201),o=n(97),a=n(78),s=n(59),l=n(25),u=n(121),c=n(161),f=n(144),d=n(98),h=n(30),v=n(63),p=n(94),g=n(179),y=n(102),m=n(36),b=v("matchAll"),k="RegExp String",w="RegExp String Iterator",C=y.set,R=y.getterFor(w),S=RegExp.prototype,x=S.exec,E="".matchAll,D=!!E&&!h((function(){"a".matchAll(/./)})),T=i((function(e,t,n,r){C(this,{type:w,regexp:e,string:t,global:n,unicode:r,done:!1})}),k,(function(){var e=R(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,n=e.string,r=function(e,t){var n,r=e.exec;if("function"==typeof r){if("object"!=typeof(n=r.call(e,t)))throw TypeError("Incorrect exec result");return n}return x.call(e,t)}(t,n);return null===r?{value:void 0,done:e.done=!0}:e.global?(""==String(r[0])&&(t.lastIndex=g(n,a(t.lastIndex),e.unicode)),{value:r,done:!1}):(e.done=!0,{value:r,done:!1})})),O=function(e){var t,n,r,i,o,s,u=l(this),c=String(e);return t=p(u,RegExp),void 0===(n=u.flags)&&u instanceof RegExp&&!("flags"in S)&&(n=f.call(u)),r=void 0===n?"":String(n),i=new t(t===RegExp?u.source:u,r),o=!!~r.indexOf("g"),s=!!~r.indexOf("u"),i.lastIndex=a(u.lastIndex),new T(i,c,o,s)};r({target:"String",proto:!0,forced:D},{matchAll:function(e){var t,n,r,i=o(this);if(null!=e){if(c(e)&&!~String(o("flags"in S?e.flags:f.call(e))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(D)return E.apply(i,arguments);if(void 0===(n=e[b])&&m&&"RegExp"==u(e)&&(n=O),null!=n)return s(n).call(e,i)}else if(D)return E.apply(i,arguments);return t=String(i),r=new RegExp(e,"g"),m?O.call(r,t):r[b](t)}}),m||b in S||d(S,b,O)},function(e,t,n){var r=n(11),i=n(108),o=n(78);r({target:"String",stat:!0},{raw:function(e){for(var t=i(e.raw),n=o(t.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(t[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,n){"use strict";var r=n(11),i=n(97),o=n(161),a=n(144),s=n(268),l=n(63),u=n(36),c=l("replace"),f=RegExp.prototype,d=Math.max,h=function(e,t,n){return n>e.length?-1:""===t?n:e.indexOf(t,n)};r({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,l,v,p,g,y,m,b=i(this),k=0,w=0,C="";if(null!=e){if((n=o(e))&&!~String(i("flags"in f?e.flags:a.call(e))).indexOf("g"))throw TypeError("`.replaceAll` does not allow non-global regexes");if(void 0!==(r=e[c]))return r.call(e,b,t);if(u&&n)return String(b).replace(e,t)}for(l=String(b),v=String(e),(p="function"==typeof t)||(t=String(t)),g=v.length,y=d(1,g),k=h(l,v,0);-1!==k;)m=p?String(t(v,k,l)):s(v,l,k,[],void 0,t),C+=l.slice(w,k)+m,w=k+g,k=h(l,v,k+y);return w<l.length&&(C+=l.slice(w)),C}})},function(e,t,n){"use strict";var r=n(11),i=n(143).end,o=n(214)("trimEnd"),a=o?function(){return i(this)}:"".trimEnd;r({target:"String",proto:!0,forced:o},{trimEnd:a,trimRight:a})},function(e,t,n){"use strict";var r=n(11),i=n(143).start,o=n(214)("trimStart"),a=o?function(){return i(this)}:"".trimStart;r({target:"String",proto:!0,forced:o},{trimStart:a,trimLeft:a})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("big")},{big:function(){return i(this,"big","","")}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("blink")},{blink:function(){return i(this,"blink","","")}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("bold")},{bold:function(){return i(this,"b","","")}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("fixed")},{fixed:function(){return i(this,"tt","","")}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("fontcolor")},{fontcolor:function(e){return i(this,"font","color",e)}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("fontsize")},{fontsize:function(e){return i(this,"font","size",e)}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("italics")},{italics:function(){return i(this,"i","","")}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("link")},{link:function(e){return i(this,"a","href",e)}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("small")},{small:function(){return i(this,"small","","")}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("strike")},{strike:function(){return i(this,"strike","","")}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("sub")},{sub:function(){return i(this,"sub","","")}})},function(e,t,n){"use strict";var r=n(11),i=n(109);r({target:"String",proto:!0,forced:n(110)("sup")},{sup:function(){return i(this,"sup","","")}})},function(e,t,n){n(125)("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){var r=n(111);e.exports=function(e){var t=r(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}},function(e,t,n){n(125)("Float64",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(125)("Int8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(125)("Int16",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(125)("Int32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(125)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(125)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},function(e,t,n){n(125)("Uint16",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(125)("Uint32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){"use strict";var r=n(77),i=n(231),o=r.aTypedArray;(0,r.exportTypedArrayMethod)("copyWithin",(function(e,t){return i.call(o(this),e,t,arguments.length>2?arguments[2]:void 0)}))},function(e,t,n){"use strict";var r=n(77),i=n(95).every,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("every",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(77),i=n(199),o=r.aTypedArray;(0,r.exportTypedArrayMethod)("fill",(function(e){return i.apply(o(this),arguments)}))},function(e,t,n){"use strict";var r=n(77),i=n(95).filter,o=n(414),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("filter",(function(e){var t=i(a(this),e,arguments.length>1?arguments[1]:void 0);return o(this,t)}))},function(e,t,n){var r=n(77).aTypedArrayConstructor,i=n(94);e.exports=function(e,t){for(var n=i(e,e.constructor),o=0,a=t.length,s=new(r(n))(a);a>o;)s[o]=t[o++];return s}},function(e,t,n){"use strict";var r=n(77),i=n(95).find,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(77),i=n(95).findIndex,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("findIndex",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(77),i=n(95).forEach,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("forEach",(function(e){i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(215);(0,n(77).exportTypedArrayStaticMethod)("from",n(270),r)},function(e,t,n){"use strict";var r=n(77),i=n(149).includes,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("includes",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(77),i=n(149).indexOf,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("indexOf",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(55),i=n(77),o=n(17),a=n(63)("iterator"),s=r.Uint8Array,l=o.values,u=o.keys,c=o.entries,f=i.aTypedArray,d=i.exportTypedArrayMethod,h=s&&s.prototype[a],v=!!h&&("values"==h.name||null==h.name),p=function(){return l.call(f(this))};d("entries",(function(){return c.call(f(this))})),d("keys",(function(){return u.call(f(this))})),d("values",p,!v),d(a,p,!v)},function(e,t,n){"use strict";var r=n(77),i=r.aTypedArray,o=r.exportTypedArrayMethod,a=[].join;o("join",(function(e){return a.apply(i(this),arguments)}))},function(e,t,n){"use strict";var r=n(77),i=n(236),o=r.aTypedArray;(0,r.exportTypedArrayMethod)("lastIndexOf",(function(e){return i.apply(o(this),arguments)}))},function(e,t,n){"use strict";var r=n(77),i=n(95).map,o=n(94),a=r.aTypedArray,s=r.aTypedArrayConstructor;(0,r.exportTypedArrayMethod)("map",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(s(o(e,e.constructor)))(t)}))}))},function(e,t,n){"use strict";var r=n(77),i=n(215),o=r.aTypedArrayConstructor;(0,r.exportTypedArrayStaticMethod)("of",(function(){for(var e=0,t=arguments.length,n=new(o(this))(t);t>e;)n[e]=arguments[e++];return n}),i)},function(e,t,n){"use strict";var r=n(77),i=n(168).left,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(function(e){return i(o(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(77),i=n(168).right,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduceRight",(function(e){return i(o(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(77),i=r.aTypedArray,o=r.exportTypedArrayMethod,a=Math.floor;o("reverse",(function(){for(var e,t=this,n=i(t).length,r=a(n/2),o=0;o<r;)e=t[o],t[o++]=t[--n],t[n]=e;return t}))},function(e,t,n){"use strict";var r=n(77),i=n(78),o=n(269),a=n(86),s=n(30),l=r.aTypedArray;(0,r.exportTypedArrayMethod)("set",(function(e){l(this);var t=o(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=a(e),s=i(r.length),u=0;if(s+t>n)throw RangeError("Wrong length");for(;u<s;)this[t+u]=r[u++]}),s((function(){new Int8Array(1).set({})})))},function(e,t,n){"use strict";var r=n(77),i=n(94),o=n(30),a=r.aTypedArray,s=r.aTypedArrayConstructor,l=r.exportTypedArrayMethod,u=[].slice;l("slice",(function(e,t){for(var n=u.call(a(this),e,t),r=i(this,this.constructor),o=0,l=n.length,c=new(s(r))(l);l>o;)c[o]=n[o++];return c}),o((function(){new Int8Array(1).slice()})))},function(e,t,n){"use strict";var r=n(77),i=n(95).some,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("some",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(77),i=r.aTypedArray,o=r.exportTypedArrayMethod,a=[].sort;o("sort",(function(e){return a.call(i(this),e)}))},function(e,t,n){"use strict";var r=n(77),i=n(78),o=n(126),a=n(94),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("subarray",(function(e,t){var n=s(this),r=n.length,l=o(e,r);return new(a(n,n.constructor))(n.buffer,n.byteOffset+l*n.BYTES_PER_ELEMENT,i((void 0===t?r:o(t,r))-l))}))},function(e,t,n){"use strict";var r=n(55),i=n(77),o=n(30),a=r.Int8Array,s=i.aTypedArray,l=i.exportTypedArrayMethod,u=[].toLocaleString,c=[].slice,f=!!a&&o((function(){u.call(new a(1))}));l("toLocaleString",(function(){return u.apply(f?c.call(s(this)):s(this),arguments)}),o((function(){return[1,2].toLocaleString()!=new a([1,2]).toLocaleString()}))||!o((function(){a.prototype.toLocaleString.call([1,2])})))},function(e,t,n){"use strict";var r=n(77).exportTypedArrayMethod,i=n(30),o=n(55).Uint8Array,a=o&&o.prototype||{},s=[].toString,l=[].join;i((function(){s.call({})}))&&(s=function(){return l.call(this)});var u=a.toString!=s;r("toString",s,u)},function(e,t,n){"use strict";n(170)("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(271))},function(e,t,n){(function(r){var i,o;void 0===(o="function"==typeof(i=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}function c(e){var t=s();return function(){var n,r=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}var h=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(t,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r].callback===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++){var i=t[n];try{i.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}i.options&&i.options.once&&this.removeEventListener(e.type,i.callback)}return!e.defaultPrevented}}}]),t}(),v=function(t){i(a,t);var r=c(a);function a(){var t;return e(this,a),(t=r.call(this)).listeners||h.call(l(t)),Object.defineProperty(l(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(l(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return n(a,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),d(o(a.prototype),"dispatchEvent",this).call(this,e)}}]),a}(h),p=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new v,writable:!0,configurable:!0})}return n(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();function g(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}function y(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=void 0===r?n.Request:r,o=t.AbortController,a=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,s=void 0!==a&&a;if(!g({fetch:n,Request:i,AbortController:o,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:s}))return{fetch:n,Request:l};var l=i;(l&&!l.prototype.hasOwnProperty("signal")||s)&&((l=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var r=new i(e,t);return n&&Object.defineProperty(r,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),r}).prototype=i.prototype);var u=n;return{fetch:function(e,t){var n=l&&l.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var r;try{r=new DOMException("Aborted","AbortError")}catch(e){(r=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(r);var i=new Promise((function(e,t){n.addEventListener("abort",(function(){return t(r)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([i,u(e,t)])}return u(e,t)},Request:l}}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(p.prototype[Symbol.toStringTag]="AbortController",v.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(g(e))if(e.fetch){var t=y(e),n=t.fetch,r=t.Request;e.fetch=n,e.Request=r,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:p}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:v})}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:r)})?i.call(t,n,t,e):i)||(e.exports=o)}).call(this,n(184))},function(e,t,n){var r=n(273);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,u=[],c=!1,f=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&h())}function h(){if(!c){var e=s(d);c=!0;for(var t=u.length;t;){for(l=u,u=[];++f<t;)l&&l[f].run();f=-1,t=u.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new v(e,t)),1!==u.length||c||s(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){n(240)},function(e,t,n){"use strict";var r=2147483647,i=/[^\0-\u007E]/,o=/[.\u3002\uFF0E\uFF61]/g,a="Overflow: input needs wider integers to process",s=Math.floor,l=String.fromCharCode,u=function(e){return e+22+75*(e<26)},c=function(e,t,n){var r=0;for(e=n?s(e/700):e>>1,e+=s(e/t);e>455;r+=36)e=s(e/35);return s(r+36*e/(e+38))},f=function(e){var t,n,i=[],o=(e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),n--)}else t.push(i)}return t}(e)).length,f=128,d=0,h=72;for(t=0;t<e.length;t++)(n=e[t])<128&&i.push(l(n));var v=i.length,p=v;for(v&&i.push("-");p<o;){var g=r;for(t=0;t<e.length;t++)(n=e[t])>=f&&n<g&&(g=n);var y=p+1;if(g-f>s((r-d)/y))throw RangeError(a);for(d+=(g-f)*y,f=g,t=0;t<e.length;t++){if((n=e[t])<f&&++d>r)throw RangeError(a);if(n==f){for(var m=d,b=36;;b+=36){var k=b<=h?1:b>=h+26?26:b-h;if(m<k)break;var w=m-k,C=36-k;i.push(l(u(k+w%C))),m=s(w/C)}i.push(l(u(m))),h=c(d,y,p==v),d=0,++p}}++d,++f}return i.join("")};e.exports=function(e){var t,n,r=[],a=e.toLowerCase().replace(o,".").split(".");for(t=0;t<a.length;t++)n=a[t],r.push(i.test(n)?"xn--"+f(n):n);return r.join(".")}},function(e,t,n){"use strict";n(17);var r=n(11),i=n(89),o=n(275),a=n(99),s=n(142),l=n(115),u=n(201),c=n(102),f=n(128),d=n(90),h=n(93),v=n(156),p=n(25),g=n(57),y=n(116),m=n(120),b=n(182),k=n(155),w=n(63),C=i("fetch"),R=i("Headers"),S=w("iterator"),x="URLSearchParams",E="URLSearchParamsIterator",D=c.set,T=c.getterFor(x),O=c.getterFor(E),M=/\+/g,A=Array(4),I=function(e){return A[e-1]||(A[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},P=function(e){try{return decodeURIComponent(e)}catch(t){return e}},F=function(e){var t=e.replace(M," "),n=4;try{return decodeURIComponent(t)}catch(e){for(;n;)t=t.replace(I(n--),P);return t}},L=/[!'()~]|%20/g,B={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},j=function(e){return B[e]},_=function(e){return encodeURIComponent(e).replace(L,j)},H=function(e,t){if(t)for(var n,r,i=t.split("&"),o=0;o<i.length;)(n=i[o++]).length&&(r=n.split("="),e.push({key:F(r.shift()),value:F(r.join("="))}))},N=function(e){this.entries.length=0,H(this.entries,e)},z=function(e,t){if(e<t)throw TypeError("Not enough arguments")},V=u((function(e,t){D(this,{type:E,iterator:b(T(e).entries),kind:t})}),"Iterator",(function(){var e=O(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n})),W=function(){f(this,W,x);var e,t,n,r,i,o,a,s,l,u=arguments.length>0?arguments[0]:void 0,c=this,h=[];if(D(c,{type:x,entries:h,updateURL:function(){},updateSearchParams:N}),void 0!==u)if(g(u))if("function"==typeof(e=k(u)))for(n=(t=e.call(u)).next;!(r=n.call(t)).done;){if((a=(o=(i=b(p(r.value))).next).call(i)).done||(s=o.call(i)).done||!o.call(i).done)throw TypeError("Expected sequence with length 2");h.push({key:a.value+"",value:s.value+""})}else for(l in u)d(u,l)&&h.push({key:l,value:u[l]+""});else H(h,"string"==typeof u?"?"===u.charAt(0)?u.slice(1):u:u+"")},$=W.prototype;s($,{append:function(e,t){z(arguments.length,2);var n=T(this);n.entries.push({key:e+"",value:t+""}),n.updateURL()},delete:function(e){z(arguments.length,1);for(var t=T(this),n=t.entries,r=e+"",i=0;i<n.length;)n[i].key===r?n.splice(i,1):i++;t.updateURL()},get:function(e){z(arguments.length,1);for(var t=T(this).entries,n=e+"",r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){z(arguments.length,1);for(var t=T(this).entries,n=e+"",r=[],i=0;i<t.length;i++)t[i].key===n&&r.push(t[i].value);return r},has:function(e){z(arguments.length,1);for(var t=T(this).entries,n=e+"",r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){z(arguments.length,1);for(var n,r=T(this),i=r.entries,o=!1,a=e+"",s=t+"",l=0;l<i.length;l++)(n=i[l]).key===a&&(o?i.splice(l--,1):(o=!0,n.value=s));o||i.push({key:a,value:s}),r.updateURL()},sort:function(){var e,t,n,r=T(this),i=r.entries,o=i.slice();for(i.length=0,n=0;n<o.length;n++){for(e=o[n],t=0;t<n;t++)if(i[t].key>e.key){i.splice(t,0,e);break}t===n&&i.push(e)}r.updateURL()},forEach:function(e){for(var t,n=T(this).entries,r=h(e,arguments.length>1?arguments[1]:void 0,3),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new V(this,"keys")},values:function(){return new V(this,"values")},entries:function(){return new V(this,"entries")}},{enumerable:!0}),a($,S,$.entries),a($,"toString",(function(){for(var e,t=T(this).entries,n=[],r=0;r<t.length;)e=t[r++],n.push(_(e.key)+"="+_(e.value));return n.join("&")}),{enumerable:!0}),l(W,x),r({global:!0,forced:!o},{URLSearchParams:W}),o||"function"!=typeof C||"function"!=typeof R||r({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,n,r,i=[e];return arguments.length>1&&(g(t=arguments[1])&&(n=t.body,v(n)===x&&((r=t.headers?new R(t.headers):new R).has("content-type")||r.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=y(t,{body:m(0,String(n)),headers:m(0,r)}))),i.push(t)),C.apply(this,i)}}),e.exports={URLSearchParams:W,getState:T}},function(e,t,n){"use strict";var r=n(25),i=n(59);e.exports=function(){for(var e=r(this),t=i(e.add),n=0,o=arguments.length;n<o;n++)t.call(e,arguments[n]);return e}},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(278);function i(e){var t,n;function i(t,n){try{var a=e[t](n),s=a.value,l=s instanceof r;Promise.resolve(l?s.wrapped:s).then((function(e){l?i("return"===t?"return":"next",e):o(a.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(11),i=n(163).charAt;r({target:"String",proto:!0,forced:n(30)((function(){return"𠮷"!=="𠮷".at(0)}))},{at:function(e){return i(this,e)}})},function(e,t,n){"use strict";n.r(t),n.d(t,"Base",(function(){return $e})),n.d(t,"Config",(function(){return De})),n.d(t,"GlobalEvents",(function(){return Fi})),n.d(t,"AjaxStore",(function(){return ss})),n.d(t,"DomDataStore",(function(){return ls})),n.d(t,"Duration",(function(){return Bo})),n.d(t,"Model",(function(){return Lo})),n.d(t,"Store",(function(){return ts})),n.d(t,"BooleanDataField",(function(){return vo})),n.d(t,"DataField",(function(){return uo})),n.d(t,"DateDataField",(function(){return go})),n.d(t,"IntegerDataField",(function(){return mo})),n.d(t,"ModelDataField",(function(){return ko})),n.d(t,"NumberDataField",(function(){return Co})),n.d(t,"ObjectDataField",(function(){return So})),n.d(t,"StringDataField",(function(){return Eo})),n.d(t,"StoreChained",(function(){return Ba})),n.d(t,"StoreCRUD",(function(){return ha})),n.d(t,"StoreFilter",(function(){return pa})),n.d(t,"StoreGroup",(function(){return ma})),n.d(t,"StoreProxy",(function(){return wa})),n.d(t,"StoreRelation",(function(){return Ra})),n.d(t,"StoreSearch",(function(){return Aa})),n.d(t,"StoreSort",(function(){return Pa})),n.d(t,"StoreState",(function(){return _a})),n.d(t,"StoreSum",(function(){return xa})),n.d(t,"StoreSync",(function(){return qa})),n.d(t,"StoreTree",(function(){return Wa})),n.d(t,"TreeNode",(function(){return eo})),n.d(t,"ActionBase",(function(){return fs})),n.d(t,"ModelStm",(function(){return Xi})),n.d(t,"StateBase",(function(){return ps})),n.d(t,"StateTrackingManager",(function(){return ql})),n.d(t,"StoreStm",(function(){return Za})),n.d(t,"Transaction",(function(){return Is})),n.d(t,"ContextMenuBase",(function(){return Bf})),n.d(t,"AjaxHelper",(function(){return Vt})),n.d(t,"ArrayHelper",(function(){return it})),n.d(t,"AsyncHelper",(function(){return Ft})),n.d(t,"BrowserHelper",(function(){return pe.a})),n.d(t,"CSSHelper",(function(){return jf})),n.d(t,"DateHelper",(function(){return Un})),n.d(t,"DomHelper",(function(){return mi})),n.d(t,"DomSync",(function(){return du})),n.d(t,"DragHelper",(function(){return Xf})),n.d(t,"EventHelper",(function(){return Tu})),n.d(t,"FunctionHelper",(function(){return at})),n.d(t,"IdHelper",(function(){return Wo})),n.d(t,"ObjectHelper",(function(){return Qn})),n.d(t,"ResizeHelper",(function(){return ad})),n.d(t,"ResizeMonitor",(function(){return bu})),n.d(t,"StringHelper",(function(){return te})),n.d(t,"TemplateHelper",(function(){return ud})),n.d(t,"VersionHelper",(function(){return z.a})),n.d(t,"WidgetHelper",(function(){return vd})),n.d(t,"XMLHelper",(function(){return yd})),n.d(t,"DataGenerator",(function(){return bd})),n.d(t,"DemoBot",(function(){return Cd})),n.d(t,"DomClassList",(function(){return xr})),n.d(t,"Formatter",(function(){return Ed})),n.d(t,"Fullscreen",(function(){return hu})),n.d(t,"NumberFormat",(function(){return Pd})),n.d(t,"Objects",(function(){return he})),n.d(t,"Point",(function(){return wu})),n.d(t,"Promissory",(function(){return zu})),n.d(t,"RandomGenerator",(function(){return md})),n.d(t,"Rectangle",(function(){return Cr})),n.d(t,"Scroller",(function(){return ju})),n.d(t,"LocaleHelper",(function(){return Ut})),n.d(t,"LocaleManager",(function(){return Yt})),n.d(t,"Localizable",(function(){return en})),n.d(t,"Delayable",(function(){return el})),n.d(t,"Draggable",(function(){return Gd})),n.d(t,"Droppable",(function(){return qd})),n.d(t,"Events",(function(){return Ot})),n.d(t,"Factoryable",(function(){return ao})),n.d(t,"Featureable",(function(){return Jd})),n.d(t,"Finalizable",(function(){return Ld})),n.d(t,"Hoverable",(function(){return sh})),n.d(t,"Identifiable",(function(){return Gi})),n.d(t,"InstancePlugin",(function(){return _i})),n.d(t,"LoadMaskable",(function(){return uh})),n.d(t,"Override",(function(){return fh})),n.d(t,"Pluggable",(function(){return Ni})),n.d(t,"State",(function(){return Vi})),n.d(t,"Bag",(function(){return sa})),n.d(t,"ClickRepeater",(function(){return Oc})),n.d(t,"Collection",(function(){return na})),n.d(t,"CollectionFilter",(function(){return zo})),n.d(t,"CollectionSorter",(function(){return Uo})),n.d(t,"ScrollManager",(function(){return hh})),n.d(t,"DragContext",(function(){return Vd})),n.d(t,"DragProxy",(function(){return $d})),n.d(t,"DragTipProxy",(function(){return Ch})),n.d(t,"DynamicObject",(function(){return Dc})),n.d(t,"DayTime",(function(){return Dh})),n.d(t,"Month",(function(){return Oh})),n.d(t,"Parser",(function(){return Xh})),n.d(t,"UndoRedoBase",(function(){return Tv})),n.d(t,"BooleanCombo",(function(){return Mv})),n.d(t,"Button",(function(){return nf})),n.d(t,"ButtonGroup",(function(){return Iv})),n.d(t,"CalendarPanel",(function(){return Fv})),n.d(t,"Checkbox",(function(){return Bv})),n.d(t,"ChipView",(function(){return bv})),n.d(t,"Combo",(function(){return Sv})),n.d(t,"Container",(function(){return Rc})),n.d(t,"DateField",(function(){return $v})),n.d(t,"DatePicker",(function(){return Vv})),n.d(t,"DateTimeField",(function(){return Jv})),n.d(t,"DisplayField",(function(){return ep})),n.d(t,"DurationField",(function(){return np})),n.d(t,"Editor",(function(){return sp})),n.d(t,"Field",(function(){return tv})),n.d(t,"FileField",(function(){return up})),n.d(t,"FilePicker",(function(){return fp})),n.d(t,"FilterField",(function(){return hp})),n.d(t,"Label",(function(){return pp})),n.d(t,"List",(function(){return yv})),n.d(t,"Mask",(function(){return qu})),n.d(t,"Menu",(function(){return Ff})),n.d(t,"MenuItem",(function(){return Af})),n.d(t,"MessageDialog",(function(){return kp})),n.d(t,"NumberField",(function(){return Gv})),n.d(t,"PagingToolbar",(function(){return Cp})),n.d(t,"Panel",(function(){return Rf})),n.d(t,"PickerField",(function(){return ov})),n.d(t,"Popup",(function(){return xf})),n.d(t,"Renderable",(function(){return Gu})),n.d(t,"Ripple",(function(){return pc})),n.d(t,"Slider",(function(){return Sp})),n.d(t,"SlideToggle",(function(){return Ep})),n.d(t,"Splitter",(function(){return Pp})),n.d(t,"Tab",(function(){return jp})),n.d(t,"TabBar",(function(){return Np})),n.d(t,"TabPanel",(function(){return Up})),n.d(t,"TextAreaField",(function(){return Yp})),n.d(t,"TextField",(function(){return rv})),n.d(t,"TimeField",(function(){return Xv})),n.d(t,"TimePicker",(function(){return qv})),n.d(t,"Toast",(function(){return hd})),n.d(t,"Tool",(function(){return Bc})),n.d(t,"Toolbar",(function(){return df})),n.d(t,"Tooltip",(function(){return kh})),n.d(t,"Widget",(function(){return uc})),n.d(t,"Layout",(function(){return fc})),n.d(t,"Badge",(function(){return Kc})),n.d(t,"Responsive",(function(){return Kp})),n.d(t,"Rotatable",(function(){return Fc})),n.d(t,"Styleable",(function(){return Zp})),n.d(t,"Toolable",(function(){return zc})),n.d(t,"Histogram",(function(){return ig})),n.d(t,"Scale",(function(){return ug})),n.d(t,"AvatarRendering",(function(){return fg})),n.d(t,"ActionColumn",(function(){return Cg})),n.d(t,"AggregateColumn",(function(){return Sg})),n.d(t,"CheckColumn",(function(){return Tg})),n.d(t,"Column",(function(){return vg})),n.d(t,"DateColumn",(function(){return Mg})),n.d(t,"NumberColumn",(function(){return Ig})),n.d(t,"PercentColumn",(function(){return Fg})),n.d(t,"RatingColumn",(function(){return Bg})),n.d(t,"RowNumberColumn",(function(){return _g})),n.d(t,"TemplateColumn",(function(){return Vg})),n.d(t,"TimeColumn",(function(){return $g})),n.d(t,"TreeColumn",(function(){return Yg})),n.d(t,"WidgetColumn",(function(){return Eg})),n.d(t,"ColumnStore",(function(){return bg})),n.d(t,"GridRowModel",(function(){return Kg})),n.d(t,"CellEdit",(function(){return oy})),n.d(t,"CellMenu",(function(){return sy})),n.d(t,"CellTooltip",(function(){return uy})),n.d(t,"ColumnAutoWidth",(function(){return yy})),n.d(t,"ColumnDragToolbar",(function(){return by})),n.d(t,"ColumnPicker",(function(){return wy})),n.d(t,"ColumnReorder",(function(){return Ry})),n.d(t,"ColumnResize",(function(){return xy})),n.d(t,"ContextMenu",(function(){return Dy})),n.d(t,"Filter",(function(){return Fy})),n.d(t,"FilterBar",(function(){return Hy})),n.d(t,"GridFeatureManager",(function(){return ty})),n.d(t,"Group",(function(){return Wy})),n.d(t,"GroupSummary",(function(){return Yy})),n.d(t,"HeaderMenu",(function(){return Ky})),n.d(t,"QuickFind",(function(){return Qy})),n.d(t,"RegionResize",(function(){return tm})),n.d(t,"RowCopyPaste",(function(){return rm})),n.d(t,"RowReorder",(function(){return om})),n.d(t,"Search",(function(){return um})),n.d(t,"Sort",(function(){return pm})),n.d(t,"StickyCells",(function(){return ym})),n.d(t,"Stripe",(function(){return bm})),n.d(t,"GridSummary",(function(){return wm})),n.d(t,"Tree",(function(){return Sm})),n.d(t,"ExportDialog",(function(){return Hm})),n.d(t,"Exporter",(function(){return Gm})),n.d(t,"ExportOrientationCombo",(function(){return jm})),n.d(t,"ExportRowsCombo",(function(){return Lm})),n.d(t,"LocalizableCombo",(function(){return Pm})),n.d(t,"GridMultiPageExporter",(function(){return qm})),n.d(t,"GridMultiPageVerticalExporter",(function(){return Xm})),n.d(t,"GridPdfExport",(function(){return eb})),n.d(t,"GridSinglePageExporter",(function(){return Jm})),n.d(t,"FileFormat",(function(){return Tm})),n.d(t,"Orientation",(function(){return Dm})),n.d(t,"PaperFormat",(function(){return Em})),n.d(t,"RowsRange",(function(){return xm})),n.d(t,"GridExcelExporter",(function(){return ob})),n.d(t,"TableExporter",(function(){return nb})),n.d(t,"Row",(function(){return sb})),n.d(t,"Bar",(function(){return fb})),n.d(t,"Footer",(function(){return hb})),n.d(t,"Grid",(function(){return wk})),n.d(t,"GridBase",(function(){return bk})),n.d(t,"Header",(function(){return Tb})),n.d(t,"RowManager",(function(){return yb})),n.d(t,"SubGrid",(function(){return ok})),n.d(t,"TreeGrid",(function(){return Rk})),n.d(t,"GridElementEvents",(function(){return Ab})),n.d(t,"GridFeatures",(function(){return Fb})),n.d(t,"GridResponsive",(function(){return Hb})),n.d(t,"GridSelection",(function(){return Ub})),n.d(t,"GridState",(function(){return Zb})),n.d(t,"GridSubGrids",(function(){return uk})),n.d(t,"AbstractCrudManager",(function(){return Lk})),n.d(t,"AbstractCrudManagerMixin",(function(){return Pk})),n.d(t,"AjaxTransport",(function(){return jk})),n.d(t,"JsonEncoder",(function(){return Hk})),n.d(t,"CrudManagerView",(function(){return zk})),n.d(t,"AssignmentStore",(function(){return dC})),n.d(t,"CrudManager",(function(){return bx})),n.d(t,"DependencyStore",(function(){return hS})),n.d(t,"EventStore",(function(){return XR})),n.d(t,"ResourceStore",(function(){return DC})),n.d(t,"ResourceTimeRangeStore",(function(){return bS})),n.d(t,"TimeAxis",(function(){return Ox})),n.d(t,"AbstractRecurrenceIterator",(function(){return aR})),n.d(t,"DailyRecurrenceIterator",(function(){return lR})),n.d(t,"EventDayIndex",(function(){return IC})),n.d(t,"MonthlyRecurrenceIterator",(function(){return dR})),n.d(t,"RecurrenceDayRuleEncoder",(function(){return QC})),n.d(t,"RecurrenceLegend",(function(){return Ax})),n.d(t,"WeeklyRecurrenceIterator",(function(){return cR})),n.d(t,"YearlyRecurrenceIterator",(function(){return vR})),n.d(t,"AssignmentStoreMixin",(function(){return Jw})),n.d(t,"AttachToProjectMixin",(function(){return Px})),n.d(t,"DependencyStoreMixin",(function(){return oS})),n.d(t,"EventStoreMixin",(function(){return _C})),n.d(t,"PartOfBaseProject",(function(){return Xw})),n.d(t,"PartOfProject",(function(){return Wk})),n.d(t,"ProjectConsumer",(function(){return jx})),n.d(t,"ProjectCrudManager",(function(){return pS})),n.d(t,"RecurringEventsMixin",(function(){return UC})),n.d(t,"RecurringTimeSpansMixin",(function(){return WC})),n.d(t,"ResourceStoreMixin",(function(){return vC})),n.d(t,"SharedEventStoreMixin",(function(){return NC})),n.d(t,"DragBase",(function(){return Wx})),n.d(t,"DragCreateBase",(function(){return Zx})),n.d(t,"EditBase",(function(){return aE})),n.d(t,"ResourceTimeRangesBase",(function(){return lE})),n.d(t,"TimeSpanMenuBase",(function(){return cE})),n.d(t,"TimeSpanRecordContextMenuBase",(function(){return hE})),n.d(t,"TooltipBase",(function(){return yE})),n.d(t,"AbstractTimeRanges",(function(){return wE})),n.d(t,"ColumnLines",(function(){return SE})),n.d(t,"Dependencies",(function(){return jE})),n.d(t,"DependencyEdit",(function(){return zE})),n.d(t,"EventContextMenu",(function(){return UE})),n.d(t,"EventCopyPaste",(function(){return KE})),n.d(t,"EventDrag",(function(){return QE})),n.d(t,"EventDragCreate",(function(){return tD})),n.d(t,"EventDragSelect",(function(){return rD})),n.d(t,"EventEdit",(function(){return jD})),n.d(t,"EventFilter",(function(){return ND})),n.d(t,"EventMenu",(function(){return WE})),n.d(t,"EventResize",(function(){return qx})),n.d(t,"EventTooltip",(function(){return VD})),n.d(t,"GridGroupSummary",(function(){return $O})),n.d(t,"HeaderContextMenu",(function(){return YO})),n.d(t,"HeaderZoom",(function(){return KO})),n.d(t,"Labels",(function(){return iM})),n.d(t,"NonWorkingTime",(function(){return aM})),n.d(t,"Pan",(function(){return lM})),n.d(t,"ResourceTimeRanges",(function(){return cM})),n.d(t,"ScheduleContextMenu",(function(){return vM})),n.d(t,"ScheduleMenu",(function(){return dM})),n.d(t,"ScheduleTooltip",(function(){return gM})),n.d(t,"SimpleEventEdit",(function(){return mM})),n.d(t,"StickyEvents",(function(){return RM})),n.d(t,"Summary",(function(){return xM})),n.d(t,"TimeAxisHeaderMenu",(function(){return TM})),n.d(t,"TimeRanges",(function(){return MM})),n.d(t,"DependencyCreation",(function(){return DE})),n.d(t,"RecurringEventEdit",(function(){return AD})),n.d(t,"MultiPageExporter",(function(){return BM})),n.d(t,"MultiPageVerticalExporter",(function(){return _M})),n.d(t,"PdfExport",(function(){return GM})),n.d(t,"ScheduleRangeCombo",(function(){return NM})),n.d(t,"SchedulerExportDialog",(function(){return VM})),n.d(t,"SinglePageExporter",(function(){return $M})),n.d(t,"ScheduleRange",(function(){return AM})),n.d(t,"ExcelExporter",(function(){return XM})),n.d(t,"ResourceCollapseColumn",(function(){return JM})),n.d(t,"ResourceInfoColumn",(function(){return eA})),n.d(t,"TimeAxisColumn",(function(){return AO})),n.d(t,"AssignmentModel",(function(){return qw})),n.d(t,"DependencyBaseModel",(function(){return QR})),n.d(t,"DependencyModel",(function(){return rS})),n.d(t,"EventModel",(function(){return VR})),n.d(t,"ProjectModel",(function(){return yx})),n.d(t,"RecurrenceModel",(function(){return wR})),n.d(t,"ResourceModel",(function(){return mC})),n.d(t,"ResourceTimeRangeModel",(function(){return yS})),n.d(t,"TimeSpan",(function(){return KC})),n.d(t,"AssignmentModelMixin",(function(){return Uk})),n.d(t,"EventModelMixin",(function(){return MR})),n.d(t,"ProjectModelMixin",(function(){return wS})),n.d(t,"RecurringTimeSpan",(function(){return ER})),n.d(t,"ResourceModelMixin",(function(){return gC})),n.d(t,"PresetManager",(function(){return Dx})),n.d(t,"PresetStore",(function(){return xx})),n.d(t,"ViewPreset",(function(){return Rx})),n.d(t,"RectangularPathFinder",(function(){return ME})),n.d(t,"ScheduleTableExporter",(function(){return qM})),n.d(t,"HorizontalTimeAxis",(function(){return DO})),n.d(t,"TimeAxisSubGrid",(function(){return vT})),n.d(t,"Scheduler",(function(){return nA})),n.d(t,"SchedulerBase",(function(){return HO})),n.d(t,"EventEditor",(function(){return oD})),n.d(t,"TimeAxisViewModel",(function(){return $D})),n.d(t,"TimelineBase",(function(){return bT})),n.d(t,"ResourceHeader",(function(){return OO})),n.d(t,"EventNavigation",(function(){return ZT})),n.d(t,"EventSelection",(function(){return qT})),n.d(t,"RecurringEvents",(function(){return rT})),n.d(t,"SchedulerDom",(function(){return CT})),n.d(t,"SchedulerDomEvents",(function(){return ST})),n.d(t,"SchedulerEventRendering",(function(){return FT})),n.d(t,"SchedulerRegions",(function(){return WT})),n.d(t,"SchedulerScroll",(function(){return zT})),n.d(t,"SchedulerState",(function(){return GT})),n.d(t,"SchedulerStores",(function(){return BT})),n.d(t,"TimelineDateMapper",(function(){return YD})),n.d(t,"TimelineDomEvents",(function(){return XD})),n.d(t,"TimelineEventRendering",(function(){return oT})),n.d(t,"TimelineScroll",(function(){return uT})),n.d(t,"TimelineViewPresets",(function(){return QD})),n.d(t,"TimelineZoomable",(function(){return tT})),n.d(t,"RecurrenceCombo",(function(){return fD})),n.d(t,"RecurrenceConfirmationPopup",(function(){return sD})),n.d(t,"RecurrenceDaysButtonGroup",(function(){return yD})),n.d(t,"RecurrenceDaysCombo",(function(){return pD})),n.d(t,"RecurrenceEditor",(function(){return DD})),n.d(t,"RecurrenceFrequencyCombo",(function(){return uD})),n.d(t,"RecurrenceLegendButton",(function(){return hD})),n.d(t,"RecurrenceMonthDaysButtonGroup",(function(){return bD})),n.d(t,"RecurrenceMonthsButtonGroup",(function(){return wD})),n.d(t,"RecurrencePositionsCombo",(function(){return xD})),n.d(t,"RecurrenceStopConditionCombo",(function(){return RD})),n.d(t,"ResourceCombo",(function(){return PD})),n.d(t,"ResourceFilter",(function(){return iA})),n.d(t,"UndoRedo",(function(){return sA})),n.d(t,"WidgetTag",(function(){return fA})),n.d(t,"TimelineBaseTag",(function(){return pA})),n.d(t,"SchedulerTag",(function(){return yA}));n(280);var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==r&&r,i="URLSearchParams"in r,o="Symbol"in r&&"iterator"in Symbol,a="FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in r,l="ArrayBuffer"in r;if(l)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&u.indexOf(Object.prototype.toString.call(e))>-1};function f(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function v(e){this.map={},e instanceof v?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function g(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function y(e){var t=new FileReader,n=g(t);return t.readAsArrayBuffer(e),n}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():l&&a&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=p(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(y)}),this.text=function(){var e,t,n,r=p(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=g(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(C)}),this.json=function(){return this.text().then(JSON.parse)},this}v.prototype.append=function(e,t){e=f(e),t=d(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},v.prototype.delete=function(e){delete this.map[f(e)]},v.prototype.get=function(e){return e=f(e),this.has(e)?this.map[e]:null},v.prototype.has=function(e){return this.map.hasOwnProperty(f(e))},v.prototype.set=function(e,t){this.map[f(e)]=d(t)},v.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},v.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},v.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},v.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},o&&(v.prototype[Symbol.iterator]=v.prototype.entries);var k=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(e,t){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,r,i=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new v(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new v(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),k.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var o=/([?&])_=[^&]*/;if(o.test(this.url))this.url=this.url.replace(o,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function C(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function R(e,t){if(!(this instanceof R))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"",this.headers=new v(t.headers),this.url=t.url||"",this._initBody(e)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},b.call(w.prototype),b.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},R.error=function(){var e=new R(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];R.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new R(null,{status:t,headers:{location:e}})};var x=r.DOMException;try{new x}catch(e){(x=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),x.prototype.constructor=x}function E(e,t){return new Promise((function(n,i){var o=new w(e,t);if(o.signal&&o.signal.aborted)return i(new x("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var e,t,r={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new v,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;setTimeout((function(){n(new R(i,r))}),0)},s.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},s.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},s.onabort=function(){setTimeout((function(){i(new x("Aborted","AbortError"))}),0)},s.open(o.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&(a?s.responseType="blob":l&&o.headers.get("Content-Type")&&-1!==o.headers.get("Content-Type").indexOf("application/octet-stream")&&(s.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof v?o.headers.forEach((function(e,t){s.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){s.setRequestHeader(e,d(t.headers[e]))})),o.signal&&(o.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&o.signal.removeEventListener("abort",u)}),s.send(void 0===o._bodyInit?null:o._bodyInit)}))}E.polyfill=!0,r.fetch||(r.fetch=E,r.Headers=v,r.Request=w,r.Response=R);n(437),n(81),n(83),n(12),n(24),n(29),n(54),n(23),n(20),n(100),n(103),n(208),n(16),n(107),n(26),n(104),n(14);var D,T,O,M,A=n(13),I=n.n(A),P=n(8),F=n.n(P),L=n(2),B=n.n(L),j=n(3),_=n.n(j),H=(n(79),n(17),n(33),n(61),n(56),n(58),n(32),n(88),n(22),n(85),n(64),n(65),n(66),n(67),n(68),n(69),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(18),n(15)),N=n.n(H),z=(n(35),n(19),n(80),n(117),n(84),n(101),n(21)),V=/([a-z])([A-Z])/g,W=/[\n\r]/g,$=/[.*+?^${}()|[\]\\]/g,U=/[&<]/,G=/(^[^a-z]+|[^\w]+)/gi,Y=/\s+/,q=function(e,t){return T[t.toLowerCase()]||String.fromCharCode(parseInt(t.substr(2),10))},K=function(e,t){return D[t]},X=function(e,t,n){return"".concat(t,"-").concat(n.toLowerCase())},Z=function(e,t,n){return"".concat(t," ").concat(n.toLowerCase())},J=function(e){return e?"_x".concat(e.charCodeAt(0).toString(16)):"__blank__"},Q={},ee={},te=function(){function e(){B()(this,e)}return _()(e,null,[{key:"capitalize",value:function(e){return e&&e[0].toUpperCase()+e.substr(1)}},{key:"capitalizeFirstLetter",value:function(e){return z.a.deprecate("Core","5.0.0","Deprecated in favor of `capitalize()`, will be removed in 5.0"),e?e[0].toUpperCase()+e.substr(1):null}},{key:"lowercaseFirstLetter",value:function(e){return z.a.deprecate("Core","5.0.0","Deprecated in favor of `uncapitalize()`, will be removed in 5.0"),e?e[0].toLowerCase()+e.substr(1):null}},{key:"uncapitalize",value:function(e){return e&&e[0].toLowerCase()+e.substr(1)}},{key:"hyphenate",value:function(e){var t=Q[e];return t||(Q[e]=e.replace(V,X))}},{key:"separate",value:function(e){var t=ee[e];return t||(ee[e]=this.capitalize(e.replace(V,Z)))}},{key:"createId",value:function(e){return String(e).replace(G,J)}},{key:"escapeRegExp",value:function(e,t){var n=e.replace($,"\\$&");return void 0!==t&&(n=new RegExp(n,t)),n}},{key:"decodeHtml",value:function(e){return e&&String(e).replace(M,q)}},{key:"encodeHtml",value:function(e){return e&&String(e).replace(O,K)}},{key:"encodeHtmlBR",value:function(t){var n;return null===(n=e.encodeHtml(t))||void 0===n?void 0:n.replace(W,"<br>")}},{key:"isHtml",value:function(e){return"string"==typeof e&&U.test(e||"")}},{key:"initHtmlEntities",value:function(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};var t=Object.keys(e);D=e,T=t.reduce((function(t,n){return t[e[n]]=n,t}),{}),O=new RegExp("([".concat(t.map((function(e){return"[-]".includes(e)?"\\"+e:e})).join(""),"])"),"g"),M=new RegExp("(".concat(Object.values(e).join("|"),"|&#[0-9]+;)"),"ig")}},{key:"safeJsonParse",value:function(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}},{key:"safeJsonStringify",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null;try{r=JSON.stringify(e,t,n)}catch(e){}return r}},{key:"joinPaths",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}},{key:"split",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y,n=e;return"string"==typeof n&&(n=(n=e.trim())?n.split(t):[]),n}},{key:"xss",value:function(t){for(var n=[],r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=i.length;for(n[a]=t[a];a-- >0;)n[a]=t[a]+e.encodeHtml(i[a]);return n.join("")}},{key:"xssBR",value:function(t){for(var n=[],r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=i.length;for(n[a]=t[a];a-- >0;)n[a]=t[a]+e.encodeHtmlBR(i[a]);return n.join("")}}]),e}();function ne(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}te.initHtmlEntities(),te._$name="StringHelper";var ie,oe=Object.prototype.toString,ae=Object.isFrozen,se=/\s*<\s*/,le=/\s*>\s*/,ue={},ce=/\[object ([^\]]+)]/,fe={},de=Object.freeze({}),he=function(){function e(){B()(this,e)}return _()(e,null,[{key:"assign",value:function(e){for(var t,n,r=0;r<(arguments.length<=1?0:arguments.length-1);r++)if(t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])for(n in t)e[n]=t[n];return e}},{key:"assignIf",value:function(e){for(var t,n,r=0;r<(arguments.length<=1?0:arguments.length-1);r++)if(t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])for(n in t)n in e&&void 0!==e[n]||(e[n]=t[n]);return e}},{key:"blend",value:function(t,n,r){t=t||{};var i,o,a,s=r=r||ue,l=s.clone,u=void 0===l?e.clone:l,c=s.merge,f=void 0===c?e.blend:c;if(Array.isArray(n)){if(n.length>1)return n.forEach((function(n){t=e.blend(t,n,r)})),t;n=n[0]}if(n)for(o in n)(a=n[o])&&ve.isObject(a)&&(i=t[o],r.key=o,i&&ve.isObject(i)?(ae(i)&&(t[o]=i=u(i,r)),a=f(i,a,r)):a=ae(a)?a:u(a,r)),t[o]=a;return t}},{key:"clone",value:function(e,t){var n,r=e;if(e&&"object"===I()(e))if(t&&"object"===I()(t)&&t&&(t=null),ve.isObject(e))for(n in r={},e)r[n]=ve.clone(e[n]);else if(Array.isArray(e))for(r=[],n=e.length;n-- >0;)r[n]=ve.clone(e[n]);else ve.isDate(e)?r=new Date(e.getTime()):t&&(r=t(e));return r}},{key:"createTruthyKeys",value:function(e){var t=te.split(e),n=t&&{};if(t){var r,i=ne(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;o&&(n[o]=!0)}}catch(e){i.e(e)}finally{i.f()}}return n}},{key:"getPath",value:function(e,t){return t.split(".").reduce((function(e,t){return(e||de)[t]}),e)}},{key:"getPathDefault",value:function(e,t,n){var r=Array.isArray(t)?t:"string"==typeof t?t.split("."):[t],i=r.length-1;return r.reduce((function(e,t,r){return n&&!(t in e)&&(e[t]=r===i?n:{}),(e||de)[t]}),e)}},{key:"hasPath",value:function(e,t){return t.split(".").every((function(t){return t in e&&(e=e[t],!0)}))}},{key:"getTruthyKeys",value:function(e){var t=[];for(var n in e)e[n]&&t.push(n);return t}},{key:"getTruthyValues",value:function(e){var t=[];for(var n in e)e[n]&&t.push(e[n]);return t}},{key:"isClass",value:function(e){var t;return"function"==typeof e&&(null===(t=e.prototype)||void 0===t?void 0:t.constructor)===e}},{key:"isDate",value:function(e){return Boolean(e&&e.getUTCDate)&&"date"===ve.typeOf(e)}},{key:"isPromise",value:function(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e||"function"==typeof(null==e?void 0:e.then);throw new Error("Promise not supported in your environment")}},{key:"isEmpty",value:function(e){if(e&&"object"===I()(e))for(var t in e)return!1;return!0}},{key:"isObject",value:function(e){var t=null==e?void 0:e.constructor;return Boolean(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&"object"===I()(e))}},{key:"isInstantiated",value:function(t){return!!t&&("object"===I()(t)&&!e.isObject(t))}},{key:"merge",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.blend(t,r)}},{key:"mergeItems",value:function(t,n,r){var i,o,a,s,l,u,c,f=r=r||ue,d=f.merge,h=void 0===d?e.blend:d,v=f.rebuild,p=void 0===v?!e.ES6_OBJECT_ORDER:v;if(t=t||{},Array.isArray(n))n.forEach((function(n){t=e.mergeItems(t,n,r)}));else if(n){for(l in n){if(c=n[l],i=null,l.includes(">")){var g=l.split(le),y=N()(g,2);l=y[0],i=y[1],o=0}else if(l.includes("<")){var m=l.split(se),b=N()(m,2);i=b[0],l=b[1],o=1}if(l in t)c&&t[l]&&h&&(r.key=l,c=h(t[l],c,r)),t[l]=c;else if(i){if(!s)for(var k in s=new Map,a=0,t)s.set(k,a++);if(a=s.get(i),t[l]=c,null==a&&o)a=s.size;else{u=!p&&(u||[]),a=(a||0)+o;var w,C=ne(s);try{for(C.s();!(w=C.n()).done;){var R=w.value,S=N()(R,2),x=S[0],E=S[1];a<=E&&(u&&(u[s.size-E-1]=x),s.set(x,E+1))}}catch(e){C.e(e)}finally{C.f()}if(u)for(;u.length;){var D=u.pop(),T=t[D];delete t[D],t[D]=T}}s.set(l,a)}else{var O;t[l]=c,null===(O=s)||void 0===O||O.set(l,s.size)}}if(p&&s){var M=Array.from(s.entries()).sort((function(e,t){return e[1]-t[1]})),A=t;t={};for(var I,P=0;P<M.length;++P)I=M[P][0],t[I]=A[I]}}return t}},{key:"setPath",value:function(e,t,n){return t.split(".").reduce((function(e,t,r,i){return r===i.length-1?e[t]=n:(e[t]instanceof Object||(e[t]={}),e[t])}),e),e}},{key:"typeOf",value:function(e){var t,n,r=I()(e);return"object"===r?null===e?r="null":(n=oe.call(e),(r=fe[n])||(t=ce.exec(n),fe[n]=r=t?t[1].toLowerCase():n)):e!=e&&(r="nan"),r}}]),e}(),ve=he;ve.ES6_OBJECT_ORDER=(delete(ie={a:1,b:2,c:3}).b,ie.b=20,"c"===Object.keys(ie)[1]),he._$name="Objects";var pe=n(10),ge=(n(160),n(113),Reflect.defineProperty),ye=Reflect.getOwnPropertyDescriptor,me=Object.prototype,be=me.hasOwnProperty,ke=me.toString,we=Symbol("instanceProperties"),Ce=Symbol("configuring"),Re=Symbol("lazyConfigValues"),Se=ke.call(new Date),xe=/\s+/,Ee=function(e,t){return e[t]=1,e},De=function(){function e(t){B()(this,e);var n=this,r=t[0].toUpperCase()+t.substr(1);n.base=n,n.name=t,n.field="_"+t,n.capName=r,n.changer="change"+r,n.initializing="initializing"+r,n.updater="update"+r}return _()(e,[{key:"descriptor",get:function(){var e=this._descriptor;return e&&be.call(this,"_descriptor")||(this._descriptor=e=this.makeDescriptor()),e}},{key:"initDescriptor",get:function(){var e=this._initDescriptor;return e&&be.call(this,"_initDescriptor")||(this._initDescriptor=e=this.makeInitter()),e}},{key:"equal",value:function(e,t){return e===t}},{key:"extend",value:function(t){var n=Object.assign(Object.create(this),t),r=t.equal,i=t.merge,o=e.equalityMethods;return"string"==typeof r&&(r.endsWith("[]")?n.equal=e.makeArrayEquals(o[r.substr(0,r.length-2)]):n.equal=o[r]),"string"==typeof i&&(n.merge=e.mergeMethods[i]),n}},{key:"define",value:function(e){var t=ye(e,this.name),n=this.descriptor;t&&t.get&&((n=Object.assign({},n)).get=t.get),ge(e,this.name,n)}},{key:"defineInitter",value:function(e,t){var n,r,i=this.name,o=e[we];o[i]||!(r=ye(e,i))||"value"in r||(o[i]=r),ge(e,i,this.initDescriptor),this.lazy&&((n=e[Re]||(e[Re]={$counter_:0}))[i]=t,++n.$counter_)}},{key:"makeDescriptor",value:function(){var e=this,t=e.base,n=e.field,r=e.changer,i=e.updater,o=e.name;return t!==e&&t.equal===e.equal?t.descriptor:{get:function(){var e;return null===(e=this.configObserver)||void 0===e||e.get(o,this),this[n]},set:function(t){var a,s,l=this,u=l[n];if("string"==typeof t){var c,f=t;if(t.startsWith("up."))f=null===(c=l.owner)||void 0===c?void 0:c.resolveProperty(t.substr(3));else t.startsWith("this.")&&(f=l.resolveProperty(t.substr(5)));"function"!=typeof f&&(t=f)}l[r]&&((a=void 0===(s=l[r](t,u)))||(t=s,u=l[n])),a||(e.equal===Oe?u===t:e.equal(u,t))||(l[n]=t,a=!0,l[i]&&l[i](t,u)),a&&!l.onConfigChange.$nullFn&&l.onConfigChange({name:o,value:t,was:u,config:e})}}}},{key:"makeInitter",value:function(){var e=this;return e!==e.base?e.lazy?e.makeLazyInitter():e.base.initDescriptor:e.makeBasicInitter()}},{key:"makeBasicInitter",value:function(){var e=this,t=e.initializing,n=e.name;return{configurable:!0,get:function(){var r=this;return e.removeInitter(r),r[t]=!0,r[n]=r[Ce][n],r[t]=!1,r.configDone[n]=!0,r[n]},set:function(t){e.removeInitter(this),this.configDone[n]=!0,this[n]=t}}}},{key:"makeLazyInitter",value:function(){var e=this,t=e.initializing,n=e.name;return{configurable:!0,get:function(){var r=this,i=r[Re][n];return e.removeInitter(r),r.isDestroying||(r[t]=!0,r[n]=i,r[t]=!1),r[n]},set:function(t){e.removeInitter(this),this[n]=t}}}},{key:"removeInitter",value:function(e){var t=this.name,n=e[we][t];n?ge(e,t,n):delete e[t],this.lazy&&(--e[Re].$counter_||delete e[Re])}},{key:"merge",value:function(e,t){return t&&e&&he.isObject(t)&&he.isObject(e)&&(e=he.merge(he.clone(t),e)),e}}],[{key:"get",value:function(t,n){var r,i=this.cache,o=i[t]||(i[t]=new e(t)),a=o;return n&&((a=(r=e.makeCacheKey(t,n))&&i[r])||(a=o.extend(n),r&&(i[r]=a))),a}},{key:"makeArrayEquals",value:function(e){return function(t,n){var r,i=t&&n&&t.length===(r=n.length);if(i&&Array.isArray(t)&&Array.isArray(n))if(e)for(;i&&r-- >0;)i=e(t[r],n[r]);else for(;i&&r-- >0;)i=t[r]===n[r];else i=e?e(t,n):t===n;return i}}},{key:"makeCacheKey",value:function(e,t){for(var n,r,i,o=Object.keys(t).sort(),a=o.length;a-- >0;)if(null==(i=t[n=o[a]])&&!1===i)o.splice(a,1);else{if("function"===(r=I()(i)))return null;"string"===r?o[a]="".concat(n,':"').concat(i,'"'):"number"===r&&(o[a]="".concat(n,":").concat(i))}return o.length?"".concat(e,">").concat(o.join("|")):e}}]),e}(),Te=De.prototype,Oe=Te.equal;De.symbols={configuring:Ce,instanceProperties:we,lazyConfigs:Re},De.cache=Object.create(null),De.equalityMethods={array:De.makeArrayEquals(),date:function(e,t){return e===t||!(!e||!t||ke.call(e)!==Se||ke.call(t)!==Se)&&e.getTime()===t.getTime()},strict:De.equal=Oe},De.mergeMethods={distinct:function(e,t){var n,r,i=t?t.slice():[];if(null!=e)if(he.isObject(e))if(void 0===t)i=e;else for(n in e)r=i.indexOf(n),e[n]?r<0&&i.push(n):r>-1&&i.splice(r,1);else Array.isArray(e)?e.forEach((function(e){return!i.includes(e)&&i.push(e)})):i.includes(e)||i.push(e);return i},merge:De.merge=Te.merge,classList:function(e,t){if("string"==typeof e){if(!e.length)return t;e=e.split(xe).reduce(Ee,{})}return De.merge(e,t)},objects:function(e,t){return!0===e?t||{}:De.merge(e,t)},replace:function(e){return e},items:function(e,t){return he.mergeItems(t,e,{merge:function(e,t){return Te.merge(t,e)}})}},Object.assign(Te,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1}),De._$name="Config";var Me=function(){function e(t){B()(this,e),t&&Object.assign(this,t)}return _()(e,[{key:"getInherited",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this[e];e in this||((r=null===(t=this.super)||void 0===t?void 0:t.getInherited(e,n))||n)&&(this[e]=r=Object.create(r||null));return r}}]),e}(),Ae=Object.getPrototypeOf,Ie=Reflect.defineProperty,Pe=Object.prototype.hasOwnProperty,Fe=Symbol("classMetaData"),Le=Symbol("mixinTag"),Be=Symbol("originalConfig"),je=(Symbol("createdAt"),De.symbols.configuring),_e=De.symbols.instanceProperties,He=De.symbols.lazyConfigs,Ne={merge:"replace",simple:!0},ze=function(){},Ve=function(e){return new Me(e)},We={},$e=function(){function e(){B()(this,e);var t=this,n=t.constructor;t.$meta.class!==n&&n.$meta,t.construct.apply(t,arguments),t.afterConstruct()}return _()(e,[{key:"isBase",get:function(){return!0}},{key:"construct",value:function(){null!==(arguments.length<=0?void 0:arguments[0])&&this.configure.apply(this,arguments),this.afterConfigure()}},{key:"destroy",value:function(){var e=this,t=e.id;for(var n in e.isDestroying=!0,e.destroy=ze,e.doDestroy(),Object.setPrototypeOf(e,null),e)"destroy"!==n&&"isDestroying"!==n&&delete e[n];delete e[Be],e.isDestroyed=!0,e.id=t}},{key:"_thisIsAUsedExpression",value:function(e){}},{key:"$$name",get:function(){return this.constructor.$$name}},{key:"startConfigure",value:function(e){}},{key:"finishConfigure",value:function(e){}},{key:"afterConfigure",value:function(){}},{key:"afterConstruct",value:function(){}},{key:"callback",value:function(e,t,n){"this"===t&&(t=this);var r=this.resolveCallback(e,t),i=r.handler,o=r.thisObj;return n?i.apply(o,n):i.call(o)}},{key:"resolveProperty",value:function(e){for(var t=this;t;){if(he.hasPath(t,e))return he.getPath(t,e);t=t.owner}}},{key:"resolveCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(e.substr){if(e.startsWith("up.")){for(e=e.substr(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substr(5),t=this);if(!(t&&t instanceof Object))return;if("function"!=typeof t[e])return;e=t[e]}return{handler:e,thisObj:t}}},{key:"bindCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(e){var n=this.resolveCallback(e,t),r=n.handler,i=n.thisObj;if(r)return r.bind(i)}}},{key:"delay",value:function(e,t){e=this.setTimeout?e:e.bind(this),(this.setTimeout?this:pe.a.global)["number"==typeof t?"setTimeout":"requestAnimationFrame"](e,t)}},{key:"doDestroy",value:function(){var e=this,t=e.$meta.nullify;if(t)for(var n=0;n<t.length;++n)null!=e[t[n].field]&&(e[t[n].name]=null)}},{key:"destroyProperties",value:function(){for(var e,t,n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];for(var a=0,s=i;a<s.length;a++)!((e=s[a])in n)||n[je]&&n[je][e]||((t=n[e])&&t.destroy&&t.destroy(),delete n[e])}},{key:"configure",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this,o=r.beforeConfigure,a=i.$meta.configs,s=i.getDefaultConfiguration();for(t in i.initialConfig=r,i.isConfiguring=!0,Object.assign(i,i.getProperties()),r)n=r[t],e=a[t],s[t]=e?e.merge(n,s[t],null):n;o&&(delete s.beforeConfigure,o(i,s)),i.setConfig(i[Be]=s,!0),i.isConfiguring=!1}},{key:"getConfig",value:function(e){return this[e]}},{key:"setConfig",value:function(e,t){var n,r,i=this,o=i[je],a=o?i.configDone:i.configDone={},s=i.$meta.configs;for(r in i[_e]={},i[je]=o?Object.setPrototypeOf(Object.assign({},e),o):e,e)null!=e[r]||Pe.call(e,r)?((n=s[r]||De.get(r)).defineInitter(i,e[r]),t?n.lazy&&(a[r]=!0):a[r]=!1):a[r]=!0;for(r in t&&i.startConfigure(e),e)a[r]||(i[r]=e[r]);return o?i[je]=o:delete i[je],t&&i.finishConfigure(e),i}},{key:"hasConfig",value:function(e){var t=this,n=t[He],r=t[je],i=null!=t["_"+e],o=null!=(null==n?void 0:n[e]),a=Boolean(!t.configDone[e]&&r&&(null!=r[e]||Pe.call(r,e)));return i||o||a}},{key:"triggerConfig",value:function(e){var t=this.configDone,n=this[je],r=n&&(null!=n[e]||Pe.call(n,e))?!t[e]:null;return r&&this.getConfig(e),r}},{key:"onConfigChange",value:function(){}},{key:"config",get:function(){var e={},t=this[Be];for(var n in t)e[n]=t[n];return e}},{key:"getDefaultConfiguration",value:function(){return this.constructor.getDefaultConfiguration()}},{key:"getProperties",value:function(){for(var e=this.$meta.properties,t={},n=0;n<e.length;n++)Object.assign(t,e[n].properties);return t}},{key:"classHierarchy",value:function(e){var t=this.$meta.hierarchy,n=e?t.indexOf(e):0;return n>0?t.slice(n):t}},{key:"detachListeners",value:function(e){var t,n=this.$detachers;if(n=null===(t=n)||void 0===t?void 0:t[e])for(;n.length;)n.pop()()}},{key:"trackDetacher",value:function(e,t){var n=this.$detachers||(this.$detachers={});(n[e]||(n[e]=[])).push(t)}},{key:"untrackDetachers",value:function(e){var t=this.$detachers;if(t)for(var n in t)for(var r=t[n],i=r.length;i-- >0;)r[i].eventer===e&&r.splice(i,1)}}],[{key:"isBase",get:function(){return!0}},{key:"declarable",get:function(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}},{key:"new",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new this(he.merge.apply(he,[{}].concat(t)))}},{key:"destroy",value:function(){for(var e=function e(t){null!=t&&t.destroy?t.destroy():Array.isArray(t)&&t.forEach(e)},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e(n)}},{key:"$$name",get:function(){return Pe.call(this,"$name")&&this.$name||Pe.call(this,"_$name")&&this._$name||this.name}},{key:"initClass",value:function(){return this.$meta.class}},{key:"$meta",get:function(){var e=this,t=e[Fe];return Pe.call(e,Fe)||(e[Fe]=t=Ve(),t.class=e,e.setupClass(t)),t}},{key:"onClassMixedIn",value:function(){}},{key:"mergeConfigs",value:function(e){for(var t,n,r,i,o=this.$meta.configs,a=he.clone(e)||{},s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];for(n=0;n<l.length;++n)if(t=l[n])for(r in t)i=t[r],o[r]?i=o[r].merge(i,a[r]):a[r]&&i&&(i=De.merge(i,a[r])),a[r]=i;return a}},{key:"mixin",value:function(){for(var e,t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(e=0;e<r.length;++e){var o=r[e],a=o[Le]||(o[Le]=Symbol("mixinTag"));t[a]||((t=o(t))[a]=!0,Pe.call(t,"onClassMixedIn")&&t.onClassMixedIn())}return t}},{key:"setupClass",value:function(e){var t,n=e.class,r=Ae(n).$meta,i=n.$$name,o=r.names,a=n.prototype;if(Ie(a,"$meta",{value:e}),Object.assign(e,{super:r,config:Object.create(r.config),configs:Object.create(r.configs),declarables:r.declarables,forkConfigs:r.forkConfigs,hierarchy:Object.freeze([].concat(F()(r.hierarchy),[n])),names:o.includes(i)?o:Object.freeze([].concat(F()(o),[i])),properties:r.properties,nullify:null===(t=r.nullify)||void 0===t?void 0:t.slice()}),o!==e.names){var s="is"+i;Pe.call(a,s)||Ie(a,s,{value:!0}),Pe.call(n,s)||Ie(n,s,{value:!0})}for(var l,u=0;u<e.declarables.length;++u)l=e.declarables[u],Pe.call(n,l)&&n[We[l]||(We[l]="setup".concat(te.capitalize(l)))](n,e)}},{key:"setupConfigs",value:function(e,t,n){var r,i,o,a,s=e.config,l=e.configs,u=e.class.prototype,c=e.nullify;for(var f in t)o=t[f],n?(r=l[f])?o=r.merge(o,s[f],e):r=De.get(f,Ne):(i=null,o&&"object"===I()(o)&&"$config"in o&&((i=o.$config)&&!he.isObject(i)&&(i=he.createTruthyKeys(i)),"default"in o&&Ie(u,De.get(f).field,{configurable:!0,writable:!0,value:o.default}),o=o.value),(r=l[f])?(a=r.nullify,i&&(r=r.extend(i)),o=r.merge(o,s[f],e)):((r=De.get(f,i)).define(e.class.prototype),a=!1),r.nullify&&!a&&(c||(c=e.nullify||(e.nullify=[]))).push(r)),o&&(he.isObject(o)||Array.isArray(o))&&!Object.isFrozen(o)&&(e.forkConfigs=!0),l[f]=r,s[f]=o}},{key:"setupConfigurable",value:function(e,t){e.setupConfigs(t,e.configurable,!1)}},{key:"setupDefaultConfig",value:function(e,t){e.setupConfigs(t,e.defaultConfig,!0)}},{key:"setupDeclarable",value:function(e,t){var n,r,i=e.declarable,o=t.declarables;for(r=0;r<i.length;++r)o.includes(i[r])||(n||(t.declarables=n=o=o.slice()),o.push(i[r]))}},{key:"setupProperties",value:function(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}},{key:"setupPrototypeProperties",value:function(e){Object.assign(e.prototype,e.prototypeProperties)}},{key:"getDefaultConfiguration",value:function(){var t=this.$meta,n=t.forkConfigs?e.fork(t.config):Object.create(t.config);if(z.a.isTestEnv&&pe.a.isBrowserEnv&&n.testConfig&&pe.a.global.__applyTestConfigs)for(var r in n.testConfig)n[r]=n.testConfig[r];return n}},{key:"fork",value:function(t){var n,r,i=t;if(t&&he.isObject(t)&&!Object.isFrozen(t))for(n in i=Object.create(t),t)(r=t[n])&&(he.isObject(r)?i[n]=e.fork(r):Array.isArray(r)&&(i[n]=r.slice()));return i}},{key:"superclass",get:function(){return Ae(this)}},{key:"isOfTypeName",value:function(e){return this.$meta.names.includes(e)}}]),e}(),Ue=$e.prototype;Ue.onConfigChange.$nullFn=!0,$e[Fe]=Ue.$meta=Ve({class:$e,config:Object.freeze({}),configs:Object.create(null),declarables:$e.declarable,forkConfigs:!1,hierarchy:Object.freeze([$e]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null}),Object.assign(Ue,{$detachers:null,configObserver:null,isDestroyed:!1,isDestroying:!1}),z.a.setVersion("core","4.2.1"),$e._$name="Base";n(37),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(47),n(48),n(49),n(50),n(51),n(52),n(53);var Ge=n(4),Ye=n.n(Ge),qe=n(5),Ke=n.n(qe),Xe=n(0),Ze=n.n(Xe),Je=(n(27),n(34),n(87),n(91),n(256),n(6)),Qe=n.n(Je),et=n(1),tt=n.n(et);n(207),n(262),n(264);function nt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var it=function(){function e(){B()(this,e)}return _()(e,[{key:"magnitudeCompare",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"lexicalCompare",value:function(e,t){return(e=String(e))<(t=String(t))?-1:e>t?1:0}}],[{key:"clean",value:function(e){return e.reduce((function(e,t){return null==t||Array.isArray(t)&&0===t.length||""===t||e.push(t),e}),[])}},{key:"from",value:function(e,t,n){var r=[];if(e){var i,o=nt(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;t&&!t(a)||r.push(n?n(a):a)}}catch(e){o.e(e)}finally{o.f()}}return r}},{key:"remove",value:function(e){for(var t,n,r=!1,i=0;i<(arguments.length<=1?0:arguments.length-1);i++)n=i+1<1||arguments.length<=i+1?void 0:arguments[i+1],-1!==(t=e.indexOf(n))&&(e.splice(t,1),r=!0);return r}},{key:"findInsertionIndex",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.lexicalCompare,o=arguments.length>3?arguments[3]:void 0,a=t.length;return o<a&&(n=o>0?i(t[o-1],e):0,r=o<a-1?i(e,t[o]):0,n<1&&r<1)?o:this.binarySearch(t,e,i)}},{key:"findLast",value:function(e,t,n){for(var r=e.length-1;r>=0;r--)if(t.call(n,e[r],r,e))return e[r]}},{key:"binarySearch",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.lexicalCompare,s=e.length;for(i instanceof Function?(a=i,i=0):o instanceof Function&&(a=o,o=s),--o;i<=o;)(r=a(t,e[n=i+o>>1]))>=0?i=n+1:r<0&&(o=n-1);return i}},{key:"fill",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[],i=Array.isArray(t)?t:[t],o=0;o<e;o++){var a,s=nt(i);try{for(s.s();!(a=s.n()).done;){var l=a.value,u=Object.assign({},l);n&&n(u,o),r.push(u)}}catch(e){s.e(e)}finally{s.f()}}return r}},{key:"populate",value:function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}},{key:"include",value:function(e,t){e.includes(t)||e.push(t)}},{key:"unique",value:function(e){return F()(new Set(e))}},{key:"allowNegative",value:function(e){return new Proxy(e,{get:function(e,t,n){if("string"!=typeof t)return Reflect.get(e,t,n);var r=Number(t);return Number.isNaN(r)?Reflect.get(e,t,n):e[r<0?e.length+r:r]},set:function(e,t,n,r){if("string"!=typeof t)return Reflect.set(e,t,n,r);var i=Number(t);return Number.isNaN(i)?Reflect.set(e,t,n,r):(e[i<0?e.length+i:i]=n,!0)}})}},{key:"delta",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return n?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};for(var r=[],i=[],o=[],a=0;a<e.length;a++){var s=e[a];t.includes(s)?o.push(s):r.push(s)}for(var l=0;l<t.length;l++){var u=t[l];o.includes(u)||i.push(u)}return n?{toAdd:r,toRemove:i,toKeep:o}:{onlyInA:r,onlyInB:i,inBoth:o}}}]),e}();!function(e){var t,n,r,i,o=new Array(600),a={};for(t=0;t<600;++t)o[t]=[Math.floor(3*Math.random())+1,t+1];for(o.sort((function(e,t){return e[0]-t[0]})),t=0;t<600&&!r;++t){var s=N()(o[t],2);n=s[0],i=s[1],r=a[n]>i,a[n]=i}if(r){var l=Array.prototype,u=l.sort,c=function(e,t){return e<t?-1:t<e?1:0};Object.defineProperty(l,"sort",{configurable:!0,value:function(e){var t,n,r=this,i=r.length;if(i>1){for(n=new Array(i),t=i;t-- >0;)n[t]=t;for(e=e||c,u.call(n,(function(t,n){return e(r[t],r[n])||t-n})),t=i;t-- >0;)n[t]=r[n[t]];for(t=i;t-- >0;)r[t]=n[t]}return r}})}}(),it._$name="ArrayHelper";var ot=Object.prototype.hasOwnProperty,at=function(){function e(){B()(this,e)}return _()(e,null,[{key:"after",value:function(t,n,r,i,o){var a="string"==typeof r,s=!1!==(null==o?void 0:o.return);return e.hookMethod(t,n,(function e(){for(var n,o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var c=(n=e.$nextHook).call.apply(n,[t].concat(l)),f=null!=i&&i.isDestroyed?void 0:s?a?i[r].apply(i,[c].concat(l)):r.call.apply(r,[i,c].concat(l)):a?i[r].apply(i,l):r.call.apply(r,[i].concat(l));return void 0===f?c:f}))}},{key:"before",value:function(t,n,r,i){var o="string"==typeof r;return e.hookMethod(t,n,(function e(){for(var n,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];var u=null!=i&&i.isDestroyed?0:o?i[r].apply(i,s):r.call.apply(r,[i].concat(s));return!1===u?u:(n=e.$nextHook).call.apply(n,[t].concat(s))}))}},{key:"curry",value:function(e){return function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length>=e.length?e.apply(this,r):function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,r.concat(n))}}}},{key:"bindAll",value:function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=e[t].bind(e))}},{key:"createInterceptor",value:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return!1!==t.call.apply(t,[n].concat(i))&&e.call.apply(e,[n].concat(i))}}},{key:"createSequence",value:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=e.call.apply(e,[n].concat(i)),s=t.call.apply(t,[n].concat(i));return void 0===s?a:s}}},{key:"createThrottled",value:function(e,t,n,r,i){var o,a,s=-Number.MAX_VALUE,l=function(){a=0,s=performance.now(),o.push.apply(o,r),e.apply(n,o)},u=function(){for(var e=performance.now()-s,u=arguments.length,c=new Array(u),f=0;f<u;f++)c[f]=arguments[f];o=c,e>=t?(clearTimeout(a),l()):(a||(a=setTimeout(l,t-e)),i&&(o.push.apply(o,r),i.apply(n,o)))};return u.cancel=function(){return clearTimeout(a)},u}},{key:"createBuffered",value:function(e,t,n,r){var i,o,a=function(){o=0,s.isPending=!1,i.push.apply(i,r),e.apply(n,i)},s=function e(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];i=r,o&&clearTimeout(o),e.isPending=!0,o=setTimeout(a,t)};return s.cancel=function(){s.isPending=!1,clearTimeout(o)},s}},{key:"hookMethod",value:function(e,t,n){return n.$nextHook=e[t],e[t]=n,function(){if(ot.call(e,t)){var r,i,o=e[t];if(o===n)(null===(i=Object.getPrototypeOf(e))||void 0===i?void 0:i[t])===n.$nextHook?delete e[t]:e[t]=n.$nextHook;else for(;r=null===(a=o)||void 0===a?void 0:a.$nextHook;o=r){var a;if(r===n){o.$nextHook=n.$nextHook;break}}}}}},{key:"noThrow",value:function(e,t,n){var r=e[t];e[t]=function(){try{for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return r.apply(e,i)}catch(e){return null==n?void 0:n(e)}}}},{key:"returnTrue",value:function(){return!0}},{key:"animate",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"linear",o=!1,a=new Promise((function(a){var s=performance.now();!function l(){var u=Math.min((performance.now()-s)/e,1),c=n&&n.setTimeout?n:window;o||!1===t.call(n,r.easingFunctions[i](u))&&a(),o||1===u?c.requestAnimationFrame((function(){return a()})):c.requestAnimationFrame(l)}()}));return a.cancel=function(){return o=!0,!1},a}}]),e}(),st=.5,lt=1.70158,ut=7.5625,ct=1.525,ft=2/2.75,dt=2.25/2.75,ht=1/2.75,vt=1.5/2.75,pt=2.5/2.75,gt=2.625/2.75,yt=.75,mt=.9375,bt=.984375;function kt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}at.easingFunctions={linear:function(e){return e},easeInQuad:function(e){return Math.pow(e,2)},easeOutQuad:function(e){return-(Math.pow(e-1,2)-1)},easeInOutQuad:function(e){return(e/=st)<1?st*Math.pow(e,2):-.5*((e-=2)*e-2)},easeInCubic:function(e){return Math.pow(e,3)},easeOutCubic:function(e){return Math.pow(e-1,3)+1},easeInOutCubic:function(e){return(e/=st)<1?st*Math.pow(e,3):st*(Math.pow(e-2,3)+2)},easeInQuart:function(e){return Math.pow(e,4)},easeOutQuart:function(e){return-(Math.pow(e-1,4)-1)},easeInOutQuart:function(e){return(e/=st)<1?st*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeInQuint:function(e){return Math.pow(e,5)},easeOutQuint:function(e){return Math.pow(e-1,5)+1},easeInOutQuint:function(e){return(e/=st)<1?st*Math.pow(e,5):st*(Math.pow(e-2,5)+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=st)<1?st*Math.pow(2,10*(e-1)):st*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return(e/=st)<1?-.5*(Math.sqrt(1-e*e)-1):st*(Math.sqrt(1-(e-=2)*e)+1)},easeOutBounce:function(e){return e<ht?ut*e*e:e<ft?ut*(e-=vt)*e+yt:e<pt?ut*(e-=dt)*e+mt:ut*(e-=gt)*e+bt},easeInBack:function(e){return e*e*((lt+1)*e-lt)},easeOutBack:function(e){return(e-=1)*e*((lt+1)*e+lt)+1},easeInOutBack:function(e){var t=1.70158;return(e/=st)<1?st*(e*e*((1+(t*=ct))*e-t)):st*((e-=2)*e*((1+(t*=ct))*e+t)+2)},elastic:function(e){return-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1},swingFromTo:function(e){var t=1.70158;return(e/=st)<1?st*(e*e*((1+(t*=ct))*e-t)):st*((e-=2)*e*((1+(t*=ct))*e+t)+2)},swingFrom:function(e){return e*e*((lt+1)*e-lt)},swingTo:function(e){return(e-=1)*e*((lt+1)*e+lt)+1},bounce:function(e){return e<ht?ut*e*e:e<ft?ut*(e-=vt)*e+yt:e<pt?ut*(e-=dt)*e+mt:ut*(e-=gt)*e+bt},bouncePast:function(e){return e<ht?ut*e*e:e<ft?2-(ut*(e-=vt)*e+yt):e<pt?2-(ut*(e-=dt)*e+mt):2-(ut*(e-=gt)*e+bt)},easeFromTo:function(e){return(e/=st)<1?st*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeFrom:function(e){return Math.pow(e,4)},easeTo:function(e){return Math.pow(e,.25)}},at._$name="FunctionHelper";var xt=Array.isArray,Et=Object.prototype.hasOwnProperty,Dt={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,buffer:1,throttle:1,name:1},Tt=function(e,t){return t.prio-e.prio},Ot=function(e){return function(e){Ye()(n,e);var t=St(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"destroy",value:function(){this.trigger("beforeDestroy"),tt()(Ze()(n.prototype),"destroy",this).call(this)}},{key:"construct",value:function(e){var t,r;(this.configuredListeners=null===(t=e)||void 0===t?void 0:t.listeners)&&delete(e=Rt({},e)).listeners;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(r=tt()(Ze()(n.prototype),"construct",this)).call.apply(r,[this,e].concat(o)),this.processConfiguredListeners()}},{key:"processConfiguredListeners",value:function(){if(this.configuredListeners){var e=this,t=e.isConfiguring;e.isConfiguring=!1,e.listeners=e.configuredListeners,e.configuredListeners=null,e.isConfiguring=t}}},{key:"doDestroy",value:function(){this.trigger("destroy"),this.removeAllListeners(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"addListener",value:function(e,t,n){if(!xt(e)){var r,i=this,o=i.$meta.getInherited("deprecatedEvents");if("string"==typeof e)return i.addListener((r={},Qe()(r,e,t),Qe()(r,"detachable",!1!==t.detachable),Qe()(r,"thisObj",n),r));for(var a in t=e.thisObj=void 0!==e.thisObj?e.thisObj:t,e)Dt[a]||function(){var n=a.toLowerCase(),r=null==o?void 0:o[n],s=i.eventListeners||(i.eventListeners={}),l=e[a],u=l.expires||e.expires,c={fn:"object"===I()(l)?l.fn:l,thisObj:void 0!==l.thisObj?l.thisObj:t,args:l.args||e.args,prio:void 0!==l.prio?l.prio:void 0!==e.prio?e.prio:0,once:void 0!==l.once?l.once:void 0!==e.once&&e.once,buffer:l.buffer||e.buffer,throttle:l.throttle||e.throttle,catchAll:"catchAll"===a};if(r){var f=r.product,d=r.invalidAsOfVersion,h=r.message;z.a.deprecate(f,d,h)}if(u){var v=i.isDelayable?i:pe.a.global,p=u.alt,g=p?u.delay:u;v.setTimeout((function(){i.un(n,c),p&&!c.called&&i.callback(p,t)}),g)}var y=s[n]||(s[n]=[]);y.$firing&&(s[n]=y=y.slice()),y.splice(it.findInsertionIndex(c,y,Tt,y.length),0,c),!i.onListen.$nullFn&&y.length<2&&i.onListen(n)}();e.relayAll&&i.relayAll(e.relayAll),t&&t!==i&&i.attachAutoDetacher(e,t);var s,l=!1!==e.detachable,u=e.name,c=e.expires||l||u?function(){i.isDestroyed||i.removeListener(e,t)}:null;return c&&(c.eventer=i,c.listenerName=u,u&&null!==(s=t)&&void 0!==s&&s.trackDetacher&&t.trackDetacher(u,c),e.expires&&i.delay(c,e.expires),l)?c:void 0}for(var f=0,d=e.length;f<d;f++)this.addListener(e[f],t)}},{key:"on",value:function(){return this.addListener.apply(this,arguments)}},{key:"un",value:function(){this.removeListener.apply(this,arguments)}},{key:"listeners",get:function(){return this.eventListeners}},{key:"changeListeners",value:function(e){if(!this.isConfiguring)return e&&!("thisObj"in e)&&(e=he.assign({thisObj:this},e)),e;e&&this.on(e,this)}},{key:"updateListeners",value:function(e,t){t&&this.un(t),e&&this.on(e)}},{key:"removeListener",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.thisObj,n=arguments.length>2?arguments[2]:void 0,r=this;if("string"==typeof e)return r.removeListener(Qe()({},e,t),n);Object.entries(e).forEach((function(e){var n=N()(e,2),i=n[0],o=n[1];if(!Dt[i]){i=i.toLowerCase();var a=r.eventListeners,s=r.findListener(i,o,t);if(s>=0){var l=a[i];l.length>1?(l.$firing&&(a[i]=l=l.slice()),l.splice(s,1)):(delete a[i],r.onUnlisten.$nullFn||r.onUnlisten(i))}}})),e.thisObj&&!e.thisObj.isDestroyed&&r.detachAutoDetacher(e)}},{key:"findListener",value:function(e,t,n){var r,i=null===(r=this.eventListeners)||void 0===r?void 0:r[e],o=t.fn||t,a=t.thisObj||n;if(i)for(var s,l=0,u=i.length;l<u;l++)if((s=i[l]).fn===o&&s.thisObj===a)return l;return-1}},{key:"hasListener",value:function(e){var t;return Boolean(null===(t=this.eventListeners)||void 0===t?void 0:t[null==e?void 0:e.toLowerCase()])}},{key:"relayAll",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.relayAllTargets||(this.relayAllTargets=[]);var r=this.relayAllTargets;e.on("beforeDestroy",(function(t){t.source===e&&r.filter((function(t){return t.through===e})).forEach((function(e){return it.remove(r,e)}))})),r.push({through:e,prefix:t,transformCase:n})}},{key:"removeAllListeners",value:function(){var e,t,n=this.eventListeners;for(var r in n){var i=n[r];for(e=i.length;e-- >0;){var o,a=i[e];this.removeListener(r,a),null!==(o=t=a.thisObj)&&void 0!==o&&o.untrackDetachers&&t.untrackDetachers(this)}}}},{key:"relayEvents",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i={detachable:!0};return t.forEach((function(e){i[e]=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return n.trigger.apply(n,[r+e.type,e].concat(i))}})),e.on(i)}},{key:"onListen",value:function(){}},{key:"onUnlisten",value:function(){}},{key:"destructorInterceptor",value:function(){for(var e=this.autoDetachers,t=this.target,n=this.oldDestructor,r=0;r<e.length;r++){var i=e[r],o=i.dispatcher,a=i.config;o.isDestroyed||o.removeListener(a,t)}n.call(t)}},{key:"attachAutoDetacher",value:function(e,t){var n=this,r=e.thisObj||t,i="doDestroy"in r?"doDestroy":"destroy";if(i in r){var o=r.$autoDetachers;o||(r.$autoDetachers=o=[]),r.$oldDestructor||(r.$oldDestructor=r[i],r[i]=this.destructorInterceptor.bind({autoDetachers:o,oldDestructor:r.$oldDestructor,target:r})),o.push({config:e,dispatcher:this})}else r[i]=function(){n.removeListener(e)}}},{key:"detachAutoDetacher",value:function(e){var t=this,n=e.thisObj;n.$oldDestructor&&!n.isDestroying&&(it.remove(n.$autoDetachers,n.$autoDetachers.find((function(n){return n.config===e&&n.dispatcher===t}))),n.$autoDetachers.length||(n["doDestroy"in n?"doDestroy":"destroy"]=n.$oldDestructor,n.$oldDestructor=null))}},{key:"await",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{checkLog:!0,resetLog:!0,args:null},n=this;!1===t&&(t={checkLog:!1});var r=t,i=r.args;return new Promise((function(r){var o,a;if(t.checkLog&&null!==(o=n._triggered)&&void 0!==o&&o[e]&&(r(),t.resetLog&&n.clearLog(e)),i)var s,l=n.on((s={},Qe()(s,e,(function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var u=Object.keys(i).every((function(e){return e in a[0]&&a[0][e]===i[e]}));u&&(r.apply(void 0,a),t.resetLog&&n.clearLog(e),l())})),Qe()(s,"prio",-1e4),s));else n.on((a={},Qe()(a,e,(function(){r.apply(void 0,arguments),t.resetLog&&n.clearLog(e)})),Qe()(a,"prio",-1e4),Qe()(a,"once",!0),a))}))}},{key:"clearLog",value:function(e){this._triggered&&(e?delete this._triggered[e]:this._triggered={})}},{key:"trigger",value:function(e,t){var n,r,i,o,a,s,l=this,u=e.toLowerCase(),c=l.eventsSuspended,f=l.relayAllTargets,d=l.callOnFunctions,h=null===(n=l.eventListeners)||void 0===n?void 0:n[u];if(l._triggered||(l._triggered={}),l._triggered[e]=!0,c)return c.shouldQueue&&c.queue.push(arguments),!0;null!==(r=l.eventListeners)&&void 0!==r&&r.catchall&&((s=h=h?h.slice():[]).push.apply(s,F()(l.eventListeners.catchall)),h.sort(Tt));if(!h&&!f&&!d)return!0;if(t?"source"in t||(Object.isExtensible(t)?t.source=l:t=Object.setPrototypeOf({source:l},t)):t={source:l},t.type!==u&&(t.constructor!==Object?Reflect.defineProperty(t,"type",{get:function(){return u}}):t.type=u),!("bubbles"in t)&&null!==(i=l.bubbleEvents)&&void 0!==i&&i[e]&&(t.bubbles=l.bubbleEvents[e]),d){var v="on"+te.capitalize(e);if(v in l){var p,g=!1===l.callback(l[v],l,[t]);if(!l.isDestroyed&&Et.call(l,v)&&(null===(p=l.pluginFunctionChain)||void 0===p||!p[v])){var y=Object.getPrototypeOf(l);if(v in y&&(g=!1===y[v].call(l,t)||g,l.isDestroyed))return}if(g)return!1}}if(h){var m,b,k,w=0;for(h.$firing=!0;w<h.length&&!l.isDestroyed&&!1!==k;w++){var C=(m=h[w]).thisObj;if(!C||!C.isDestroyed){var R;if(m.called=!0,m.once&&l.removeListener(u,m),"string"==typeof m.fn){if(C&&(b=C[m.fn]),!b){var S=l.resolveCallback(m.fn);b=S.handler,C=S.thisObj}}else b=m.fn;if(m.buffer){if(!m.bufferFn){var x=Number(m.buffer);if("number"!=typeof x||isNaN(x))throw new Error('Incorrect type for buffer, got "'.concat(x,'" (expected a Number)'));m.bufferFn=at.createBuffered(b,x,m.thisObj,m.args)}b=m.bufferFn}if(m.throttle){var E=Number(m.throttle);if("number"!=typeof E||isNaN(E))throw new Error('Incorrect type for throttle, got "'.concat(E,'" (expected a Number)'));m.throttledFn||(m.throttledFn=at.createThrottled(b,E,m.thisObj,m.args)),b=m.throttledFn}k=(R=b).call.apply(R,[C||l].concat(F()(m.args||[]),[t])),he.isPromise(k)&&(a||(a=[])).push(k)}}if(h.$firing=!1,!1===k)return k}return f&&f.forEach((function(n){var r=e;if(n.transformCase&&(r=te.capitalize(r)),n.prefix&&(r=n.prefix+r),!1===n.through.trigger(r,t))return!1})),t.bubbles&&l.owner&&!l.owner.isDestroyed?l.owner.trigger(e,t):null===(o=a)||void 0===o||!o.length||new Promise((function(e){Promise.all(a).then((function(t){var n=!t.some((function(e){return!1===e}));e(n)}))}))}},{key:"suspendEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.eventsSuspended||(this.eventsSuspended={shouldQueue:e,queue:[],count:0});t.count++}},{key:"resumeEvents",value:function(){var e=this.eventsSuspended;if(e&&0==--e.count&&(this.eventsSuspended=null,e.shouldQueue)){var t,n=kt(e.queue);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.trigger.apply(this,F()(r))}}catch(e){n.e(e)}finally{n.f()}}return!Boolean(this.eventsSuspended)}}],[{key:"$name",get:function(){return"Events"}},{key:"declarable",get:function(){return["deprecatedEvents"]}},{key:"setupDeprecatedEvents",value:function(e,t){var n=t.getInherited("deprecatedEvents"),r=e.deprecatedEvents;for(var i in r)n[i.toLowerCase()]=n[i]=r[i]}},{key:"configurable",get:function(){return{listeners:{value:null,$config:{merge:function(e,t){if(null!==e){if(!e)return t;t&&(e=e?[e]:[]).push[xt(t)?"apply":"call"](e,t)}return e}}},bubbleEvents:null}}},{key:"setupClass",value:function(e){tt()(Ze()(n),"setupClass",this).call(this,e),n.prototype.onListen.$nullFn=!0,n.prototype.onUnlisten.$nullFn=!0}}]),n}(e||$e)},Mt=(n(134),n(7)),At=n.n(Mt),It=(n(31),n(9)),Pt=n.n(It),Ft=function(){function e(){B()(this,e)}return _()(e,null,[{key:"animationFrame",value:function(){return new Promise((function(e){requestAnimationFrame(e)}))}},{key:"sleep",value:function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}},{key:"yield",value:function(){return Promise.resolve()}}]),e}();Ft._$name="AsyncHelper";n(124),n(145),n(248),n(206),n(243),n(265),n(267);var Lt,Bt=n(138),jt=n.n(Bt);function _t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ht(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Nt=/^(\w+)=(.*)$/,zt=(null===(Lt=pe.a.queryString)||void 0===Lt?void 0:Lt.__resourceRoot)||"",Vt=function(){function e(){B()(this,e)}return _()(e,null,[{key:"get",value:function(e,t){return this.fetch(e,t)}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t instanceof FormData||"string"==typeof t||(t=JSON.stringify(t),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},n))}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new AbortController;if(Object.assign(t,{abortController:n,signal:n.signal}),"credentials"in t||(t.credentials="include"),t.queryParams){var r=Object.entries(t.queryParams);r.length&&(e+=(e.includes("?")?"&":"?")+r.map((function(e){var t=N()(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(encodeURIComponent(r))})).join("&"))}var i=new Promise((function(n,r){fetch(zt+e,t).then((function(e){t.parseJson?e.json().then((function(t){e.parsedJson=t,n(e)})).catch((function(t){e.parsedJson=null,e.error=t,r(e)})):n(e)})).catch((function(e){e.stack=i.stack,"AbortError"!==e.name&&r(e)}))}));return i.stack=(new Error).stack,i.abort=function(){n.abort()},i}))},{key:"mockUrl",value:function(t,n){var r=this;(r.mockAjaxMap||(r.mockAjaxMap={}))[t]=n,e.originalFetch||(e.originalFetch=e.fetch),e.fetch=r.mockAjaxFetch.bind(r)}},{key:"mockAjaxFetch",value:function(t,n){var r=t.split("?"),i=this.mockAjaxMap[r[0]],o=null;if(i){"function"==typeof i&&(i=i(r[0],r[1]&&function(e){var t,n={},r=_t(e.split("&"));try{for(r.s();!(t=r.n()).done;){var i=t.value,o=Nt.exec(i),a=N()(o,3),s=a[0],l=a[1],u=a[2],c=decodeURIComponent(l),f=decodeURIComponent(u);if(s){var d=n[c];d?(Array.isArray(d)||(d=n[c]=[d]),d.push(f)):n[c]=f}}}catch(e){r.e(e)}finally{r.f()}return n}(r[1]),n));try{o=n.parseJson&&JSON.parse(i.responseText)}catch(e){o=null,i.error=e}return i=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:t,parsedJson:o,text:function(){return new Promise((function(e){e(i.responseText)}))},json:function(){return new Promise((function(e){e(o)}))}},i),new Promise((function(e,t){i.synchronous?e(i):setTimeout((function(){e(i)}),"delay"in i?i.delay:100)}))}return e.originalFetch(t,n)}}]),e}();function Wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wt(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Vt._$name="AjaxHelper";var Ut=function(){function e(){B()(this,e)}return _()(e,null,[{key:"mergeLocales",value:function(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){Object.keys(t).forEach((function(n){"object"===I()(t[n])?e[n]=$t($t({},e[n]),t[n]):e[n]=t[n]}))})),e}},{key:"trimLocale",value:function(e,t){var n=function(t,n){if(!e[t])throw new Error('Key "'.concat(t,"\" doesn't exist in locale"));if(n){if(!e[t][n])throw new Error('SubKey "'.concat(t,".").concat(n,"\" doesn't exist in locale"));delete e[t][n]}else delete e[t]};Object.keys(t).forEach((function(e){Object.keys(t[e]).length>0?Object.keys(t[e]).forEach((function(t){return n(e,t)})):n(e)}))}},{key:"publishLocale",value:function(e,t){var n=window.bryntum=window.bryntum||{},r=n.locales=n.locales||{};r[e]=r[e]?this.mergeLocales(r[e],t):t}}]),e}();function Gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ut._$name="LocaleHelper";var Yt=new(function(e){Ye()(n,e);var t=Gt(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){for(var e,t=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];if((e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this].concat(i)),pe.a.isBrowserEnv){var a=document.querySelector("script[data-default-locale]"),s=window.bryntum||{},l=s.locales;a&&(t.defaultLocaleName=a.dataset.defaultLocale),l&&(Object.keys(l).forEach((function(e){if(!e.startsWith("moment")){var n=l[e];n.extends?t.extendLocale(n.extends,n):n.localeName&&t.registerLocale(n.localeName,{desc:n.localeDesc,locale:n})}})),t.locale||"En"!==t.defaultLocaleName&&t.applyLocale(t.defaultLocaleName||Object.keys(t.locales)[0]))}}},{key:"locales",get:function(){return this._locales},set:function(e){this._locales=e}},{key:"locale",get:function(){return this._locale},set:function(e){"string"==typeof e?this.applyLocale(e):(e.locale||(e={locale:e,localeName:e.localeName||"custom"}),this.registerLocale(e.localeName,e),this.applyLocale(e.localeName))}},{key:"registerLocale",value:function(e,t){var n,r=this,i=r.defaultLocaleName===e,o=(null===(n=r.locale)||void 0===n?void 0:n.localeName)===e,a=0===Object.keys(r.locales).length,s=r.locales[e];s?(t.exclude&&(s.exclude=Ut.mergeLocales(s.exclude||{},t.exclude)),s.locale=Ut.mergeLocales(s.locale,t.locale)):(r.locales[e]=t,s=r.locales[e]),s.exclude&&Ut.trimLocale(s.locale,s.exclude),(i||!r.defaultLocaleName&&(a||o))&&r.internalApplyLocale(s)}},{key:"extendLocale",value:function(e,t){var n,r=this.locales[e];return!!r&&(r.locale=Ut.mergeLocales(r.locale,t),delete r.locale.extends,(null===(n=this.locale)||void 0===n?void 0:n.localeName)===e&&this.applyLocale(e),!0)}},{key:"internalApplyLocale",value:function(e){this._locale=e.locale,this.trigger("locale",e)}},{key:"applyLocale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.locales[e];if(null!=i&&i.locale&&r._locale===i.locale&&!t)return!0;if(!i){if(n)return!0;throw new Error("Locale ".concat(e," not registered"))}function o(){r.internalApplyLocale(i)}return i.locale?(o(),!0):new Promise((function(t,n){r.loadLocale(i.path).then((function(n){n.text().then((function(n){new Function(n)(),pe.a.isBrowserEnv&&(i.locale=window.bryntum.locales[e]),o(),t(i)}))})).catch((function(e){return n(e)}))}))}},{key:"loadLocale",value:function(e){return Vt.get(e)}},{key:"throwOnMissingLocale",get:function(){return this._throwOnMissingLocale},set:function(e){this._throwOnMissingLocale=e}}],[{key:"defaultConfig",get:function(){return{locales:{},throwOnMissingLocale:z.a.isTestEnv}}}]),n}(Ot($e)));function qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Zt=Object.getPrototypeOf(Object),Jt=/L{.*?}/g,Qt=function(e){return e.replace(/\[\[(\d+)]]/gm,"{$1}")},en=function(e){return function(e){Ye()(n,e);var t=Xt(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this,t].concat(i)),Yt.on("locale",this.updateLocalization,this),this.updateLocalization()}},{key:"localeClass",get:function(){return this._localeClass||null}},{key:"localizeProperty",value:function(e){var t,r=this,i=he.getPath(r,e),o=null===(t=r.$meta.configs[e])||void 0===t?void 0:t.localeKey;if(o){var a=n.localize(o,null,r.localeClass||r);a&&!(e in r.initialConfig)&&he.setPath(r,e,a)}else if("string"==typeof i){r.originalLocales=r.originalLocales||{};var s=he.getPath(r.originalLocales,e);void 0===s&&(he.setPath(r.originalLocales,e,i),s=i),s&&he.setPath(r,e,r.optionalL(s))}}},{key:"updateLocalization",value:function(){var e;null===(e=this.localizableProperties)||void 0===e||e.forEach(this.localizeProperty,this)}},{key:"L",value:function(e,t){var r=this.localeClass,i=this.constructor;return r&&n.clsName(r)!==n.clsName(i)?n.L(e,t,r,i):n.L(e,t,i)}},{key:"optionalL",value:function(e,t){var n=Yt.throwOnMissingLocale;Yt.throwOnMissingLocale=n&&Jt.test(e);var r=this.L(e,t);return Yt.throwOnMissingLocale=n,r}},{key:"localeManager",get:function(){return Yt}}],[{key:"$name",get:function(){return"Localizable"}},{key:"configurable",get:function(){return{localeClass:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}},{key:"clsName",value:function(e){var t,n;return"string"==typeof e?e:e===Zt?"Object":e.$$name||e.name||(null===(t=e.prototype)||void 0===t?void 0:t.$$name)||(null===(n=e.prototype)||void 0===n?void 0:n.name)}},{key:"parseLocaleString",value:function(e){var t,n,r=[];if(null!==(t=e)&&void 0!==t&&t.includes("L{")){var i=/L{(.*?)}/g;for(e=e.replace(/{(\d+)}/gm,"[[$1]]");null!=(n=i.exec(e));){var o=/((.*?)\.)?(.+)/g.exec(n[1]);r.push({match:Qt(n[0]),localeKey:Qt(o[3]),localeClass:o[2]})}}return r.length>0?r:[{match:e,localeKey:e,localeClass:void 0}]}},{key:"getTranslation",value:function(e,t,r){var i,o,a=this,s=Yt.locale,l=null;if(s){var u,c=qt(this.parseLocaleString(e));try{var f=function(){var c=u.value,f=c.match,d=c.localeKey,h=c.localeClass,v=function(n){var i,o=null===(i=s[n])||void 0===i?void 0:i[d];return o&&(l="function"==typeof o?null!=t?o(t):o:"object"===I()(o)||e===f?o:(l||e).replace(f,o),"string"==typeof o&&o.includes("L{")&&(l=a.getTranslation(o,t,r))),o},p=!1;for(o=r;o&&(i=n.clsName(o))&&!(p=v(i))&&"string"!=typeof o;o=Object.getPrototypeOf(o));!p&&h&&v(h)};for(c.s();!(u=c.n()).done;)f()}catch(e){c.e(e)}finally{c.f()}}return l}},{key:"localize",value:function(e){for(var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];0===(null===(t=o)||void 0===t?void 0:t.length)&&(o=[this]);var s=null;return o.some((function(t){return null!=(s=n.getTranslation(e,r,t))})),s}},{key:"L",value:function(e){for(var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];0===(null===(t=o)||void 0===t?void 0:t.length)&&(o=[this]);var s=this.localize.apply(this,[e,r].concat(F()(o)));if(Yt.throwOnMissingLocale&&Yt.locale&&null==s)throw new Error("Localization is not found for '".concat(e,"' in '").concat(o.map((function(e){return n.clsName(e)})).join(", "),"'. ").concat(Yt.locale.localeName?"Locale : ".concat(Yt.locale.localeName):""));return null!=s?s:e}},{key:"optionalL",value:function(e){for(var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];var s=Yt.throwOnMissingLocale;Yt.throwOnMissingLocale=s&&Jt.test(e),0===(null===(t=o)||void 0===t?void 0:t.length)&&(o=[this]);var l=n.L.apply(n,[e,r].concat(F()(o)));return Yt.throwOnMissingLocale=s,l}}]),n}(e||$e)};function tn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rn(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function an(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var sn=Object.prototype.toString,ln=sn.call(new Date),un=new RegExp("‎","g"),cn=function(e,t){return isNaN(e)||null==e?t:e},fn=function(e){var t="th";["11","12","13"].find((function(t){return e.endsWith(t)}))||(t={1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th");return e+t},dn=function(e,t,n){var r=(bn[e]||(bn[e]=new Intl.DateTimeFormat(gn,t))).format(n);return pe.a.isIE11&&(r=r.replace(un,"")),r},hn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=dn(e,t,n);return/am|pm/i.test(i)&&(i=i.replace(/^0/,""),r&&(i=i.replace(/:00/,""))),i},vn=function(e,t){return Math.floor((e.getTime()-t.getTime()-(e.getTimezoneOffset()-t.getTimezoneOffset())*An.minute.millisecond)/An.day.millisecond)+1},pn=function(e){return e>=0?e:e+7},gn="en-US",yn=fn,mn={},bn={},kn={},wn=2020,Cn={M:function(e){return e.getMonth()+1},Mo:function(e){return yn(Cn.M(e).toString())},MM:function(e){return(e.getMonth()+1).toString().padStart(2,"0")},MMM:function(e){return dn("MMM",{month:"short"},e)},MMMM:function(e){return dn("MMMM",{month:"long"},e)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},Qo:function(e){return yn(Cn.Q(e).toString())},D:function(e){return e.getDate()},Do:function(e){return yn(Cn.D(e).toString())},DD:function(e){return e.getDate().toString().padStart(2,"0")},DDD:function(e){return Math.ceil((new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0)-new Date(e.getFullYear(),0,0,12,0,0))/An.day.millisecond)},DDDo:function(e){return yn(Cn.DDD(e).toString())},DDDD:function(e){return Cn.DDD(e).toString().padStart(3,"0")},d:function(e){return e.getDay()},do:function(e){return yn(e.getDay().toString())},d1:function(e){return Cn.ddd(e).substring(0,1)},dd:function(e){return Cn.ddd(e).substring(0,2)},ddd:function(e){return dn("ddd",{weekday:"short"},e)},dddd:function(e){return dn("dddd",{weekday:"long"},e)},e:function(e){return e.getDay()},E:function(e){return e.getDay()+1},W:function(e){return Un.getWeekNumber(e)[1]},Wo:function(e){return yn(Cn.W(e).toString())},WW:function(e){return Cn.W(e).toString().padStart(2,"0")},Y:function(e){return e.getFullYear()},YY:function(e){return e.getFullYear()%100},YYYY:function(e){return e.getFullYear()},A:function(e){return e.getHours()<12?"AM":"PM"},a:function(e){return e.getHours()<12?"am":"pm"},H:function(e){return e.getHours()},HH:function(e){return e.getHours().toString().padStart(2,"0")},h:function(e){return e.getHours()%12||12},hh:function(e){return Cn.h(e).toString().padStart(2,"0")},k:function(e){return e.getHours()+1},kk:function(e){return Cn.k(e).toString().padStart(2,"0")},K:function(e){return hn("K",{hour:"numeric"},e)},KK:function(e){return hn("KK",{hour:"2-digit"},e)},m:function(e){return e.getMinutes()},mm:function(e){return Cn.m(e).toString().padStart(2,"0")},s:function(e){return e.getSeconds()},ss:function(e){return Cn.s(e).toString().padStart(2,"0")},S:function(e){return Math.floor(e.getMilliseconds()/100).toString()},SS:function(e){return Math.floor(e.getMilliseconds()/10).toString().padStart(2,"0")},SSS:function(e){return e.getMilliseconds().toString().padStart(3,"0")},z:function(e){return dn("z",{timeZoneName:"short"},e)},zz:function(e){return dn("zz",{timeZoneName:"long"},e)},Z:function(e){return Gn.getGMTOffset(e)},LT:function(e){return hn("LT",{hour:"2-digit",minute:"2-digit"},e)},LST:function(e){return hn("LST",{hour:"numeric",minute:"2-digit"},e,!0)},LTS:function(e){return hn("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},e)},L:function(e){return dn("L",{year:"numeric",month:"2-digit",day:"2-digit"},e)},l:function(e){return dn("l",{year:"numeric",month:"numeric",day:"numeric"},e)},LL:function(e){return dn("LL",{year:"numeric",month:"long",day:"numeric"},e)},ll:function(e){return dn("ll",{year:"numeric",month:"short",day:"numeric"},e)},LLL:function(e){return dn("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},e)},lll:function(e){return dn("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},e)},LLLL:function(e){return dn("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},e)},llll:function(e){return dn("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},e)}},Rn=Object.keys(Cn).sort((function(e,t){return t.length-e.length})),Sn="^(?:".concat(Rn.join("|"),")"),xn=function(){return{}},En=function(e){return function(e){return Nn.test(e)}(e)&&{milliseconds:parseInt(e.padEnd(3,"0").substring(0,3))}},Dn={YYYY:function(e){return{year:parseInt(e)}},Y:function(e){return{year:parseInt(e)}},YY:function(e){var t=parseInt(e);return{year:t+(t>1968?1900:2e3)}},MM:function(e){return{month:parseInt(e)-1}},Mo:function(e){return{month:parseInt(e)-1}},DD:function(e){return{date:parseInt(e)}},M:function(e){return{month:parseInt(e)-1}},D:function(e){return{date:parseInt(e)}},Do:function(e){return{date:parseInt(e)}},DDD:xn,MMM:xn,MMMM:xn,DDDo:xn,DDDD:xn,d:xn,do:xn,d1:xn,dd:xn,ddd:xn,dddd:xn,Q:xn,Qo:xn,W:xn,Wo:xn,WW:xn,e:xn,E:xn,HH:function(e){return{hours:parseInt(e)}},hh:function(e){return{hours:parseInt(e)}},mm:function(e){return{minutes:parseInt(e)}},H:function(e){return{hours:parseInt(e)}},m:function(e){return{minutes:parseInt(e)}},ss:function(e){return{seconds:parseInt(e)}},s:function(e){return{seconds:parseInt(e)}},S:En,SS:En,SSS:En,A:function(e){return{amPm:e.toLowerCase()}},a:function(e){return{amPm:e.toLowerCase()}},L:"MM/DD/YYYY",LT:"HH:mm A",Z:function(e){if(!e||!zn.test(e)&&"Z"!==e)return null;var t=0;if("Z"!==e){var n=zn.exec(e);if(n)t=("+"===n[1]?1:-1)*(60*(parseInt(n[2])||0)+(parseInt(n[3])||0));else t=-1*(new Date).getTimezoneOffset()}return{timeZone:t}}},Tn=Object.keys(Dn).sort((function(e,t){return t.length-e.length})),On=new RegExp("(".concat(Tn.join("|"),")")),Mn=new RegExp("(l|LL|ll|LLL|lll|LLLL|llll)"),An={decade:{decade:1,year:10,quarter:40,month:120,week:520,day:3652,hour:87648,minute:5258880,second:315532800,millisecond:3155328e5},year:{decade:.1,year:1,quarter:4,month:12,week:52,day:365,hour:8760,minute:525600,second:31536e3,millisecond:31536e6},quarter:{decade:1/40,year:1/4,quarter:1,month:3,week:4,day:91,hour:2184,minute:131040,second:7862400,millisecond:78624e5},month:{decade:1/120,year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-720,minute:-43200,second:-2592e3,millisecond:-2592e6},week:{decade:-1/520,year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{decade:-1/3652,year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{decade:-1/87648,year:-1/8760,quarter:-1/2184,month:-1/720,week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{decade:-1/5258880,year:-1/525600,quarter:-1/131040,month:-1/43200,week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{decade:-1/315532800,year:-1/31536e3,quarter:-1/7862400,month:-1/2592e3,week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{decade:-1/3155328e5,year:-1/31536e6,quarter:-1/78624e5,month:-1/2592e6,week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:.001}},In={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",mi:"minute",min:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year",dec:"decade",decades:"decade"},Pn=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,Fn=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,Ln=["millisecond","second","minute","hour","day","week","month","quarter","year","decade"],Bn=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],jn=["decade","year","month","week","day","hour","minute","second","millisecond"],_n=["milliseconds","seconds","minutes","hours","date","month","year"],Hn=function(e){var t=parseFloat(e);return isNaN(t)?null:t},Nn=/^[0-9]+$/,zn=/([+-])(\d\d):*(\d\d)*$/,Vn={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8,decade:9},Wn={round:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round(e/t)*t},floor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.floor(e/t)*t},ceil:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.ceil(e/t)*t}},$n={},Un=function(e){Ye()(n,e);var t=an(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"DateHelper"}},{key:"defaultFormat",get:function(){return Gn._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"},set:function(e){Gn._defaultFormat=e}},{key:"defaultParseFormat",get:function(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"},set:function(e){this._defaultParseFormat=e}},{key:"buildParser",value:function(e){var t=this,n=e.split(On),r=[];return 1===n.length||Mn.test(e)?[]:(n.reduce((function(n,i,o,a){if(0!==o||""!==i)if(On.test(i)){var s=(t.localize("L{parsers}")||{})[i]||Dn[i];if("Z"===i&&o<a.length-2)throw new Error("Invalid format ".concat(e," TimeZone (Z) must be last token"));if("string"==typeof s){var l=Gn.buildParser(s),u=l.pop();delete u.last,r.push.apply(r,F()(l)),n=u}else n.pattern=i,n.fn=Dn[i]}else n.splitter=i,r.push(n),n={};else Object.prototype.hasOwnProperty.call(n,"pattern")&&r.push(n);return n}),{}),r[r.length-1].last=!0,r)}},{key:"makeKey",value:function(e){e.getTime&&(e=e.getTime());var t=$n[e];return t||($n[e]=Gn.format(new Date(e),"YYYY-MM-DD"))}},{key:"parseKey",value:function(e){return Gn.parse(e,"YYYY-MM-DD")}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gn.defaultParseFormat;if(e instanceof Date)return e;if("string"!=typeof e||!e)return null;var n={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(/S+/gm,"SSS");var r=kn[t];r||(r=kn[t]=Gn.buildParser(t)),r.reduce((function(e,t){if(!t.last){var r,i,o;if(-1===(r="T"===t.splitter&&-1===e.indexOf("T")?e.indexOf(" "):""!==t.splitter?e.indexOf(t.splitter):t.pattern&&t.pattern.length||-1)||"SSS"===t.pattern&&e.match(/^\d+Z$/)){var a=e.split(/([Z\-+])/);1===a.length?(i=e,o=""):(i=a[0],o="".concat(a[1]).concat(a[2]))}else i=e.substring(0,r)||e,o=e.substring(r+t.splitter.length);if(t.fn){var s=t.fn(i);s?Object.assign(n,s):o=i+o}return o}Object.assign(n,t.fn(e))}),e),n.year&&!n.date&&(n.date=1);var i=Gn.create(n);return i||new Date(e)}},{key:"create",value:function(e){var t=on({},e),n=isNaN(t.year),r=!1;if(!n){var i=!0;_n.forEach((function(e){e in t&&!isNaN(t[e])||(t[e]=0),i=i&&null===t[e]})),n=i}if("pm"===t.amPm&&(t.hours=t.hours%12+12),"timeZone"in t&&(r=!0,t.minutes-=t.timeZone),n)return null;var o=[cn(t.year,wn),cn(t.month,0),cn(t.date,1),t.hours,t.minutes,t.seconds,t.milliseconds];return r?new Date(Date.UTC.apply(Date,o)):jt()(Date,o)}},{key:"toUTC",value:function(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}},{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gn.defaultFormat;if(!e||isNaN(e))return null;var n=mn[t],r="";if(!n){n=mn[t]=[];for(var i=0;i<t.length;i++){var o=t.substr(i).match(Sn),a=null==o?void 0:o[0];if(a){var s=this.localize("L{formats}")||{},l=s[a]||Cn[a];n.push(l),i+=a.length-1}else if("{"===t[i]){var u=t.indexOf("}",i+1);-1===u?(n.push(t.substr(i+1)),i=t.length):(n.push(t.substring(i+1,u)),i=u)}else n.push(t[i])}}return n.forEach((function(t){r+="string"==typeof t?t:t(e)})),(pe.a.isEdge||pe.a.isIE11)&&(r=r.replace(/\u200E/g,"")),r}},{key:"asMilliseconds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"==typeof e&&(t=e,e=1),Gn.as("millisecond",e,t)}},{key:"asMonths",value:function(e){var t=Gn.as("ms",Gn.daysInMonth(e),"day"),n=(e.valueOf()-Gn.startOf(e,"month").valueOf())/t;return 12*e.getYear()+e.getMonth()+n}},{key:"monthsToDate",value:function(e){var t=Math.floor(e),n=e-t,r=new Date(0,t),i=Gn.as("ms",Gn.daysInMonth(r),"days");return r.setTime(r.getTime()+n*i),r}},{key:"formatDelta",value:function(e,t){var n,r;"boolean"==typeof t?n=t:t&&(n=t.abbrev);var i=this.getDelta(e,t),o=[],a=(null==t?void 0:t.separator)||(n?"":" ");for(r in i)o.push("".concat(i[r]).concat(a).concat(r));return!1===(null==t?void 0:t.asString)?o:o.join(", ")}},{key:"getDelta",value:function(e,t){var n,r,i,o,a;"boolean"==typeof t?n=t:t&&(n=t.abbrev,o=Gn.normalizeUnit(t.precision));var s,l={},u=n?Gn.getShortNameOfUnit:Gn.getLocalizedNameOfUnit,c=tn(jn);try{for(c.s();!(s=c.n()).done&&(a=s.value,r=Gn.as(a,e),i=o===a,((r=Math[i?"round":"floor"](r))||i&&!l.length)&&(l[u.call(Gn,a,1!==r)]=r,e-=Gn.as("ms",r,a)),!i&&e););}catch(e){c.e(e)}finally{c.f()}return l}},{key:"as",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms";return"string"==typeof t&&(t=Gn.parseDuration(t)),"object"===I()(t)&&(n=t.unit,t=t.magnitude),e===n||(e=Gn.normalizeUnit(e))===(n=Gn.normalizeUnit(n))?t:Vn[n]>Vn[e]?t*Math.abs(An[n][e]):t/Math.abs(An[e][n])}},{key:"formatContainsHourInfo",value:function(e){return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(/(\\.)/g,""))}},{key:"is24HourFormat",value:function(e){return Gn.format(Gn.getTime(13,0,0),e).includes("13")}},{key:"add",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms";if(n="string"==typeof e?Gn.parse(e):new Date(e.getTime()),!r||0===t)return n;switch(r=Gn.normalizeUnit(r)){case"millisecond":n=new Date(n.getTime()+t);break;case"second":n=new Date(n.getTime()+1e3*t);break;case"minute":n=new Date(n.getTime()+6e4*t);break;case"hour":n=new Date(n.getTime()+36e5*t);break;case"day":t%1==0?n.setDate(n.getDate()+t):n=new Date(n.getTime()+864e5*t),23===n.getHours()&&0===e.getHours()&&(n=Gn.add(n,1,"hour"));break;case"week":n.setDate(n.getDate()+7*t);break;case"month":var i=n.getDate();i>28&&(i=Math.min(i,Gn.getLastDateOfMonth(Gn.add(Gn.getFirstDateOfMonth(n),t,"month")).getDate())),n.setDate(i),n.setMonth(n.getMonth()+t);break;case"quarter":n=Gn.add(n,3*t,"month");break;case"year":n.setFullYear(n.getFullYear()+t)}return n}},{key:"diff",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms",i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(r=Gn.normalizeUnit(r),!e||!t)return 0;switch(r){case"year":n=Gn.diff(e,t,"month")/12;break;case"quarter":n=Gn.diff(e,t,"month")/3;break;case"month":n=12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth());break;case"week":n=Gn.diff(e,t,"day")/7;break;case"day":var o=e.getTimezoneOffset()-t.getTimezoneOffset();n=(t-e+60*o*1e3)/864e5;break;case"hour":n=(t-e)/36e5;break;case"minute":n=(t-e)/6e4;break;case"second":n=(t-e)/1e3;break;case"millisecond":n=t-e}return i?n:Math.round(n)}},{key:"startOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"day",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;t=Gn.normalizeUnit(t),n&&(e=Gn.clone(e));for(var r={},i=Vn[t],o=0;o<i;o++){var a=Ln[o];"quarter"!==a&&"week"!==a&&(r[a]="day"===a?1:0)}if("quarter"===t)r.month=3*(Gn.get(e,"quarter")-1);else if("week"===t){var s=e.getDay()-Gn.weekStartDay;r.day=e.getDate()-s}return Gn.set(e,r)}},{key:"endOf",value:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}},{key:"clone",value:function(e){return new Date(e.getTime())}},{key:"clearTime",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Gn.startOf(e,"day",t)}},{key:"midnight",value:function(e,t){var n=Gn.clearTime(e);return t&&n<e&&(n=Gn.add(n,1,"d")),n}},{key:"getTimeOfDay",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms",n=e.getHours()*An.hour.millisecond+e.getMinutes()*An.minute.millisecond+e.getSeconds()*An.second.millisecond+e.getMilliseconds();return"ms"===t?n:Gn.as(t,n,"ms")}},{key:"set",value:function(e,t,n){if(!t)return e;if("string"==typeof t)switch(Gn.normalizeUnit(t)){case"millisecond":(0!==n||e.getMilliseconds()>0)&&e.setMilliseconds(n);break;case"second":(0!==n||e.getSeconds()>0)&&e.setSeconds(n);break;case"minute":(0!==n||e.getMinutes()>0)&&e.setMinutes(n);break;case"hour":e.setHours(n);break;case"day":case"date":e.setDate(n);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(n);break;case"quarter":e.setDate(1),e.setMonth(3*(n-1));break;case"year":e.setFullYear(n)}else Object.entries(t).sort((function(e,t){return Vn[e[0]]-Vn[t[0]]})).forEach((function(t){var n=N()(t,2),r=n[0],i=n[1];Gn.set(e,r,i)}));return e}},{key:"setDateToMidday",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Gn.set(Gn.clearTime(e,t),"hour",12)}},{key:"constrain",value:function(e,t,n){return null!=t&&(e=Gn.max(e,t)),null==n?e:Gn.min(e,n)}},{key:"getTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e instanceof Date&&(r=e.getMilliseconds(),n=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(wn,0,1,e,t,n,r)}},{key:"copyTimeValues",value:function(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}},{key:"isDST",value:function(e){var t=e.getFullYear(),n=new Date(t,0,1),r=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(n.getTimezoneOffset(),r.getTimezoneOffset())}},{key:"isBefore",value:function(e,t){return e<t}},{key:"isAfter",value:function(e,t){return e>t}},{key:"isEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null===n?e&&t&&e.getTime()===t.getTime():Gn.startOf(e,n)-Gn.startOf(t,n)==0}},{key:"compare",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n&&(e=Gn.startOf(e,n),t=Gn.startOf(t,n)),e<t?-1:e>t?1:0}},{key:"isStartOf",value:function(e,t){return Gn.isEqual(e,Gn.startOf(e,t))}},{key:"betweenLesser",value:function(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<n.getTime()}},{key:"betweenLesserEqual",value:function(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<=n.getTime()}},{key:"intersectSpans",value:function(e,t,n,r){return Gn.betweenLesser(e,n,r)||Gn.betweenLesser(n,e,t)}},{key:"compareUnits",value:function(e,t){return Math.sign(Vn[e]-Vn[t])}},{key:"timeSpanContains",value:function(e,t,n,r){return n-e>=0&&t-r>=0}},{key:"weekStartDay",get:function(){return this.localize("L{weekStartDay}")||0}},{key:"nonWorkingDays",get:function(){return on({},this.localize("L{nonWorkingDays}"))}},{key:"nonWorkingDaysAsArray",get:function(){return Object.keys(this.nonWorkingDays).map(Number)}},{key:"weekends",get:function(){return on({},this.localize("L{weekends}"))}},{key:"get",value:function(e,t){switch(Gn.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return Cn.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}},{key:"daysInMonth",value:function(e){var t=Gn.clone(e);return t.setDate(1),t.setMonth(e.getMonth()+1),t.setDate(0),t.getDate()}},{key:"getFirstDateOfMonth",value:function(e){return new Date(e.getFullYear(),e.getMonth(),1)}},{key:"getLastDateOfMonth",value:function(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}},{key:"min",value:function(e,t){return e.getTime()<t.getTime()?e:t}},{key:"max",value:function(e,t){return e.getTime()>t.getTime()?e:t}},{key:"getNext",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gn.weekStartDay;if("week"===t){var i=Gn.clone(e),o=i.getDay();return i=Gn.startOf(i,"day"),(i=Gn.add(i,r-o+7*(n-(r<=o?0:1)),"day")).getDay()!==r&&Gn.add(i,1,"hour"),i}return Gn.startOf(Gn.add(e,n,t),t)}},{key:"isValidDate",value:function(e){return Gn.isDate(e)&&!isNaN(e)}},{key:"isDate",value:function(e){return e&&sn.call(e)===ln}},{key:"getStartOfNextDay",value:function(e,t,n){var r=Gn.add(n?e:Gn.clearTime(e,t),1,"day");if(r.getDate()===e.getDate()){var i=Gn.add(Gn.clearTime(e,t),2,"day").getTimezoneOffset(),o=e.getTimezoneOffset();r=Gn.add(r,o-i,"minute")}return r}},{key:"getEndOfPreviousDay",value:function(e,t){var n=t?e:Gn.clearTime(e,!0);return n-e?n:Gn.add(n,-1,"day")}},{key:"getWeekDescription",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=e.getMonth()===t.getMonth()?n.format(e,"MMMM"):"".concat(n.format(e,"MMM")," - ").concat(n.format(t,"MMM")),i=n.getWeekNumber(e);return"".concat(i[1],", ").concat(r," ").concat(i[0])}},{key:"getWeekNumber",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.weekStartDay,i=new Date(e.getFullYear(),0,1),o=new Date(e.getFullYear(),11,31),a=pn(i.getDay()-r),s=pn(o.getDay()-r),l=vn(e,i);if(t=a<4?Math.floor((l+a-1)/7)+1:Math.floor((l+a-1)/7)){var u=e.getFullYear();return 53===t&&s<3&&(u++,t=1),[u,t]}var c=n.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,c]}},{key:"formatCount",value:function(e,t){return t=Gn.normalizeUnit(t),1!==e&&(t+="s"),e+" "+t}},{key:"getUnitToBaseUnitRatio",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(e=Gn.normalizeUnit(e))===(t=Gn.normalizeUnit(t))?1:An[e]&&An[e][t]&&(n||An[e][t]>0)?1/Gn.as(t,1,e):An[t]&&An[t][e]&&(n||An[t][e]>0)?Gn.as(e,1,t):-1}},{key:"getShortNameOfUnit",value:function(e){return e=Gn.parseTimeUnit(e),Gn.unitLookup[e].abbrev}},{key:"getLocalizedNameOfUnit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.charAt(0)===e.charAt(0).toUpperCase();return e=Gn.normalizeUnit(e),e=Gn.parseTimeUnit(e),e=Gn.unitLookup[e][t?"plural":"single"],n&&(e=te.capitalize(e)),e}},{key:"normalizeUnit",value:function(e){if(!e)return null;var t=e.toLowerCase();return"date"===t||Ln.includes(t)?t:In[e]||In[t]}},{key:"getUnitByName",value:function(e){return Gn.normalizeUnit(e)||Gn.normalizeUnit(Gn.parseTimeUnit(e))}},{key:"getDurationInUnit",value:function(e,t,n,r){return Gn.diff(e,t,n,r)}},{key:"doesUnitsAlign",value:function(e,t){return!(e!==t&&"week"===t)}},{key:"getSmallerUnit",value:function(e){return Ln[Vn[Gn.normalizeUnit(e)]-1]||null}},{key:"getLargerUnit",value:function(e){return Ln[Vn[Gn.normalizeUnit(e)]+1]||null}},{key:"round",value:function(e,t,n){return Gn.snap("round",e,t,n)}},{key:"floor",value:function(e,t,n){return Gn.snap("floor",e,t,n)}},{key:"ceil",value:function(e,t,n){return Gn.snap("ceil",e,t,n)}},{key:"snap",value:function(e,t,n,r){var i=Wn[e];if("string"==typeof n&&(n=Gn.parseDuration(n)),he.isObject(n)){var o=n.magnitude||n.increment;switch(n.unit){case"week":var a=Gn.weekStartDay,s=t.getDay();return r=Gn.add(Gn.clearTime(t),s>=a?a-s:-(s-a+7),"day"),Gn[e](t,"".concat(7*o," days"),r);case"month":var l;return t=Gn.asMonths(t),l=r?t+i(t-(r=Gn.asMonths(r)),o):i(t,o),Gn.monthsToDate(l);case"quarter":return Gn[e](t,"".concat(3*o," months"),r);case"year":return Gn[e](t,"".concat(12*o," months"),r);case"decade":return Gn[e](t,"".concat(10*o," years"),r)}n=Gn.as("ms",o,n.unit)}if(r){var u=Gn.as("ms",r.getTimezoneOffset()-t.getTimezoneOffset(),"ms");return new Date(r.valueOf()+i(Gn.diff(r,t,"ms")+u,n))}var c=60*t.getTimezoneOffset()*1e3;return new Date(i(t.valueOf()-c,n)+c)}},{key:"parseDuration",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,i=n?Pn:Fn,o=i.exec(e);if(null==e||!o)return null;var a=Hn(null===(t=o[1])||void 0===t?void 0:t.replace(",",".")),s=Gn.parseTimeUnit(o[2])||r;return s?{magnitude:a,unit:s}:null}},{key:"parseTimeUnit",value:function(e){var t=null==e?null:Gn.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(var n=0;n<Ln.length;n++)if(t[n+1])return Ln[n]}},{key:"getGMTOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;if(e){var t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}}},{key:"fillDayNames",value:function(){var e=new Date("2000-01-01T12:00:00"),t=Gn._dayNames||[],n=Gn._dayShortNames||[];t.length=0,n.length=0;for(var r=2;r<9;r++)e.setDate(r),t.push(Gn.format(e,"dddd")),n.push(Gn.format(e,"ddd"));Gn._dayNames=t,Gn._dayShortNames=n}},{key:"getDayNames",value:function(){return Gn._dayNames}},{key:"getDayName",value:function(e){return Gn._dayNames[e]}},{key:"getDayShortNames",value:function(){return Gn._dayShortNames}},{key:"getDayShortName",value:function(e){return Gn._dayShortNames[e]}},{key:"fillMonthNames",value:function(){var e=new Date("2000-01-15T12:00:00"),t=Gn._monthNames||[],n=Gn._monthShortNames||[];t.length=0,n.length=0;for(var r=0;r<12;r++)e.setMonth(r),t.push(Gn.format(e,"MMMM")),n.push(Gn.format(e,"MMM"));Gn._monthNames=t,Gn._monthShortNames=n}},{key:"getMonthShortNames",value:function(){return Gn._monthShortNames}},{key:"getMonthShortName",value:function(e){return Gn._monthShortNames[e]}},{key:"getMonthNames",value:function(){return Gn._monthNames}},{key:"getMonthName",value:function(e){return Gn._monthNames[e]}},{key:"locale",get:function(){return gn},set:function(e){gn=e}},{key:"setupDurationRegEx",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this,r={},i="",o=0;o<t.length;o++){var a=t[o],s=e[o];s.canonicalUnitName=Ln[o],r[s.single]=r[s.single.toUpperCase()]=r[s.canonicalUnitName]=r[s.canonicalUnitName.toUpperCase()]=s,i+="".concat(o?"|":"","(");for(var l=0;l<a.length;l++)i+="".concat(a[l],"|");if("en-US"!==(gn=n.localize("L{locale}")||"en-US"))for(var u=Bn[o],c=0;c<u.length;c++)i+="".concat(u[c],"|");i+="".concat(s.single,"|").concat(s.plural,"|").concat(s.canonicalUnitName,"|").concat(s.canonicalUnitName,"s)")}n.unitLookup=r,n.durationRegEx=new RegExp("^(?:".concat(i,")$"))}},{key:"applyLocale",value:function(){var e=this,t=e.localize("L{unitAbbreviations}")||[],n=e.unitNames=e.localize("L{unitNames}");"unitNames"!==n&&(gn=e.localize("L{locale}")||"en-US",yn="en-US"===gn?fn:e.localize("L{ordinalSuffix}")||yn,mn={},kn={},bn={},Gn.setupDurationRegEx(n,t),Gn.fillDayNames(),Gn.fillMonthNames())}}]),n}(en()),Gn=Un;function Yn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Gn.useIntlFormat=dn,Yt.on({locale:"applyLocale",prio:1e3,thisObj:Gn}),Yt.locale&&Gn.applyLocale(),Un._$name="DateHelper";var Xn=Object.prototype.hasOwnProperty,Zn=function(e){var t=I()(e);if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"array";if("[object Date]"===Object.prototype.toString.call(e))return"date";if(e.isBase)return"instance"}return"function"===t&&e.isBase?"class":t},Jn="1.01"===1.005.toFixed(2)?null:function(e,t){var n=e.toString().split("."),r=+(n[1]?n.join(".")+"1":n[0]);return e.toFixed.call(r,t)},Qn=function(e){Ye()(n,e);var t=Kn(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"transformArrayToNamedObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ref",n={};return e.forEach((function(e,r){var i=null!=e[t]&&e[t].toString().length?e[t]:r;n[i]=e})),n}},{key:"transformNamedObjectToArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ref";return Object.keys(e).filter((function(t){return e[t]})).map((function(n){var r=e[n];return r[t]=n,r}))}},{key:"isEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===e&&null!==t||void 0===e&&void 0!==t||null===t&&null!==e||void 0===t&&void 0!==e)return!1;if(null==e&&null==t)return!0;if(e===t)return!0;var r=I()(e),i=I()(t);if(r===i){switch(r){case"number":case"string":case"boolean":return e===t}switch(!0){case e instanceof Date&&t instanceof Date:return e.getTime()===t.getTime();case Array.isArray(e)&&Array.isArray(t):return e.length===t.length&&e.every((function(e,r){return er.isEqual(e,t[r],n)}));case"object"===r&&e.constructor.prototype===t.constructor.prototype:return n?er.isDeeplyEqual(e,t,n):JSON.stringify(e)===JSON.stringify(t)}}return String(e)===String(t)}},{key:"isDeeplyEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;if(!e||!t)return!1;var r=er.keys(e,n.ignore),i=er.keys(t,n.ignore);if(r.length!==i.length)return!1;for(var o=0;o<r.length;o++){var a=r[o],s=i[o];if(a!==s)return!1;var l=e[a],u=t[s];if(!n.shouldEvaluate||!1!==n.shouldEvaluate(a,{value:l,object:e},{value:u,object:t})){if(n.evaluate){var c=n.evaluate(a,{value:l,object:e},{value:u,object:t});if(!1===c)return!1;if(!0===c)continue}if(!er.isEqual(l,u,n))return!1}}return!0}},{key:"isPartial",value:function(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),-1!==e.indexOf(t)}},{key:"isLessThan",value:function(e,t){return e instanceof Date&&t instanceof Date?Un.isBefore(e,t):e<t}},{key:"isMoreThan",value:function(e,t){return e instanceof Date&&t instanceof Date?Un.isAfter(e,t):e>t}},{key:"fork",value:function(e){var t,n,r;if(e&&e.constructor===Object)for(n in t=Object.setPrototypeOf({},e),e)(r=e[n])&&(r.constructor===Object?t[n]=er.fork(r):r instanceof Array&&(t[n]=r.slice()));else t=e;return t}},{key:"copyProperties",value:function(e,t,n){var r,i;for(i=0;i<n.length;i++)(r=n[i])in t&&(e[r]=t[r]);return e}},{key:"copyPropertiesIf",value:function(e,t,n){if(t){var r,i=Yn(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;o in e||(e[o]=t[o])}}catch(e){i.e(e)}finally{i.f()}}return e}},{key:"entries",value:function(e,t){var n=[],r="function"==typeof t;if(e)for(var i in e)(r?t(i,e[i]):null!=t&&t[i])||n.push([i,e[i]]);return n}},{key:"fromEntries",value:function(e,t){if(t=t||{},e)for(var n=0;n<e.length;++n)t[e[n][0]]=e[n][1];return t}},{key:"keys",value:function(e,t){var n=[],r="function"==typeof t;if(e)for(var i in e)(r?t(i,e[i]):null!=t&&t[i])||n.push(i);return n}},{key:"values",value:function(e,t){var n=[],r="function"==typeof t;if(e)for(var i in e)(r?t(i,e[i]):null!=t&&t[i])||n.push(e[i]);return n}},{key:"allKeys",value:function(e){return z.a.deprecate("Core","5.0.0","Deprecated in favor of `keys()`; will be removed in 5.0"),n.keys(e)}},{key:"pathExists",value:function(e,t){return t.split(".").every((function(t){return t in e&&(e=e[t],!0)}))}},{key:"pathifyKeys",value:function(e){var t={};for(var n in e)if(Object.hasOwnProperty.call(e,n))if(e[n]instanceof Object){var r=this.pathifyKeys(e[n]);for(var i in r)t["".concat(n,".").concat(i)]=r[i]}else t[n]=e[n];return t}},{key:"deletePath",value:function(e,t){t.split(".").reduce((function(e,t,n,r){if(null==e)return null;if(Object.hasOwnProperty.call(e,t)){if(n!==r.length-1)return e[t];delete e[t]}}),e)}},{key:"coerce",value:function(e,t){var n=Zn(e),r=Zn(t),i="string"==typeof e;if(n!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return!(i&&(!e||"false"===e||"0"===e))&&Boolean(e);case"null":return!(!i||e&&"null"!==e)&&null;case"undefined":return!(!i||e&&"undefined"!==e)&&void 0;case"date":return i&&isNaN(e)?Un.parse(e):Date(Number(e))}return e}},{key:"wrapProperty",value:function(e,t,n,r){for(var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o={},a=Object.getPrototypeOf(e),s=Object.getOwnPropertyDescriptor(a,t);!s&&a&&i;)(a=Object.getPrototypeOf(a))&&(s=Object.getOwnPropertyDescriptor(a,t));s?(s.set?o.set=function(t){s.set.call(e,t),r&&r.call(e,s.get.call(e))}:o.set=r,s.get?o.get=function(){var t=s.get.call(e);return n&&(t=n.call(e,t)),t}:o.get=n):(o.set=function(n){e["_".concat(t)]=n,r&&r.call(e,n)},o.get=function(){var r=e["_".concat(t)];return n&&(r=n.call(e,r)),r}),Object.defineProperty(e,t,o)}},{key:"getPropertyDescriptor",value:function(e,t){for(var n=null,r=e;r&&!n&&!Xn.call(r,"isBase");r=Object.getPrototypeOf(r))n=Object.getOwnPropertyDescriptor(r,t);return n}},{key:"cleanupProperties",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.entries(e).forEach((function(n){var r=N()(n,2),i=r[0],o=r[1];t?void 0===o&&delete e[i]:null==o&&delete e[i]})),e}},{key:"removeAllProperties",value:function(e){return Object.keys(e).forEach((function(t){return delete e[t]})),e}},{key:"assertType",value:function(e,t,n){var r=Zn(e);if(null!=e&&r!==t)throw new Error('Incorrect type "'.concat(r,'" for ').concat(n,', expected "').concat(t,'"'))}},{key:"assertObject",value:function(e,t){er.assertType(e,"object",t)}},{key:"assertInstance",value:function(e,t){er.assertType(e,"instance",t)}},{key:"assertClass",value:function(e,t){er.assertType(e,"class",t)}},{key:"assertFunction",value:function(e,t){if("function"!=typeof e||e.isBase||e.$$name)throw new Error("Incorrect type for ".concat(t,', got "').concat(e,'" (expected a function)'))}},{key:"assertNumber",value:function(e,t){var n=Number(e);if("number"!=typeof e||isNaN(n))throw new Error("Incorrect type for ".concat(t,', got "').concat(e,'" (expected a Number)'))}},{key:"assertBoolean",value:function(e,t){er.assertType(e,"boolean",t)}},{key:"assertString",value:function(e,t){er.assertType(e,"string",t)}},{key:"assertArray",value:function(e,t){er.assertType(e,"array",t)}},{key:"toFixed",value:function(e,t){return Jn?Jn(e,t):e.toFixed(t)}},{key:"roundTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round(e/t)*t}},{key:"round",value:function(e,t){if(null==t)return e;var n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"getMapPath",value:function(e,t,n){var r=Array.isArray(t)?t:"string"==typeof t?t.split("."):[t],i=1===r.length,o=r[0],a=e.has(o)?e.get(o):e.set(o,i?n:{}).get(o);return i?a:er.getPathDefault(a,r.slice(1),n)}}]),n}(he),er=Qn;Qn._$name="ObjectHelper";var tr=["border-top-width","border-right-width","border-bottom-width","border-left-width"],nr=["margin-top","margin-right","margin-bottom","margin-left"],rr=["padding-top","padding-right","padding-bottom","padding-left"],ir="border-top-width",or="border-right-width",ar="border-bottom-width",sr="border-left-width",lr="padding-top",ur="padding-right",cr="padding-bottom",fr="padding-left",dr=Object.freeze({x:0,y:0}),hr=/^([trblc])(\d*)-([trblc])(\d*)$/i,vr=/^([trblc])(\d*)$/i,pr=["top","right","bottom","left"],gr={t:0,r:1,b:2,l:3},yr=["b-t","l-r","t-b","r-l"],mr=Object.freeze([0,0]),br=["width","height"],kr=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return Array.isArray(t)?e.apply(null,t):[t,n,r,i]};function wr(e){return"".concat(pr[(gr[e.myEdge]+2)%4][0]).concat(e.myOffset,"-").concat(pr[(gr[e.targetEdge]+2)%4][0]).concat(e.targetOffset)}var Cr=function(){function e(t,n,r,i){B()(this,e),Qn.assertNumber(t,"Rectangle.x"),Qn.assertNumber(n,"Rectangle.y"),Qn.assertNumber(r,"Rectangle.width"),Qn.assertNumber(i,"Rectangle.height");var o=this;o._x=t,o._y=n,o._width=r,o._height=i}return _()(e,[{key:"roundPx",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.devicePixelRatio||1,t=this;return t._x=mi.roundPx(t._x,e),t._y=mi.roundPx(t._y,e),t._width=mi.roundPx(t._width,e),t._height=mi.roundPx(t._height,e),t}},{key:"$$name",get:function(){return this.constructor.$$name}},{key:"clone",value:function(){var t=this,n=new e(t.x,t.y,t.width,t.height);return n.isAlignRectangle=t.isAlignRectangle,n.minHeight=t.minHeight,n.minWidth=t.minWidth,n}},{key:"contains",value:function(t){var n=this;return t instanceof e&&(t._x>=n._x&&t._y>=n._y&&t.right<=n.right&&t.bottom<=n.bottom)}},{key:"intersect",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this,o=Math.max(i.y,t.y),a=Math.min(i.right,t.right),s=Math.min(i.bottom,t.bottom),l=Math.max(i.x,t.x),u=r?s>=o&&a>=l:s>o&&a>l;return!!u&&(!!n||new e(l,o,a-l,s-o))}},{key:"equals",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n?function(e){return Math.round(e)}:function(e){return e};return t instanceof e&&r(t.x)===r(this.x)&&r(t.y)===r(this.y)&&r(t.width)===r(this.width)&&r(t.height)===r(this.height)}},{key:"translate",value:function(e,t){return this._x+=e||0,this._y+=t||0,this}},{key:"moveTo",value:function(e,t){return null!=e&&(this._x=e),null!=t&&(this._y=t),this}},{key:"getDelta",value:function(e){return[e.x-this.x,e.y-this.y]}},{key:"center",get:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2)}},{key:"x",get:function(){return this._x},set:function(e){var t=e-this._x;this._x=e,this._width-=t}},{key:"left",get:function(){return this.x},set:function(e){this.x=e}},{key:"top",get:function(){return this.y},set:function(e){this.y=e}},{key:"y",get:function(){return this._y},set:function(e){var t=e-this._y;this._y=e,this._height-=t}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"right",get:function(){return this._x+this._width},set:function(e){this._width=e-this._x}},{key:"bottom",get:function(){return this._y+this._height},set:function(e){this._height=e-this._y}},{key:"area",get:function(){return this.width*this.height}},{key:"minWidth",get:function(){return this._minWidth},set:function(e){var t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))}},{key:"minHeight",get:function(){return this._minHeight},set:function(e){var t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))}},{key:"adjust",value:function(e,t,n,r){var i=this;return i.x+=e,i.y+=t,i.width+=n,i.height+=r,i}},{key:"inflate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;return this.adjust(-r,-e,t,n)}},{key:"deflate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;return this.adjust(r,e,-t,-n)}},{key:"constrainTo",value:function(e,t){var n=this,r=n.height,i=n.y,o=n.minWidth||n.width,a=n.minHeight||n.height;if(n.height>=e.height){if(t&&a>e.height)return!1;n._y=e.y,n.height=e.height}if(n.width>=e.width){if(t&&o>e.width)return n.y=i,n.height=r,!1;n._x=e.x,n.width=e.width}var s=n.bottom-e.bottom;return s>0&&n.translate(0,-s),(s=n.right-e.right)>0&&n.translate(-s),(s=e.y-n.y)>0&&n.translate(0,s),(s=e.x-n.x)>0&&n.translate(s),n}},{key:"alignTo",value:function(t){var n,r,i,o,a=this.clone(),s=t.target,l=t.constrainTo,u=t.constrainPadding;if(!s||s instanceof e||(s=e.from(s.element?s.element:s)),l&&!(l instanceof e)){o=l===window||l===document;var c="ignorePageScroll"in t?t.ignorePageScroll:!o;l=e.from(l.element?l.element:l,null,c),u&&((u=kr(u))[0]=Math.min(u[0],s.top),u[1]=Math.min(u[1],l.right-s.right),u[2]=Math.min(u[0],l.bottom-s.bottom),u[3]=Math.min(u[0],s.left),l.deflate.apply(l,u))}var f,d=this,h=null==(f=t.offset)?mr:"number"==typeof f?[f,f]:f,v=t.align,p=t.axisLock,g=t.anchorSize,y=t.anchorPosition,m=function(e){var t=hr.exec(e),n=parseInt(t[2]||50),r=parseInt(t[4]||50);return{myAlignmentPoint:t[1]+n,myEdge:t[1],myOffset:n,targetAlignmentPoint:t[3]+r,targetEdge:t[3],targetOffset:r,startZone:gr[t[3]]}}(v),b=t.position||(s&&"Point"===s.$$name?s:null),k=l&&l.clone(),w=[],C=[{zone:r=m.startZone,align:v}],R=t.matchSize&&br[1&m.startZone],S=d[R];if(R&&p&&(a[R]=s[R]),l&&a.constrainTo(l),l&&null!=m.startZone)if(p)C.push({zone:r=(r+2)%4,align:wr(m)}),"flexible"===p&&(C.push({zone:r=(m.startZone+1)%4,align:yr[r]}),C.push({zone:r=(r+2)%4,align:yr[r]}));else for(var x=1;x<4;x++)C.push({zone:r=(r+1)%4,align:yr[r]});if(y){var E,D=1&m.startZone?"y":"x";E={},Qe()(E,D,y[D]),Qe()(E,"edge",pr[(m.startZone+2)%4]),n=E}if(k&&s&&(k.adjust(-s.width,-s.height,s.width,s.height),s.constrainTo(k)),a.minWidth=d.minWidth,a.minHeight=d.minHeight,b)a.moveTo(b.x,b.y),l&&a.constrainTo(l);else{var T="c"===m.myEdge||"c"===m.targetEdge,O=g&&!T?[g[1]+h[0],g[1]+h[1]]:h,M=s.getAlignmentPoint(m.targetAlignmentPoint,O),A=a.getAlignmentPoint(m.myAlignmentPoint);a.translate(M[0]-A[0],M[1]-A[1]);var I,P=a.intersect(s,!0);if(P)l&&a.constrainTo(l),i=m.startZone,(I=a).translate.apply(I,F()(O));else if(l&&!l.contains(a)){var L,B,j=a.clone(),_=[];n=null,w[0]=L=l.clone(),L.bottom=s.y-O[1],w[1]=L=l.clone(),L.x=s.right+O[0],w[2]=L=l.clone(),L.y=s.bottom+O[1],w[3]=L=l.clone(),L.right=s.x-O[0];for(var H=0;H<C.length;H++){if(R&&2==H&&(a[R]=S),L=w[i=C[H].zone],(a=a.alignTo({target:s,offsets:O,align:C[H].align})).constrainTo(L,!0)&&(_.push({result:a,zone:i}),!B||a.width<d.width||a.height<d.height)){a.align=C[H].align;break}if(!B||L.area>B.area){var N=a.clone();switch(i){case 0:N.moveTo(null,L.bottom-N.height);break;case 1:N.moveTo(L.left);break;case 2:N.moveTo(null,L.top);break;case 3:N.moveTo(L.right-N.width)}B={area:L.area,result:N,zone:i}}}_.length?(_.length>1&&!p&&_.sort((function(e,t){return Math.sqrt(Math.pow(j.x-e.result.x,2)+Math.pow(j.y-e.result.y,2))-Math.sqrt(Math.pow(j.x-t.result.x,2)+Math.pow(j.y-t.result.y,2))})),a=_[0].result,i=_[0].zone):(a=B.result,i=B.zone,o&&a.constrainTo(l))}else i=m.startZone;if(a.zone=i,g&&!P){if(!n){var z,V=1&i,W=V?"y":"x",$=V?"bottom":"right",U=Math.max(s[W],a[W]),G=U+(Math.min(s[$],a[$])-U)/2-g[0]/2,Y=G+g[0];Y>a[$]&&(G-=Y-a[$]),G<a[W]&&(G+=a[W]-G),z={},Qe()(z,W,G-a[W]),Qe()(z,"edge",pr[(i+2)%4]),n=z}a.anchor=n}}return a}},{key:"getAlignmentPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mr,n=this,r=vr.exec(e),i=r[1].toLowerCase(),o=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(i){case"t":return[n.x+n.width*o,n.y-t[1]];case"r":return[n.right+t[0],n.y+n.height*o];case"b":return[n.x+n.width*o,n.bottom+t[1]];case"l":return[n.x-t[0],n.y+n.height*o];case"c":var a=n.center;return[a.x+t[0],a.y+t[1]]}}},{key:"highlight",value:function(){var e=this,t=mi.createElement({parent:document.body,style:"position:absolute;z-index:9999999;pointer-events:none;\n                            left:".concat(e.x,"px;top:").concat(e.y,"px;width:").concat(e.width,"px;height:").concat(e.height,"px")});return mi.highlight(t).then((function(){return t.remove()}))}}],[{key:"from",value:function(t,n,r){var i;if(t instanceof e)return t;if(void 0===r&&"boolean"==typeof n&&(r=n,n=null),n){var o=n,a=o.scrollLeft,s=o.scrollTop;(pe.a.isEdge||pe.a.isSafari)&&n===document.body&&(a=s=0),n=e.from(n).translate(-a,-s)}else n=dr;var l,u,c=t===document||t===window,f=t===document.body&&0===document.body.offsetHeight,d=f&&t.getBoundingClientRect(),h=f?new e(d.left,d.top,d.width,document.body.parentElement.scrollHeight):c?new e(0,0,window.innerWidth,window.innerHeight):t.getBoundingClientRect(),v=r||c?[0,0]:[window.pageXOffset,window.pageYOffset],p=0,g=0;(pe.a.isIE11||pe.a.isEdge&&null!==(i=t.namespaceURI)&&void 0!==i&&i.match(/svg/))&&(p=(null===(l=t.dataset)||void 0===l?void 0:l.scaleX)||0,g=(null===(u=t.dataset)||void 0===u?void 0:u.scaleY)||0);return new e(h.left+v[0]-n.x+p/2,h.top+v[1]-n.y+g/2,h.width-p,h.height-g)}},{key:"fromScreen",value:function(t,n){return e.from(t,n,!0)}},{key:"inner",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=mi.getStyleValue(e,tr);r.x+=parseFloat(i[sr]),r.y+=parseFloat(i[ir]),r.right-=parseFloat(i[or]),r.bottom-=parseFloat(i[ar])}return r}},{key:"content",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=mi.getStyleValue(e,tr),o=mi.getStyleValue(e,rr);r.x+=parseFloat(i[sr])+parseFloat(o[fr]),r.y+=parseFloat(i[ir])+parseFloat(o[lr]),r.right-=parseFloat(i[or])+parseFloat(o[ur]),r.bottom-=parseFloat(i[ar])+parseFloat(o[cr])}return r}},{key:"client",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.content(e,t,r),o=mi.scrollBarWidth;return o&&(e.scrollHeight>e.clientHeight&&"hidden"!==mi.getStyleValue(e,"overflow-y")&&(n=parseFloat(mi.getStyleValue(e,"padding-right")),i.right+=n-Math.max(n,o)),e.scrollWidth>e.clientWidth&&"hidden"!==mi.getStyleValue(e,"overflow-x")&&(n=parseFloat(mi.getStyleValue(e,"padding-bottom")),i.bottom+=n-Math.max(n,o))),i}},{key:"outer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=mi.getStyleValue(e,nr);r.x-=parseFloat(i["margin-left"]),r.y-=parseFloat(i["margin-top"]),r.right+=parseFloat(i["margin-right"]),r.bottom+=parseFloat(i["margin-bottom"])}return r}},{key:"union",value:function(){var t,n=arguments.length<=0?void 0:arguments[0],r=n.x,i=n.y,o=n.right,a=n.bottom;if(arguments.length>1)for(var s=1;s<arguments.length;s++)(t=s<0||arguments.length<=s?void 0:arguments[s]).x<r&&(r=t.x),t.y<i&&(i=t.y),t.right>o&&(o=t.right),t.bottom>a&&(a=t.bottom);return new e(r,i,o-r,a-i)}},{key:"$$name",get:function(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}}]),e}();Cr._$name="Rectangle";var Rr=Symbol("value"),Sr=Symbol("length"),xr=function(){function e(){B()(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.process(1,n)}return _()(e,[{key:"isDomClassList",get:function(){return!0}},{key:"clone",value:function(){return new e(this)}},{key:"contains",value:function(e){return!("string"!=typeof e||!e)&&Boolean(this[e])}},{key:"toString",value:function(){return this.length?"".concat(this.value," "):""}},{key:"toJSON",value:function(){return this.toString()}},{key:"trim",value:function(){return this.value}},{key:"isEqual",value:function(t){var n=e.normalize(t,"array"),r=n.length;if(this.length===r){for(var i=0;i<r;i++)if(!this[n[i]])return!1;return!0}return!1}},{key:"value",get:function(){var e,t=this[Rr];return null==t&&(e=he.getTruthyKeys(this),this[Sr]=e.length,this[Rr]=t=e.join(" ")),t},set:function(e){for(var t=this,n=Object.keys(t),r=n.length,i=0;i<r;i++)delete t[n[i]];e?t.process(1,[e]):t[Rr]=null}},{key:"values",get:function(){return he.getTruthyKeys(this)}},{key:"length",get:function(){return this.value?this[Sr]:0}},{key:"process",value:function(t,n){for(var r,i,o=0;o<n.length;o++)if(n[o])for(r=e.normalize(n[o],"array"),i=0;i<r.length;++i)this[r[i]]=t;return this[Rr]=null,this}},{key:"assign",value:function(e){for(var t in e)!this[t]!=!e[t]&&(this[t]=e[t],this[Rr]=null);return this}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.process(1,t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.process(0,t)}},{key:"split",value:function(){return he.getTruthyKeys(this)}},{key:"forEach",value:function(e){return he.getTruthyKeys(this).forEach(e)}}],[{key:"change",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"string";r=e.normalize(r,"object");var o=e.normalize(t,"array").filter((function(e){return!r[e]}));if(n){n=e.normalize(n,"array");for(var a=0;a<n.length;++a)o.includes(n[a])||o.push(n[a])}return e.normalize(o,i)}},{key:"from",value:function(t,n){return t&&(t.isDomClassList||(t=new e(t)),t.value||n||(t=null)),t||(n?new e:null)}},{key:"normalize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string";e=e||"";var n,r,i,o,a=I()(e),s="array"===t,l="object"===t,u=!s&&!l,c="string"===a;"object"===a&&(e.nodeType===Element.ELEMENT_NODE&&"function"==typeof e.getAttribute?(e=e.getAttribute("class")||"",c=!0):null!==(o=e)&&void 0!==o&&o.isDomClassList?e=e.values:e instanceof DOMTokenList?e=Array.from(e):e instanceof Map?e=Array.from(e.keys()).filter((function(t){return e.get(t)})):e instanceof Set?e=Array.from(e.values()):Array.isArray(e)||(e=he.getTruthyKeys(e)));for(c&&(e=F()(new Set(te.split(e)))),r=e.length;r-- >0;)if((n=e[r]).length){if(n.includes(" ")){var f;(f=e).splice.apply(f,[r,1].concat(F()(te.split(n))))}}else e.splice(r,1);if(s)i=e;else if(u)i=e.join(" ");else for(i=Object.create(null),r=0;r<e.length;++r)i[e[r]]=!0;return i}}]),e}();function Er(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Or(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}xr._$name="DomClassList";var Mr,Ar,Ir,Pr,Fr,Lr,Br={align:"t0-t0"},jr=Node.ELEMENT_NODE,_r=Node.TEXT_NODE,Hr=Qn.isObject,Nr=/[+-]?\d*\.?\d+[eE]?-?\d*/g,zr=Nr.source,Vr=new RegExp("matrix\\((?:".concat(zr,"),\\s?(?:").concat(zr,"),\\s?(?:").concat(zr,"),\\s?(?:").concat(zr,"),\\s?(").concat(zr,"),\\s?(").concat(zr,")")),Wr=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),$r=new RegExp("(?:".concat(Vr.source,")|(?:").concat(Wr.source,")")),Ur=new RegExp("translate(3d|X)?\\((".concat(zr,")px(?:,\\s?(").concat(zr,")px)?")),Gr=new RegExp("translate(3d|Y)?\\((".concat(zr,")px(?:,\\s?(").concat(zr,")px)?")),Yr=/^[^a-z]+|[^\w:.-]+/gi,qr=/\s+/,Kr=/\s*;\s*/,Xr=/\s*:\s*/,Zr={elementData:"",for:"htmlFor",retainElement:""},Jr={tag:1,html:1,text:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,class:1,className:1,unmatched:1,_element:1,onlyChildren:1,listeners:1,compareHtml:1,syncOptions:1},Qr={length:1,parentRule:1,style:1},ei={width:1,height:1,top:1,left:1,minWidth:1,minHeight:1,maxWidth:1,maxHeight:1,fontSize:1,"min-width":1,"min-height":1,"max-width":1,"max-height":1,"font-size":1},ti={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,HTML:pe.a.isIE11?1:0,BODY:pe.a.isIE11?0:1},ni=window,ri=document,ii={},oi=[],ai=Array.prototype.slice,si=Promise.resolve(),li=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],ui=function(e){return e._hidden},ci=function(e,t,n){return"children"===n.key?Qn.mergeItems(e,t,n):Qn.blend(e,t,n)},fi=document.documentElement.getRootNode?function(e){return e.getRootNode()}:function(e){for(;e.parentNode;)e=e.parentNode;return e},di=function e(t){return t&&(t===document.body||("offsetParent"in t?t.offsetParent:e(t.parentNode)))},hi=function e(t){return t&&(document.body.contains(t)||(Mr=fi(t))&&function(e){return e.host&&e.host instanceof Element}(Mr)&&e(Mr.host))},vi=function(e){return e instanceof Node?e:"string"==typeof e?bi.createElementFromTemplate(e):bi.createElement(e)},pi=null,gi=0,yi=null,mi=function(){function e(){B()(this,e)}var t,n;return _()(e,null,[{key:"isFocusable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&(!bi.isVisible(e)||bi.Widget.fromElement(e,ui)))return!1;var n=e.nodeName;return ti[n]||("A"===n||"LINK"===n)&&!!e.href||null!=e.getAttribute("tabIndex")||"true"===e.contentEditable}},{key:"isInView",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Cr.from(e),r=!0,i=n.height,o=n.width;r&&e.parentElement;)e=e.parentElement,r=(n=n.intersect(Cr.from(e)))&&(!t||n.height>=i&&n.width>=o);return r}},{key:"isVisible",value:function(e){for(var t,n,r,i=e.ownerDocument;e;e=(r=e).parentNode||r.host){if(e===i)return!0;if(e.nodeType===e.ELEMENT_NODE&&(n=void 0,"none"===(n=(t=e).ownerDocument.defaultView.getComputedStyle(t)).getPropertyValue("display")||"hidden"===n.getPropertyValue("visibility")))return!1}return!1}},{key:"isDOMEvent",value:function(e){return e instanceof Event}},{key:"merge",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Qn.blend(e,n,{merge:ci})}},{key:"normalizeChildren",value:function(t,n){var r,i,o,a,s,l,u=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],c=null==t?void 0:t.children;if(!1===(null==t||null===(r=t.syncOptions)||void 0===r?void 0:r.hoistReferences)&&(u=!1),c&&!(t instanceof Node))if(Array.isArray(c))for(o=0;o<c.length;++o)e.normalizeChildren(c[o],n,u);else for(a in s=c,t.children=c=[],s){var f;null!==(f=i=s[a])&&void 0!==f&&f.isWidget&&(i=i.element),(l=!a.startsWith("$")&&!e.isElement(i))&&(null==n||n(a,u)),i&&(i instanceof Node||(!1===i.reference?delete i.reference:l&&"string"!=typeof i&&(i.reference=a),e.normalizeChildren(i,n,u)),c.push(i))}return t}},{key:"roundPx",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.devicePixelRatio||1,n=1/t;return Math.round(e/n)*n}},{key:"isCustomElement",value:function(e){return Boolean(null==e?void 0:e.shadowRoot)}},{key:"elementFromPoint",value:function(e,t){var n=document.elementFromPoint(e,t);return bi.isCustomElement(n)&&(n=n.shadowRoot.elementFromPoint(e,t)||n),n}},{key:"childFromPoint",value:function(e,t,n){var r=null==n?t:new Cr(t,n,0,0),i=null;return Array.from(e.children).some((function(t){if(Cr.from(t,e,!0).contains(r))return i=t.children.length&&bi.childFromPoint(t,r)||t,!0})),i}},{key:"activeElement",get:function(){for(var e=document.activeElement;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}},{key:"getActiveElement",value:function(e){var t,n,r;null!==(t=e)&&void 0!==t&&t.isWidget&&(e=e.element);for(var i=((null===(n=e)||void 0===n||null===(r=n.getRootNode)||void 0===r?void 0:r.call(n))||document).activeElement;null!==(o=i)&&void 0!==o&&o.shadowRoot;){var o;i=i.shadowRoot.activeElement}return i}},{key:"getRootElement",value:function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return(null==n?void 0:n.body)||n||e.ownerDocument.body}},{key:"isValidFloatRootParent",value:function(e){return e===document.body||"ShadowRoot"===e.constructor.name}},{key:"getId",value:function(e){return e.id||(e.id="b-element-"+ ++gi)}},{key:"getCommonAncestor",value:function(e,t){if(e===t)return e;for(;e&&!(null!==(n=(r=e)[e.isWidget?"owns":"contains"])&&void 0!==n&&n.call(r,t)||e===t);){var n,r;e=e.owner||e.parentNode}return e}},{key:"getElement",value:function(e){return e instanceof Element?e:ri.querySelector(e)}},{key:"setAttributes",value:function(e,t){var n=bi.getElement(e);if(n&&t)for(var r in t)null!=t[r]&&n.setAttribute(r,t[r])}},{key:"setLength",value:function(e,t,n){return n=1===arguments.length?"number"==typeof e?"".concat(e,"px"):e:(e=bi.getElement(e)).style[t]="number"==typeof n?"".concat(n,"px"):n}},{key:"getChild",value:function(e,t){if(pe.a.supportsQueryScope)t=":scope>"+t;else{var n=e.id||(e.id="b-element-"+ ++gi);t="#".concat(n," > ").concat(t)}return e.querySelector(t)}},{key:"hasChild",value:function(e,t){return null!=bi.getChild(e,t)}},{key:"children",value:function(e,t){if(">"===t[0]||t.startsWith("# "))if("#"===t[0]&&(t=t.substr(2)),pe.a.supportsQueryScope)t=":scope "+t;else{var n=e.id||(e.id="b-element-"+ ++gi);t="#".concat(n," ").concat(t)}return Array.from(e.querySelectorAll(t))}},{key:"getChildElementCount",value:function(e){return e.childElementCount}},{key:"down",value:function(e,t){if(!e)return null;if(e.matches&&e.matches(t))return e;if(pe.a.supportsQueryScope)t=":scope "+t;else{var n=e.id||(e.id="b-element-"+ ++gi);t="#".concat(n," ").concat(t)}return e.querySelector(t)}},{key:"isDescendant",value:function(e,t){e.contains||(e=e.body);var n=bi.getRootElement(e),r=bi.getRootElement(t);return n!==r&&r.host?bi.isDescendant(n,r.host):e.contains(t)}},{key:"getEventElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"target";return bi.isElement(e)?e:e[t]}},{key:"isElement",value:function(e){return(null==e?void 0:e.nodeType)===document.ELEMENT_NODE&&bi.isNode(e)}},{key:"isNode",value:function(e){return Boolean(e)&&"number"==typeof e.nodeType&&!Hr(e)}},{key:"forEachSelector",value:function(e,t,n){if("string"==typeof e)throw new Error("DomHelper.forEachSelector must provide a root element context (for shadow root scenario)");bi.children(e,t).forEach(n)}},{key:"forEachChild",value:function(e,t){Array.from(e.children).forEach(t)}},{key:"removeEachSelector",value:function(e,t){bi.forEachSelector(e,t,(function(e){return e.remove()}))}},{key:"removeClsGlobally",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){return bi.forEachSelector(e,"."+t,(function(e){return e.classList.remove(t)}))}))}},{key:"isOrphaned",value:function(e){return!hi(e)}},{key:"up",value:function(e,t){return e&&e.closest(t)}},{key:"getAncestor",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!1,o=e;for(Array.isArray(t)||(t=[t]);o=o.parentElement;){if(t.includes(o)){i=!0;break}if(r&&o===r)break;n=o}return i?n||e:null}},{key:"getParents",value:function(e){for(var t=[];e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}},{key:"makeValidId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null==e?null:String(e).replace(Yr,t)}},{key:"createElement",value:function(){var e,t,n,r,i,o,a,s,l,u,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0,d=f;if("boolean"==typeof d)f={returnAll:d,refs:s=arguments.length<=2?void 0:arguments[2],syncIdField:l=arguments.length<=3?void 0:arguments[3]};else if(f){var h;n=f.ignoreRefs,(u=null===(h=f.hoistReferences)||void 0===h||h)&&(a=f.refOwner),s=f.refs,d=f.returnAll,l=f.syncIdField}"string"==typeof c.parent&&(c.parent=document.getElementById(c.parent));var v=c.parent||c.nextSibling&&c.nextSibling.parentNode,p=c.dataset,g=c.html,y=c.reference,m=c.syncOptions,b=c.text;if(m&&(l=m.syncIdField||l,m.ignoreRefs&&(n=!0,f=Or(Or({},f),{},{ignoreRefs:n}))),n&&(a=null),e=c.ns?ri.createElementNS(c.ns,c.tag||"svg"):ri.createElement(c.tag||"div"),null!=b?bi.setInnerText(e,b):null!=g&&(g instanceof DocumentFragment?e.appendChild(g):e.innerHTML=g),c.tooltip&&bi.Widget.attachTooltip(e,c.tooltip),c.style&&bi.applyStyle(e,c.style),p)for(i in p)null!=(o=p[i])&&(e.dataset[i]=o);v&&v.insertBefore(e,c.nextSibling),a&&(e.$refOwnerId=a.id),y&&!n&&(a?(e.$reference=y,a.attachRef(y,e,c)):(s||((f=Object.assign({},f)).refs=s={}),s[y]=e,e.setAttribute("data-reference",y)));var k=c.className||c.class,w=Object.keys(c);for(k&&e.setAttribute("class",xr.normalize(k)),t=0;t<w.length;++t)i=w[t],o=c[i],null!=(r=Zr[i])?e[r||i]=o:!Jr[i]&&i&&null!=o&&e.setAttribute(i,o);return!0===d?f.returnAll=d=[e]:Array.isArray(d)&&d.push(e),c.children&&(l&&(e.syncIdMap={}),c.children.forEach((function(t){if(t)if("string"==typeof t){var n=document.createTextNode(t);a&&(n.$refOwnerId=a.id),e.appendChild(n)}else if(isNaN(t.nodeType)){var r,i,o;t.parent=e,!t.ns&&c.ns&&(t.ns=c.ns);var s=bi.createElement(t,Or(Or({},f),{},{hoistReferences:null!==(r=null===(i=c.syncOptions)||void 0===i?void 0:i.hoistReferences)&&void 0!==r?r:u})),d=null===(o=t.dataset)||void 0===o?void 0:o[l];null!=d&&(e.syncIdMap[d]=s),delete t.parent}else e.appendChild(t)}))),e.lastDomConfig=c,c._element=e,s||d||e}},{key:"createElementFromTemplate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ii,r=n.array,i=n.raw,o=n.fragment;if(bi.supportsTemplate){if((Ar||(Ar=ri.createElement("template"))).innerHTML=e,t=Ar.content,o)return t.cloneNode(!0)}else{if((Ir||(Ir=new DOMParser)).parseFromString(e,"text/html"),t=Ir.parseFromString(e,"text/html").body,o){var a=t?t.childNodes:oi;for(t=document.createDocumentFragment();a.length;)t.appendChild(a[0]);return t}t||(t={children:[],childNodes:[]})}return 1!==(t=i?t.childNodes:t.children).length||r?ai.call(t):t[0]}},{key:"insertFirst",value:function(e,t){return t&&t.nodeType!==jr&&t.tag&&(t=bi.createElement(t)),e.insertBefore(t,e.firstElementChild)}},{key:"insertBefore",value:function(e,t,n){return t&&t.nodeType!==jr&&t.tag&&(t=bi.createElement(t)),n?e.insertBefore(t,n):bi.insertFirst(e,t)}},{key:"insertAt",value:function(e,t,n){var r=Array.from(e.children);if(n>=r.length)return bi.append(e,t);var i=r[n];return bi.insertBefore(e,t,i)}},{key:"append",value:function(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map((function(e){return vi(e)}))),e.append)e.append.apply(e,F()(t));else{var n=document.createDocumentFragment();t.forEach((function(e){n.appendChild(e)})),e.appendChild(n)}return t}return e.appendChild(vi(t))}},{key:"getTranslateX",value:function(e){var t=e.style.transform,n=Ur.exec(t);return n?parseFloat(n[2]):(n=$r.exec(t)||$r.exec(bi.getStyleValue(e,"transform")))?parseFloat(n[1]||n[3]):0}},{key:"getTranslateY",value:function(e){var t=e.style.transform,n=Gr.exec(t);if(n){var r=parseFloat(n["Y"===n[1]?2:3]);return isNaN(r)?0:r}return(n=$r.exec(t)||$r.exec(bi.getStyleValue(e,"transform")))?parseFloat(n[2]||n[4]):0}},{key:"getTranslateXY",value:function(e){return[bi.getTranslateX(e),bi.getTranslateY(e)]}},{key:"getOffsetX",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}},{key:"getOffsetY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}},{key:"getOffsetXY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return[bi.getOffsetX(e,t),bi.getOffsetY(e,t)]}},{key:"focusWithoutScrolling",value:function(e){function t(e){e.forEach((function(e){var t=e.element,n=e.scrollLeft,r=e.scrollTop;t.scrollLeft!==n&&(t.scrollLeft=n),t.scrollTop!==r&&(t.scrollTop=r)}))}if(pe.a.chromeVersion>=64||pe.a.firefoxVersion>=68)e.focus({preventScroll:!0});else{var n=bi.getParents(e).map((function(e){return{element:e,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}));e.focus(),pe.a.isIE11?t(n):setTimeout((function(){return t(n)}),0)}}},{key:"getPageX",value:function(e){return e.getBoundingClientRect().left+ni.pageXOffset}},{key:"getPageY",value:function(e){return e.getBoundingClientRect().top+ni.pageYOffset}},{key:"getExtremalSizePX",value:function(e,t){var n=te.hyphenate(t),r=n.split("-")[1],i=bi.getStyleValue(e,n);return i=/%/.test(i)?e.parentElement?parseInt(bi.getStyleValue(e.parentElement,r),10):NaN:parseInt(i,10)}},{key:"setTranslateX",value:function(e,t){var n=bi.getStyleValue(e,"transform").split(/,\s*/);t=bi.roundPx(t),n.length>1?(n[n[0].startsWith("matrix3d")?12:4]=t,e.style.transform=n.join(",")):e.style.transform="translateX(".concat(t,"px)")}},{key:"setTranslateY",value:function(e,t){var n=bi.getStyleValue(e,"transform").split(/,\s*/);t=bi.roundPx(t),n.length>1?(n[n[0].startsWith("matrix3d")?13:5]=t,e.style.transform=n.join(",")+")"):e.style.transform="translateY(".concat(t,"px)")}},{key:"setTop",value:function(e,t){bi.setLength(e,"top",t)}},{key:"setLeft",value:function(e,t){bi.setLength(e,"left",t)}},{key:"setTranslateXY",value:function(e,t,n){if(null==t)return bi.setTranslateY(e,n);if(null==n)return bi.setTranslateX(e,t);t=bi.roundPx(t),n=bi.roundPx(n);var r=bi.getStyleValue(e,"transform").split(/,\s*/),i=r[0].startsWith("matrix3d");r.length>1?(r[i?12:4]=t,r[i?13:5]=n,e.style.transform=r.join(",")+")"):e.style.transform="translate(".concat(t,"px, ").concat(n,"px)")}},{key:"addTranslateX",value:function(e,t){bi.setTranslateX(e,bi.getTranslateX(e)+t)}},{key:"addTranslateY",value:function(e,t){bi.setTranslateY(e,bi.getTranslateY(e)+t)}},{key:"addLeft",value:function(e,t){bi.setLeft(e,bi.getOffsetX(e)+t)}},{key:"addTop",value:function(e,t){bi.setTop(e,bi.getOffsetY(e)+t)}},{key:"alignTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Br,r=arguments.length>3?arguments[3]:void 0;t=t instanceof Cr?t:Cr.from(t,!0);var i=bi.getTranslateXY(e),o=Cr.from(e,!0);r&&(o.roundPx(),t.roundPx());var a=o.alignTo(Object.assign(n,{target:t}));bi.setTranslateXY(e,i[0]+a.x-o.x,i[1]+a.y-o.y)}},{key:"getStyleValue",value:function(e,t,n,r){var i=n?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){var o,a={},s=Er(t);try{for(s.s();!(o=s.n()).done;){var l=o.value;a[l]=i.getPropertyValue(te.hyphenate(l))}}catch(e){s.e(e)}finally{s.f()}return a}return i.getPropertyValue(te.hyphenate(t))}},{key:"getEdgeSize",value:function(e,t,n){for(var r="border"===t?"-width":"",i={raw:{}},o=0,a=["top","right","bottom","left"];o<a.length;o++){var s=a[o];n&&!n.includes(s[0])||(i[s]=parseFloat(i.raw[s]=bi.getStyleValue(e,"".concat(t,"-").concat(s).concat(r))))}return i.width=(i.left||0)+(i.right||0),i.height=(i.top||0)+(i.bottom||0),i}},{key:"parseStyle",value:function(e){if("string"==typeof e){var t=e.split(Kr);e={};for(var n=0,r=t.length;n<r;n++){var i=t[n].split(Xr);e[i[0]]=i[1]}}return e||{}}},{key:"applyStyle",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof t)n?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else if(t)for(var r in n&&(e.style.cssText=""),t.style&&("string"==typeof t.style?e.style.cssText=t.style:t=Object.assign({},t.style,t)),t)if(!Qr[r]){var i=ei[r]&&"number"==typeof t[r]?"px":"";e.style.setProperty(te.hyphenate(r),t[r]+i)}}},{key:"getCSSText",value:function(e){if("string"==typeof e)return e;var t="";for(var n in e)Qr[n]||(t+="".concat(te.hyphenate(n),":").concat(e[n],";"));return t}},{key:"addClasses",value:function(e,t){for(var n=0;n<t.length;n++)e.classList.add(t[n])}},{key:"removeClasses",value:function(e,t){for(var n=0;n<t.length;n++)e.classList.remove(t[n])}},{key:"toggleClasses",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)||(t=[t]),!0===n?bi.addClasses(e,t):!1===n?bi.removeClasses(e,t):t.forEach((function(t){return e.classList.toggle(t)}))}},{key:"addTemporaryClass",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;n>0&&(e.classList.add(t),r.setTimeout((function(){return e.classList.remove(t)}),n))}},{key:"getPropertyTransitionDuration",value:function(e,t){var n,r=window.getComputedStyle(e),i=r.transitionProperty.split(", "),o=r.transitionDuration.split(", "),a=i.indexOf(t);return-1!==a&&(n=1e3*parseFloat(o[a])),n}},{key:"getAnimationDuration",value:function(e){return 1e3*parseFloat(bi.getStyleValue(e,"animation-duration"))}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e instanceof Cr?e.highlight():new Promise((function(n){t.setTimeout((function(){e.classList.add("b-fx-highlight"),t.setTimeout((function(){e.classList.remove("b-fx-highlight"),n()}),1e3)}),0)}))}},{key:"scrollBarWidth",get:function(){if(null===pi&&ri.body){var e=bi.createElement({parent:ri.body,style:"position:absolute;top:-999px;width:100px;height:100px;overflow:scroll"});pi=e.offsetWidth-e.clientWidth,e.remove()}return pi}},{key:"scrollBarPadElement",get:function(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}},{key:"resetScrollBarWidth",value:function(){pi=null}},{key:"measureText",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=bi.getMeasureElement(t,r);i[n?"innerHTML":"innerText"]=e;var o=i.clientWidth;return i.className="",o}},{key:"measureSize",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return 0;if("number"==typeof e)return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){var r=bi.getMeasureElement(t);r.innerHTML="",r.style.width=bi.setLength(e);var i=n?r.offsetWidth:r.getBoundingClientRect().width;return r.style.width=r.className="",i}return/^\d+em$/.test(e)?14*parseInt(e):isNaN(e)?0:parseInt(e)}},{key:"getMeasureElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ri.body,n=ni.getComputedStyle(e),r=t.offScreenDiv=t.offScreenDiv||bi.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},!0)[1];return li.forEach((function(e){r.style[e]!==n[e]&&(r.style[e]=n[e])})),r.className=e.className,r.parentElement.parentElement!==t&&t.appendChild(r.parentElement),r}},{key:"stripTags",value:function(e){return(bi.$domParser||(bi.$domParser=new DOMParser)).parseFromString(e,"text/html").body.textContent}},{key:"sync",value:function(e,t){if("string"==typeof e){if(""===e)return void(t.innerHTML="");e=bi.createElementFromTemplate(e)}return bi.performSync(e,t),t}},{key:"performSync",value:function(e,t){return e.outerHTML!==t.outerHTML&&(bi.syncAttributes(e,t),bi.syncContent(e,t),bi.syncChildren(e,t),!0)}},{key:"getSyncAttributes",value:function(e){for(var t={},n=[],r=0;r<e.attributes.length;r++){var i=e.attributes[r];if(i.specified){var o=i.name.toLowerCase();t[o]=i.value,n.push(o)}}return{attributes:t,names:n}}},{key:"syncAttributes",value:function(e,t){var n=bi.getSyncAttributes(e),r=n.attributes,i=n.names,o=bi.getSyncAttributes(t),a=o.attributes,s=o.names,l=i.includes("dataset"),u=i.filter((function(e){return!s.includes(e)})),c=s.filter((function(e){return!(i.includes(e)||l&&e.startsWith("data-"))})),f=i.filter((function(e){return s.includes(e)}));if(u.length>0)for(var d=0;d<u.length;d++){var h=u[d];"style"===h?bi.applyStyle(t,r.style,!0):"dataset"===h?Object.assign(t.dataset,r.dataset):t.setAttribute(h,r[h])}if(c.length>0)for(var v=0;v<c.length;v++)t.removeAttribute(c[v]);if(f.length>0)for(var p=0;p<f.length;p++){var g=f[p];if("style"===g)bi.applyStyle(t,r.style,!0);else if("dataset"===g)Object.assign(t.dataset,r.dataset);else if("class"!==g||!r.class.isDomClassList&&"object"!==I()(r.class))a[g]!==r[g]&&t.setAttribute(g,r[g]);else{var y=void 0;(y=r.class.isDomClassList?r.class:new xr(r.class)).isEqual(a.class)||t.setAttribute("class",y)}}}},{key:"syncContent",value:function(e,t){0===bi.getChildElementCount(e)&&(t.innerText=e.innerText)}},{key:"setInnerText",value:function(e,t){var n=e.firstChild;n?n.data=t:e.textContent=t}},{key:"syncChildren",value:function(e,t){for(var n=ai.call(e.childNodes),r=ai.call(t.childNodes);n.length;){var i=n.shift(),o=r.shift();if(i&&i.nodeType!==_r&&i.nodeType!==jr)throw new Error("Source node type ".concat(i.nodeType," not supported by DomHelper.sync()"));if(o&&o.nodeType!==_r&&o.nodeType!==jr)throw new Error("Target node type ".concat(o.nodeType," not supported by DomHelper.sync()"));if(o)if(i.nodeType===o.nodeType)i.nodeType===_r?o.data=i.data:i.tagName===o.tagName?this.performSync(i,o):(t.insertBefore(i,o),o.remove());else{if(i.nodeType!==_r||o.nodeType!==jr){var a=i.parentElement||i;throw new Error("Currently no support for transforming nodeType.\n".concat(a.outerHTML))}t.innerText=i.data.trim()}else t.appendChild(i)}r.forEach((function(e){e.remove()}))}},{key:"syncClassList",value:function(e,t){var n,r=e.classList,i="string"==typeof t,o=i?t.trim().split(qr):Array.isArray(t)?t:Qn.getTruthyKeys(t),a=o.length,s=r.length!==a;for(n=0;!s&&n<a;n++)s=!r.contains(o[n]);s&&(e.className=i?t:o.join(" "))}},{key:"setTheme",value:function(e){e=e.toLowerCase();var t=bi.themeInfo.name.toLowerCase(),n=document.head.querySelector("#bryntum-theme:not([data-loading])")||document.head.querySelector('[href*="'.concat(t,'.css"]:not([data-loading])'));if(bi.removeEachSelector(document.head,"#bryntum-theme[data-loading]"),null==n||!n.href.includes("".concat(t,".css")))throw new Error("Theme link for ".concat(t," not found"));return n.href.includes("".concat(e,".css"))?si:new Promise((function(t,r){var i=document.createElement("link"),o=n.nextSibling,a=bi.themeInfo.name.toLowerCase(),s={theme:e,prev:a};i.rel="stylesheet",i.id="bryntum-theme",i.addEventListener("load",(function(){delete i.dataset.loading,yi=null,n.remove(),Fi.trigger("theme",s),t(s)})),i.addEventListener("error",(function(e){delete i.dataset.loading,r(e)})),i.dataset.loading="true",i.href=n.href.replace(a,e),o.parentNode.insertBefore(i,o)}))}},{key:"themeInfo",get:function(){if(!yi){var e=bi.createElement({parent:document.body,className:"b-theme-info"}),t=bi.getStyleValue(e,"content",!1,":before");if(t)try{yi=JSON.parse(t.replace(/^["']|["']$|\\/g,""))}catch(e){yi=null}e.remove()}return yi}},{key:"transition",value:(n=Pt()(At.a.mark((function t(n){var r,i,o,a,s,l,u,c,f,d,h,v,p,g,y,m,b,k,w,C,R,S,x,E,D,T,O,M,A,I,P,F,L,B,j,_,H,z,V,W,$,U,G,Y,q,K,X,Z,J,Q,ee,te,ne;return At.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.element,i=n.selector,o=void 0===i?"[data-dom-transition]":i,a=n.duration,s=n.action,l=n.thisObj,u=void 0===l?this:l,c=n.addTransition,f=void 0===c?{}:c,d=n.removeTransition,h=void 0===d?{}:d,v=Array.from(r.querySelectorAll(o)),p=new Map(v.map((function(e){for(var t=0,n=e.parentElement;n&&n!==r;)t++,n=n.parentElement;e.$depth=t;var i=e.parentElement,o=Cr.from(e,r),a=Cr.from(e,i),s=window.getComputedStyle(i),l=parseFloat(s.borderLeftWidth);return l&&(o.left-=l,a.left-=l),[e.id,{element:e,globalBounds:o,localBounds:a,depth:t,parentElement:i}]}))),s.call(u),g=Array.from(r.querySelectorAll(o)),y=new Map(g.map((function(e){var t=Cr.from(e,r),n=Cr.from(e,e.parentElement),i=window.getComputedStyle(e.parentElement),o=parseFloat(i.borderLeftWidth);return o&&(t.left-=o,n.left-=o),[e.id,{element:e,globalBounds:t,localBounds:n}]}))),m=["position","top","left","width","height","padding","margin","zIndex","minWidth","minHeight","opacity","overflow"],b=Er(p);try{for(b.s();!(k=b.n()).done;)w=N()(k.value,2),C=w[0],R=w[1],(S=y.get(C))?(x=S.element,E=x.style,D=x.parentElement,T=parseInt(e.getStyleValue(x,"zIndex")),O=R.globalBounds,M=R.localBounds,A=R.depth,I=R.parentElement,P=I!==D,Qn.copyProperties(x.$initial={parentElement:D},E,m),F=void 0,P?(S.bounds=S.globalBounds,F=O,r.appendChild(x)):(S.bounds=S.localBounds,F=M,I.appendChild(x)),Object.assign(E,{position:"absolute",top:"".concat(F.top,"px"),left:"".concat(F.left,"px"),width:"".concat(F.width,"px"),height:"".concat(F.height,"px"),minWidth:0,minHeight:0,padding:0,margin:0,zIndex:A+(T||0),overflow:"hidden"}),S.processed=!0):(L=R.element,B=R.localBounds,j=R.depth,_=R.parentElement,L.$initial={removed:!0},Object.assign(L.style,{position:"absolute",top:"".concat(B.top,"px"),left:"".concat(B.left,"px"),width:"".concat(B.width,"px"),height:"".concat(B.height,"px"),minWidth:0,minHeight:0,padding:0,margin:0,zIndex:j,overflow:"hidden"}),_.appendChild(L),y.set(C,{element:L,bounds:B,removed:!0,processed:!0}),g.push(L))}catch(e){b.e(e)}finally{b.f()}H=Er(y);try{for(H.s();!(z=H.n()).done;)V=N()(z.value,2),(W=V[1]).processed||($=W.element,U=$.style,G=$.parentElement,Y=W.bounds=W.localBounds,$.classList.add("b-dom-transition-adding"),Qn.copyProperties($.$initial={parentElement:G},U,m),Object.assign(U,{position:"absolute",top:f.top?0:"".concat(Y.top,"px"),left:f.left?0:"".concat(Y.left,"px"),width:f.width?0:"".concat(Y.width,"px"),height:f.height?0:"".concat(Y.height,"px"),opacity:f.opacity?0:null,zIndex:G.$depth+1,overflow:"hidden"}))}catch(e){H.e(e)}finally{H.f()}r.classList.add("b-dom-transition"),r.firstElementChild.offsetWidth,q=Er(y);try{for(q.s();!(K=q.n()).done;)X=N()(K.value,2),Z=X[1],J=Z.element,Q=Z.bounds,Z.removed?Object.assign(J.style,{top:h.top?0:"".concat(Q.top,"px"),left:h.left?0:"".concat(Q.left,"px"),width:h.width?0:"".concat(Q.width,"px"),height:h.height?0:"".concat(Q.height,"px"),opacity:h.opacity?0:J.$initial.opacity}):Object.assign(J.style,{top:"".concat(Q.top,"px"),left:"".concat(Q.left,"px"),width:"".concat(Q.width,"px"),height:"".concat(Q.height,"px"),opacity:J.$initial.opacity})}catch(e){q.e(e)}finally{q.f()}return t.next=14,Ft.sleep(a);case 14:for(r.classList.remove("b-dom-transition"),ee=0,te=g;ee<te.length;ee++)(ne=te[ee]).$initial&&(ne.$initial.removed?ne.remove():(Qn.copyProperties(ne.style,ne.$initial,m),ne.classList.remove("b-dom-transition-adding"),ne.$initial.parentElement.appendChild(ne)));case 16:case"end":return t.stop()}}),t,this)}))),function(e){return n.apply(this,arguments)})},{key:"loadScript",value:(t=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=document.createElement("script");r.src=t,r.onload=e,r.onerror=n,document.head.appendChild(r)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"isNamedColor",value:function(e){return e&&!/^(#|hsl|rgb)/.test(e)}}]),e}(),bi=mi,ki=function(){return bi.isTouchEvent=!1},wi=function(){bi.isTouchEvent=!0,clearTimeout(Pr),Pr=setTimeout(ki,400)};if(ri.addEventListener("touchstart",wi,!0),ri.addEventListener("touchend",wi,!0),bi.supportsTemplate="content"in ri.createElement("template"),bi.elementPropKey="$bryntum",bi.numberRe=Nr,!("children"in Node.prototype)){var Ci=function(e){return e.nodeType===e.ELEMENT_NODE};Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,Ci)}})}(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),ni.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(e){var t=this;if(!ri.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&t.nodeType===t.ELEMENT_NODE);return null}:Node.prototype.closest=function(e){var t;return null===(t=this.parentNode)||void 0===t?void 0:t.closest(e)},[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),SVGElement.prototype.contains||(SVGElement.prototype.contains=function(e){do{if(this===e)return!0;e=e.parentNode}while(e);return!1}),"function"!=typeof ni.CustomEvent)&&(ni.CustomEvent=Lr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};return(Fr=ri.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),Fr},Lr.prototype=ni.Event.prototype,ni.MouseEvent=Lr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};return(Fr=ri.createEvent("MouseEvents")).initMouseEvent(e,t.bubbles,t.cancelable,ri.defaultView||ni,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,document),Fr},Lr.prototype=ni.Event.prototype,ni.KeyboardEvent=Lr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0},n="".concat(t.shiftKey?"Shift ":"").concat(t.ctrlKey?"Control":"");return(Fr=ri.createEvent("KeyboardEvent")).initKeyboardEvent(e,t.bubbles,t.cancelable,ri.defaultView||ni,t.key,t.location,n,!1,""),Fr},Lr.prototype=ni.Event.prototype);if(!Object.getOwnPropertyDescriptor(SVGElement.prototype,"dataset")||!Object.getOwnPropertyDescriptor(SVGElement.prototype,"dataset").get){var Ri={enumerable:!0,get:function(){var e,t,n,r,i,o={},a=this.attributes,s=a.length,l=function(e){return e.charAt(1).toUpperCase()},u=function(){return this},c=function(e,t){return void 0!==t?this.setAttribute(e,t):this.removeAttribute(e)};for(e=0;e<s;e++)(i=a[e])&&i.name&&/^data-\w[\w-]*$/.test(i.name)&&(t=i.value,r=(n=i.name).substr(5).replace(/-./g,l),Object.defineProperty(o,r,{enumerable:this.enumerable,get:u.bind(t||""),set:c.bind(this,n)}));return o}};Object.defineProperty(SVGElement.prototype,"dataset",Ri)}var Si=DOMTokenList.prototype.add,xi=DOMTokenList.prototype.remove;function Ei(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}DOMTokenList.prototype.add=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return Si.call(t,e)})):Si.call.apply(Si,[this].concat(Array.prototype.slice.call(arguments)))},DOMTokenList.prototype.remove=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return xi.call(t,e)})):xi.call.apply(xi,[this].concat(Array.prototype.slice.call(arguments)))},window.addEventListener("resize",(function(){return pi=null})),mi._$name="DomHelper";var Di=new(function(e){Ye()(n,e);var t=Ei(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"suspendFocusEvents",value:function(){Ii=!0}},{key:"resumeFocusEvents",value:function(){Ii=!1}},{key:"setupFocusListenersOnce",value:function(e,t){e&&!Di.observedElements.has(e)&&(Di.setupFocusListeners(e,t),Di.observedElements.add(e))}},{key:"setupFocusListeners",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i={element:t,touchstart:function(e){Oi=Oi||1!==e.changedTouches.length?null:e.changedTouches[0]},touchend:{handler:function(e){Oi&&(Oi.identifier===n.contextMenuTouchId?(e.stopImmediatePropagation(),e.preventDefault()):1===e.changedTouches.length&&e.changedTouches[0].identifier===Oi.identifier&&Di.trigger("globaltap",{event:e}),Oi=null)},passive:!1},mousedown:{handler:function(e){Mi="mouse",Oi||Di.trigger("globaltap",{event:e})},passive:!1},keydown:function(){Mi="key"},keypress:function(){Mi="key"},focusin:function(e){var t=Di.Widget;if(t.resetFloatRootScroll(),!Ii){var n=e.relatedTarget?e.relatedTarget instanceof HTMLElement?e.relatedTarget:document.body:null,r=e.target||document.body,i=t.fromElement(n),o=t.fromElement(r),a=mi.getCommonAncestor(i,o),s=!!(n&&4&r.compareDocumentPosition(n)),l=t.query(Ti),u=null;if(u=r&&r!==document.body?mi.getActiveElement(r):mi.getActiveElement(document),!l||o&&l.owns(o)){for(var c=Pi("focusout",n,e.target,i,o,s),f=i;f&&f!==a;f=f.owner)if(!f.isDestroying&&f.onFocusOut&&(f.onFocusOut(c),e.target&&u!==mi.getActiveElement(e.target)))return;if(a&&e.target===a.element)!a.isDestroying&&mi.getActiveElement(a)===r&&a.focusElement&&a.focusElement!==a.element&&a.setTimeout((function(){var e;return null===(e=a.focus)||void 0===e?void 0:e.call(a)}),0);else{c=Pi("focusin",r,n,i,o,s);for(var d=o;d&&d!==a;d=d.owner){var h,v;if(!d.isDestroying)null===(h=(v=d).onFocusIn)||void 0===h||h.call(v,c)}}var p=mi.getCommonAncestor((null==n?void 0:n.nodeType)===Element.ELEMENT_NODE?n:null,r)||r.parentNode;c=Pi("focusmove",r,n,i,o,s,{bubbles:!0}),p.dispatchEvent(c)}else l.focus()}},focusout:function(e){if(!(Ii||e.relatedTarget&&Di.Widget.fromElement(e.relatedTarget))){var t=e.relatedTarget&&e.relatedTarget instanceof HTMLElement?e.relatedTarget:null;i.focusin({target:t,relatedTarget:e.target})}},capture:!0,passive:!0};r&&(null===(e=Ai)||void 0===e||e()),Ai=n.on(i)}},{key:"lastInteractionType",get:function(){return Mi}}]),n}($e.mixin(Ot))),Ti=function(e){return e.isVisible&&e.isTopModal};Di.observedElements=new Set;var Oi,Mi,Ai,Ii=!1;function Pi(e,t,n,r,i,o,a){var s=new CustomEvent(e,a);return Object.defineProperty(s,"_target",{get:function(){return t}}),Object.defineProperty(s,"relatedTarget",{get:function(){return n}}),s.fromWidget=r,s.toWidget=i,s.backwards=o,s}var Fi=Di;n(140),n(183);function Li(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Bi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ji(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var _i=function(e){Ye()(n,e);var t=ji(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"client",get:function(){return this._client},set:function(e){this._client=e}},{key:"getFocusRevertTarget",value:function(){var e;return null===(e=this.client)||void 0===e?void 0:e.getFocusRevertTarget()}},{key:"construct",value:function(){for(var e=this,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o,a=r[0],s=r[1];1===r.length?Qn.isObject(a)&&(a=(s=a).client):delete(s=Qn.assign({},s)).client,e.client=a,tt()(Ze()(n.prototype),"construct",this).call(this,s),e.applyPluginConfig(a),(o=e.clientListeners)&&((o=Qn.assign({},o)).thisObj=e,a.on(o))}},{key:"applyPluginConfig",value:function(e){var t=this,n=t.pluginConfig||t.constructor.pluginConfig;if(n){var r=n.assign,i=n.chain,o=n.after,a=n.before,s=n.override;r&&t.applyAssign(e,r),(i||o)&&t.applyChain(e,i||o),a&&t.applyChain(e,a,!1),s&&t.applyOverride(e,s)}}},{key:"applyAssign",value:function(e,t){var n=this;t.forEach((function(t){return n.assign(e,t)}))}},{key:"applyChain",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(Array.isArray(t)){var r,i=Li(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.chain(e,o,o,n)}}catch(e){i.e(e)}finally{i.f()}}else for(var a in t)this.chain(e,a,t[a],n)}},{key:"applyOverride",value:function(e,t){var n=this;n.overridden||(n.overridden={}),t.forEach((function(t){if(!n[t])throw new Error("Trying to chain fn ".concat(e.$$name,"#").concat(t,", but plugin fn ").concat(n.$$name,"#").concat(t," does not exist"));"function"==typeof e[t]&&(n.overridden[t]=e[t].bind(e)),e[t]=n[t].bind(n)}))}},{key:"assign",value:function(e,t){var n=this,r=function(e,t){var n=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),t);return n&&(n.get||n.set)?n:null}(n,t);r?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(n),set:r.set&&r.set.bind(n)}):e[t]=n[t].bind(n)}},{key:"chain",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this,o=e.pluginFunctionChain||(e.pluginFunctionChain={}),a=i[n]&&i[n].bind(i),s=i.functionChainRunner;if(!a)throw new Error("Trying to chain fn ".concat(e.$$name,"#").concat(n,", but plugin fn ").concat(i.$$name,"#").concat(n," does not exist"));if(!o[t]){var l=e[t];l&&((l=l.bind(e)).$this=e),o[t]=l?[l]:[],e[t]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return s(o[t],n)}}a.$this=i,o[t][r?"push":"unshift"](a)}},{key:"functionChainRunner",value:function(e,t){var n,r,i;for(r=0;r<e.length&&((n=e[r]).$this.isDestroyed||!1!==(i=n.apply(void 0,F()(t))));r++);return i}},{key:"doDisable",value:function(e){var t,n,r=this,i=r.constructor,o="featureClass"in i?i.featureClass:"b-".concat(i.$$name.toLowerCase());o&&(null===(t=r.client)||void 0===t||null===(n=t.element)||void 0===n||n.classList[e?"remove":"add"](o));r.isConfiguring||(e?r.trigger("disable"):r.trigger("enable"))}},{key:"updateDisabled",value:function(e){this.doDisable(e)}},{key:"throwOverrideIsMissing",value:function(e){throw new Error("Trying to override fn ".concat(e.plugIntoName,"#").concat(e.fnName,", but plugin fn ").concat(e.pluginName,"#").concat(e.fnName," does not exist"))}},{key:"rootElement",get:function(){return this.client.rootElement}}],[{key:"configurable",get:function(){return{clientListeners:null,disabled:!1}}},{key:"initPlugins",value:function(e){for(var t=e.plugins||(e.plugins={}),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];t[s.$$name]=new s(e)}}}]),n}($e.mixin(Ot,en));function Hi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}_i._$name="InstancePlugin";var Ni=function(e){return function(e){Ye()(n,e);var t=Hi(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"plugins",get:function(){return this._plugins||(this._plugins={}),this._plugins},set:function(e){e&&(Array.isArray(e)||(e=[e]),_i.initPlugins.apply(_i,[this].concat(F()(e)))),this.initPlugins()}},{key:"initPlugins",value:function(){}},{key:"addPlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];_i.initPlugins.apply(_i,[this].concat(t))}},{key:"hasPlugin",value:function(e){return null!=this.getPlugin(e)}},{key:"getPlugin",value:function(e){return"function"==typeof e&&(e=e.$$name),this.plugins&&this.plugins[e]}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"Pluggable"}}]),n}(e||$e)};function zi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Vi=function(e){return function(e){Ye()(n,e);var t=zi(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"state",get:function(){return this._state=this.getState(),this._state},set:function(e){this._state=e,this.applyState(e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"State"}}]),n}(e||$e)};function Wi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var $i=Qn.getPathDefault(pe.a.global,"bryntum.idCounts",Object.create(null)),Ui={string:1,number:1},Gi=function(e){return function(e){Ye()(n,e);var t=Wi(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"doDestroy",value:function(){this.constructor.unregisterInstance(this),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"changeId",value:function(e){return(this.hasGeneratedId=!e)?this.generateAutoId():e}},{key:"updateId",value:function(e,t){var n=this,r=n.constructor;t&&r.unregisterInstance(n,t),n.hasGeneratedId&&!1===r.identifiable.registerGeneratedId||r.registerInstance(n,e)}},{key:"generateAutoId",value:function(){return this.constructor.generateId("b-".concat(this.$$name.toLowerCase(),"-"))}}],[{key:"$name",get:function(){return"Identifiable"}},{key:"declarable",get:function(){return["identifiable"]}},{key:"configurable",get:function(){return{id:""}}},{key:"setupIdentifiable",value:function(e,t){var n=e.identifiable;n.idMap=Object.create(null),Reflect.defineProperty(e,"identifiable",{get:function(){return n}})}},{key:"all",get:function(){return Object.values(this.identifiable.idMap)}},{key:"generateId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generatedId";return e+($i[e]=($i[e]||0)+1)}},{key:"registerInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.id,n=this.identifiable.idMap;if(t in n&&!this.disableThrow)throw new Error("Id "+t+" already in use");n[t]=e}},{key:"unregisterInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.id,n=this.identifiable.idMap;Ui[I()(e)]?delete n[e]:n[t]===e&&delete n[t]}},{key:"getById",value:function(e){var t=this.identifiable.idMap;if(t)return t[e]}},{key:"registeredInstances",get:function(){var e=this.identifiable.idMap;return e?Object.values(e):[]}}]),n}(e||$e)};n(210),n(211);function Yi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var qi=Symbol("STM_PROP"),Ki={parentIndex:1},Xi=function(e){return function(e){Ye()(n,e);var t=Yi(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"joinStore",value:function(e){this.stm||(this.stm=e.stm)}},{key:"unjoinStore",value:function(e){this.stm===e.stm&&(this.stm=null),tt()(Ze()(n.prototype),"unjoinStore",this)&&tt()(Ze()(n.prototype),"unjoinStore",this).call(this,e)}},{key:"stm",get:function(){return this[qi]},set:function(e){this[qi]=e}},{key:"beforeSet",value:function(e,t,r,i){var o=this,a=this.stm;if(a&&!a.disabled&&!Ki[e]&&!this.constructor.nonPersistableFields[e]){var s,l,u,c=(null===(s=tt()(Ze()(n.prototype),"beforeSet",this))||void 0===s?void 0:s.call(this,e,t,r,i))||[];if("object"==I()(e)){var f=Object.keys(e).reduce((function(t,n){return t[0][n]=e[n],t[1][n]=o.get(n),t}),[{},{}]),d=N()(f,2);l=d[0],u=d[1]}else l=Qe()({},e,t),u=Qe()({},e,this.get(e));return c.push([l,u]),c}return[]}},{key:"afterSet",value:function(e,t,n,r,i,o){var a=this.stm,s=this.constructor.nonPersistableFields;if(a&&!a.disabled&&!Ki[e]&&!s[e]){var l=i.pop();if(o){var u,c=N()(l,2),f=c[0],d=c[1],h=Object.keys(o).reduce((function(e,t){return s[t]||(u=!0),e[0][t]=f[t],e[1][t]=d[t],e}),[{},{}]),v=N()(h,2),p=v[0],g=v[1];u&&a.onModelUpdate(this,p,g)}}}},{key:"beforeInsertChild",value:function(e){var t=this,r=tt()(Ze()(n.prototype),"beforeInsertChild",this)?tt()(Ze()(n.prototype),"beforeInsertChild",this).call(this,e):[],i=this.stm;return i&&!i.disabled&&r.push(e.reduce((function(e,n){return n.root===t.root&&e.set(n,{parent:n.parent,index:n.parent?n.parentIndex:void 0}),e}),new Map)),r}},{key:"afterInsertChild",value:function(e,t,r,i){var o=this.stm;if(o&&!o.disabled){var a=r.pop();i&&o.onModelInsertChild(this,e,i,a)}tt()(Ze()(n.prototype),"afterInsertChild",this)&&tt()(Ze()(n.prototype),"afterInsertChild",this).call(this,e,t,r,i)}},{key:"beforeRemoveChild",value:function(e,t){var r=tt()(Ze()(n.prototype),"beforeRemoveChild",this)?tt()(Ze()(n.prototype),"beforeRemoveChild",this).call(this,e,t):[],i=this.stm;return!i||i.disabled||t||r.push(e.reduce((function(e,t){return e.set(t,t.parentIndex),e}),new Map)),r}},{key:"afterRemoveChild",value:function(e,t,r){var i=this.stm;if(i&&!i.disabled&&!r){var o=t.pop();e&&e.length&&i.onModelRemoveChild(this,e,o)}tt()(Ze()(n.prototype),"afterRemoveChild",this)&&tt()(Ze()(n.prototype),"afterRemoveChild",this).call(this,e,t,r)}}],[{key:"$name",get:function(){return"ModelStm"}},{key:"defaultConfig",get:function(){return{stm:null}}}]),n}(e||$e)};function Zi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ji(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ji(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ji(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var eo=function(e){return function(e){Ye()(n,e);var t=Qi(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"ingestChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stores,n=this.inProcessChildren,r=this.constructor,i=t[0];if(!0===e)return!!n||[];if(e){Array.isArray(e)||(e=[e]);for(var o,a=e.length,s=[],l=0;l<a;l++)o=(o=e[l]).isModel?o:i?i.createRecord(o):new r(o,null,null,!0),o=i?i.processRecord(o):o,s.push(o);if(!0===this.children&&i){var u=i.createSorterFn(i.sorters);s.sort(u)}return s}}},{key:"processChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stores,t=this,n=t.meta;t.inProcessChildren=!0;var r=t.ingestChildren(t.data[t.constructor.childrenField],e);r&&(r.length?(n.isLeaf=!1,!0===t.children&&(t.children=[]),t.appendChild(r,!1,!0)):!0===r?(n.isLeaf=!1,t.children=!0):t.isRoot||(n.isLeaf=t.constructor.convertEmptyParentToLeaf.onLoad)),t.inProcessChildren=!1}},{key:"ancestorsExpanded",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.firstStore,t=this.parent;return!t||t.isExpanded(e)&&t.ancestorsExpanded(e)}},{key:"isExpanded",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.firstStore,t=this.instanceMeta(e.id);return Object.prototype.hasOwnProperty.call(t,"collapsed")||(t.collapsed=!this.expanded),!t.collapsed}},{key:"expanded",get:function(){return this.data.expanded}},{key:"childLevel",get:function(){for(var e=this,t=-1;e&&!e.isRoot;)++t,e=e.parent;return t}},{key:"isLeaf",get:function(){return!1!==this.meta.isLeaf&&!this.isRoot}},{key:"isParent",get:function(){return!this.isLeaf}},{key:"isLoaded",get:function(){return this.isParent&&Array.isArray(this.children)}},{key:"descendantCount",get:function(){return this.getDescendantCount()}},{key:"visibleDescendantCount",get:function(){return this.getDescendantCount(!0)}},{key:"getDescendantCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.firstStore,n=this.children;return!n||!Array.isArray(n)||e&&!this.isExpanded(t)?0:n.reduce((function(t,n){return t+n.getDescendantCount(e)}),n.length)}},{key:"allChildren",get:function(){var e=this.children;return e?e.reduce((function(e,t){return e.push(t),e.push.apply(e,t.allChildren),e}),[]):[]}},{key:"firstChild",get:function(){var e=this.children;return e&&e.length&&e[0]||null}},{key:"lastChild",get:function(){var e=this.children;return e&&e.length&&e[e.length-1]||null}},{key:"previousSiblingsTotalCount",get:function(){for(var e=this.previousSibling,t=this.parentIndex;e;)t+=e.descendantCount,e=e.previousSibling;return t}},{key:"root",get:function(){return this.parent&&this.parent.root||this}},{key:"parentId",get:function(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null},set:function(e){var t=this,n=t.parent,r=e&&t.firstStore.getById(e);r!==n&&(n||r)&&(t.isBatchUpdating?t.meta.batchChanges.parentId=e:r?r.appendChild(t):t.parent.removeChild(t))}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(n?this.unfilteredChildren:this.children)||this.children;t||e.call(this,this);for(var i=0,o=r&&r.length;i<o;i++)r[i].traverse(e,!1,n)}},{key:"traverseBefore",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(n?this.unfilteredChildren:this.children)||this.children,i=0,o=r&&r.length;i<o;i++)r[i].traverse(e,!1,n);t||e.call(this,this)}},{key:"traverseWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=!0;if(t||(i=!1!==e.call(r,r)),i&&r.isLoaded){var o=(n?r.unfilteredChildren:r.children)||this.children;i=o.every((function(t){return t.traverseWhile(e,!1,n)}))}return i}},{key:"bubble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;for(t||e.call(n,n);n.parent;)n=n.parent,e.call(n,n)}},{key:"bubbleWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=!0;for(t||(r=e.call(n,n));r&&n.parent;)n=n.parent,r=e.call(n,n);return r}},{key:"contains",value:function(e){return e&&"object"===I()(e)&&(e=e.id),!this.traverseWhile((function(t){return t.id!=e}))}},{key:"getTopParent",value:function(e){var t;return e?(t=[],this.bubbleWhile((function(e){return t.push(e),e.parent&&!e.parent.isRoot}))):(t=null,this.bubbleWhile((function(e){return e.parent||(t=e),e.parent&&!e.parent.isRoot}))),t}},{key:"appendChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.insertChild(e,null,t)}},{key:"insertChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof e){var r=e;e=t,t=this.children[r]}var i=this,o=i.isLeaf,a=Array.isArray(e);if(Array.isArray(e)||(e=[e]),!n&&!i.stores.every((function(t){return!1!==t.trigger("beforeAdd",{records:e,parent:i})})))return null;e=i.ingestChildren(e);var s=t?t.parentIndex:i.children?i.children.length:0,l=i.beforeInsertChild?i.beforeInsertChild(e):void 0,u=i.internalAppendInsert(e,t,n);return o&&u.length&&(i.meta.isLeaf=!1),i.isLeaf===o||i.root.isLoading||n||i.stores.forEach((function(e){var t={isLeaf:{value:!1,oldValue:!0}};e.trigger("update",{record:i,changes:t}),e.trigger("change",{action:"update",record:i,changes:t})})),i.afterInsertChild&&i.afterInsertChild(s,e,l,u),a||!u?u:u[0]}},{key:"tryInsertChild",value:function(){return this.insertChild.apply(this,arguments)}},{key:"internalAppendInsert",value:function(e,t,n){var r,i,o,a,s=this,l=s.stores,u=s.root,c=u.firstStore,f=s.constructor.parentIdField,d=s.isAutoRoot?null:s.id,h={};if(t&&t.parent!==s&&(t=null),s.children){var v=s.children,p=t?t.parentIndex:v.length;if(v[i=p]===e[0]||v[i=p-1]===e[0])for(r=!0,o=0;r&&o<e.length;o++)e[o]!==v[i+o]&&(r=!1)}if(r)return e;for(o=0;o<e.length;o++){var g=e[o],y=g.parent;h[g.id]=g.root===u,c&&!u.isLoading&&g.traverse((function(e){e.root===u&&(h[e.id]=!0)})),y&&!1===y.removeChild(g,h[g.id])?(a||(e=e.slice(),a=!0),e.splice(o--,1)):(g.parent=s,g.data[f]=d,y&&(g.meta.oldParentId=y.id))}if(e.length){var m=s.addToChildren(s.children||(s.children=[]),t,e);s.addToChildren(s.unfilteredChildren,t,e,!0),l.forEach((function(t){t.isChained||(e.forEach((function(e){e.joinStore(t)})),t.onNodeAddChild(s,e,m,h,n),e.forEach((function(e){if(null!=e.meta.oldParentId&&!s.inProcessChildren&&!s.isLoading){var t,n=(t={},Qe()(t,f,d),Qe()(t,s.getDataSource("parentIndex"),e.parentIndex),t),r={},i=e.meta,o=i.modified,a=i.oldParentId,l=o.parentIndex;delete e.meta.oldParentId,s.id!==a&&(r[f]={value:d,oldValue:a}),e.parentIndex!==l&&(r.parentIndex={value:e.parentIndex,oldValue:l}),o[f]===s.id?Reflect.deleteProperty(o,f):f in o||(o[f]=a),e.afterChange(n,r)}})))}))}return e}},{key:"removeChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.isLeaf,o=r.children,a=r.stores;if(Array.isArray(e)||(e=[e]),e=e.filter((function(e){return e.parent===r})),!n){var s,l=Zi(a);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(!u.isChained&&!1===u.trigger("beforeRemove",{parent:r,records:e,isMove:t}))return!1}}catch(e){l.e(e)}finally{l.f()}}var c,f=r.beforeRemoveChild?r.beforeRemoveChild(e,t):void 0,d=Zi(e);try{var h=function(){var e=c.value,i=e.constructor.parentIdField,s=e.meta.modified,l=e.parent?e.parent.id:null;i in s||(s[i]=l);var u=r.removeFromChildren(o,e);r.removeFromChildren(r.unfilteredChildren,e,!0),a.forEach((function(i){i.isChained||i.onNodeRemoveChild(r,[e],u,{isMove:t,silent:n})})),t||(e.parent=e.parentIndex=e.unfilteredIndex=e.nextSibling=e.previousSibling=null,e.data[i]=null)};for(d.s();!(c=d.n()).done;)h()}catch(e){d.e(e)}finally{d.f()}0===(r.unfilteredChildren||o).length&&r.constructor.convertEmptyParentToLeaf.onRemove&&!r.isRoot&&(r.meta.isLeaf=!0),r.isLeaf===i||n||r.stores.forEach((function(e){var t={isLeaf:{value:!0,oldValue:!1}};e.trigger("update",{record:r,changes:t}),e.trigger("change",{action:"update",record:r,changes:t})})),r.afterRemoveChild&&r.afterRemoveChild(e,f,t)}},{key:"clearParentId",value:function(){var e=this;Reflect.deleteProperty(e.data,e.parentIdField),Reflect.deleteProperty(e.originalData,e.parentIdField),e.meta.modified&&Reflect.deleteProperty(e.meta.modified,e.parentIdField)}},{key:"clearChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.stores,r=t.unfilteredChildren||t.children;t.children=[],r&&!0!==r&&(n.forEach((function(n){n.isChained||n.onNodeRemoveChild(t,r,0,{unfiltered:!0,silent:e})})),t.unfilteredChildren&&(t.unfilteredChildren=[]))}},{key:"clear",value:function(){var e=this,t=e.stores,n=e.children&&e.children.slice();if(e.isRoot&&n){var r,i=Zi(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!o.isChained&&!1===o.trigger("beforeRemove",{parent:e,records:n,isMove:!1,removingAll:!0}))return!1}}catch(e){i.e(e)}finally{i.f()}e.children.length=0,t.forEach((function(e){n.forEach((function(t){t.stores.includes(e)&&t.unjoinStore(e),t.parent=t.parentIndex=t.nextSibling=t.previousSibling=null})),e.storage.suspendEvents(),e.storage.clear(),e.storage.resumeEvents(),e.added.clear(),e.modified.clear(),e.trigger("removeAll"),e.trigger("change",{action:"removeall"})}))}}},{key:"updateChildrenIndices",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t?"unfilteredIndex":"parentIndex",i=null,o=0;o<e.length;o++){var a=e[o],s=a[r];"parentIndex"===r?void 0===s||n?a.setData("parentIndex",o):s!==o&&a.set("parentIndex",o,!0):a[r]=o,t||(a.previousSibling=i,i&&(i.nextSibling=a),o===e.length-1&&(a.nextSibling=null),i=a)}}},{key:"addToChildren",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e){var i=r?"unfilteredIndex":"parentIndex",o=t?t[i]:e.length;return e.splice.apply(e,[o,0].concat(F()(n))),this.updateChildrenIndices(e,r),o}}},{key:"removeFromChildren",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var r=n?"unfilteredIndex":"parentIndex",i=t[r];return i>-1&&(e.splice(i,1),this.updateChildrenIndices(e,n)),i}}}],[{key:"$name",get:function(){return"TreeNode"}},{key:"convertEmptyParentToLeaf",get:function(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}},set:function(e){!0===e?e={onLoad:!0,onRemove:!0}:!1===e&&(e={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=e}},{key:"parentIdField",get:function(){return this._parentIdField||"parentId"},set:function(e){this._parentIdField=e,Object.defineProperty(this.prototype,e,{set:function(e){this.parentId=e},get:function(){return this.parentId}})}}]),n}(e||$e)};function to(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function no(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var ro=Reflect.defineProperty,io=Symbol("owner"),oo=/[\s,]+/,ao=function(e){return function(e){Ye()(n,e);var t=no(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"Factoryable"}},{key:"declarable",get:function(){return["factoryable","alias","type"]}},{key:"register",value:function(e,t){for(var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pe.a.global.__BRYNTUM_EXAMPLE,o=this.initClass(),a=o.factoryable,s=a.caseless,l=a.registry,u=te.split(e,oo),c=0;c<u.length;++c){if(r=u[c],n=s?r.toLowerCase():r,!i&&n in l)throw new Error('Type "'.concat(r,'" already registered with ').concat(a.class.name," factory"));l[r]=l[n]=t.initClass()}}},{key:"isA",value:function(e,t){return this.isType(e,t,!0)}},{key:"isType",value:function(e,t,n){var r=this.factoryable,i=r.caseless,o=r.registry[i?t.toLowerCase():t];return!!o&&(n?e instanceof o:e.constructor===o)}},{key:"setupAlias",value:function(e){e.register(e.alias,e)}},{key:"setupFactoryable",value:function(e,t){var n=t.super.class,r=e.factoryable;(r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?to(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):to(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({caseless:!0,defaultType:null,extends:n.factoryable?[n]:null,typeKey:"type"},r)).class=e,r.registry=Object.create(null),r.extends&&!Array.isArray(r.extends)&&(r.extends=[r.extends]),ro(e,"factoryable",{get:function(){return r}})}},{key:"setupType",value:function(e){var t=e.type;e.register(t,e),ro(e.prototype,"type",{value:t})}},{key:"create",value:function(e,t){return this.reconfigure(null,e,t)}},{key:"reconfigure",value:function(e,t,n){var r,i,o,a,s,l,u,c,f,d=this,h=d.factoryable,v=h.typeKey,p=n;if(n&&!Qn.isClass(n)&&(p=null,"function"===(u=I()(n))?l=n:"string"===u?p=n:Qn.isObject(n)?(r=n.cleanup,i=n.defaults,a=n.owner,l=n.setup,p=n.type,c=n.transform):a=n),c&&(t="string"==typeof c?a[c](t):c(t)),"string"==typeof(f=t))t={};else if(t){if(!0===t&&(t={}),!Qn.isObject(t)){var g;if(a&&t!==e&&(null==e?void 0:e[io])===a)"string"==typeof r?a[r](e):null===(g=r)||void 0===g||g(e),e.destroy();return t}f=t[v]}if(f=f&&d.resolveType(f),e){if(t&&(!f||e.constructor===f))return v in t&&delete(t=Qn.assign({},t))[v],e.setConfig(t),e;var y;if(a&&e[io]===a)"string"==typeof r?a[r](e):null===(y=r)||void 0===y||y(e),e.destroy()}if(t){if(i){if(!(o=f)){if(!(o=i[v]||p||h.defaultType))throw new Error("No default mergeType defined for ".concat(h.class.name," factory"));o=d.resolveType(o)}o&&(t=o.mergeConfigs(i,t))}if(l){if(null===(s="string"==typeof l?a[l](t,f,i):l(t,f,i)))return s;t=s||t}if(!f){if(!(f=t[v]||p||h.defaultType))throw new Error("No default type defined for ".concat(h.class.name," factory"));f=d.resolveType(f)}i&&!o&&(t=f.mergeConfigs(i,t)),v in t&&delete(t=Qn.assign({},t))[v],t=new f(t),a&&(t[io]=a)}return t||null}},{key:"resolveType",value:function(e,t){if("string"!=typeof e)return e;var n,r=this.factoryable,i=r.extends,o=r.registry[r.caseless?e.toLowerCase():e];for(n=0;!o&&i&&n<i.length;++n)o=i[n].resolveType(e,!0);if(!o&&!t)throw new Error('Invalid type name "'.concat(e,'" passed to ').concat(r.class.name," factory"));return o}}]),n}(e||$e)};function so(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var lo=Reflect.getOwnPropertyDescriptor,uo=function(e){Ye()(n,e);var t=so(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;e&&(t.name=e.name,Object.assign(t,e)),t.compare&&(t.compareItems=function(e,n){return t.compare(null==e?void 0:e[t.name],null==n?void 0:n[t.name])})}},{key:"defineAccessor",value:function(e,t){var n=this.name,r=this.dataSource;!t&&n in e&&e.$meta.hierarchy.some((function(e){var t;return!1===(null===(t=lo(e.prototype,n))||void 0===t?void 0:t.enumerable)}))||Reflect.defineProperty(e,n,{configurable:!0,enumerable:!0,get:this.complexMapping?function(){return this.complexGet(n,r)}:function(){return this.flatGet(n,r)},set:function(e){var t=this.$meta.fields.map[n];t&&t.readOnly||this.set(n,e)}})}},{key:"isEqual",value:function(e,t){return Qn.isEqual(e,t)}},{key:"print",value:function(e){return null==e?this.nullText:this.printValue(e)}},{key:"printValue",value:function(e){return String(e)}}],[{key:"$name",get:function(){return"DataField"}},{key:"type",get:function(){return"auto"}},{key:"factoryable",get:function(){return{defaultType:"auto"}}},{key:"prototypeProperties",get:function(){return{compare:null,compareItems:null,dataSource:null,alwaysWrite:!1,nullable:!0,nullText:null,nullValue:void 0,persist:!0,readOnly:!1,internal:!1}}}]),n}($e.mixin(ao));function co(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}uo._$name="DataField";var fo=function(e){Ye()(n,e);var t=co(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"isEqual",value:function(e,t){return e===t}}],[{key:"$name",get:function(){return"ArrayDataField"}},{key:"type",get:function(){return"array"}}]),n}(uo);function ho(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fo.initClass(),fo._$name="ArrayDataField";var vo=function(e){Ye()(n,e);var t=ho(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"convert",value:function(e){return null==e?this.nullable?e:this.nullValue:Boolean(e)}}],[{key:"$name",get:function(){return"BooleanDataField"}},{key:"type",get:function(){return"boolean"}},{key:"alias",get:function(){return"bool"}},{key:"prototypeProperties",get:function(){return{nullValue:!1}}}]),n}(uo);function po(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}vo.initClass(),vo._$name="BooleanDataField";var go=function(e){Ye()(n,e);var t=po(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"dateFormat",get:function(){return this.format},set:function(e){z.a.deprecate("Core","5.0.0",'DateDataField "'.concat(this.name,'": dateFormat config has been renamed to "format"')),this.format=e}},{key:"convert",value:function(e){return null==e?this.nullable||(e=this.nullValue):"now"===e?e=new Date:e instanceof Date||(e=(e=Un.parse(e,this.format||Un.defaultParseFormat))||void 0),e}},{key:"serialize",value:function(e){return e instanceof Date&&(e=Un.format(e,this.format||Un.defaultFormat)),e}},{key:"printValue",value:function(e){return Un.format(e,this.format||Un.defaultFormat)}}],[{key:"$name",get:function(){return"DateDataField"}},{key:"type",get:function(){return"date"}},{key:"prototypeProperties",get:function(){return{format:null}}}]),n}(uo);function yo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}go.initClass(),go._$name="DateDataField";var mo=function(e){Ye()(n,e);var t=yo(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"convert",value:function(e){return null==e?this.nullable?e:this.nullValue:Math[this.rounding](Number(e))}}],[{key:"$name",get:function(){return"IntegerDataField"}},{key:"type",get:function(){return"integer"}},{key:"alias",get:function(){return"int"}},{key:"prototypeProperties",get:function(){return{nullValue:0,rounding:"round"}}}]),n}(uo);function bo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}mo.initClass(),mo._$name="IntegerDataField";var ko=function(e){Ye()(n,e);var t=bo(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"ModelDataField"}},{key:"type",get:function(){return"model"}},{key:"prototypeProperties",get:function(){return{complexMapping:!0}}}]),n}(uo);function wo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ko.initClass(),ko._$name="ModelDataField";var Co=function(e){Ye()(n,e);var t=wo(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"convert",value:function(e){if(null==e)return this.nullable?e:this.nullValue;e=Number(e);var t=this.precision;return t?(t=Math.pow(10,t),e=Math.round(e*t)/t):0===t&&(e=Math.round(e)),e}}],[{key:"$name",get:function(){return"NumberDataField"}},{key:"type",get:function(){return"number"}},{key:"alias",get:function(){return"float"}},{key:"prototypeProperties",get:function(){return{nullValue:0,precision:null}}}]),n}(uo);function Ro(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Co.initClass(),Co._$name="NumberDataField";var So=function(e){Ye()(n,e);var t=Ro(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"ObjectDataField"}},{key:"type",get:function(){return"object"}},{key:"prototypeProperties",get:function(){return{complexMapping:!0}}}]),n}(uo);function xo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}So.initClass(),So._$name="ObjectDataField";var Eo=function(e){Ye()(n,e);var t=xo(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"convert",value:function(e){return null==e?this.nullable?e:this.nullValue:String(e)}}],[{key:"$name",get:function(){return"StringDataField"}},{key:"type",get:function(){return"string"}},{key:"prototypeProperties",get:function(){return{nullValue:""}}}]),n}(uo);function Do(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function To(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Do(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Do(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Eo.initClass(),Eo._$name="StringDataField";var Mo=Reflect.defineProperty,Ao=Object.prototype.hasOwnProperty,Io=void 0,Po={children:1,data:1,meta:1},Fo=["name","title","text","label","description"],Lo=function(e){Ye()(n,e);var t=Oo(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"indexPath",get:function(){var e=[],t=this,n=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[n--]=t.parentIndex+1;return e}},{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=t?Array.isArray(t)?t:[t]:[],s=o.constructor,l=o.fieldMap,u=null;if(t=a[0],o.meta=To(To({modified:{}},s.metaConfig),r),s.applyConfigs)for(var c in o.getDefaultConfiguration())u||(u={},o.useRawData&&o.useRawData.enabled||(e=To({},e))),c in e&&(u[c]=e[c],delete e[c]);if(tt()(Ze()(n.prototype),"construct",this).call(this,u),i||s.exposeProperties(e),!Ao.call(s,"idFieldProcessed")){var f=o.meta.idField;f||(s._assignedIdField?f=s.idField:t&&(f=t.idField)),f&&f!==l.id.dataSource&&s.addField({name:"id",dataSource:f,internal:!0}),s.idFieldProcessed=!0}o._internalId=n._internalIdCounter++,o.stores=[],o.unjoinedStores=[],o.originalData||(o.originalData=e),o.data=s.processData(e,!1,t,o),null==o.id&&o.setData("id",o.generateId(t)),o.data[s.childrenField]&&o.processChildren(a),o.generation=0}},{key:"isCreating",get:function(){return this.meta.isCreating},set:function(e){var t=this;Boolean(t.meta.isCreating)!==e&&(t.meta.isCreating=e,t.stores.forEach((function(n){n.onIsCreatingToggle(t,e)})))}},{key:"equals",value:function(e){if(e instanceof this.constructor){for(var t=this.$meta.fields.defs,n=0,r=t.length;n<r;n++){var i=t[n],o=i.name;if("id"!==o&&!i.isEqual(this[o],e[o]))return!1}return!0}return!1}},{key:"subclass",get:function(){return new this.constructor(Object.setPrototypeOf({id:Io},this.data),this.stores[0],null,!0)}},{key:"allFields",get:function(){return this.$meta.fields.defs}},{key:"fieldMap",get:function(){return this.$meta.fields.map}},{key:"fields",get:function(){return this.$meta.fields.defs}},{key:"getFieldDefinition",value:function(e){return this.$meta.fields.map[e]}},{key:"getFieldDefinitionFromDataSource",value:function(e){return this.$meta.fields.sources[e]}},{key:"fieldNames",get:function(){return Object.keys(this.data)}},{key:"getDataSource",value:function(e){var t=this.constructor.getFieldDefinition(e);return(null==t?void 0:t.dataSource)||(null==t?void 0:t.name)}},{key:"initRelations",value:function(){var e=this;e.constructor.relations&&e.stores.forEach((function(t){var n;t.modelRelations||t.initRelations();var r=[];null===(n=t.modelRelations)||void 0===n||n.forEach((function(t){r.push({related:e.initRelation(t),config:t})})),t.updateRecordRelationCache(e,r)}))}},{key:"initRelation",value:function(e){var t=this,n=t.get(e.fieldName),r=n!==Io&&"string"!=typeof e.store&&e.store.getById(n),i={id:n,placeHolder:!0};return t.meta.relationCache||(t.meta.relationCache={}),t.meta.relationCache[e.relationName]=r||(null!=n?i:null),r}},{key:"removeRelation",value:function(e){this.meta.relationCache[e.relationName]&&(delete this.meta.relationCache[e.relationName],e.nullFieldOnRemove&&this.setData(e.fieldName,null))}},{key:"getForeign",value:function(e){var t;return null===(t=this.meta.relationCache)||void 0===t?void 0:t[e]}},{key:"setForeign",value:function(e,t,r){var i=n.asId(t);return this.set(r.fieldName,i)}},{key:"flatGet",value:function(e,t){var n;return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:null!==(n=this.data[t])&&void 0!==n?n:this.data[e]}},{key:"complexGet",value:function(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:Qn.getPath(this.data,t)}},{key:"get",value:function(e){if(e){var t=this.fieldMap[e];return!t&&e.includes(".")?this.complexGet(e,e):null!=t&&t.complexMapping?this.complexGet(e,t.dataSource):this.flatGet(e,(null==t?void 0:t.dataSource)||e)}}},{key:"setData",value:function(e,t){var n=this.data,r=this.fieldMap;if("string"==typeof e){var i,o=r[e],a=null!==(i=null==o?void 0:o.dataSource)&&void 0!==i?i:e;null!=o&&o.complexMapping?Qn.setPath(n,a,t):n[a]=t}else for(var s=Object.keys(e),l=0;l<s.length;l++){var u,c=s[l],f=r[c],d=null!==(u=null==f?void 0:f.dataSource)&&void 0!==u?u:c;d&&(null!=f&&f.complexMapping?Qn.setPath(n,d,e[c]):n[d]=e[c])}}},{key:"getData",value:function(e){var t,n=this.fieldMap[e],r=null!==(t=null==n?void 0:n.dataSource)&&void 0!==t?t:e;if(r)return null!=n&&n.complexMapping?Qn.getPath(this.data,r):this.data[r]}},{key:"syncId",value:function(e){var t=this.id;if(t!==e){this.setData("id",e);var n={id:{value:e,oldValue:t}};this.afterChange(n,n)}}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this;if(o.isBatchUpdating)return o.inBatchSet(e,t,n||o.$silenceBatch),null;var a,s=o.beforeSet?o.beforeSet(e,t,n,r):Io,l=o.inSet(e,t,n,r,i);return null===(a=o.afterSet)||void 0===a||a.call(o,e,t,n,r,s,l),l}},{key:"fieldToKeys",value:function(e,t){return"string"!=typeof e?Qn.assign({},e):Qe()({},e,t)}},{key:"inBatchSet",value:function(e,t,n){var r,i=this,o=i.meta,a=i.constructor,s=i.fieldMap,l={},u=!1;if("string"!=typeof e?Object.keys(i.fieldToKeys(e,t)).forEach((function(n){r=s[n]||Qn,t=a.processField(n,e[n],i),r.isEqual(o.batchChanges[n],t)||(l[n]={value:t,oldValue:i.get(n)},o.batchChanges[n]=t,u=!0)})):(r=s[e]||Qn).isEqual(o.batchChanges[e],t)||(l[e]={value:t,oldValue:i.get(e)},o.batchChanges[e]=t,u=!0),u&&(i.generation++,!n)){var c={action:"update",record:i,changes:l};i.stores.forEach((function(e){e.trigger("batchedUpdate",c)}))}}},{key:"inSet",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this,a=o.data,s=o.meta,l=o.fieldMap,u=o.constructor,c=u.prototype,f=u.childrenField,d={},h=o.fieldToKeys(e,t),v=Object.keys(h),p=!1;if(!n&&!o.triggerBeforeUpdate(h))return null;for(var g=function(e){var t,n=v[e];if(n===f)return"continue";var g=l[n],y=g||Qn,m=null==g?void 0:g.readOnly,b=null!==(t=null==g?void 0:g.dataSource)&&void 0!==t?t:n,k=!i&&!g&&n in c,w=k?o[b]:null!=g&&g.complexMapping?Qn.getPath(a,b):a[b],C=u.processField(n,h[n],o),R=h[n]={value:C},S=o.getRelationConfig(n);m||y.isEqual(w,C)||(o.generation++,R.oldValue=w,p=!0,y.isEqual(o.meta.modified[n],C)?Reflect.deleteProperty(s.modified,n):o.ignoreBag||(n in s.modified||(s.modified[n]=w),R.oldValue===Io&&Reflect.deleteProperty(R,"oldValue")),d[n]=R,o.applyValue(k,b,C,i,g),S&&!r&&(o.initRelation(S),o.stores.forEach((function(e){return e.cacheRelatedRecord(o,C,S.relationName,R.oldValue)}))))},y=0;y<v.length;y++)g(y);return p&&o.afterChange(h,d,n,r,i),p?d:null}},{key:"applyValue",value:function(e,t,n,r,i){var o;if(e)this[t]=n;else{if(!i&&t.includes(".")){var a=t.split(".")[0];i=this.constructor.fieldMap[a]}null!==(o=i)&&void 0!==o&&o.complexMapping?Qn.setPath(this.data,t,n):this.data[t]=n}}},{key:"afterChange",value:function(e,t,n,r,i){var o=this;this.stores.forEach((function(i){i.onModelChange(o,e,t,n,r)}))}},{key:"isPersistable",get:function(){return!this.isBatchUpdating&&!this.isCreating}},{key:"isModified",get:function(){return Boolean(this.meta.modified&&Object.keys(this.meta.modified).length>0)}},{key:"hasPersistableChanges",get:function(){return this.isPersistable&&!Qn.isEmpty(this.rawModificationData)}},{key:"isFieldModified",value:function(e){return this.isModified&&this.meta.modified[e]}},{key:"getFieldPersistentValue",value:function(e){var t,n="string"==typeof e?this.getFieldDefinition(e):e,r=(null==n?void 0:n.name)||e;return n&&!n.persist||(t=this[r],null!=n&&n.serialize&&(t=n.serialize(t,this))),t}},{key:"modifications",get:function(){var e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}},{key:"rawModifications",get:function(){var e=this,t={};if(!e.isModified)return null;var n=!1;return Object.keys(e.meta.modified).forEach((function(r){var i=e.getFieldPersistentValue(r);i!==Io&&(t[r]=i,n=!0)})),n?t:null}},{key:"modificationData",get:function(){var e=this.rawModificationData;return e&&Object.keys(e).length&&Qn.setPath(e,this.constructor.getFieldDefinition(this.constructor.idField).dataSource,this.id),e}},{key:"rawModificationData",get:function(){var e=this,t=e.constructor.fieldMap,n={};if(!e.isModified)return null;var r=!1;return Object.keys(e.meta.modified).forEach((function(i){var o=t[i];if(null!=o&&o.persist){var a=e.getFieldPersistentValue(i);a!==Io&&(Qn.setPath(n,o.dataSource,a),r=!0)}})),r?n:null}},{key:"modificationDataToWrite",get:function(){var e=this,t=this.constructor.alwaysWriteFields,n=this.modificationData;return t.length&&(n=Object.assign({},this.modificationData),t.forEach((function(t){n[e.getFieldDefinition(t).dataSource]=e[t]}))),n}},{key:"persistableData",get:function(){var e=this,t={};return e.fields.forEach((function(n){var r=e.getFieldPersistentValue(n);r!==Io&&(null!=n&&n.complexMapping?Qn.setPath(t,n.dataSource,r):t[n.dataSource]=r)})),t}},{key:"isCommitting",get:function(){return Boolean(this.meta.committing)}},{key:"clearChanges",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.meta;r.modified={},r.committing=!1,e&&n.stores.forEach((function(e){if(e.modified.remove(n),e.added.remove(n),t){var r=e.collectDescendants(n).all;e.added.remove(r),e.modified.remove(r)}}))}},{key:"revertChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.set(this.meta.modified,Io,e)}},{key:"internalId",get:function(){return this._internalId}},{key:"isPhantom",get:function(){return""===this.id||null==this.id||this.hasGeneratedId}},{key:"isModel",get:function(){return!0}},{key:"hasGeneratedId",get:function(){return"string"==typeof this.id&&this.id.startsWith("_generated")}},{key:"generateId",value:function(){return this.constructor.generateId()}},{key:"json",get:function(){return te.safeJsonStringify(this)}},{key:"toJSON",value:function(){var e=this.children,t=this.persistableData;return e&&(t[this.constructor.childrenField]=e.map((function(e){return e.toJSON()}))),t}},{key:"toString",value:function(){var e,t=this,n=Fo.find((function(e){return e in t.constructor.fieldMap})),r=n?(e={},Qe()(e,t.constructor.idField,t.id),Qe()(e,n,t[n]),e):t.data;return te.safeJsonStringify(r)}},{key:"isBatchUpdating",get:function(){return Boolean(this.batching)}},{key:"hasBatchedChange",value:function(e){var t,n;return null===(t=this.meta)||void 0===t||null===(n=t.batchChanges)||void 0===n?void 0:n[e]}},{key:"beginBatch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.batching||(t.batching=0,t.meta.batchChanges={}),e&&(t.$silenceBatch=(t.$silenceBatch||0)+1),t.batching++}},{key:"endBatch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.constructor.parentIdField;if(n.batching&&(n.batching--,n.$silenceBatch&&n.$silenceBatch--,!(n.batching>0||Qn.isEmpty(n.meta.batchChanges)))){var i=To({},n.meta.batchChanges);n.meta.batchChanges=null,i[r]&&(n.parentId=i[r],delete i[r]),n.set(i,Io,e,!1,t)}}},{key:"cancelBatch",value:function(){if(this.batching){var e=this,t=e.meta.batchChanges,n={};if(e.batching=null,e.meta.batchChanges=null,e.generation++,!e.$silenceBatch){Object.entries(t).forEach((function(t){var r=N()(t,2),i=r[0],o=r[1];n[i]={oldValue:o,value:e[i]}}));var r={action:"update",record:e,changes:n};e.stores.forEach((function(e){e.trigger("batchedUpdate",r)}))}e.$silenceBatch&&e.$silenceBatch--}}},{key:"triggerBeforeUpdate",value:function(e){var t=this;return!this.stores.some((function(n){return!1===n.trigger("beforeUpdate",{record:t,changes:e})}))}},{key:"copy",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,i=this,o=To({},i.data),a=i.constructor.idField;e=Qn.isObject(r)?r.deep:r,!1!==n&&delete o[a],n&&"object"===I()(n)?(t=n.id,"deep"in n?(e=n.deep,z.a.deprecate("Grid","5.0.0","`deep` attribute deprecated, in favor of a separate second parameter"),delete n.id,delete n.deep):Object.assign(o,n)):t=n,e&&i.children?o.children=i.children.map((function(e){return e.copy(void 0,r)})):(delete o.children,delete o.expanded),null==o[a]&&(o[a]=t||i.generateId(i.firstStore));var s=new i.constructor(o);return s.originalInternalId=i.internalId,s}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=this.parent;n?n.removeChild(t):t.stores.length&&(t.isSpecialRow||t.stores.forEach((function(n){return n.remove(t,e,!1,!0)})))}},{key:"firstStore",get:function(){return this.stores.length>0&&this.stores[0]}},{key:"getRelationConfig",value:function(e){var t,n;return null===(t=this.firstStore)||void 0===t||null===(n=t.modelRelations)||void 0===n?void 0:n.find((function(t){return t.fieldName===e}))}},{key:"isValid",get:function(){return!0}},{key:"joinStore",value:function(e){var t=this,r=t.stores;if(!r.includes(e)){var i=t.unjoinedStores;tt()(Ze()(n.prototype),"joinStore",this).call(this,e),e.register(t),r.push(e),i.includes(e)&&i.splice(i.indexOf(e),1),t.isLoaded&&t.children.forEach((function(t){return t.joinStore(e)})),t.initRelations(),e.tree&&!t.isRoot&&(t.instanceMeta(e.id).collapsed=!t.expanded)}}},{key:"unjoinStore",value:function(e){var t,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this,a=o.stores,s=o.unjoinedStores;a.includes(e)&&(e.isDestroying||(e.unregister(o),s.push(e)),null===(t=o.unfilteredChildren||o.children)||void 0===t||null===(r=t.forEach)||void 0===r||r.call(t,(function(t){return t.unjoinStore(e,i)})),a.splice(a.indexOf(e),1),tt()(Ze()(n.prototype),"unjoinStore",this)&&tt()(Ze()(n.prototype),"unjoinStore",this).call(this,e,i),e.uncacheRelatedRecord(o))}},{key:"isPartOfStore",value:function(e){return e?e.includes(this):this.stores.length>0}},{key:"isRemoved",get:function(){return!this.isPartOfStore()}},{key:"instanceMeta",value:function(e){var t=this.meta,n=e.id||e;return t.map||(t.map={}),t.map[n]||(t.map[n]={})}},{key:"isSpecialRow",get:function(){return this.meta.specialRow}}],[{key:"$name",get:function(){return"Model"}},{key:"declarable",get:function(){return["fields"]}},{key:"fields",get:function(){return[{name:"parentIndex",type:"number",persist:!1,internal:!0}]}},{key:"idField",get:function(){return this._idField},set:function(e){this._assignedIdField=!0,this._idField=e}},{key:"childrenField",get:function(){return this._childrenField||"children"},set:function(e){this._childrenField=e}},{key:"processData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=this.fieldMap,a=this.defaultValues,s=r||{},l=s.useRawData,u=void 0===l?{enabled:!1}:l,c=u.enabled?e:Qn.clone(e);if(!(n=n||u.disableDefaultValue))for(t in a)c[t]===Io&&(c[t]=a[t]);if(!u.disableTypeConversion)for(t in o){var f=o[t],d=f.name,h=f.dataSource,v=h!==d,p=v&&Qn.pathExists(e,h),g=d in e&&(!v||!p),y=!u.disableTypeConversion&&f.convert;if((g||y)&&(!n||g||p)){var m=g?c[d]:Qn.getPath(c,h);Qn.setPath(c,h,y?f.convert(m,i):m),v&&delete c[d]}}return c}},{key:"setupClass",value:function(e){tt()(Ze()(n),"setupClass",this).call(this,e),e.fields||this.setupFields(this,e)}},{key:"setupFields",value:function(e,t){var n,r,i,o,a,s=Ao.call(e,"fields")&&e.fields,l=t.super.fields,u=t.fields={defs:null!==(n=null==l?void 0:l.defs.slice())&&void 0!==n?n:[],exposedData:!1,defaults:l?To({},l.defaults):{},exposed:Object.create(null!==(r=null==l?void 0:l.exposed)&&void 0!==r?r:null),ordinals:Object.create(null!==(i=null==l?void 0:l.ordinals)&&void 0!==i?i:null),map:Object.create(null!==(o=null==l?void 0:l.map)&&void 0!==o?o:null),sources:Object.create(null!==(a=null==l?void 0:l.sources)&&void 0!==a?a:null)};Ao.call(e,"defaults")&&Object.assign(u.defaults,e.defaults),Ao.call(e,"idField")&&(e.addField({name:"id",dataSource:e.idField,internal:!0}),u.exposed[e.idField]=!0),null!=s&&s.length&&s.map(e.addField,e),e.exposeRelations()}},{key:"defaultValues",get:function(){return this.$meta.fields.defaults}},{key:"allFields",get:function(){return this.$meta.fields.defs}},{key:"fieldMap",get:function(){return this.$meta.fields.map}},{key:"fieldDataSourceMap",get:function(){return this.$meta.fields.sources}},{key:"exposeProperties",value:function(e){var t=this,n=t.$meta.fields;if(e&&t.autoExposeFields&&!n.exposedData){var r,i,o;for(r in e)n.exposed[r]||r===t.childrenField||(i={name:r,dataSource:r,fromData:!0},"boolean"!==(o=Zn(e[r]))&&"number"!==o&&"date"!==o||(i.type=o),t.addField(i));n.exposedData=!0}t.exposeRelations()}},{key:"addField",value:function(e){if(null!=e){"string"==typeof e&&(e={name:e});var t,n,r=this.initClass(),i=r.$meta.fields,o=i.ordinals,a=i.exposed,s=e.name,l=i.map[s],u=e.dataSource||(e.dataSource=s);if(!l||e.type&&e.type!==l.type)(t=uo.create(e)).definedBy=l?l.definedBy:r,t.ordinal=l?l.ordinal:o[s]=i.defs.length;else for(n in t=Object.create(l),e)"type"!==n&&(t[n]=e[n]);return t.owner=r,i.defs[t.ordinal]=t,i.map[s]=t,i.sources[u]||(i.sources[u]=t),u.includes(".")&&(t.complexMapping=!0),t.complexMapping?a[u.split(".")[0]]=!0:a[u]=!0,"defaultValue"in t&&(i.defaults[u]=t.defaultValue),Po[s]||t.defineAccessor(r.prototype),r._nonPersistableFields=null,r._alwaysWriteFields=null,t}}},{key:"removeField",value:function(e){var t=this.initClass(),n=t.$meta.fields,r=n.map[e],i=n.ordinals,o=i[e];if(r){for(var a in n.defs.splice(o,1),delete i[e],delete n.defaults[e],delete n.exposed[e],delete n.map[e],delete n.sources[r.dataSource],i)i[a]>o&&--i[a];delete t.prototype[e]}}},{key:"exposeRelations",value:function(){var e=this;Ao.call(e,"relationsExposed")||e.relationConfig&&(e.relationsExposed=!0,e.relations=[],e.relationConfig.forEach((function(t){e.relations.push(t);var n=t.relationName;Reflect.ownKeys(e.prototype).includes(n)||Mo(e.prototype,n,{enumerable:!0,get:function(){return this.getForeign(n)},set:function(e){this.setForeign(n,e,t)}})})))}},{key:"autoExposeFields",get:function(){return!0}},{key:"getFieldDefinition",value:function(e){return this.$meta.fields.map[e]}},{key:"getFieldDataSource",value:function(e){return this.getFieldDefinition(e).dataSource}},{key:"processField",value:function(e,t,n){var r=this.fieldMap[e];return null!=r&&r.convert?r.convert(t,n):t}},{key:"generateId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$$name;return this.generatedIdIndex||(this.generatedIdIndex=0),"_generated".concat(e).concat(++this.generatedIdIndex)}},{key:"asId",value:function(e){return null!=e&&e.isModel?e.id:e}},{key:"nonPersistableFields",get:function(){var e=this;return e._nonPersistableFields||(e._nonPersistableFields={},e.allFields.forEach((function(t){t.persist&&!t.calculated||(e._nonPersistableFields[t.name]=1)}))),e._nonPersistableFields}},{key:"alwaysWriteFields",get:function(){var e=this;return e._alwaysWriteFields||(e._alwaysWriteFields=[],e.allFields.forEach((function(t){t.alwaysWrite&&e._alwaysWriteFields.push(t.name)}))),e._alwaysWriteFields}}]),n}($e.mixin(Xi,eo));Lo._idField="id",Lo._internalIdCounter=1,Lo._assignedIdField=!1,Lo.exposeProperties(),Lo._$name="Model";n(216),n(277),n(106);var Bo=function(){function e(t,n){B()(this,e),"number"==typeof t?(this._magnitude=t,this._unit=n):("string"==typeof t&&(t=Un.parseDuration(t)),"object"===I()(t)&&Object.assign(this,t))}return _()(e,[{key:"magnitude",get:function(){return this._magnitude},set:function(e){this._magnitude="number"==typeof e&&e}},{key:"unit",get:function(){return this._unit},set:function(e){this._unit=Un.parseTimeUnit(e)}},{key:"isValid",get:function(){return null!=this._magnitude&&this._unit}},{key:"milliseconds",get:function(){return this.isValid?Math.round(Un.asMilliseconds(this._magnitude,this._unit)):0}},{key:"isEqual",value:function(e){return Boolean(e&&this.milliseconds===e.milliseconds)}},{key:"toString",value:function(e){var t=this,n=e?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?"".concat(t._magnitude," ").concat(Un[n](t._unit,1!==t._magnitude)):""}},{key:"toJSON",value:function(){return this.toString()}},{key:"valueOf",value:function(){return this.milliseconds}}]),e}();function jo(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ho(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Bo._$name="Duration";var No=function(e,t){return e[t]},zo=function(e){Ye()(n,e);var t=Ho(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){"function"==typeof e&&(e={filterBy:e}),e.type?"date"===e.type?e.value=new Date(e.value):"duration"===e.type&&(e.value=new Bo(e.value)):Un.isDate(e.value)?e.type="date":e.value instanceof Bo&&(e.type="duration"),tt()(Ze()(n.prototype),"construct",this).call(this,e)}},{key:"id",get:function(){return this._id||(this._id=this.property||n.generateId("b-filter"))},set:function(e){this._id=e}},{key:"onChange",value:function(e){var t=this;!t.isConfiguring&&t.owner&&!t.owner.isConfiguring&&t.owner.onFilterChanged&&t.owner.onFilterChanged(t,e)}},{key:"filterBy",get:function(){return this._filterBy||this.defaultFilterBy},set:function(e){this._filterBy=e}},{key:"defaultFilterBy",value:function(e){var t,n=this;return t=n._propertyItems.length>1?n._propertyItems.reduce(No,e):e[n.property],n[n.operator](n.convert(t))}},{key:"updateProperty",value:function(e){this._propertyItems=e.split("."),this.onChange("property")}},{key:"value",get:function(){return this._value},set:function(e){var t,n;this._value=e,e=null!==(t=null===(n=e)||void 0===n?void 0:n.valueOf())&&void 0!==t?t:e,this._filterValue=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase(),this.onChange("value")}},{key:"filterValue",get:function(){return this._filterValue}},{key:"operator",get:function(){return this._operator||("string"==typeof this.filterValue?"*":"=")},set:function(e){this._operator=e,this.onChange("operator")}},{key:"convert",value:function(e){var t,n;"string"==typeof this.filterValue&&e instanceof Date||(e=null!==(t=null===(n=e)||void 0===n?void 0:n.valueOf())&&void 0!==t?t:e);return e=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase()}},{key:"filter",value:function(e){return this.filterBy(e)}},{key:"startsWith",value:function(e){return String(e).startsWith(this.filterValue)}},{key:"endsWith",value:function(e){return String(e).endsWith(this.filterValue)}},{key:"=",value:function(e){return Qn.isEqual(e,this.filterValue)}},{key:"!=",value:function(e){return!Qn.isEqual(e,this.filterValue)}},{key:">",value:function(e){return Qn.isMoreThan(e,this.filterValue)}},{key:">=",value:function(e){return Qn.isMoreThan(e,this.filterValue)||Qn.isEqual(e,this.filterValue)}},{key:"<",value:function(e){return Qn.isLessThan(e,this.filterValue)}},{key:"<=",value:function(e){return Qn.isLessThan(e,this.filterValue)||Qn.isEqual(e,this.filterValue)}},{key:"*",value:function(e){return Qn.isPartial(e,this.filterValue)}}],[{key:"defaultConfig",get:function(){return{value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null,type:null}}},{key:"configurable",get:function(){return{property:null}}},{key:"generateFiltersFunction",value:function(e){return e&&(e.length||e.count)?function(t){var n,r=!0,i=jo(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.disabled||(r=o.filter(t)),!r)break}}catch(e){i.e(e)}finally{i.f()}return r}:at.returnTrue}}]),n}($e.mixin(Gi));zo._$name="CollectionFilter";var Vo=Qn.getPathDefault(pe.a.global,"bryntum.idCounts",Object.create(null)),Wo=function(){function e(){B()(this,e)}return _()(e,null,[{key:"generateId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generatedId";return e+(Vo[e]=(Vo[e]||0)+1)}}]),e}();function $o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Wo._$name="IdHelper";var Uo=function(e){Ye()(n,e);var t=$o(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){"function"==typeof e&&(e={sortFn:e}),tt()(Ze()(n.prototype),"construct",this).call(this,e)}},{key:"id",get:function(){return this._id||(this._id=this.property||Wo.generateId("b-sorter"))},set:function(e){this._id=e}},{key:"sortFn",get:function(){return this._sortFn?this._sortFn:this.defaultSortFn},set:function(e){this._sortFn=e}},{key:"defaultSortFn",value:function(e,t){var n=this,r=n.convert,i=n.property,o=n.useLocaleSort,a="desc"===n.direction.toLowerCase()?-1:1;if(e=e[i],t=t[i],r&&(e=r(e),t=r(t)),o&&null!=e&&null!=t){if(!0===o)return String(e).localeCompare(t);if("string"==typeof o)return String(e).localeCompare(t,o);if("object"===I()(o))return String(e).localeCompare(t,o.locale,o)}return(e>t?1:e<t?-1:0)*a}}],[{key:"defaultConfig",get:function(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}},{key:"generateSortFunction",value:function(e,t){var n=e.isCollection?e.values:e,r=n.length;return function(e,i){var o,a;for(a=0;a<r;++a)if(o=n[a].sortFn(e,i))return o;return t?t(e,i):0}}}]),n}($e);function Go(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Uo._$name="CollectionSorter";var Yo=function(){return 0},qo=function(e,t){return t-e},Ko=Symbol("filteredIndicesProperty"),Xo=Object.freeze([]),Zo=Object.freeze({action:"sort",added:Xo,removed:Xo,replaced:Xo}),Jo=Object.freeze({action:"filter",added:Xo,removed:Xo,replaced:Xo}),Qo={string:1,number:1};function ea(e,t,n){if(!1!==t.unique)t.set(n,e);else{var r=t.get(n);r||(r=new Set,t.set(n,r)),r.add(e)}}function ta(e,t,n,r){for(var i=0;i<e.length;i++)for(var o=e[i],a=0;a<r;a++){var s=n[a],l=o[s];ea(o,t[s],l)}}var na=function(e){Ye()(n,e);var t=Go(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"isCollection",get:function(){return!0}},{key:"construct",value:function(e){this.generation=0,this._values=[],tt()(Ze()(n.prototype),"construct",this).call(this,e)}},{key:"doDestroy",value:function(){var e;tt()(Ze()(n.prototype),"doDestroy",this).call(this);var t=this;t._values.length=0,t.isFiltered&&(t._filteredValues.length=0,t.filters.destroy()),null===(e=t._sorters)||void 0===e||e.destroy()}},{key:"clear",value:function(){var e=this,t=e._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}},{key:"replaceValues",value:function(e){var t,n,r=e.values,i=e.filteredValues,o=e.silent,a=void 0!==o&&o,s=e.isNewDataset,l=void 0!==s&&s,u=this;u.isFiltered&&!l?(Boolean(i)?r&&(t=u._values,u._values=r.slice()):(i=r.slice(),r=null),n=u._filteredValues,u._filteredValues=i.slice()):(t=u._values,u._values=r.slice(),i=null,u.isFiltered&&l&&u.autoFilter?(u._filterFunction=null,u._filteredValues=u._values.filter(u.filterFunction)):u._filteredValues&&(u._filteredValues.length=0));u._indicesInvalid=!0,u.generation++,a||u.trigger("change",{action:"replaceValues",replacedValues:t,replacedFilteredValues:n,values:r,filteredValues:i})}},{key:"values",get:function(){return this.isFiltered?this._filteredValues:this._values},set:function(e){this.invalidateIndices(),this.splice(0,this._values.length,e)}},{key:Symbol.iterator,value:function(){return this.values[Symbol.iterator]()}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}},{key:"first",get:function(){return this.values[0]}},{key:"last",get:function(){return this.values[this.count-1]}},{key:"allValues",get:function(){return this._values}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length?this.splice.apply(this,[this._values.length,null].concat(t)):this.splice(this._values.length,null,t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length?this.splice.apply(this,[0].concat(t)):this.splice(0,t)}},{key:"move",value:function(e,t){for(Array.isArray(e)||(e=[e]);e.length&&e[0]===t;)e.shift();if(e.length){var n=this,r=n._values,i=n.indexOf(e[0],!0);if(1!==e.length||r[i+1]!==t){n.suspendEvents(),n.remove(e),n.resumeEvents();var o=t?n.indexOf(t,!0):r.length;if(-1===o)throw new Error("Collection move beforeItem parameter must be present in Collection");return r.splice.apply(r,[o,0].concat(F()(e))),n._indicesInvalid=1,n.trigger("change",{action:"move",items:e,from:i,to:o}),o}}}},{key:"splice",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o,a,s=this,l=s.idProperty,u=s._values,c={},f=[],d=[],h=s.totalCount;if(r)if(1===r.length&&Array.isArray(r[0])&&(r=r[0]),h&&r.length){var v=s.indices[l];o=[];for(var p=0;p<r.length;p++){var g=r[p],y=g[l],m=v.get(y),b=m?u.indexOf(m):-1;c[y]=!0,-1!==b?u[b]!==g&&(d.push([u[b],g]),u[b]=g):o.push(g)}}else o=r;if(t){if("number"==typeof t){t=Math.min(t,u.length-e);for(var k=e;t;--t){var w=u[k][l];c[w]?(e++,k++):(f.push(u[k]),u.splice(k,1),a=!0)}}else{var C,R=0===o.length;Array.isArray(t)||(t=[t]);var S=t.reduce((function(e,t){var n="number"==typeof t,r=n?t:s.indexOf(t,!0);return R&&(null!=C&&r!==C+1||n)&&(R=!1),r>=0&&r<h&&e.push(r),C=r,e}),[]).sort(qo);if(R)S.length&&(f.push.apply(f,t),u.splice(S[S.length-1],S.length),a=!0);else for(var x=0;x<S.length;x++){var E=S[x];if(-1!==E){var D=u[E][l];c[D]||(f.unshift(u[E]),u.splice(E,1),a=!0)}}}f.length&&!s._indicesInvalid&&f.forEach(s.removeFromIndices,s)}if(o.length&&(u.splice.apply(u,[Math.min(e,u.length),0].concat(F()(o))),a=!0,s._indicesInvalid||o.forEach(s.addToIndices,s)),d.length&&!s._indicesInvalid&&d.forEach((function(e){s.removeFromIndices(e[0]),s.addToIndices(e[1])})),a||d.length){if(s.isSorted)s.onSortersChanged();else if(s.isFiltered){var T;if(s.autoFilter)s.onFiltersChanged();else(T=s._filteredValues).push.apply(T,F()(o))}s.generation++,s.trigger("change",{action:"splice",removed:f,added:o,replaced:d,oldCount:h})}else s.trigger("noChange",{index:e,toRemove:t,toAdd:r})}},{key:"changeId",value:function(e,t){var n=this,r=n.idProperty,i=Qo[I()(e)]?e:e[r],o=n.get(i);if(o){var a=n.get(t);if(a&&o!==a)throw new Error("Attempt to set item ".concat(i," to already existing member's id ").concat(t));n.removeIndexEntry(e,r,i),n.addIndexEntry(e,r,t),o[r]=t}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getBy(this.idProperty,e,t)}},{key:"getAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}},{key:"getBy",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.findItem(e,t,this.isFiltered&&n)}},{key:"count",get:function(){return this.values.length}},{key:"totalCount",get:function(){return this._values.length}},{key:"updateIdProperty",value:function(e){this.addIndex({property:e,unique:!0})}},{key:"changeSorters",value:function(e){return new n({values:Array.isArray(e)?e:[e],listeners:{change:"onSortersChanged",thisObj:this}})}},{key:"addSorter",value:function(e){var t=e instanceof Uo?e:new Uo(e);return this.sorters.add(t),t}},{key:"isSorted",get:function(){var e;return Boolean(null===(e=this._sorters)||void 0===e?void 0:e.count)}},{key:"onSortersChanged",value:function(){var e=this;delete e._sortFunction,e._values.sort(e.sortFunction),e.trigger("change",Zo)}},{key:"sortFunction",get:function(){return this._sortFunction||(this.isSorted?this._sortFunction=Uo.generateSortFunction(this.sorters.values):this._sortFunction=Yo),this._sortFunction}},{key:"filters",get:function(){return this._filters||(this._filters=new n({listeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}},{key:"addFilter",value:function(e){var t=e instanceof zo?e:new zo(e);return this.filters.add(t),t}},{key:"isFiltered",get:function(){return Boolean(this._filters&&this._filters.count)}},{key:"onFiltersChanged",value:function(){var e=this;e._filterFunction=null,e._filteredValues=e._values.filter(e.filterFunction),e._indicesInvalid=!0,e.trigger("change",Jo)}},{key:"filterFunction",get:function(){return this._filterFunction||(this.isFiltered?this._filterFunction=zo.generateFiltersFunction(this.filters.values):this._filterFunction=at.returnTrue),this._filterFunction}},{key:"changeExtraKeys",value:function(e){return(Array.isArray(e)?e:[e]).map((function(e){return"string"==typeof e?{property:e,unique:!0}:e}))}},{key:"updateExtraKeys",value:function(e){for(var t=0;t<e.length;t++)this.addIndex(e[t])}},{key:"addIndex",value:function(e){e&&((this._indices||(this._indices={}))[e.property]=new Map,Object.assign(this._indices[e.property],e),this.invalidateIndices())}},{key:"findIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.findItem(e,t,n);if(!r)return-1;var i=this.isFiltered&&!n?this._filteredValues:this._values;return i.indexOf(r)}},{key:"findItem",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.isFiltered,o=i&&!n?r.indices[Ko][e]:r.indices[e];if(o){var a,s=null!==(a=o.get(t))&&void 0!==a?a:"string"==typeof t&&t.length&&!isNaN(t)&&o.get(Number(t))||null;if(null!=s)return s}else for(var l=i&&!n?r._filteredValues:r._values,u=l.length,c=0;c<u;c++){var f=l[c];if(f[e]==t)return f}return null}},{key:"removeIndex",value:function(e){delete this._indices[e]}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.findIndex(this.idProperty,Qo[I()(e)]?e:e[this.idProperty],t)}},{key:"includes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.isArray(e)?e.some((function(e){return t.includes(e)})):Boolean(this.findItem(this.idProperty,Qo[I()(e)]?e:e[this.idProperty],n))}},{key:"indices",get:function(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}},{key:"invalidateIndices",value:function(){this._indicesInvalid=!0}},{key:"rebuildIndices",value:function(){var e,t=this,n=t.isFiltered,r=t._indices||(t._indices={}),i=Object.keys(r),o=i.length,a=t._values;n&&(e=r[Ko]={});for(var s=0;s<o;s++){var l=r[i[s]];if(l.clear(),n){var u=e[i[s]];u?u.clear():(u=e[i[s]]=new Map).unique=l.unique}}ta(a,r,i,o),n&&ta(t._filteredValues,e,i,o),t._indicesInvalid=!1}},{key:"getIndices",value:function(e){var t=[this.indices[e]];return this.isFiltered&&t.push(this.indices[Ko][e]),t}},{key:"addToIndices",value:function(e){var t=this;Object.keys(this.indices).forEach((function(n){t.addIndexEntry(e,n,e[n])}))}},{key:"removeFromIndices",value:function(e){var t=this;Object.keys(this.indices).forEach((function(n){t.removeIndexEntry(e,n,e[n])}))}},{key:"removeIndexEntry",value:function(e,t,n){this.getIndices(t).forEach((function(t){return function(e,t,n){!1!==t.unique?t.delete(n):t.has(n)&&(t.get(n).delete(e),t.get(n).size||t.delete(n))}(e,t,n)}))}},{key:"addIndexEntry",value:function(e,t,n){this.getIndices(t).forEach((function(t){return ea(e,t,n)}))}},{key:"onItemMutation",value:function(e,t){var n=this;!this._indicesInvalid&&Object.keys(this.indices).length>1&&Object.keys(t).forEach((function(r){if(n.indices[r]){var i=t[r],o=i.value,a=i.oldValue;n.removeIndexEntry(e,r,a),n.addIndexEntry(e,r,o)}}))}}],[{key:"configurable",get:function(){return{idProperty:"id",extraKeys:null,autoFilter:!0,autoSort:!0,sorters:{$config:["lazy"],value:[]}}}}]),n}($e.mixin(Ot));function ra(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ia(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ia(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}na._$name="Collection";var oa=new WeakMap,aa=function(e){if(e&&"object"===I()(e)){var t=oa.get(e);void 0===t&&(t=Symbol("bscik"),oa.set(e,t)),e=t}return e},sa=function(){function e(t){B()(this,e);var n=this;n.generation=0,n.items=new Set,n.idMap={},n.idProperty="id",t&&(t.idProperty&&(n.idProperty=t.idProperty),t.values&&(n.values=t.values))}return _()(e,[{key:"get",value:function(e){return this.idMap[aa(e)]}},{key:"count",get:function(){return this.items.size}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length&&Array.isArray(t[0])&&(t=t[0]);for(var r=this,i=r.items,o=r.idMap,a=r.idProperty,s=t.length,l=0;l<s;l++){var u=t[l],c=Qo[I()(u)]?u:aa(u[a]),f=o[c];null==f?(o[c]=u,i.add(u),r.generation++):f!==u&&(o[c]=u,i.delete(f),i.add(u))}}},{key:"remove",value:function(e){Array.isArray(e)||(e=[e]);for(var t=this.items,n=this.idMap,r=this.idProperty,i=e.length,o=0;o<i;o++){var a=e[o],s=Qo[I()(a)]?a:aa(a[r]),l=n[s];null!=l&&(t.delete(l),delete n[s],this.generation++)}}},{key:"clear",value:function(){this.items.clear(),this.idMap={},this.generation++}},{key:"countOf",value:function(e){var t,n=0,r=ra(this.items);try{for(r.s();!(t=r.n()).done;)e(t.value)&&++n}catch(e){r.e(e)}finally{r.f()}return n}},{key:"changeId",value:function(e,t){var n=this,r=n.idMap,i=n.idProperty,o=Qo[I()(e)]?e:aa(e[i]),a=n.get(o);if(a){var s=n.get(t);if(s&&a!==s)throw new Error("Attempt to set item ".concat(o," to already existing member's id ").concat(t));a[i]=t,delete r[o],r[t]=a}}},{key:"includes",value:function(e){var t=Qo[I()(e)]?e:aa(e[this.idProperty]);return Boolean(this.idMap[t])}},{key:"map",value:function(e,t){var n=this.items,r=new Array(n.size),i=0;return n.forEach((function(o){r[i]=e.call(t,o,i++,n)})),r}},{key:"forEach",value:function(e,t){return this.items.forEach(e,t)}},{key:"find",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r<0&&(r=this.countOf(e)+r);var i,o=ra(this.items);try{for(o.s();!(i=o.n()).done;)if(e(t=i.value)&&!r--){n=t;break}}catch(e){o.e(e)}finally{o.f()}return n}},{key:Symbol.iterator,value:function(){return this.items[Symbol.iterator]()}},{key:"indexOf",value:function(e,t){var n,r,i=-1,o=ra(this.items);try{for(o.s();!(r=o.n()).done;)if(n=r.value,(!t||t(n))&&(++i,n===e))return i}catch(e){o.e(e)}finally{o.f()}return-1}},{key:"values",get:function(){return F()(this.items)}},{key:"values",set:function(e){Array.isArray(e)||(e=[e]),this.clear(),this.add.apply(this,e),this.generation++}},{key:"sort",value:function(e){this.values=this.values.sort(e)}},{key:"some",value:function(e,t){return this.values.some(e,t)}}]),e}();function la(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}sa._$name="Bag";var ua=function(e){Ye()(n,e);var t=la(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"add",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return 1===r.length&&Array.isArray(r[0])&&(r=r[0]),(e=tt()(Ze()(n.prototype),"add",this)).call.apply(e,[this].concat(F()(r.filter((function(e){return e.isPersistable})))))}}]),n}(sa);function ca(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fa(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function da(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ua._$name="StoreBag";var ha=function(e){return function(e){Ye()(n,e);var t=da(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.storage;if(e instanceof Set&&(e=Array.from(e)),(e=(Array.isArray(e)?e:[e]).reduce((function(e,t){return(t=n.getById(t))&&e.push(t),e}),[])).length){if(n.isRemoving=!0,n.tree){for(var i=e.reduce((function(e,t){var n=t.parent;return n&&(e[n.id]||(e[n.id]=[n,[]]),e[n.id][1].push(t)),e}),{}),o=0,a=Object.values(i);o<a.length;o++){var s=a[o];s[0].removeChild(s[1],!1,t)}return n.isRemoving=!1,e}if(n.isGrouped){var l,u=r.count,c=[],f=new Set,d=ca(e);try{for(d.s();!(l=d.n()).done;){var h=l.value,v=h.instanceMeta(n),p=v.groupParent;p&&p.meta.collapsed&&c.push(h),it.remove(p.groupChildren,h),p.meta.childCount--,f.add(p)}}catch(e){d.e(e)}finally{d.f()}var g,y=ca(f);try{for(y.s();!(g=y.n()).done;){var m=g.value;m.groupChildren.length>0&&n.onModelChange(m,{},{})}}catch(e){y.e(e)}finally{y.f()}c.length&&r.trigger("change",{action:"splice",removed:c,added:[],replaced:[],oldCount:u})}if(!e.length||!t&&!1===n.trigger("beforeRemove",{records:e}))return n.isRemoving=!1,null;t&&n.suspendEvents(),r.remove(e),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),n.isRemoving=!1}return e}},{key:"clear",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this,i=r.storage;if(r.storage.totalCount||null!==(e=r.rootNode)&&void 0!==e&&null!==(t=e.unfilteredChildren)&&void 0!==t&&t.length){if(!n&&!1===r.trigger("beforeRemove",{records:i.allValues,removingAll:!0}))return null;if(r.rootNode)r.isChained||r.rootNode.clearChildren(n);else if(n)for(var o,a=r.registeredRecords,s=a.length-1;s>=0;s--)(o=a[s])&&!o.isDestroyed&&o.unjoinStore(r);n&&(r.removed.clear(),i.suspendEvents()),i.clear(),n&&i.resumeEvents(),r.added.clear(),r.modified.clear()}}},{key:"removeAll",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this,r=n.storage;if(n.isRemoving=!0,t){r.suspendEvents();for(var i,o=n.registeredRecords,a=o.length-1;a>=0;a--)!(i=o[a])||i.isDestroyed||i.isRoot||i.unjoinStore(n)}return e=n.tree?!1!==n.rootNode.clear():null!==n.clear(),t&&r.resumeEvents(),n.isRemoving=!1,e}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.storage;if(Array.isArray(e)){if(!e.length)return}else e=[e];if(n.tree=n.tree||Boolean(n.autoTree&&e[0].children),n.tree){var i=new Map,o=[];return e.forEach((function(e){var t=e[n.modelClass.parentIdField];i.has(t)||i.set(t,[]),i.get(t).push(e)})),i.forEach((function(e,r){var i=null==r?n.rootNode:n.getById(r);if(!i)throw new Error("Parent node with id ".concat(r," not found, cannot add children."));o.push.apply(o,F()(i.appendChild(e,t)))})),o}if(!t&&!1===n.trigger("beforeAdd",{records:e}))return null;if(n.tree=n.tree||Boolean(n.autoTree&&e[0].children),n.tree)return n.rootNode.appendChild(e);var a=n.processRecords(e);return t&&n.suspendEvents(),r.add(a),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),a}},{key:"processRecords",value:function(e,t){var n=this;return e.map((function(e){var r=n.processRecord(e.isModel?e:n.createRecord(e));return null==t||t.call(n,r),r}))}},{key:"insert",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this,s=a.storage,l=a.getAt(e),u=s.values,c=[];if(Array.isArray(t)||(t=[t]),!1===a.trigger("beforeAdd",{records:t}))return null;if(u[r=e]===t[0]||u[r=e-1]===t[0])for(n=!0,i=0;n&&i<t.length;i++)t[i]!==u[r+i]&&(n=!1);if(n)return null;var f=a.processRecords(t,(function(t){var n=s.indexOf(t);t.children&&t.children.length&&a.autoTree&&(a.tree=!0),n>-1&&(n<e&&l&&e--,c.push(n)),t.meta.previousIndex=n}));if(a.tree){var d=a.rootNode;return d.insertChild(t,d.children&&d.children[e])}return a.suspendEvents(),a.storage.remove(c),a.resumeEvents(),o&&a.suspendEvents(),s.splice.apply(s,[e,0].concat(F()(f))),o&&a.resumeEvents(),a.autoCommit&&a.doAutoCommit(),f}},{key:"move",value:function(e,t){this.storage.move(e,t)}},{key:"setMultiple",value:function(e,t,n){var r=this,i=[],o=[];r.forEach((function(r){e(r)&&(o.push(r.set(t,n,!0)),i.push(r))})),r.trigger("updateMultiple",{records:i,all:r.records.length===i.length}),r.trigger("change",{action:"updatemultiple",records:i,all:r.records.length===i.length}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}},{key:"setAll",value:function(e,t){var n=this,r=[];n.forEach((function(n){r.push(n.set(e,t,!0))})),n.trigger("updateMultiple",{records:n.records,all:!0}),n.trigger("change",{action:"updatemultiple",records:n.records,all:!0}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}},{key:"acceptChanges",value:function(){var e=this;e.added.forEach((function(e){return e.clearChanges(!1)})),e.modified.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.modified.clear(),e.removed.clear()}},{key:"commit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.changes;return!(!e&&!1===this.trigger("beforeCommit",{changes:t}))&&(this.acceptChanges(),e||this.trigger("commit",{changes:t}),t)}},{key:"revertChanges",value:function(){var e=this,t=e.changes;e.add(e.removed.values,!0),e.remove(e.added.values,!0),e.modified.forEach((function(e){return e.revertChanges(!0)})),e.added.clear(),e.modified.clear(),e.removed.clear(),e.trigger("change",{action:"clearchanges",changes:t})}},{key:"changes",get:function(){var e=this,t=e.modified.values.filter((function(e){return e.rawModifications}));return e.added.count||t.length||e.removed.count?{added:e.added.values.slice(),modified:t,removed:e.removed.values.slice()}:null}},{key:"autoCommit",get:function(){return this._autoCommit},set:function(e){this._autoCommit=e,e&&this.changes&&this.commit()}},{key:"suspendAutoCommit",value:function(){this.suspendCount++}},{key:"resumeAutoCommit",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.suspendCount--,this.autoCommit&&e&&this.doAutoCommit()}},{key:"doAutoCommit",value:function(){this.suspendCount<=0&&this.commit()}},{key:"applyChangesFromStore",value:function(e){var t=this,n=e.changes;n&&(n.added&&t.add(n.added),n.removed&&t.remove(n.removed.map((function(e){return e.id}))),n.modified&&n.modified.forEach((function(e){t.getById(e.id).set(e.modifications)})))}}],[{key:"$name",get:function(){return"StoreCRUD"}},{key:"defaultConfig",get:function(){return{autoCommit:!1}}},{key:"properties",get:function(){return{isRemoving:!1,suspendCount:0}}}]),n}(e||$e)};function va(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var pa=function(e){return function(e){Ye()(n,e);var t=va(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"reapplyFilterOnAdd",get:function(){return this.storage.autoFilter},set:function(e){this.storage.autoFilter=e}},{key:"filters",get:function(){return this._filters||(this._filters=new na({extraKeys:["property"]}))},set:function(e){var t=this,n=t.filters;if(n.clear(),t._filtersFunction=null,e){if("Object"===e.constructor.name)for(var r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];"filterBy"===o[0]&&"function"==typeof o[1]?n.add(new zo({filterBy:o[1]})):n.add(new zo("Object"===o[1].constructor.name?Object.assign({property:o[0]},o[1]):{property:o[0],value:o[1]}))}else Array.isArray(e)?n.add.apply(n,F()(e.map((function(e){return e instanceof zo?e:new zo(e)})))):e.isCollection?n.add.apply(n,F()(e.values)):n.add(new zo({filterBy:e}));n.forEach((function(e){return e.owner=t}))}}},{key:"filtersFunction",get:function(){var e=this,t=e.filters,n=e.isGrouped;if(!e._filtersFunction)if(t.count){var r=zo.generateFiltersFunction(t);e._filtersFunction=function(e){return n&&e.isSpecialRow?e.groupChildren.some(r):r(e)}}else e._filtersFunction=at.returnTrue;return e._filtersFunction},set:function(e){this._filtersFunction=e}},{key:"isFiltered",get:function(){return this.filters.values.some((function(e){return!e.disabled}))}},{key:"traverseFilter",value:function(e){var t=this,n=!e.isRoot&&t.filtersFunction(e),r=e.unfilteredChildren||e.children;return r&&r.length?(e.unfilteredChildren||(e.unfilteredChildren=e.children.slice()),e.children=e.unfilteredChildren.filter((function(e){return t.traverseFilter(e)})),e.updateChildrenIndices(e.unfilteredChildren,!0,!0),e.updateChildrenIndices(e.children,!1,!0),n||Boolean(e.children.length)):n}},{key:"traverseClearFilter",value:function(e){var t=this;e.unfilteredChildren&&(e.children=e.unfilteredChildren.slice(),e.unfilteredChildren=null),e.children&&(e.children.forEach((function(e){return t.traverseClearFilter(e)})),e.updateChildrenIndices(e.children,!1,!0))}},{key:"latestFilterField",get:function(){return this.filters.last?this.filters.last.property:null}},{key:"addFilter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(e=e instanceof zo?e:new zo(e)).owner=this,this.filters.add(e),t||this.filter(),e}},{key:"filter",value:function(e){var t=this,n=t.filters,r=!1;if(e){var i=I()(e);if("object"===i&&("silent"in e||"replace"in e)&&(r=e.silent,e.replace&&n.clear(),e=e.filters,i=I()(e)),e&&(t.isConfiguring=!0,Array.isArray(e)?e.forEach((function(e){return t.addFilter(e,!0)}),t):"function"===i?t.addFilter(new zo(e),!0):"string"===i?t.addFilter({property:e,value:arguments[1]},!0):t.addFilter(e,!0),t.isConfiguring=!1,!t.isFiltered))return}t.filtersFunction=null,t.performFilter(r)}},{key:"performFilter",value:function(e){var t=this,n=t.storage,r=t.filters,i=t.rootNode,o=t.count;t.trigger("beforeFilter",{filters:r}),t.tree?(t.isFiltered?t.traverseFilter(i):t.traverseClearFilter(i),n.replaceValues({values:t.collectDescendants(i).visible,silent:!0})):t.isFiltered?n.addFilter({id:"primary-filter",filterBy:t.filtersFunction}):n.filters.clear(),t.afterPerformFilter(e?null:{action:"filter",filters:r,oldCount:o,records:t.storage.values})}},{key:"afterPerformFilter",value:function(e){this.resetRelationCache(),e&&this.triggerFilterEvent(e)}},{key:"filtered",get:function(){return this.storage.isFiltered}},{key:"triggerFilterEvent",value:function(e){this.trigger("filter",e),this.remoteFilter||(this.trigger("refresh",e),this.trigger("change",e))}},{key:"filterBy",value:function(e){this.filter(e)}},{key:"removeFilter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=e instanceof zo?e:n.filters.get(e);if(r)return n.filters.remove(r),n._filtersFunction=null,t||n.filter(),r}},{key:"clearFilters",value:function(){this.filters.clear(),this.filter()}},{key:"convertFilterToString",value:function(e){var t=this.filters.getBy("property",e);return t&&!t.filterBy?String(t):""}},{key:"doDestroy",value:function(){var e;null===(e=this._filters)||void 0===e||e.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}}],[{key:"$name",get:function(){return"StoreFilter"}},{key:"defaultConfig",get:function(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}}]),n}(e||$e)};function ga(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var ya={add:1,replace:1},ma=function(e){return function(e){Ye()(n,e);var t=ga(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e),this.on("change",this.onDataChanged)}},{key:"groupers",get:function(){return this._groupers},set:function(e){var t=this;e&&e.length?t._groupers=e:t.groupers&&(delete t._groupers,t.groupRecords.forEach((function(e){e.meta.collapsed&&t.includeGroupRecords(e)})),t.storage.replaceValues({values:t.removeHeadersAndFooters(t.storage._values),filteredValues:t.storage.isFiltered?t.removeHeadersAndFooters(t.storage._filteredValues):null,silent:!0}),t.group(null,null,null,!1),"groupRecords"in t&&delete t.groupRecords),this._idMap=null}},{key:"storeCollapsedGroups",value:function(){var e=this;return e.collapsedGroupsHash={},!(!e.groupRecords||!e.groupRecords.length)&&(e.groupRecords.forEach((function(t){e.expand(t)&&(e.collapsedGroupsHash[t.id]=!0)})),!0)}},{key:"restoreCollapsedGroups",value:function(){var e=this,t=e.collapsedGroupsHash;t&&Object.keys(t).forEach((function(t){return e.collapse(e.getById(t))}))}},{key:"onDataChange",value:function(e){var t=e.source,r=e.action,i=e.removed,o=this,a=o.groupers;if(a){var s=t.values;a.length?"splice"===r&&i&&i.length&&(o.storeCollapsedGroups()&&o.storage.replaceValues({values:o.removeHeadersAndFooters(s),silent:!0}),o.storage.replaceValues({values:o.prepareGroupRecords(s),silent:!0}),o.restoreCollapsedGroups()):t.replaceValues({values:o.removeHeadersAndFooters(s),silent:!0})}tt()(Ze()(n.prototype),"onDataChange",this)&&tt()(Ze()(n.prototype),"onDataChange",this).apply(this,arguments)}},{key:"collapse",value:function(e){return!(!e||e.meta.collapsed)&&(this.excludeGroupRecords(e),e.meta.collapsed=!0,!0)}},{key:"expand",value:function(e){return!(!e||!e.meta.collapsed)&&(this.includeGroupRecords(e),e.meta.collapsed=!1,!0)}},{key:"removeHeadersAndFooters",value:function(e){var t=this;return e.filter((function(e){return!e.isSpecialRow||(t.unregister(e),!1)}),!0)}},{key:"prepareGroupRecords",value:function(e){var t=this;if(e=t.removeHeadersAndFooters(e),!t.isGrouped)return e;var n=[],r=t.groupers[0].field,i=[],o=null,a=null,s=0;function l(){var e=a.meta.groupRowFor,r="group-footer-".concat("number"==typeof e?e:te.createId(e)),o=t.getById(r)||new t.modelClass({id:r},t,{specialRow:!0,groupFooterFor:e,groupRecord:a});return o.stores=[t],t.register(o),o.groupChildren=a.groupChildren,i.push(o),n.push(o),t.allRecords.push(o),a.groupChildren.push(o),s++,o}return e.forEach((function(e){var u=null==e[r]?"__novalue__":e[r],c="group-header-".concat("number"==typeof u?u:te.createId(u));!e.groupChildren||e.groupChildren.length?(Qn.isEqual(u,o)||(a&&(t.useGroupFooters&&l(),a.meta.childCount=s),(a=t.getById(c)||new t.modelClass({id:c},t,{specialRow:!0,groupRowFor:u,groupField:r})).stores=[t],t.register(a),a.groupChildren=[],n.push(a),t.allRecords.push(a),i.push(a),o=u,s=0),e.instanceMeta(t.id).groupParent=a,n.push(e),a.groupChildren.push(e),s++):t.unregister(e)})),a&&(t.useGroupFooters&&l(),a.meta.childCount=s),t.groupRecords=i,n}},{key:"isGrouped",get:function(){return Boolean(this.groupers&&this.groupers.length)}},{key:"group",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this;if(e&&"object"===I()(e)&&(t=e.ascending,r=e.fn,e=e.field),i)s.groupers.push(n={field:e,ascending:t,complexMapping:e.includes(".")});else if(e){var l,u;if(null==t)t=(null===(l=s.groupInfo)||void 0===l?void 0:l.field)!==e||(null===(u=s.groupInfo)||void 0===u?void 0:u.fn)!==r||!s.groupInfo.ascending;s.groupInfo=n={field:e,ascending:t,fn:r,complexMapping:e.includes(".")},s.groupers=[s.groupInfo]}if(n){var c=s.modelClass.prototype;n.complexMapping&&!Object.prototype.hasOwnProperty.call(c,e)&&Object.defineProperty(c,e,{get:function(){return Qn.getPath(this,e)}})}!1!==o&&s.sort(null,null,!1,!0),a||(s.trigger("group",{isGrouped:s.isGrouped,groupers:s.groupers,records:s.storage.values}),s.trigger("refresh",{action:"group",isGrouped:s.isGrouped,groupers:s.groupers,records:s.storage.values}))}},{key:"addGrouper",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.group(e,t,!0)}},{key:"removeGrouper",value:function(e){var t=this,n=t.groupers.findIndex((function(t){return t.field===e}));n>-1&&(t.groupers.splice(n,1),t.groupers.length?t.group():t.clearGroupers())}},{key:"clearGroupers",value:function(){this.groupers=null}},{key:"isRecordInGroup",value:function(e,t){if(!this.isGrouped)return null;return e[this.groupers[0]&&this.groupers[0].field]===t&&!e.isSpecialRow}},{key:"isInCollapsedGroup",value:function(e){var t=e.instanceMeta(this).groupParent;return t&&t.meta.collapsed}},{key:"getGroupRecords",value:function(e){var t=this;return t.isGrouped?t.storage.values.filter((function(n){return t.isRecordInGroup(n,e)})):null}},{key:"getGroupTitles",value:function(){var e=this;return e.isGrouped?e.getDistinctValues(e.groupers[0]&&e.groupers[0].field):null}},{key:"onDataChanged",value:function(e){var t=e.changes,n=e.action;this.isGrouped&&(!t&&ya[n]||t&&this.groupers.some((function(e){return e.field in t})))&&this.sort()}},{key:"internalIncludeExcludeGroupRecords",value:function(e,t){var n=this,r=n.indexOf(e),i=n.id;if(-1!==r&&!(e.meta.collapsed&&!t||!e.meta.collapsed&&t)){if(e.groupChildren.forEach((function(e){return e.instanceMeta(i).hiddenByCollapse=!t})),t){var o,a=e.groupChildren.filter((function(e){return!n.isAvailable(e)}));(o=n.storage.values).splice.apply(o,[r+1,0].concat(F()(a)))}else n.storage.values.splice(r+1,e.groupChildren.length);n.storage._indicesInvalid=!0,n._idMap=null}}},{key:"excludeGroupRecords",value:function(e){this.internalIncludeExcludeGroupRecords(e,!1)}},{key:"includeGroupRecords",value:function(e){this.internalIncludeExcludeGroupRecords(e,!0)}},{key:"collectGroupRecords",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e?this.storage.allValues:this.storage.values;return n.reduce((function(e,n){return n.isSpecialRow&&(t&&e.push(n),"groupRowFor"in n.meta&&e.push.apply(e,n.groupChildren)),e}),[])}}],[{key:"$name",get:function(){return"StoreGroup"}},{key:"defaultConfig",get:function(){return{groupers:null}}}]),n}(e||$e)};function ba(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var wa=function(e){return function(e){Ye()(n,e);var t=ka(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"initProxy",value:function(){if(!pe.a.global.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get:function(e,t){if(t in e)return e[t];if("$store"===t)return e;var n=e.getById(t);return n||isNaN(parseInt(t))||(n=e.getAt(parseInt(t))),n},set:function(e,t,n){return t in e||e.isDestroying?e[t]=n:e.add(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ba(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ba(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(Qe()({},e.modelClass.idField,t),n)),!0},deleteProperty:function(e,t){return e.isDestroying?(delete e[t],!0):Boolean(e.remove(t).length)},has:function(e,t){if(t in e)return!0;if(t.startsWith("{")&&t.endsWith("}")){var n=te.safeJsonParse(t);t=null==n?void 0:n.id}return e.includes(t)}})}}],[{key:"configurable",get:function(){return{objectify:null}}}]),n}(e||$e)};function Ca(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Ra=function(e){return function(e){Ye()(n,e);var t=Ca(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"initRelations",value:function(e){var t=this,n=t.modelClass.relations;e&&t.modelRelations&&t.modelRelations.forEach((function(e){e.storeDetacher&&e.storeDetacher()})),t.modelRelations&&0!==t.modelRelations.length&&!e||!n||(t.modelRelations=[],n&&n.forEach((function(n){var r=Object.assign({},n),i="string"==typeof r.store?t[r.store]:r.store;if(r.dependentStore=t,t.modelRelations.push(r),i){r.storeProperty=r.store,r.store=i;var o=i.dependentStoreConfigs;if(o.has(t)){var a=o.get(t);if(e){var s=a.find((function(e){return e.relationName===r.relationName}));s&&it.remove(a,s)}a.push(r)}else o.set(t,[r]);r.collectionName&&i.initRelationCollection(r,t),i.count>0&&i.updateDependentStores("dataset",i.records)}})))}},{key:"initRelationCollection",value:function(e,t){var n=this,r=e.collectionName;n.collectionStores||(n.collectionStores={}),n.collectionStores[r]={store:t,config:e},n[r+"Store"]||(n[r+"Store"]=t),n.count>0&&n.initModelRelationCollection(r,n.records)}},{key:"initModelRelationCollection",value:function(e,t){var n=this;t.forEach((function(t){t.traverse((function(t){var r=e in t?"$related".concat(te.capitalize(e)):e;Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:function(){return n.getCollection(this,e)},set:function(t){return n.setCollection(this,e,t)}})}))}))}},{key:"resetRelationCache",value:function(){this.relationCache={},this.forEach((function(e){return e.initRelations()}))}},{key:"updateRecordRelationCache",value:function(e,t){var n=this;t&&t.forEach((function(t){var r=t.related?t.related.id:e.get(t.config.fieldName);void 0!==r&&n.cacheRelatedRecord(e,r,t.config.relationName,r)}))}},{key:"getRelationCollection",value:function(e,t){var n=Lo.asId(t);return this.relationCache[e]&&this.relationCache[e][n]||[]}},{key:"getCollection",value:function(e,t){var n=this.collectionStores[t],r=n.config,i=n.store;return i.relationCache[r.relationName]&&i.relationCache[r.relationName][e.id]||[]}},{key:"setCollection",value:function(e,t,n){var r=this.collectionStores[t],i=r.config,o=r.store;o.relationCache[i.relationName]||(o.relationCache[i.relationName]={});var a=(o.relationCache[i.relationName][e.id]||[]).slice(),s=[],l=[];o.suspendEvents(),a.forEach((function(e){n.includes(e)||(e[i.fieldName]=null,o.remove(e),l.push(e))})),n.forEach((function(t){if(t instanceof Lo)t.stores.includes(o)||(o.add(t),s.push(t));else{var n=o.add(t);t=N()(n,1)[0],s.push(t)}t[i.fieldName]=e.id})),o.resumeEvents(),l.length&&(o.trigger("remove",{records:l}),o.trigger("change",{action:"remove",records:l})),s.length&&(o.trigger("add",{records:s}),o.trigger("change",{action:"add",records:s}))}},{key:"cacheRelatedRecord",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this,o=i.relationCache[n]||(i.relationCache[n]={});null!==r&&i.uncacheRelatedRecord(e,n,r),null!=t&&it.include(o[t]||(o[t]=[]),e)}},{key:"uncacheRelatedRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this;function i(t,n){var i=r.relationCache[t],o=i&&i[n];if(o){var a=o.indexOf(e);a>=0&&o.splice(a,1),0===o.length&&delete i[n]}}null!=n?i(t,n):e.meta.relationCache&&Object.entries(e.meta.relationCache).forEach((function(e){var t=N()(e,2),n=t[0],r=t[1];i(n,r&&r.id)}))}},{key:"updateDependentStores",value:function(e,t){var n=this;this.dependentStoreConfigs.forEach((function(r){r.forEach((function(r){var i=r.dependentStore,o=i.relationCache[r.relationName];return"dataset"===e?(r.collectionName&&n.initModelRelationCollection(r.collectionName,t),void i.forEach((function(e){var t=e.initRelation(r);t&&i.cacheRelatedRecord(e,t.id,r.relationName,t.id)}))):"removeall"===e?(i.forEach((function(e){e.removeRelation(r)})),void delete i.relationCache[r.relationName]):("add"===e&&r.collectionName&&n.initModelRelationCollection(r.collectionName,t),void("add"!==e&&"remove"!==e||t.forEach((function(t){var n=o&&o[t.id];switch(e){case"remove":n&&n.forEach((function(e){return e.removeRelation(r)}));break;case"add":i.forEach((function(e){e.get(r.fieldName)==t.id&&(e.initRelation(r),i.cacheRelatedRecord(e,t.id,r.relationName))}))}}))))}))}))}},{key:"updateDependentRecordIds",value:function(e,t){this.dependentStoreConfigs&&this.dependentStoreConfigs.forEach((function(n){n.forEach((function(n){var r=n.dependentStore,i=r.relationCache[n.relationName],o=i&&i[e]&&i[e].slice();o&&o.forEach((function(i){r.cacheRelatedRecord(i,t,n.relationName,e),i.set(n.fieldName,t,!1,!0)}))}))}))}}],[{key:"$name",get:function(){return"StoreRelation"}}]),n}(e||$e)};function Sa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var xa=function(e){return function(e){Ye()(n,e);var t=Sa(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"sum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t?t.reduce((function(t,n){if(n.isSpecialRow)return t;var r=Number(n[e]);return isNaN(r)?t:t+r}),0):0}},{key:"min",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t&&t.length?t.reduce((function(t,n){var r;return"number"===I()(null===(r=n[e])||void 0===r?void 0:r.valueOf())&&n[e]<t&&(t=n[e]),t}),t[0][e]):0}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t&&t.length?t.reduce((function(t,n){var r;return"number"===I()(null===(r=n[e])||void 0===r?void 0:r.valueOf())&&n[e]>t&&(t=n[e]),t}),t[0][e]):0}},{key:"average",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;if(!t||!t.length)return 0;var n=0,r=t.reduce((function(t,r){if(r.isSpecialRow)return t;var i=parseFloat(r[e]);return isNaN(i)?t:(n++,t+i)}),0);return n>0?r/n:0}},{key:"groupSum",value:function(e,t){return this.sum(t,this.getGroupRecords(e))}}],[{key:"$name",get:function(){return"StoreSum"}}]),n}(e||$e)};function Ea(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Da(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Da(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Da(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Oa=function(e,t){return-1!==String(e).toLowerCase().indexOf(t)},Ma={string:Oa,number:Oa,boolean:Oa,date:function(e,t){return e instanceof Date&&t instanceof Date?String(e)===String(t):-1!==String(e.getMonth()+1).indexOf(t)||-1!==String(e.getDate()).indexOf(t)||-1!==String(e.getFullYear()).indexOf(t)}},Aa=function(e){return function(e){Ye()(n,e);var t=Ta(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"search",value:function(e){var t,n,r,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.storage.values,l=s.length,u=[];if(null==e)return null;for("string"==typeof e&&(e=String(e).toLowerCase()),t=0;t<l;t++){n=s[t];var c,f=Ea(a||n.fieldNames);try{for(f.s();!(c=f.n()).done;){var d=c.value;i=(r=n[d])instanceof Date?"date":I()(r),o=Ma[i],r&&o&&o(r,e)&&u.push({index:t,data:n,field:d,id:n.id})}}catch(e){f.e(e)}finally{f.f()}}return u}},{key:"findByField",value:function(e,t){var n,r,i,o=this.storage.values,a=o.length,s=[];for(null!=t&&(t=String(t).toLowerCase()),n=0;n<a;n++){r=o[n];var l=(i=r[e])instanceof Date?"date":I()(i),u={date:function(){return Boolean(i)&&i.toLocaleString().includes(t)},string:function(){return Boolean(i)&&i.toLowerCase().includes(t)},number:function(){return"number"==typeof i&&i.toString().includes(t)},object:function(){return i===t},undefined:function(){return i===t}};(null==t&&i===t||t&&u[l]())&&s.push({id:r.id,index:n,data:r})}return s}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?this.storage.allValues:this.storage.values;return this.isGrouped&&(n=this.collectGroupRecords(t,!1)),n.find(e)}},{key:"findRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(n){return Qn.isEqual(n[e],t)};return this.tree?this.query(r)[0]:(n?this.storage.allValues:this.storage.values).find(r)}},{key:"query",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?this.storage.allValues:this.storage.values;if(this.isTree){var r=[];return this.traverse((function(t){e(t)&&r.push(t)}),void 0,void 0,t),r}return this.isGrouped&&(n=this.collectGroupRecords(t,!1)),n.filter(e)}},{key:"some",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?this.storage.allValues:this.storage.values;return this.isGrouped&&(n=this.collectGroupRecords(t,!1)),n.some(e)}}],[{key:"$name",get:function(){return"StoreSearch"}}]),n}(e||$e)};function Ia(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Pa=function(e){return function(e){Ye()(n,e);var t=Ia(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"isSorted",get:function(){return Boolean(this.sorters.length)||this.isGrouped}},{key:"updateReapplySortersOnAdd",value:function(e){this.storage.autoSort=e}},{key:"sort",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=o.allRecords,s=o.sorters?o.sorters.slice():[],l=null;if(e)if(Array.isArray(e))o.sorters=e.map((function(e){return o.normalizeSorterConfig(e,"string"==typeof e||t)}));else{var u=o.normalizeSorterConfig(e,t);r?(n=o.getCurrentSorterByField(u.field))?(l=n.ascending,n.ascending=u.ascending):o.sorters.push(u):o.sorters=[u]}return i||!1!==o.trigger("beforeSort",{sorters:o.sorters,records:a,currentSorters:s})?o.performSort(i):(o.sorters=s,void(null!==l&&(n.ascending=l)))}},{key:"normalizeSorterConfig",value:function(e,t){var n,r={ascending:t};"object"===I()(e)?(Qn.assign(r,e),e.fn&&(delete r.fn,r.sortFn=e.fn),r.ascending=null!==(n=e.ascending)&&void 0!==n?n:t):"function"==typeof e?r.sortFn=e:r.field=e;if(null==r.ascending){var i=this.getCurrentSorterByField(r.field);r.ascending=!i||!i.ascending}if(null==r.sortFn){var o,a,s=null===(o=this.modelClass)||void 0===o||null===(a=o.$meta.fields.map[r.field])||void 0===a?void 0:a.compareItems;s&&(r.sortFn=s)}return r}},{key:"getCurrentSorterByField",value:function(e){return"string"==typeof e&&this.sorters.find((function(t){return t.field===e}))||null}},{key:"addSorter",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.sort(e,t,!0)}},{key:"removeSorter",value:function(e){var t=this.sorters.findIndex((function(t){return t.field===e||t.sortFn===e}));t>-1&&(this.sorters.splice(t,1),this.sort())}},{key:"clearSorters",value:function(){this.sorters.length=0,this.sort()}},{key:"createSorterFn",value:function(e){var t=this.useLocaleSort;return function(n,r){for(var i=0;i<e.length;i++){var o=e[i],a=o.field,s=o.ascending,l=void 0===s||s,u=o.useLocaleSort,c=void 0===u?t:u,f=o.fn||o.sortFn,d=l?1:-1;if(f){var h=f(n,r);if(null!==h)return h*d}var v=n[a],p=r[a];if(v!==p){if(null==v)return-d;if(null==p)return d;if(c){if(!0===c)return String(v).localeCompare(p)*d;if("string"==typeof c)return String(v).localeCompare(p,c)*d;if("object"===I()(c))return String(v).localeCompare(p,c.locale,c)*d}if(v>p)return d;if(v<p)return-d}}return 0}}},{key:"performSort",value:function(e){var t=this,n=t.rootNode,r=t.storage,i=t.sorters,o=t.createSorterFn(t.isGrouped?t.groupers.concat(i):i);t.isGrouped&&t.storeCollapsedGroups()&&r.replaceValues({values:t.removeHeadersAndFooters(r.values),silent:!0}),t.tree?(n.traverse((function(e){e.isLoaded&&e.isParent&&(e.children.sort(o),e.updateChildrenIndices(e.children,!1,!0))})),r.replaceValues({values:t.collectDescendants(n).visible,silent:!0})):r.replaceValues({values:r.values.sort(o),silent:!0}),t.afterPerformSort(e)}},{key:"afterPerformSort",value:function(e){var t=this,n=t.storage;if(t._idMap=null,t.isGrouped&&(n.replaceValues({values:t.prepareGroupRecords(n.values),silent:!0}),t.restoreCollapsedGroups()),!e){var r={action:"sort",sorters:t.sorters,records:t.allRecords};t.trigger("sort",r),t.sortParamName||t.trigger("refresh",r)}}}],[{key:"$name",get:function(){return"StoreSort"}},{key:"defaultConfig",get:function(){return{sorters:[],useLocaleSort:null}}},{key:"configurable",get:function(){return{reapplySortersOnAdd:!1}}}]),n}(e||$e)};function Fa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var La=function(){return!0},Ba=function(e){return function(e){Ye()(n,e);var t=Fa(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e);var t=this,r=t.masterStore;r&&(t.methodNamesToRelay.forEach((function(e){return t[e]=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.relayToMaster(e,r)}})),t.removeAll=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];r.remove.apply(r,[t.getRange()].concat(n))},r.on({changePreCommit:t.onMasterDataChangedPreCommit,change:t.onMasterDataChanged,prio:1,thisObj:t}),r.chainedStores||(r.chainedStores=[]),r.chainedStores.push(t),t.fillFromMaster())}},{key:"isChained",get:function(){return Boolean(this.masterStore)}},{key:"chainedFilterFn",get:function(){return this._chainedFilterFn||La},set:function(e){this._chainedFilterFn=this.thisObj?e.bind(this.thisObj):e}},{key:"methodNamesToRelay",get:function(){var e=this,t=Array.isArray(this.doRelayToMaster),n=Array.isArray(this.dontRelayToMaster);return t&&this.doRelayToMaster.filter((function(t){return!n||!e.dontRelayToMaster.includes(t)}))||[]}},{key:"updateChainedStores",value:function(){this.chainedStores&&this.chainedStores.forEach((function(e){return e.fillFromMaster()}))}},{key:"fillFromMaster",value:function(){var e=this,t=e.masterStore,n=e.isTree;if(!e.isChained)throw new Error("fillFromMaster only allowed on chained store");if(e.keepUncommittedChanges){if(n)throw new Error("Cannot use keepUncommittedChanges on a chained tree store");e.data=[].concat(e.added.values.filter((function(t){return!e.removed.includes(t)})),t.allRecords.filter((function(t){return!e.removed.includes(t)&&!e.added.includes(t)&&e.chainedFilterFn(t)})))}else{var r=t.allRecords.filter(e.chainedFilterFn);if(n&&(e.idRegister={},e.internalIdRegister={},r.forEach((function(t){t.stores.includes(e)?e.register(t):t.joinStore(e)})),e.excludeCollapsedRecords)){var i=e.getChildren(e.rootNode);r=e.doIncludeExclude(i,!0)}e.data=r}}},{key:"commitToMaster",value:function(){var e=this,t=e.masterStore;if(!e.isChained)throw new Error("commitToMaster only allowed on chained store");return t.beginBatch(),t.remove(e.removed.values),t.add(e.added.values),t.endBatch(),e.commit()}},{key:"relayToMaster",value:function(e,t){var n;return(n=this.masterStore)[e].apply(n,F()(t))}},{key:"onMasterDataChangedPreCommit",value:function(e){this.onMasterDataChanged(e),this.$masterEventhandled=!0}},{key:"onMasterDataChanged",value:function(e){var t,n=e.action,r=e.changes;e.$handled;this.$masterEventhandled?this.$masterEventhandled=!1:("update"!==n||null!==(t=this.chainedFields)&&void 0!==t&&t.some((function(e){return e in r})))&&this.fillFromMaster()}},{key:"makeChained",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return new this.constructor(Object.assign(n||{},{tree:!1,autoTree:!1,masterStore:this,modelClass:this.modelClass,chainedFilterFn:e,chainedFields:t}))}},{key:"chain",value:function(){return this.makeChained.apply(this,arguments)}},{key:"doDestroy",value:function(){var e;null===(e=this.chainedStores)||void 0===e||e.forEach((function(e){return e.destroy()})),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}}],[{key:"$name",get:function(){return"StoreChained"}},{key:"defaultConfig",get:function(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],keepUncommittedChanges:!1,excludeCollapsedRecords:!0}}},{key:"properties",get:function(){return{chainedStores:null}}}]),n}(e||$e)};function ja(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var _a=function(e){return function(e){Ye()(n,e);var t=ja(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getState",value:function(){var e=this.sorters,t=this.groupers,n=this.filters,r={};return null!=e&&e.length&&(r.sorters=e.map((function(e){var t=Qn.cleanupProperties(Qn.clone(e));return delete t.fn,delete t.sortFn,t}))),null!=t&&t.length&&(r.groupers=t.slice()),null!=n&&n.values.length&&(r.filters=n.values.map((function(e){var t=Qn.cleanupProperties(Qn.clone(e.config));return t.value=e.value,t.caseSensitive&&delete t.caseSensitive,t}))),r}},{key:"applyState",value:function(e){var t=this,n=e.sorters,r=void 0===n?[]:n,i=e.groupers,o=void 0===i?[]:i,a=e.filters,s=void 0===a?[]:a;t.sorters=r.slice(),t.groupers=o.slice(),t.sort(),t.filters=s.slice(),t.filter()}}],[{key:"$name",get:function(){return"StoreState"}}]),n}(e||$e)};function Ha(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Na(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Na(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Na(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function za(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Va=Object.freeze([]),Wa=function(e){return function(e){Ye()(i,e);var t,n,r=za(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"isTree",get:function(){return this.tree||this.masterStore&&this.masterStore.tree}},{key:"leaves",get:function(){var e=this,t=[];return e.isTree?(e.traverse((function(e){e.isLeaf&&t.push(e)})),t):(e.allRecords.forEach((function(e){e.isLeaf&&t.push(e),e.traverse((function(e){e.isLeaf&&t.push(e)}),!0)})),t)}},{key:"loadChildren",value:(n=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"onNodeAddChild",value:function(e,t,n,r){var i,o,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this,l=e===s.rootNode&&e.isLoading,u=s.storage,c=[],f=[],d=t[0].previousSibling;if(s.collectDescendants(t,c,f,{inCollapsedBranch:!(e.isExpanded(s)&&e.ancestorsExpanded(s))}),!l&&f.length){var h,v=Ha(f);try{for(v.s();!(h=v.n()).done;){var p=h.value;s.modified.includes(p)||r[p.id]||(s.removed.includes(p)?s.removed.remove(p):s.added.add(p))}}catch(e){v.e(e)}finally{v.f()}}if(l&&s.rootVisible&&(c.unshift(e),f.unshift(e)),c.length&&(i=0!==n&&d?u.indexOf(d)+d.getDescendantCount(!0,s):u.indexOf(e),u.suspendEvents(),s.storage.splice(++i,0,c),u.resumeEvents()),s.updateDependentStores("add",t),l&&c.length){if(s.sorters.length&&s.sort(null,null,!1,!0),null===(o=s.afterLoadData)||void 0===o||o.call(s),!a){var g={action:"dataset",data:s._data,records:c};s.trigger("refresh",g),s.trigger("change",g)}}else if(!a){var y={action:"add",parent:e,isChild:!0,isMove:r,records:t,allRecords:f,index:i};s.trigger("add",y),s.trigger("change",y)}}},{key:"onNodeRemoveChild",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{isMove:!1,silent:!1,unfiltered:!1},i=this,o=i.storage,a=[],s=[],l=r.isMove,u=r.silent,c=r.unfiltered,f=c&&i.isFiltered,d=f&&e.unfilteredChildren?e.unfilteredChildren:t;if(i.collectDescendants(d,a,s,{inCollapsedBranch:!(e.isExpanded(i)&&e.ancestorsExpanded(i)),unfiltered:f}),!l){var h,v=Ha(t);try{for(v.s();!(h=v.n()).done;){var p=h.value;p.unjoinStore(i)}}catch(e){v.e(e)}finally{v.f()}if(s.length){var g,y=Ha(s);try{for(y.s();!(g=y.n()).done;){var m=g.value;m.stores.includes(i)&&m.unjoinStore(i),i.added.includes(m)?i.added.remove(m):i.removed.add(m)}}catch(e){y.e(e)}finally{y.f()}i.modified.remove(s)}}if(a.length?(n=o.indexOf(a[0]))>-1&&(o.suspendEvents(),o.splice(n,a.length),o.resumeEvents()):n=-1,!u){var b={action:"remove",parent:e,isChild:!0,isMove:l,records:t,allRecords:s,index:n};i.trigger("remove",b),i.trigger("change",b)}}},{key:"collectDescendants",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{inCollapsedBranch:!1,unfiltered:!1},i=this,o=r.inCollapsedBranch,a=r.unfiltered,s=Array.isArray(e)?e:i.getChildren(e,a);if(s)for(var l,u=0,c=s.length;u<c;u++)l=s[u],o||t.push(l),n.push(l),i.collectDescendants(l,t,n,{inCollapsedBranch:o||!l.isExpanded(i),unfiltered:a});return{visible:t,all:n}}},{key:"getChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(t||this.isChained)&&e.unfilteredChildren||e.children;return n&&n.length?this.isChained?n.filter(this.chainedFilterFn):n:Va}},{key:"internalToggleTreeSubRecords",value:function(e,t){var n=this,r=n.storage,i=r.indexOf(e),o=n.doIncludeExclude(n.getChildren(e),t);if(n.isFiltered&&t&&e.unfilteredChildren&&n.updateChildrenHiddenState(e),o.length&&!1!==i){if(r.suspendEvents(),t){r.splice.apply(r,[i+1,0].concat(F()(o)));var a={action:"add",isExpand:!0,records:o,index:i+1};n.trigger("add",a),n.trigger("change",a)}else{r.splice(i+1,o.length);var s={action:"remove",isCollapse:!0,records:o,index:i+1};n.trigger("remove",s),n.trigger("change",s)}r.resumeEvents()}}},{key:"updateChildrenHiddenState",value:function(e){var t,n=this;null===(t=e.unfilteredChildren)||void 0===t||t.forEach((function(e){e.instanceMeta(n.id).hidden=!1,e.isLeaf||n.updateChildrenHiddenState(e)}))}},{key:"doIncludeExclude",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this,i=(null==e?void 0:e.length)||0,o=0;o<i;o++){var a=e[o];if(!r.isChained||r.chainedFilterFn(a)){var s=a.instanceMeta(r.id);!t&&s.hidden||n.push(a),s.hidden=!t,a.isExpanded(r)&&r.doIncludeExclude(r.getChildren(a),t,n)}}return n}},{key:"toggleCollapse",value:(t=Pt()(At.a.mark((function e(t,n){var r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(r=this).getById(t),o=i.instanceMeta(r),void 0===n&&(n=!o.collapsed),o.isLoadingChildren||i.isLeaf||i.isExpanded(r)!==n){e.next=28;break}if(r.trigger("beforeToggleNode",{record:i,collapse:n}),o.collapsed=n,!o.collapsed){e.next=10;break}return r.onNodeCollapse(i),e.abrupt("return",!0);case 10:if(r.onNodeExpand(i),a=!0,i.isLoaded){e.next=27;break}return o.isLoadingChildren=!0,e.prev=14,e.next=17,r.loadChildren(i);case 17:e.next=24;break;case 19:e.prev=19,e.t0=e.catch(14),o.collapsed=!0,a=!1,r.trigger("loadChildrenException",{record:i,exception:e.t0});case 24:return e.prev=24,o.isLoadingChildren=!1,e.finish(24);case 27:return e.abrupt("return",a);case 28:case"end":return e.stop()}}),e,this,[[14,19,24,27]])}))),function(e,n){return t.apply(this,arguments)})},{key:"onNodeCollapse",value:function(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!1)}},{key:"onNodeExpand",value:function(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!0)}},{key:"transformToTree",value:function(e){var t,n=this.modelClass,r=n.parentIdField,i=n.idField,o=n.childrenField,a=new Map,s=[],l=Ha(e);try{var u=function(){var n=t.value,l=n[r];if(null!=l){var u,c=a.get(l);if(void 0===c)c=null!==(u=e.find((function(e){return e[i]===l})))&&void 0!==u?u:null,a.set(l,c);c&&(c[o]||(c[o]=[]),c[o].push(n))}else s.push(n)};for(l.s();!(t=l.n()).done;)u()}catch(e){l.e(e)}finally{l.f()}return s}}],[{key:"$name",get:function(){return"StoreTree"}},{key:"configurable",get:function(){return{transformFlatData:null}}}]),i}(e||$e)},$a=function(){function e(){B()(this,e)}return _()(e,null,[{key:"preWalk",value:function(e,t,n){for(var r,i,o=[e];o.length;)n(r=o.pop()),(i=t(r))&&o.push.apply(o,i.slice().reverse())}},{key:"preWalkWithParent",value:function(e,t,n){for(var r=[{node:e,parent:null}],i=function(){var e=r.pop(),i=e.parent,o=e.node;n(i,o);var a=t(o);a&&r.push.apply(r,F()(a.slice().reverse().map((function(e){return{node:e,parent:o}}))))};r.length;)i()}},{key:"preWalkUnordered",value:function(e,t,n){for(var r,i,o=[e];o.length;)n(r=o[o.length-1]),(i=t(r))?o.splice.apply(o,[o.length-1,1].concat(F()(i))):o.length=o.length-1}},{key:"postWalk",value:function(e,t,n){for(var r,i,o=new Map,a=[e];a.length;)r=a[a.length-1],o.has(r)?(n(r),a.pop()):((i=t(r))&&(a=a.concat(i.slice().reverse())),o.set(r,r))}},{key:"prePostWalk",value:function(e,t,n,r){for(var i,o,a=new Map,s=[e];s.length;)i=s[s.length-1],a.has(i)?(r(i),s.pop()):(n(i),(o=t(i))&&(s=s.concat(o.slice().reverse())),a.set(i,i))}}]),e}();function Ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ga(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ua(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ya(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}$a._$name="WalkHelper";var qa=function(e){return function(e){Ye()(n,e);var t=Ya(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"syncDataset",value:function(e){var t=this,n=t.storage,r=t.tree?t.syncTreeDataset(e):t.syncFlatDataset(e),i=r.toAdd,o=r.toRemove,a=r.updated,s=t.syncDataOnLoad.threshold,l=!1;if(s&&("string"==typeof s&&(s=parseInt(s,10)/100*t.count),l=i.length+o.length+a.length>s),t.tree){if(i.length)t.add(i,l).forEach((function(e){return e.clearParentId()}));t.remove(o,l)}else l&&t.suspendEvents(),t.remove(o),t.add(i),l&&t.resumeEvents();s&&!l&&a.forEach((function(e){var n=e.record,r=e.toSet,i=e.wasSet;return t.onModelChange(n,r,i)})),t.acceptChanges();var u={added:i,removed:o,updated:a,thresholdSurpassed:l};l&&this.trigger("refresh",{action:"batch",data:e,records:n.values,syncInfo:u}),t.isFiltered&&t.filter(),t.isGrouped?t.group():t.isSorted&&t.sort(),t.trigger("loadSync",u)}},{key:"syncFlatDataset",value:function(e){if(e){var t=this,n=t.modelClass.idField,r=[],i=[],o=[],a={},s=t.syncDataOnLoad.threshold,l=0;return e.forEach((function(e){var r=e[n],u=t.getById(r);if(u){var c=u.set(e,null,Boolean(s));c&&o.push({record:u,wasSet:c,toSet:e}),l++}else i.push(t.processRecord(t.createRecord(e)));a[r]=1})),l<t.allCount&&t.forEach((function(e){a[e.id]||r.push(e)})),{toAdd:i,toRemove:r,updated:o}}}},{key:"syncTreeDataset",value:function(e){if(e){var t=this,n=t.modelClass,r=n.idField,i=n.parentIdField,o=[],a=[],s=[],l={},u=t.syncDataOnLoad.threshold;return $a.preWalkWithParent({isRoot:!0,children:e},(function(e){return e.children}),(function(e,n){if(e){var o=n[r],c=t.getById(o);if(c){var f=c.set(n,null,Boolean(u));f&&s.push({record:c,wasSet:f,toSet:n})}else n[i]=e[r],a.push(Ga(Ga({},n),{},{children:[]}));l[o]=1}})),t.traverse((function(e){l[e.id]||o.push(e)})),{toAdd:a,toRemove:o,updated:s}}}}],[{key:"$name",get:function(){return"StoreSync"}},{key:"defaultConfig",get:function(){return{syncDataOnLoad:null}}}]),n}(e||$e)};function Ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Xa=Symbol("STM_PROP"),Za=function(e){return function(e){Ye()(n,e);var t=Ka(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"stm",get:function(){return this[Xa]},set:function(e){var t=this;t.stm!=e&&(t.stm&&t.stm.hasStore(t)&&t.stm.removeStore(t),t[Xa]=e,t.stm&&!t.stm.hasStore(t)&&t.stm.addStore(t))}},{key:"add",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.stm;return this.tree||!i||i.disabled?t=tt()(Ze()(n.prototype),"add",this).call(this,e,r):(t=tt()(Ze()(n.prototype),"add",this).call(this,e,r))&&t.length&&i.onStoreModelAdd(this,t,r),t}},{key:"insert",value:function(e,t){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.stm;if(this.tree||!a||a.disabled)r=tt()(Ze()(n.prototype),"insert",this).call(this,e,t,o);else{var s=(Array.isArray(t)?t:[t]).reduce((function(e,t){var n=t instanceof Lo?i.indexOf(t):void 0;return void 0!==n&&-1!==n&&e.set(t,n),e}),new Map);(r=tt()(Ze()(n.prototype),"insert",this).call(this,e,t))&&r.length&&(e=this.indexOf(r[0]),a.onStoreModelInsert(this,e,r,s,o))}return r}},{key:"remove",value:function(e){var t,r=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0,a=this.stm;if(this.tree||!a||a.disabled)t=tt()(Ze()(n.prototype),"remove",this).call(this,e,i,o);else{var s=(Array.isArray(e)?e:[e]).map((function(e){return r.getById(e)})).filter((function(e){return!!e})),l=s.reduce((function(e,t){var n=r.indexOf(t);return void 0!==n&&-1!=n&&e.set(t,n),e}),new Map);(t=tt()(Ze()(n.prototype),"remove",this).call(this,e,i,o))&&t.length&&a.onStoreModelRemove(this,t,l,i)}return t}},{key:"removeAll",value:function(e){var t,r=this.stm;if(r&&!r.disabled){var i=this.tree,o=this.rootNode,a=this.allRecords,s=a.length,l=i?o.children.slice():a.slice();t=tt()(Ze()(n.prototype),"removeAll",this).call(this,e),s&&0===this.count&&r.onStoreRemoveAll(this,l,e)}else t=tt()(Ze()(n.prototype),"removeAll",this).call(this,e);return t}}],[{key:"$name",get:function(){return"StoreStm"}},{key:"defaultConfig",get:function(){return{stm:null}}}]),n}(e||$e)};function Ja(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Qa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qa(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Qa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function es(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var ts=function(e){Ye()(n,e);var t=es(n);function n(){var e;B()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).objectify?Ke()(e,e.initProxy()):e}return _()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;Object.assign(t,{added:new ua,removed:new ua,modified:new ua,idRegister:{},internalIdRegister:{}}),e.storeId&&(e=Qn.assign({id:e.storeId},e)),tt()(Ze()(n.prototype),"construct",this).call(this,e),t.initRelations()}},{key:"doDestroy",value:function(){for(var e,t,r,i=this,o=i.registeredRecords,a=o.length-1;a>=0;a--){var s;null!==(s=t=o[a])&&void 0!==s&&s.isDestroyed||t.unjoinStore(i)}(null===(e=i._storage)||void 0===e||e.destroy(),i.stm&&i.stm.removeStore(i),i.isChained)||(null===(r=i.rootNode)||void 0===r||r.destroy());tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"beginBatch",value:function(){this.suspendEvents()}},{key:"endBatch",value:function(){this.resumeEvents()&&this.trigger("refresh",{action:"batch",data:this.storage.values,records:this.storage.values})}},{key:"storage",get:function(){return this._storage||(this.storage={}),this._storage},set:function(e){var t=this;null!=e&&e.isCollection?t._storage=e:t._storage=new na(e),t._storage.autoFilter=t.reapplyFilterOnAdd,t._storage.autoSort=t.reapplySortersOnAdd;var n,r=Ja(t._storage);try{for(r.s();!(n=r.n()).done;){n.value.joinStore(t)}}catch(e){r.e(e)}finally{r.f()}t._storage.on({change:"onDataChange",thisObj:t})}},{key:"allRecords",get:function(){var e=this;if(e.isTree){var t=e.collectDescendants(e.rootNode,void 0,void 0,{unfiltered:!0}).all;return e.rootVisible&&t.unshift(e.rootNode),t}return e.isGrouped?e.collectGroupRecords():e.storage.allValues}},{key:"onIsCreatingToggle",value:function(e,t){var n=this,r=e.isPersistable&&!t;n.added[r?"add":"remove"](e),r&&(n.trigger("addConfirmed",{record:e}),n.autoCommit&&n.doAutoCommit())}},{key:"joinRecordsToStore",value:function(e){var t=this;e.forEach((function(e){e.joinStore(t)}))}},{key:"onDataChange",value:function(e){var t,r,i=e.source,o=e.action,a=e.added,s=e.removed,l=e.replaced,u=e.oldCount,c=e.items,f=e.from,d=e.to,h=this,v=null==a?void 0:a.length,p=null==s?void 0:s.length;if(h._idMap=null,v&&h.joinRecordsToStore(a),null==l||l.forEach((function(e){var t=N()(e,2),n=t[0],r=t[1];n.unjoinStore(h,!0),r.joinStore(h)})),tt()(Ze()(n.prototype),"onDataChange",this).apply(this,arguments),!h.isTree){if(v){var g,y=Ja(a);try{for(y.s();!(g=y.n()).done;){var m=g.value;h.removed.includes(m)?h.removed.remove(m):h.added.add(m)}}catch(e){y.e(e)}finally{y.f()}(t=!h.remoteFilter&&h.filtered&&h.reapplyFilterOnAdd)&&h.filter({silent:!0}),(r=!h.sortParamName&&h.isSorted&&h.reapplySortersOnAdd)&&h.sort(null,null,!1,!0)}if(p){var b,k=Ja(s);try{for(k.s();!(b=k.n()).done;){var w=b.value;w.cancelBatch(),w.unjoinStore(h),h.added.includes(w)?h.added.remove(w):w._undoingInsertion||w.meta.isCreating||h.removed.add(w)}}catch(e){k.e(e)}finally{k.f()}h.modified.remove(s),(t=!h.remoteFilter&&h.filtered)&&h.filter({silent:!0})}}switch(o){case"clear":h.relationCache={},h.updateDependentStores("removeall"),h.trigger("removeAll"),h.trigger("change",{action:"removeall"});break;case"splice":if(v){h.updateDependentStores("add",a);var C=a.reduce((function(e,t){var n=t.meta.previousIndex;return n>-1&&n<e&&(e=n),e}),a[0].meta.previousIndex),R=i.indexOf(a[0],!i.autoFilter),S={records:a,index:R};C>-1&&(S.oldIndex=C),h.trigger("add",S),h.trigger("change",Object.assign({action:"add"},S)),t&&h.triggerFilterEvent({action:"filter",filters:h.filters,oldCount:u,records:h.storage.allValues}),r&&h.trigger("sort",{action:"sort",sorters:h.sorters,records:h.storage.allValues})}s.length&&(h.updateDependentStores("remove",s),h.trigger("remove",{records:s}),h.trigger("change",{action:"remove",records:s})),l.length&&(h.trigger("replace",{records:l,all:h.records.length===l.length}),h.trigger("change",{action:"replace",replaced:l,all:h.records.length===l.length}));break;case"filter":h.isGrouped?h.group(null,null,null,null,!0):h.isSorted&&h.performSort(!0);break;case"move":for(var x=h.storage.allValues,E=Math.min(f,d);E<=Math.max(f,d);E++)x[E].setData("parentIndex",E);h.trigger("move",{record:c[0],records:c,from:f,to:d}),h.isFiltered&&h.performFilter(),h.trigger("change",{action:o,record:c[0],records:c,from:f,to:d})}}},{key:"onDataReplaced",value:function(e,t){for(var n,r=this,i=r.storage.allValues,o=0;o<i.length;o++)i[o].joinStore(r);if(r.prepareGroupRecords(r.storage.values),r.restoreCollapsedGroups(),!r.remoteFilter&&r.isFiltered&&r.filter({silent:!0}),r.isGrouped&&r.group(null,null,!1,!r.sorters.length,!0),!r.sortParamName&&r.sorters.length&&r.sort(null,null,!1,!0),!r.useRawData.disableDuplicateIdCheck){var a=r.idMap;if(Object.keys(a).length<r.storage.values.length){var s=[];throw r.storage.values.forEach((function(e){return a[e.id]?delete a[e.id]:s.push(e)})),new Error("Id collision on ".concat(s.map((function(e){return e.id}))))}}var l={action:e,data:t,records:r.storage.values};r.updateDependentStores(e,l.records),null===(n=r.afterLoadData)||void 0===n||n.call(r),r.trigger("refresh",l),r.trigger("change",l)}},{key:"onModelChange",value:function(e,t,n,r,i){var o=this,a=e.constructor.idField,s={record:e,changes:n,batch:null!=e.batching,fromRelationUpdate:i},l=!e.ignoreBag&&o.updateModifiedBagForRecord(e);if(o.storage.onItemMutation(e,n),!r){if(a in n){var u=t[a],c=u.oldValue,f=u.value;o.updateDependentRecordIds(c,f),o.onRecordIdChange({record:e,oldValue:c,value:f}),o.trigger("idChange",{store:o,record:e,oldValue:c,value:f})}o.onUpdateRecord(e,n),o.trigger("update",s),o.trigger("change",Object.assign({action:"update"},s))}o.autoCommit&&l&&o.doAutoCommit()}},{key:"updateModifiedBagForRecord",value:function(e){var t=this,n=!1;return e.isModified?t.modified.includes(e)||t.added.includes(e)||!e.isPartOfStore(t)||e.isAutoRoot||(e.isPhantom?t.added.add(e):t.modified.add(e),n=!0):t.modified.remove(e),n}},{key:"idMap",get:function(){var e=this,t=e.storage.values,n=!e._idMap,r=e._idMap||(e._idMap={});if(n)for(var i,o=0,a=0;o<t.length;o++)r[(i=t[o]).id]={index:o,visibleIndex:a,record:i},i.isSpecialRow||a++;return r}},{key:"changeModelClass",value:function(e){var t=this.fields,n=null;return(n=null!=t&&t.length?function(e){Ye()(r,e);var n=es(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,null,[{key:"fields",get:function(){return t}}]),r}(e):this.preventSubClassingModel?e:function(e){Ye()(n,e);var t=es(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(e)).initClass(),n}},{key:"storeId",get:function(){return this.id},set:function(e){this.id=e}},{key:"changeId",value:function(e,t){return tt()(Ze()(n.prototype),"changeId",this).call(this,!0!==e&&e,t)}},{key:"updateId",value:function(e,t){var r=n.getById(e);r&&n.unregisterInstance(r),tt()(Ze()(n.prototype),"updateId",this).call(this,e,t)}},{key:"generateAutoId",value:function(){return n.generateId("store-")}},{key:"tree",get:function(){return this._tree},set:function(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}},{key:"buildRootNode",value:function(){return{}}},{key:"rootNode",get:function(){return this.masterStore?this.masterStore.rootNode:this._rootNode},set:function(e){var t,n=this,r=n._rootNode;e!==r&&(r&&n.clear(!0),e instanceof Lo?(e.instanceMeta(n).collapsed=!1,n._rootNode=e):n._rootNode=e=new n.modelClass(Object.assign(Qe()({expanded:!0},n.modelClass.idField,"".concat(n.id,"-rootNode")),e),n,null,!0),n._tree=!0,e.isRoot=!0,e.joinStore(n),(null!==(t=e.children)&&void 0!==t&&t.length||n.rootVisible)&&(e.isLoading=!0,n.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),n.trigger("rootChange",{oldRoot:r,rootNode:e}))}},{key:"data",get:function(){return this._data},set:function(e){this.setStoreData(e)}},{key:"setStoreData",value:function(e){var t,n=this,r=n.modelClass,i=r.idField,o=r.childrenField,a=r.parentIdField;if(n.getConfig("plugins"),n.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=Qn.transformNamedObjectToArray(e,i)),n.tree=!n.isChained&&(n.tree||Boolean(n.autoTree&&(null===(t=e)||void 0===t?void 0:t.some((function(e){return e[o]}))))),n.syncDataOnLoad&&n._data)n.syncDataset(e);else{if(n._data=e,n.tree){if(n.transformFlatData){var s,l=!1,u=!0,c=Ja(e);try{for(c.s();!(s=c.n()).done;){var f=s.value;if(f.isModel||f[o]){u=!1;break}null!=f[a]&&(l=!0)}}catch(e){c.e(e)}finally{c.f()}u&&l&&(e=n.transformToTree(e))}var d=n.rootNode;d.isLoading=!0,n.clear(!0),d.appendChild(e),n.updateDependentStores("dataset",[d]),d.isLoading=!1,0===e.length?n.trigger("refresh",{action:"dataset",data:[],records:[]}):n.isFiltered&&n.filter()}else n.loadData(e);n.added.clear(),n.removed.clear(),n.modified.clear()}}},{key:"loadData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dataset",n=this,r=n.storage,i=n.allowNoId,o=n.modelClass.fieldMap.id.dataSource;if(n.storeCollapsedGroups(),n.removeHeadersAndFooters(n.storage.values),n._idMap=null,e){var a=!(e[0]instanceof Lo);if(a){n.modelClass.exposeProperties(e[0]);for(var s=e.length,l=new Array(s),u=0;u<s;u++){var c=e[u];if(!i&&null==c[o])throw new Error("Id required but not found on row ".concat(u));l[u]=n.processRecord(n.createRecord(c,!0),!0),l[u].setData("parentIndex",u)}n.clear(!0),r.replaceValues({values:l,isNewDataset:!0,silent:!0})}else n.clear(!0),r.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});n.onDataReplaced(t,e)}else n.clear(!0),n._data=null}},{key:"getRange",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(n?this.storage.allValues:this.storage.values).slice(e,t)}},{key:"createRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new this.modelClass(e,this,null,t)}},{key:"processRecord",value:function(e){return e}},{key:"refreshData",value:function(){this.filter(),this.sort()}},{key:"onRecordIdChange",value:function(e){var t=e.record,n=e.oldValue,r=e.value,i=this,o=i._idMap,a=i.idRegister;i.storage._indicesInvalid=!0,o&&(delete o[n],o[r]=t),i.added.changeId(n,r),i.removed.changeId(n,r),i.modified.changeId(n,r),delete a[n],a[r]=t,t.index=i.storage.indexOf(t)}},{key:"onUpdateRecord",value:function(e,t){var n=t.internalId,r=this.internalIdRegister;n&&(this.storage._indicesInvalid=!0,delete r[n.oldValue],r[n.value]=e),this.reapplyFilterOnUpdate&&this.isFiltered&&this.filter()}},{key:"useRawData",get:function(){return this._useRawData},set:function(e){this._useRawData=!0===e?{enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:e?Object.assign(e,{enabled:!0}):{enabled:!1}}},{key:"getCount",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.count:this.originalCount}},{key:"originalCount",get:function(){var e;return this.storage.totalCount-((null===(e=this.groupRecords)||void 0===e?void 0:e.length)||0)}},{key:"count",get:function(){return this.storage.count}},{key:"allCount",get:function(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}},{key:"records",get:function(){return this.storage.values}},{key:"first",get:function(){return this.storage.values[0]}},{key:"last",get:function(){return this.storage.values[this.storage.values.length-1]}},{key:"getAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.storage.getAt(e,t)}},{key:"register",value:function(e){var t=this,n=t.isTree&&t.idRegister[e.id];if(n&&n!==e)throw new Error("Id collision on ".concat(e.id));t.idRegister[e.id]=e,t.internalIdRegister[e.internalId]=e}},{key:"unregister",value:function(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}},{key:"registeredRecords",get:function(){return Object.values(this.idRegister)}},{key:"getById",value:function(e){return null!=e&&e.isModel?e:this.idRegister[e]}},{key:"isAvailable",value:function(e){var t=this.getById(e);return t&&this.storage.includes(t)||!1}},{key:"getByInternalId",value:function(e){return this.internalIdRegister[e]}},{key:"includes",value:function(e){return this.isTree?null!=this.idRegister[Lo.asId(e)]:this.indexOf(e)>-1}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=e&&e.isModel&&!e.stores.includes(this.$store||this))return-1;var n=Lo.asId(e);if(null==n)return-1;if(this.isTree)return this.storage.indexOf(n);var r=this.idMap[n];return r?r[t?"visibleIndex":"index"]:-1}},{key:"allIndexOf",value:function(e){var t=this;if(this.isTree){var n=this.getById(e),r=-1;return n&&n.bubble((function(e){e.parent?r+=e.parentIndex+1:e===t.rootNode&&t.rootVisible&&(r+=1)})),r}return this.storage.indexOf(e,!0)}},{key:"getDistinctValues",value:function(e){var t,n=[],r={};return this.forEach((function(i){i.isSpecialRow||i.isRoot||(t=i.get(e),r[t]||(n.push(t),r[t]=1))})),n}},{key:"getValueCount",value:function(e,t){var n=0;return this.forEach((function(r){Qn.isEqual(r.get(e),t)&&n++})),n}},{key:"json",get:function(){return te.safeJsonStringify(this)},set:function(e){"string"==typeof e&&(e=te.safeJsonParse(e)),this.data=e}},{key:"formattedJSON",get:function(){return te.safeJsonStringify(this,null,4)}},{key:"toJSON",value:function(){return(this.isTree?this.rootNode.children:this).map((function(e){return e.toJSON()}))}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length>2?arguments[2]:void 0;"boolean"==typeof(n=void 0!==n&&n)&&(n={includeFilteredOutRecords:n,includeCollapsedGroupRecords:!1});var r=function(n,r){if(!n.isRoot&&!n.isSpecialRow)return e.call(t,n,r)};if(this.isTree)this.rootNode.traverseWhile(r,!1,n.includeFilteredOutRecords);else{var i=n.includeFilteredOutRecords?this.storage.allValues:this.storage.values;if(this.isGrouped&&n.includeCollapsedGroupRecords)for(var o=0;o<i.length;o++){var a=i[o];if(a.groupChildren&&!0===a.meta.collapsed)for(var s=0;s<a.groupChildren.length;s++){var l=a.groupChildren[s];if(!1===r(l,s))return}else if(!1===r(a,o))return}else for(var u=0;u<i.length;u++)if(!1===r(i[u],u))return}}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return this.storage.values.map(e,t)}},{key:"reduce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;return n!==this&&(e=e.bind(n)),this.storage.values.reduce(e,t,n)}},{key:Symbol.iterator,value:function(){return this.storage.values[Symbol.iterator]()}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t===this.rootNode,r=arguments.length>3?arguments[3]:void 0;"boolean"==typeof(r=void 0!==r&&r)&&(r={includeFilteredOutRecords:r,includeCollapsedGroupRecords:!1});var i=this;if(i.isTree){if("boolean"==typeof t&&(n=t,t=i.rootNode),i.isChained){var o=e;e=function(e){i.chainedFilterFn(e)&&o(e)}}t.traverse(e,n,r.includeFilteredOutRecords)}else i.forEach((function(t){return t.traverse(e,!1,r.includeFilteredOutRecords)}),i,r)}},{key:"traverseWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t===this.rootNode,r=this;if(r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){var i=e;e=function(e){r.chainedFilterFn(e)&&i(e)}}t.traverseWhile(e,n)}else{var o,a=Ja(r.storage);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(!1===s.traverse(e))break}}catch(e){a.e(e)}finally{a.f()}}}},{key:"getNext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.storage.values,o=r.indexOf(e);if(o>=i.length-1){if(!t)return null;o=-1}var a=i[o+1];return n&&a&&a.isSpecialRow?r.getNext(i[o+1],t,!0):a}},{key:"getPrev",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.storage.values,o=r.indexOf(e);if(0===o){if(!t)return null;o=i.length}var a=i[o-1];return n&&a&&a.isSpecialRow&&o>0?r.getPrev(i[o-1],t,!0):a}},{key:"getAdjacent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t?this.getNext(e,n,r):this.getPrev(e,n,r)}},{key:"getNextLeaf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.leaves,i=n.getById(e),o=r.indexOf(i);if(o>=r.length-1){if(!t)return null;o=-1}return r[o+1]}},{key:"getPrevLeaf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.leaves,i=n.getById(e),o=r.indexOf(i);if(0===o){if(!t)return null;o=r.length}return r[o-1]}},{key:"getAdjacentLeaf",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?this.getNextLeaf(e,n):this.getPrevLeaf(e,n)}}],[{key:"properties",get:function(){return{relationCache:{},dependentStoreConfigs:new Map}}},{key:"configurable",get:function(){return{id:!0,modelClass:Lo}}},{key:"defaultConfig",get:function(){return{fields:null,autoTree:!0,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null}}},{key:"identifiable",get:function(){return{registerGeneratedId:!1}}},{key:"from",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e&&!e.isStore&&("string"==typeof e?e=n.getStore(e):(Array.isArray(e)&&(r&&(e=e.map((function(e){return e.isModel?e:r(e)}))),e=Qn.assign({},t,{data:e})),e=new n(e))),e}},{key:"getStore",value:function(e,t){if(e instanceof n)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){var r,i=e.map((function(e){return e instanceof Lo?r=e.constructor:"string"==typeof e&&(e={text:e}),e}));e={autoCreated:!0,data:i,modelClass:r||function(e){Ye()(n,e);var t=es(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Lo),allowNoId:!0},t||(t=n)}return t?new t(e):void 0}},{key:"stores",get:function(){return n.registeredInstances}}]),n}($e.mixin(Gi,Ot,Ni,Vi,pa,ha,Ra,xa,Aa,Pa,ma,Ba,_a,Wa,Za,qa,wa));function ns(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return rs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rs(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function rs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function is(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ts.storeMap={},ts._$name="Store";var os=function(e,t){return Array.isArray(t[1])?t[1].forEach((function(n){return e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(t[1])),e},as=Promise.resolve(),ss=function(e){Ye()(l,e);var t,n,r,i,o,a,s=is(l);function l(){return B()(this,l),s.apply(this,arguments)}return _()(l,[{key:"afterConstruct",value:function(e){tt()(Ze()(l.prototype),"afterConstruct",this).call(this,e),this.autoLoad&&this.load().catch((function(){}))}},{key:"isLoading",get:function(){return this._isLoading}},{key:"isCommitting",get:function(){return Boolean(this.commitPromise)}},{key:"pageParamName",get:function(){return this._pageParamName},set:function(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e}},{key:"pageStartParamName",get:function(){return this._pageStartParamName},set:function(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e}},{key:"isPaged",get:function(){return this.pageParamName||this.pageStartParamName}},{key:"allCount",get:function(){return"remoteTotal"in this?this.remoteTotal:tt()(Ze()(l.prototype),"allCount",this)}},{key:"lastPage",get:function(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}},{key:"buildQueryString",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=e.includes("?"),o=Object.entries(Object.assign.apply(Object,[{}].concat(n))).reduce(os,[]).join("&");return o?(i?"&":"?")+o:""}},{key:"performSort",value:function(e){var t=this;if(t.sortParamName){var n=t.groupRecords,r={};return t.isGrouped&&n&&n.length&&n.forEach((function(e){e.meta.collapsed&&(t.includeGroupRecords(e),r[e.id]=!0)})),t.internalLoad({},"",(function(n){t.data=n.data,t.afterPerformSort(e,r)}))}tt()(Ze()(l.prototype),"performSort",this).call(this,e)}},{key:"performFilter",value:function(e){var t=this;if(t.remoteFilter){var n=t.count,r=t.filters;return t.currentPage=1,t.internalLoad({},"",(function(i){t.data=i.data,t.afterPerformFilter(e?null:{action:"filter",filters:r,oldCount:n,records:t.storage.values})}))}tt()(Ze()(l.prototype),"performFilter",this).call(this,e)}},{key:"encodeFilterParams",value:function(e){var t,n=[],r=ns(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.property,a=i.operator,s=i.value,l=i.caseSensitive;n.push({field:o,operator:a,value:s,caseSensitive:l})}}catch(e){r.e(e)}finally{r.f()}return JSON.stringify(n)}},{key:"encodeSorterParams",value:function(e){return JSON.stringify(e.filter((function(e){return!e.sortFn})).map((function(e){return e})))}},{key:"buildReadUrl",value:function(){var e=this.readUrl;return this.restfulFilter&&this.filters.count?(e.endsWith("/")?e:e+"/")+this.filters.first.value:e}},{key:"internalLoad",value:function(e,t,n){var r=this,i=Qn.assign({},r.params,e),o=r.buildReadUrl(),a={action:"read"+t,params:i,url:o};return o?new Promise((function(e,o){if(!1===r.trigger("beforeLoad"+t,a))return o(!1);if(r._isLoading=!0,r.trigger("load".concat(t,"Start"),a),r.trigger("beforeRequest",a),r.filterParamName&&r.isFiltered&&(i[r.filterParamName]=r.encodeFilterParams(r.filters.values)),r.sortParamName&&r.isSorted&&(i[r.sortParamName]=r.encodeSorterParams(r.groupers?r.groupers.concat(r.sorters):r.sorters)),r.isPaged){if(!i[r.pageParamName]&&!i[r.pageStartParamName]){var s=Math.min(r.currentPage||1,r.allCount?r.lastPage:1/0);r.pageParamName?i[r.pageParamName]=s:i[r.pageStartParamName]=(s-1)*r.pageSize}i[r.pageSizeParamName]=r.pageSize}var l={headers:r.headers,parseJson:!0};r.useRestfulMethods&&(l.method=r.httpMethods.read),Vt.get(a.url+r.buildQueryString(a.url,i),Qn.assign(l,r.fetchOptions)).then(function(){var s=Pt()(At.a.mark((function s(l){var u,c,f,d,h;return At.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(u=l.parsedJson,c=Array.isArray(u),f=c||u&&!1!==Qn.getPath(u,r.responseSuccessProperty),d=c?null:Qn.getPath(u,r.responseTotalProperty),r._isLoading=!1,a.response=l,a.json=u,!f){s.next=20;break}if(null!=d&&(r.remoteTotal=parseInt(d,10)),!r.isPaged){s.next=13;break}if(!(r.remoteTotal>=0)){s.next=12;break}h=r.pageParamName?i[r.pageParamName]:i[r.pageStartParamName]/r.pageSize+1,r.currentPage=Math.min(h,r.lastPage),s.next=13;break;case 12:throw new Error("A paged store must receive its responseTotalProperty in each data packet");case 13:return a.data=c?u:Qn.getPath(u,r.responseDataProperty),s.next=16,n(a);case 16:r.trigger("load"+t,a),e(a),s.next=24;break;case 20:a.exception=!0,a.exceptionType="server",r.trigger("exception",a),o(a);case 24:r.trigger("afterRequest",a);case 25:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()).catch((function(e){r._isLoading=!1,a.exception=!0,e instanceof Response?(a.exceptionType=e.ok?"server":"network",a.response=e,a.error=e.error):(a.exceptionType="server",a.error=e),r.trigger("exception",a),o(a),r.trigger("afterRequest",a)}))})):null}},{key:"load",value:(a=Pt()(At.a.mark((function e(t){var n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this).isPaged){e.next=5;break}return e.abrupt("return",n.loadPage(n.currentPage||1,t));case 5:return e.abrupt("return",n.internalLoad(t,"",(function(e){n.data=e.data})));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"loadChildren",value:(o=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.internalLoad(Qe()({},this.parentIdParamName,t.id),"Children",(function(e){e.parentRecord=t,t.children.length&&t.clearChildren(!0),t.data[t.constructor.childrenField]=e.data,t.processChildren(t.stores)})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"loadPage",value:(i=Pt()(At.a.mark((function e(t,n){var r,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.allCount&&(t=Math.min(t,this.lastPage)),(i=(r=this).pageParamName?Qe()({},r.pageParamName,t):Qe()({},r.pageStartParamName,(t-1)*r.pageSize))[r.pageSizeParamName]=r.pageSize,e.abrupt("return",r.internalLoad(Qn.assign(i,n),"Page",(function(e){r.loadData(e.data,"pageLoad")})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"nextPage",value:(r=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isPaged&&this.currentPage!==this.lastPage?this.loadPage(this.currentPage+1,t):as);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"previousPage",value:(n=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isPaged&&1!==this.currentPage?this.loadPage(this.currentPage-1,t):as);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"commit",value:(t=Pt()(At.a.mark((function e(){var t,n,r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).changes,r=[],!t.commitPromise){e.next=3;break}return e.abrupt("return",!1);case 3:if(n){e.next=6;break}return t.modified.count&&(t.modified.forEach((function(e){return e.clearChanges(!1)})),t.modified.clear()),e.abrupt("return",as);case 6:if(!1===t.trigger("beforeCommit",{changes:n})){e.next=26;break}if([].concat(F()(n.added),F()(n.modified),F()(n.removed)).forEach((function(e){return e.meta.committing=!0})),t.trigger("commitStart",{changes:n}),i={action:"commit",exception:!1,changes:n},(o=t.commitRemoved(i))&&r.push(o),(o=t.commitAdded(i))&&r.push(o),(o=t.commitModified(i))&&r.push(o),r.length){e.next=24;break}return t.modified.forEach((function(e){return e.clearChanges(!1)})),t.modified.clear(),t.added.forEach((function(e){return e.clearChanges(!1)})),t.added.clear(),t.removed.clear(),t.trigger("commit",{changes:n}),e.abrupt("return",as);case 24:return o=1===r.length?r[0]:Promise.all(r),e.abrupt("return",t.commitPromise=new Promise((function(e,r){o.then((function(){t.commitPromise=null,i.exception?(t.trigger("exception",i),r(i)):(t.trigger("commit",{changes:n}),e(i))})).catch((function(){t.commitPromise=null,r(i)}))})));case 26:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"doAutoCommit",value:function(){this.suspendCount<=0&&this.commit().catch((function(e){var t=e.response;if(!t||!(t.ok&&t.parsedJson||[500,404].includes(t.status)))throw e}))}},{key:"commitAdded",value:function(e){var t=this,n=t.added,r={action:"create",params:t.params};return n.count&&t.createUrl?new Promise((function(i){var o=n.values.map((function(e){return e.persistableData}));e.create=r;var a=r.body={data:o};if(t.trigger("beforeRequest",r),t.sendAsFormData){var s=new FormData;s.append("data",JSON.stringify(o)),a=s}var l={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(l.method=t.httpMethods.create),Vt.post(t.createUrl+t.buildQueryString(t.createUrl,t.params),a,Qn.assign(l,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a),l=s||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,l?(t.processReturnedData(n.values,s?a:a[t.responseDataProperty]),n.clear(),t.trigger("commitAdded"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,e.exceptionType=r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"commitModified",value:function(e){var t=this,n=t.changes.modified,r={action:"update",params:t.params},i=n.length&&t.updateUrl?new Promise((function(i){var o=n.map((function(e){return t.writeAllFields?e.persistableData:e.modificationDataToWrite})).filter((function(e){return!Qn.isEmpty(e)}));if(0===o.length)return t.modified.clear(),n.forEach((function(e){return e.meta.committing=!1})),void i();e.update=r;var a=r.body={data:o};if(t.trigger("beforeRequest",r),t.sendAsFormData){var s=new FormData;s.append("data",JSON.stringify(o)),a=s}var l={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(l.method=t.httpMethods.update),Vt.post(t.updateUrl+t.buildQueryString(t.updateUrl,t.params),a,Qn.assign(l,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a),l=s||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,l?(t.processReturnedData(n,s?a:a[t.responseDataProperty],!0),t.modified.clear(),t.trigger("commitModified"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null;return!n.length&&t.modified.count&&t.modified.clear(),i}},{key:"processReturnedData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.modelClass,o=i.fieldMap.id.dataSource;t.forEach((function(t,r){var a=e[r];a.clearChanges(!1),a.syncId(t[o]),Object.assign(e[r].data,i.processData(t,n))}))}},{key:"commitRemoved",value:function(e){var t=this,n=t.removed,r={action:"delete",params:t.params};return n.count&&t.deleteUrl?new Promise((function(i){e.delete=r;var o=r.body={ids:n.map((function(e){return e.id}))};if(t.trigger("beforeRequest",r),t.sendAsFormData){var a=new FormData;a.append("id",JSON.stringify(o.ids)),o=a}var s={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(s.method=t.httpMethods.delete),Vt.post(t.deleteUrl+t.buildQueryString(t.deleteUrl,t.params),o,Qn.assign(s,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a)||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,s?(n.forEach((function(e){return e.meta.committing=!1})),n.clear(),t.trigger("commitRemoved"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"remoteFilter",get:function(){return Boolean(this.filterParamName||this.restfulFilter)}}],[{key:"defaultConfig",get:function(){return{headers:null,fetchOptions:null,sendAsFormData:!1,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",pageSize:50,useRestfulMethods:!1,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}},{key:"configurable",get:function(){return{params:null}}}]),l}(ts);ss._$name="AjaxStore";var ls=function(){function e(){B()(this,e)}return _()(e,null,[{key:"get",value:function(e,t){var n=e._domData||(e._domData={});return null!=t?n[t]:n}},{key:"remove",value:function(e,t){var n=e._domData,r=null==n?void 0:n[t];return null==n||delete n[t],r}},{key:"set",value:function(e,t,n){3===arguments.length?(e._domData||(e._domData={}))[t]=n:e._domData=t}},{key:"assign",value:function(e,t){Object.assign(e._domData||(e._domData={}),t)}}]),e}();function us(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ls._$name="DomDataStore";var cs=function(){throw new Error("Abstract method call!")},fs=function(e){Ye()(n,e);var t=us(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"type",get:function(){return this.constructor.name}},{key:"undo",value:function(){cs()}},{key:"redo",value:function(){cs()}}]),n}($e);function ds(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fs._$name="ActionBase";var hs=function(){throw new Error("Abstract method call!")},vs=function(){throw new Error("Method cannot be called at this state!")},ps=function(e){Ye()(n,e);var t=ds(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"canUndo",value:function(e){hs()}},{key:"canRedo",value:function(e){hs()}},{key:"onUndo",value:function(e){hs()}},{key:"onRedo",value:function(e){hs()}},{key:"onStartTransaction",value:function(e){hs()}},{key:"onStopTransaction",value:function(e){hs()}},{key:"onStopTransactionDelayed",value:function(e){hs()}},{key:"onRejectTransaction",value:function(e){hs()}},{key:"onEnable",value:function(e){hs()}},{key:"onDisable",value:function(e){hs()}},{key:"onAutoRecordOn",value:function(e){hs()}},{key:"onAutoRecordOff",value:function(e){hs()}},{key:"onResetQueue",value:function(e){hs()}},{key:"onModelUpdate",value:function(e){hs()}},{key:"onStoreModelAdd",value:function(e){hs()}},{key:"onStoreModelInsert",value:function(e){hs()}},{key:"onStoreModelRemove",value:function(e){hs()}},{key:"onStoreModelRemoveAll",value:function(e){hs()}},{key:"onModelInsertChild",value:function(e){hs()}},{key:"onModelRemoveChild",value:function(e){hs()}}]),n}($e);ps._$name="StateBase";var gs=Symbol("STATE_PROP"),ys=Symbol("STORES_PROP"),ms=Symbol("QUEUE_PROP"),bs=Symbol("POS_PROP"),ks=Symbol("TRANSACTION_PROP"),ws=Symbol("TRANSACTION_TIMER_PROP"),Cs=Symbol("AUTO_RECORD_PROP"),Rs=(Object.freeze([gs,ys,ms,bs,ks,ws,Cs]),new Map),Ss=function(e,t){Rs.set(e,t)},xs=function(e){return"string"==typeof e&&(e=Rs.get(e)),e},Es=function(e,t){var n,r,i=t.undo,o=t.redo;if(i&&!o)r={},Qe()(r,ms,e[ms].slice(e.position)),Qe()(r,bs,0),n=r;else if(o&&!i)n=Qe()({},ms,e[ms].slice(0,e.position));else{var a;a={},Qe()(a,ms,[]),Qe()(a,bs,0),n=a}return[n,function(){e.notifyStoresAboutQueueReset(t)}]};function Ds(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Ts=new(function(e){Ye()(n,e);var t=Ds(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onUndo",value:function(){vs()}},{key:"onRedo",value:function(){vs()}},{key:"onEnable",value:function(e){return e.autoRecord?"autoreadystate":"readystate"}},{key:"onDisable",value:function(){vs()}},{key:"onAutoRecordOn",value:function(){return Qe()({},Cs,!0)}},{key:"onAutoRecordOff",value:function(){return Qe()({},Cs,!1)}},{key:"onStartTransaction",value:function(){vs()}},{key:"onStopTransaction",value:function(){vs()}},{key:"onStopTransactionDelayed",value:function(){vs()}},{key:"onRejectTransaction",value:function(){vs()}},{key:"onResetQueue",value:function(e,t){return Es(e,t)}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),n}(ps)),Os=Ts;function Ms(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ss("disabledstate",Ts);var As=Symbol("ACTION_QUEUE_PROP"),Is=function(e){Ye()(n,e);var t=Ms(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"defaultConfig",get:function(){return{title:null}}},{key:"construct",value:function(){var e;this[As]=[];for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this].concat(r))}},{key:"queue",get:function(){return this[As].slice(0)}},{key:"length",get:function(){return this[As].length}},{key:"addAction",value:function(e){this[As].push(e)}},{key:"undo",value:function(){for(var e=this[As],t=e.length-1;t>=0;--t)e[t].undo()}},{key:"redo",value:function(){for(var e=this[As],t=0,n=e.length;t<n;++t)e[t].redo()}}]),n}($e);function Ps(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Is._$name="Transaction";var Fs=function(e){Ye()(n,e);var t=Ps(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"canUndo",value:function(e){return 0<e.position&&e.position<=e.length}},{key:"canRedo",value:function(e){return 0<=e.position&&e.position<e.length}},{key:"onUndo",value:function(e,t){var n,r=e[ms],i=e.position,o=Math.max(0,i-t);return[(n={},Qe()(n,gs,"restoringstate"),Qe()(n,bs,o),n),function(){for(e.notifyStoresAboutStateRestoringStart();i!=o;)r[--i].undo();return[e.autoRecord?"autoreadystate":"readystate",function(){e.notifyStoresAboutStateRestoringStop()}]}]}},{key:"onRedo",value:function(e,t){var n,r=e[ms],i=e.position,o=Math.min(r.length,i+t);return[(n={},Qe()(n,gs,"restoringstate"),Qe()(n,bs,o),n),function(){e.notifyStoresAboutStateRestoringStart();do{r[i++].redo()}while(i!=o);return[e.autoRecord?"autoreadystate":"readystate",function(){e.notifyStoresAboutStateRestoringStop()}]}]}},{key:"onEnable",value:function(){vs()}},{key:"onDisable",value:function(){return"disabledstate"}},{key:"onAutoRecordOn",value:function(){var e;return e={},Qe()(e,gs,"autoreadystate"),Qe()(e,Cs,!0),e}},{key:"onAutoRecordOff",value:function(){vs()}},{key:"onStartTransaction",value:function(e,t){var n,r=new Is({title:t});return[(n={},Qe()(n,gs,"recordingstate"),Qe()(n,ks,r),n),function(){e.notifyStoresAboutStateRecordingStart(r)}]}},{key:"onStopTransaction",value:function(){vs()}},{key:"onStopTransactionDelayed",value:function(){vs()}},{key:"onRejectTransaction",value:function(){vs()}},{key:"onResetQueue",value:function(e,t){return Es(e,t)}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),n}(ps),Ls=new Fs,Bs=Ls;function js(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ss("readystate",Ls);var _s=function(e){Ye()(n,e);var t=js(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onEnable",value:function(){}},{key:"onDisable",value:function(e){var t,n=e[ks];return e.notifyStoresAboutStateRecordingStop(n,{disabled:!0}),t={},Qe()(t,gs,"disabledstate"),Qe()(t,ks,null),t}},{key:"onAutoRecordOn",value:function(e){var t;return[(t={},Qe()(t,gs,"autorecordingstate"),Qe()(t,Cs,!0),t),function(){e.stopTransactionDelayed()}]}},{key:"onAutoRecordOff",value:function(){vs()}},{key:"onStartTransaction",value:function(){vs()}},{key:"onStopTransaction",value:function(e,t){var n,r=e[ks],i=e[bs],o=e[ms];return r.length&&(r.title||t||!e.getTransactionTitle?t&&(r.title=t):r.title=e.getTransactionTitle(r),o[i]=r,o.length=++i),[(n={},Qe()(n,gs,"readystate"),Qe()(n,bs,i),Qe()(n,ks,null),n),function(){e.notifyStoresAboutStateRecordingStop(r,{stop:!0})}]}},{key:"onRejectTransaction",value:function(e){var t,n=e[ks];return[(t={},Qe()(t,gs,"restoringstate"),Qe()(t,ks,null),t),function(){return n.length&&n.undo(),["readystate",function(){e.notifyStoresAboutStateRecordingStop(n,{rejected:!0})}]}]}},{key:"onStopTransactionDelayed",value:function(){vs()}},{key:"onQueueReset",value:function(){vs()}},{key:"onModelUpdate",value:function(e,t,n,r){e[ks].addAction(e.makeModelUpdateAction(t,n,r))}},{key:"onModelInsertChild",value:function(e,t,n,r,i,o){e[ks].addAction(e.makeModelInsertChildAction(t,n,r,i,o))}},{key:"onModelRemoveChild",value:function(e,t,n,r){e[ks].addAction(e.makeModelRemoveChildAction(t,n,r))}},{key:"onStoreModelAdd",value:function(e,t,n,r){e[ks].addAction(e.makeStoreModelAddAction(t,n,r))}},{key:"onStoreModelInsert",value:function(e,t,n,r,i,o){e[ks].addAction(e.makeStoreModelInsertAction(t,n,r,i,o))}},{key:"onStoreModelRemove",value:function(e,t,n,r,i){e[ks].addAction(e.makeStoreModelRemoveAction(t,n,r,i))}},{key:"onStoreRemoveAll",value:function(e,t,n,r){e[ks].addAction(e.makeStoreRemoveAllAction(t,n,r))}}]),n}(ps),Hs=new _s,Ns=Hs;function zs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ss("recordingstate",Hs);var Vs=new(function(e){Ye()(n,e);var t=zs(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onUndo",value:function(){vs()}},{key:"onRedo",value:function(){vs()}},{key:"onEnable",value:function(){vs()}},{key:"onDisable",value:function(){vs()}},{key:"onAutoRecordOn",value:function(){return Qe()({},Cs,!0)}},{key:"onAutoRecordOff",value:function(){return Qe()({},Cs,!1)}},{key:"onStartTransaction",value:function(){vs()}},{key:"onStopTransaction",value:function(){vs()}},{key:"onStopTransactionDelayed",value:function(){vs()}},{key:"onRejectTransaction",value:function(){vs()}},{key:"onQueueReset",value:function(){vs()}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),n}(ps)),Ws=Vs;function $s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ss("restoringstate",Vs);var Us=new(function(e){Ye()(n,e);var t=$s(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onAutoRecordOn",value:function(){vs()}},{key:"onAutoRecordOff",value:function(){var e;return e={},Qe()(e,gs,"readystate"),Qe()(e,Cs,!1),e}},{key:"onStartTransaction",value:function(e,t){var n,r=new Is({title:t});return[(n={},Qe()(n,gs,"autorecordingstate"),Qe()(n,ks,r),n),function(){e.notifyStoresAboutStateRecordingStart(r),e.stopTransactionDelayed()}]}},{key:"onModelUpdate",value:function(e,t,n,r){e.startTransaction(),e.onModelUpdate(t,n,r)}},{key:"onModelInsertChild",value:function(e,t,n,r,i){e.startTransaction(),e.onModelInsertChild(t,n,r,i)}},{key:"onModelRemoveChild",value:function(e,t,n,r){e.startTransaction(),e.onModelRemoveChild(t,n,r)}},{key:"onStoreModelAdd",value:function(e,t,n,r){e.startTransaction(),e.onStoreModelAdd(t,n,r)}},{key:"onStoreModelInsert",value:function(e,t,n,r,i,o){e.startTransaction(),e.onStoreModelInsert(t,n,r,o)}},{key:"onStoreModelRemove",value:function(e,t,n,r,i){e.startTransaction(),e.onStoreModelRemove(t,n,r,i)}},{key:"onStoreRemoveAll",value:function(e,t,n,r){e.startTransaction(),e.onStoreRemoveAll(t,n,r)}}]),n}(Fs)),Gs=Us;function Ys(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ss("autoreadystate",Us);var qs,Ks=Reflect.defineProperty;qs=pe.a.isBrowserEnv?window.performance:{now:function(){return(new Date).getTime()}};var Xs=null;if(z.a.isTestEnv){var Zs=pe.a.global.bryntum||(pe.a.global.bryntum={});Xs=Zs.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,isEmpty:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Xs.timeouts.size+Xs.animationFrames.size+(e?Xs.intervals.size:0)===0}}}var Js=function(e,t,n,r){var i="string"==typeof t,o=r&&r.appendArgs||[],a=function(){n.timerId=null,n.lastCallTime=qs.now();var r,a=n.args;(n.args=null,i)?(r=e)[t].apply(r,F()(a).concat(F()(o))):t.call.apply(t,[e].concat(F()(a),F()(o)));n.called=!0,++n.calls};return r&&(e=r.thisObj||e),n.lastCallTime=-9e9,n.calls=0,n.invoker=a,a.wrapFn=n,a},Qs=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"clearTimeout";return t.cancel=function(){t.isPending&&(e[n](t.timerId),t.args=t.timerId=null)},t.flush=function(){t.isPending&&(e[n](t.timerId),t.timerId=null,t.invoker())},t.now=function(){t.cancel();for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.args=n,t.invoker()},t.resume=function(e){var n=t.suspended;t.suspended=e||n<1?0:n-1},t.suspend=function(){++t.suspended},t.immediate=!1,t.suspended=0,t.timerId=null,Ks(t,"isPending",{get:function(){return null!==t.timerId}}),t},el=function(e){return function(e){Ye()(r,e);var t,n=Ys(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"doDestroy",value:function(){var e=this;tt()(Ze()(r.prototype),"doDestroy",this).call(this),e.timeoutIds&&(e.timeoutIds.forEach((function(e,t){"function"==typeof e&&e(),clearTimeout(t),Xs&&Xs.timeouts.delete(t)})),e.timeoutIds=null),e.timeoutMap&&(e.timeoutMap.forEach((function(e,t){return clearTimeout(t)})),e.timeoutMap=null),e.intervalIds&&(e.intervalIds.forEach((function(e){clearInterval(e),Xs&&Xs.intervals.delete(e)})),e.intervalIds=null),e.animationFrameIds&&(e.animationFrameIds.forEach((function(e){cancelAnimationFrame(e),Xs&&Xs.animationFrames.delete(e)})),e.animationFrameIds=null)}},{key:"hasTimeout",value:function(e){return!(!this.timeoutMap||!this.timeoutMap.has(e))}},{key:"setTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.fn,n=e.delay,r=e.name,i=e.runOnDestroy,o=e.cancelOutstanding,a=e.args;if(arguments.length>1||"function"==typeof arguments[0]){var s=Array.prototype.slice.call(arguments);t=s[0],n=s[1],r=s[2],i=s[3]}"string"==typeof t?r=t:r||(r=t.name),o&&this.clearTimeout(r);var l=this,u=l.timeoutIds||(l.timeoutIds=new Map),c=l.timeoutMap||(l.timeoutMap=new Map),f=setTimeout((function(){"string"==typeof t&&(t=l[r]),u&&u.delete(f),c&&c.delete(r),Xs&&Xs.timeouts.delete(f),t.apply(l,a)}),n);return u.set(f,!i||t),Xs&&Xs.timeouts.set(f,{fn:t,delay:n,name:r}),r&&c.set(r,f),f}))},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e;if("string"==typeof t){if(!this.timeoutMap)return;t=this.timeoutMap.get(e),this.timeoutMap.delete(e)}clearTimeout(t),this.timeoutIds&&this.timeoutIds.delete(t),Xs&&Xs.timeouts.delete(t)}))},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){clearInterval(e),this.intervalIds&&this.intervalIds.delete(e),Xs&&Xs.intervals.delete(e)}))},{key:"setInterval",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var n=setInterval(e,t);return(this.intervalIds||(this.intervalIds=new Set)).add(n),Xs&&Xs.intervals.set(n,{fn:e,delay:t}),n}))},{key:"requestAnimationFrame",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,r=this.animationFrameIds||(this.animationFrameIds=new Set),i=requestAnimationFrame((function(){return Xs&&Xs.animationFrames.delete(i),r.delete(i),e.apply(n,t)}));return r.add(i),Xs&&Xs.animationFrames.set(i,{fn:e,extraArgs:t,thisObj:n}),i}))},{key:"createOnFrame",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,o=arguments.length>3?arguments[3]:void 0,a=function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];t&&o&&(n.cancelAnimationFrame(t),t=null),t||(t=n.requestAnimationFrame((function(){"string"==typeof e&&(e=i[e]),t=null,s.push.apply(s,F()(r)),e.apply(i,s)})))};return a.cancel=function(){return n.cancelAnimationFrame(t)},a}},{key:"cancelAnimationFrame",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){cancelAnimationFrame(e),this.animationFrameIds&&this.animationFrameIds.delete(e),Xs&&Xs.animationFrames.delete(e)}))},{key:"nextAnimationFrame",value:(t=Pt()(At.a.mark((function e(){var t=this;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return t.requestAnimationFrame(e)})));case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"buffer",value:function(e,t){var n=this,r=t;t&&"number"!=typeof t?r=t.delay:t=null;var i=function e(){if(!e.suspended){var t=e.delay;e.cancel(),e.called=!1;for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];e.args=i,e.immediate||!t?o():e.timerId=n.setTimeout(o,t)}},o=Js(this,e,i,t);return i.delay=r,Qs(this,i)}},{key:"raf",value:function(e,t){var n=this,r=t;t&&"boolean"!=typeof t?r=t.cancelOutstanding:t=null;var i=function e(){if(!e.suspended){e.cancelOutstanding&&e.cancel(),e.called=!1;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e.args=r,e.immediate?o():e.isPending||(e.timerId=n.requestAnimationFrame(o))}},o=Js(this,e,i,t);return i.cancelOutstanding=r,Qs(this,i,"cancelAnimationFrame")}},{key:"throttle",value:function(e,t){var n,r=t;t&&"number"!=typeof t?(r=t.delay,n=t.throttled):t=null;var i=this,o=function e(){if(!e.suspended){for(var t=e.delay,r=qs.now()-e.lastCallTime,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];e.args=s,e.immediate||r>=t?(i.clearTimeout(e.timerId),a()):(e.isPending||(e.timerId=i.setTimeout(a,t-r),e.called=!1),n&&(n.wrapFn.args=s,n()))}},a=Js(i,e,o,t);return o.delay=r,n&&(n=Js(i,n,(function(){}),t)),Qs(i,o)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"Delayable"}},{key:"declarable",get:function(){return["delayable"]}},{key:"setupDelayable",value:function(e){e.setupDelayableMethods(e.delayable)}},{key:"setupDelayableMethods",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=e.static,i=t||n.prototype;r&&delete e.static;var o=function(t){var n=e[t],r=t+"Now",o=I()(n);i[r]=i[t],"number"===o?n={type:"buffer",delay:n}:"string"===o&&(n={type:n}),Ks(i,t,{get:function(){var e=this,i=this[n.type]((function(){e[r].apply(e,arguments)}),n);return Ks(this,t,{value:i}),i}})};for(var a in e)o(a)}}]),r}(e||$e)};function tl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var nl=new(function(e){Ye()(n,e);var t=tl(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onDisable",value:function(e){var t,n=e[ks],r=e[ws];return r&&this.clearTimeout(r),e.notifyStoresAboutStateRecordingStop(n,{disabled:!0}),t={},Qe()(t,gs,"disabledstate"),Qe()(t,ks,null),Qe()(t,ws,null),t}},{key:"onAutoRecordOn",value:function(e){vs()}},{key:"onAutoRecordOff",value:function(e){var t,n=e[ws];return n&&this.clearTimeout(n),t={},Qe()(t,gs,"recordingstate"),Qe()(t,Cs,!1),Qe()(t,ws,null),t}},{key:"onStopTransaction",value:function(e,t){var n,r=e[ks],i=e[ws],o=e[bs],a=e[ms];return i&&this.clearTimeout(i),r.length&&(r.title||t||!e.getTransactionTitle?t&&(r.title=t):r.title=e.getTransactionTitle(r),a[o]=r,a.length=++o),[(n={},Qe()(n,gs,"autoreadystate"),Qe()(n,bs,o),Qe()(n,ks,null),Qe()(n,ws,null),n),function(){e.notifyStoresAboutStateRecordingStop(r,{stop:!0})}]}},{key:"onStopTransactionDelayed",value:function(e){var t,n=e[ws];return n&&this.clearTimeout(n),n=this.setTimeout((function(){e.stopTransaction()}),e.autoRecordTransactionStopTimeout),t={},Qe()(t,gs,nl),Qe()(t,ws,n),t}},{key:"onRejectTransaction",value:function(e){var t,n=e[ks],r=e[ws];return r&&this.clearTimeout(r),[(t={},Qe()(t,gs,"restoringstate"),Qe()(t,ks,null),Qe()(t,ws,null),t),function(){return n.length&&n.undo(),["autoreadystate",function(){e.notifyStoresAboutStateRecordingStop(n,{rejected:!0})}]}]}},{key:"onModelUpdate",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"onModelUpdate",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onModelInsertChild",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"onModelInsertChild",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onModelRemoveChild",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"onModelRemoveChild",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelAdd",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"onStoreModelAdd",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelInsert",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"onStoreModelInsert",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelRemove",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"onStoreModelRemove",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreRemoveAll",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"onStoreRemoveAll",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}}]),n}(_s.mixin(el))),rl=nl;function il(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ss("autorecordingstate",nl);var ol=Symbol("MODEL_PROP"),al=Symbol("NEW_DATA_PROP"),sl=Symbol("OLD_DATA_PROP"),ll=function(e){Ye()(n,e);var t=il(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"type",get:function(){return"UpdateAction"}},{key:"model",get:function(){return this[ol]},set:function(e){this[ol]=e}},{key:"newData",get:function(){return this[al]},set:function(e){this[al]=Object.assign({},e)}},{key:"oldData",get:function(){return this[sl]},set:function(e){this[sl]=Object.assign({},e)}},{key:"undo",value:function(){this.model.set(this.oldData,null,null,null,!0),this.model.$&&Object.assign(this.model,this.oldData)}},{key:"redo",value:function(){this.model.set(this.newData,null,null,null,!0),this.model.$&&Object.assign(this.model,this.newData)}}],[{key:"defaultConfig",get:function(){return{model:void 0,newData:void 0,oldData:void 0}}}]),n}(fs);function ul(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ll._$name="UpdateAction";var cl=Symbol("PARENT_MODEL_PROP"),fl=Symbol("CHILD_MODELS_PROP"),dl=Symbol("INSERT_INDEX_PROP"),hl=Symbol("CONTEXT_PROP"),vl=function(e){Ye()(n,e);var t=ul(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"type",get:function(){return"InsertChildAction"}},{key:"parentModel",get:function(){return this[cl]},set:function(e){this[cl]=e}},{key:"childModels",get:function(){return this[fl]},set:function(e){this[fl]=e.slice(0)}},{key:"insertIndex",get:function(){return this[dl]},set:function(e){this[dl]=e}},{key:"context",get:function(){return this[hl]},set:function(e){this[hl]=e}},{key:"undo",value:function(){var e=this.parentModel,t=this.context,n=this.childModels;n.sort((function(e,n){var r=t.get(e)||{},i=r.lhsParent,o=r.lhsIndex,a=t.get(n)||{},s=a.rhsParent,l=a.rhsIndex;return i&&i===s?o-l:0})),n.forEach((function(n){var r=t.get(n)||{},i=r.parent,o=r.index;if(i)if(i===e){var a;a=o>n.parentIndex?o+1:o,a=o===i.children.length-1?null:a;var s=i.children[a];i.insertChild(n,s)}else i.insertChild(n,i.children[o]);else e.removeChild(n)}))}},{key:"redo",value:function(){var e=this.parentModel,t=this.insertIndex,n=this.childModels,r=e.children[t];e.insertChild(n,r)}}],[{key:"defaultConfig",get:function(){return{parentModel:void 0,childModels:void 0,insertIndex:void 0,context:void 0}}}]),n}(fs);function pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}vl._$name="InsertChildAction";var gl=Symbol("PARENT_MODEL_PROP"),yl=Symbol("CHILD_MODELS_PROP"),ml=Symbol("CONTEXT_PROP"),bl=function(e){Ye()(n,e);var t=pl(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"type",get:function(){return"RemoveChildAction"}},{key:"parentModel",get:function(){return this[gl]},set:function(e){this[gl]=e}},{key:"childModels",get:function(){return this[yl]},set:function(e){this[yl]=e.slice(0)}},{key:"context",get:function(){return this[ml]},set:function(e){this[ml]=e}},{key:"undo",value:function(){var e=this.parentModel,t=this.context,n=this.childModels;n.sort((function(e,n){return t.get(e)-t.get(n)})),n.forEach((function(n){e.insertChild(t.get(n),n)}))}},{key:"redo",value:function(){this.parentModel.removeChild(this.childModels)}}],[{key:"defaultConfig",get:function(){return{parentModel:void 0,childModels:void 0,context:void 0}}}]),n}(fs);function kl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bl._$name="RemoveChildAction";var wl=Symbol("STORE_PROP"),Cl=Symbol("MODEL_LIST_PROP"),Rl=function(e){Ye()(n,e);var t=kl(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"type",get:function(){return"AddAction"}},{key:"store",get:function(){return this[wl]},set:function(e){this[wl]=e}},{key:"modelList",get:function(){return this[Cl]},set:function(e){this[Cl]=e.slice(0)}},{key:"undo",value:function(){var e=this;e.store.remove(e.modelList,e.silent)}},{key:"redo",value:function(){var e=this;e.store.add(e.modelList,e.silent)}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,silent:!1}}}]),n}(fs);function Sl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Rl._$name="AddAction";var xl=Symbol("STORE_PROP"),El=Symbol("MODEL_LIST_PROP"),Dl=Symbol("INSERT_INDEX_PROP"),Tl=Symbol("CONTEXT_PROP"),Ol=function(e){Ye()(n,e);var t=Sl(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"type",get:function(){return"InsertAction"}},{key:"store",get:function(){return this[xl]},set:function(e){this[xl]=e}},{key:"modelList",get:function(){return this[El]},set:function(e){this[El]=e.slice(0)}},{key:"insertIndex",get:function(){return this[Dl]},set:function(e){this[Dl]=e}},{key:"context",get:function(){return this[Tl]},set:function(e){this[Tl]=e}},{key:"undo",value:function(){var e=this.store,t=this.modelList,n=this.context,r=this.silent;t.sort((function(e,t){var r=n.get(e),i=n.get(t);return void 0!==r&&void 0!==i?r-i:0})),t.forEach((function(t){var i=n.get(t);t._undoingInsertion=!0,void 0!==i?e.insert(i,t,r):e.remove(t,r),t._undoingInsertion=!1}))}},{key:"redo",value:function(){var e=this;e.store.insert(e.insertIndex,e.modelList,e.silent)}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,insertIndex:void 0,context:void 0,silent:!1}}}]),n}(fs);function Ml(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ol._$name="InsertAction";var Al=Symbol("STORE_PROP"),Il=Symbol("MODEL_LIST_PROP"),Pl=Symbol("CONTEXT_PROP"),Fl=function(e){Ye()(n,e);var t=Ml(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"type",get:function(){return"RemoveAction"}},{key:"store",get:function(){return this[Al]},set:function(e){this[Al]=e}},{key:"modelList",get:function(){return this[Il]},set:function(e){this[Il]=e.slice(0)}},{key:"context",get:function(){return this[Pl]},set:function(e){this[Pl]=e}},{key:"undo",value:function(){var e=this.store,t=this.context,n=this.modelList,r=this.silent;n.sort((function(e,n){return t.get(e)-t.get(n)})),n.forEach((function(n){var i=t.get(n);e.insert(i,n,r)}))}},{key:"redo",value:function(){var e=this;e.store.remove(e.modelList,e.silent)}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,context:void 0,silent:!1}}}]),n}(fs);function Ll(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Fl._$name="RemoveAction";var Bl=Symbol("STORE_PROP"),jl=Symbol("ALL_RECORDS_PROP"),_l=function(e){Ye()(n,e);var t=Ll(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"type",get:function(){return"RemoveAllAction"}},{key:"store",get:function(){return this[Bl]},set:function(e){this[Bl]=e}},{key:"allRecords",get:function(){return this[jl]},set:function(e){this[jl]=e.slice(0)}},{key:"undo",value:function(){var e=this.store,t=this.allRecords,n=this.silent;e.add(t,n)}},{key:"redo",value:function(){this.store.removeAll(this.silent)}}],[{key:"defaultConfig",get:function(){return{store:void 0,allRecords:void 0,silent:!1}}}]),n}(fs);function Hl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}_l._$name="RemoveAllAction";var Nl=function(e,t,n){return new ll({model:e,newData:t,oldData:n})},zl=function(e,t,n,r){return new vl({parentModel:e,childModels:n,insertIndex:t,context:r})},Vl=function(e,t,n){return new bl({parentModel:e,childModels:t,context:n})},Wl=function(e,t,n){return new Rl({store:e,modelList:t,silent:n})},$l=function(e,t,n,r,i){return new Ol({store:e,insertIndex:t,modelList:n,context:r,silent:i})},Ul=function(e,t,n,r){return new Fl({store:e,modelList:t,context:n,silent:r})},Gl=function(e,t,n){return new _l({store:e,allRecords:t,silent:n})},Yl=function e(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var a=t.state,s=n.call.apply(n,[t[gs],t].concat(i));if("string"==typeof s)t[gs]=xs(s);else if(s instanceof ps)t[gs]=s;else if(Array.isArray(s)){var l=N()(s,2),u=l[0],c=l[1];"string"==typeof u?t[gs]=xs(u):u instanceof ps?t[gs]=u:u&&"object"===I()(u)&&((t=Object.assign(t,u))[gs]=xs(t[gs])),"function"==typeof c&&e.apply(void 0,[t,c].concat(i))}else s&&"object"===I()(s)&&((t=Object.assign(t,s))[gs]=xs(t[gs]));a!==Bs&&a!==Gs&&s!==Bs&&s!==Gs&&t.trigger("ready")},ql=function(e){Ye()(a,e);var t,n,r,i,o=Hl(a);function a(){return B()(this,a),o.apply(this,arguments)}return _()(a,[{key:"construct",value:function(){var e,t,n=this;Object.assign(n,(e={},Qe()(e,gs,Bs),Qe()(e,ys,[]),Qe()(e,ms,[]),Qe()(e,bs,0),Qe()(e,ks,null),Qe()(e,ws,null),Qe()(e,Cs,!1),e));for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(t=tt()(Ze()(a.prototype),"construct",this)).call.apply(t,[this].concat(i))}},{key:"state",get:function(){return this[gs]}},{key:"position",get:function(){return this[bs]}},{key:"length",get:function(){return this[ms].length}},{key:"stores",get:function(){return Array.from(this[ys])}},{key:"hasStore",value:function(e){return this[ys].includes(e)}},{key:"addStore",value:function(e){this.hasStore(e)||(this[ys].push(e),e.stm=this)}},{key:"removeStore",value:function(e){this.hasStore(e)&&(this[ys]=this[ys].filter((function(t){return t!==e})),e.stm=null)}},{key:"forEachStore",value:function(e){this[ys].forEach((function(t){return e(t,t.id)}))}},{key:"disabled",get:function(){return this.state===Os},set:function(e){var t=this;t.disabled!=e&&(Yl(t,e?t.state.onDisable:t.state.onEnable,t),t.trigger("stmDisabled",{disabled:e}),t.trigger("disabled",{disabled:e}))}},{key:"enable",value:function(){this.disabled=!1}},{key:"disable",value:function(){this.disabled=!0}},{key:"isReady",get:function(){return this.state===Bs||this.state===Gs}},{key:"waitForReadiness",value:function(){return this.await("ready",!1)}},{key:"isRecording",get:function(){return this.state===Ns||this.state===rl}},{key:"autoRecord",get:function(){return this[Cs]},set:function(e){var t=this;t.autoRecord!=e&&Yl(t,e?t.state.onAutoRecordOn:t.state.onAutoRecordOff,t)}},{key:"startTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Yl(this,this.state.onStartTransaction,e)}},{key:"stopTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Yl(this,this.state.onStopTransaction,e)}},{key:"stopTransactionDelayed",value:function(){Yl(this,this.state.onStopTransactionDelayed)}},{key:"rejectTransaction",value:function(){Yl(this,this.state.onRejectTransaction)}},{key:"transaction",get:function(){return this[ks]}},{key:"queue",get:function(){return this[ms].map((function(e){return e.title}))}},{key:"isRestoring",get:function(){return this.state===Ws}},{key:"canUndo",get:function(){return this.state.canUndo(this)}},{key:"canRedo",get:function(){return this.state.canRedo(this)}},{key:"undo",value:(i=Pt()(At.a.mark((function e(){var t,n=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:1,this.isReady){e.next=4;break}return e.next=4,this.waitForReadiness();case 4:Yl(this,this.state.onUndo,t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"undoAll",value:(r=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReady){e.next=3;break}return e.next=3,this.waitForReadiness();case 3:this.undo(this.length);case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"redo",value:(n=Pt()(At.a.mark((function e(){var t,n=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:1,this.isReady){e.next=4;break}return e.next=4,this.waitForReadiness();case 4:Yl(this,this.state.onRedo,t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"redoAll",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReady){e.next=3;break}return e.next=3,this.waitForReadiness();case 3:this.redo(this.length);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"resetQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{undo:!0,redo:!0};Yl(this,this.state.onResetQueue,e)}},{key:"resetUndoQueue",value:function(){this.resetQueue({undo:!0})}},{key:"resetRedoQueue",value:function(){this.resetQueue({redo:!0})}},{key:"notifyStoresAboutStateRecordingStart",value:function(e){var t=this;this.forEachStore((function(n){n.onStmRecordingStart&&n.onStmRecordingStart(t,e)})),this.trigger("recordingStart",{stm:this,transaction:e})}},{key:"notifyStoresAboutStateRecordingStop",value:function(e,t){var n=this;this.forEachStore((function(r){r.onStmRecordingStop&&r.onStmRecordingStop(n,e,t)})),this.trigger("recordingStop",{stm:this,transaction:e,reason:t})}},{key:"notifyStoresAboutStateRestoringStart",value:function(){var e=this;this.forEachStore((function(t){t.onStmRestoringStart&&t.onStmRestoringStart(e)})),this.trigger("restoringStart",{stm:this})}},{key:"notifyStoresAboutStateRestoringStop",value:function(){var e=this;this.forEachStore((function(t){t.onStmRestoringStop&&t.onStmRestoringStop(e)})),this.trigger("restoringStop",{stm:this})}},{key:"notifyStoresAboutQueueReset",value:function(e){var t=this;this.forEachStore((function(n){n.onStmQueueReset&&n.onStmQueueReset(t,e)})),this.trigger("queueReset",{stm:this,options:e})}},{key:"onModelUpdate",value:function(e,t,n){Yl(this,this.state.onModelUpdate,e,t,n)}},{key:"onModelInsertChild",value:function(e,t,n,r){Yl(this,this.state.onModelInsertChild,e,t,n,r)}},{key:"onModelRemoveChild",value:function(e,t,n){Yl(this,this.state.onModelRemoveChild,e,t,n)}},{key:"onStoreModelAdd",value:function(e,t,n){Yl(this,this.state.onStoreModelAdd,e,t,n)}},{key:"onStoreModelInsert",value:function(e,t,n,r,i){Yl(this,this.state.onStoreModelInsert,e,t,n,r,i)}},{key:"onStoreModelRemove",value:function(e,t,n,r){Yl(this,this.state.onStoreModelRemove,e,t,n,r)}},{key:"onStoreRemoveAll",value:function(e,t,n){Yl(this,this.state.onStoreRemoveAll,e,t,n)}},{key:"onUndoKeyPress",value:function(e){this.disabled||(e.shiftKey?this.canRedo&&(e.preventDefault(),this.redo()):this.canUndo&&(e.preventDefault(),this.undo()))}}],[{key:"defaultConfig",get:function(){return{disabled:!0,autoRecord:!1,autoRecordTransactionStopTimeout:100,makeModelUpdateAction:Nl,makeModelInsertChildAction:zl,makeModelRemoveChildAction:Vl,makeStoreModelAddAction:Wl,makeStoreModelInsertAction:$l,makeStoreModelRemoveAction:Ul,makeStoreRemoveAllAction:Gl,getTransactionTitle:null}}}]),a}(Ot($e));ql._$name="StateTrackingManager";n(174);function Kl(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Xl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xl(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Xl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zl(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ql=Array.prototype.slice,eu=Object.freeze([]),tu=Object.freeze({}),nu=/[&<]/,ru=Object.getPrototypeOf,iu=Object.prototype.toString,ou=Qn.isEqual,au=Qn.isObject,su={_element:1,parent:1,elementData:1,ns:1,syncOptions:1},lu=function(){return{ignore:su,refsFound:new Set}},uu={class:1,className:1,classname:1},cu={bigint:1,boolean:1,function:1,number:1,string:1,symbol:1},fu={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,_element:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1},du=function(){function e(){B()(this,e)}return _()(e,null,[{key:"checkEquality",value:function(t,n,r,i){if(t===n)return!0;if(null==t)return null==n;if(!t||!n)return!1;var o=I()(t);if(o!==I()(n)||cu[o])return!1;var a,s,l,u,c,f=r.equalityCache||(r.equalityCache=new Map);if(void 0===(a=(f=f.get(t)||f.set(t,new Map).get(t)).get(n))){if(a=!0,ru(t)!==ru(n)||t instanceof Node)a=!1;else if(Array.isArray(t)){if((s=t.length)!==n.length)a=!1;else for(;s-- >0;)if(!e.checkEquality(t[s],n[s],r,i)){a=!1;break}}else{var d;for(u in null!==(d=t.syncOptions)&&void 0!==d&&d.ignoreRefs&&(i=!0),l=r.ignore||tu,n)if(!(l[u]||u in t||i&&"reference"===u)){a=!1;break}if(a)if("[object Date]"===iu.call(n))a=t.getTime()===n.getTime();else for(u in t)if(!(l[u]||i&&"reference"===u)){if(!(u in n)){a=!1;break}if(c=t[u],!e.checkEquality(c,n[u],r,i)){a=!1;break}}}var h;if(!i&&au(t)&&t.reference)null===(h=r.refsFound)||void 0===h||h.add(t.reference);f.set(n,a)}return a}},{key:"sync",value:function(t){var n,r,i,o,a=t,s=t.refOwner,l=null==s?void 0:s.byRef,u=lu(),c=t.affected;if("string"==typeof c&&(c=[c]),t=Jl(Jl({},t),{},{checkEqualityOptions:u}),s){if(s.byRef={},c)for(r in l)c.includes(r)||(s.byRef[r]=l[r]);t.refsWas=l}if(a.changed=e.performSync(t,t.targetElement),s)for(c||(c=Object.keys(l)),n=0;n<c.length;++n)i=l[r=c[n]],u.refsFound.has(r)||i.retainElement?s.byRef[r]=i:(o=i.lastDomConfig,i.remove(),s.detachRef(r,i,o));return t.targetElement}},{key:"performSync",value:function(t,n){var r=t.domConfig,i=t.callback,o=n.lastDomConfig;return(t.configEquality||e.checkEquality)(r,o,t.checkEqualityOptions,t.ignoreRefs)?(r._element||e.relinkElements(r,n),null==i||i({action:"none",domConfig:r,targetElement:n}),!1):(r?(r.onlyChildren||(e.syncAttributes(r,n,t),e.syncContent(r,n)),e.syncChildren(t,n),r._element=n):(n.innerHTML=null,n.syncIdMap=null),n.lastDomConfig=null!=r&&r.onlyChildren&&o?Jl(Jl({},o),{},{children:r.children}):r,!0)}},{key:"relinkElements",value:function(t,n){var r;t.retainElement||(t._element=n,null===(r=t.children)||void 0===r||r.forEach((function(t,r){!t||"string"==typeof t||t instanceof Node||e.relinkElements(t,n.lastDomConfig.children[r]._element)})))}},{key:"syncDataset",value:function(e,t){var n,r,i,o,a=t.lastDomConfig,s=e===a,l=Object.keys(e.dataset),u=a&&a.dataset&&Object.keys(a.dataset),c=it.delta(l,u);for(r=0;r<c.onlyInA.length;r++)n=c.onlyInA[r],null!=(o=e.dataset[n])&&t.setAttribute("data-".concat(te.hyphenate(n)),o);for(r=0;r<c.inBoth.length;r++)n=c.inBoth[r],o=e.dataset[n],(s||o!=a.dataset[n])&&(i="data-".concat(te.hyphenate(n)),null==o?t.removeAttribute(i):t.setAttribute(i,o));for(r=0;r<c.onlyInB.length;r++)t.removeAttribute("data-".concat(te.hyphenate(c.onlyInB[r])))}},{key:"addCls",value:function(e,t){var n=t.lastDomConfig;(e=xr.normalize(e,"array")).forEach((function(e){t.classList.add(e),function(e,t){var n="className"in t?"className":"class",r=t[n];if(r)if("string"==typeof r){var i=r.split(" ");i.includes(e)||(i.push(e),t[n]=i.join(" "))}else Array.isArray(r)?r.includes(e)||r.push(e):r.isDomClassList?r.add(e):Qn.isObject(r)&&(r[e]=1)}(e,n)}))}},{key:"removeCls",value:function(e,t){var n=t.lastDomConfig;(e=xr.normalize(e,"array")).forEach((function(e){t.classList.remove(e),function(e,t){var n="className"in t?"className":"class",r=t[n];if(r)if("string"==typeof r){var i=r.split(" ");i.includes(e)&&(i.splice(i.indexOf(e),1),t[n]=i.join(" "))}else Array.isArray(r)?r.includes(e)&&r.splice(r.indexOf(e),1):r.isDomClassList?r.remove(e):Qn.isObject(r)&&delete r[e]}(e,n)}))}},{key:"syncClassList",value:function(e,t,n){var r,i,o,a,s,l,u=e.className||e.class;if(n){for(i=xr.normalize(t,"array"),u=xr.normalize(u,"object"),l=xr.normalize(n.className||n.class,"object"),s=[],o=0,a=i.length;o<a;++o)!u[r=i[o]]&&r in l||(l[r]=1,s.push(r));for(r in u)l[r]||s.push(r);u=s.join(" ")}else u=xr.normalize(u);t.setAttribute("class",u)}},{key:"getSyncAttributes",value:function(e){var t={},n=[];return e&&Object.keys(e).forEach((function(r){if(!fu[r]){var i=r.toLowerCase();t[i]=e[r],n.push(i)}})),{attributes:t,names:n}}},{key:"syncAttributes",value:function(t,n,r){for(var i=n.lastDomConfig,o=t===i,a=e.getSyncAttributes(t),s=a.attributes,l=a.names,u=o?a:e.getSyncAttributes(i),c=u.attributes,f=u.names,d=o?{onlyInA:eu,onlyInB:eu,inBoth:l}:it.delta(l,f),h=d.onlyInA,v=d.onlyInB,p=d.inBoth,g=0;g<h.length;g++){var y=h[g],m=s[y];"style"===y&&null!=m?mi.applyStyle(n,m,!0):"dataset"===y?e.syncDataset(t,n):uu[y]?e.syncClassList(t,n):null!=m&&n.setAttribute(y,m)}for(var b=0;b<v.length;b++)n.removeAttribute(v[b]);for(var k=0;k<p.length;k++){var w=p[k],C=s[w],R=c[w];null==C?n.removeAttribute(w):"style"===w?r.strict?o?e.syncStyles(n,C):ou(C,R,!0)||e.syncStyles(n,C,R):!o&&ou(C,R,!0)||mi.applyStyle(n,C,!0):"dataset"===w?e.syncDataset(t,n):uu[w]?e.syncClassList(t,n,r.strict&&n.lastDomConfig):(o||C!==R)&&n.setAttribute(w,C)}}},{key:"syncStyles",value:function(e,t,n){var r,i,o;if(n){if(r={},t=mi.parseStyle(t),n=mi.parseStyle(n),t)for(i in t)o=t[i],n[i]!==o&&(r[i]=o);for(i in n)i in t||(r[i]="")}else r=t;mi.applyStyle(e,r)}},{key:"syncContent",value:function(e,t){var n=e.html,r=e.text,i=null!=r?r:n;e.elementData&&(t.elementData=e.elementData),i instanceof DocumentFragment?1===t.childNodes.length&&0===mi.getChildElementCount(t)&&1===i.childNodes.length&&0===mi.getChildElementCount(i)?mi.setInnerText(t,i.firstChild.data):(t.innerHTML="",t.appendChild(i)):null!=n&&nu.test(n)?t.innerHTML=String(n):null!=i&&mi.setInnerText(t,String(i))}},{key:"insertTextNode",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=document.createTextNode(e);t.insertBefore(o,i),r&&(o.$refOwnerId=r.id),null==n||n({action:"newNode",domConfig:e,targetElement:o})}},{key:"insertElement",value:function(t,n,r,i,o,a,s){var l,u=s.ns?document.createElementNS(s.ns,t.tag||"svg"):document.createElement(t.tag||"div");n.insertBefore(u,r),e.performSync(s,u),null!=a&&(o[a]=u),i&&(u.$refOwnerId=i.id,a&&(u.$reference=a,i.attachRef(a,u,t))),null===(l=s.callback)||void 0===l||l.call(s,{action:"newElement",domConfig:t,targetElement:u,syncId:a})}},{key:"syncChildren",value:function(t,n){var r,i,o,a,s=t.domConfig,l=t.syncIdField,u=t.callback,c=t.releaseThreshold,f=t.configEquality,d=t.ns,h=t.refOwner,v=t.refsWas,p=t.strict,g=t.checkEqualityOptions,y=t.ignoreRefs,m=s.syncOptions||{},b=null,k=!0;if(!(null!==(r=s.html)&&void 0!==r?r:s.text)){m.ignoreRefs&&(y=!0),y&&(h=v=null),"strict"in m&&(p=m.strict),!1===m.hoistReferences&&(v=h=k=!1);var w=h?h.byRef:{},C=Ql.call(s.children||[]),R=Ql.call(n.childNodes),S=v||n.syncIdMap||{},x=n.releasedIdMap||{},E=function(e){for(;R.length&&R[0].parentNode!==n;)R.shift();return(e?R.shift():R[0])||null};l=m.syncIdField||l,p=m.strict||p,u=m.callback||u,f=m.configEquality||f,c="releaseThreshold"in m?m.releaseThreshold:c,l&&(n.syncIdMap=w);for(var D={checkEqualityOptions:g||lu(),ignoreRefs:y,refOwner:h,refsWas:v,strict:p,syncIdField:l,releaseThreshold:c,callback:u,configEquality:f,hoistReferences:k};C.length;){var T=C.shift();if(a=null,T)if(T instanceof Node)T!==(o=E())&&n.insertBefore(T,o),(i=R.indexOf(T))>-1&&R.splice(i,1);else{var O="string"==typeof T;if(D.domConfig=T,D.ns=T.ns||d,!O){if(h?a=T.reference:l&&T.dataset&&(a=T.dataset[l]),null!=a&&!T.unmatched){var M=S[a]||x[a];if(M){var A=M.lastDomConfig;if(M.retainElement)e.relinkElements(D.domConfig,M);else if(e.performSync(D,M)){var I;null===(I=u)||void 0===I||I({action:"reuseOwnElement",domConfig:T,targetElement:M,lastDomConfig:A,syncId:a})}T.retainElement&&(M.retainElement=!0,T._element=M),w[a]=M,it.remove(R,M),delete x[a],M.isReleased=!1,o=E(),(M.parentNode!==n||p&&M.nextSibling!==o)&&n.insertBefore(M,o)}else p?e.insertElement(T,n,E(),h,w,a,D):(C.push(T),T.unmatched=!0);continue}T.unmatched&&delete T.unmatched}for(var P=null,F=null,L=void 0;!F&&(L=E(!0));){if(h){if(L.$refOwnerId!==h.id)continue;if(L.$reference){if(!p)continue;P=L;break}F=L}else L.retainElement||(F=L);F||(b||(b=[])).push(L)}if(P||!F)O?e.insertTextNode(T,n,u,h,P):e.insertElement(T,n,P,h,w,a,D);else if(O||F.nodeType!==Node.ELEMENT_NODE||(T.tag||"div").toLowerCase()!==F.tagName.toLowerCase())O&&F.nodeType===Node.TEXT_NODE?F.data=T:(O?e.insertTextNode(T,n,u,h,F):e.insertElement(T,n,F,h,w,a,D),F.remove());else{var B,j,_=F.lastDomConfig,H=e.performSync(D,F);l&&null!=(null==_||null===(B=_.dataset)||void 0===B?void 0:B[l])&&delete x[_.dataset[l]],null!=a&&(w[a]=F),F.isReleased=!1,H&&(null===(j=u)||void 0===j||j({action:"reuseElement",domConfig:T,targetElement:F,lastDomConfig:_,syncId:a}))}}}for(;o=E(!0);)h&&(o.$refOwnerId!==h.id||o.$reference)||(b||(b=[])).push(o);b&&e.syncChildrenCleanup(n,b,w,u,h,c,l)}}},{key:"syncChildrenCleanup",value:function(e,t,n,r,i,o,a){var s,l,u=0,c=Kl(t);try{for(c.s();!(l=c.n()).done;){var f=l.value,d=f.lastDomConfig;f.retainElement?a&&d&&(n[f.dataset[a]]=f):!i&&a&&(null==o||u<o)?(f.isReleased||(f.className="b-released",f.isReleased=!0,null!=d&&d.dataset&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[d.dataset[a]]=f),null==r||r({action:"releaseElement",domConfig:d,lastDomConfig:d,targetElement:f}),d&&(d.isReleased=!0,d.className&&(d.className="b-released"),d.style&&(d.style=null))),u++):(f.remove(),i&&(s=f.$reference)&&i.detachRef(s,f,d),e.releasedIdMap&&a&&null!=d&&d.dataset&&delete e.releasedIdMap[d.dataset[a]],null==r||r({action:"removeElement",domConfig:f.lastDomConfig,lastDomConfig:f.lastDomConfig,targetElement:f}))}}catch(e){c.e(e)}finally{c.f()}}},{key:"removeChild",value:function(e,t){if(e.contains(t)){var n=e.syncIdMap;if(n){var r=Object.values(n).indexOf(t);r>-1&&delete n[Object.keys(n)[r]]}e.removeChild(t)}}},{key:"addChild",value:function(e,t,n){e.appendChild(t),e.syncIdMap[n]=t}},{key:"getChild",value:function(e,t){var n,r=Kl(String(t).split("."));try{for(r.s();!(n=r.n()).done;){var i=n.value;e=e.syncIdMap[i]}}catch(e){r.e(e)}finally{r.f()}return e}}]),e}();du._$name="DomSync";var hu=function(){function e(){B()(this,e)}return _()(e,null,[{key:"init",value:function(){var e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=function(t){return e.map((function(e){var n=t+te.capitalize(e);return"moz"===t&&(n=n.replace("screen","Screen"),"mozCancelFullScreen"in document&&"exitFullscreen"===e&&(n="mozCancelFullScreen")),n}))};this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];var n=["fullscreenchange","fullscreenerror"],r=function(e){return n.map((function(t){return e+te.capitalize(t)}))};this.events="fullscreenEnabled"in document&&n||"webkitFullscreenEnabled"in document&&r("webkit")||"mozFullscreenEnabled"in document&&r("moz")||"msFullscreenEnabled"in document&&["MSFullscreenChange","MSFullscreenError"]||[]}},{key:"enabled",get:function(){return document[this.functions[0]]}},{key:"request",value:function(e){return e[this.functions[1]]()}},{key:"exit",value:function(){return document[this.functions[2]]()}},{key:"isFullscreen",get:function(){return!!document[this.functions[3]]}},{key:"onFullscreenChange",value:function(e){document.addEventListener(this.events[0],e)}},{key:"unFullscreenChange",value:function(e){document.removeEventListener(this.events[0],e)}}]),e}();function vu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function pu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}hu.init(),hu._$name="Fullscreen";var gu=null,yu=[],mu=function(e){var t;return e.nodeType===e.ELEMENT_NODE&&"absolute"===(null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).getPropertyValue("position"))},bu=function(){function e(){B()(this,e)}return _()(e,null,[{key:"addResizeListener",value:function(e,t){var n=this;if(e!==document&&e!==window||(e=document.body),e.nodeType===e.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)n.hasWindowResizeListener||(window.addEventListener("resize",n.onWindowResize),n.hasWindowResizeListener=!0);else if(window.ResizeObserver)n.resizeObserver||(n.resizeObserver=new ResizeObserver(n.onElementResize)),n.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");var r=mi.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},!0),i=N()(r,3),o=i[0],a=i[1],s=i[2];a.scrollLeft=a.scrollTop=s.scrollLeft=s.scrollTop=1e6,a.addEventListener("scroll",n.onSizeMonitorScroll,!0),s.addEventListener("scroll",n.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver((function(e){var t,n=[],r=vu(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;"childList"===i.type&&(n.push.apply(n,i.removedNodes),n.push.apply(n,i.addedNodes))}}catch(e){r.e(e)}finally{r.f()}n.length>0&&n.every(mu)||(!pe.a.isEdge&&!pe.a.isIE11||a.classList.contains("b-resize-monitor-expand"))&&a.dispatchEvent(new CustomEvent("scroll",{bubbles:!1}))}))).observe(e,{childList:!0,subtree:!0}),t.monitorElement=o}e._bResizemonitor.handlers.push(t)}},{key:"removeResizeListener",value:function(e,t){if(e){e!==document&&e!==window||(e=document.body);var n=e._bResizemonitor,r=0;n&&n.handlers&&(it.remove(n.handlers,t),r=n.handlers.length),r||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}},{key:"onElementResize",value:function(e){var t,n=vu(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.target,o=i._bResizemonitor,a=r.contentRect||i.getBoundingClientRect();if(i.offsetParent&&(!o.rectangle||a.width!==o.rectangle.width||a.height!==o.rectangle.height)){var s=o.rectangle;o.rectangle=a;var l,u=vu(o.handlers);try{for(u.s();!(l=u.n()).done;){(0,l.value)(i,s,a)}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){n.e(e)}finally{n.f()}}},{key:"onSizeMonitorScroll",value:function(t){var n;if(null!==(n=document.body)&&void 0!==n&&n.contains(t.target)){t.stopImmediatePropagation();var r=t.target.parentNode,i=r.parentNode,o=i._bResizemonitor,a=i.getBoundingClientRect();o.rectangle&&a.width===o.rectangle.width&&a.height===o.rectangle.height||(yu.push([i,o.rectangle,a]),o.rectangle=a,gu||(gu=requestAnimationFrame(e.fireResizeEvents))),r.firstChild.scrollLeft=r.firstChild.scrollTop=r.childNodes[1].scrollTop=r.childNodes[1].scrollLeft=1e6}}},{key:"onWindowResize",value:function(e){var t=document.body,n=t._bResizemonitor,r=n.rectangle;n.rectangle=document.documentElement.getBoundingClientRect();var i,o=vu(n.handlers);try{for(o.s();!(i=o.n()).done;){(0,i.value)(t,r,n.rectangle)}}catch(e){o.e(e)}finally{o.f()}}},{key:"fireResizeEvents",value:function(){var e,t=vu(yu);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,i=vu(r[0]._bResizemonitor.handlers);try{for(i.s();!(n=i.n()).done;){var o=n.value;r[0].offsetParent&&o.apply(this,r)}}catch(e){i.e(e)}finally{i.f()}}}catch(e){t.e(e)}finally{t.f()}gu=null,yu.length=0}}]),e}();function ku(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bu._$name="ResizeMonitor";var wu=function(e){Ye()(n,e);var t=ku(n);function n(e,r){return B()(this,n),t.call(this,e,r,0,0)}return _()(n,[{key:"constrain",value:function(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}},{key:"toArray",value:function(){return[this.x,this.y]}}],[{key:"from",value:function(e){var t=e.changedTouches;return new n(t?t[0].screenX:e.screenX,t?t[0].screenY:e.pageY)}}]),n}(Cr);Object.getPrototypeOf(wu).Point=wu,wu._$name="Point";var Cu=["clientX","clientY","pageX","pageY","screenX","screenY"],Ru={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1},Su={get:function(){return!0}},xu={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},Eu={Meta:1,Control:1,Alt:1};function Du(e,t){for(var n,r;(e=Object.getPrototypeOf(e))&&!r;)r=(n=Object.getOwnPropertyDescriptor(e,t))&&n.get;return r}var Tu=function(){function e(){B()(this,e)}var t;return _()(e,null,[{key:"normalizeEvent",value:function(e){return Qn.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],Cu)}},{key:"getXY",value:function(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}},{key:"getDistanceBetween",value:function(e,t){var n=Ou.getXY(e),r=Ou.getXY(t);return Math.sqrt(Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2))}},{key:"getPagePoint",value:function(e){return new Cr.Point(e.pageX,e.pageY)}},{key:"getClientPoint",value:function(e){return new Cr.Point(e.clientX,e.clientY)}},{key:"addListener",value:function(e,t,n,r){return r=e.nodeType?"string"==typeof t?Object.assign(Qe()({element:e},t,n),r):Object.assign({element:e},t):e,Ou.on(r)}},{key:"on",value:function(e){var t=e.element,n=e.thisObj,r=[];for(var i in e)if(!Ru[i]){var o=e[i];"object"!==I()(o)&&(o={handler:o});var a=o.element||t;pe.a.isTouchDevice&&!pe.a.isAndroid&&"contextmenu"===i&&r.push(Ou.addElementListener(a,"touchstart",{handler:Ou.createContextMenuWrapper(o.handler,o.thisObj||n)},e)),r.push(Ou.addElementListener(a,i,o,e))}var s=function(){for(var e,t=0;t<r.length;t++)e=r[t],Ou.removeEventListener(e[0],e[1],e[2]);r.length=0};return n&&!1!==e.autoDetach&&(n.doDestroy=at.createInterceptor(n.doDestroy,s,n)),s}},{key:"addElementListener",value:function(e,t,n,r){var i=Ou.createHandler(e,t,n,r),o="passive"in n,a=n.expires||r.expires,s=n.capture||r.capture;if((o||"passive"in r)&&pe.a.supportsPassive&&(s={capture:!!s,passive:o?n.passive:r.passive}),e.addEventListener(t,i,s),a){var l=n.thisObj||r.thisObj,u=null!=l&&l.isDelayable?l:window,c=a.alt,f=c?a.delay:a,d=i.spec;d.expires=a,d.timerId=u["number"==typeof f?"setTimeout":"requestAnimationFrame"]((function(){d.timerId=null,Ou.removeEventListener(e,t,i),c&&!i.called&&("string"==typeof c?l[c]:c).call(l)}),f,"listener-timer-".concat(performance.now()))}return[e,t,i,s]}},{key:"fixEvent",value:function(e){var t,n,r,i,o=e.type;if(o.startsWith("key")){var a=xu[e.key];a&&Object.defineProperty(e,"key",{get:function(){return a}})," "!==e.key||e.code||Object.defineProperty(e,"code",{get:function(){return"Space"}})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",Su),null!==(t=e.target)&&void 0!==t&&t.shadowRoot&&e.composedPath&&!pe.a.isIE11&&!pe.a.isEdge){var s=e.composedPath()[0],l=e.target;e.target!==s&&(Object.defineProperty(e,"target",{get:function(){return s},configurable:!0}),Object.defineProperty(e,"originalTarget",{get:function(){return l},configurable:!0}))}if(pe.a.isChrome&&e.target&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"offsetX")||Object.defineProperty(e,"offsetX",{get:function(){var t=Du(e,"offsetX").call(e),n=e.target.offsetWidth,r=Math.min(Math.max(t,0),n-1);return t<0||t>=n?r:t}}),Object.getOwnPropertyDescriptor(e,"offsetY")||Object.defineProperty(e,"offsetY",{get:function(){var t=Du(e,"offsetY").call(e),n=e.target.offsetHeight,r=Math.min(Math.max(t,0),n-1);return t<0||t>=n?r:t}})),(null===(n=e.target)||void 0===n?void 0:n.nodeType)===Element.DOCUMENT_NODE&&"clientX"in e){var u=mi.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{get:function(){return u}})}if((null===(r=e.target)||void 0===r?void 0:r.nodeType)===Element.TEXT_NODE){var c=e.target.parentElement;Object.defineProperty(e,"target",{get:function(){return c}})}if((null===(i=e.relatedTarget)||void 0===i?void 0:i.nodeType)===Element.TEXT_NODE){var f=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{get:function(){return f}})}return o.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}},{key:"createHandler",value:function(e,t,n,r){var i=n.delay||r.delay,o=n.throttled||r.throttled,a=n.block||r.block,s=n.once||r.once,l=n.thisObj||r.thisObj,u=n.capture||r.capture,c=n.delegate||r.delegate,f=n.handler,d=function(e){var t;if(d.called=!0,!(Ou.playingDemo&&e.isTrusted||l&&l.isDestroyed)){if(e=Ou.fixEvent(e),c){var n,r=(null===(n=e.target.closest)||void 0===n?void 0:n.call)&&e.target.closest(c);if(!r)return;Object.defineProperty(e,"currentTarget",{get:function(){return r},configurable:!0})}for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(t="string"==typeof f?l[f]:f).call.apply(t,[l,e].concat(o))}};if(a){var h,v,p=d;d=function(e){var t=performance.now();if(!h||e.target!==v||t-h>a){v=e.target,h=t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];p.apply(void 0,[e].concat(r))}}}if(null!=i){var g=d,y=l&&l.setTimeout?l:window;d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.setTimeout((function(){g.apply(void 0,t)}),i)}}if(null!=o){var m,b=o;o.buffer&&(m=function(e){return o.alt.call(Ou,Ou.fixEvent(e))},b=o.buffer),d=l&&l.isDelayable?l.throttle(d,{delay:b,throttled:m}):at.createThrottled(d,b,l,null,m)}if(s){var k=d;d=function(){Ou.removeEventListener(e,t,d),k.apply(void 0,arguments)}}return n.thisObj&&!1!==n.autoDetach&&(l.doDestroy=at.createInterceptor(l.doDestroy,(function(){return Ou.removeEventListener(e,t,d)}),l)),d.spec={delay:i,throttled:o,block:a,once:s,thisObj:l,capture:u,delegate:c},d}},{key:"removeEventListener",value:function(e,t,n){var r=n.spec,i=r.expires,o=r.timerId,a=r.thisObj,s=r.capture;null!=i&&i.alt&&o&&(null!=a&&a.isDelayable?a:window)["number"==typeof i.delay?"clearTimeout":"cancelAnimationFrame"](o);e.removeEventListener(t,n,s)}},{key:"onTransitionEnd",value:function(e){var t,n=e.element,r=e.property,i=e.handler,o=e.mode,a=void 0===o?"transition":o,s=e.duration,l=void 0===s?mi["get".concat("transition"===a?"Property":"").concat(te.capitalize(a),"Duration")](n,r):s,u=e.thisObj,c=void 0===u?window:u,f=e.args,d=void 0===f?[]:f,h=[n,r].concat(F()(d)),v=c.isDelayable?c:window,p=function(){g(),c.isDestroyed||(c.callback?c.callback(i,c,h):i.apply(c,h))},g=Ou.on(Qe()({element:n},"".concat(a,"end"),(function(e){var i=e.propertyName,o=e.target;i===r&&o===n&&(t&&(v.clearTimeout(t),t=null),p())})));return null!=l&&(t=v.setTimeout(p,l+50)),g}},{key:"waitForTransitionEnd",value:(t=Pt()(At.a.mark((function t(n){return At.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){n.handler=t,e.onTransitionEnd(n)})));case 1:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})},{key:"createContextMenuWrapper",value:function(e,t){return function(n){if(1===n.touches.length)var r=n.touches[0],i=setTimeout((function(){a();var i=new MouseEvent("contextmenu",r);Object.defineProperty(i,"target",{get:function(){return r.target}}),"string"==typeof e&&(e=t[e]),i.browserEvent=n,e.call(t,i),Ou.contextMenuTouchId=r.identifier}),Ou.longPressTime),o=function(e){var t=e.clientX,n=e.clientY,o=e.type,s="touchend"===o||"pointerup"===o;if(!s){var l=Math.abs(t-r.clientX),u=Math.abs(n-r.clientY);s=l>=5||u>=5}s&&(Ou.contextMenuTouchId=null,a(),clearTimeout(i))},a=Ou.on({element:document,touchmove:o,touchend:o,pointermove:o,pointerup:o,capture:!0})}}},{key:"createDblClickWrapper",value:function(e,t,n){var r,i,o;return function(){i||(i=Ou.on({element:e,touchstart:function(e){r=e.changedTouches[0].identifier,e.preventDefault()},touchend:function(e){if(e.changedTouches[0].identifier===r){e.preventDefault(),clearTimeout(o),r=i=null;var a=Cr.from(e.changedTouches[0].target,null,!0),s=e.changedTouches[0].pageX-a.x,l=e.changedTouches[0].pageY-a.y,u=Object.assign({browserEvent:e},e),c=new MouseEvent("dblclick",u);Object.defineProperty(c,"target",{get:function(){return e.target}}),Object.defineProperty(c,"offsetX",{get:function(){return s}}),Object.defineProperty(c,"offsetY",{get:function(){return l}}),"string"==typeof t&&(t=n[t]),t.call(n,c)}},once:!0}),o=setTimeout((function(){i(),r=i=null}),Ou.dblClickTime))}}}]),e}(),Ou=Tu;function Mu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ou.longPressTime=500,Ou.dblClickTime=300,Ou.on({element:document,mousedown:function(e){var t=e.target;if(!mi.isTouchEvent){var n,r=mi.getRootElement(t);mi.usingKeyboard=!1,null===(n=r.classList)||void 0===n||n.remove("b-using-keyboard"),mi.removeClsGlobally(r,"b-using-keyboard")}},touchmove:function(e){var t,n=e.changedTouches[0].target,r=mi.getRootElement(n);mi.usingKeyboard=!1,null===(t=r.classList)||void 0===t||t.remove("b-using-keyboard"),mi.removeClsGlobally(r,"b-using-keyboard")},keydown:function(e){var t=e.target,n=e.key;if(!Eu[n]){mi.usingKeyboard=!0;var r=mi.getRootElement(t);r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Array.from(r.children).forEach((function(e){e.matches(".b-outer")&&e.classList.add("b-using-keyboard")})):r.classList.add("b-using-keyboard")}}}),pe.a.isTouchDevice&&Ou.on({element:document,touchmove:function(e){e.target.closest(".b-dragging")&&e.preventDefault()},passive:!1,capture:!0}),Tu._$name="EventHelper";var Au={true:"auto",false:"hidden","hidden-scroll":"auto"},Iu="b-widget-scroller",Pu={block:"nearest"},Fu=Promise.resolve(),Lu=function(e){return new Promise((function(t){return Tu.on({element:e,scroll:t,once:!0})}))},Bu={x:1},ju=function(e){Ye()(n,e);var t=Mu(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"syncOverflowState",value:function(){var e=this.element,t=e.classList;pe.a.isEdge?t[e.scrollWidth-e.clientWidth>1?"add":"remove"]("b-horizontal-overflow"):t[e.scrollWidth>e.clientWidth?"add":"remove"]("b-horizontal-overflow"),t[e.scrollHeight>e.clientHeight?"add":"remove"]("b-vertical-overflow")}},{key:"hasScrollbar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y",t=this.element;if(t&&mi.scrollBarWidth){var n="y"===e,r=n?"Width":"Height",i=t["client".concat(r)],o=parseInt(mi.getStyleValue(t,"border".concat(n?"Left":"Top","Width")))+parseInt(mi.getStyleValue(t,"border".concat(n?"Right":"Bottom","Width"))),a=t["offset".concat(r)]-o-i;return Math.abs(a-mi.scrollBarWidth)<2}}},{key:"addPartner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bu,n=this;"string"==typeof t&&(t=Qe()({},t,1)),n.partners||(n.partners={}),n.partners[e.id]={scroller:e,axes:t},t.x&&(e.x=n.x),t.y&&(e.y=n.y),e.isPartneredWith(n)||e.addPartner(n,t)}},{key:"eachPartner",value:function(e){var t=this.partners;t&&Object.values(t).forEach(e)}},{key:"removePartner",value:function(e){this.isPartneredWith(e)&&(delete this.partners[e.id],e.removePartner(this))}},{key:"isPartneredWith",value:function(e){return Boolean(this.partners&&this.partners[e.id])}},{key:"scrollIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pu,n=this,r=e instanceof Cr,i=r?e:Cr.from(e),o=n.getDeltaTo(e,t),a=o.xDelta,s=o.yDelta,l=n.scrollBy(a,s,t);return(t.highlight||t.focus)&&l.then((function(){r&&(e=i.translate(-a,-s)),t.highlight&&(isNaN(t.highlight)?(n.widget||n).callback(t.highlight,null,[e]):mi.highlight(e,n)),t.focus&&e.focus()})),l}},{key:"scrollBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pu,r=this,i="object"===I()(n)?n.animate:n,o=Math.abs(e),a=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=n.silent);var s=i&&("number"==typeof i?i:"number"==typeof i.duration?i.duration:300);if(s&&(o>10||a>10)){var l=r.x,u=r.y,c=l,f=u;return Math.max(o,a)<50&&(s=Math.min(s,500)),r.scrollAnimation=at.animate(s,(function(i){var o=1===i;if(e){if(r.x!==c&&!n.force)return r.scrollAnimation&&r.scrollAnimation.cancel();r.x=Math.max(l+(o?e:Math.round(e*i)),0)}if(t){if(r.y!==f&&!n.force)return r.scrollAnimation&&r.scrollAnimation.cancel();r.y=Math.max(u+(o?t:Math.round(t*i)),0)}c=r.x,f=r.y}),r,i.easing),r.element.classList.add("b-scrolling"),r.scrollAnimation.then((function(){r.isDestroyed||(r.element.classList.remove("b-scrolling"),r.scrollAnimation=null)})),r.scrollAnimation}return e|t?(r.x+=e,r.y+=t,Lu(r.element)):Fu}},{key:"scrollTo",value:function(e,t,n){var r=this.x,i=this.y,o=null==e?0:e-r,a=null==t?0:t-i;return this.scrollBy(o,a,n)}},{key:"doDestroy",value:function(){var e=this;e._element&&(e._element.removeEventListener("scroll",e.scrollHandler),e.wheelListenerRemover&&e.wheelListenerRemover()),e.scrollAnimation&&e.scrollAnimation.cancel(),Object.values(e.partners||{}).forEach((function(t){return t.scroller.removePartner(e)})),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"onElMutation",value:function(e){var t=this,n=mi.getTranslateXY(t.element),r=N()(n,2),i=r[0],o=r[1];if(t._x!==-i||t.y!==-o){var a=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(a,"target",{get:function(){return t.element}}),t.onScroll(a)}}},{key:"onScroll",value:function(e){var t=this;t.widget&&t.widget.isDestroyed||(t.positionDirty=!0,t.element.classList.contains("b-scrolling")||t.element.classList.add("b-scrolling"),e.widget=t.widget,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.onScrollEnd(e))}},{key:"syncPartners",value:function(e){var t=this;t.partners&&Object.values(t.partners).forEach((function(n){var r=n.axes,i=n.scroller;(i!==t.controllingPartner||e)&&i.sync(t,r)}))}},{key:"onScrollEnd",value:function(e){this.silent&&(this.silent=!1),this.trigger("scrollEnd",e),this.controllingPartner=null,this.element.classList.remove("b-scrolling")}},{key:"getDeltaTo",value:function(e,t){var n=this;if(!n.viewport)return{xDelta:0,yDelta:0};var r=e instanceof Cr?e:Cr.from(e),i=t.block||"nearest",o=n.viewport,a=t.edgeOffset||0,s=o.width>=r.width+2*a?a:0,l=o.height>=r.height+2*a?a:0,u=r.clone().adjust(-s,-l,s,l).constrainTo(new Cr(o.x-n.x,o.y-n.y,n.scrollWidth,n.scrollHeight)),c=u.clone(),f=0,d=0;if("start"===i)c.moveTo(o.x,o.y),f=u.x-c.x,d=u.y-c.y;else if("end"===i)c.translate(o.right-c.right,o.bottom-c.bottom),f=u.x-c.x,d=u.y-c.y;else if("center"===i){var h=o.center;c.moveTo(h.x-c.width/2,h.y-c.height/2),f=f||u.x-c.x,d=d||u.y-c.y}else c.width>o.width?f=c.x-o.x:c.right>o.right?f=c.right-o.right:c.x<o.x&&(f=c.x-o.x),c.height>o.height?d=c.y-o.y:c.bottom>o.bottom?d=c.bottom-o.bottom:c.y<o.y&&(d=c.y-o.y);return{xDelta:!1===t.x?0:Math.max(Math.min(Math.round(f),n.maxX-n.x),-n.x),yDelta:!1===t.y?0:Math.max(Math.min(Math.round(d),n.maxY-n.y),-n.y)}}},{key:"viewport",get:function(){return Cr.client(this.element)}},{key:"updateElement",value:function(e,t){var n=this,r=n.scrollHandler||(n.scrollHandler=n.onScroll.bind(n));if(t&&(n.translate?n.mutationObserver&&n.mutationObserver.disconnect(t):(t.removeEventListener("scroll",r),t.classList.remove(Iu),t.style.overflowX=t.style.overflowY="")),n.translate){if(n.mutationObserver||(n.mutationObserver=new MutationObserver((function(e){return n.onElMutation(e)}))),n.mutationObserver.observe(e,{attributes:!0}),n._x=n._y=0,document.contains(e)){var i=mi.getTranslateXY(e),o=N()(i,2),a=o[0],s=o[1];n._x=-a,n._y=-s}}else e&&(e.addEventListener("scroll",r),e.classList.add(Iu));n.positionDirty&&(n.updateOverflowX(n.overflowX),n.updateOverflowY(n.overflowY)),n.isConfiguring&&(n._x&&n.updateX(n._x),n._y&&n.updateY(n._y)),n.positionDirty=!0}},{key:"x",get:function(){var e=this,t=e.element;if(t&&e.positionDirty){if(e.translate){var n=mi.getTranslateXY(t),r=N()(n,2),i=r[0],o=r[1];e._x=-i,e._y=-o}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._x}},{key:"changeX",value:function(e){if(!this.isConfiguring||e)return e;this._x=e}},{key:"updateX",value:function(e){var t=this.element,n=this.widget;!t||null!=n&&n.isConfiguring||(this.trigger("scrollStart",{x:e}),this.translate?mi.setTranslateX(t,-e):t.scrollLeft=e),this.positionDirty=!0}},{key:"sync",value:function(e,t){var n=t.x,r=t.y;null!=n&&this.x!==e.x&&(this.controllingPartner=e,this.x=e.x),null!=r&&this.y!==e.y&&(this.controllingPartner=e,this.y=e.y)}},{key:"y",get:function(){var e=this,t=e.element;if(t&&e.positionDirty){if(e.translate){var n=mi.getTranslateXY(t),r=N()(n,2),i=r[0],o=r[1];e._x=-i,e._y=-o}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}},{key:"changeY",value:function(e){if(!this.isConfiguring||e)return e;this._y=e}},{key:"updateY",value:function(e){var t=this.element,n=this.widget;!t||null!=n&&n.isConfiguring||(this.trigger("scrollStart",{y:e}),this.translate?mi.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}},{key:"maxX",get:function(){return this.scrollWidth-this.clientWidth}},{key:"maxY",get:function(){return this.scrollHeight-this.clientHeight}},{key:"updateOverflowX",value:function(e){var t=this.element,n=this.translate;t&&("hidden-scroll"!==e||n||(t.classList.add("b-hide-scroll"),this.enableWheel()),n||(t.style.overflowX=Au[e]||e)),this.positionDirty=!this.isConfiguring}},{key:"updateOverflowY",value:function(e){var t=this.element,n=this.translate;t&&("hidden-scroll"!==e||n||(t.classList.add("b-hide-scroll"),this.enableWheel()),n||(t.style.overflowY=Au[e]||e)),this.positionDirty=!this.isConfiguring}},{key:"enableWheel",value:function(){pe.a.isChrome||pe.a.isSafari||this.wheelListenerRemover||(this.wheelListenerRemover=Tu.on({element:this.element,wheel:"onWheel",thisObj:this}))}},{key:"onWheel",value:function(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&!1!==this.overflowX?(this.x+=e.deltaX,e.stopPropagation()):!1!==this.overflowY&&(this.y+=e.deltaY,e.stopPropagation())}},{key:"scrollWidth",get:function(){return this.element?this.element.scrollWidth:0},set:function(e){var t=this,n=t.widthStretcher;n&&null==e?(n.remove(),t.widthStretcher=null):e&&(n||(n=t.widthStretcher=mi.createElement({className:"b-scroller-stretcher b-horizontal-stretcher"})),n.style.transform="translateX(".concat(e-1,"px)"),t.element&&t.element.lastChild!==n&&t.element.appendChild(n)),!1!==t.propagate&&t.eachPartner((function(t){var n=t.scroller;n.propagate=!1,n.scrollWidth=e,delete n.propagate})),t.positionDirty=!0,t.syncOverflowState()}},{key:"scrollHeight",get:function(){return this.element?this.element.scrollHeight:0},set:function(e){var t=this,n=t.stretcher||(t.stretcher=mi.createElement({className:"b-scroller-stretcher"}));n.style.transform="translateY(".concat(e-1,"px)"),t.element&&t.element.lastChild!==n&&t.element.appendChild(n),t.positionDirty=!0}},{key:"clientWidth",get:function(){return this.element?this.element.clientWidth:0}},{key:"clientHeight",get:function(){return this.element?this.element.clientHeight:0}},{key:"id",get:function(){return this._id||(this.widget?this._id="".concat(this.widget.id,"-scroller"):this._id=Wo.generateId("scroller-")),this._id}}],[{key:"configurable",get:function(){return{widget:null,element:{$config:{nullify:!0},value:null},overflowX:null,overflowY:null,translate:null,x:0,y:0}}},{key:"delayable",get:function(){return{onScrollEnd:{type:"buffer",delay:100}}}}]),n}(el(Ot($e)));ju._$name="Scroller";var _u="English",Hu={localeName:"En",localeDesc:_u,Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Ok:"OK"},Combo:{noResults:"No results"},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:function(e){return"Value must be less than or equal to ".concat(e.max)},rangeUnderflow:function(e){return"Value must be greater than or equal to ".concat(e.min)},stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},NumberFormat:{locale:"en-US",currency:"USD"},DurationField:{invalidUnit:"Invalid unit"},TimeField:{invalidTime:"Invalid time input"},List:{loading:"Loading..."},GridBase:{loadMask:"Loading...",syncMask:"Saving changes, please wait..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:function(e){return"of ".concat(e.lastPage)},summaryTemplate:function(e){return"Displaying records ".concat(e.start," - ").concat(e.end," of ").concat(e.allCount)}},UndoRedo:{Undo:"Undo",Redo:"Redo",UndoLastAction:"Undo last action",RedoLastAction:"Redo last undone action"},DateHelper:{locale:"en-US",weekStartDay:0,nonWorkingDays:{0:!0,6:!0},weekends:{0:!0,6:!0},unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"},{single:"decade",plural:"decades",abbrev:"dec"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A"},ordinalSuffix:function(e){var t="th";["11","12","13"].find((function(t){return e.endsWith(t)}))||(t={1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th");return e+t}}},Nu=Hu;Yt.registerLocale("En",{desc:_u,locale:Hu});var zu=function e(t){var n=this;B()(this,e),this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t})),t&&t(this)};function Vu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Wu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Wu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}zu._$name="Promissory";var Uu=Reflect.defineProperty,Gu=function(e){Ye()(n,e);var t=$u(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){var e;this.$iid=++n.$idSeed,this.byRef={};for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this].concat(r)),this.onDraw!==n.prototype.onDraw&&this.initDrawable()}},{key:"startConfigure",value:function(e){this.element=this.renderContext.renderDom(),tt()(Ze()(n.prototype),"startConfigure",this).call(this,e)}},{key:"element",get:function(){return this.refreshDom.flush(),this._element}},{key:"changeElement",value:function(e,t){return t&&t.remove(),e&&(e.id=this.id,e=mi.createElement(e,{refOwner:this})),e}},{key:"updateId",value:function(e,t){if(t){var n=this.element;n.id=e,this.fixRefOwnerId(n,e,t)}}},{key:"classes",get:function(){return this.element.classList}},{key:"fixRefOwnerId",value:function(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;var r=e.$reference;r&&(e.id="".concat(t,"-").concat(r));var i,o=Vu(e.childNodes);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.fixRefOwnerId(a,t,n)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"onConfigChange",value:function(e){var t=e.name;!this.isConfiguring&&this.$renderConfigs.has(t)&&this.refreshDom()}},{key:"attachRef",value:function(e,t,n){var r=this,i="_"+e,o=n.listeners;i in r||Uu(r,e,{get:function(){return r.refreshDom.flush(),r[i]},set:function(e){r[i]=e}}),t.id="".concat(r.id,"-").concat(e),r.byRef[e]=t,r[e]=t,o&&(n.listeners={on:o,un:Tu.on(Object.assign({element:t,thisObj:r},o))})}},{key:"detachRef",value:function(e,t,n){n.listeners&&(n.listeners.un(),n.listeners=null),this[e]=null,delete this.byRef[e]}},{key:"renderDom",value:function(){return{}}},{key:"renderContext",get:function(){var e=this,t=e.$meta,n=e.constructor,r=t.renderConfigs||n.renderConfigs,i=e;if(!r){i=Object.create(e),r=new Set;var o=function(t){Uu(i,t,{get:function(){return r.add(t),e[t]}})};for(var a in t.configs)o(a);i.renderDom=function(){return e.renderDom.call(i)},e.$renderConfigs=r}return Uu(e,"renderContext",{value:i}),i}},{key:"refreshDom",value:function(){du.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}},{key:"onListen",value:function(e){"draw"===e&&this.initDrawable()}},{key:"initDrawable",value:function(){var e=this;if(!e.intersector){var t=Object.values(e.byRef).find((function(e){return e.classList.contains("b-drawable")}));t||(t=e.element).classList.add("b-drawable"),e.intersector=!0,Tu.on({element:mi.createElement({parent:t,class:"b-drawable-el"}),animationend:function(t){"b-drawable-anim"===t.animationName&&e.onDraw({count:++e.drawCounter})}})}}},{key:"onDraw",value:function(e){this.trigger("draw",e)}}],[{key:"configurable",get:function(){return{element:null}}},{key:"delayable",get:function(){return{refreshDom:"raf"}}},{key:"identifiable",get:function(){return{}}},{key:"renderConfigs",get:function(){var e,t,n=this.$meta,r=n.renderConfigs;if(void 0===r){for(t in r=null,e=n.configs)e[t].render&&(r||(r=new Set)).add(t);n.renderConfigs=this.prototype.$renderConfigs=r}return r}}]),n}($e.mixin(en,Ot,el,Gi));function Yu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Gu.$idSeed=0,Object.assign(Gu.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null}),Gu._$name="Renderable";var qu=function(e){Ye()(n,e);var t=Yu(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){if(e){var t,r=e.element;r&&(z.a.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=t=Object.assign({},e),delete t.element,t.target=r),"string"==typeof(r=e.target)&&(e=t=t||Object.assign({},e),t.target=e.owner[r])}tt()(Ze()(n.prototype),"construct",this).call(this,e),this.target||(this.target=document.body),this.show()}},{key:"doDestroy",value:function(){var e=this,t=e.element;if("trial"===e.type)return!1;t&&(e.element=null,e.mode.endsWith("blur")&&mi.forEachChild(t,(function(t){t.classList.remove("b-masked-".concat(e.mode))})),e.target.classList.remove("b-masked"),e.target[e.maskName]=null),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"maskElement",get:function(){return this.element}},{key:"maskName",get:function(){var e=this.type;return"mask".concat("string"==typeof e?e.trim():"")}},{key:"error",set:function(e){this.setConfig(this.errorDefaults),this.text=e}},{key:"renderDom",value:function(){var e,t=this,n=t.maxProgress;return{class:(e={"b-mask":1,"b-delayed-show":t.showDelay,"b-widget":1},Qe()(e,"b-mask-".concat(t.mode),1),Qe()(e,"b-progress",n),Qe()(e,"b-prevent-transitions",!t.useTransition),e),children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[n?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:"".concat(Math.max(0,Math.min(100,Math.round(t.progress/n*100))),"%")}}:null,{reference:"maskText",class:"b-mask-text",html:(t.icon?'<i class="b-mask-icon '.concat(t.icon,'"></i>'):"")+t.text}]}]}}},{key:"updateAutoClose",value:function(e){var t=this;t.deferredClose.cancel(),e&&(t.deferredClose.delay=e,t.deferredClose())}},{key:"updateCover",value:function(){var e=this.owner;e&&e.syncMaskCover&&e.syncMaskCover(this)}},{key:"updateShowDelay",value:function(e){var t=this.delayedShow;t.delay=e,e||t.flush()}},{key:"deferredClose",value:function(){var e=this,t=this.owner;this.close().then((function(){t&&t.onMaskAutoClose&&t.onMaskAutoClose(e)})),t&&t.onMaskAutoClosing&&t.onMaskAutoClosing(this)}},{key:"delayedShow",value:function(){this.classes.remove("b-delayed-show")}},{key:"show",value:function(){var e=this,t=e.element,n=e.target,r=e.hiding,i=e.maskName;r&&(r.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),n.classList.add("b-masked"),n[i]||(n[i]=e,n.appendChild(t)),e.shown=!0,e.mode.endsWith("blur")&&mi.forEachChild(n,(function(n){n!==t&&n.classList.add("b-masked-".concat(e.mode))}))}},{key:"hide",value:function(){var e=this,t=e.target,n=e.element,r=e.hiding;if(!r){if(!e.shown)return Promise.resolve();e.hiding=r=new zu,e.shown=!1,n.classList.remove("b-visible"),n.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&mi.forEachChild(t,(function(t){t!==n&&t.classList.remove("b-masked-".concat(e.mode))})),r.promise=r.promise.then((function(){e.hiding===r&&(e.hiding=null)})),e.setTimeout((function(){return r.resolve()}),500,"hide")}return r.promise}},{key:"close",value:function(){var e=this;return this.hide().then((function(){e.destroy()}))}}],[{key:"$name",get:function(){return"Mask"}},{key:"type",get:function(){return"mask"}},{key:"configurable",get:function(){return{autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:null,target:null,text:null,type:null,showDelay:null,useTransition:!1}}},{key:"delayable",get:function(){return{deferredClose:0,delayedShow:0}}},{key:"mergeConfigs",value:function(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];"string"==typeof a?e.text=a:Qn.assign(e,a)}return e}},{key:"mask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;return new n("string"!=typeof e?Object.assign({target:t},e):{target:t,text:e})}},{key:"unmask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return e.mask&&e.mask.close()}}]),n}(Gu);function Ku(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}qu._$name="Mask";var Xu=[],Zu=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,Ju={INPUT:1,TEXTAREA:1},Qu=function(e,t,n){var r,i=null==n?void 0:n.listeners;(i=(null===(r=i)||void 0===r?void 0:r.on)||i)&&(n.listeners={on:i,un:Tu.on(Qn.assign({element:t,thisObj:e},i))})},ec=function(e,t){return e&&t&&t[Qn.keys(e)[0]]?De.merge(e,t):e},tc=function(e){e.isVisible&&e.triggerPaint()},nc=/^:not\((.+)\)$/,rc=function(e){return null!=e.scale},ic=Object.prototype.hasOwnProperty,oc=Reflect.defineProperty,ac=function(e){return parseFloat(e)*(e.endsWith("ms")?1:1e3)},sc=Promise.resolve(),lc=["b-aligned-above","b-aligned-right","b-aligned-below","b-aligned-left"],uc=function(e){Ye()(s,e);var t,n,r,i,o,a=Ku(s);function s(){return B()(this,s),a.apply(this,arguments)}return _()(s,[{key:"isType",value:function(e,t){return s.isType(this,e,t)}},{key:"construct",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;n._isAnimatingCounter=0,n.alignConstrained=0,n.byRef=Object.create(null),n.callRealign=n.realign.bind(n),n.doHideOrRealign=n.doHideOrRealign.bind(n),n.onFullscreenChange=n.onFullscreenChange.bind(this),n.domSyncCallback=n.domSyncCallback.bind(n),n._isUserAction=!1;for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(e=tt()(Ze()(s.prototype),"construct",this)).call.apply(e,[this,t].concat(i));var a=s.recomposeAsync;null!=a&&null==n.recomposeAsync&&(n.recomposeAsync=a),n.finalizeInit()}},{key:"startConfigure",value:function(e){var t=this,n=t.adopt,r=t.element;n&&(t.adoptElement(r,n,e.id),t.updateElement(t._element,r)),tt()(Ze()(s.prototype),"startConfigure",this).call(this,e)}},{key:"finalizeInit",value:function(){(this.insertBefore||this.appendTo||this.insertFirst||this.adopt)&&this.render()}},{key:"doDestroy",value:function(){var e=this,t=e.preExistingElements,n=e.element;if(n){var r,i,o,a=!e._tooltip&&e._rootElement&&(null===(r=s.Tooltip)||void 0===r?void 0:r.getSharedTooltip(e._rootElement,!0));if((null==a?void 0:a.activeTarget)===n&&a.hide(),e.onExitFullscreen(),e.clearTimeout(e.scrollListenerTimeout),e.clearTimeout(e.resizeListenerTimeout),e.removeTransientListeners(),e.floating||e.positioned?e.hide():e.revertFocus(),bu.removeResizeListener(n.parentElement,e.onParentElementResize),bu.removeResizeListener(n,e.onElementResize),e.adopt){for(var l=Array.from(n.childNodes),u=0,c=l.length;u<c;u++){var f=l[u];t.includes(f)||f===e.floatRoot||f.remove()}n.className=e.adoptedElementClassName,n.style.cssText=e.adoptedElementCssText}else n.remove();null===(i=e.dragEventDetacher)||void 0===i||i.call(e),null===(o=e.dragOverEventDetacher)||void 0===o||o.call(e),e.dragGhost.remove()}tt()(Ze()(s.prototype),"doDestroy",this).call(this)}},{key:"isComposable",get:function(){return!this.compose.$nullFn}},{key:"adoptElement",value:function(e,t,n){var r=this,i="string"==typeof t?document.getElementById(t):t,o=s.fromElement(i);o&&o.adopt&&o!==r&&(("string"==typeof o.adopt?document.getElementById(o.adopt):o.adopt)===i&&o.destroy());r.preExistingElements=Array.from(i.childNodes),r.adoptedElementClassName=i.className,r.adoptedElementCssText=i.style.cssText,i.id&&!n&&(r.id=e.id=i.id),mi.syncAttributes(e,i);for(var a=0,l=e.childNodes.length;a<l;a++)i.appendChild(e.childNodes[0]);delete r._contentRange,r._element=i;var u,c=e.lastDomConfig,f=null==c?void 0:c.listeners;f&&r.isComposable&&(null===(u=f.un)||void 0===u||u.call(f),Qu(r,i,c));i.lastDomConfig=c||i.lastDomConfig,i.$refOwnerId=r.id,r.scaleToFitWidth||r.getConfig("monitorResize")}},{key:"addRefAccessor",value:function(e,t){var n=this.constructor.prototype;oc(n,t,{writable:!0,value:null}),oc(n,e,{get:function(){return this.recompose.flush(),this[t]},set:function(e){this[t]=e}})}},{key:"attachRef",value:function(e,t,n){var r=this,i="_"+e;t.dataset&&(t.dataset.ownerCmp=r.id),r.isComposable&&(i in r||r.addRefAccessor(e,i),Qu(r,t,n)),r.byRef[e]=t,r[e]=t}},{key:"detachRef",value:function(e,t,n){n.listeners&&(n.listeners.un(),n.listeners=null),this[e]=null,delete this.byRef[e]}},{key:"afterRecompose",value:function(){}},{key:"compose",value:function(){return{class:xr.normalize(this.widgetClassList,"object")}}},{key:"doCompose",value:function(){var e,t,n,r,i,o,a=this,l=a.$meta,u=l.hierarchy,c=l.composers,f=null;if(a.recompose.suspend(),!c){for(n=!0,l.composers=c=[],r=u.indexOf(s);r<u.length;++r)i=u[r].prototype,ic.call(i,"compose")&&c.push(i);(o=l.getInherited("renderConfigs",!1))||(o=Object.create(null),a.configObserver={get:function(e){o[e]=!0}}),l.$renderConfigs=o}for(r=0;r<c.length;++r)e=c[r].compose.call(a,f),f=f?mi.merge(f,e):e;return ic.call(a,"compose")&&(e=a.compose)&&(e=e.call(a,f),mi.merge(f,e)),n&&delete a.configObserver,mi.normalizeChildren(f,(function(e,n){n&&((t="_"+e)in a||a.addRefAccessor(e,t))}))}},{key:"element",get:function(){return this.isComposable&&!this.isDestroying&&this.recompose.flush(),this._element}},{key:"domSyncCallback",value:function(){}},{key:"changeElement",value:function(e){var t=this,n=t.isComposable;if(n&&(e=t.doCompose()),"string"==typeof e)e=mi.createElementFromTemplate(e);else if(Qn.isObject(e)){if(t.initialSync){var r=e;e=document.createElement("div"),du.sync({targetElement:e,domConfig:r,refOwner:t,callback:t.domSyncCallback,strict:!0}),t.recompose.resume()}else e=mi.createElement(e,{refOwner:t}),t.recompose.resume();n&&Qu(t,e,e.lastDomConfig)}else 1!==e.nodeType&&(e=mi.createElementFromTemplate(t.template(t)));return e.id=t.id,e}},{key:"updateElement",value:function(e){var t=this,n=e.className,r=t.contentElement,i=t.contentElementCls,o=!t.isComposable&&e.querySelectorAll("[data-reference]"),a=t.isComposable?[]:t.widgetClassList;if(n&&a.unshift(n),t._hidden&&a.push("b-hidden"),t._readOnly&&a.push("b-readonly"),at.noThrow(e,"remove"),i&&(r===e?a.push(i):r.className+=" "+i),t.parent||a.push.apply(a,F()(s.outerCls)),e.className=a.join(" "),o)for(var l,u=0;u<o.length;++u)l=o[u],t.attachRef(l.getAttribute("data-reference"),l),l.removeAttribute("data-reference");t.adopt||t.scaleToFitWidth||t.getConfig("monitorResize")}},{key:"recompose",value:(o=Pt()(At.a.mark((function e(){var t,n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={targetElement:(t=this).element,domConfig:t.doCompose(),refOwner:t,callback:t.domSyncCallback,strict:!0},!t.transitionRecompose){e.next=9;break}return t.isTransitioningDom=!0,e.next=5,mi.transition(Qn.assign({element:t.element,action:function(){du.sync(n)}},t.transitionRecompose));case 5:t.isTransitioningDom=!1,t.trigger("transitionedRecompose"),e.next=10;break;case 9:du.sync(n);case 10:n.changed&&t.afterRecompose(),t.recompose.resume();case 12:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.appendTo,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.element;if(n.emptyCache(),n.syncElement&&n.currentElement)mi.sync(r,n.currentElement);else{var i,o=n.insertBefore;if(n.insertFirst&&(e=n.insertFirst,o=n.insertFirst.firstChild),o){if("string"==typeof o){var a=o;if(!(o=document.getElementById(o)))throw new Error("No element found with id '".concat(a,"'"))}e||(e=o.parentElement)}if("string"==typeof e){var l=e;if(!(e=document.getElementById(e)))throw new Error("No element found with id '".concat(l,"'"))}null===(i=e)||void 0===i||i.insertBefore(r,o),n.currentElement=r}s.fromElement(r.parentElement)&&mi.removeClasses(r,s.outerCls),n.rendered=!0,t&&(n.getConfig("contentRange"),n.triggerPaint()),n.setupFocusListeners()}},{key:"template",value:function(e){return"<".concat(e.tag,' class="').concat(e.html?e.htmlCls:"",'" ').concat(e.name?'data-name="'.concat(e.name,'"'):"",">").concat(e.html||"","</").concat(e.tag,">")}},{key:"updateRecomposeAsync",value:function(e){this.recompose.immediate=!e}},{key:"onConfigChange",value:function(e){var t,n=e.name;this._element&&!this.isDestroying&&null!==(t=this.$meta.$renderConfigs)&&void 0!==t&&t[n]&&this.recompose()}},{key:"dataset",get:function(){return this.element.dataset}},{key:"changeDataset",value:function(e){Object.assign(this.dataset,e)}},{key:"dragGhost",get:function(){return this.constructor._dragGhost||(this.constructor._dragGhost=mi.createElement({html:" ",style:"position:absolute;top:-10000em;left:-10000em"}))}},{key:"updateParent",value:function(e){var t=this._element;t&&mi[e?"removeClasses":"addClasses"](t,s.outerCls)}},{key:"constrainTo",get:function(){var e=this._constrainTo;return void 0===e?window:e}},{key:"updateCentered",value:function(e){var t=this.element,n=this._anchorElement;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top="",null==n||n.classList.add("b-hide-display"),t.classList.remove("b-anchored")):t.classList.remove("b-centered")}},{key:"contentElement",get:function(){return this.element}},{key:"contentRange",get:function(){var e=this,t=e.contentElement,n=e._contentRange||(e._contentRange=pe.a.isIE11?document.createRange():new Range);return n.collapsed&&(n.setStart(t,e.contentRangeStartOffset||0),n.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),n}},{key:"fixRefOwnerId",value:function(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;for(var r=e.childNodes,i=r.length;i-- >0;)this.fixRefOwnerId(r[i],t,n)}}},{key:"updateId",value:function(e,t){if(tt()(Ze()(s.prototype),"updateId",this).call(this,e,t),t){var n=this.byRef,r=this.element;for(var i in n)n[i].dataset&&(n[i].dataset.ownerCmp=e);r.id=e,this.fixRefOwnerId(r,e,t)}}},{key:"style",get:function(){var e=this.element;return e?e.ownerDocument.defaultView.getComputedStyle(e):this._style}},{key:"updateStyle",value:function(e){this.element&&mi.applyStyle(this.element,e)}},{key:"updateTitle",value:function(e){this.titleElement&&(this.titleElement.innerHTML=e)}},{key:"alignTo",value:function(e){var t,n=this,r=n.lastAlignSpec,i=n.element;if(r&&i.classList.remove(lc[r.zone]),!e)return n.removeTransientListeners(),void(n.anchor=n.lastAlignSpec=null);(e.nodeType===Element.ELEMENT_NODE||e instanceof s||"Point"===e.$$name)&&(e={target:e}),n.releaseSizeConstraints();var o=n.scrollable,a=n.constrainTo,l=n.scale||1,u=e.target,c=u&&(u instanceof Cr?u:u.element||u),f=Cr.from(i,n.positioned?i.offsetParent:null,!0),d=f.width,h=f.height,v=c&&c.nodeType===Element.ELEMENT_NODE,p=(e=Qn.assign({constrainTo:a,align:"b-t",axisLock:n.axisLock,anchor:n.anchor},n.align,e)).minWidth||n.minWidth,g=e.minHeight||n.minHeight;if(f.isAlignRectangle=!0,p&&(f.minWidth=p*l),g&&(f.minHeight=g*l),n.lastAlignSpec=e,v&&c.offsetParent){(e=Object.setPrototypeOf({},e)).target=Cr.from(c,n.positioned?i.offsetParent:null,!n.positioned),e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1);var y=n.clippedBy;if(y){var m=e.target.intersect(y);if(!m){var b=n.hide();return n.lastAlignSpec.targetHidden=!0,b}e.target=m}n.anchoredTo=c}else n.anchoredTo=null;if(e.anchor&&(e.anchorSize=n.anchorSize,i.contains(n.anchorPathElement)||i.appendChild(n.anchorElement)),a&&!a.isRectangle&&n.positioned){var k=a===document||a===window;e.constrainTo=Cr.from(k?document.body:e.constrainTo,i.offsetParent)}n.isAligning=!0,n.trigger("beforeAlign",e),n.isAligning=!1;var w=f.alignTo(e),C=w.align,R=w.anchor,S=w.x,x=w.y,E=w.width,D=w.height;if(n.lastAlignSpec.zone=w.zone,D!=h&&("configuredHeight"in n||(n.configuredHeight=i.style.height),n.height=D/l,n.alignConstrained=1|n.alignConstrained,o&&(o.overflowY=!0)),E!=d&&("configuredWidth"in n||(n.configuredWidth=i.style.width),n.width=E/l,n.alignConstrained=2|n.alignConstrained,o&&(o.overflowX=o.clientWidth>o.scrollWidth)),C&&n.alignConstrained){e.align=C;var T=Cr.from(i,n.positioned?i.offsetParent:null,!0).alignTo(e);R=T.anchor,S=T.x,x=T.y,E=T.width,D=T.height}if(n.setXY(S,x),isFinite(w.zone)&&i.classList.add(lc[w.zone]),null!==(t=R)&&void 0!==t&&t.edge){var O=R.edge,M=n.anchorElement,A=Cr.from(i),I=[];"top"===O||"bottom"===O?(I[0]=R.x,I[1]="top"===O?1:A.height-1):(I[0]="left"===O?1:A.width-1,I[1]=R.y);var P=mi.childFromPoint.apply(mi,[i].concat(I));if(P){for(var F=mi.getStyleValue(P,"background-color");F.match(Zu)&&"absolute"!==mi.getStyleValue(P,"position");)P=P.parentNode,F=mi.getStyleValue(P,"background-color");F.match(Zu)?n.anchorPathElement.setAttribute("fill",n.defaultAnchorBackgroundColor):n.anchorPathElement.setAttribute("fill",F)}M.classList.remove("b-hide-display"),M.style.transform="",M.className="b-anchor b-anchor-".concat(O),R.x&&(R.x/=l),R.y&&(R.y/=l),mi.setTranslateXY(M,R.x,R.y),i.classList.add("b-anchored")}else n._anchorElement&&(n.anchorElement.classList.add("b-hide-display"),i.classList.remove("b-anchored"));"hide"!==n.scrollAction||v||(i.style.pointerEvents="none",n.anchoredTo=mi.elementFromPoint(S,x),i.style.pointerEvents=""),("realign"===n.scrollAction&&v||"hide"===n.scrollAction)&&!n.documentScrollListener&&(n.clearTimeout(n.scrollListenerTimeout),n.scrollListenerTimeout=n.setTimeout((function(){n.documentScrollListener=!0,document.addEventListener("scroll",n.doHideOrRealign,!0)}),"hide"===n.scrollAction?n.ignoreScrollDuration:0)),v&&e.monitorResize&&!n.targetResizeListener&&(bu.addResizeListener(c,n.callRealign),n.targetResizeListener=!0),pe.a.isAndroid||n.constrainListeners||a instanceof Cr||(n.clearTimeout(n.resizeListenerTimeout),n.resizeListenerTimeout=n.setTimeout((function(){n.constrainListeners=!0,bu.addResizeListener(a||window,n.callRealign)}),n.ignoreScrollDuration))}},{key:"realign",value:function(e){var t=this;if(t.isVisible&&(t.floating||t.positioned)&&t.lastAlignSpec){var n=t.lastAlignSpec.target;if(n&&n.nodeType===Element.ELEMENT_NODE){if(pe.a.isIE11&&!hi(n))return t.hide();var r=s.fromElement(n),i=Cr.from(n),o=(!r||r.isVisible)&&mi.isVisible(n);if(i.minHeight=i.minWidth=1,n!==document.body&&!o||e&&e.nodeType===Element.ELEMENT_NODE&&e.contains(n)&&!Cr.from(e).intersect(i))return t.hide()}mi.addTemporaryClass(t.element,"b-realigning",300),t.alignTo(t.lastAlignSpec)}}},{key:"rectangle",value:function(e,t,n){return"string"!=typeof e?(n=t,t=e,e=""):"border"===e&&(e=""),"boolean"==typeof t&&(n=t,t=null),Cr[e||"from"](this.element,t,n)}},{key:"releaseSizeConstraints",value:function(){var e=this,t=e.scrollable;1&e.alignConstrained&&(e.height=e.configuredHeight,t&&(t.overflowY=t.config.overflowY)),2&e.alignConstrained&&(e.width=e.configuredWidth,t&&(t.overflowX=t.config.overflowX)),e.alignConstrained=0}},{key:"toFront",value:function(){var e=this.element,t=this.floating?this.floatRoot:this.positioned?null==e?void 0:e.parentNode:null;if(e&&e.nextSibling){var n=this._toFrontRange||(this._toFrontRange=document.createRange());n.setStartBefore(e.nextSibling),n.setEndAfter(t.lastElementChild),t.insertBefore(n.extractContents(),e)}}},{key:"updateRef",value:function(e){this.element.dataset.ref=e}},{key:"clippedBy",get:function(){var e=this._clippedBy;if((null==e?void 0:e.length)>0){var t,n=Cr.from(null==e?void 0:e[0],null,!0);for(t=1;t<e.length;t++)n=n.intersect(Cr.from(null==e?void 0:e[t],null,!0));return n}},set:function(e){this._clippedBy=Array.isArray(e)?e:e?[e]:null}},{key:"overflowElement",get:function(){return this.contentElement}},{key:"maxHeightElement",get:function(){return this.element}},{key:"changeAlign",value:function(e){return"string"==typeof e?{align:e}:e}},{key:"changeScrollable",value:function(e,t){return"boolean"==typeof e&&(e={overflowX:e,overflowY:e}),e?(e.element=this.overflowElement,e.widget=this,e.isScroller||(e=t?t.setConfig(e):new this.scrollerClass(e)),e.syncOverflowState()):null==t||t.destroy(),e}},{key:"html",get:function(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}},{key:"updateHtml",value:function(e){var t=this,n=null==e,r=t.element,i=t.contentElement,o=t.htmlCls;if(r){var a=i===r&&t._anchorElement;o&&o.values.forEach((function(e){return r.classList[n?"remove":"add"](e)})),a&&t.element.removeChild(a),e&&"object"===I()(e)?du.sync({domConfig:e,targetElement:t.contentElement,onlyChildren:!0}):t.contentElement.innerHTML=n?"":e,a&&r.appendChild(a),t.isComposable?t.recompose():(t.floating||t.positioned)&&(t.isAligning||t.realign())}}},{key:"updateContent",value:function(e){var t=this,n=null==e,r=t.element,i=t.htmlCls;if(r){var o=t.contentRange;i&&i.values.forEach((function(e){return r.classList[n?"remove":"add"](e)})),hi(r)?(o.deleteContents(),n||o.insertNode(mi.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=o.startOffset,t.contentRangeEndOffset=o.endOffset,!t.floating&&!t.positioned||t.isAligning||t.realign()}}},{key:"onThemeChange",value:function(){var e;null!==(e=this.anchorElement)&&void 0!==e&&e.offsetParent&&(this._anchorSize=null,this.realign())}},{key:"anchorSize",get:function(){var e=this,t=this._anchorSize;if(!t){var n=parseFloat(mi.getStyleValue(e.element,"border-top-width")),r=mi.getStyleValue(e.element,"border-top-color"),i=e.anchorElement,o=i.className,a=i.firstElementChild,s=e.anchorPathElement=a.lastElementChild,l=e._hidden;i.className="b-anchor b-anchor-top";var u=mi.getStyleValue(e.contentElement,"background-color");u.match(Zu)&&(u=mi.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=u,t=i.getBoundingClientRect();var c=t=e._anchorSize=[t.width,t.height],f=N()(c,2),d=f[0],h=f[1];i.className=o,a.setAttribute("height",h+n),a.setAttribute("width",d),s.setAttribute("d","M0,".concat(h,"L").concat(d/2,",0.5L").concat(d,",").concat(h)),n&&(s.setAttribute("stroke-width",n),s.setAttribute("stroke",r)),t[1]-=n,l&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=Fi.on({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}},{key:"anchorElement",get:function(){var e=this;if(!e._anchorElement){var t=e.floating&&!(pe.a.isIE11||pe.a.isEdge),n="".concat(e.id,"-shadow-filter");e._anchorElement=mi.createElement({parent:e.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:n,children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:1,"flood-opacity":.2}]}]}:null,Qe()({tag:"path"},t?"filter":"","url(#".concat(n,")"))]}]})}return e._anchorElement}},{key:"updateAnchor",value:function(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}},{key:"updateDraggable",value:function(e){var t,n,r,i=this,o=i.element;(pe.a.isFirefox||o.setAttribute("draggable",Boolean(e)),e)?(i.dragEventDetacher=Tu.addListener({element:o,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:i}),pe.a.isFirefox&&(i.ffDragDetacher=Tu.on({element:o,mousedown:function(e){mi.up(e.target,".b-field-inner")||o.setAttribute("draggable","true")},thisObj:i}))):(null===(t=i.dragEventDetacher)||void 0===t||t.call(i),null===(n=i.dragOverEventDetacher)||void 0===n||n.call(i),null===(r=i.ffDragDetacher)||void 0===r||r.call(i))}},{key:"onWidgetDragStart",value:function(e){var t=this,n=t.element;if(t.validateDragStartEvent(e)){t.removeTransientListeners();var r=e.clientX,i=e.clientY,o=document.scrollingElement||document.body,a=t.getXY()[0],s=t.getXY()[1],l={element:t.rootElement,dragover:function(e){n.classList.remove("b-centered"),mi.setTranslateXY(n,a+e.clientX-r-o.scrollLeft,s+e.clientY-i-o.scrollTop)}};pe.a.isTouchDevice&&(l.touchmove=function(e){return e.preventDefault()}),t.floatRoot.appendChild(t.dragGhost),t.setDragImage(e),e.dataTransfer.effectAllowed="none",t.dragOverEventDetacher=Tu.addListener(l),t.alignTo()}}},{key:"validateDragStartEvent",value:function(e){var t=this.element,n=mi.elementFromPoint(e.clientX,e.clientY),r=this.draggable.handleSelector;if(r){var i=nc.exec(r)[1];if(i){if(n.closest("#".concat(t.id," ").concat(i)))return e.preventDefault(),!1}else if(!n.closest("#".concat(t.id," ").concat(r)))return e.preventDefault(),!1}return!0}},{key:"setDragImage",value:function(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,-9999,-9999))}},{key:"onWidgetDragEnd",value:function(){this.dragGhost.remove(),this.dragOverEventDetacher(),pe.a.isFirefox&&this.element.removeAttribute("draggable")}},{key:"changeFloating",value:function(e){return Boolean(e)}},{key:"changePositioned",value:function(e){return Boolean(e)}},{key:"updatePositioned",value:function(e){this.element.classList[e?"add":"remove"]("b-positioned")}},{key:"getXY",value:function(){return[mi.getPageX(this.element),mi.getPageY(this.element)]}},{key:"setXY",value:function(e,t){var n=this;(n.floating||n.positioned)&&(null!=e&&(n._x=e,n.centered=!1),null!=t&&(n._y=t,n.centered=!1),mi.setTranslateXY(n.element,n._x||0,n._y||0))}},{key:"x",get:function(){return this.getXY()[0]}},{key:"changeX",value:function(e){this.setXY(e)}},{key:"y",get:function(){return this.getXY()[1]}},{key:"changeY",value:function(e){this.setXY(null,e)}},{key:"width",get:function(){var e=this,t=e.element;return e.monitorResize?(null==e._width&&(e._width=t.offsetWidth),e._width):t.offsetWidth}},{key:"changeWidth",value:function(e){mi.setLength(this.element,"width",e),this._width=null,this._flex=null,this.element.style.flex=""}},{key:"maxWidth",get:function(){return mi.measureSize(this.element.style.maxWidth,this.element)}},{key:"updateMaxWidth",value:function(e){mi.setLength(this.element,"maxWidth",e)}},{key:"minWidth",get:function(){return mi.measureSize(this.element.style.minWidth,this.element)}},{key:"updateMinWidth",value:function(e){mi.setLength(this.element,"minWidth",e)}},{key:"updateFlex",value:function(e){this.getConfig("width"),"number"!=typeof e&&isNaN(e)||(e="".concat(e," ").concat(e)),this.element.style.flex=e,this.element.style.width=""}},{key:"updateAlignSelf",value:function(e){this.element.style.alignSelf=e}},{key:"updateMargin",value:function(e){this.element.style.margin=this.parseTRBL(e).join(" ")}},{key:"updateTextAlign",value:function(e,t){t&&this.element.classList.remove("b-text-align-".concat(t)),this.element.classList.add("b-text-align-".concat(e))}},{key:"updatePlaceholder",value:function(e){this.input&&(null==e?this.input.removeAttribute("placeholder"):this.input.placeholder=e)}},{key:"height",get:function(){var e=this,t=e.element;return e.monitorResize?(null==e._height&&(e._height=t.offsetHeight),e._height):t.offsetHeight}},{key:"changeHeight",value:function(e){mi.setLength(this.element,"height",e),this._height=null}},{key:"maxHeight",get:function(){return mi.measureSize(this.maxHeightElement.style.maxHeight,this.element)}},{key:"updateMaxHeight",value:function(e){var t=this,n=t.element;mi.setLength(t.maxHeightElement,"maxHeight",e),pe.a.isIE11&&t.contentElement!==n&&(null==e?bu.removeResizeListener(n,t.boundMaxHeightBugHandler):(bu.addResizeListener(n,t.boundMaxHeightBugHandler||(t.boundMaxHeightBugHandler=t.fixIEMaxHeightBug.bind(t))),document.body.contains(n)&&t.fixIEMaxHeightBug()))}},{key:"fixIEMaxHeightBug",value:function(){var e=this.element,t=this.contentElement;if("column"===mi.getStyleValue(e,"flex-direction")){t.style.maxHeight="";for(var n=Cr.client(e).height,r=e.childNodes,i=r.length,o=0;o<i;o++){var a=r[o];a===t||a.classList.contains("b-resize-monitors")||(n-=a.offsetHeight)}this.contentElement.style.maxHeight="".concat(n,"px")}}},{key:"minHeight",get:function(){return mi.measureSize(this.element.style.minHeight,this.element)}},{key:"updateMinHeight",value:function(e){mi.setLength(this.element,"minHeight",e)}},{key:"updateDisabled",value:function(e){var t=this,n=t.element,r=t.focusElement;t.trigger("beforeUpdateDisabled",{disabled:e}),e&&t.revertFocus(),n&&(n.classList[e?"add":"remove"]("b-disabled"),r&&(r.disabled=e)),t.onDisabled(e)}},{key:"onDisabled",value:function(e){}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"requestFullscreen",value:function(){var e=this,t=hu.request(e.floating?e.floatRoot:e.element);return hu.onFullscreenChange(e.onFullscreenChange),e.floating||(e.floatRoot._oldParent=e.floatRoot.parentElement,e.element.appendChild(e.floatRoot)),t}},{key:"exitFullscreen",value:function(){return hu.exit()}},{key:"onFullscreenChange",value:function(){hu.isFullscreen||this.onExitFullscreen()}},{key:"onExitFullscreen",value:function(){var e,t,n=this;hu.unFullscreenChange(n.onFullscreenChange),!n.floating&&null!==(e=n._rootElement)&&void 0!==e&&null!==(t=e.floatRoot)&&void 0!==t&&t._oldParent&&(n.floatRoot._oldParent.appendChild(n.floatRoot),n.floatRoot._oldParent=null)}},{key:"tooltip",get:function(){if(this._tooltip)return this._tooltip;var e,t=null===(e=s.Tooltip)||void 0===e?void 0:e.getSharedTooltip(this.rootElement);return t&&t.activeTarget===this._element&&t.isVisible?t:void 0}},{key:"changeTooltip",value:function(e,t){var n=this;if(e){if(!n.preventTooltipOnTouch||!pe.a.isTouchDevice){if(e.isTooltip||"Object"===e.constructor.name||(e={html:"string"==typeof e?e:n.placeholder,textContent:!0}),!(null!=t&&t.isTooltip||e.newInstance))return n.element.dataset.btip=!0,void(n.tipConfig=e);e.type="tooltip",e.forElement||(e.forElement=n.element),"showOnHover"in e||e.forSelector||(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),e=s.reconfigure(t,e,n)}}else if(t){if(null!=e||!t.isTooltip)return void(t.html=null);t.destroy()}else delete n.element.dataset.btip;return e}},{key:"tooltipText",get:function(){var e=this._tooltip;return e?e.isTooltip?e.contentElement.innerText:"string"==typeof e?e:e.html:this.tipConfig?this.tipConfig.html:void 0}},{key:"isVisible",get:function(){var e=this,t=e.element;return Boolean(t&&!e._hidden&&!e.isDestroying&&hi(t)&&(!e.requireSize||di(t))&&(!e.owner||e.owner.isVisible))}},{key:"focus",value:function(){this.isFocusable&&mi.focusWithoutScrolling(this.focusElement)}},{key:"focusElement",get:function(){}},{key:"isFocusable",get:function(){var e=this.focusElement;return e&&this.isVisible&&!this.disabled&&(e===document.body||e.offsetParent)}},{key:"show",value:(i=Pt()(At.a.mark((function e(){var t=this;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n,r,i=t,o=i.showAnimation,a=i.element,s=a.style;if(i.isVisible||!1===i.trigger("beforeShow")||i.internalBeforeShow&&!1===i.internalBeforeShow())e();else{if(i.cancelHideShowAnimation(),i.updateCentered(i._centered),i.floating){var l=i.floatRoot;l.contains(a)||(i.rendered?l.appendChild(i.element):i.render(l,!1)),s.transform.includes("scale")&&(i.scale=null,s.transform=s.transformOrigin="");var u=i.closest(rc);if(u){var c=u.scale;i.scale=c,s.transform="scale(".concat(c,")"),s.transformOrigin="0 0"}}if(i._hidden=!1,a.classList.remove("b-hidden"),i.onConfigChange({name:"hidden",value:!1,was:!0,config:i.$meta.configs.hidden}),o){r=o[n=Object.keys(o)[0]];var f=i.currentAnimation={styleProp:n,resolve:e};i.isAnimating=!0,i.currentAnimation.detacher=Tu.onTransitionEnd({element:a,property:n,duration:ac(r.duration)+20,handler:function(){return i.afterHideShowAnimate(f)},thisObj:i}),s[n]=r.from,mi.getStyleValue(a,n),s.transition="".concat(n," ").concat(r.duration," ease ").concat(r.delay),s[n]=r.to}i.afterShow(!o&&e),i.inShowBy||!i.floating||!i.forElement||i.centered||i.hidden||i.alignTo(i.forElement)}})));case 1:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"showBy",value:(r=Pt()(At.a.mark((function e(t){var n,r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this).isVisible?mi.addTemporaryClass(n.element,"b-realigning",300):(n.inShowBy=!0,r=n.show(),n.inShowBy=!1),n.isVisible&&n.alignTo(t),e.abrupt("return",r||sc);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"showByPoint",value:(n=Pt()(At.a.mark((function e(t,n,r){var i,o=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=1===o.length?t:[t,n],e.abrupt("return",this.showBy(Object.assign({position:new wu(i[0]+1,i[1]+1),matchSize:!1,align:"t-b"},r)));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"afterShow",value:function(e){var t,n,r=this;r.boundMaxHeightBugHandler&&r.boundMaxHeightBugHandler(),r.trigger("show"),r._configuredAnchorState=r.anchor,null===(t=r.parent)||void 0===t||null===(n=t.onChildShow)||void 0===n||n.call(t),r.triggerPaint(),e&&e()}},{key:"triggerPaint",value:function(){var e=this,t=e.element,n=!e.isPainted;e.isVisible&&(n&&e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),bu.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),e.eachWidget(tc,!1),n&&e.isVisible&&(e.rootElement=mi.getRootElement(t),e.getConfig("tooltip"),!s.Ripple&&s.RippleClass&&(s.Ripple=new s.RippleClass({rootElement:e.rootElement}))),e.isPainted=!0,e.trigger("paint",{firstPaint:n}),n&&e.monitorResize&&!e.scaleToFitWidth&&bu.onElementResize([{target:t}]))}},{key:"cancelHideShowAnimation",value:function(){var e=this,t=e.currentAnimation,n=e.element;t&&(e.isAnimating=!1,n.classList.remove("b-hiding"),t.detacher(),t.resolve(),n.style.transition=n.style[t.styleProp]="",e.currentAnimation=null)}},{key:"afterHideShowAnimate",value:function(e){var t=this;e===t.currentAnimation&&(t.cancelHideShowAnimation(),t._hidden&&t.afterHideAnimation())}},{key:"hide",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise((function(n){var r=e,i=r.element,o=i.style,a=t&&r.hideAnimation;if(r.clearTimeout(r.scrollListenerTimeout),r.clearTimeout(r.resizeListenerTimeout),!r._hidden&&!1!==r.trigger("beforeHide")){if(r._hidden=!0,r.onConfigChange({name:"hidden",value:!0,was:!1,config:r.$meta.configs.hidden}),!i)return void n();if(i.contains(mi.getActiveElement(i))&&r.revertFocus(!0),r.isDestroyed)return void n();if(r.cancelHideShowAnimation(),a){var s=Object.keys(a)[0],l=a[s];if(Number(getComputedStyle(r.element)[s])!==l.to){var u=r.currentAnimation={styleProp:s,resolve:n};i.classList.add("b-hiding"),r.isAnimating=!0,r.currentAnimation.detacher=Tu.onTransitionEnd({element:i,property:s,duration:ac(l.duration)+20,handler:function(){return r.afterHideShowAnimate(u)},thisObj:r}),o[s]=l.from,mi.getStyleValue(i,s),o.transition="".concat(s," ").concat(l.duration," ease ").concat(l.delay),o[s]=l.to}else i.classList.add("b-hidden")}else i.classList.add("b-hidden");r.afterHide(!a&&n,a)}}))}},{key:"doHideOrRealign",value:function(e){var t,n=this,r=n.anchoredTo,i=n.lastAlignSpec,o=null==i?void 0:i.target,a=null==i?void 0:i.position,s=mi.getActiveElement(n),l=n.getXY(),u=N()(l,2),c=u[0],f=u[1];if(!n.element.contains(e.target)&&e.isTrusted&&!((null===(t=e.target)||void 0===t?void 0:t.nodeType)===Element.DOCUMENT_NODE&&n.element.contains(s)&&Ju[s]&&window.innerHeight<document.body.offsetHeight)&&(n.realign(e.target),!n.isDestroyed&&"hide"===n.scrollAction)){var d=n.getXY(),h=N()(d,2),v=h[0],p=h[1];(v!==c||p!==f||"Point"===(null==o?void 0:o.$$name)||a)&&(!r||e.target&&mi.isDescendant(e.target,r))&&n.hide()}}},{key:"afterHide",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hideAnimation,i=this,o=i.lastAlignSpec;o&&(o.targetHidden=null),i._anchor=i._configuredAnchorState,i.removeTransientListeners(),r||i.afterHideAnimation(),i.trigger("hide"),null===(e=i.parent)||void 0===e||null===(t=e.onChildHide)||void 0===t||t.call(e),n&&n()}},{key:"removeTransientListeners",value:function(){var e=this;e.clearTimeout(e.resizeListenerTimeout),e.clearTimeout(e.scrollListenerTimeout),e.documentScrollListener&&(document.removeEventListener("scroll",e.doHideOrRealign,!0),e.documentScrollListener=!1),e.targetResizeListener&&(bu.removeResizeListener(e.lastAlignSpec.target,e.callRealign),e.targetResizeListener=!1),e.constrainListeners&&(bu.removeResizeListener(e.lastAlignSpec.constrainTo||window,e.callRealign),e.constrainMutationMonitor&&e.constrainMutationMonitor.disconnect(),e.constrainListeners=!1)}},{key:"afterHideAnimation",value:function(){var e=this,t=e.element;e.floating&&e.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}},{key:"changeHidden",value:function(e){var t,n=this;return n.isConfiguring?(t=Boolean(e),n.element.classList[e?"add":"remove"]("b-hidden")):(n.trigger("beforeChangeHidden",{hidden:e}),e?n.hide():n.show()),t}},{key:"assignedId",get:function(){return this.hasGeneratedId?null:this.id}},{key:"owner",get:function(){var e=this.parent||this._owner;if(!e){var t,n,r=(null===(t=this.forElement)||void 0===t?void 0:t.nodeType)===Element.ELEMENT_NODE?this.forElement:null===(n=this.element)||void 0===n?void 0:n.parentNode;e=(null==r?void 0:r.closest(".b-widget"))&&s.fromElement(r)}return e}},{key:"previousSibling",get:function(){return this.getSibling(-1)}},{key:"nextSibling",get:function(){return this.getSibling(1)}},{key:"getSibling",value:function(e){var t=this,n=t.parent,r=n?n.childItems:Array.from(t.element.parentElement.querySelectorAll(".b-widget"));return n?r[r.indexOf(t)+e]:s.fromElement(r[r.indexOf(t.element)+e])}},{key:"up",value:function(){var e=this.owner;if(e)return e.closest.apply(e,arguments)}},{key:"closest",value:function(e,t,n){for(var r=I()(n),i="number"===r,o="string"===r,a=this,l=1;a;a=a.owner,l++){if(s.widgetMatches(a,e,t))return a;if(i&&l>=n)return;if(o&&s.widgetMatches(a,n,t))return;if(a===n)return}}},{key:"owns",value:function(e){if(e){if(e.eventPhase&&(e=e.target),e.nodeType===Element.ELEMENT_NODE){if(this.element.contains(e))return!0;e=s.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}},{key:"eachAncestor",value:function(e){for(var t=this.owner;t;){if(!1===e(t))return!1;t=t.owner}return!0}},{key:"changeMonitorResize",value:function(e,t){var n=!this.scaleToFitWidth&&Boolean(e);if(n!==Boolean(t))return n}},{key:"updateMonitorResize",value:function(e){var t=this;ic.call(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),bu[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}},{key:"changeReadOnly",value:function(e){if(e=Boolean(e),Boolean(this._readOnly)!==e)return e}},{key:"updateReadOnly",value:function(e){var t;null===(t=this.element)||void 0===t||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget((function(t){"_originalReadOnly"in t||(t._originalReadOnly=t.config.readOnly||!1),t.readOnly=e||t._originalReadOnly}),!1),this.trigger("readOnly",{readOnly:e}))}},{key:"eachWidget",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.childItems,r=n?n.length:0,i={},o=0;o<r;o++){var a=n[o];if(i.down=t,!1===e(a,i))return!1;if(i.down&&a.eachWidget&&!1===a.eachWidget(e,t))return!1}return!0}},{key:"queryAll",value:function(e){var t=[];return this.eachWidget((function(n){e(n)&&t.push(n)})),t}},{key:"query",value:function(e){var t=null;return this.eachWidget((function(n){if(e(n))return t=n,!1})),t}},{key:"getWidgetByRef",value:function(e){var t,n;return e instanceof s?e:(null==this||null===(t=this.widgetMap)||void 0===t?void 0:t[e])||(null==this||null===(n=this.owner)||void 0===n?void 0:n.getWidgetByRef(e))}},{key:"onFocusIn",value:function(e){var t=this,n=t.element;t.containsFocus=!0,t.focusInEvent=e,n.classList.add("b-contains-focus"),n.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=Tu.on({element:n,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}},{key:"onFocusOut",value:function(e){var t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.trigger("focusout",e))}},{key:"captureFocus",value:function(){var e=this,t=mi.getActiveElement(e),n=e.contains(t)&&e.captureFocusItem(t);return function(r){n&&!e.isDestroying&&(mi.getActiveElement(e)!==t&&n(r))}}},{key:"captureFocusItem",value:function(e){var t=this;return function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.contains(e)&&(n?e.focus():mi.focusWithoutScrolling(e))}}},{key:"contains",value:function(e,t){var n=this.element;if(e&&n)return e.isWidget&&(e=e.element),n.contains(e)&&(!t||n!==e)}},{key:"revertFocus",value:function(e){var t,n,r=this,i=mi.getActiveElement(r),o=null===(t=r.focusInEvent)||void 0===t?void 0:t.relatedTarget;(e||r.containsFocus&&(null===(n=o)||void 0===n?void 0:n.nodeType)===Element.ELEMENT_NODE&&r.element.contains(i))&&(o&&mi.isFocusable(o)||(o=r.getFocusRevertTarget()),o&&mi.isFocusable(o)?mi.focusWithoutScrolling(o):null==i||i.blur())}},{key:"getFocusRevertTarget",value:function(){var e=this,t=e.owner,n=e.focusInEvent,r=n&&n.backwards?1:-1,i=n&&n.relatedTarget,o=i&&s.fromElement(i);if(t&&!t.isDestroyed&&(!i||!mi.isFocusable(i)||o&&!o.isFocusable)){if(i=null,t.eachWidget){var a=[];if(t.eachWidget((function(t){(t===e||t.isFocusable)&&a.push(t)}),!1),a.length>1){var l=a.indexOf(e);i=a[l+r]||a[l-r]}}!i&&t.isFocusable&&(i=t),i=i?i.focusElement:t.getFocusRevertTarget()}return i}},{key:"widgetClassList",get:function(){for(var e,t,n,r,i=this,o=i.cls,a=i.$meta.hierarchy,l=(null==o?void 0:o.values)||[],u=a.indexOf(s);u<a.length;++u){var c;e=a[u],null!==(c=r=Reflect.getOwnPropertyDescriptor(e.prototype,"widgetClass"))&&void 0!==c&&c.get?n=r.get.call(i):(((t=ic.call(e,"$$name")||ic.call(e,"$name")||ic.call(e,"_$name")?e.$$name:e.name).length<3||t.includes("$"))&&console.warn('Class "'.concat(t,'" which extends "').concat(e.$name,'" should have "$name" static getter with no less than 3 chars.')),n="b-".concat(t.toLowerCase())),n&&l.push.apply(l,F()(xr.normalize(n,"array")))}return i.floating&&l.push("b-floating"),pe.a.isTouchDevice&&l.push("b-touch"),l}},{key:"changeCls",value:function(e){return xr.from(e)}},{key:"changeContentElementCls",value:function(e){return xr.from(e)}},{key:"changeHtmlCls",value:function(e){return xr.from(e)}},{key:"fromCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.element;if(!n)return null;var r=this;return r.cache[e]||(r.cache[e]=t?mi.children(n,e):mi.down(n,e)),r.cache[e]}},{key:"emptyCache",value:function(){this.cache={}}},{key:"changeMasked",value:function(e,t){if(!0!==e&&""!==e||(e=" "),t)"string"==typeof e?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){var n=s.resolveType("mask");(e=n.mergeConfigs(this.maskDefaults,e)).owner=this,e=n.mask(e)}return e||null}},{key:"onMaskAutoClose",value:function(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}},{key:"mask",value:function(e){return this.masked=e,this.masked}},{key:"unmask",value:function(){this.masked=null}},{key:"onInternalResize",value:function(e,t,n,r,i){this._width=e.offsetWidth,this._height=e.offsetHeight}},{key:"onElementResize",value:function(e){var t,n=this,r=n.element,i=n.scrollable,o=n._width,a=n._height,s=r.offsetWidth,l=r.offsetHeight;(n.floating&&n.onFloatingWidgetResize.apply(n,arguments),i)&&(null===(t=i.syncOverflowState)||void 0===t||t.call(i));n.suspendResizeMonitor||o===s&&a===l||(n.onInternalResize(r,s,l,o,a),n.trigger("resize",{width:s,height:l,oldWidth:o,oldHeight:a}))}},{key:"onFloatingWidgetResize",value:function(e,t,n){var r=this,i=r.lastAlignSpec,o=r.constrainTo;if(r.isVisible&&i&&i.target){var a=!t||n.height!==t.height,s=!t||n.width!==t.width,l=o&&!Cr.from(o).contains(Cr.from(r.element,null,!0));(a&&2!==i.zone||s&&1!==i.zone||l)&&r.requestAnimationFrame((function(){return r.realign()}))}}},{key:"updateScale",value:function(){var e=this,t=e.element,n=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";var r=Cr.client(n).width/e.configuredWidth,i=e.scale=e.allowGrowWidth?Math.min(r,1):r;t.style.transform="scale(".concat(i,")"),t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&r>1&&(e.width=e.configuredWidth*r)}},{key:"onParentElementResize",value:function(e){this.updateScale()}},{key:"parseTRBL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";if("number"==typeof(e=e||0))return["".concat(e).concat(t),"".concat(e).concat(t),"".concat(e).concat(t),"".concat(e).concat(t)];var n=e.split(" "),r=n.length;return 1===r?n[1]=n[2]=n[3]=n[0]:2===r?(n[2]=n[0],n[3]=n[1]):3===r&&(n[3]=n[1]),[isFinite(n[0])?"".concat(n[0]).concat(t):n[0],isFinite(n[1])?"".concat(n[1]).concat(t):n[2],isFinite(n[2])?"".concat(n[2]).concat(t):n[3],isFinite(n[3])?"".concat(n[3]).concat(t):n[4]]}},{key:"documentRoot",get:function(){var e;return(null===(e=this.owner)||void 0===e?void 0:e.documentRoot)||this.element.getRootNode()}},{key:"rootElement",get:function(){var e=this;if(!e._rootElement){var t,n=(null===(t=e.owner)||void 0===t?void 0:t.rootElement)||e.forElement instanceof HTMLElement&&mi.getRootElement(e.forElement);if(!n){var r=e.element instanceof HTMLElement&&mi.getRootElement(e.element);r!==document.body&&r.nodeType!==Node.DOCUMENT_FRAGMENT_NODE||(n=r)}n||(n=document.body),e._rootElement=n}return e._rootElement}},{key:"floatRoot",get:function(){var e,t=this.rootElement||(null===(e=this.owner)||void 0===e?void 0:e.rootElement),n=t.floatRoot;if(n)t.contains(n)||t.appendChild(n);else{var r,i=s.outerCls,o=null===(r=mi.themeInfo)||void 0===r?void 0:r.name;if(!mi.isValidFloatRootParent(t))throw new Error("Attaching float root to wrong root");o&&i.push("b-theme-".concat(o.toLowerCase())),n=t.floatRoot=mi.createElement({className:"b-float-root ".concat(i.join(" ")),parent:t}),Xu.push(n),pe.a.isAndroid&&(n.style.height="".concat(screen.height,"px"),Tu.on({element:window,orientationchange:function(){return n.style.height="".concat(screen.height,"px")}})),!pe.a.isHoverableDevice&&window.visualViewport&&Tu.on({element:window.visualViewport,resize:function(e){var t=e.target;return n.style.height="".concat(t.height,"px")}}),Fi.on({theme:function(e){var t=e.theme,r=e.prev;n.classList.add("b-theme-".concat(t.toLowerCase())),n.classList.remove("b-theme-".concat(r.toLowerCase()))}})}return n}},{key:"isAnimating",get:function(){return this._isAnimatingCounter>0},set:function(e){var t=this;0===t._isAnimatingCounter&&e?(t.element.classList.add("b-animating"),this.trigger("animationStart")):1!==t._isAnimatingCounter||e||(t.element.classList.remove("b-animating"),this.trigger("animationEnd")),t._isAnimatingCounter+=e?1:-1,t._isAnimatingCounter=Math.max(0,t._isAnimatingCounter)}},{key:"waitForAnimations",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isAnimating){e.next=3;break}return e.next=3,this.await("animationend",{checkLog:!1});case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"triggerFieldChange",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.trigger("change",e),this.eachAncestor((function(t){if(t.onFieldChange&&t.onFieldChange(e),t.isolateFields)return!1}))}},{key:"setupFocusListeners",value:function(){Fi.setupFocusListenersOnce(this._rootElement,Tu)}}],[{key:"$name",get:function(){return"Widget"}},{key:"type",get:function(){return"widget"}},{key:"configurable",get:function(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,cls:{$config:{merge:"classList"},value:null},contentElementCls:{$config:{merge:"classList"},value:null},dock:null,parent:null,tab:null,htmlCls:{$config:{merge:"classList"},value:{"b-html":1}},style:null,disabled:null,readOnly:{value:null,default:!1,$config:null},adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:{$config:["lazy","nullify"],value:null},preventTooltipOnTouch:null,monitorResize:{$config:["lazy","nullify"],value:null},masked:null,maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:"t-b",centered:null,constrainTo:void 0,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:ec},value:null},showAnimation:{$config:{merge:ec},value:null},x:null,y:null,scrollable:{$config:["nullify"],value:null},scrollerClass:ju,defaultBindProperty:"html",defaultAction:null,overflowable:{value:null,default:!0,$config:null},width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div",recomposeAsync:null,rootElement:null}}},{key:"prototypeProperties",get:function(){return{hasGeneratedId:!1,innerItem:!0}}},{key:"declarable",get:function(){return["renderConfigs"]}},{key:"delayable",get:function(){return{recompose:"raf"}}},{key:"factoryable",get:function(){return{defaultType:"widget"}}},{key:"identifiable",get:function(){return{}}},{key:"all",get:function(){return tt()(Ze()(s),"all",this)}},{key:"recomposeAsync",get:function(){return s._recomposeAsync},set:function(e){if(s._recomposeAsync=e,null!=e)for(var t=s.all,n=0;n<t.length;++n)t[n].isComposable&&(t[n].recomposeAsync=e)}},{key:"setupRenderConfigs",value:function(e,t){var n,r=e.renderConfigs;if(r){var i=t.getInherited("renderConfigs",!1)||Object.create(null);if(Array.isArray(r)){for(n=0;n<r.length;++n)i[r[n]]=!0;r=i}else r=Object.assign(i,r)}t.renderConfigs=r}},{key:"resetFloatRootScroll",value:function(){Xu.forEach((function(e){return e.scrollTop=e.scrollLeft=0}))}},{key:"floatRoots",get:function(){return Xu}},{key:"removeFloatRoot",value:function(e){Xu.splice(Xu.indexOf(e),1)}},{key:"outerCls",get:function(){var e=["b-outer"];return pe.a.isTouchDevice&&e.push("b-touch-events"),mi.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),pe.a.isChrome?e.push("b-chrome"):pe.a.isSafari?e.push("b-safari"):pe.a.isFirefox?e.push("b-firefox"):pe.a.isIE11?e.push("b-ie"):pe.a.isEdge&&e.push("b-edge"),window.ResizeObserver||e.push("b-no-resizeobserver"),e}},{key:"query",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s.identifiable.idMap;for(var r in n)if(s.widgetMatches(n[r],e,t))return n[r];return null}},{key:"queryAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s.identifiable.idMap,r=[];for(var i in n)s.widgetMatches(n[i],e,t)&&r.push(n[i]);return r}},{key:"fromElement",value:function(e,t,n){var r=I()(t);e&&!e.nodeType&&(e=e.target),("number"===r||t&&t.nodeType===Element.ELEMENT_NODE)&&(n=t,t=null);var i,o,a,l=e,u=0;for("number"!=typeof n&&(i=n,n=Number.MAX_VALUE),"string"===r&&(t=t.toLowerCase());l&&l.nodeType===Element.ELEMENT_NODE&&u<n&&l!==i;){if(o=l.dataset&&l.dataset.ownerCmp||l.id){if(a=s.getById(o)){if(!t)return a;if("function"===r){if(t(a))return a}else if(s.widgetMatches(a,t,!0))return a}u++}l=l.parentNode}return null}},{key:"widgetMatches",value:function(e,t,n){return"*"===t||("function"==typeof t?t(e):s.isType(e,t,n))}},{key:"attachTooltip",value:function(e,t){return"string"==typeof t&&(t={html:t}),s.create(Object.assign({forElement:e},t),"tooltip"),e}}]),s}($e.mixin(en,Ot,el,Gi,ao));function cc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}uc.prototype.compose.$nullFn=!0,uc.initClass(),uc.register("mask",qu),mi.Widget=uc,Fi.Widget=uc,qu.identifiable.idMap=uc.identifiable.idMap,Object.assign(window.bryntum||(window.bryntum={}),{get:uc.getById.bind(uc),query:uc.query,queryAll:uc.queryAll,fromElement:uc.fromElement}),uc._$name="Widget";var fc=function(e){Ye()(n,e);var t=cc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"contentElement",get:function(){var e;return null===(e=this.owner)||void 0===e?void 0:e.contentElement}},{key:"onChildAdd",value:function(e){}},{key:"onChildRemove",value:function(e){}},{key:"renderChildren",value:function(){var e=this,t=e.owner,n=e.containerCls,r=e.itemCls,i=t.contentElement,o=t.items,a=t.itemCls,s=null==o?void 0:o.length;if(i.classList.add("b-content-element"),n&&i.classList.add(n),s){t.textContent=!1;for(var l=0;l<s;l++){var u=o[l],c=u.element;c.dataset.itemIndex=l,r&&c.classList.add(r),a&&c.classList.add(a),c.classList.remove("b-outer"),u.render(i,Boolean(t.isPainted))}}e.syncPendingConfigs(),e.syncChildCount()}},{key:"removeChild",value:function(e){var t=this,n=e.element,r=t.owner,i=t.itemCls,o=r.contentElement,a=r.itemCls;o.contains(n)&&n.remove(),delete n.dataset.itemIndex,i&&n.classList.remove(i),a&&n.classList.remove(a),t.fixChildIndices(),t.syncChildCount()}},{key:"appendChild",value:function(e){var t=e.element,n=this.owner,r=this.itemCls,i=n.contentElement,o=n.itemCls;t.dataset.itemIndex=n.indexOfChild(e),n.textContent=!1,r&&t.classList.add(r),o&&t.classList.add(o),e.render(i,Boolean(n.isPainted)),this.syncChildCount()}},{key:"insertChild",value:function(e,t){var n=this,r=e.element,i=n.owner,o=n.itemCls,a=i.contentElement,s=mi.getChild(a,'[data-item-index="'.concat(t,'"]')),l=i.itemCls;i.textContent=!1,o&&r.classList.add(o),l&&r.classList.add(l),a.insertBefore(r,s),e.render(null,Boolean(i.isPainted)),n.fixChildIndices(),n.syncChildCount()}},{key:"fixChildIndices",value:function(){this.owner.items.forEach((function(e,t){e.element.dataset.itemIndex=t}))}},{key:"syncChildCount",value:function(){var e,t=this.owner,n=t.items.length;null===(e=t.contentElement)||void 0===e||e.classList[1===n?"add":"remove"]("b-single-child")}},{key:"syncConfigLater",value:function(e){var t=this.pendingConfigs||(this.pendingConfigs=[]);t.includes(e)||t.push(e)}},{key:"syncConfigStyle",value:function(e,t,n){var r=this,i=r.contentElement,o=r[e];i?i.style[t]=(null==n?void 0:n[o])||o:r.syncConfigLater(e)}},{key:"syncPendingConfigs",value:function(){var e,t=this,n=t.pendingConfigs;if(n)for(t.pendingConfigs=null;e=n.pop();)t[t.$meta.configs[e].updater](t[e])}}],[{key:"type",get:function(){return"default"}},{key:"configurable",get:function(){return{owner:null,containerCls:"b-auto-container",itemCls:null}}},{key:"factoryable",get:function(){return{defaultType:"default"}}}]),n}($e.mixin(Ot,ao));function dc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fc.initClass(),fc._$name="Layout";var hc=0,vc=function(e){return e.ripple},pc=function(e){Ye()(n,e);var t=dc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"afterConstruct",value:function(){tt()(Ze()(n.prototype),"afterConstruct",this).call(this),Tu.on({element:this.rootElement,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}},{key:"onRippleControllingEvent",value:function(e){var t,n=this;n.show();var r=mi.getStyleValue(n.circleElement,"animationName");n.hide(),null===(t=n.listenerDetacher)||void 0===t||t.call(n),r&&"none"!==r&&(n.listenerDetacher=Tu.on({mousedown:{element:n.rootElement,capture:!0,handler:"onMousedown"},touchstart:{element:n.rootElement,capture:!0,handler:"onTouchStart"},animationend:{element:n.circleElement,handler:"onAnimationEnd"},thisObj:n}),"mousedown"===e.type&&(n.onMousedown(e),Fi.on({theme:"onRippleControllingEvent",thisObj:this})))}},{key:"onTouchStart",value:function(e){hc=performance.now(),this.handleTriggerEvent(e)}},{key:"onMousedown",value:function(e){performance.now()-hc>200&&this.handleTriggerEvent(e)}},{key:"handleTriggerEvent",value:function(e){var t=uc.fromElement(e.target,vc);if(t){var n=t.ripple,r=n.delegate?e.target.closest(n.delegate):t.focusElement||t.element;if(r){var i=Qn.assign({event:e,target:r,radius:this.radius},n);if("string"==typeof i.clip&&(i.clip=t[i.clip]||e.target.closest(i.clip),!i.clip))return;this.ripple(i)}}}},{key:"ripple",value:function(e){var t=e.event,n=e.point,r=void 0===n?Tu.getClientPoint(t):n,i=e.target,o=void 0===i?t.target:i,a=e.clip,s=void 0===a?o:a,l=e.radius,u=void 0===l?this.radius:l,c=e.color,f=void 0===c?this.color:c;this.clip=s,s=Cr.from(s,null,!0);var d=this,h=s.getDelta(r),v=d.rippleElement.style,p=d.circleElement,g=mi.getStyleValue(o,"border-radius");d.hide(),d.alignTo(s),v.transform="translateX(".concat(h[0],"px) translateY(").concat(h[1],"px)"),v.height=v.width="".concat(u,"px"),d.element.style.borderRadius=g,p.setAttribute("r",u),p.setAttribute("fill",f),d.show(),d.requestAnimationFrame((function(){document.addEventListener("scroll",d.callRealign,!0),d.documentScrollListener=!0}))}},{key:"alignTo",value:function(e){e.nodeType===Element.ELEMENT_NODE&&(e=Cr.from(e,null,!0));var t=this,n=e,r=n.x,i=n.y,o=n.width,a=n.height;t.x=r,t.y=i,t.height=a,t.width=o}},{key:"onAnimationEnd",value:function(e){"b-ripple-expand"===e.animationName&&this.hide()}},{key:"realign",value:function(){this.isVisible&&this.alignTo(this.clip)}}],[{key:"defaultConfig",get:function(){return{old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}},{key:"$name",get:function(){return"Ripple"}}]),n}(uc);function gc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}uc.RippleClass=pc,pc._$name="Ripple";var yc=Object.freeze({}),mc=Array.isArray,bc=function(e){return e.weight},kc=function(e,t){var n=e.weight,r=t.weight;return"string"==typeof n||"string"==typeof r?String(n).localeCompare(String(r)):(null!=n?n:Number.MAX_SAFE_INTEGER)-(null!=r?r:Number.MAX_SAFE_INTEGER)},wc=function(e){return e&&!e.hidden},Cc=["display","flex-direction"],Rc=function(e){Ye()(n,e);var t=gc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"startConfigure",value:function(e){var t=e.items||e.lazyItems;(this.hasItems=Boolean(t&&(mc(t)?t:Object.keys(t)).length))||(this.initialItems=!1),tt()(Ze()(n.prototype),"startConfigure",this).call(this,e)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0;1===t.length&&(mc(t[0])?t=t[0]:r=!1);for(var i=this,o=i._items,a=[],s=0;s<t.length;s++){var l=t[s];o.includes(l)&&(o.remove(l),i.layout.removeChild(l),a.push(l),i.onChildRemove(l))}return r?a:a[0]}},{key:"removeAll",value:function(){return this.remove(this.items)}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i,o,a=this,s=[],l=a._items,u=!0;for(1===t.length&&(mc(t[0])?t=t[0]:u=!1),l||(a.items=[],l=a._items),i=0;i<t.length;i++){var c;null!=(null===(c=r=t[i])||void 0===c?void 0:c.weight)?(o=it.findInsertionIndex(r,l.values,kc),s.push(a.insert(r,o))):r&&(r.isWidget?r.parent=a:r=a.createWidget(r),l.includes(r)||(l.add(r),a.onChildAdd(r),a.layout.appendChild(r),s.push(r)))}return u?s:s[0]}},{key:"insert",value:function(e,t){this.items||(this.items=[]);var n=this,r=n._items;e instanceof uc?e.parent=n:e=n.createWidget(e),r.includes(t)&&(t=n.indexOfChild(t)),t=Math.min(t,r.count);var i=r.values;return i.splice(t,0,e),r.values=i,n.onChildAdd(e),n.layout.insertChild(e,t),e}},{key:"indexOfChild",value:function(e){return this.items.indexOf(e)}},{key:"changeLazyItems",value:function(e){this.items=e,this.layout.renderChildren()}},{key:"changeItems",value:function(e,t){var n=this,r=[],i=new sa;return mc(e)?n.processItemsArray(e,r):e&&n.processItemsObject(e,n.namedItems,r),r.some(bc)&&r.sort(kc),i.add(r),t&&t.forEach((function(e){n.remove(e),i.includes(e)||e._createdBy!==n||e.destroy()})),i}},{key:"updateItems",value:function(e,t){var n=this,r=0;e.forEach((function(e){n.onChildAdd(e),t&&!t.temporary&&n.layout.insertChild(e,r),++r})),this.initialItems=!1}},{key:"updateHideWhenEmpty",value:function(){this.syncChildCount(this.rendered)}},{key:"items",get:function(){var e=this;if(e.getConfig("lazyItems"),!e._items){if(e.initializingItems)return[];e._items=new sa,e._items.temporary=!0}return e._items.values}},{key:"processItemsArray",value:function(e,t){var n,r,i=e.length;for(n=0;n<i;n++)(r=e[n])instanceof uc?(r.parent=this,mi.removeClasses(r.element,uc.outerCls)):r=this.createWidget(r),r&&((r.ref||r.id)&&this.addDescendant(r),t.push(r))}},{key:"processItemsObject",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yc,i=arguments.length>2?arguments[2]:void 0;for(n in e)(t=e[n])&&(n in r&&(t="object"===I()(t)?Qn.merge(Qn.clone(r[n]),t):r[n]),t&&(t instanceof uc?t.parent=this:(t instanceof Object&&(t.ref=n),t=this.createWidget(t)),t&&(t.ref=n,this.addDescendant(t),i.push(t))))}},{key:"onChildAdd",value:function(e){if(e.innerItem&&this.readOnly&&(e.readOnly=!0),this.onChildAddLayout(e),e.ref||e.id)for(var t=this;t;t=t.parent)t.addDescendant(e);this.syncChildCount(!0)}},{key:"onChildAddLayout",value:function(e){e.innerItem&&this.layout.onChildAdd(e)}},{key:"onChildHide",value:function(){this.syncChildCount(!0)}},{key:"onChildShow",value:function(){this.syncChildCount(!0)}},{key:"syncChildCount",value:function(e){if(!this.isConfiguring){var t=this,n=t.childItems,r=t.hasItems,i=n.length,o=n.filter(wc),a=o.length;if(t.hideWhenEmpty&&e){var s=Boolean(!a);Boolean(t._hidden)!==s&&(t.hidden=s)}for(var l=0;l<i;l++)n[l].element.classList.remove("b-last-visible-child"),n[l].element.classList.remove("b-first-visible-child");a&&(o[0].element.classList.add("b-first-visible-child"),o[a-1].element.classList.add("b-last-visible-child")),t.hasItems=Boolean(i),t.contentElement.classList[a?"remove":"add"]("b-no-visible-children"),t.isComposable?r!==t.hasItems&&t.recompose():t.updateTextContent(t._textContent)}}},{key:"syncFlexDirection",value:function(){var e=this.contentElement,t=new xr(e.className),n=mi.getStyleValue(e,Cc);t["b-flex-row"]=t["b-flex-column"]=0,"flex"===n.display&&(t["b-flex-".concat(n["flex-direction"])]=1),mi.syncClassList(e,t)}},{key:"addDescendant",value:function(e){var t=e.ref||e.id,n=this._widgetMap||(this._widgetMap={});n[t]||(n[t]=e)}},{key:"onChildRemove",value:function(e){var t=e.ref||e.id;if(t)for(var n=this;n;n=n.parent)n.widgetMap[t]===e&&delete n.widgetMap[t];this.layout.onChildRemove(e),this.syncChildCount(!0)}},{key:"widgetMap",get:function(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}},{key:"changeRecord",value:function(e){return this._record=null==e?yc:null,e}},{key:"updateRecord",value:function(e){this.trigger("beforeSetRecord",{record:e}),this.setValues(e,!0,!this.$highlight)}},{key:"setRecord",value:function(e,t){this.$highlight=t,this.record=e,this.$highlight=!1}},{key:"onFieldChange",value:function(e){var t=e.source,n=e.userAction;if(this.autoUpdateRecord){var r=this.record,i=t.name,o=t.isValid,a=t.value;r&&n&&i&&o&&(r[i]=a)}}},{key:"getValues",value:function(e){var t={};return this.eachWidget((function(n,r){n.isolateFields?r.down=!1:!("name"in n)||e&&!e(n)||(t[n.name]=n.value)}),!0),t}},{key:"hasNoChildren",get:function(){var e=this,t=e.initialConfig,n=t.items,r=t.lazyItems,i=n&&(mc(n)?n:Qn.values(n)),o=r&&(mc(r)?r:Qn.values(r)),a=e.isConfiguring?o||i:e.items;return!(null!=a&&a.filter(wc).length)}},{key:"afterRecompose",value:function(){this.realign()}},{key:"updateTextContent",value:function(e){var t=this;t.isComposable||(t.contentElement.classList[e&&t.hasNoChildren?"add":"remove"]("b-text-content"),t.rendered&&t.realign())}},{key:"updateLayoutStyle",value:function(e){mi.applyStyle(this.contentElement,e)}},{key:"onPaint",value:function(){var e;null===(e=tt()(Ze()(n.prototype),"onPaint",this))||void 0===e||e.apply(this,arguments),this.getConfig("contentElMutationObserver")}},{key:"changeContentElMutationObserver",value:function(e,t){if(t&&(t.takeRecords(),t.disconnect()),e){var n=this,r=n.element,i=n.contentElement;(e=new MutationObserver((function(e){return n.onContentElMutation(e)}))).observe(i,{attributes:!0}),i!==r&&e.observe(r,{attributes:!0}),n.syncFlexDirection()}return e}},{key:"onContentElMutation",value:function(){this.isVisible&&this.syncFlexDirection()}},{key:"changeLayout",value:function(e,t){return fc.reconfigure(t,e,{owner:this,defaults:{owner:this}})}},{key:"childItems",get:function(){return this.items}},{key:"getWidgetById",value:function(e){return this.widgetMap[e]}},{key:"processWidgetConfig",value:function(e){}},{key:"setupWidgetConfig",value:function(e,t){var n=this;"string"==typeof e?e={html:e}:e.nodeType===Element.ELEMENT_NODE&&(e={element:e,id:e.id}),("string"==typeof t||!t&&(t=e.type))&&(t=uc.resolveType(t,!0));for(var r=(e=(t||uc).mergeConfigs(n.defaults,e,{parent:n})).parent;r;r=r.parent)if(!1===r.processWidgetConfig(e))return null;return!1===n.trigger("beforeWidgetCreate",{widgetConfig:e})?null:e}},{key:"createWidget",value:function(e){var t=uc.create(this.setupWidgetConfig(e),this.defaultType);return t&&(t._createdBy=this),t}},{key:"updateDefaults",value:function(e,t){if(!this.isConfiguring){var n=Object.entries(e);this.eachWidget((function(e){n.forEach((function(n){var r=N()(n,2),i=r[0],o=r[1];e[i]===t[i]&&(e[i]=o)}))}),!1)}}},{key:"render",value:function(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),tt()(Ze()(n.prototype),"render",this).apply(this,arguments)}},{key:"focusElement",get:function(){var e=this.query(this.defaultFocus||function(e){return e.isFocusable&&"close"!==e.ref});return e?e.focusElement:tt()(Ze()(n.prototype),"focusElement",this)}},{key:"doDestroy",value:function(){var e;null===(e=this._items)||void 0===e||e.forEach((function(e){var t;return null===(t=e.destroy)||void 0===t?void 0:t.call(e)})),this.layout.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"isValid",get:function(){var e=!0;return this.eachWidget((function(t){"isValid"in t&&!t.isValid&&(e=!1)}),!0),e}},{key:"values",get:function(){var e={};return this.eachWidget((function(t,n){t.isolateFields?n.down=!1:"value"in t&&(e[t.name||t.ref||t.id]=t.value)}),!0),e},set:function(e){this.setValues(e)}},{key:"isSettingValues",get:function(){var e;return Boolean(this._isSettingValues||(null===(e=this.parent)||void 0===e?void 0:e.isSettingValues))}},{key:"setValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._isSettingValues={preventHighlight:n},this.eachWidget((function(r,i){var o=r.highlightExternalChange,a=t?r.name:r.name||r.ref||r.id;"value"in r&&a&&(n&&(r.highlightExternalChange=!1),r.value=e&&a in e?e[a]:null,r.highlightExternalChange=o),r.isolateFields&&(i.down=!1)}),!0),this._isSettingValues=!1}}],[{key:"$name",get:function(){return"Container"}},{key:"type",get:function(){return"container"}},{key:"configurable",get:function(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:{type:"default"},namedItems:null,overflowable:{value:null,default:!1,$config:null},textContent:!0,record:null,autoUpdateRecord:null,hideWhenEmpty:null,contentElMutationObserver:{$config:["lazy","nullify"],value:!0},isolateFields:!1}}},{key:"prototypeProperties",get:function(){return{initialItems:!0}}}]),n}(uc);function Sc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Rc.initClass(),Rc._$name="Container";var Ec=Symbol("pendingCreate"),Dc=function(e){Ye()(n,e);var t=xc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"proxy",get:function(){var e=this,t=null;return e.proxyable&&(t=new Proxy(e.instances,{get:function(t,n){return e.get(n)},set:function(t,n,r){return e.set(n,r),!0},deleteProperty:function(t,n){return e.set(n,null),!0}})),Reflect.defineProperty(e,"proxy",{configurable:!0,value:t}),t}},{key:"target",get:function(){return this.proxy||this.object}},{key:"define",value:function(e,t){var n=this,r=n.transform,i=r?r(t,e):t,o=Qn.isInstantiated(i);n.instances[e]=Ec,o||n.setDefaults(e,i),n.defineProp(e,!0),o&&n.set(e,i)}},{key:"defineProp",value:function(e,t){var n=this,r=n.object;n.proxy||Reflect.defineProperty(t?Object.getPrototypeOf(r):r,e,{configurable:!t,enumerable:!0,get:function(){return n.get(e)},set:function(t){return n.set(e,t)}})}},{key:"flush",value:function(){var e=this;try{var t;for(var n in e.updating=!0,e.defaults)e.get(n);e.afterConfigureOwner=null===(t=e.afterConfigureOwner)||void 0===t?void 0:t.call(e)}finally{e.updating=!1}}},{key:"get",value:function(e){var t=this.defaults,n=this.instances;return n[e]===Ec&&this.set(e,Ec),n[e]||t[e]&&null}},{key:"set",value:function(e,t){var n=this,r=n.cleanup,i=n.configName,o=n.defaults,a=n.factory,s=n.instances,l=n.owner,u=n.setup,c=n.transform,f=n.updating,d=l&&i&&!f,h=s[e]===Ec?null:s[e],v=a.reconfigure(h,t===Ec?{}:t||null,{cleanup:r&&function(t){return r(t,e)},defaults:o[e]||n.setDefaults(e,{}),owner:n.owner,setup:u&&function(t,n,r){return u(t,e,n,r)},transform:c&&function(t){return c(t,e)}});if(v!==h){var p,g=d&&function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sc(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},s);if(s[e]=v,v)n.defineProp(e),null===(p=n.created)||void 0===p||p.call(n,v,e);else delete n.object[e],delete s[e];d&&l.onConfigChange({name:i,config:l.$meta.configs[i],value:n.target,was:g})}}},{key:"setDefaults",value:function(e,t){var n=this.defaults,r=this.factory,i=this.inferType,o=this.instances,a=this.owner,s=this.ownerName,l=r.factoryable.typeKey;return t=!0===t?{}:Qn.assign({},t),("name"===i||!0===i&&!t[l])&&(t[l]=e),s&&(t[s]=a),t.beforeConfigure=function(t){o[e]=t},n[e]=t}},{key:"update",value:function(e){var t,n,r=this,i=r.owner;try{if(r.updating=!0,e)for(t in e)n=e[t],r.defaults[t]?r.set(t,n):n&&r.define(t,n);else for(t in r.instances)r.set(t,null)}finally{r.updating=!1}i&&(i.isConfiguring?r.afterConfigureOwner||(r.afterConfigureOwner=at.before(i,"afterConfigure","flush",r)):r.flush())}}],[{key:"prototypeProperties",get:function(){return{cleanup:null,configName:null,created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:"undefined"!=typeof Proxy,setup:null,transform:null}}},{key:"properties",get:function(){return{defaults:{},instances:{},object:Object.create({})}}}]),n}($e);Dc.initClass(),Dc._$name="DynamicObject";n(135);function Tc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Oc=function(e){Ye()(n,e);var t=Tc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"doDestroy",value:function(){var e;null===(e=this.mousedownRemover)||void 0===e||e.call(this),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"cancel",value:function(){var e,t,n,r=this;null===(e=r.activeElement)||void 0===e||e.classList.remove(r.pressedCls),r.activeElement=null,null===(t=r.acceleration)||void 0===t||t.cancel(),r.activeListenerRemover=null===(n=r.activeListenerRemover)||void 0===n?void 0:n.call(r),r.clearTimeout("startAutoRepeat"),r.clearTimeout(r.repeatTimer)}},{key:"updateElement",value:function(e){var t;null===(t=this.mousedownRemover)||void 0===t||t.call(this),this.mousedownRemover=Tu.on({element:e,mousedown:"onMouseDown",thisObj:this})}},{key:"onMouseDown",value:function(e){var t=this,n=t.delegate?e.target.closest(t.delegate):t.element;t.cancel(),n&&(t.activeElement=n,t.triggerEvent=e,n.classList.add(t.pressedCls),t.activeListenerRemover=Tu.on({mouseup:{element:document,handler:"onMouseUp"},mousemove:{element:n,handler:"onTargetMouseMove"},mouseleave:{element:n,handler:"onTargetMouseLeave"},mouseenter:{element:n,handler:"onTargetMouseEnter"},thisObj:t}),t.setTimeout("startAutoRepeat",t.delay))}},{key:"onMouseUp",value:function(){this.cancel()}},{key:"onTargetMouseLeave",value:function(){this.activeElement.classList.remove(this.pressedCls),this.clearTimeout(this.repeatTimer)}},{key:"onTargetMouseEnter",value:function(e){var t=this;e.buttons?(t.activeElement.classList.add(t.pressedCls),t.triggerEvent=e,t.fireClick()):t.cancel()}},{key:"onTargetMouseMove",value:function(e){this.triggerEvent=e}},{key:"startAutoRepeat",value:function(){var e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=at.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}},{key:"nextTick",value:function(e){this.interval=this.startInterval-this.accelerationDelta*e}},{key:"fireClick",value:function(){var e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}}],[{key:"configurable",get:function(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3,pressedCls:"b-pressed"}}}]),n}($e.mixin(el));function Mc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Oc._$name="ClickRepeater";var Ac=/^(?:undefined|null|LEFT|RIGHT)$/,Ic={TOP:"BOTTOM",RIGHT:"LEFT",BOTTOM:"TOP",LEFT:"RIGHT"},Pc=function(e){var t=null==e?void 0:e.toUpperCase();return[t,"LEFT"===t||"RIGHT"===t]},Fc=function(e){return function(e){Ye()(n,e);var t=Mc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e,t=this.rotate;return{class:(e={},Qe()(e,"b-rotate-".concat((t||"").toLowerCase()),t),Qe()(e,"b-rotate-vertical",t),e)}}},{key:"syncRotationToDock",value:function(e){if(Ac.test(String(this.rotate))){var t=Pc(e),n=N()(t,2),r=n[0],i=n[1];this.rotate=i?this.invertRotate?Ic[r]:r:null}}},{key:"widgetClass",get:function(){return null}}],[{key:"$name",get:function(){return"Rotatable"}},{key:"configurable",get:function(){return{rotate:null,invertRotate:null}}}]),n}(e||$e)};function Lc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Bc=function(e){Ye()(n,e);var t=Lc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e,t=this.align,n=this.ariaLabel;return{tag:"button",class:(e={},Qe()(e,"b-align-".concat(t||"end"),1),Qe()(e,"b-icon",1),e),"aria-label":n,listeners:{click:"onClick"}}}},{key:"focusElement",get:function(){return this.element}},{key:"panel",get:function(){return this.parent}},{key:"changeAlign",value:function(e){return e}},{key:"onClick",value:function(e){var t=this.handler,n=this.panel;!1!==(null==n?void 0:n.trigger("toolclick",{domEvent:e,tool:this}))&&t&&this.callback(t,n,[e])}},{key:"onInternalKeyDown",value:function(e){"Enter"===(e.key.trim()||e.code)&&(e.cancelBubble=!0,e.stopPropagation())}},{key:"updateDisabled",value:function(e,t){var r;tt()(Ze()(n.prototype),"updateDisabled",this).call(this,e,t),e&&(null===(r=this.repeat)||void 0===r||r.cancel())}},{key:"changeRepeat",value:function(e,t){return null==t||t.destroy(),e&&Oc.new({element:this.element},e)}}],[{key:"$name",get:function(){return"Tool"}},{key:"type",get:function(){return"tool"}},{key:"configurable",get:function(){return{align:{value:null,$config:{merge:"replace"}},repeat:null,ariaLabel:null}}}]),n}(uc.mixin(Fc));function jc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Bc.initClass(),Bc._$name="Tool";var _c=[],Hc=function(e,t){var n={};if(e)for(var r,i=0;i<e.length;++i)n[(r=e[i]).ref]=t?r.element:r;return n},Nc={align:1,weight:1},zc=function(e){return function(e){Ye()(n,e);var t=jc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"byWeightSortFn",value:function(e,t){return(e.weight||0)-(t.weight||0)}},{key:"byWeightReverseSortFn",value:function(e,t){return(t.weight||0)-(e.weight||0)}},{key:"childItems",get:function(){return[].concat(F()(this.startTools),F()(this._items||_c),F()(this.endTools))}},{key:"endTools",get:function(){return Qn.values(this.tools,(function(e,t){var n,r;return"end"!==(null!==(n=null==t||null===(r=t.align)||void 0===r?void 0:r.align)&&void 0!==n?n:null==t?void 0:t.align)})).sort(this.byWeightReverseSortFn)}},{key:"endToolRefs",get:function(){return Hc(this.endTools)}},{key:"endToolElementRefs",get:function(){return Hc(this.endTools,!0)}},{key:"startTools",get:function(){return Qn.values(this.tools,(function(e,t){var n,r;return"start"!==(null!==(n=null==t||null===(r=t.align)||void 0===r?void 0:r.align)&&void 0!==n?n:null==t?void 0:t.align)})).sort(this.byWeightSortFn)}},{key:"startToolRefs",get:function(){return Hc(this.startTools)}},{key:"startToolElementRefs",get:function(){return Hc(this.startTools,!0)}},{key:"changeTools",value:function(e,t){var n=this,r=n.$tools||(n.$tools=new Dc({configName:"tools",factory:uc,inferType:!1,owner:n,created:function(e){var t,i;e.innerItem=!1,null===(t=e.syncRotationToDock)||void 0===t||t.call(e,null===(i=n.header)||void 0===i?void 0:i.dock),at.after(e,"onConfigChange",(function(e,t){var i=t.name;Nc[i]&&n.onConfigChange({name:"tools",value:r.target})})),n.onChildAdd(e)},setup:function(e,t){return(e=Qn.merge({},n.toolDefaults["*"],n.toolDefaults[t],e)).parent=n,e.ref=t,e}}));if(r.update(e),!t)return r.target}}],[{key:"$name",get:function(){return"Toolable"}},{key:"configurable",get:function(){return{tools:{value:null,$config:{nullify:!0}},toolDefaults:{"*":{type:"tool",align:"end"},close:{weight:-1e3},collapse:{weight:-990}}}}}]),n}(e||uc)};function Vc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Wc=["b-hbox","b-vbox"],$c={false:"nowrap",true:"wrap",reverse:"wrap-reverse"},Uc=function(e){Ye()(n,e);var t=Vc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"vertical",get:function(){return!1===this.horizontal},set:function(e){return this.horizontal=!e}},{key:"updateAlign",value:function(){this.syncConfigStyle("align","alignItems")}},{key:"updateContentAlign",value:function(){this.syncConfigStyle("contentAlign","alignContent")}},{key:"updateDirection",value:function(){this.syncConfigStyle("direction","flexDirection")}},{key:"updateHorizontal",value:function(){var e,t=this,n=null===(e=t.contentElement)||void 0===e?void 0:e.classList,r=Number(t.vertical);n?(n.remove(Wc[1-r]),n.add(Wc[r])):t.syncConfigLater("horizontal"),t.syncDirection()}},{key:"updateJustify",value:function(){this.syncConfigStyle("justify","justifyContent")}},{key:"updateReverse",value:function(){this.syncDirection()}},{key:"updateWrap",value:function(){this.syncConfigStyle("wrap","flexWrap",$c)}},{key:"syncDirection",value:function(){var e=this,t=e.reverse;e.direction=t?"".concat(e.vertical?"column":"row").concat(t?"-reverse":""):null}}],[{key:"$name",get:function(){return"Box"}},{key:"type",get:function(){return"box"}},{key:"alias",get:function(){return"hbox"}},{key:"configurable",get:function(){return{itemCls:"b-box-item",align:null,contentAlign:null,direction:null,horizontal:!0,justify:null,reverse:null,wrap:null}}}]),n}(fc);function Gc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Uc.initClass(),Uc._$name="Box";var Yc=function(e){Ye()(n,e);var t=Gc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"VBox"}},{key:"type",get:function(){return"vbox"}},{key:"configurable",get:function(){return{horizontal:!1}}}]),n}(Uc);function qc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Yc.initClass(),Yc._$name="VBox";var Kc=function(e){return function(e){Ye()(n,e);var t=qc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e=this.badge;return{dataset:{badge:e},class:{"b-badge":null!=e&&""!==e}}}}],[{key:"$name",get:function(){return"Badge"}},{key:"configurable",get:function(){return{badge:null}}}]),n}(e||$e)};function Xc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xc(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Qc=/(?:^|\s)b-icon-/,ef=/(?:^|\s)b-fa-/,tf=Symbol("defaultToggleable"),nf=function(e){Ye()(n,e);var t=Jc(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e,t=this.color,n=this.href,r=this.icon,i=this.iconAlign,o=this.pressed,a=this.pressedIcon,s=this.target,l=this.text,u=this.toggleable,c=this.toggleGroup,f=o&&a?a:r;return{tag:n?"a":"button",href:n,target:s,class:(e={},Qe()(e,"b-icon-align-".concat(i),r),Qe()(e,t,Boolean(t)),Qe()(e,"b-pressed",o&&u),Qe()(e,"b-text",Boolean(l)),e),dataset:{group:c},listeners:{click:"onInternalClick"},children:{iconElement:(r||a)&&{tag:"i",class:Zc(Zc({},xr.normalize(f,"object")),{},{"b-icon":Qc.test(f),"b-fa":ef.test(f)})},label:l&&{tag:"label",text:l}}}}},{key:"onHide",value:function(){var e;null===(e=this._menu)||void 0===e||e.hide()}},{key:"childItems",get:function(){return this._menu&&[this.menu]}},{key:"onFocusOut",value:function(e){var t;tt()(Ze()(n.prototype),"onFocusOut",this).call(this,e),null===(t=this.menu)||void 0===t||t.hide()}},{key:"focusElement",get:function(){return this.element}},{key:"changeText",value:function(e){return null==e?"":e}},{key:"changeToggleable",value:function(e){return e===tf?this.toggleGroup||this.config.menu:e}},{key:"changeMenu",value:function(e,t){var n=this;if(e){var r=function(){return!n.isDestroying&&n.setTimeout((function(){return n.toggle(!1)}),n.onMenuHideTimeout)};e.isWidget?(e.forElement=n.element,e.owner=n,e.on("hide",r)):("object"!==I()(e)||"type"in e||"items"in e||"widgets"in e||"html"in e||(e={lazyItems:e}),e=uc.reconfigure(t,e?he.merge({constrainTo:n.rootElement,forElement:n.element,owner:n,onHide:r},n.menuDefaults,e):null,n))}else t&&t.destroy();return e}},{key:"updateMenu",value:function(e){this.toggleable=Boolean(e)}},{key:"updatePressed",value:function(e){var t=this;!t.isConfiguring&&e&&t.toggleGroup&&mi.forEachSelector(t.rootElement,"button[data-group=".concat(t.toggleGroup,"]"),(function(e){e!==t.element&&uc.getById(e.id).toggle(!1)}))}},{key:"onInternalClick",value:function(e){var t=this,n={event:e};if(t.toggleable){if(t.toggleGroup&&t.pressed)return;if(t.toggle(!t.pressed),t.isDestroyed)return}t.trigger("click",n),t.isDestroyed||t.trigger("action",n),t.href||(e.preventDefault(),e.stopPropagation())}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t.menu;if(t.toggleable&&(null===e&&(e=!t.pressed),t.pressed!==e)){var r,i;if(t.toggling=!0,t.pressed=e,n)n.initialConfig.minWidth||(n.minWidth=t.width),n.align.constrainTo=window,n.align.constrainPadding=10,n.align.minHeight=null!==(r=n._minHeight)&&void 0!==r?r:100,n.align.minWidth=null!==(i=n._minWidth)&&void 0!==i?i:100,n[e?"show":"hide"]();t.trigger("toggle",{pressed:e}),t.toggling=!1}}}],[{key:"$name",get:function(){return"Button"}},{key:"type",get:function(){return"button"}},{key:"configurable",get:function(){return{icon:null,pressedIcon:null,iconAlign:"start",text:{value:null,$config:null,default:""},color:null,toggleable:tf,pressed:!1,toggleGroup:null,ripple:{radius:75},defaultBindProperty:"text",localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,onMenuHideTimeout:300,testConfig:{onMenuHideTimeout:0}}}}]),n}(uc.mixin(Kc,Fc));function rf(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return of(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return of(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function of(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function af(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?af(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):af(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}nf.initClass(),nf._$name="Button";var uf=function(e){return e.isToolbar},cf=[{box:"hbox",clientSizeProp:"clientWidth",edgeProp:"right",flexDir:"row",horizontal:!0,max:"maxX",overflow:"overflowX",pos:"x",scrollSize:"scrollWidth",sizeProp:"width"},{box:"vbox",clientSizeProp:"clientHeight",edgeProp:"bottom",flexDir:"column",horizontal:!1,max:"maxY",overflow:"overflowY",pos:"y",scrollSize:"scrollHeight",sizeProp:"height"}],ff={delay:0,startRate:40,endRate:200,accelerateDuration:500},df=function(e){Ye()(n,e);var t=lf(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e,t=this.axisProps,n=this.dock,r=this.endToolElementRefs,i=this.startToolElementRefs;return{class:(e={},Qe()(e,"b-dock-".concat(n),1),Qe()(e,"b-".concat(n,"-toolbar"),1),Qe()(e,"b-".concat(t.box),1),e),children:sf(sf({},i),{},{toolbarContent:{class:{"b-box-center":1,"b-toolbar-content":1}}},r)}}},{key:"axisProps",get:function(){return cf[this.layout.horizontal?0:1]}},{key:"contentElement",get:function(){return this.toolbarContent}},{key:"overflowMenuButton",get:function(){var e;return null===(e=this.tools)||void 0===e?void 0:e.overflowMenuButton}},{key:"overflowType",get:function(){var e=this.overflow;return"string"==typeof e?e:null==e?void 0:e.type}},{key:"onChildAdd",value:function(e){var t;tt()(Ze()(n.prototype),"onChildAdd",this).call(this,e),this.processAddedLeafItem(e),null===(t=e.syncRotationToDock)||void 0===t||t.call(e,this.dock)}},{key:"processAddedLeafItem",value:function(e){var t=this;at.after(e,"onConfigChange",this.onLeafItemConfigChange,e),e.isContainer&&e.eachWidget((function(e){return t.processAddedLeafItem(e)}))}},{key:"onPaint",value:function(e){var t,r=e.firstPaint;null===(t=tt()(Ze()(n.prototype),"onPaint",this))||void 0===t||t.apply(this,arguments),r&&this.getConfig("overflow")}},{key:"updateDock",value:function(e){var t=this,n=t.layout,r=n.vertical;if(n.vertical=Pc(e)[1],!t.initialItems){r!==n.vertical&&t.updateOverflow(t.overflow);var i,o=rf(t.childItems);try{for(o.s();!(i=o.n()).done;){var a,s=i.value;null===(a=s.syncRotationToDock)||void 0===a||a.call(s,e)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"updateOverflow",value:function(e,t){var n,r,i,o=this,a=o.axisProps,s=o.contentElement,l=o.overflowType,u=a.flexDir,c=null===(n=o.overflowMenuButton)||void 0===n?void 0:n._menu,f={};if(c&&(e?null==c||c.removeAll():c.eachWidget((function(e){e._toolbarOverflowOriginal._toolbarOverflowClone=null}))),"menu"===t?f.overflowMenuButton=null:"scroll"===t&&(f.overflowScrollStart=f.overflowScrollEnd=null),"menu"===l)null===(r=o.scrollable)||void 0===r||r.destroy(),s.style.overflow=s.style.overflowX=s.style.overflowY="",f.overflowMenuButton={cls:(i={},Qe()(i,"b-".concat(u,"-menu"),1),Qe()(i,"b-overflow-button",1),i)};else if("scroll"===l){var d,h,v,p="object"===I()(e)&&(null==e?void 0:e.repeat)||ff;o.scrollable=(d={},Qe()(d,a.overflow,"hidden-scroll"),Qe()(d,"element",s),Qe()(d,"listeners",{scroll:"onContentScroll",thisObj:o}),d),f.overflowScrollStart={repeat:p,invertRotate:!0,cls:(h={},Qe()(h,"b-".concat(u,"-start-scroller"),1),Qe()(h,"b-icon-angle-left",1),Qe()(h,"b-overflow-button",1),Qe()(h,"b-icon",1),h)},f.overflowScrollEnd={repeat:p,invertRotate:!0,cls:(v={},Qe()(v,"b-".concat(u,"-end-scroller"),1),Qe()(v,"b-icon-angle-right",1),Qe()(v,"b-overflow-button",1),Qe()(v,"b-icon",1),v)}}o.tools=f,l?(s.classList.add("b-overflow"),o.monitorResize=!0,o.syncOverflowVisibility()):(s.classList.remove("b-overflow"),o.monitorResize=!1)}},{key:"onContentScroll",value:function(){this.syncScrollerState()}},{key:"onStartScrollClick",value:function(){this.scrollable[this.axisProps.pos]-=2}},{key:"onEndScrollClick",value:function(){this.scrollable[this.axisProps.pos]+=2}},{key:"onInternalResize",value:function(){tt()(Ze()(n.prototype),"onInternalResize",this).apply(this,arguments),this.isPainted&&this.syncOverflowVisibility()}},{key:"syncOverflowVisibility",value:function(){var e=this,t=e.overflowType,n=e.contentElement,r=e.isVisible,i=e.axisProps,o=i.clientSizeProp,a=i.edgeProp,s=i.sizeProp,l=e.tools,u=l.overflowMenuButton,c=l.overflowScrollStart,f=l.overflowScrollEnd,d="menu"===t;if(r&&t){e.inSyncOverflowVisibility=!0,null==u||u.hide();var h,v,p,g,y=0;if(e.eachWidget((function(e,t){e.floating?t.down=!1:(t.down=!(p=e.overflowable),p&&e.innerItem&&(e._toolbarOverflow&&(e.hidden=e._toolbarOverflow=!1),e.isVisible&&((g||(g=[])).push(e),++y)))})),g&&(v=g[--y].rectangle(n),h=Math.ceil(n[o]+(!c||c.hidden?0:c.rectangle("outer")[s])+(!f||f.hidden?0:f.rectangle("outer")[s]))),g&&Math.floor(v[a])>h)if(d){for(u.show(),h=n[o];y-- >0&&(v=g[y].rectangle(n),!(Math.floor(v[a])<=h)););e.syncOverflowMenuButton(g.slice(y+1))}else f.show(),c.show(),e.syncScrollerState();else d||(null==f||f.hide(),null==c||c.hide());e.inSyncOverflowVisibility=!1}}},{key:"syncOverflowMenuButton",value:function(e){for(var t,n,r=this,i=r.axisProps,o=r.overflowMenuButton,a={cls:"b-toolbar-overflow-menu",minWidth:280,items:[],align:{align:i.horizontal?"t100-b100":"r100-l100",axisLock:"flexible"}},s=0,l=e.length;s<l;s++)(n=e[s])._toolbarOverflowWidth=n.width,n._toolbarOverflow=!0,n.hidden=!0;if(r.addToMenu(a,e.filter((function(){return r.overflowItemFilter}))),null!==(t=o._menu)&&void 0!==t&&t.isMenu){var u=o.menu,c=it.delta(a.items,u.items,1),f=c.toAdd,d=c.toRemove;if(u.remove(d),u.items.length)for(var h=f.length-1;h>=0;h--)u.insert(f[h],0);else u.add(f)}else o.menu=a}},{key:"syncScrollerState",value:function(){var e=this,t=e.axisProps,n=e.scrollable,r=e.tools,i=r.overflowScrollStart,o=r.overflowScrollEnd,a=n[t.pos],s=n[t.max];i.disabled=!a,o.disabled=Math.ceil(a)>=s}},{key:"overflowItemFilter",value:function(e){var t=Boolean(mi.getChildElementCount(e)),n=this.overflow.filter;return t&&(n?n(e):1)}},{key:"addToMenu",value:function(e,t){for(var n=this.horizontal,r=0,i=t.length;r<i;r++){var o=t[r],a=o._toolbarOverflowClone,s=o.constructor;if(!a){var l=he.clone(o.initialConfig);delete l.id,l.width="",n&&(l.flex=""),l.minWidth=o._toolbarOverflowWidth,l.type=o.type,l._toolbarOverflowOriginal=o,l.disabled=o.disabled,"value"in o&&(l.value=o.value),"button"===l.type&&(l.text||(l.text=o.tooltipText)),o._toolbarOverflowClone=a=s.create(l),a.element.style.margin="",o.isField&&a.on({change:this.onFieldCloneChange})}e.items.push(a)}}},{key:"onFieldCloneChange",value:function(e){var t=e.source,n=e.value;t._toolbarOverflowOriginal.value=n}},{key:"onLeafItemConfigChange",value:function(e,t){var n=t.name,r=t.value,i=this,o=i.up(uf),a=i._toolbarOverflowClone;null!=o&&o.inSyncOverflowVisibility||"hidden"===n&&r===i._toolbarOverflow||(a&&(a[n]=r),null!=o&&o.isPainted&&"overflowMenuButton"!==i.ref&&o.syncOverflowVisibility())}},{key:"createWidget",value:function(e){"->"===e?e={type:"widget",cls:"b-toolbar-fill"}:"|"===e?e={type:"widget",cls:"b-toolbar-separator"}:"string"==typeof e&&(e={type:"widget",cls:"b-toolbar-text",html:e});var t=tt()(Ze()(n.prototype),"createWidget",this).call(this,e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}}],[{key:"$name",get:function(){return"Toolbar"}},{key:"type",get:function(){return"toolbar"}},{key:"delayable",get:function(){return{syncOverflowVisibility:{type:"raf",cancelOutstanding:!0}}}},{key:"configurable",get:function(){return{defaultType:"button",dock:"top",layout:{type:"box"},overflow:{$config:["lazy","nullify"],value:"menu"},toolDefaults:{overflowMenuButton:{type:"button",icon:"b-icon-menu",hidden:!0},overflowScrollEnd:{handler:"up.onEndScrollClick",hidden:!0},overflowScrollStart:{align:"start",handler:"up.onStartScrollClick",hidden:!0}},widgetCls:null}}}]),n}(Rc.mixin(zc));function hf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}df.initClass(),df._$name="Toolbar";var vf=function(e){return!e.classList.contains("b-focus-trap")&&mi.isFocusable(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP},pf=function(e){return e.element},gf=[],yf=[gf,gf],mf=function(e,t){var n;return{children:e.children,class:(n={},Qe()(n,"b-".concat(e.vertical?"v":"h","box"),1),Qe()(n,"b-box-center",1),Qe()(n,"b-panel-bar-wrap",!t),n)}},bf=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{vertical:t,children:e?[e]:[]}},kf={dock:1,hidden:1,weight:1},wf={top:[!0,!0],bottom:[!0,!1],left:[!1,!0],right:[!1,!1]},Cf={header:1,"pre-header":1};vf.acceptNode=vf;var Rf=function(e){Ye()(n,e);var t=hf(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e=this,t=e.focusable,n=e.hasItems,r=e.composeBody(),i=e.composeHeader(),o=(null==i?void 0:i.class["b-dock-left"])||(null==i?void 0:i.class["b-dock-right"]);return{tabIndex:n&&!1!==t||t?0:null,class:Qe()({},"b-".concat(o?"h":"v","box"),1),children:{topFocusTrap:{tabIndex:0,class:{"b-focus-trap":1}},headerElement:i,bodyWrapElement:r,bottomFocusTrap:{tabIndex:0,class:{"b-focus-trap":1}}}}}},{key:"composeBody",value:function(){var e,t,n,r,i,o,a,s,l=this,u=l.bodyCls,c=l.bodyConfig,f=l.footer,d=Qn.values(l.strips,(function(e,t){return!wf[null==t?void 0:t.dock]})).sort(l.byWeightSortFn);f&&(n=f.dock||"bottom",d.unshift({dock:n,element:{tag:"footer",reference:"footerElement",html:"string"==typeof f?f:f.html,class:(s={},Qe()(s,"b-dock-".concat(n),1),Qe()(s,"".concat(f.cls||""),1),s)}}));for(u&&(c[i="className"]||(i="class"),c[i]=new xr(c[i]).assign(u)),r=d.length;r-- >0;){e=d[r];var h=N()(wf[e.dock],2);o=h[0],t=h[1],a?a.vertical!==o&&(a=bf(mf(a),o)):a=bf(c,o),a.children[t?"unshift":"push"](e.element)}var v=mf(a||bf(c),!0);return v.class["b-panel-body-wrap"]=1,v.class["b-".concat(l.$$name.toLowerCase(),"-body-wrap")]=1,v}},{key:"hasHeader",get:function(){var e=this.header,t=this.title,n=this.tools,r=this.parent,i=Object.values(n||{}).some((function(e){return!e.hidden}));return e||!(null!=r&&r.suppressChildHeaders)&&(t||i)}},{key:"composeHeader",value:function(e){var t=this;if(e||t.hasHeader){var r,i,o=t.splitHeaderItems(),a=t.header||{},s=o||yf,l=N()(s,2),u=l[0],c=l[1],f=t.$meta.hierarchy,d=t.composeTitle(a),h=a.dock||"top",v=new xr(Qe()({},"b-dock-".concat(h),1),a.cls);for(r=f.indexOf(n);r<f.length;++r)"Grid"!==(i=f[r].$$name)&&(v["b-".concat(i.toLowerCase(),"-header")]=1);for(r=0;r<u.length;++r){var p,g;null===(p=(g=u[r]).syncRotationToDock)||void 0===p||p.call(g,h)}for(r=0;r<c.length;++r){var y,m;null===(y=(m=c[r]).syncRotationToDock)||void 0===y||y.call(m,h)}return{tag:"header",class:v,children:[].concat(F()(u.map(pf)),[d],F()(c.map(pf)))}}}},{key:"composeTitle",value:function(e){var t,n="string"==typeof e?e:this.title||e.title,r={reference:"titleElement",html:n,class:(t={},Qe()(t,"b-align-".concat(e.titleAlign||"start"),1),Qe()(t,"b-header-title",1),t)};return Qn.isObject(n)&&(delete r.html,Qn.merge(r,n)),r}},{key:"splitHeaderItems",value:function(){var e=this,t=e.endTools,n=e.startTools,r=Qn.values(e.strips,(function(e,t){return!Cf[null==t?void 0:t.dock]}));if(r.length+t.length+n.length)return[[].concat(F()(n),F()(r.filter((function(e){return"pre-header"===e.dock})).sort(e.byWeightSortFn))),[].concat(F()(r.filter((function(e){return"header"===e.dock})).sort(e.byWeightReverseSortFn)),F()(t))]}},{key:"bodyConfig",get:function(){var e=this,t=e.hasNoChildren,r=e.textContent,i=Qn.merge({reference:"bodyElement",className:e.classHierarchy(n).reduce((function(t,n){var r=n.$$name,i=Reflect.getOwnPropertyDescriptor(n.prototype,"widgetClass"),o=r;return null!=i&&i.get&&(o=i.get.call(e)),o&&(t["b-".concat(r.toLowerCase(),"-content")]=o),t}),{})},e._bodyConfig);return!e.initializingElement&&e._element||(i.html=e.content||e._html),i.className["b-box-center"]=1,i.className["b-text-content"]=r&&t,i},set:function(e){this._bodyConfig=e}},{key:"changeBodyCls",value:function(e){return xr.from(e)}},{key:"changeTbar",value:function(e){return this.getConfig("strips"),this.strips={tbar:e},this.strips.tbar}},{key:"changeBbar",value:function(e){return this.getConfig("strips"),this.strips={bbar:e},this.strips.bbar}},{key:"childItems",get:function(){var e=this,t=Qn.values(e.strips,(function(e,t){return!wf[null==t?void 0:t.dock]})).sort(e.byWeightSortFn),n=e.splitHeaderItems()||yf,r=N()(n,2),i=r[0],o=r[1];return[].concat(F()(i),F()(o),F()(t.filter((function(e){return wf[e.dock][1]}))),F()(e._items||gf),F()(t.filter((function(e){return!wf[e.dock][1]})).reverse()))}},{key:"changeStrips",value:function(e,t){var n=this,r=n.$strips||(n.$strips=new Dc({configName:"strips",factory:uc,inferType:!1,owner:n,created:function(e){var t,i=e.dock;if(!Cf[i]&&!wf[i])throw new Error('Invalid dock value "'.concat(i,'"; must be: top, left, right, bottom, header, or pre-header'));at.after(e,"onConfigChange",(function(e,t){var i=t.name;kf[i]&&n.onConfigChange({name:"strips",value:r.target})})),e.innerItem=!1,n.onChildAdd(e),e.parent=n,null===(t=e.layout)||void 0===t||t.renderChildren(),e.hasItems&&(n.hasItems=!0)},setup:function(e,t){return(e=Qn.merge(Qn.clone(n.stripDefaults["*"]),n.stripDefaults[t],e)).parent=n,e.ref=t,e},transform:function(e){return Array.isArray(e)&&(e={items:e}),e||null}}));if(r.update(e),!t)return r.target}},{key:"updateTrapFocus",value:function(e){var t,n=this;n.element.classList[e?"add":"remove"]("b-focus-trapped"),n.focusTrapListener=null===(t=n.focusTrapListener)||void 0===t?void 0:t.call(n),e&&(n.focusTrapListener=Tu.on({element:n.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:n}),n.treeWalker||(n.treeWalker=this.setupTreeWalker(n.element,NodeFilter.SHOW_ELEMENT,vf,!1)))}},{key:"updateMaxHeight",value:function(e){tt()(Ze()(n.prototype),"updateMaxHeight",this).call(this,e),pe.a.isIE11&&(this.bodyWrapElement.style.flex="1 1 ".concat(e,"px"))}},{key:"fixIEMaxHeightBug",value:function(){var e=this.element,t=this.contentElement,n=this.bodyWrapElement;if("column"===mi.getStyleValue(e,"flex-direction")){t.style.maxHeight="";for(var r=Cr.client(e).height,i=e.childNodes,o=i.length,a=0;a<o;a++){var s=i[a];s===t||s===n||s.classList.contains("b-resize-monitors")||(r-=s.offsetHeight)}this.contentElement.style.maxHeight="".concat(r,"px")}}},{key:"setupTreeWalker",value:function(e,t,n,r){return document.createTreeWalker(e,t,n,r)}},{key:"onFocusTrapped",value:function(e){var t=this,n=t.treeWalker;e.target===t.bottomFocusTrap?(n.currentNode=t.topFocusTrap,n.nextNode()):(n.currentNode=t.bottomFocusTrap,n.previousNode()),t.requestAnimationFrame((function(){return n.currentNode.focus()}))}},{key:"focusElement",get:function(){return this.hasItems&&(tt()(Ze()(n.prototype),"focusElement",this)||this.element)}},{key:"contentElement",get:function(){return this.element&&this.bodyElement}},{key:"widgetClassList",get:function(){var e,t=this,r=tt()(Ze()(n.prototype),"widgetClassList",this);t.hasHeader&&r.push("b-panel-has-header","b-header-dock-".concat((null===(e=t.header)||void 0===e?void 0:e.dock)||"top"));return t.tbar&&r.push("b-panel-has-top-toolbar"),t.bbar&&r.push("b-panel-has-bottom-toolbar"),r}}],[{key:"$name",get:function(){return"Panel"}},{key:"type",get:function(){return"panel"}},{key:"configurable",get:function(){return{localizableProperties:["title"],bodyCls:{$config:{merge:"classList"},value:null},trapFocus:null,title:null,header:null,stripDefaults:{"*":{type:"toolbar",dock:"top"},bbar:{dock:"bottom",weight:-1e3},tbar:{weight:-1e3}},strips:{value:null,$config:{nullify:!0}},footer:null,tbar:null,bbar:null}}}]),n}(Rc.mixin(zc));function Sf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Rf.initClass(),Rf._$name="Panel";var xf=function(e){Ye()(n,e);var t=Sf(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"finalizeInit",value:function(){var e=this;e.anchoredTo=e.forElement,e.initialAnchor=e.anchor,e.forElement&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),Tu.on({element:e.forElement,click:"onElementUserAction",thisObj:e})),tt()(Ze()(n.prototype),"finalizeInit",this).call(this),e.autoShow&&(!0===e.autoShow?e.show():e.setTimeout((function(){return e.show()}),e.autoShow))}},{key:"onPaint",value:function(e){var t;e.firstPaint;null===(t=tt()(Ze()(n.prototype),"onPaint",this))||void 0===t||t.apply(this,arguments);var r=this;r.maximizable&&r.headerElement&&Tu.on({element:r.headerElement,dblclick:r.onHeaderDblClick,thisObj:r})}},{key:"doDestroy",value:function(){this.syncModalMask(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"compose",value:function(){var e=this.hasNoChildren,t=this.textContent;return{class:{"b-text-popup":Boolean(t&&e)}}}},{key:"close",value:function(){var e=this;if(!e._hidden&&!1!==e.trigger("beforeClose")||e._hidden&&"destroy"===e.closeAction)return e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout((function(){return e.element.classList.add("b-using-keyboard")}),0),e[e.closeAction]()}},{key:"toggleMaximized",value:function(){this.maximized=!this.maximized}},{key:"updateMaximized",value:function(e){mi.toggleClasses(this.element,["b-maximized"],e)}},{key:"onInternalKeyDown",value:function(e){"Escape"===e.key&&(e.stopImmediatePropagation(),this.close(!0))}},{key:"onDocumentMouseDown",value:function(e){var t=e.event,r=this;r.modal&&t.target===n.modalMask?(t.preventDefault(),r.modal.closeOnMaskTap?r.close():r.containsFocus||r.focus()):r.owns(t.target)||!r.autoClose||r.containsFocus||r.close()}},{key:"isTopModal",get:function(){return mi.isVisible(n.modalMask)&&this.element.previousElementSibling===n.modalMask}},{key:"onFocusIn",value:function(e){var t=mi.getActiveElement(this);tt()(Ze()(n.prototype),"onFocusIn",this).call(this,e),mi.getActiveElement(this)===t&&e.target===this.element&&this.focus()}},{key:"onFocusOut",value:function(e){window.visualViewport&&window.visualViewport.height<document.documentElement.clientHeight||this.modal||!this.autoClose||this.close(),tt()(Ze()(n.prototype),"onFocusOut",this).call(this,e)}},{key:"onShow",value:function(){var e=this;e.autoClose&&e.addDocumentMouseDownListener(),e.focusOnToFront&&e.focus(),tt()(Ze()(n.prototype),"onShow",this)&&tt()(Ze()(n.prototype),"onShow",this).call(this),e.syncModalMask()}},{key:"addDocumentMouseDownListener",value:function(){this.mouseDownRemover||(this.mouseDownRemover=Fi.on({globaltap:"onDocumentMouseDown",thisObj:this}))}},{key:"syncModalMask",value:function(){var e=this;if(e.modal&&e.isVisible)"number"!=typeof e._x&&"number"!=typeof e._y&&(e.centered=!0),e.modalMask.classList.remove("b-hide-display"),e.element.classList.add("b-modal");else if(e.isPainted){e.element.classList.remove("b-modal");var t=e.floatRoot.querySelectorAll(".b-modal"),r=t.length?n.fromElement(t[t.length-1],"popup"):null;r?r.syncModalMask():n.modalMask.classList.add("b-hide-display")}}},{key:"onHide",value:function(){var e=this;e.mouseDownRemover&&(e.mouseDownRemover(),e.mouseDownRemover=null),tt()(Ze()(n.prototype),"onHide",this)&&tt()(Ze()(n.prototype),"onHide",this).call(this),e.syncModalMask()}},{key:"onElementUserAction",value:function(){this.show()}},{key:"onHeaderDblClick",value:function(){this.maximizable&&this.toggleMaximized()}},{key:"updateClosable",value:function(e){this.tools.close.hidden=!e}},{key:"updateMaximizable",value:function(e){this.tools.maximize.hidden=!e}},{key:"modalMask",get:function(){var e=n.modalMask;return e.nextElementSibling!==this.element&&this.floatRoot.insertBefore(e,this.element),e}}],[{key:"$name",get:function(){return"Popup"}},{key:"type",get:function(){return"popup"}},{key:"configurable",get:function(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:pe.a.isIE11?null:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:pe.a.isIE11?null:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},stripDefaults:{bbar:{layout:{justify:"flex-end"}}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,maximizable:null,modal:null,maximized:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,hidden:!0},maximize:{cls:"b-popup-expand",handler:"toggleMaximized",weight:-999,hidden:!0}},highlightReturnedFocus:!0}}},{key:"modalMask",get:function(){return this._modalMask||(this._modalMask=mi.createElement({className:"b-modal-mask b-hide-display"}),Tu.on({element:this._modalMask,wheel:function(e){return e.preventDefault()}})),this._modalMask}}]),n}(Rf);function Ef(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Df(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ef(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ef(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}xf.initClass(),xf._$name="Popup";var Of=/^b-icon-/,Mf=/^b-fa-/,Af=function(e){Ye()(n,e);var t=Tf(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e=this.checked,t=this.href,n=this.hasMenu,r=this.name,i=this.target,o=this.text,a=this.icon||("boolean"==typeof e?"b-fw-icon":"");return{tag:t?"a":"div",tabIndex:-1,href:t,target:i,class:{"b-has-submenu":n},dataset:{name:r,group:this.toggleGroup},children:{iconElement:a&&{tag:"i",class:Df({"b-fa":Mf.test(a),"b-icon":Of.test(a),"b-icon-checked":!0===e,"b-icon-unchecked":!1===e,"b-menuitem-icon":1},xr.normalize(a,"object"))},textElement:{tag:"span",html:o,class:{"b-menu-text":1}},subMenuIcon:n&&{tag:"i",class:{"b-fw-icon":1,"b-icon-sub-menu":1}}}}}},{key:"doAction",value:function(e){var t=this,n=this.parent,r={menu:n,item:t,element:t.element,bubbles:!0};if("boolean"==typeof t.checked){var i=!t.checked;t.toggleGroup&&!i||(t.checked=!t.checked)}t.trigger("beforeItem",r),t.trigger("item",r),t.closeParent&&n&&(n.rootMenu.close(),e&&!t.href&&e.preventDefault())}},{key:"focusElement",get:function(){return this.element}},{key:"contentElement",get:function(){return this.textElement}},{key:"isFocusable",get:function(){var e=this.focusElement;return e&&this.isVisible&&(e===document.body||e.offsetParent)}},{key:"hasMenu",get:function(){return this.hasConfig("menu")}},{key:"childItems",get:function(){var e=this.menu;return e?[e]:[]}},{key:"text",get:function(){return this.html},set:function(e){this.html=e}},{key:"onFocusIn",value:function(e){tt()(Ze()(n.prototype),"onFocusIn",this).call(this,e),!this.disabled&&this.menu&&this.openMenu()}},{key:"onFocusOut",value:function(e){tt()(Ze()(n.prototype),"onFocusOut",this).call(this,e),this.closeMenu()}},{key:"openMenu",value:function(e){var t=this.menu;!this.disabled&&t&&(t.focusOnToFront=e,t.show(),this.owner.currentSubMenu=t)}},{key:"closeMenu",value:function(){this._menu instanceof uc&&this.menu.close()}},{key:"changeToggleGroup",value:function(e){return e&&"boolean"!=typeof this.checked&&(this.checked=!1),e}},{key:"changeChecked",value:function(e,t){if(this.isConfiguring||"boolean"==typeof t)return Boolean(e)}},{key:"updateChecked",value:function(e){var t=this;t.isConfiguring||(t.toggleGroup&&t.uncheckToggleGroupMembers(),t.trigger("toggle",{menu:t.owner,item:t,element:t.element,bubbles:!0,checked:e}))}},{key:"getToggleGroupMembers",value:function(){var e=this,t=e.checked,n=e.toggleGroup,r=e.element,i=[];return t&&n&&mi.forEachSelector(e.rootElement,"[data-group=".concat(n,"]"),(function(e){if(e!==r){var t=uc.fromElement(e);t&&i.push(t)}})),i}},{key:"uncheckToggleGroupMembers",value:function(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((function(e){return e.checked=!1}))}},{key:"closeParent",get:function(){return("boolean"==typeof this.checked?this._closeParent:!1!==this._closeParent)&&!this.hasMenu}},{key:"changeMenu",value:function(e,t){var n=this,r=n.owner,i=r.constrainTo,o=r.scrollAction;return!e||"object"!==I()(e)||"items"in e||"widgets"in e||"html"in e||(e={lazyItems:e}),Ff.reconfigure(t,e,{owner:n,defaults:{type:"menu",align:"l0-r0",anchor:!0,autoClose:!0,autoShow:!1,cls:"b-sub-menu",forElement:n.element,owner:n,constrainTo:i,scrollAction:o}})}}],[{key:"$name",get:function(){return"MenuItem"}},{key:"type",get:function(){return"menuitem"}},{key:"configurable",get:function(){return{checked:null,toggleGroup:null,menu:{value:null,$config:["lazy","nullify"]},icon:null,name:null,closeParent:null,href:null,target:null,localizableProperties:["text"]}}}]),n}(uc);function If(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Af.initClass(),Af._$name="MenuItem";var Pf={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1},Ff=function(e){Ye()(n,e);var t=If(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){Array.isArray(e)&&(e={lazyItems:e}),tt()(Ze()(n.prototype),"construct",this).call(this,e),Tu.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseleave:"onMouseLeave",thisObj:this})}},{key:"afterShow",value:function(e){var t=this;t.items.some((function(e){return Boolean(e._menu)}))&&t.element.classList.add("b-menu-with-submenu"),t.items.some((function(e){return e.icon}))&&t.element.classList.add("b-menu-with-icon"),tt()(Ze()(n.prototype),"afterShow",this).call(this,e)}},{key:"createWidget",value:function(e){return"string"==typeof e&&(e={text:e}),tt()(Ze()(n.prototype),"createWidget",this).call(this,e)}},{key:"focusElement",get:function(){var e,t=this,r=null===(e=t.parentMenu)||void 0===e?void 0:e.element.contains(mi.getActiveElement(t.parentMenu)),i=t.items[0];return!r&&i instanceof Af?t.element:tt()(Ze()(n.prototype),"focusElement",this)}},{key:"onDocumentMouseDown",value:function(e){this.parentMenu&&this.parentMenu.owns(e.event.target)||tt()(Ze()(n.prototype),"onDocumentMouseDown",this).call(this,e)}},{key:"hide",value:function(e){var t=this;tt()(Ze()(n.prototype),"hide",this).call(this,e),t.currentSubMenu&&!t.currentSubMenu.isDestroyed&&t.currentSubMenu.hide(e),t.parentMenu&&(t.parentMenu.currentSubMenu=null)}},{key:"onMouseClick",value:function(e){var t=e.target.closest(".b-menuitem");t&&(this.triggerElement(t,e),e.stopImmediatePropagation())}},{key:"onMouseOver",value:function(e){if(!1!==this.focusOnHover){var t=mi.up(e.relatedTarget,".b-widget"),n=mi.up(e.target,".b-widget"),r=uc.fromElement(n);!mi.isTouchEvent&&n&&n!==t&&r.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[r],cancelOutstanding:!0})}}},{key:"handleMouseOver",value:function(e){e.focus()}},{key:"onMouseLeave",value:function(e){var t=this,n=e.relatedTarget,r=n&&t.owns(n),i=n&&n instanceof HTMLElement&&uc.fromElement(n),o=!r;if(i){for(;i.ownerCmp;)i=i.ownerCmp;o&=!mi.getAncestor(i.element,[e.target])}!r&&o&&(t.currentSubMenu&&t.currentSubMenu.hide(),t.currentSubMenu=t.selectedElement=null,t.element.contains(mi.getActiveElement(t))&&mi.getActiveElement(t).matches(".b-menuitem")&&t.focusElement.focus())}},{key:"onInternalKeyDown",value:function(e){var t=uc.fromElement(e),r=t&&t!==this&&!(t instanceof Af);if("Escape"!==e.key){if(tt()(Ze()(n.prototype),"onInternalKeyDown",this).call(this,e),!r){Pf[e.key]&&e.preventDefault();var i=this.element,o=mi.getActiveElement(i);this.navigateFrom(o!==i&&i.contains(o)?o:null,e.key,e)}}else(r?this:this.rootMenu).close()}},{key:"navigateFrom",value:function(e,t,n){var r,i=this,o=i.treeWalker,a=e&&i.getItem(e);switch(t){case"ArrowUp":o.currentNode=e||(e=i.bottomFocusTrap),o.previousNode(),r=o.currentNode;break;case"ArrowDown":o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(a&&a.menu?i.openSubMenu(e,a):i.triggerElement(e,n));break;case"ArrowRight":if(e&&a&&a.menu&&!e.classList.contains("b-disabled")){var s=i.openSubMenu(e,a);s&&s.focus()}else o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode;break;case"ArrowLeft":i.isSubMenu?i.hide():e||(o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&i.triggerElement(e,n)}r&&(r===i.element?i.navigateFrom(i.bottomFocusTrap,"ArrowUp",n):r===e?i.navigateFrom(i.topFocusTrap,"ArrowDown",n):r.focus())}},{key:"getItem",value:function(e){if(null!=e)return"number"==typeof e?this.items[e]:e.nodeType===Element.ELEMENT_NODE?uc.fromElement(e,"menuitem",this.contentElement):this.items.find((function(t){return t.id==e}))}},{key:"triggerElement",value:function(e,t){var n=this.getItem(e);n&&!n.disabled&&n.doAction(t)}},{key:"isSubMenu",get:function(){var e;return this===(null===(e=this.owner)||void 0===e?void 0:e.menu)}},{key:"openSubMenu",value:function(e,t){var n=t.menu;if(n){if(!n.isVisible){var r={item:t,element:e};if(!1===this.trigger("beforeSubMenu",r))return;if(t.onBeforeSubMenu&&!1===t.onBeforeSubMenu(r))return;n.show()}return this.currentSubMenu=n}}},{key:"selectedElement",get:function(){return this._selectedElement},set:function(e){var t=this,n=t._selectedElement;if(n){var r=t.getItem(n),i=r&&r.menu;i&&i.hide(),n.classList.remove("b-active")}if(t._selectedElement=e,e){var o=mi.isFocusable(e);e.classList.add("b-active"),t.scrollable.scrollIntoView(e,{animate:!o,focus:o})}}},{key:"selectFirst",value:function(){var e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame((function(){return e.currentNode.focus()}))}},{key:"parentMenu",get:function(){var e=this.owner;if(e instanceof Af&&(e=e.owner),e instanceof n)return e}},{key:"rootMenu",get:function(){for(var e=this;e.parentMenu&&e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}],[{key:"$name",get:function(){return"Menu"}},{key:"type",get:function(){return"menu"}},{key:"configurable",get:function(){return{focusable:!0,align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1}}}}]),n}(xf);function Lf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ff.initClass(),Ff._$name="Menu";var Bf=function(e){Ye()(n,e);var t=Lf(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){for(var e,t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=i[1===i.length?0:1];if(a&&"menuConfig"in a&&(z.a.deprecate("Grid","5.0.0","`menuConfig` attribute deprecated, in favour of `menu`"),a.menu=a.menuConfig),(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this].concat(i)),null===(t=this.type)||void 0===t||!t.length)throw new Error("Config 'type' is required to be specified for context menu")}},{key:"onElementContextMenu",value:function(e){this.onElementEvent(e)}},{key:"onElementClick",value:function(e){this.onElementEvent(e)}},{key:"onElementDblClick",value:function(e){this.onElementEvent(e)}},{key:"onElementEvent",value:function(e){this.triggerEvent===e.type&&this.internalShowContextMenu(e)}},{key:"onElementKeyDown",value:function(e){}},{key:"internalShowContextMenu",value:function(e){var t=this;if(!t.disabled){var n=t.getDataFromEvent(e);t.shouldShowMenu(n)&&t.showContextMenu(n)}}},{key:"getDataFromEvent",value:function(e){return{event:e,targetElement:this.getTargetElementFromEvent(e)}}},{key:"getTargetElementFromEvent",value:function(e){return e.target}},{key:"showContextMenu",value:function(e,t){var n,r=this,i=mi.isDOMEvent(e)?r.getDataFromEvent(e):e;if(null===(n=r._menu)||void 0===n||n.hide(),!r.disabled){r.menuContext=i;var o,a=r.type,s=r.client,l=r.processItems,u=i.event,c=null!=u?u:Cr.from(i.targetElement).center;if(he.assign(i,{point:u?[u.clientX+1,u.clientY+1]:[c.x,c.y],items:{},selection:r.client.selectedRecords}),r.callChainablePopulateMenuMethod(i),he.merge(i.items,r.baseItems),(!l||!1!==l(i))&&r.hasActiveMenuItems(i))if(r.populateItemsWithData(i),r.preventDefaultEvent(i),!1!==r.beforeContextMenuShow(i))if(!1!==s.trigger("".concat(a,"MenuBeforeShow"),i)&&!1!==s.trigger("".concat(a,"ContextMenuBeforeShow"),i))r.menu.items=i.items,t?r.menu.showBy(t):r.menu.showByPoint(i.point),null===(o=r.touchMoveDetacher)||void 0===o||o.call(r),r.touchMoveDetacher=Tu.on({element:s.element,touchmove:function(){return r.menu.hide()},once:!0})}}},{key:"baseItems",get:function(){if(!this._baseItems){var e=this,t=e.namedItems,n=e._baseItems=he.assign({},e.items);for(var r in n){var i=n[r];i&&(t&&r in t?n[r]="object"===I()(i)?he.merge(he.clone(t[r]),i):t[r]:!0===i&&delete n[r])}}return this._baseItems}},{key:"hideContextMenu",value:function(e){var t;null===(t=this.menu)||void 0===t||t.hide(e)}},{key:"callChainablePopulateMenuMethod",value:function(e){var t,n;null===(t=(n=this.client)["populate".concat(te.capitalize(this.type),"Menu")])||void 0===t||t.call(n,e)}},{key:"createContextMenuEventForElement",value:function(e){var t=Cr.from(e).center,n=new MouseEvent(this.triggerEvent,{clientX:t.x,clientY:t.y});return Object.defineProperty(n,"target",{get:function(){return e}}),n}},{key:"hasActiveMenuItems",value:function(e){return Object.values(e.items).some((function(e){return e}))}},{key:"shouldShowMenu",value:function(){return!0}},{key:"beforeContextMenuShow",value:function(e){}},{key:"populateItemsWithData",value:function(e){}},{key:"preventDefaultEvent",value:function(e){var t;null===(t=e.event)||void 0===t||t.preventDefault()}},{key:"changeTriggerEvent",value:function(e){return e||this.client.contextMenuTriggerEvent}},{key:"changeMenu",value:function(e,t){var n=this,r=n.client,i=n.type;if(e)return Ff.reconfigure(t,e?Ff.mergeConfigs({owner:r,rootElement:r.rootElement,onItem:function(e){r.trigger("".concat(i,"MenuItem"),e),r.trigger("contextMenuItem",e),r.trigger("".concat(i,"ContextMenuItem"),e)},onToggle:function(e){r.trigger("".concat(i,"MenuToggleItem"),e),r.trigger("contextMenuToggleItem",e)},onDestroy:function(){n.menu=null},onBeforeItem:function(e){Object.assign(e,n.menuContext)},onShow:function(e){var t=e.source;n.menuContext.menu=t,r.trigger("".concat(i,"MenuShow"),n.menuContext),r.trigger("".concat(i,"ContextMenuShow"),n.menuContext)}},e):null,n);null!=t&&t.isWidget&&t.destroy()}}],[{key:"$name",get:function(){return"ContextMenuBase"}},{key:"configurable",get:function(){return{type:null,menu:{$config:["lazy","nullify"],value:{type:"menu",autoShow:!1,closeAction:"hide",scrollAction:"hide",constrainTo:window}},menuConfig:null,items:{},triggerEvent:!1}}},{key:"pluginConfig",get:function(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onElementKeyDown"]}}}]),n}(_i);Bf._$name="ContextMenuBase";var jf=function(){function e(){B()(this,e)}return _()(e,null,[{key:"insertRule",value:function(e){var t=this.getStyleSheet(document.head),n=t.cssRules.length;if(t.insertRule(e,0),t.cssRules.length>n)return t.cssRules[0]}},{key:"findRule",value:function(e){var t,n="function"==typeof e;return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),(function(r){if(t=Array.prototype.find.call(r.sheet.rules||r.sheet.cssRules,(function(t){return n?e(t):t.selectorText===e})))return!0})),t}},{key:"getStyleSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.head;return e.$bryntumStylesheet||(e.$bryntumStylesheet=mi.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:e}).sheet),e.$bryntumStylesheet}}]),e}();function _f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}jf._$name="CSSHelper";function Hf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Nf={pageXOffset:0,pageYOffset:0};function zf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Vf="onMouseDown",Wf="onMouseMove",$f="onMouseUp",Uf="onDocumentClick",Gf="onTouchStart",Yf="onTouchMove",qf="onTouchEnd",Kf="onKeyDown",Xf=function(e){Ye()(n,e);var t=zf(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;tt()(Ze()(n.prototype),"construct",this).call(this,e),t.initListeners(),"container"===t.mode?t.initContainerDrag():t.mode.startsWith("translate")&&t.initTranslateDrag(),t.initialMode=t.mode}},{key:"doDestroy",value:function(){this.abort(!0),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"initListeners",value:function(){var e={element:this.outerElement,mousedown:Vf,thisObj:this};pe.a.isTouchDevice&&(e.touchstart=Gf),Tu.on(e)}},{key:"onPointerDown",value:function(e){var t=this;if(mi.isVisible(e.target))if(t.context)t.context.awaitingFinalization||(t.onMouseUp(e),t.reset());else if((!t.isElementDraggable||t.isElementDraggable(e.target,e))&&(t.startEvent=e,"container"===t.mode?t.grabContainerDrag(e):!!t.mode.startsWith("translate")&&t.grabTranslateDrag(e))){var n={element:document,thisObj:t,keydown:Kf};if("touches"in e?(n.touchmove={handler:Yf,passive:!1},n.touchend=n.pointerup=qf):(n.mousemove=Wf,n.mouseup=$f),t.removeListeners=Tu.on(n),t.dragWithin&&t.dragWithin!==t.outerElement&&t.outerElement.contains(t.dragWithin)){var r=Cr.from(t.dragWithin,t.outerElement);t.minY=r.top,t.maxY=r.bottom,t.minX=r.left,t.maxX=r.right}}}},{key:"onTouchStart",value:function(e){var t=this;1===e.touches.length&&(t.touchStartTimer=t.setTimeout((function(){t.touchStartTimer=null}),t.touchStartDelay,"touchStartDelay"),t.onPointerDown(e))}},{key:"onMouseDown",value:function(e){0===e.button&&this.onPointerDown(e)}},{key:"internalMove",value:function(e){var t=this,n=t.context,r=Tu.getDistanceBetween(t.startEvent,e);if(t.touchStartTimer&&r>t.dragThreshold)t.abort(!0);else if(!t.touchStartTimer&&n&&n.element&&e.target&&e.target.nodeType===Node.ELEMENT_NODE&&(n.started||r>=t.dragThreshold)){if(!n.started){if(!1===t.trigger("beforeDragStart",{context:n,event:e}))return t.abort();var i;"container"!==t.mode&&(t.lockY?t.mode="translateX":t.lockX?t.mode="translateY":t.mode=t.initialMode),n.action.startsWith("translate")?t.startTranslateDrag(e):"container"===n.action&&t.startContainerDrag(e),n.started=!0,null===(i=t.scrollManager)||void 0===i||i.startMonitoring(Qn.merge({scrollables:[{element:t.dragWithin||t.outerElement}],callback:function(e){null!=n&&n.element&&t.lastMouseMoveEvent&&(t.lastMouseMoveEvent.isScroll=!0,t.update(t.lastMouseMoveEvent,e))}},t.monitoringConfig)),n.outermostEl=e.target.closest(".b-outer")||document.body,n.outermostEl.classList.add("b-draghelper-active"),t.trigger("dragStart",{context:n,event:e})}"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation()),t.update(e)}}},{key:"onTouchMove",value:function(e){this.internalMove(e)}},{key:"onMouseMove",value:function(e){this.internalMove(e)}},{key:"update",value:function(e,t){var n=this,r=n.context,i=r.dragProxy||r.element,o=document.scrollingElement||document.body,a=e.isScroll?mi.elementFromPoint(e.clientX,e.clientY):e.target;if("touchmove"===e.type){var s=e.changedTouches[0];a=mi.elementFromPoint(s.clientX+o.scrollLeft,s.clientY+o.scrollTop)}r.target=a,n.dropTargetSelector?r.valid=Boolean(a.closest(n.dropTargetSelector)):r.valid=!0,r.action&&("container"===r.action&&n.updateContainerProxy(e,t),r.action.startsWith("translate")&&n.updateTranslateProxy(e,t)),n.trigger("drag",{context:r,event:e}),"container"===r.action&&n.updateContainerDrag(e,t),i.classList[r.valid?"remove":"add"](n.invalidCls),e&&(n.lastMouseMoveEvent=e)}},{key:"abort",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this,i=r.context;null===(e=r.scrollManager)||void 0===e||null===(t=e.stopMonitoring)||void 0===t||t.call(e),i&&(i.element.getBoundingClientRect(),i.valid=!1,"container"===i.action?r.abortContainerDrag(void 0,void 0,n):r.abortTranslateDrag(void 0,void 0,n)),r.reset()}},{key:"removeListeners",value:function(){}},{key:"reset",value:function(e){var t=this,n=t.context;null!=n&&n.started&&n.outermostEl.classList.remove("b-draghelper-active"),t.removeListeners(),e||t.trigger("reset"),t.context=t.lastMouseMoveEvent=null}},{key:"onTouchEnd",value:function(e){this.onMouseUp(e)}},{key:"onDocumentClick",value:function(e){e.stopPropagation()}},{key:"onMouseUp",value:function(e){var t,n=this,r=n.context;(n.removeListeners(),r)&&(null===(t=n.scrollManager)||void 0===t||t.stopMonitoring(),"container"===r.action?n.finishContainerDrag(e):r.started&&r.action.startsWith("translate")&&n.finishTranslateDrag(e),r.started?Tu.on({element:document,thisObj:n,click:Uf,capture:!0,expires:n.clickSwallowDuration,once:!0}):n.reset(!0))}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.abort()}},{key:"createProxy",value:function(e){var t=e.cloneNode(!0);return t.removeAttribute("id"),t}}],[{key:"defaultConfig",get:function(){return{dragProxyCls:"b-drag-proxy",invalidCls:"b-drag-invalid",draggingCls:"b-dragging",dropPlaceholderCls:"b-drop-placeholder",dragThreshold:5,outerElement:document.body,dragWithin:null,monitoringConfig:null,constrain:!0,minX:null,maxX:null,minY:null,maxY:null,mode:null,isElementDraggable:null,targetSelector:null,dropTargetSelector:null,cloneTarget:!1,hideOriginalElement:!1,containers:null,ignoreSelector:null,startEvent:null,lockX:!1,lockY:!1,touchStartDelay:300,scrollManager:null,snapCoordinates:null,transitionDuration:300,clickSwallowDuration:50,ignoreSamePositionDrop:!0,floatRootOwner:null,testConfig:{transitionDuration:10,clickSwallowDuration:pe.a.isEdge?300:50}}}}]),n}($e.mixin(Ot,(function(e){return function(e){Ye()(n,e);var t=_f(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"initContainerDrag",value:function(){var e=this;if(e.mode||(e.mode="container"),"container"===e.mode&&!e.containers)throw new Error("Container drag mode must specify containers")}},{key:"grabContainerDrag",value:function(e){var t=this;if(!t.ignoreSelector||!mi.up(e.target,t.ignoreSelector)){var n=mi.getAncestor(e.target,t.containers,t.outerElement);if(n){var r=n.getBoundingClientRect();t.context={element:n,valid:!0,action:"container",offsetX:e.pageX-r.left,offsetY:e.pageY-r.top,originalPosition:{parent:n.parentElement,prev:n.previousElementSibling,next:n.nextElementSibling}}}return!0}return!1}},{key:"startContainerDrag",value:function(e){var t=this.context,n=this.floatRootOwner,r=t.element,i=r.cloneNode(!0),o=r.getBoundingClientRect();i.classList.add(this.dragProxyCls),i.classList.add(this.draggingCls),((null==n?void 0:n.floatRoot)||mi.getRootElement(r)).appendChild(i),t.dragProxy=i,i.style.width=o.width+"px",i.style.height=o.height+"px",mi.setTranslateXY(t.dragProxy,o.left,o.top),t.dragging=r,r.classList.add(this.dropPlaceholderCls)}},{key:"updateContainerDrag",value:function(e){var t=this,n=t.context;if(n.started&&n.targetElement){var r=mi.getAncestor(n.targetElement,t.containers,"b-grid"),i=n.dragging&&n.dragging.contains(mi.getActiveElement(n.dragging));r&&mi.isDescendant(n.element,r)||(i&&Fi.suspendFocusEvents(),r&&n.valid?t.moveNextTo(r,e):t.revertPosition(),i&&Fi.resumeFocusEvents(),e.preventDefault())}}},{key:"finishContainerDrag",value:function(e){var t=this,n=this,r=n.context,i=r.dragging,o=r.dragProxy,a=r.valid,s=r.draggedTo,l=r.insertBefore,u=r.originalPosition;i&&(r.valid=a&&s&&(i!==l||u.parent!==s),r.finalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.valid;!e&&t.context&&n.revertPosition(),i.classList.remove(n.dropPlaceholderCls),o.remove(),n.reset()},r.async=!1,n.trigger("drop",{context:r,event:e}),r.async?r.awaitingFinalization=!0:r.finalize())}},{key:"abortContainerDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.context;i.dragging&&(i.dragging.classList.remove(r.dropPlaceholderCls),i.dragProxy.remove(),r.context={}),n||r.trigger(e?"drop":"abort",{context:i,event:t})}},{key:"updateContainerProxy",value:function(e){var t,n=this,r=n.context,i=r.dragProxy,o=e.pageX-r.offsetX,a=e.pageY-r.offsetY;if("number"==typeof n.minX&&(o=Math.max(n.minX,o)),"number"==typeof n.maxX&&(o=Math.min(n.maxX-i.offsetWidth,o)),"number"==typeof n.minY&&(a=Math.max(n.minY,a)),"number"==typeof n.maxY&&(a=Math.min(n.maxY-i.offsetHeight,a)),n.lockX?mi.setTranslateY(i,a):n.lockY?mi.setTranslateX(i,o):mi.setTranslateXY(i,o,a),"touchmove"===e.type){var s=e.changedTouches[0];t=mi.elementFromPoint(s.clientX,s.clientY)}else t=e.target;r.targetElement=t}},{key:"moveNextTo",value:function(e,t){var n=this.context,r=n.dragging,i=e.parentElement;if(e!==r){var o=e.getBoundingClientRect().left+e.offsetWidth/2;t.pageX<o?(i.insertBefore(r,e),n.insertBefore=e):e.nextElementSibling?e.nextElementSibling!==r?(n.insertBefore=e.nextElementSibling,i.insertBefore(r,e.nextElementSibling)):n.insertBefore||r.parentElement.lastElementChild===r||(n.insertBefore=e.nextElementSibling):(i.appendChild(r),n.insertBefore=null),n.draggedTo=i}}},{key:"revertPosition",value:function(){var e=this.context,t=e.originalPosition;t.next?t.next&&t.next.previousSibling===e.dragging||!t.next&&e.dragging===t.parent.lastChild||t.parent.insertBefore(e.dragging,t.next):t.parent.appendChild(e.dragging);e.draggedTo=null}}],[{key:"$name",get:function(){return"DragHelperContainer"}}]),n}(e||$e)}),(function(e){return function(e){Ye()(n,e);var t=Hf(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"initTranslateDrag",value:function(){var e=this;e.mode=e.mode||"translateXY",!e.isElementDraggable&&e.targetSelector&&(e.isElementDraggable=function(t){return mi.up(t,e.targetSelector)})}},{key:"grabTranslateDrag",value:function(e){var t=this,n=t.getTarget(e);return!!n&&(t.context={valid:!0,action:t.mode,element:n,startPageX:e.pageX,startPageY:e.pageY,startClientX:e.clientX,startClientY:e.clientY},!0)}},{key:"getTarget",value:function(e){return mi.up(e.target,this.targetSelector)}},{key:"startTranslateDrag",value:function(e){var t=this,n=t.context,r=n.relatedElements,i=n.dragProxy||n.element;if(i&&!n.started){var o=i,a=i.parentElement,s=t.dragWithin=t.dragWithin||t.cloneTarget&&document.body,l=t.outerElement;if(t.cloneTarget){var u=mi.getOffsetX(i,s),c=mi.getOffsetY(i,s),f=i.offsetWidth,d=i.offsetHeight;i=t.createProxy(i),mi.setTranslateXY(i,u,c),i.style.width="".concat(f,"px"),i.style.height="".concat(d,"px"),i.classList.add(t.dragProxyCls),s.appendChild(i),o.classList.add("b-drag-original"),t.hideOriginalElement&&o.classList.add("b-hidden")}Object.assign(t.context,{element:i,grabbed:o,grabbedParent:a,grabbedNextSibling:i.nextElementSibling,elementStartX:mi.getTranslateX(i),elementStartY:mi.getTranslateY(i),elementX:mi.getOffsetX(i,s||l),elementY:mi.getOffsetY(i,s||l),scrollX:0,scrollY:0,scrollManagerElementContainsDragProxy:!t.cloneTarget||s===l}),i.classList.add(t.draggingCls),s&&(n.parentElement=i.parentElement,s!==i.parentElement&&s.appendChild(i),t.updateTranslateProxy(e)),r&&r.forEach((function(e){e.classList.add(t.draggingCls)}))}}},{key:"applyConstraints",value:function(e,t,n){var r=this,i=r.dragWithin,o=i===document.body?window:Nf,a=o.pageXOffset,s=o.pageYOffset;return i&&r.constrain&&(t<0&&(t=0),t+e.offsetWidth>i.scrollWidth&&(t=i.scrollWidth-e.offsetWidth),n<0&&(n=0),n+e.offsetHeight>i.scrollHeight&&(n=i.scrollHeight-e.offsetHeight)),"number"==typeof r.minX&&(t=Math.max(r.minX+a,t)),"number"==typeof r.maxX&&(t=Math.min(r.maxX+a,t)),"number"==typeof r.minY&&(n=Math.max(r.minY+s,n)),"number"==typeof r.maxY&&(n=Math.min(r.maxY+s,n)),{constrainedX:t,constrainedY:n}}},{key:"updateTranslateProxy",value:function(e,t){var n=this,r=n.mode,i=n.lockX,o=n.lockY,a=n.context,s=a.dragProxy||a.element,l=a.relatedElements,u=a.relatedElDragFromPos;a.scrollManagerElementContainsDragProxy&&t&&(a.scrollX=t.getRelativeLeftScroll(s),a.scrollY=t.getRelativeTopScroll(s)),a.pageX=e.pageX,a.pageY=e.pageY,a.clientX=e.clientX,a.clientY=e.clientY;var c=a.elementStartX+e.pageX-a.startPageX+a.scrollX,f=a.elementStartY+e.pageY-a.startPageY+a.scrollY;if(n.snapCoordinates){var d=n.snapCoordinates({element:s,newX:c,newY:f});c=d.x,f=d.y}var h=n.applyConstraints(s,c,f),v=h.constrainedX,p=h.constrainedY;if("translateXY"!==r||i||o?"translateX"===r||o?mi.setTranslateX(s,v):("translateY"===r||i)&&mi.setTranslateY(s,p):mi.setTranslateXY(s,v,p),l){var g=i||"translateY"===r?0:v-a.elementStartX,y=o||"translateX"===r?0:p-a.elementStartY;l.forEach((function(e,t){var n=N()(u[t],2),r=n[0],i=n[1];mi.setTranslateXY(e,r+g,i+y)}))}a.newX=v,a.newY=p}},{key:"finishTranslateDrag",value:function(e){var t=this,n=t.context,r=n.newX!==n.elementStartX,i=n.newY!==n.elementStartY,o=n.dragProxy||n.element,a=n.relatedElements;function s(){o.classList.remove(t.invalidCls),o.classList.remove(t.draggingCls),a&&a.forEach((function(e){e.classList.remove(t.invalidCls),e.classList.remove(t.draggingCls)})),o.classList.contains("b-aborting")||(t.hideOriginalElement&&n.grabbed.classList.remove("b-hidden"),n.grabbed.classList.remove("b-drag-original"))}if(!t.ignoreSamePositionDrop||"translateY"!==t.mode&&r||"translateX"!==t.mode&&i){if(!1===n.valid)t.abortTranslateDrag(!0,e);else{var l=Cr.from(t.dragWithin||t.outerElement);!t.minX&&e.pageX<l.left||!t.maxX&&e.pageX>l.right||!t.minY&&e.pageY<l.top||!t.maxY&&e.pageY>l.bottom?(n.valid=!1,t.abortTranslateDrag(!0,e)):(n.finalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.valid;n.asyncCleanup&&s(),!e&&t.context?t.abortTranslateDrag(!0,null,!0):(t.cloneTarget||n.dragProxy)&&o.remove(),t.reset()},n.async=!1,t.trigger("drop",{context:n,event:e}),n.async?n.awaitingFinalization=!0:n.finalize())}n.asyncCleanup||s()}else t.abortTranslateDrag(!1,e)}},{key:"abortTranslateDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.context,o=i.relatedElements,a=i.relatedElStartPos,s=i.grabbed,l=i.dragProxy||i.element,u=r.cloneTarget&&r.hideOriginalElement?s:l,c=i.elementStartX,f=i.elementStartY;if(l&&i.started){if(!r.cloneTarget&&r.dragWithin&&r.dragWithin!==i.grabbedParent&&i.grabbedParent.insertBefore(l,i.grabbedNextSibling),s.classList.remove("b-hidden"),r.cloneTarget){if(r.hideOriginalElement){var d=mi.getTranslateXY(s),h=N()(d,2);c=h[0],f=h[1],mi.alignTo(s,l),u.getBoundingClientRect()}l.remove()}u.classList.add("b-aborting"),"translateXY"!==r.mode||r.lockX||r.lockY||(mi.setTranslateXY(u,c,f),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),mi.setTranslateXY(e,a[t][0],a[t][1])}))),("translateX"===r.mode||r.lockY)&&(mi.setTranslateX(u,c),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),mi.setTranslateX(e,a[t][0])}))),("translateY"===r.mode||r.lockX)&&(mi.setTranslateY(u,f),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),mi.setTranslateY(e,a[t][1])}))),r.setTimeout((function(){u.classList.remove("b-aborting"),s.classList.remove("b-dragging"),s.classList.remove("b-drag-original"),r.cloneTarget||(o&&o.forEach((function(e,t){e.classList.remove("b-aborting")})),l.classList.remove("b-aborting"),l.classList.remove(r.draggingCls),l.classList.remove(r.invalidCls))}),r.transitionDuration,void 0,!0),n||r.trigger(e?"drop":"abort",{context:i,event:t})}r.reset()}}],[{key:"$name",get:function(){return"DragHelperTranslate"}}]),n}(el(e||$e))})));function Zf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Xf._$name="DragHelper";var Jf="onMouseDown",Qf="onMouseMove",ed="onMouseUp",td="onDocumentClick",nd="onTouchStart",rd="onTouchMove",id="onTouchEnd",od="onKeyDown",ad=function(e){Ye()(n,e);var t=Zf(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;tt()(Ze()(n.prototype),"construct",this).call(this,e),t.handleSelector||pe.a.isHoverableDevice||(t.handleSize=t.touchHandleSize),t.handleVisibilityThreshold=t.handleVisibilityThreshold||2*t.handleSize,t.initListeners(),t.initResize()}},{key:"doDestroy",value:function(){this.abort(!0),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"initResize",value:function(){var e=this;if(!e.isElementResizable&&e.targetSelector&&(e.isElementResizable=function(t){return mi.up(t,e.targetSelector)}),e.grab){var t=e.grab,n=t.edge,r=t.element,i=t.event;e.startEvent=i;var o=e.getCursorOffsetToElementEdge(i,r,n);e.context={element:r,edge:n,valid:!0,async:!1,elementStartX:mi.getTranslateX(r)||r.offsetLeft,elementStartY:mi.getTranslateY(r)||r.offsetTop,newX:mi.getTranslateX(r)||r.offsetLeft,newY:mi.getTranslateY(r)||r.offsetTop,elementWidth:r.offsetWidth,elementHeight:r.offsetHeight,cursorOffset:o,startX:i.clientX+o.x+e.scrollLeft,startY:i.clientY+o.y+e.scrollTop,finalize:function(){var t;return null===(t=e.reset)||void 0===t?void 0:t.call(e)}},r.classList.add(e.resizingCls),e.internalStartResize(e.isTouch)}}},{key:"initListeners",value:function(){var e=this,t={element:e.outerElement,mousedown:Jf,touchstart:nd,thisObj:e};!e.handleSelector&&pe.a.isHoverableDevice&&(t.mousemove={handler:Qf,delegate:e.targetSelector},t.mouseleave={handler:"onMouseLeaveTarget",delegate:e.targetSelector,capture:!0}),e.removeListeners=Tu.on(t)}},{key:"removeListeners",value:function(){}},{key:"scrollLeft",get:function(){return this.scroller?this.scroller.x:this.outerElement.scrollLeft}},{key:"scrollTop",get:function(){return this.scroller?this.scroller.y:this.outerElement.scrollTop}},{key:"internalStartResize",value:function(e){var t={element:document,keydown:od,thisObj:this};e?(t.touchmove=rd,t.touchend=t.pointerup=id):(t.mousemove=Qf,t.mouseup=ed),this.removeDragListeners=Tu.on(t)}},{key:"removeDragListeners",value:function(){}},{key:"reset",value:function(){var e;null===(e=this.removeDragListeners)||void 0===e||e.call(this),this.context=null}},{key:"onPointerDown",value:function(e,t){var n=this;n.startEvent=t,n.isElementResizable&&!n.isElementResizable(t.target,t)||n.grabResizeHandle(e,t)&&(t.stopImmediatePropagation(),n.internalStartResize(e))}},{key:"onTouchStart",value:function(e){e.touches.length>1||this.onPointerDown(!0,e)}},{key:"onMouseDown",value:function(e){0===e.button&&this.onPointerDown(!1,e)}},{key:"internalMove",value:function(e,t){var n=this,r=n.context,i=n.direction;if(null!=r&&r.element&&(r.started||Tu.getDistanceBetween(n.startEvent,t)>=n.dragThreshold)){var o;if(!r.started)null===(o=n.scrollManager)||void 0===o||o.startMonitoring(Qn.merge({scrollables:[{element:n.dragWithin||n.outerElement,direction:i}],callback:function(e){var t;return(null===(t=n.context)||void 0===t?void 0:t.element)&&n.lastMouseMoveEvent&&n.update(n.lastMouseMoveEvent,e)}},n.monitoringConfig)),n.trigger("resizeStart",{context:r,event:t}),r.started=!0;n.update(t)}else e||n.handleSelector||n.checkResizeHandles(t)}},{key:"onTouchMove",value:function(e){this.internalMove(!0,e)}},{key:"onMouseMove",value:function(e){this.internalMove(!1,e)}},{key:"onPointerUp",value:function(e,t){var n,r,i,o=this,a=o.context;(null===(n=o.removeDragListeners)||void 0===n||n.call(o),a)?(null===(r=o.scrollManager)||void 0===r||r.stopMonitoring(),a.started&&Tu.on({element:document,thisObj:o,click:td,expires:o.clickSwallowDuration,capture:!0,once:!0}),o.finishResize(t)):null===(i=o.reset)||void 0===i||i.call(o)}},{key:"onTouchEnd",value:function(e){this.onPointerUp(!0,e)}},{key:"onMouseUp",value:function(e){this.onPointerUp(!1,e)}},{key:"onDocumentClick",value:function(e){e.stopPropagation()}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.abort()}},{key:"update",value:function(e){var t=this,n=t.context,r=Cr.from(t.outerElement);n.currentX=Math.max(Math.min(e.clientX+n.cursorOffset.x,r.right),r.x)+t.scrollLeft,n.currentY=Math.max(Math.min(e.clientY+n.cursorOffset.y,r.bottom),r.y)+t.scrollTop,t.updateResize(e),t.trigger("resizing",{context:n,event:e}),n.element.classList[!1===n.valid?"add":"remove"](t.invalidCls),e&&(t.lastMouseMoveEvent=e)}},{key:"abort",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this;null===(e=r.scrollManager)||void 0===e||null===(t=e.stopMonitoring)||void 0===t||t.call(e),r.context?r.abortResize(null,n):r.isDestroyed||r.reset()}},{key:"grabResizeHandle",value:function(e,t){var n=this;if(n.allowResize&&!n.allowResize(t.target,t))return!1;var r=n.handleSelector,i="touchstart"===t.type?t.changedTouches[0]:t,o=i.clientX,a=i.clientY,s=n.targetSelector?mi.up(t.target,n.targetSelector):t.target;if(s){var l;if(r){if(!t.target.matches(r))return!1;l="horizontal"===n.direction?t.pageX<mi.getPageX(s)+s.offsetWidth/2?"left":"right":t.pageY<mi.getPageY(s)+s.offsetHeight/2?"top":"bottom"}else if("horizontal"===n.direction?n.overLeftHandle(t,s)?l="left":n.overRightHandle(t,s)&&(l="right"):n.overTopHandle(t,s)?l="top":n.overBottomHandle(t,s)&&(l="bottom"),!l)return n.context=null,!1;"touchstart"===t.type&&t.preventDefault();var u=n.getCursorOffsetToElementEdge(i,s,l);if(!1!==n.trigger("beforeResizeStart",{element:s,event:t}))return n.context={element:s,edge:l,isTouch:e,valid:!0,async:!1,direction:n.direction,elementStartX:mi.getTranslateX(s)||s.offsetLeft,elementStartY:mi.getTranslateY(s)||s.offsetTop,newX:mi.getTranslateX(s)||s.offsetLeft,newY:mi.getTranslateY(s)||s.offsetTop,elementWidth:s.offsetWidth,elementHeight:s.offsetHeight,cursorOffset:u,startX:o+u.x+n.scrollLeft,startY:a+u.y+n.scrollTop,finalize:function(){var e;return null===(e=n.reset)||void 0===e?void 0:e.call(n)}},s.classList.add(n.resizingCls),!0}return!1}},{key:"getCursorOffsetToElementEdge",value:function(e,t,n){var r=Cr.from(t),i=0,o=0;switch(n){case"left":i=r.x-e.clientX;break;case"right":i=r.x+r.width-e.clientX;break;case"top":o=r.y-e.clientY;break;case"bottom":o=r.y+r.height-e.clientY}return{x:i,y:o}}},{key:"checkResizeHandles",value:function(e){var t=this,n=t.targetSelector?mi.up(e.target,t.targetSelector):e.target;if(!n||t.allowResize&&!t.allowResize(e.target,e))t.currentElement&&t.unHighlightHandle();else if(t.currentElement=t.handleContainerSelector?mi.up(e.target,t.handleContainerSelector):e.target,t.currentElement){("horizontal"===t.direction?t.overLeftHandle(e,n)||t.overRightHandle(e,n):t.overTopHandle(e,n)||t.overBottomHandle(e,n))?t.highlightHandle():t.unHighlightHandle()}}},{key:"onMouseLeaveTarget",value:function(e){var t=this;t.currentElement=t.handleContainerSelector?mi.up(e.target,t.handleContainerSelector):e.target,t.currentElement&&t.unHighlightHandle()}},{key:"updateResize",value:function(e){var t=this,n=t.context;t.allowEdgeSwitch&&("horizontal"===t.direction?n.edge=n.currentX>n.startX?"right":"left":n.edge=n.currentY>n.startY?"bottom":"top");var r=n.currentX-n.startX,i=n.currentY-n.startY,o=mi.getExtremalSizePX(n.element,"minWidth")||t.minWidth,a=mi.getExtremalSizePX(n.element,"maxWidth")||t.maxWidth,s=mi.getExtremalSizePX(n.element,"minHeight")||t.minHeight,l=mi.getExtremalSizePX(n.element,"maxHeight")||t.maxHeight,u="right"===n.edge||"bottom"===n.edge?1:-1,c=n.elementWidth+r*u,f=n.elementHeight+i*u,d=Math.max(o,c),h=Math.max(s,f);a>0&&(d=Math.min(d,a)),l>0&&(h=Math.min(h,l)),n.element.style.flex&&(n.element.style.flex=""),"horizontal"===t.direction?(n.element.style.width=Math.abs(d)+"px",n.newWidth=d,"left"===n.edge||d<0?(n.newX=Math.max(Math.min(n.elementStartX+n.elementWidth-t.minWidth,n.elementStartX+r),0),t.skipTranslate||mi.setTranslateX(n.element,n.newX)):"right"===n.edge&&t.allowEdgeSwitch&&!t.skipTranslate&&mi.setTranslateX(n.element,n.elementStartX)):(n.element.style.height=Math.abs(h)+"px",n.newHeight=h,"top"===n.edge||h<0?(n.newY=Math.max(Math.min(n.elementStartY+n.elementHeight-t.minHeight,n.elementStartY+i),0),t.skipTranslate||mi.setTranslateY(n.element,n.newY)):"bottom"===n.edge&&t.allowEdgeSwitch&&!t.skipTranslate&&mi.setTranslateY(n.element,n.elementStartY))}},{key:"finishResize",value:function(e){var t=this,n=t.context,r={context:n,event:e};if(n.element.classList.remove(t.resizingCls),n.started){var i=!1;i="horizontal"===t.direction?n.newWidth&&n.newWidth!==n.elementWidth:n.newHeight&&n.newHeight!==n.elementHeight,t.trigger(i?"resize":"cancel",r),n.async||n.finalize()}else{var o;null===(o=t.reset)||void 0===o||o.call(t)}}},{key:"abortResize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.context;r.element.classList.remove(n.resizingCls),"horizontal"===n.direction?(mi.setTranslateX(r.element,r.elementStartX),r.element.style.width=r.elementWidth+"px"):(mi.setTranslateY(r.element,r.elementStartY),r.element.style.height=r.elementHeight+"px"),!t&&n.trigger("cancel",{context:r,event:e}),n.isDestroyed||n.reset()}},{key:"highlightHandle",value:function(){var e=this,t=e.targetSelector?mi.up(e.currentElement,e.targetSelector):e.currentElement;e.currentElement.classList.add("b-resize-handle"),t.classList.add("b-over-resize-handle")}},{key:"unHighlightHandle",value:function(){var e=this,t=e.targetSelector?mi.up(e.currentElement,e.targetSelector):e.currentElement;t&&t.classList.remove("b-over-resize-handle"),e.currentElement.classList.remove("b-resize-handle"),e.currentElement=null}},{key:"overAnyHandle",value:function(e,t){return this.overStartHandle(e,t)||this.overEndHandle(e,t)}},{key:"overStartHandle",value:function(e,t){return"horizontal"===this.direction?this.overLeftHandle(e,t):this.overTopHandle(e,t)}},{key:"overEndHandle",value:function(e,t){return"horizontal"===this.direction?this.overRightHandle(e,t):this.overBottomHandle(e,t)}},{key:"getDynamicHandleSize",value:function(e,t){var n=e?2:1,r=this.handleSize;return this.dynamicHandleSize&&r*n>t-this.reservedSpace?Math.max(Math.floor((t-this.reservedSpace)/n),0):r}},{key:"overLeftHandle",value:function(e,t){var n=this,r=t.offsetWidth;if(n.leftHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=Cr.from(t);return i.width=n.getDynamicHandleSize(n.rightHandle,r),i.width>0&&i.contains(Tu.getPagePoint(e))}return!1}},{key:"overRightHandle",value:function(e,t){var n=this,r=t.offsetWidth;if(n.rightHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=Cr.from(t);return i.x=i.right-n.getDynamicHandleSize(n.leftHandle,r),i.width>0&&i.contains(Tu.getPagePoint(e))}return!1}},{key:"overTopHandle",value:function(e,t){var n=this,r=t.offsetHeight;if(n.topHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=Cr.from(t);return i.height=n.getDynamicHandleSize(n.bottomHandle,r),i.height>0&&i.contains(Tu.getPagePoint(e))}return!1}},{key:"overBottomHandle",value:function(e,t){var n=this,r=t.offsetHeight;if(n.bottomHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=Cr.from(t);return i.y=i.bottom-n.getDynamicHandleSize(n.bottomHandle,r),i.height>0&&i.contains(Tu.getPagePoint(e))}return!1}}],[{key:"defaultConfig",get:function(){return{resizingCls:"b-resizing",dragThreshold:5,handleSize:10,dynamicHandleSize:null,reservedSpace:10,touchHandleSize:30,minWidth:1,maxWidth:0,minHeight:1,maxHeight:0,outerElement:document.body,scroller:null,allowResize:null,dragWithin:null,isElementResizable:null,targetSelector:null,leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSelector:null,handleContainerSelector:null,startEvent:null,grab:null,invalidCls:"b-resize-invalid",handleVisibilityThreshold:null,skipTranslate:!1,direction:"horizontal",clickSwallowDuration:50}}}]),n}(Ot($e));ad._$name="ResizeHelper";var sd=/>[ \t\r\n]+</g,ld=/\s\s+/g,ud=function(){function e(){B()(this,e)}return _()(e,null,[{key:"tpl",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o=n.map((function(t,n){var r=e[n];return Array.isArray(t)?r+=t.reduce((function(e,t){return e+(("string"==typeof t?t.trim():t)+"\n")}),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),i++,r})).join("");return i<=e.length&&(o+=e[e.length-1]),o.replace(sd,"><").replace(ld," ").trim()}},{key:"docsTpl",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o=n.map((function(t,n){var r=e[n];return Array.isArray(t)?r+=t.reduce((function(e,t){return e+(("string"==typeof t?t.trim():t)+"\n")}),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),i++,r})).join("");return i<=e.length&&(o+=e[e.length-1]),o.replace(sd,"><").trim()}},{key:"repeat",value:function(t){return function(){return e.tpl.apply(e,arguments).repeat(t)}}},{key:"loop",value:function(e){}}]),e}();function cd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ud._$name="TemplateHelper";var hd=function(e){Ye()(n,e);var t=dd(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e=this.appendTo,t=this.color,n=this.html,r=this.showProgress,i=this.style,o=this.timeout;return{parent:e||this.floatRoot,class:fd(fd({},xr.normalize(t,"object")),{},{"b-toast-hide":1}),html:n,style:i,children:{progressElement:r&&{style:"animation-duration:".concat(o/1e3,"s;"),class:{"b-toast-progress":1}}},listeners:{click:"hide"}}}},{key:"doDestroy",value:function(){this.untoast(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"nextBottom",get:function(){var e=this.bottomMargin,t=this.element;return parseInt(t.style.bottom,10)+t.offsetHeight+e}},{key:"show",value:function(){tt()(Ze()(n.prototype),"show",this).call(this);var e,t,r=this,i=r.element,o=n.toasts;o.includes(r)||(i.style.bottom=(null!==(e=null===(t=o[0])||void 0===t?void 0:t.nextBottom)&&void 0!==e?e:r.bottomMargin)+"px",o.unshift(r),i.getBoundingClientRect(),i.classList.remove("b-toast-hide"),r.timeout>0&&(r.hideTimeout=r.setTimeout("hide",r.timeout)))}},{key:"hide",value:function(){var e=this;e.untoast(),e.element.classList.add("b-toast-hide"),e.autoDestroy&&!e.destroyTimer&&(e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}},{key:"untoast",value:function(){var e=n.toasts;e.includes(this)&&e.splice(e.indexOf(this),1)}}],[{key:"$name",get:function(){return"Toast"}},{key:"type",get:function(){return"toast"}},{key:"configurable",get:function(){return{testConfig:{destroyTimeout:1,timeout:100},floating:!0,timeout:2500,autoDestroy:null,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}},{key:"hideAll",value:function(){n.toasts.slice().reverse().forEach((function(e){return e.hide()}))}},{key:"show",value:function(e){var t=n.new({autoDestroy:!0,rootElement:document.body},"string"==typeof e?{html:e}:e);return t.show(),t}}]),n}(uc);hd.toasts=[],hd.initClass(),hd._$name="Toast";var vd=function(){function e(){B()(this,e)}return _()(e,null,[{key:"getById",value:function(e){return uc.getById(e)}},{key:"fromElement",value:function(e,t,n){return uc.fromElement(e,t,n)}},{key:"createWidget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.isWidget?e:uc.create(e)}},{key:"append",value:function(e,t){if(e=Array.isArray(e)&&e||[e],(t instanceof HTMLElement||"string"==typeof t)&&(t={appendTo:t}),t.insertFirst){var n="string"==typeof t.insertFirst?document.getElementById(t.insertFirst):t.insertFirst;n.firstChild?t.insertBefore=n.firstChild:t.appendTo=n}return e.map((function(e){return uc.create(Qn.assign({},t||{},e))}))}},{key:"openPopup",value:function(e,t){return uc.create(Qn.assign({forElement:e},"string"==typeof t?{html:t}:t),"popup")}},{key:"showContextMenu",value:function(e,t){var n=this;return n.currentContextMenu&&n.currentContextMenu.destroy(),e instanceof HTMLElement?t.forElement=e:Array.isArray(e)?t.forElement={target:jt()(wu,F()(e))}:e instanceof wu&&(t.forElement={target:e}),n.currentContextMenu=uc.create(t,"menu"),n.currentContextMenu.on("destroy",(function(){n.currentContextMenu=null})),n.currentContextMenu}},{key:"attachTooltip",value:function(e,t){return uc.attachTooltip(e,t)}},{key:"hasTooltipAttached",value:function(e){return uc.resolveType("tooltip").hasTooltipAttached(e)}},{key:"destroyTooltipAttached",value:function(e){return uc.resolveType("tooltip").destroyTooltipAttached(e)}},{key:"mask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Loading";if(e)return e instanceof HTMLElement&&(e={target:e,text:t}),qu.mask(e,e.target)}},{key:"unmask",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.mask&&(t?e.mask.close():e.mask.hide())}},{key:"toast",value:function(e){return hd.show(e)}}]),e}();function pd(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return gd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gd(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function gd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}vd._$name="WidgetHelper";var yd=function(){function e(){B()(this,e)}return _()(e,null,[{key:"convertFromObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};he.assignIf(t,{rootName:"root",elementName:"element",includeHeader:!0,rootElementForArray:!0});var n=t.rootName,r=t.elementName,i=t.includeHeader,o=t.rootElementForArray,a=t.xmlns;a=a?' xmlns="'.concat(a,'"'):"";var s=i?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>':"",l=function e(t){var n=[];for(var i in t){var a=t[i];if(Array.isArray(a)){o&&n.push("<".concat(i,">"));var s,l=pd(a);try{for(l.s();!(s=l.n()).done;){var u=s.value;r.length?n.push("<".concat(r,">")):n.push("<".concat(i,">")),n.push(e(u)),r.length?n.push("</".concat(r,">")):n.push("</".concat(i,">"))}}catch(e){l.e(e)}finally{l.f()}o&&n.push("</".concat(i,">"))}else he.isObject(a)?n.push("<".concat(i,">").concat(e(a),"</").concat(i,">")):null==a?n.push("<".concat(i,"/>")):n.push("<".concat(i,">").concat(te.encodeHtml(a),"</").concat(i,">"))}return n.join("")};return"".concat(s,"<").concat(n).concat(a,">").concat(l(e),"</").concat(n,">")}}]),e}();yd._$name="XMLHelper";var md=function(){function e(){B()(this,e),this.random100=[46,2,36,46,54,59,18,20,71,55,88,98,13,61,61,40,2,15,3,32,51,45,64,25,81,85,54,13,57,49,64,22,81,94,0,62,17,7,11,2,33,99,85,26,83,83,96,26,20,89,91,38,26,13,11,79,32,30,5,51,70,7,5,56,58,77,37,89,40,80,78,59,26,36,8,51,60,23,86,5,11,96,64,94,87,64,4,78,17,85,35,0,90,86,23,55,53,9,35,59,29,2,64,42,8,49,43,73,6,53,38,9,39,31,32,40,49,13,78,68,20,99,24,78,35,91,73,46,67,76,89,69,30,69,25,3,4,55,1,65,66,76,83,19,67,1,95,24,54,45,56,40,67,92,72,4,69,8,47,50,27,2,38,9,14,83,12,14,62,95,22,47,35,18,38,14,86,64,68,61,52,69,39,93,20,73,32,52,74,6,56,68,99,29,24,92,40,67,6,72,31,41,91,53,80,55,33,97,97,99,18,20,5,27,82,84,61,78,27,67,7,42,75,95,91,25,63,21,70,36,46,0,1,45,84,6,86,15,10,62,96,94,10,23,93,83,94,47,5,29,29,52,51,37,77,96,43,72,43,14,54,14,72,52,4,39,15,26,68,28,25,76,60,50,22,40,72,74,68,58,8,48,40,62,52,24,9,26,47,44,49,96,7,77,90,45,76,47,5,86,1,36,18,42,19,90,34,23,70,32,69,79,0,99,57,80,72,21,19,72,85,68,4,40,86,62,0,63,4,11,69,31,78,31,21,78,29,84,13,53,57,10,26,50,24,30,90,42,51,96,93,21,99,23,81,0,89,43,86,63,93,19,54,71,92,36,4,95,37,99,60,29,23,50,68,95,57,95,77,53,99,78,75,12,92,47,23,14,0,41,98,11,34,64,26,90,50,23,38,31,74,76,16,76,66,23,22,72,48,50,20,36,37,58,5,43,49,64,81,30,8,21,98,75,60,17,50,42,27,38,90,74,45,68,67,27,31,15,58,76,41,99,23,98,53,98,56,19,79,2,4,38,96,24,65,51,43,42,41,60,46,7,90,65,3,27,63,99,51,44,86,1,54,40,15,74,3,81,51,63,87,79,84,72,22,38,96,95,33,41,21,99,21,69,7,49,40,52,41,6,91,19,76,40,54,17,33,11,11,0,1,32,94,33,13,18,45,7,85,61,42,54,45,72,78,96,17,9,80,87,41,96,66,0,8,59,18,21,2,28,64,75,97,32,80,86,97,97,55,2,73,75,11,89,67,58,70,76,12,46,64,17,22,97,25,35,93,57,82,46,57,61,31,74,27,4,32,85,53,86,53,53,42,5,28,50,65,63,70,61,73,37,13,80,7,34,22,3,26,6,62,78,12,56,87,41,58,64,31,27,45,35,18,66,62,43,89,69,94,93,33,74,2,43,85,37,82,41,74,9,15,44,33,42,65,19,1,49,78,12,29,9,78,7,55,12,45,40,33,16,86,14,52,16,73,76,0,98,75,91,78,46,99,95,90,69,78,45,62,55,37,88,49,77,27,83,38,73,39,1,75,40,65,83,54,95,7,73,4,30,26,36,89,21,5,95,11,14,87,45,36,21,77,55,5,66,51,98,48,62,74,58,23,82,30,28,19,53,89,76,98,8,34,70,28,54,16,52,35,93,54,54,72,49,18,93,72,90,71,73,15,60,38,80,76,53,70,39,69,25,5,31,61,46,6,54,34,31,52,33,36,79,76,44,29,28,38,1,66,2,90,91,1,76,78,31,55,37,71,2,3,38,85,0,95,42,2,39,57,87,61,77,98,2,24,80,48,27,47,71,15,7,49,60,86,3,2,29,38,54,36,59,83,27,47,9,36,42,8,73,85,9,16,73,60,39,12,43,25,23,29,28,47,40,77,20,89,22,30,41,59,96,19,56,20,76,73,39,46,72,40,47,37,52,29,79,37,39,50,41,87,66,17,75,31,45,26,88,70,11,90,40,74,9,32,65,72,61,6,93,54,15,84,22,99,47,10,96,4,84,19,85,73,45,25,16,8,94,99,39,28,26,68,87,48,1,65,86,46,86,7,60,82,45,75,38,56,41,35,30,86,91,97,85,45,5,14,69,85,96,37,18,26,16,38,16,1,44,94,85,58,60,20,5,47,52,41,50,71,43,42,67,64,38,65,83,99,78,96,33,20,98,24,6,2,25,16,16,44,63,24,68,56,49,91,15,59,99,27,43,34,28,36,45,1,10,19,54,26,75,17,88,96,63,24,71,93,72,97,66,87,18,86],this.randomCache={},this.rndIndex=0}return _()(e,[{key:"nextRandom",value:function(e){var t,n=this.randomCache;return n[e]?t=n[e]:(t=this.random100.filter((function(t){return t<e})),n[e]=t),t[this.rndIndex++%t.length]}},{key:"reset",value:function(){this.rndIndex=0}},{key:"fromArray",value:function(e){return e[this.nextRandom(e.length)]}}]),e}();md._$name="RandomGenerator";var bd=function(){function e(){B()(this,e)}return _()(e,null,[{key:"reset",value:function(){this.rnd.reset(),this.rndTime.reset(),this.rndRating.reset()}},{key:"generate",value:At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,f,d,h,v,p,g,y,m,b,k,w,C=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=C.length>1&&void 0!==C[1]&&C[1],r=C.length>2&&void 0!==C[2]?C[2]:1,o=(i=this).rnd,a=i.rndTime,s=i.rndRating,l=i.firstNames,u=i.surNames,c=i.teams,f=i.foods,d=i.colors,h=i.cities,v=0;case 4:if(!(v<t)){e.next=12;break}return p=o.fromArray(l),g=o.fromArray(u),y="".concat(p," ").concat(String.fromCharCode(65+v%25)," ").concat(g),m=o.nextRandom(60)+1,b=new Date(2019,0,m),k=new Date(2019,0,m+o.nextRandom(30)+2),w={id:r>-1?v+r:void 0,title:"Row "+v,name:y,firstName:p,surName:g,city:o.fromArray(h),team:o.fromArray(h)+" "+o.fromArray(c),age:10+o.nextRandom(80),food:o.fromArray(f),color:o.fromArray(d),score:10*o.nextRandom(100),rank:o.nextRandom(100)+1,start:b,finish:k,time:Un.getTime(a.nextRandom(24),5*a.nextRandom(12)),percent:o.nextRandom(100),done:o.nextRandom(100)<50,rating:s.nextRandom(5),relatedTo:Math.min(t-1,v+r+o.nextRandom(10))},n&&(w.rowHeight=5*o.nextRandom(!0===n?20:n)+20),e.next=9,w;case 9:v++,e.next=4;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"generateData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&this.reset();for(var o=[],a=e.overrideRowCount?e.overrideRowCount:t,s=this.generate(a,n,r),l=0;l<a;l++)o.push(s.next().value);return o}},{key:"generateRow",value:function(){return e.generateData(1,!1,-1,!1)[0]}}]),e}();function kd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Object.assign(bd,{rnd:new md,rndTime:new md,rndRating:new md,cities:["Stockholm","Barcelona","Paris","Dubai","New York","San Francisco","Washington","Moscow"],firstNames:["Mike","Linda","Don","Karen","Doug","Jenny","Daniel","Melissa","John","Jane","Theo","Lisa","Adam","Mary","Barbara","James","David"],surNames:["McGregor","Ewans","Scott","Smith","Johnson","Adams","Williams","Brown","Jones","Miller","Davis","More","Wilson","Taylor","Anderson","Thomas","Jackson"],teams:["Lions","Eagles","Tigers","Horses","Dogs","Cats","Panthers","Rats","Ducks","Cougars","Hens","Roosters"],foods:["Pancake","Burger","Fish n chips","Carbonara","Taco","Salad","Bolognese","Mac n cheese","Waffles"],colors:["Blue","Green","Red","Yellow","Pink","Purple","Orange","Teal","Black"]}),bd._$name="DataGenerator";var wd=["action","target","to","deltaX","deltaY","x","y","text"],Cd=function(e){Ye()(n,e);var t=kd(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e);var t=this;t.widget&&(t.outerElement=t.widget.element,t.widget.playingDemo=!0),Tu.playingDemo=!0,Object.assign(t,{prevTarget:null,currentStep:0,mouse:mi.createElement({parent:t.outerElement,tag:"div",className:"simulated-mouse"}),timeoutId:null,innerIntervalId:null,mouseOutElements:[]}),t.intervalId=t.setInterval(t.nextStep.bind(t),1e3),t.outerElement.classList.add("b-playing-demo"),t.outerElement.addEventListener("click",(function(e){e.isTrusted&&t.abort()}))}},{key:"doDestroy",value:function(){this.abort()}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.mouse.style.top="-100px",t.clearInterval(t.intervalId),t.timeoutId&&t.clearTimeout(t.timeoutId),t.innerIntervalId&&t.clearInterval(t.innerIntervalId),t.outerElement.classList.remove("b-playing-demo"),t.widget&&(t.widget.playingDemo=!1),Tu.playingDemo=!1,t.trigger(e?"done":"abort")}},{key:"triggerEvent",value:function(e,t,n){if(!e)return null;var r;if(t.startsWith("mouse")){var i=this.mouse.getBoundingClientRect();r=new MouseEvent(t,Object.assign({view:window,bubbles:!0,cancelable:!0,clientX:i.left,clientY:i.top},n||{}))}else(r=document.createEvent("Event")).initEvent(t,!0,!1);return e.dispatchEvent(r),r}},{key:"handleMouseMove",value:function(e,t){var n=this,r=n.mouse;r.classList.add("quick"),n.mouseDown&&r.classList.add("drag");var i=Cr.from(r,n.outerElement),o=i.x,a=i.y,s=0,l=0;if(e.to)if("string"==typeof e.to){var u=n.outerElement.querySelector(e.to);if(u){var c=Cr.from(u,n.outerElement),f=c.x+c.width/2,d=c.y+c.height/2;s=(f-o)/10,l=(d-a)/10}}else e.to.x?s=(e.to.x-o)/10:(s=e.to[0]/10,l=e.to[1]/10);else e.deltaX?s=e.deltaX/10:e.x&&(s=(e.x-o)/10);e.deltaY&&(l=e.deltaY/10);var h=0;n.innerIntervalId=n.setInterval((function(){if(!n.shouldPause){9==h++&&(clearInterval(n.innerIntervalId),e.then&&e.then());var t=o+s*h,i=a+l*h;r.style.left=t+"px",r.style.top=i+"px";var u=r.getBoundingClientRect(),c=u.left,f=u.top,d=mi.elementFromPoint(c,f);d!==n.prevTarget&&(n.prevTarget&&(n.mouseOutElements.push(n.prevTarget),mi.isDescendant(n.mouseOutElements[0],d)||(n.mouseOutElements.forEach((function(e){return n.triggerEvent(e,"mouseout")})),n.mouseOutElements.length=0)),n.prevTarget=d,n.triggerEvent(d,"mouseover")),n.triggerEvent(d,e.action,{clientX:c,clientY:f})}}),50)}},{key:"getTarget",value:function(e){var t=e.target;return t?"function"==typeof t?t(e):document.querySelector(t):this.prevTarget||this.outerElement}},{key:"normalizeStep",value:function(e){if(e.action)return"function"==typeof e.action?e.action(e):e;if("function"==typeof e)return e(),e;for(var t in e)Object.hasOwnProperty.call(e,t)&&!wd.includes(t)&&(e.action=t.toLowerCase(),e.to=e[t]);return e.target||"string"!=typeof e.to&&"function"!=typeof e.to||(e.target=e.to),e}},{key:"isScrolling",get:function(){var e=this,t=e.outerElement.getBoundingClientRect(),n=e.lastTop&&t.top!==e.lastTop;return e.lastTop=t.top,n}},{key:"isInView",get:function(){var e=this.outerElement.getBoundingClientRect();return e.top<window.innerHeight&&e.bottom>0}},{key:"shouldPause",get:function(){return!this.isInView||this.isScrolling||document.hidden||!document.hasFocus()}},{key:"nextStep",value:function(){var e=this;if(!e.shouldPause){if(e.currentStep===e.steps.length){if(!e.repeat)return e.abort(!0);e.currentStep=0}0===e.currentStep&&e.trigger("initialize");var t=e.mouse,n=e.normalizeStep(e.steps[e.currentStep++]),r=e.getTarget(n),i=n.action;if(r&&i)if(t.className="simulated-mouse","mousemove"===i)e.handleMouseMove(n,r);else{if(r!==e.prevTarget){var o=Cr.from(r,e.outerElement);t.style.left=o.x+o.width/2+"px",t.style.top=o.y+o.height/2+"px"}"mousedown"===i&&(e.mouseDown=!0),"mouseup"===i&&(e.mouseDown=!1),e.timeoutId=e.setTimeout((function(){if(e.prevTarget=r,t.classList.add(i),"type"===i){var o=uc.fromElement(r),a=n.text.split("|");o.value=a[1===a.length||o.value!=a[0]?0:1]}else e.triggerEvent(r,i)}),"type"===i?100:550)}}}}],[{key:"defaultConfig",get:function(){return{repeat:!0,outerElement:document.body,callOnFunctions:!0}}}]),n}(Ot(el()));Cd._$name="DemoBot";var Rd=Object.prototype.hasOwnProperty,Sd=null;var xd=function(){function e(t){B()(this,e),this.formatter=t}return _()(e,[{key:"format",value:function(e){return this.formatter.defaultFormat(e)}},{key:"parse",value:function(e,t){return this.formatter.defaultParse(e,t)}},{key:"resolvedOptions",value:function(){return null}}]),e}(),Ed=function(){function e(t){B()(this,e);var n=this;if(n.cacheKey=Sd,Sd=null,n.initialize(),null===t)n.formatter=new xd(n);else{n.configure(t);for(var r=0,i=Object.entries(n.resolvedOptions());r<i.length;r++){var o=N()(i[r],2),a=o[0],s=o[1];null!=s&&a in n.defaults&&(n[a]=s)}}}return _()(e,[{key:"parser",get:function(){return e=this,t=new this.constructor.Parser(this),Object.defineProperty(e,"parser",{value:t}),t;var e,t}},{key:"defaultFormat",value:function(e){return null==e?e:String(e)}},{key:"defaultParse",value:function(e){return e}},{key:"format",value:function(e){return null==e?e:this.formatter.format(e)}},{key:"parse",value:function(e,t){return null==e?e:this.parser.parse(e,t)}},{key:"parseStrict",value:function(e){return this.parse(e,!0)}},{key:"resolvedOptions",value:function(){return this.formatter.resolvedOptions()}}],[{key:"get",value:function(e){if(null==e)return this.NULL;var t="string"==typeof e?e:JSON.stringify(e),n=this.cache,r=n.get(t);return r||(Sd=t,r=new this(e),n.set(t,r)),r}},{key:"cache",get:function(){return Rd.call(this,"_cache")&&this._cache||(this._cache=new Map)}},{key:"NULL",get:function(){return Rd.call(this,"_null")?this._null:this._null=new this(null)}}]),e}();function Dd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ed._$name="Formatter";var Td=te.escapeRegExp,Od=/[\d+-]/g,Md=function(e,t){return new Intl.NumberFormat(e||void 0,t)},Ad=/^(?:([$])\s*)?(?:(\d+)>)?\d+(,\d+)?(?:\.((\d*)(?:#*)|[*]))?(?:\s*([%])?)?$/,Id=function(){function e(t){B()(this,e);var n=this,r=t.locale,i=Md(r,{maximumFractionDigits:3}),o=t.is.currency?n._decodeStyle(r,{style:"currency",currency:t.currency,currencyDisplay:t.currencyDisplay}):null,a=t.is.percent?n._decodeStyle(r,{style:"percent"}):null,s=i.format(1.2).replace(Od,"")[0],l=i.format(1e9).replace(Od,"")[0]||"";Object.assign(n,{currency:o,decimal:s,formatter:t,grouper:l,percent:a}),n.decimal=s,n.decimalRe=Td(s,"g"),n.grouper=l,n.stripRe=new RegExp("(?:\\s+|".concat(Td(l),")")+(o?"|(?:".concat(Td(o.text),")"):"")+(a?"|(?:".concat(Td(a.text),")"):""),"g")}return _()(e,[{key:"decimalPlaces",value:function(e){var t=(e=e.replace(this.stripRe,"")).indexOf(this.decimal)+1;return t&&e.length-t}},{key:"parse",value:function(e,t){return"string"==typeof e&&(e=e.replace(this.stripRe,"").replace(this.decimalRe,"."),e=t?Number(e):parseFloat(e),this.formatter.is.percent&&(e/=100)),e}},{key:"_decodeStyle",value:function(e,t){var n=Md(e,t),r=Md(e,Object.assign(n.resolvedOptions(),{style:"decimal"})),i=n.format(0),o=r.format(0);return{suffix:i.startsWith(o),text:i.replace(o,"").trim()}}}]),e}(),Pd=function(e){Ye()(n,e);var t=Dd(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"initialize",value:function(){this._as={},this.is={decimal:!1,currency:!1,percent:!1,null:!0,from:null}}},{key:"truncator",get:function(){var e=this.maximumFractionDigits;return null==e?null:this.as({style:"decimal",maximumFractionDigits:Math.min(20,e+1)},"truncator")}},{key:"configure",value:function(e){var t=this;"string"!=typeof e?Object.assign(t,e):t.template=e;var n={},r=t.locale?Yt.locales[t.locale]:Yt.locale,i=r&&r.NumberFormat,o=t.template;if(i)for(var a in i)null==t[a]&&"function"!=typeof i[a]&&(t[a]=i[a]);if(o){var s=Ad.exec(o),l=s[2],u=s[4];t.useGrouping=!!s[3],t.style=s[1]?"currency":s[6]?"percent":"decimal",l&&(t.integer=+l),"*"===u?t.fraction=[0,20]:null!=u&&(t.fraction=[s[5].length,u.length])}for(var c in t._minMax("fraction",!0,!0),t._minMax("integer",!0,!1),t._minMax("significant",!1,!0),t.defaults)null!=t[c]&&(n[c]=t[c]);t.is.from=t.from&&t.from.is,t.is[t.style]=!(t.is.null=!1),t.formatter=Md(t.locale,n)}},{key:"as",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.resolvedOptions()||{template:"9.*"},i=this._as,o=t&&i[t];return o||("string"==typeof e?r.style=e:Object.assign(r,e),r.from=this,o=new n(r)),t&&(i[t]=o),o}},{key:"defaultParse",value:function(e,t){return null==e?e:t?Number(e):parseFloat(e)}},{key:"format",value:function(e){if("string"==typeof e){var t=Number(e);e=isNaN(t)?this.parse(e):t}return tt()(Ze()(n.prototype),"format",this).call(this,e)}},{key:"round",value:function(e){return this.parse(this.format(e))}},{key:"truncate",value:function(e){var t,n=this,r=n.maximumFractionDigits,i=n.truncator,o=n.parse(e);return i&&((t=(o=i.format(o)).indexOf(i.parser.decimal))>-1&&o.length-t-1>r&&(o=o.substr(0,t+r+1)),o=i.parse(o)),o}},{key:"resolvedOptions",value:function(){var e=tt()(Ze()(n.prototype),"resolvedOptions",this).call(this);for(var t in e)void 0===e[t]&&(e[t]=this[t]);return e}},{key:"_minMax",value:function(e,t,n){var r=this,i=r[e];if(null!=i){var o=te.capitalize(e),a="maximum".concat(o,"Digits"),s="minimum".concat(o,"Digits");"number"==typeof i?(t&&(r[s]=i),n&&(r[a]=i)):(r[s]=i[0],r[a]=i[1])}}}],[{key:"$name",get:function(){return"NumberFormat"}}]),n}(Ed);function Fd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Pd.Parser=Id,Object.assign(Pd.prototype,{defaults:{style:"decimal",currency:null,currencyDisplay:"symbol",locale:null,maximumFractionDigits:null,minimumFractionDigits:null,minimumIntegerDigits:null,maximumSignificantDigits:null,minimumSignificantDigits:null,useGrouping:!0},fraction:null,from:null,integer:null,significant:null,template:null}),Object.assign(Pd.prototype,Pd.prototype.defaults),Ed.number=function(e,t){return Pd.format(e,t)},Pd._$name="NumberFormat";var Ld=function(e){return function(e){Ye()(r,e);var t,n=Fd(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"construct",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=tt()(Ze()(r.prototype),"construct",this)).call.apply(e,[this].concat(n)),this.finalizer=null,this.finalizing=null,this.isFinalized=!1,this.isFinalizing=!1}},{key:"doFinalize",value:function(){this.destroy()}},{key:"finalize",value:function(){var e=this,t=e.finalizing;return t||e.isFinalized||(e.isFinalizing=!0,e.finalizing=t=e._awaitFinalizer()),t}},{key:"_awaitFinalizer",value:(t=Pt()(At.a.mark((function e(){var t;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.prev=1,e.next=4,t.finalizer;case 4:return e.prev=4,t.finalizing=null,t.isFinalized=!0,t.doFinalize(),e.finish(4);case 9:case"end":return e.stop()}}),e,this,[[1,,4,9]])}))),function(){return t.apply(this,arguments)})}],[{key:"$name",get:function(){return"Finalizable"}}]),r}(e||$e)};function Bd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var jd=Symbol("dragAbort"),_d=Symbol("dragInit"),Hd=Symbol("dragDrag"),Nd=Symbol("dragDrop"),zd={x:"horizontal",y:"vertical"},Vd=function(e){Ye()(r,e);var t,n=Bd(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"construct",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=tt()(Ze()(r.prototype),"construct",this)).call.apply(e,[this].concat(n));var o=this,a=o.event;Object.assign(o,{altKey:null,cleaners:[],ctrlKey:null,data:new Map,element:a.target,endEvent:null,lastMoveEvent:null,metaKey:null,scrollerAction:null,shiftKey:null,state:_d,startEvent:a,touchStartTimer:null,_valid:!0}),"touches"in a&&o.touchStartDelay&&(o.touchStartTimer=o.setTimeout((function(){return o.touchStartTimer=null}),o.touchStartDelay,"touchStartDelay"))}},{key:"doDestroy",value:function(){var e=this,t=e.source,n=e.target;e.cleanup(),(null==n?void 0:n.dropping)===e&&(n.dropping=null),(null==t?void 0:t.dragging)===e&&(t.dragging=null),tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"aborted",get:function(){return this.state===jd}},{key:"completed",get:function(){return this.aborted||null!==this.endEvent}},{key:"started",get:function(){return this.state!==_d&&!this.aborted}},{key:"valid",get:function(){return this.started&&null!=this.targetElement&&this._valid},set:function(e){this._valid=e}},{key:"get",value:(t=Pt()(At.a.mark((function e(t){var n,r=this;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.aborted){e.next=2;break}throw new Error("Data is not available on aborted drag");case 2:if(this.completed){e.next=4;break}throw new Error("Data is not available until drag completion");case 4:if(!Array.isArray(t)){e.next=6;break}return e.abrupt("return",Promise.all(t.map((function(e){return r.get(e)}))));case 6:if("function"!=typeof(n=this.data.get(t))){e.next=12;break}return e.next=10,n();case 10:n=e.sent,this.data.set(t,n);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"has",value:function(e){return this.data.has(e)}},{key:"peek",value:function(e){var t=this;if(this.aborted)throw new Error("Data is not available on aborted drag");if(Array.isArray(e))return e.map((function(e){return t.peek(e)}));var n=this.data.get(e);return"function"==typeof n&&(n=!0),n}},{key:"set",value:function(e,t){this.data.set(e,t)}},{key:"changeTarget",value:function(e,t){if(e!==t){var n=this;n._target=e,t&&(t.dropping=null),e&&(e.dropping=n,e.dropping!==n&&(e=null,n.valid=!1)),n._target=t}return e}},{key:"updateTarget",value:function(e,t){var n=this;t&&n.source.dragLeaveTarget(n,t),e&&(n.valid=!0,e.dragMove(n),n.source.dragEnterTarget(n))}},{key:"updateTargetElement",value:function(e){var t,n,r,i,o;for(o=e;o;o=o.parentElement)if(n=ls.get(o,"droppables"))for(i=0;i<n.length;++i)if((t=n[i]).dropRootElement.contains(e)&&(!(r=t.droppableSelector)||e.closest("#".concat(mi.getId(t.dropRootElement)," ").concat(r)))&&(this.target=t,this.target===t))return}},{key:"abort",value:function(){var e=this,t=e.element,n=e.source;null==t||t.getBoundingClientRect(),e.state!==Nd&&(e.state=jd,e.cleanup()),null==n||n.endDrag(e)}},{key:"begin",value:function(){var e=this,t=e.source;!1!==t.beforeDrag(e)&&(t.dragging=e)}},{key:"cleanup",value:function(){for(var e;e=this.cleaners.pop();)e()}},{key:"end",value:function(e){var t=this,n=t.lastMoveEvent,r=t.target,i=t.source.dragSwallowClickTime;t.event=t.endEvent=e,t.syncFlags(),t.started&&((null==n?void 0:n.clientX)===e.clientX&&(null==n?void 0:n.clientY)===e.clientY&&(null==n?void 0:n.target)===e.target||t.track(),i&&Tu.on({element:document,capture:!0,expires:i,once:!0,click:function(e){e.stopPropagation()}}),t.state=Nd,r!==t.source&&(null==r||r.dragDrop(t)))}},{key:"fakeKey",value:function(e,t){var n,r=this,i=r.lastMoveEvent;i&&r.element&&(i.isKey=!0,"Alt"===e.key?r.altKey!==t&&(r.altKey=t,n=!0):"Control"===e.key&&r.ctrlKey!==t&&(r.ctrlKey=t,n=!0),n&&(r.event=i,r.track()))}},{key:"keyDown",value:function(e){this.completed||("Escape"===e.key?this.abort():this.isDragToggleKey(e.key)&&this.fakeKey(e,!0))}},{key:"keyUp",value:function(e){!this.completed&&this.isDragToggleKey(e.key)&&this.fakeKey(e,!1)}},{key:"getDistance",value:function(e){return Tu.getDistanceBetween(this.startEvent,e)}},{key:"isDragToggleKey",value:function(e){return"Control"===e||"Alt"===e}},{key:"move",value:function(e){var t=this,n=e.target,r=t.getDistance(e)>=t.threshold;if(t.syncFlags(),t.touchStartTimer)r&&t.abort();else if(n&&n.nodeType===Node.ELEMENT_NODE){if(r&&!t.started&&(t.event=e,!1===t.start()))return void t.abort();t.started&&(t.lastMoveEvent=t.event=e,"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation()),t.track())}}},{key:"start",value:function(){var e=this,t=e.scrollManager,n=e.monitoringConfig,r=e.source,i=r.draggingBodyCls,o=r.dragLock,a=r.dragRootElement;if(e.state=Hd,t){var s=t.startMonitoring(he.merge({scrollables:[{element:a}],direction:zd[o]||o||"both",callback:function(t){var n=e.lastMoveEvent;n&&e.element&&(n.isScroll=!0,e.event=n,e.scrollerAction=t,e.track(),e.scrollerAction=null)}},n));e.cleaners.push(s)}var l=r.dragRootElement.closest(".b-outer")||document.body;if(l.classList.add(i),e.cleaners.push((function(){return l.classList.remove(i)})),!1===r.startDrag(e))return e.cleanup(),!1}},{key:"syncFlags",value:function(){var e=this,t=e.event;e.altKey=t.altKey,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey}},{key:"track",value:function(){var e,t=this,n=t.event,r=t.source,i=t.target,o=n.target;"touchmove"===n.type&&(e=n.changedTouches[0],o=mi.elementFromPoint(e.clientX,e.clientY)),t.targetElement=o,i===t.target&&(null==i||i.dragMove(t)),r.trackDrag(t)}}],[{key:"configurable",get:function(){return{itemElement:null,scrollManager:null,monitoringConfig:null,source:null,target:null,targetElement:null,threshold:5,touchStartDelay:300}}}]),r}($e.mixin(Ld,el));function Wd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Vd.prototype.STATE=Vd.STATE=Object.freeze({ABORTED:jd,INIT:_d,DRAGGING:Hd,DROPPED:Nd}),Vd._$name="DragContext";var $d=function(e){Ye()(n,e);var t=Wd(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateDragging",value:function(e,t){t&&this.close(t),e&&this.open(e)}},{key:"close",value:function(e){}},{key:"open",value:function(e){}},{key:"dragStart",value:function(e){this.dragging=e}},{key:"dragMove",value:function(e){}},{key:"dragEnd",value:function(e){this.dragging=null}}],[{key:"type",get:function(){return"default"}},{key:"configurable",get:function(){return{dragging:null}}},{key:"factoryable",get:function(){return{defaultType:n}}}]),n}($e.mixin(ao));function Ud(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}$d.initClass(),$d._$name="DragProxy";var Gd=function(e){return function(e){Ye()(i,e);var t,n,r=Ud(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"dragStart",value:function(e){}},{key:"dragOver",value:function(e){}},{key:"dragEnterTarget",value:function(e){}},{key:"dragLeaveTarget",value:function(e,t){}},{key:"dragDrop",value:function(e){}},{key:"dragEnd",value:function(e){}},{key:"activeDrag",get:function(){var e=this.dragging;return null!=e&&e.started&&!e.completed?e:null}},{key:"dragEventer",get:function(){return this.trigger?this:null}},{key:"draggingClassElement",get:function(){var e=this.draggingClsSelector,t=this.dragRootElement;return e?null==t?void 0:t.closest(e):t}},{key:"beforeDrag",value:function(e){var t=this.dragSelector;return!t||Boolean(e.element.closest(t))}},{key:"beginDrag",value:function(e){var t=this.draggingCls,n=this.draggingClassElement;t&&n&&(n.classList.add(t),e.cleaners.push((function(){return n.classList.remove(t)})))}},{key:"endDrag",value:(n=Pt()(At.a.mark((function e(t){var n,r,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).dragEventer,i=n.dragProxy,!t.valid){e.next=4;break}return e.next=4,n.dragDrop(t);case 4:n.dragEnd(t),null==i||i.dragEnd(t),null==r||r.trigger(t.valid?"drop":"dragCancel",{drag:t,event:t.event}),n.finalizeDrag(t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"finalizeDrag",value:(t=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.finalize();case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"moveDrag",value:function(e){if(!1!==this.dragOver(e)){var t=this.dragEventer,n=this.dragProxy;null==n||n.dragMove(e),null==t||t.trigger("drag",{drag:e,event:e.event})}}},{key:"setupDragContext",value:function(e){var t=this,n=t.dragItemSelector,r=e.target;return{event:e,itemElement:n?r.closest(n):r,touchStartDelay:t.dragTouchStartDelay,source:t,threshold:t.dragThreshold}}},{key:"startDrag",value:function(e){var t=this.draggingStartedCls,n=this.draggingClassElement,r=this.draggingItemCls,i=this.dragEventer,o=this.dragProxy,a=e.itemElement;if(!1===(null==i?void 0:i.trigger("beforeDragStart",{drag:e,event:e.event})))return!1;t&&n&&(n.classList.add(t),e.cleaners.push((function(){return n.classList.remove(t)}))),r&&a&&(a.classList.add(r),e.cleaners.push((function(){return a.classList.remove(r)}))),null==o||o.dragStart(e);var s=this.dragStart(e);return!1!==s&&(null==i||i.trigger("dragStart",{drag:e,event:e.event})),s}},{key:"trackDrag",value:function(e){var t,n=this.dropTargetSelector;e.valid=!(n&&(null===(t=e.targetElement)||void 0===t||!t.closest(n))),this.moveDrag(e)}},{key:"configureListeners",value:function(e){var t=Qn.assign({thisObj:this},this.dragDocumentListeners);return"touches"in e.startEvent?(delete t.mousemove,delete t.mouseup):(delete t.contextmenu,delete t.touchmove,delete t.touchend,delete t.pointerup),t}},{key:"updateDragging",value:function(e){if(e){var t=this.configureListeners(e);e.cleaners.push(Tu.on(t)),this.beginDrag(e)}}},{key:"changeDragProxy",value:function(e,t){return $d.reconfigure(t,e,{owner:this,defaults:{owner:this}})}},{key:"updateDragRootElement",value:function(e,t){var n,r=this,i=r.draggableCls,o=r.dragItemSelector,a=r.onDragItemMouseMove;if(null==t||t.classList.remove(i),null===(n=r._dragRootDetacher)||void 0===n||n.call(r),e){var s={thisObj:r,element:e,mousedown:"onDragMouseDown",touchstart:"onDragTouchStart"};a&&(s.mousemove={delegate:o,handler:"onDragItemMouseMove"}),(r.dragItemOverCls||a||r.onDragItemMouseEnter||r.onDragItemMouseLeave)&&Object.assign(s,{mouseover:{delegate:o,handler:"onDragItemMouseOver"},mouseout:{delegate:o,handler:"onDragItemMouseOut"}}),e.classList.add(i),r._dragRootDetacher=Tu.on(s)}}},{key:"onDragItemMouseOver",value:function(e){this.overItem=e}},{key:"onDragItemMouseOut",value:function(e){this.dragging||(this.overItem=e)}},{key:"changeOverItem",value:function(e){var t;return this.enterLeaveEvent=e,"mouseout"===e.type?(null===(t=e.relatedTarget)||void 0===t?void 0:t.closest(this.dragItemSelector))||null:e.target.closest(this.dragItemSelector)}},{key:"updateOverItem",value:function(e,t){var n,r,i=this.dragItemOverCls;t&&(i&&t.classList.remove(i),null===(n=this.onDragItemMouseLeave)||void 0===n||n.call(this,this.enterLeaveEvent,t));e&&(i&&e.classList.add(i),null===(r=this.onDragItemMouseEnter)||void 0===r||r.call(this,this.enterLeaveEvent,e))}},{key:"onDragContextMenu",value:function(e){e.preventDefault()}},{key:"onDragKeyDown",value:function(e){this.dragging.keyDown(e)}},{key:"onDragKeyUp",value:function(e){this.dragging.keyUp(e)}},{key:"onDragMouseDown",value:function(e){0===e.button&&this.onDragPointerDown(e)}},{key:"onDragPointerDown",value:function(e){var t=this.dragging;t?t.isFinalizing||t.abort():(t=this.setupDragContext(e))&&new Vd(t).begin()}},{key:"onDragPointerMove",value:function(e){var t=this.dragging;t&&!t.completed&&(null==t||t.move(e))}},{key:"onDragPointerUp",value:function(e){var t=this.dragging;t&&!t.completed&&(t.end(e),this.endDrag(t))}},{key:"onDragTouchStart",value:function(e){1===e.touches.length&&this.onDragPointerDown(e)}}],[{key:"$name",get:function(){return"Draggable"}},{key:"configurable",get:function(){return{dragging:null,draggingClsSelector:null,dragDocumentListeners:{element:document,keydown:"onDragKeyDown",keyup:"onDragKeyUp",contextmenu:"onDragContextMenu",mousemove:"onDragPointerMove",mouseup:"onDragPointerUp",pointerup:"onDragPointerUp",touchend:"onDragPointerUp",touchmove:{handler:"onDragPointerMove",passive:!1}},dragItemSelector:null,dragItemOverCls:null,dragLock:null,dragMinDistance:1,dragProxy:{$config:["lazy","nullify"],value:null},dragRootElement:{$config:"nullify",value:null},dragSameTargetDrop:!1,dragSelector:null,dragSwallowClickTime:50,dragThreshold:5,dragTouchStartDelay:300,dropTargetSelector:null,overItem:null,testConfig:{dragSwallowClickTime:pe.a.isEdge?300:50}}}},{key:"properties",get:function(){return{draggingCls:"b-draggable-active",draggingBodyCls:"b-draghelper-active",draggingItemCls:"b-dragging-item",draggingStartedCls:"b-draggable-started",draggableCls:"b-draggable"}}}]),i}(e||$e)};function Yd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var qd=function(e){return function(e){Ye()(n,e);var t=Yd(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"droppableCls",get:function(){return"b-droppable"}},{key:"dragEnter",value:function(e){}},{key:"dragMove",value:function(e){}},{key:"dragDrop",value:function(e){}},{key:"dragLeave",value:function(e){}},{key:"changeDropping",value:function(e,t){if(e!==t){var n=this;t&&(!t.aborted&&t.completed||n.dragLeave(t)),e&&(n._dropping=e,!1===n.dragEnter(e)&&(e=null),n._dropping=t)}return e}},{key:"updateDropRootElement",value:function(e,t){var n,r,i,o=this,a=o.droppableCls;t&&(n=ls.get(t,"droppables"),i=!0,Array.isArray(n)&&(r=n.indexOf(o))>-1&&(n.length<2?ls.remove(t,"droppables"):(n.splice(r,1),n.forEach((function(e){a===e.droppableCls&&(i=!1)})))),i&&t.classList.remove(a)),e&&((n=ls.get(e,"droppables"))?n.push(o):ls.set(e,"droppables",[o]),e.classList.add(a))}}],[{key:"$name",get:function(){return"Droppable"}},{key:"configurable",get:function(){return{droppableSelector:null,dropping:null,dropRootElement:{$config:"nullify",value:null}}}}]),n}(e||$e)};function Kd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Zd,Jd=function(e){return function(e){Ye()(n,e);var t=Xd(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"doDestroy",value:function(){var e=this.features;for(var t in tt()(Ze()(n.prototype),"doDestroy",this).call(this),e){var r,i=e[t];null===(r=i.destroy)||void 0===r||r.call(i)}}},{key:"hasFeature",value:function(e){var t;return Boolean(null===(t=this.features)||void 0===t?void 0:t[e])}},{key:"changeFeatures",value:function(e,t){if(!this.isDestroying){var n=this,r=n.constructor.featureable,i=n.$features||(n.$features=new Dc({configName:"features",factory:r.factory,owner:n,ownerName:r.ownerName}));return i.update(e),t?void 0:i.target}}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"Featureable"}},{key:"configurable",get:function(){return{features:null}}},{key:"declarable",get:function(){return["featureable"]}},{key:"setupFeatureable",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kd(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ownerName:"client"},e.featureable);t.factory.initClass(),Reflect.defineProperty(e,"featureable",{get:function(){return t}})}}]),n}(e||$e)};function Qd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var eh="b-hover-edge",th="b-hover-top",nh="b-hover-right",rh="b-hover-bottom",ih="b-hover-left",oh=(Zd={},Qe()(Zd,eh,1),Qe()(Zd,th,1),Qe()(Zd,nh,1),Qe()(Zd,rh,1),Qe()(Zd,ih,1),Zd),ah={t:[eh,th],r:[eh,nh],b:[eh,rh],l:[eh,ih],tr:[eh,th,nh],bl:[eh,rh,ih],tl:[eh,th,ih],br:[eh,rh,nh]},sh=function(e){return function(e){Ye()(n,e);var t=Qd(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"hoverEnter",value:function(e){}},{key:"hoverIgnore",value:function(e){var t;return null===(t=this.hoverIgnoreElement)||void 0===t?void 0:t.contains(e)}},{key:"hoverLeave",value:function(e){}},{key:"hoverMove",value:function(e){}},{key:"onHoverMouseMove",value:function(e){var t=this,n=t.hoverEdges,r=t.hoverEdgeSize,i=t.hoverTarget;if(i){if(n){var o=i.getBoundingClientRect(),a=o.top,s=o.left,l=o.width,u=o.height,c=o.right,f=o.bottom,d=e.clientX,h=e.clientY,v=s+l/2,p=a+u/2,g=h<(r?a+r:p),y=d>=(r?c-r:v),m=g||h>=(r?f-r:p)?g?"t":"b":"",b=y||d<(r?s+r:v)?y?"r":"l":"";t.hoverZone=(n.includes(m)?m:"")+(n.includes(b)?b:"")}t.hoverEvent=e,t.hoverTrack&&t.hoverMove(e)}}},{key:"onHoverMouseOver",value:function(e){this.hoverEvent=e,this.hoverElement=e.target}},{key:"onHoverMouseOut",value:function(e){this.hoverEvent=e,this.hoverElement=e.relatedTarget}},{key:"updateHoverDelay",value:function(e){this.setHoverTarget.delay=e}},{key:"changeHoverEdges",value:function(e){return!0===e?"trbl":(e||"").replace("v","tb").replace("h","lr")}},{key:"updateHoverEdges",value:function(){this.syncHoverListeners()}},{key:"changeHoverElement",value:function(e){if(!this.hoverIgnore(e))return e}},{key:"updateHoverElement",value:function(e){var t,n=this.hoverSelector;n&&(e=null===(t=e)||void 0===t?void 0:t.closest(n));this.setHoverTarget(e)}},{key:"updateHoverRootElement",value:function(e,t){var n=this.hoverRootCls;n&&(null==t||t.classList.remove(n),null==e||e.classList.add(n)),this.syncHoverListeners()}},{key:"changeHoverTarget",value:function(e,t){return t&&(this.hoverZone=null),e}},{key:"updateHoverTarget",value:function(e,t){var n=this,r=n.hoverCls,i=n.hoverAnimationCls,o=n.hoverRootActiveCls,a=n.hoverRootElement;o&&(null==a||a.classList[e?"add":"remove"](o)),t&&(r&&t.classList.remove(r),i&&t.classList.remove(i),n.hoverLeave(t)),e&&(r&&e.classList.add(r),n.hoverEnter(t),n.hoverTrack&&n.hoverMove(n.hoverEvent),i&&(e.getBoundingClientRect(),e.classList.add(i)))}},{key:"updateHoverTrack",value:function(){this.syncHoverListeners()}},{key:"updateHoverZone",value:function(e){var t=this.hoverAnimationCls,n=this.hoverTarget;if(n){var r=n.className,i=xr.change(r,e?ah[e]:null,oh);r!==i&&(n.className=i,e&&t&&(n.classList.remove(t),n.getBoundingClientRect(),n.classList.add(t)))}}},{key:"setHoverTarget",value:function(e){this.hoverTarget=e}},{key:"syncHoverListeners",value:function(){var e,t=this,n=t.hoverRootElement,r={element:n,thisObj:t,mouseover:"onHoverMouseOver",mouseout:"onHoverMouseOut"};(t.hoverTrack||t.hoverEdges)&&(r.mousemove="onHoverMouseMove"),null===(e=t._hoverRootDetacher)||void 0===e||e.call(t),t._hoverRootDetacher=n&&Tu.on(r)}}],[{key:"$name",get:function(){return"Hoverable"}},{key:"configurable",get:function(){return{hoverCls:null,hoverAnimationCls:null,hoverRootCls:null,hoverRootActiveCls:null,hoverDelay:null,hoverElement:null,hoverIgnoreElement:null,hoverEdges:null,hoverEdgeSize:10,hoverRootElement:{$config:"nullify",value:null},hoverSelector:null,hoverTarget:{$config:"nullify",value:null},hoverTrack:null,hoverZone:null}}},{key:"delayable",get:function(){return{setHoverTarget:0}}}]),n}(e.mixin(el))};function lh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var uh=function(e){return function(e){Ye()(n,e);var t=lh(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"applyLoadMask",value:function(){var e=this,t=e.loadMask;t&&(e.masked=qu.mergeConfigs(e.loadMaskDefaults,t))}},{key:"applyMaskError",value:function(e){var t=this.loadMaskError,n=this.masked;n&&(Qn.assign(n.errorDefaults,t),n.error=e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"LoadMaskable"}},{key:"configurable",get:function(){return{loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},loadMask:{text:"L{GridBase.loadMask}"},syncMask:{text:"L{GridBase.syncMask}"},localizableProperties:["loadMask.text","syncMask.text"]}}}]),n}(e)},ch=(n(254),{constructor:1,prototype:1,name:1,length:1,arguments:1,caller:1,callee:1,__proto__:1}),fh=function(){function e(){B()(this,e)}return _()(e,null,[{key:"apply",value:function(e){if(!e.target)throw new Error("Override must specify what it overrides, using static getter target");if(!e.target.class)throw new Error("Override must specify which class it overrides, using target.class");if(!this.shouldApplyOverride(e))return!1;var t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(e.prototype);return t.splice(t.indexOf("target"),1),this.internalOverrideAll(e.target.class,t,e),this.internalOverrideAll(e.target.class.prototype,n,e.prototype),!0}},{key:"internalOverrideAll",value:function(e,t,n){var r=this;Reflect.ownKeys(n).forEach((function(i){if(t.includes(i)&&!ch[i]){for(var o=Object.getOwnPropertyDescriptor(n,i),a=e,s=null;!s&&a;)(s=Object.getOwnPropertyDescriptor(a,i))||(a=Object.getPrototypeOf(a));s&&r.internalOverride(a,i,o,s)}}))}},{key:"internalOverride",value:function(e,t,n,r){(e._overridden=e._overridden||{})[t]=e[t],r.get?Object.defineProperty(e,t,{enumerable:!1,configurable:!0,get:n.get}):e[t]=n.value}},{key:"shouldApplyOverride",value:function(e){var t=e.target;if(!t.maxVersion&&!t.minVersion)return!0;if(!t.product)throw new Error("Override must specify product when using versioning");return(!t.maxVersion||!z.a[t.product].isNewerThan(t.maxVersion))&&(!t.minVersion||!z.a[t.product].isOlderThan(t.minVersion))}}]),e}();function dh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fh._$name="Override";var hh=function(e){Ye()(n,e);var t=dh(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeMonitoring",value:function(e,t){return null==t||t.clear(),new Map}},{key:"doDestroy",value:function(){this.stopMonitoring(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"isScrolling",get:function(){return 0!==Object.keys(this.activeScroll).length}},{key:"startMonitoring",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=t.element,r=t.direction,i=e.scrollables,o=void 0===i?[]:i,a=e.direction,s=void 0===a?r:a,l=e.callback,u=[];return e.element&&(z.a.deprecate("core","5.0.0","`element` config is deprecated, please use `scrollables` instead."),o.push({element:e.element})),o.length||o.push({element:n}),o.forEach((function(e){var r=e.element;"string"==typeof r?mi.forEachSelector(n,r,(function(n){t.createMonitor(n,e.direction||s,e.callback||l),u.push(n)})):(t.createMonitor(r,e.direction||s,e.callback||l),u.push(r))})),function(){t.stopMonitoring(u)}}},{key:"createMonitor",value:function(e,t,n){var r=this.monitoring;r.has(e)||r.set(e,new vh({scrollManager:this,element:e,direction:t,callback:n}))}},{key:"stopMonitoring",value:function(e){var t=this,n=t.monitoring;if(e&&!Array.isArray(e)&&(e=[e]),n){if(!e)return void n.forEach((function(e){return t.stopMonitoring(e.element)}));e.forEach((function(e){var t=n.get(e);t&&(t.destroy(),n.delete(e))}))}}},{key:"requestScroll",value:function(e,t){var n=this.activeScroll;return(!(e in n)||n[e]===t)&&(n[e]=t,!0)}},{key:"releaseScroll",value:function(e){var t=this.activeScroll,n=void 0===t?{}:t;Object.keys(n).forEach((function(t){n[t]===e&&delete n[t]}))}},{key:"getRelativeScroll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=0;return this.monitoring.forEach((function(r,i){mi.isDescendant(i,e)&&(n+="left"===t?r.scrollRelativeLeft:r.scrollRelativeTop)})),n}}],[{key:"configurable",get:function(){return{element:null,zoneWidth:50,scrollSpeed:5,direction:"both",startScrollDelay:500,stopScrollWhenPointerOut:!1,testConfig:{scrollSpeed:2,startScrollDelay:0},activeScroll:{$config:["lazy"],value:{}},monitoring:{$config:["lazy","nullify"],value:!0}}}}]),n}(el($e)),vh=function(e){Ye()(n,e);var t=dh(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=e.element,r=t.scrollLeft,i=t.scrollTop;Object.assign(e,{startScrollLeft:r,startScrollTop:i}),tt()(Ze()(n.prototype),"construct",this).call(this,e),Tu.on({element:t,scroll:"onElementScroll",mousemove:"onMouseMove",touchmove:"onMouseMove",capture:!0,thisObj:this}),Tu.on({element:t,pointerleave:"onPointerLeave",thisObj:this})}},{key:"doDestroy",value:function(){this.stopScroll(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"startScroll",value:function(){this.scrolling=!0,this.performScroll()}},{key:"stopScroll",value:function(){var e=this;e.scrolling=!1,e.scrollRequested&&(e.scrollManager.cancelAnimationFrame(e.frameId),e.scrollRequested=!1),e.scrollManager.clearTimeout(e.scrollTimeout),e.scrollManager.releaseScroll(e),e.scrollTimeout=null}},{key:"onPointerLeave",value:function(){this.scrollManager.stopScrollWhenPointerOut&&this.stopScroll()}},{key:"onMouseMove",value:function(e){var t=this,n=t.scrollManager,r=t.element.getBoundingClientRect(),i=n.zoneWidth,o=n.scrollSpeed;if(t.scrollDeltaX=t.scrollDeltaY=0,"vertical"!==t.direction){var a=t.element,s=a.scrollLeft,l=a.scrollWidth,u=a.clientWidth;e.clientX>r.right-i&&l-s-u>=1?t.scrollDeltaX=Math.round((i-(r.right-e.clientX))/o)+1:e.clientX<r.left+i&&s>0&&(t.scrollDeltaX=-Math.round((i+(r.left-e.clientX))/o)-1)}if("horizontal"!==t.direction){var c=t.element,f=c.scrollTop,d=c.scrollHeight,h=c.clientHeight;e.clientY>r.bottom-i&&d-f-h>=1?t.scrollDeltaY=Math.round((i-(r.bottom-e.clientY))/o)+1:e.clientY<r.top+i&&f>0&&(t.scrollDeltaY=-Math.round((i+(r.top-e.clientY))/o)-1)}0===t.scrollDeltaX||n.requestScroll("horizontal",t)||(t.scrollDeltaX=0),0===t.scrollDeltaY||n.requestScroll("vertical",t)||(t.scrollDeltaY=0),0===t.scrollDeltaX&&0===t.scrollDeltaY?t.stopScroll():t.scrollTimeout||(t.scrollTimeout=n.setTimeout((function(){return t.startScroll()}),n.startScrollDelay))}},{key:"performScroll",value:function(){var e=this,t=e.element;if(e.scrolling&&!e.scrollRequested){if(0!==e.scrollDeltaX){var n=t.scrollLeft,r=Math.min(n+e.scrollDeltaX,t.scrollWidth-t.clientWidth);r!==n&&(t.scrollLeft=r)}if(0!==e.scrollDeltaY){var i=t.scrollTop,o=Math.min(i+e.scrollDeltaY,t.scrollHeight-t.clientHeight);o!==i&&(t.scrollTop=o)}e.scrollRequested=!0,e.frameId=e.scrollManager.requestAnimationFrame((function(){e.scrollRequested=!1,e.performScroll(e)}))}}},{key:"onElementScroll",value:function(){var e,t;null===(e=this.config)||void 0===e||null===(t=e.callback)||void 0===t||t.call(this.thisObj||this.scrollManager,this)}},{key:"scrollLeft",get:function(){return this.element.scrollLeft}},{key:"scrollTop",get:function(){return this.verticalElement?this.verticalElement.scrollTop:this.element.scrollTop}},{key:"scrollRelativeLeft",get:function(){return this.scrollLeft-this.startScrollLeft}},{key:"scrollRelativeTop",get:function(){return this.scrollTop-this.startScrollTop}},{key:"getRelativeLeftScroll",value:function(e){return this.scrollManager.getRelativeScroll(e,"left")}},{key:"getRelativeTopScroll",value:function(e){return this.scrollManager.getRelativeScroll(e,"top")}}]),n}($e);hh._$name="ScrollManager";var ph=n(28),gh=n.n(ph);function yh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var mh={left:!0,right:!0,top:!0,bottom:!0,transform:!0},bh={true:1,false:1},kh=function(e){Ye()(i,e);var t,n,r=yh(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"afterConstruct",value:function(){var e=this;e.forSelector&&(e.showOnHover=!0,e.forElement||(e.trackMouse=!0,e.forElement=e.rootElement.host||e.rootElement)),tt()(Ze()(i.prototype),"afterConstruct",this).call(this),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=Tu.on({element:e.forElement,mouseover:"internalOnPointerOver",mouseout:"internalOnPointerOut",thisObj:e})),e.autoShow&&e.show(),e.allowOver&&Tu.on({element:e.element,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:e})}},{key:"doDestroy",value:function(){this.pointerOverOutDetacher&&this.pointerOverOutDetacher(),tt()(Ze()(i.prototype),"doDestroy",this).call(this)}},{key:"focusOnToFront",get:function(){return tt()(Ze()(i.prototype),"focusOnToFront",this)&&mi.usingKeyboard},set:function(e){gh()(Ze()(i.prototype),"focusOnToFront",e,this,!0)}},{key:"focusElement",get:function(){var e=tt()(Ze()(i.prototype),"focusElement",this);if(e!==this.element)return e}},{key:"trackMouse",get:function(){return this._trackMouse&&!this.anchorToTarget}},{key:"updateAnchorToTarget",value:function(e){e||(this.anchor=!1)}},{key:"onDocumentMouseDown",value:function(e){var t=e.event,n=this,r=n.triggeredByEvent;r&&mi.isTouchEvent&&t.pageX===r.pageX&&t.pageY===r.pageY&&n.activeTarget.contains(t.target)&&performance.now()-r.timeStamp<500||(n.abortDelayedShow(),tt()(Ze()(i.prototype),"onDocumentMouseDown",this).call(this,{event:t}))}},{key:"internalOnPointerOver",value:function(e){var t,n=this,r=n.forElement,i=n.forSelector,o=n.activeTarget;if(!(n.disabled||n.allowOver&&n.element.contains(e.target))){if(i){if(o&&o.contains(e.target)&&o.contains(e.relatedTarget))return;if((t=e.target.closest(i))&&e.relatedTarget&&e.relatedTarget.closest(i)===t)return}else{if(r.contains(e.relatedTarget))return;t=r}t?n.handleForElementOver(e,t):o&&n.handleForElementOut()}}},{key:"onTransitionEnd",value:function(e){var t=this,n=i.currentOverElement;if(mh[e.propertyName]){if(t.allowOver&&t.element.contains(n))return;t.activeTarget&&t.activeTarget.contains(n)&&!t.trackMouse&&t.realign()}}},{key:"handleForElementOver",value:(n=Pt()(At.a.mark((function e(t,n){var r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(r=this).trigger("pointerOver",{event:t,target:n})){e.next=5;break}r.internalOnPointerOut(t),e.next=23;break;case 5:if(r.triggeredByEvent=t,r.abortDelayedHide(),!r.hideOnDelegateChange&&r.element.classList.contains("b-hiding")&&(r.element.classList.remove("b-hiding"),i=!0),!i&&!r.isVisible||r.hideOnDelegateChange){e.next=20;break}if(r.updateActiveTarget(n),!1!==r.trigger("beforeShow")){e.next=12;break}return e.abrupt("return",r.hide());case 12:if(i&&r.show(!1),o=r.updateContent(),!he.isPromise(o)||r.loadingMsg){e.next=17;break}return e.next=17,o;case 17:r.hidden||(r.alignTo({target:r.anchorToTarget?n:new wu(r.triggeredByEvent.pageX-window.pageXOffset+r.mouseOffsetX,r.triggeredByEvent.pageY-window.pageYOffset+r.mouseOffsetY),overlap:!(r.anchorToTarget&&r.anchor)}),r.trigger("show"),r.afterShowByTarget()),e.next=23;break;case 20:r.hideOnDelegateChange&&r.hide(!1),r.updateActiveTarget(n),r.delayShow(n);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"delayShow",value:(t=Pt()(At.a.mark((function e(t){var n,r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this).currentAnimation&&(n.cancelHideShowAnimation(),n._hidden=!0),n.isVisible||n.hasTimeout("show")){e.next=16;break}if(n.hoverDelay&&!(n.forSelector&&Date.now()-n.lastHidden<n.quickShowInterval)){e.next=11;break}if(r=n.updateContent(),!he.isPromise(r)||n.loadingMsg){e.next=8;break}return e.next=8,r;case 8:n.showByTarget(t),e.next=14;break;case 11:n.addDocumentMouseDownListener(),n.listeningForMouseMove||n.anchorToTarget||(n.mouseMoveRemover=Tu.on({element:n.rootElement,mousemove:"onMouseMove",thisObj:n})),n.setTimeout(Pt()(At.a.mark((function e(){var r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mi.isOrphaned(t)){e.next=6;break}if(r=n.updateContent(),!he.isPromise(r)||n.loadingMsg){e.next=5;break}return e.next=5,r;case 5:n.showByTarget(t);case 6:case"end":return e.stop()}}),e)}))),n.triggeredByEvent&&"mouseover"!==n.triggeredByEvent.type?0:n.hoverDelay,"show");case 14:e.next=17;break;case 16:n.isVisible&&n.showByTarget(t);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"updateContent",value:function(){var e=this;if(e.getHtml){var t=e.getHtml({tip:e,element:e.element,activeTarget:e.activeTarget,event:e.triggeredByEvent});return e.html=t,t}}},{key:"hasContent",get:function(){return Boolean(""!==this._html&&"string"==typeof this.html&&this.html.length||this.items.length)}},{key:"internalBeforeShow",value:function(){return this.updateContentOnMouseMove||this.hasContent}},{key:"showAsyncMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.optionalL(this.loadingMsg);e&&(this.html='\n                <div class="b-tooltip-loading">\n                    <i class="b-icon b-icon-spinner"></i>\n                    '.concat(e,"\n                </div>\n            "))}},{key:"showByTarget",value:function(e){var t=this;t.mouseMoveRemover&&(t.mouseMoveRemover(),t.mouseMoveRemover=null),t.showBy({target:t.anchorToTarget?e:new wu(t.triggeredByEvent.pageX-window.pageXOffset+t.mouseOffsetX,t.triggeredByEvent.pageY-window.pageYOffset+t.mouseOffsetY),overlap:!(t.anchorToTarget&&t.anchor)})}},{key:"afterShowByTarget",value:function(){var e=this,t=e.dismissDelay;e.abortDelayedShow(),t&&e.setTimeout("hide",t),e.toFront()}},{key:"updateActiveTarget",value:function(e){var t=this,n=t.activeTarget;t.activeTarget=e,t.isConfiguring||t.trigger("overtarget",{newTarget:e,lastTarget:n})}},{key:"internalOnPointerOut",value:function(e){var t=this,n=e.relatedTarget;t.allowOver&&t.element.contains(n)||t.element.contains(e.target)&&t.activeTarget&&t.activeTarget.contains(n)||t.activeTarget&&!t.activeTarget.contains(e.relatedTarget)&&t.handleForElementOut()}},{key:"handleForElementOut",value:function(){var e=this,t=e.hideDelay;!1!==e.trigger("pointerOut")?(e.abortDelayedShow(),e.isVisible&&!1!==t&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())):e.activeTarget=null}},{key:"show",value:function(){var e,t=this;(t.forElement&&t.anchorToTarget&&!t.forSelector&&!t.inShowBy?t.showByTarget(t.forElement):(t.inShowBy&&(t.y=-1e4),tt()(Ze()(i.prototype),"show",this).call(this)),t.afterShowByTarget(),t.mouseMoveRemover||t._hidden||!t.trackMouse&&!t.updateContentOnMouseMove)||(t.mouseMoveRemover=Tu.on((e={element:t.rootElement},Qe()(e,pe.a.supportsPointerEvents?"pointermove":"touchmove","onMouseMove"),Qe()(e,"thisObj",t),e)));!t.forElement||t.transitionEndDetacher||t._hidden||(t.transitionEndDetacher=Tu.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t}))}},{key:"hide",value:function(){var e=this;if(e.abortDelayedShow(),e.isVisible){var t;e.abortDelayedHide();for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];(t=tt()(Ze()(i.prototype),"hide",this)).call.apply(t,[this].concat(r)),e.lastHidden=Date.now(),e.activeTarget=null,e.mouseMoveRemover&&(e.mouseMoveRemover(),e.mouseMoveRemover=null),e.transitionEndDetacher&&(e.transitionEndDetacher(),e.transitionEndDetacher=null),e.listeningForMouseMove=!1}}},{key:"abortDelayedShow",value:function(){var e=this;e.hasTimeout("show")&&(e.mouseDownRemover&&(e.mouseDownRemover(),e.mouseDownRemover=null),e.clearTimeout("show"),e.mouseMoveRemover&&(e.mouseMoveRemover(),e.mouseMoveRemover=null),e.transitionEndDetacher&&(e.transitionEndDetacher(),e.transitionEndDetacher=null))}},{key:"abortDelayedHide",value:function(){this.clearTimeout("hide")}},{key:"realign",value:function(e){var t=this,n=t.lastAlignSpec,r=t.clippedBy;!t.isConfiguring&&r&&!t.isVisible&&n&&n.targetHidden&&(Cr.from(n.target,t.positioned?t.element.offsetParent:null,!t.positioned).intersect(r)&&(t.show(),n.targetHidden=!1));tt()(Ze()(i.prototype),"realign",this).call(this,e)}},{key:"alignTo",value:function(e){var t=this;t.isVisible&&(!e||t.triggeredByEvent&&t.element.contains(t.triggeredByEvent.target)||e.nodeType===Node.ELEMENT_NODE&&(e={target:e}),tt()(Ze()(i.prototype),"alignTo",this).call(this,e))}},{key:"changeHtml",value:function(e){var t=this;return!1===e?(z.a.deprecate("Grid","5.0.0","Setting false to indicate loading is deprecated, in favor of `showAsyncMessage`. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/3.0.1.md for more information"),void this.showAsyncMessage()):he.isPromise(e)?(t.showAsyncMessage(),e.target=t.activeTarget,void e.then((function(n){e.target===t.activeTarget&&(t.html=n)}))):("object"!==I()(e)&&(e=null!=e?t.optionalL(String(e)):""),e)}},{key:"updateHtml",value:function(e,t){var n=this,r=""===e;r||(tt()(Ze()(i.prototype),"updateHtml",this).call(this,e,t),n.hasContent?(n.isVisible&&n.realign(),he.isPromise(e)||n.trigger("innerHtmlUpdate")):r=!0),r&&n.hide()}},{key:"onMouseMove",value:function(e){var t=this,n=t.forElement,r=e.pageX-window.pageXOffset+t.mouseOffsetX,i=e.pageY-window.pageYOffset+t.mouseOffsetY,o=t.hasTimeout("hide"),a=e.target;if(t.triggeredByEvent=e,!t._hidden){var s,l=t.forSelector&&t.activeTarget&&!o&&a.nodeType===Node.ELEMENT_NODE&&!a.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(a)),u=null!=n&&n.document?n.document.documentElement:n,c=u&&(u.contains?u.contains(a):16&u.compareDocumentPosition(a));l&&(s=t.handleForElementOut()),(s||!o||c)&&(t.dismissDelay&&!o&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.getHtml({tip:t,element:t.element,forElement:t.activeTarget,event:e})),t.trackMouse&&t.alignTo({position:new wu(r,i),ignorePageScroll:!0}))}}},{key:"onOwnElementMouseEnter",value:function(e){this.abortDelayedHide()}}],[{key:"$name",get:function(){return"Tooltip"}},{key:"type",get:function(){return"tooltip"}},{key:"configurable",get:function(){return{mouseOffsetX:15,mouseOffsetY:15,floating:!0,getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:!1,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:!1,anchor:!0,align:"b-t",axisLock:!0,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}},{key:"getSharedTooltip",value:function(e,t){var n,r,o=null===(n=e.bryntum)||void 0===n||null===(r=n.tooltip)||void 0===r?void 0:r.get(i);if(!o&&!t){var a;null!==(a=e.bryntum)&&void 0!==a&&a.tooltip||Qn.setPath(e,"bryntum.tooltip",new Map);var s=e.bryntum.tooltip;s.set(i,!0),o=new i({forElement:e,rootElement:e,forSelector:"[data-btip]",resetCfg:{},isShared:!0,cls:"b-tooltip-shared",listeners:{pointerOver:function(e){var t=e.source,n=e.target;for(var r in t.resetCfg)"listeners"===r?t.un(t.resetCfg[r].set):"html"!==r&&(t[r]=t.resetCfg[r].was);t.resetCfg={};var i=uc.getById(n.id),o=(null==i?void 0:i.tipConfig)||t.gatherDataConfigs(n.dataset);if(i&&i.element!==n||!i&&n.matches(".b-widget"))return!1;for(var a in o)t.resetCfg[a]={set:o[a],was:t[a]},"listeners"===a?t.on(o[a]):t[a]=o[a]}},gatherDataConfigs:function(e){var t={};for(var n in e)if(n.startsWith("btip"))if(n.length>4){var r=te.uncapitalize(n.substr(4));if(r in this.getDefaultConfiguration()){var i=e[n];t[r]=bh[i]?"true"===i:isNaN(i)?i:parseInt(i,10)}}else t.html=e[n];return t}}),Tu.on({element:e,mouseenter:function(e){return i.currentOverElement=e.target},capture:!0}),s.set(i,o)}return o}}]),i}(xf);function wh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}kh.initClass(),Object.defineProperty(uc,"tooltip",{get:function(){return kh.getSharedTooltip(document.body)}}),uc.Tooltip=kh,kh._$name="Tooltip";var Ch=function(e){Ye()(n,e);var t=wh(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"open",value:function(){this.getConfig("tooltip")}},{key:"close",value:function(){var e;null===(e=this.tooltip)||void 0===e||e.hide()}},{key:"dragMove",value:function(e){var t=this.offset,n=this.tooltip,r=e.event;n&&(n.isVisible||n.show(),n.alignTo({align:this.align,target:new Cr(r.clientX-t,r.clientY-t,2*t,2*t)}))}},{key:"changeTooltip",value:function(e,t){return uc.reconfigure(t,e,this)}}],[{key:"type",get:function(){return"tip"}},{key:"configurable",get:function(){return{align:"t10-b50",offset:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip"}}}}}]),n}($d);Ch.initClass(),Ch._$name="DragTipProxy";var Rh=6e4,Sh=36e5,xh=864e5,Eh=/(\d+)?:?(\d*)/,Dh=function(){function e(t){B()(this,e);var n,r,i=0;null!=t&&t.isDayView?(i=t.dayStartShift,n=t.dayStartTime,r=t.dayEndTime):"number"==typeof t?i=n=r=t:t&&(i=t.startShift,n=t.timeStart,r=t.timeEnd),this.startShift=i=e.parse(i||0),this.timeEnd=(null==r?(i+xh)%xh:e.parse(r))||xh,this.timeStart=null==n?i:e.parse(n)}return _()(e,[{key:"startHour",get:function(){return Math.floor(this.timeStart/Sh)}},{key:"startTimeOffsetMs",get:function(){var e=this.startShift,t=this.timeStart;return t<e?xh-e+t:t-e}},{key:"today",get:function(){return this.startOfDay(new Date)}},{key:"ceil",value:function(e){var t=this.startOfDay(e);return t<e&&t.setDate(t.getDate()+1),t}},{key:"contains",value:function(e){return!this.outside(e)}},{key:"dateKey",value:function(e){return e=this.shiftDate(e,-1),Un.makeKey(e)}},{key:"dayOfDate",value:function(e){return this.shiftDate(Un.clearTime(e))}},{key:"dayOfWeek",value:function(e){return(e=this.shiftDate(e,-1)).getDay()}},{key:"delta",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms",r=this.timeStart,i=e.parse(t),o=(i<r?i+xh:i)-r;return"ms"===n?o:Un.as(n,o,"ms")}},{key:"duration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ms",t=this.timeStart,n=this.timeEnd,r=t<n?n-t:xh-t+n;return"ms"===e?r:Un.as(e,r,"ms")}},{key:"equals",value:function(e){return this.startShift===(null==e?void 0:e.startShift)&&this.timeStart===e.timeStart&&this.timeEnd===e.timeEnd}},{key:"intersects",value:function(e,t){var n=this,r=n.timeStart,i=n.timeEnd,o=n._dateRangeArgs(e,t),a=N()(o,2),s=a[0],l=a[1],u=n.timeRange(s,l),c=N()(u,2),f=c[0],d=c[1];return r<i?f<d?f<i&&r<=d:f<i||r<=d:!(f<d)||f<i||r<=d}},{key:"isIntraDay",value:function(e,t){var n=this._dateRangeArgs(e,t),r=N()(n,2),i=r[0],o=r[1],a=this.startOfDay(i),s=xh-Un.diff(a,o,"ms");return!(s<0)&&(s>0||a<i)}},{key:"outside",value:function(t){var n=this.startShift,r=this.timeStart,i=this.timeEnd,o=e.parse(t);return r<i?o<r?o<n?1:-1:o<i?0:o<n?-1:1:o<i||o>=r?0:o<n?1:-1}},{key:"shiftDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.startShift;return e="number"==typeof e?new Date(e):e,t&&n?Un.add(e,t>0?n:-n,"ms"):e}},{key:"startOfDay",value:function(e){return e=this.shiftDate(e,-1),e=Un.clearTime(e),e=this.shiftDate(e)}},{key:"timeRange",value:function(e,t){var n=this._dateRangeArgs(e,t),r=N()(n,2),i=r[0],o=r[1];return[Un.getTimeOfDay(i),Un.getTimeOfDay(o)]}},{key:"toString",value:function(){var t=this.startShift,n=this.timeEnd,r=this.timeStart,i=t?"@".concat(e.format(t)):"",o=e.format(r);return r===n?t?i:o:"".concat(o,"-").concat(e.format(n)).concat(i)}},{key:"_dateRangeArgs",value:function(e,t){return e.isModel?[e.startDate,e.endingDate]:[e,t]}}],[{key:"format",value:function(e){var t=Math.floor(e/Sh),n=Math.floor(e/Rh)%60;return"".concat(t,":").concat(n<10?"0":"").concat(n)}},{key:"parse",value:function(e){var t=I()(e);if("string"===t){var n=Eh.exec(e);e=Number(n[1]||0)*Sh+Number(n[2]||0)*Rh}else"number"!==t?e=Un.getTimeOfDay(e):e<=24&&(e*=Sh);return Math.min(Math.max(Math.floor(e),0),xh)}}]),e}();function Th(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Dh.MIDNIGHT=new Dh({startShift:0,startTime:0,endTime:24}),Dh.MILLIS_PER_MINUTE=Rh,Dh.MILLIS_PER_HOUR=Sh,Dh.MILLIS_PER_DAY=xh,Dh._$name="DayTime";var Oh=function(e){Ye()(n,e);var t=Th(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"configure",value:function(e){tt()(Ze()(n.prototype),"configure",this).call(this,e),this.updateDayNumbers(),e.date&&(this.date=e.date)}},{key:"changeDate",value:function(e){if(!this.isConfiguring){if(e="string"==typeof e?Un.parse(e,"YYYY-MM-DD"):new Date(e),isNaN(e))throw new Error("Month date ingestion must be passed a Date, or a valid YYYY-MM-DD date string");return e}}},{key:"updateDate",value:function(e,t){var n=this,r=n.dayColumnIndex,i=Un.getFirstDateOfMonth(e),o=Un.getLastDateOfMonth(i),a=r[i.getDay()],s=r[o.getDay()],l=!t||e.getFullYear()!==t.getFullYear(),u=n.eventListeners&&(t?e.getDate()!==t.getDate()|(n.getWeekId(e)!==n.getWeekId(t))<<1|(e.getMonth()!==t.getMonth())<<2|l<<3:15);if(n._year=e.getFullYear(),n._month=e.getMonth(),n.startDayOfMonth=1-a,n.endDayOfMonth=o.getDate()+(6-s),n.sixWeeks&&(n.endDayOfMonth+=7*(6-n.weekCount)),n.weekBase&&!l||n.calculateWeekBase(),u){var c={newDate:e,oldDate:t,changes:{d:!0,w:Boolean(2&u),m:Boolean(12&u),y:Boolean(8&u)}};n.trigger("dateChange",c),2&u&&n.trigger("weekChange",c),12&u&&n.trigger("monthChange",c),8&u&&n.trigger("yearChange",c)}}},{key:"calculateWeekBase",value:function(){var e=this,t=e.dayColumnIndex,n=new Date(e.year,0,1),r=new Date(e.year,11,31),i=e.month?e.getOtherMonth(n):e;e.dayColumnIndex[n.getDay()]>3?e.weekBase=i.startDate:e.weekBase=new Date(e.year,0,i.startDayOfMonth-7);var o=Math.floor(Un.diff(e.weekBase,r,"day")/7);e.has53weeks=53===o&&t[r.getDay()]>2}},{key:"getWeekStart",value:function(e){if("number"==typeof e)return Un.add(this.weekBase,7*Math.max(e,1),"day");var t=this,n=N()(e,2),r=n[0],i=n[1];return r===t.year?t.getWeekStart(i):t.getOtherMonth(new Date(r,0,1)).getWeekStart(i)}},{key:"getOtherMonth",value:function(e){var t=this,r=t===Mh?new n(null):Mh;return r.configure({weekBase:null,weekStartDay:t.weekStartDay,nonWorkingDays:t.nonWorkingDays,hideNonWorkingDays:t.hideNonWorkingDays,sixWeeks:t.sixWeeks,date:new Date(e.getFullYear(),0,1)}),r.date=e,r.updateDate(r.date,r.date),r}},{key:"changeYear",value:function(e){var t=new Date(this.date);t.setFullYear(e),this.date=t}},{key:"changeMonth",value:function(e){var t=new Date(this.date);t.setMonth(e),this.date=t}},{key:"weekStartDay",get:function(){return"number"==typeof this._weekStartDay?this._weekStartDay:Un.weekStartDay}},{key:"updateWeekStartDay",value:function(){var e=this;e.updateDayNumbers(),!e.isConfiguring&&e.date&&(e.weekBase=null,e.updateDate(e.date,e.date))}},{key:"nonWorkingDays",get:function(){return this._nonWorkingDays||Un.nonWorkingDays}},{key:"changeNonWorkingDays",value:function(e){return Qn.assign({},e)}},{key:"updateNonWorkingDays",value:function(){this.updateDayNumbers()}},{key:"updateHideNonWorkingDays",value:function(){this.updateDayNumbers()}},{key:"updateSixWeeks",value:function(){this.isConfiguring||this.updateDate(this.date)}},{key:"dayCount",get:function(){return this.endDayOfMonth+1-this.startDayOfMonth}},{key:"weekCount",get:function(){return this.dayCount/7}},{key:"startDate",get:function(){var e=this;if(null!=e.year&&null!=e.month&&null!=e.startDayOfMonth)return new Date(e.year,e.month,e.startDayOfMonth)}},{key:"endDate",get:function(){var e=this;if(null!=e.year&&null!=e.month&&null!=e.startDayOfMonth)return new Date(e.year,e.month,e.endDayOfMonth)}},{key:"eachDay",value:function(e){for(var t=this.startDayOfMonth;t<=this.endDayOfMonth;t++)e(new Date(this.year,this.month,t))}},{key:"eachWeek",value:function(e){for(var t=this,n=t.weekCount,r=t.startDayOfMonth,i=0;i<n;i++){for(var o=[],a=t.getWeekNumber(new Date(t.year,t.month,r)),s=0;s<7;s++,r++)o.push(new Date(t.year,t.month,r));e(a,o)}}},{key:"getWeekNumber",value:function(e){var t=this;if((e=Un.clearTime(e)).getFullYear()!==t.year)return t.getOtherMonth(new Date(e.getFullYear(),0,1)).getWeekNumber(e);var n=Math.floor(Un.diff(t.weekBase,e,"day")/7),r=e.getFullYear();return n?(53!==n||t.has53weeks?n>53&&(n%=52):(n=1,r++),[r,n]):t.getOtherMonth(new Date(t.year-1,0,1)).getWeekNumber(new Date(t.year,0,0))}},{key:"getWeekId",value:function(e){var t=this.getWeekNumber(e);return 100*t[0]+t[1]}},{key:"getCellData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dh.MIDNIGHT,r=this,i=e.getDay(),o=r.visibleDayColumnIndex[i],a=r.nonWorkingDays[i],s=r.hideNonWorkingDays&&a;return(e<r.startDate||e>r.endDate)&&(r.month=e.getMonth()),{day:i,dayTime:n,visibleColumnIndex:o,isNonWorking:a,week:r.getOtherMonth(e).getWeekNumber(e),key:Un.format(e,"YYYY-MM-DD"),columnIndex:r.dayColumnIndex[i],date:new Date(e),isOtherMonth:Math.sign(e.getMonth()+12*e.getFullYear()-(t.month+12*t.year)),visible:!s&&e>=t.startDate&&e<Un.add(t.endDate,1,"day"),tomorrow:n.dayOfDate(Un.add(e,1,"day")),isRowStart:0===o,isRowEnd:o===r.visibleColumnCount-1}}},{key:"updateDayNumbers",value:function(){for(var e=this,t=e.weekStartDay,n=e.nonWorkingDays,r=e.hideNonWorkingDays,i=e.dayColumnIndex=[],o=e.canonicalDayNumbers=[],a=e.visibleDayColumnIndex=[],s=0,l=0;l<7;l++){var u=(t+l)%7;o[l]=u,i[u]=l,r&&n[u]||(a[u]=s++)}e.visibleColumnCount=s,e.weekLength=r?7-Qn.keys(n).length:7}}],[{key:"configurable",get:function(){return{date:{$config:{equal:"date"},value:Un.clearTime(new Date)},month:null,year:null,weekStartDay:null,hideNonWorkingDays:null,nonWorkingDays:null,sixWeeks:null}}}]),n}(Ot($e)),Mh=new Oh(null);Oh._$name="Month";var Ah=0,Ih=new WeakMap,Ph=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){var t;return e&&"object"==I()(e)||"function"==typeof e?void 0===(t=Ih.get(e))&&(t=++Ah,Ih.set(e,t)):t=String(e),t})).join("-")},Fh=function(e){var t=new Map;return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=Ph(r),a=t.get(o);return void 0===a&&(a=e.apply(void 0,r),t.set(o,a)),a}},Lh=function(e){var t=new Map,n=function(e){return e[0]},r=function(e){return e[1]},i=function(e,t){return n(e).push(t)};return function(o,a){var s=function(e){var n=t.get(e);return void 0===n&&(n=[[],[]],t.set(e,n)),n}(o);!function(e){return!r(e).length&&!n(e).length}(s)?(i(s,a),r(s).forEach((function(e){return a(e)}))):(i(s,a),e(o,(function(e){(function(e,t){return r(e).some((function(e){return Qn.isEqual(e,t)}))})(s,e)||(!function(e,t){r(e).push(t)}(s,e),n(s).forEach((function(t){return t(e)})))})))}},Bh=Symbol("success"),jh=Symbol("failure"),_h=function(e,t){return[Bh,e,t]},Hh=function(e){return[jh,e]},Nh=function(e){return e.length&&e[0]===Bh},zh=function(e){return"function"!=typeof e||e.length?e:e()},Vh=Fh((function(e){return Lh((function(t,n){return n(_h(e,t))}))})),Wh=Fh((function(e){return Lh((function(t,n){var r=Math.min(e.length,t.length),i=t.substr(0,r),o=t.substr(r);n(i===e?_h(i,o):Hh(o))}))})),$h=function(e,t){return function(n,r){return zh(e)(n,(function(e){if(Nh(e)){var n=N()(e,3),i=n[1],o=n[2];t(i)(o,r)}else r(e)}))}},Uh=Fh((function(){for(var e=Fh((function(e,t){return Lh($h(e,(function(e){return $h(t,(function(t){return Vh([].concat(e,t))}))})))})),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce(e,Vh([]))})),Gh=Fh((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Lh((function(e,n){return t.forEach((function(t){return zh(t)(e,n)}))}))})),Yh=Fh((function(e){return function(t,n){var r=new RegExp("^".concat(e)).exec(t);if(r){var i=r[0],o=t.substr(i.length);n(_h(i,o))}else n(Hh(t))}})),qh=Fh((function(e,t){return $h(e,(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Vh(t.apply(void 0,F()([].concat.apply([],n))))}))})),Kh=function(e,t){var n=[];return e(t,(function(e){Nh(e)&&(""===N()(e,3)[2]&&n.push(e))})),n},Xh={memo:Fh,memoCps:Lh,success:_h,failure:Hh,isSuccess:Nh,resolveParser:zh,succeed:Vh,string:Wh,bind:$h,seq:Uh,alt:Gh,regexp:Yh,red:qh,runParser:Kh,defineParser:function(e){return function(t,n){return n?zh(e)(t,n):Kh(zh(e),t)}}};function Zh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Jh=function(e,t){return(e.weight||0)-(t.weight||0)},Qh=function(e,t){return(t.weight||0)-(e.weight||0)},ev={align:!0,weight:!0},tv=function(e){Ye()(n,e);var t=Zh(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"doDestroy",value:function(){var e,t,r=this,i=r.triggers,o=r.isPainted&&n.getSharedErrorTooltip(r.rootElement,!0);if(null===(e=r.inputListenerRemover)||void 0===e||e.call(r),null===(t=r.keyListenerRemover)||void 0===t||t.call(r),tt()(Ze()(n.prototype),"doDestroy",this).call(this),i)for(var a=0,s=Object.values(i);a<s.length;a++){s[a].destroy()}(null==o?void 0:o.field)===r&&o.hide()}},{key:"invalidValueError",get:function(){return"L{invalidValue}"}},{key:"errorTip",get:function(){return this.constructor.getSharedErrorTooltip(this.rootElement)}},{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e);var t=this;t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}},{key:"onFocusIn",value:function(e){var t=this;t.valueOnFocus=Qn.clone(t.value),t.validOnFocus=!(t.errors&&Object.keys(t.errors).length),tt()(Ze()(n.prototype),"onFocusIn",this).call(this,e)}},{key:"onFocusOut",value:function(e){tt()(Ze()(n.prototype),"onFocusOut",this).call(this,e),this.syncRequired(),this.onEditComplete()}},{key:"onEditComplete",value:function(){}},{key:"compose",value:function(){this.getConfig("clearable");var e=this.id,t=this.innerElements,n=this.label,r=this.labels,i=void 0===r?[]:r,o=this.labelCls,a=this.readOnly,s=this.triggers,l=Qn.values(s,(function(e,t){return!t})),u=l.filter((function(e){return"start"===e.align})).sort(Jh),c=l.filter((function(e){return"start"!==e.align})).sort(Qh),f=function(t){return Qn.assign({tag:"label",for:"".concat(e,"-input"),class:"b-label b-align-".concat(t.align||"start")},t)};return{class:{"b-has-label":Boolean(n)||i.length,"b-has-start-trigger":u.length,"b-readonly":a},children:[].concat(F()(i.filter((function(e){return e&&"end"!==e.align})).map(f)),[n?f({reference:"labelElement",class:"b-label b-align-start ".concat(o||""),html:n}):null,{class:"b-field-inner",reference:"inputWrap",children:[].concat(F()(u.map((function(e){return e.element}))),F()(t),F()(c.map((function(e){return e.element}))))}],F()(i.filter((function(e){return"end"===(null==e?void 0:e.align)})).map(f)))}}},{key:"updateElement",value:function(e,t){var r,i=this,o=i.initialConfig.value,a=i.input;tt()(Ze()(n.prototype),"updateElement",this).call(this,e,t),null!=o&&(i.value=o),i.syncEmpty(),i.updateInputReadOnly(i.inputReadOnly),i.syncInvalid();var s=a||i.focusElement;null===(r=i.keyListenerRemover)||void 0===r||r.call(i),i.keyListenerRemover=s&&Tu.on({element:s,thisObj:i,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}},{key:"innerElements",get:function(){return[this.inputElement]}},{key:"inputElement",get:function(){var e=this.attributes,t=this.inputAttributes,n=this.id,r=this.inputCls,i=this.inputType,o=this.name,a=Qn.assign({reference:"input",tag:"input",type:i,name:o||n,id:"".concat(n,"-input"),retainElement:!0},t);r&&(a.class=r);for(var s,l,u=e.length;u-- >0;)null!=(l=this[s=e[u]])&&(a[s]=l);return a}},{key:"caretPos",get:function(){return this.textSelection[0]},set:function(e){this.textSelection=e}},{key:"focusElement",get:function(){return this.input}},{key:"textSelection",get:function(){var e,t=this.input;try{e=[t.selectionStart,t.selectionEnd,t.selectionDirection]}catch(n){e=[e=(e=t.value)?e.length:0,e]}return e},set:function(e){"number"==typeof e?this.select(e,e):this.select.apply(this,F()(e))}},{key:"hasTextSelection",get:function(){var e=N()(this.textSelection,2),t=e[0],n=e[1];return t&&n-t>0}},{key:"getAfterValue",value:function(e){var t=N()(this.textSelection,2),n=t[0],r=t[1],i=this.input.value;return"".concat(i.substr(0,n)).concat(e).concat(i.substr(r||n))}},{key:"select",value:function(e,t){var n=this.focusElement;if(n.value.length){if(0===arguments.length)return void this.selectAll();if(!this.supportsTextSelection)return;pe.a.isIE11?(n.focus(),n.setSelectionRange(e,t)):n.setSelectionRange(e,t)}}},{key:"moveCaretToEnd",value:function(){var e=this.input;if(e.createTextRange){var t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}},{key:"selectAll",value:function(){this.focusElement.select()}},{key:"syncEmpty",value:function(){var e=this.isEmptyInput,t=this.isEmpty,n=this.element,r=this.clearIcon,i=e&&t;n&&(r&&r.classList[i?"add":"remove"]("b-icon-hidden"),n.classList[i?"add":"remove"]("b-empty"))}},{key:"updateHint",value:function(){this.syncHint()}},{key:"updateHintHtml",value:function(){this.syncHint()}},{key:"syncHint",value:function(){var e=this,t=e.input,n=e.hint,r=e.hintHtml,i=null==t?void 0:t.parentElement;if(t){var o=r||n,a=e.hintElement||o&&(e.hintElement=mi.createElement({parent:i,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));a&&("function"==typeof o&&(o=o({source:e,value:e.value})),a.firstChild[r?"innerHTML":"textContent"]=o||""),e.element.classList[o?"remove":"add"]("b-field-no-hint")}}},{key:"syncInvalid",value:function(){if(this.updatingInvalid=!0,this.isPainted){var e=this.isValid,t=this.element,n=this.inputWrap,r=this.errorTip;t.classList[e?"remove":"add"]("b-invalid"),e?null!=r&&r.isVisible&&r.field===this&&r.hide():r&&n.contains(kh.currentOverElement)&&(r.activeTarget===n&&r.isVisible?r.onBeforeShow():(r.activeTarget=n,r.showBy(n)))}this.updatingInvalid=!1}},{key:"updateEditable",value:function(){this.syncInputReadOnly()}},{key:"syncInputReadOnly",value:function(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||!1===this.editable}},{key:"updateInputReadOnly",value:function(e){var t=this,n=t.input,r=t.inputListenerRemover;n&&(n.readOnly=e?"readOnly":null,e?t.inputListenerRemover=null==r?void 0:r():r||(t.inputListenerRemover=Tu.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}},{key:"changeReadOnly",value:function(e){return Boolean(e)}},{key:"updateReadOnly",value:function(e){this.syncInputReadOnly()}},{key:"updateClearable",value:function(e){var t=this;t.getConfig("triggers"),t.triggers={clear:e&&Qn.assign({cls:"b-icon-remove",weight:1e3,handler:function(){t._isUserAction=!0,t.clear(),t._isUserAction=!1}},e)||null}}},{key:"changeTriggers",value:function(e,t){var r=this,i=r.$triggers||(r.$triggers=new Dc({configName:"triggers",factory:n.Trigger,inferType:!1,owner:r,created:function(e){at.after(e,"onConfigChange",(function(e,t){var n=t.name;ev[n]&&r.onConfigChange({name:"triggers",value:i.target})}))},setup:function(e,t){e.reference=e.ref=t,e.parent=r}}));if(!1===r.stepTriggers&&(e.back||e.forward)&&(delete(e=Qn.assign({},e)).back,delete e.forward),i.update(e),!t)return i.target}},{key:"updateLabelWidth",value:function(e){this.labelElement&&(this.labelElement.style.flex="0 0 ".concat(mi.setLength(e)),this.inputWrap.style.flexBasis=null==e?"":0)}},{key:"updateInputWidth",value:function(e){this.input.style.width=mi.setLength(e),pe.a.isIE11&&(this.input.parentElement.style.flexBasis=this.input.style.width),this.element.classList.add("b-has-width")}},{key:"updateInputAlign",value:function(e){this.input.style.textAlign=e}},{key:"changeLabel",value:function(e){return null==e?"":e}},{key:"updateLabel",value:function(e){this.labelElement&&(this.labelElement.innerHTML=e)}},{key:"updateLabelPosition",value:function(e,t){var n=this.element.classList;n.remove("b-label-".concat(t)),n.add("b-label-".concat(e))}},{key:"isValid",get:function(){var e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;var t=e.validity;if(t)return t.valid}return!0}},{key:"isEmpty",get:function(){return null==this.value||""===this.value}},{key:"isEmptyInput",get:function(){return!this.input||null==this.input.value||""===this.input.value}},{key:"validity",get:function(){var e=this.input;return e&&e.validity}},{key:"changeValue",value:function(e,t){return null==e&&(e=this.nullValue),this.hasChanged(t,e)?e:(""===e&&this.syncRequired(),t)}},{key:"updateValue",value:function(e,t){var n=this;n.isConfiguring||(n.syncRequired(),n.inputting||n.triggerChange()),n.inputting||(n._lastValue=e),n.syncInputFieldValue()}},{key:"hasChanged",value:function(e,t){return t!==e}},{key:"syncInputFieldValue",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this,r=n.input,i=n.parent,o=n.inputValueAttr,a=n.inputValue;r&&!n.inputting&&r[o]!==a&&(r[o]=a,n.isConfiguring||n.containsFocus||!n.highlightExternalChange||(r.classList.remove("b-field-updated"),n.clearTimeout("removeUpdatedCls"),t||i&&(i.isSettingValues||null!==(e=i._isSettingValues)&&void 0!==e&&e.preventHighlight)||n.highlightChanged()));n.syncEmpty(),n.syncInvalid()}},{key:"highlightChanged",value:function(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}},{key:"removeUpdatedCls",value:function(){this.input.classList.remove("b-field-updated")}},{key:"inputValue",get:function(){return null==this.value?"":this.value}},{key:"inputValueAttr",get:function(){return"value"}},{key:"supportsTextSelection",get:function(){var e=this.focusElement;return e&&("textarea"===e.tagName.toLowerCase()||e.type&&(/text|search|password|tel|url/.test(e.type)||pe.a.isEdge))}},{key:"internalOnInputFocus",value:function(){var e=this,t=e.input.value.length;pe.a.isIE11&&t&&!e.autoSelect&&e.select(t,t),e.autoSelect&&e.selectAll()}},{key:"internalOnChange",value:function(e){var t=this;t.isValid&&t.hasChanged(t._lastValue,t.value)&&(t.triggerChange(e,!0),t._lastValue=t.value)}},{key:"triggerChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Boolean(this._isUserAction),n=this,r=n.value,i=n._lastValue,o=n.isValid;n.syncHint(),n.triggerFieldChange({value:r,oldValue:i,event:e,userAction:t,valid:o}),"change"===n.defaultAction&&n.trigger("action",{value:r,oldValue:i,event:e,userAction:t,valid:o})}},{key:"internalOnInput",value:function(e){var t,n=this;n.inputting=!0,n.value=n.input.value,n.inputting=!1,n.trigger("input",{value:n.value,event:e}),null===(t=n.changeOnKeyStroke)||void 0===t||t.call(n,e)}},{key:"internalOnKeyEvent",value:function(e){var t=this,n=t.value,r=!1;if("keydown"===e.type)if("Escape"!==e.key||t.readOnly||t.disabled)"Enter"===e.key&&pe.a.isIE11&&t.internalOnChange(e);else{var i=t.isValid,o="initialValue"in t?t.initialValue:t.valueOnFocus,a=t.hasChanged(o,n),s=t.input.value!==String(t.inputValue);t.revertOnEscape&&(!i||a||s)?(a&&(t.value=o),s&&t.syncInputFieldValue(!0),t.clearError(),r=a&&t.isValid||i!==t.validOnFocus):t.clearable&&(n||t.input.value)&&t.clear()}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}},{key:"clear",value:function(){this.value=this.nullValue,this.trigger("clear")}},{key:"onDisabled",value:function(){this.syncInvalid()}},{key:"syncRequired",value:function(){var e,t=this;t.isConfiguring||!t.required||!t.isEmpty||null!==(e=t.parent)&&void 0!==e&&e.isSettingValues?t.clearError("L{fieldRequired}",t.updatingInvalid):t.setError("L{fieldRequired}",t.updatingInvalid)}},{key:"setError",value:function(e,t){(this.errors||(this.errors={}))[this.optionalL(e)]=1,t||this.syncInvalid()}},{key:"clearError",value:function(e,t){var n=this;n.errors&&(e?delete this.errors[this.optionalL(e)]:n.errors={},t||n.syncInvalid())}},{key:"getErrors",value:function(){var e=this;if(!e.isValid){var t,n=e.validity,r=Qn.keys(n).find((function(e){return"valid"!==e&&"customError"!==e&&n[e]})),i=e.errors&&Object.keys(e.errors);if((t=null!=i&&i.length?i:n.customError?[e.input.validationMessage]:r?[e.L(r,{min:e.min,max:e.max})]:[e.L(e.invalidValueError)])&&t.length>0)return t}}}],[{key:"$name",get:function(){return"Field"}},{key:"type",get:function(){return"field"}},{key:"configurable",get:function(){return{placeholder:null,value:"",name:null,label:null,labelPosition:"before",labelCls:null,labels:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}},required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",inputAttributes:null,inputType:"text",inputAlign:null,attributes:{value:["placeholder","autoComplete","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,testConfig:{updatedClsDuration:10}}}},{key:"delayable",get:function(){return{highlightChanged:"raf"}}},{key:"getSharedErrorTooltip",value:function(e,t){var n,r=null===(n=e.bryntum)||void 0===n?void 0:n.errorTooltip;return r||t||(e.bryntum=e.bryntum||{},r=new kh({cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:"l-r",scrollAction:"realign",rootElement:e,onBeforeShow:function(){var e=this,t=uc.fromElement(e.activeTarget);if(t){var n=t.getErrors();if(n)return e.html=n.join("<br>"),e.field=t,!0}return!1}}),e.bryntum.errorTooltip=r),r}},{key:"errorTip",get:function(){return this.getSharedErrorTooltip(document.body)}}]),n}(uc.mixin(Kc));function nv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}tv.Trigger=function(e){Ye()(n,e);var t=Zh(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"field",get:function(){return this.parent}},{key:"compose",value:function(){var e;return{class:(e={},Qe()(e,"b-align-".concat(this.align||"end"),1),Qe()(e,"b-icon",1),e),listeners:{click:"onClick",mousedown:"onMousedown"}}}},{key:"changeAlign",value:function(e){return e}},{key:"onClick",value:function(e){var t=this,n=t.field,r="function"==typeof t.handler?t.handler:n[t.handler];n.disabled||n.readOnly||!1!==n.trigger("trigger",{trigger:t})&&(null==r||r.call(n,e))}},{key:"onMousedown",value:function(e){var t=this.field;!("key"in e)&&mi.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout((function(){return t.editable=!0}),500)),e.preventDefault(),mi.getActiveElement(t.input)!==t.input&&t.focus()}}],[{key:"$name",get:function(){return"FieldTrigger"}},{key:"factoryable",get:function(){return{defaultType:tv.Trigger,extends:null}}},{key:"type",get:function(){return"trigger"}},{key:"configurable",get:function(){return{align:null,weight:null}}}]),n}(uc),tv.SpinTrigger=function(e){Ye()(n,e);var t=Zh(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){return{children:{upButton:{class:{"b-icon":1,"b-spin-up":1}},downButton:{class:{"b-icon":1,"b-spin-down":1}}}}}},{key:"updateRepeat",value:function(e){var t;null===(t=this.clickRepeater)||void 0===t||t.destroy(),this.clickRepeater=e?Oc.new({element:this.element},e):null}},{key:"onClick",value:function(e){var t=this,n=t.field;n.disabled||n.readOnly||(e.target===t.upButton?n.doSpinUp(e.shiftKey):e.target===t.downButton&&n.doSpinDown(e.shiftKey))}}],[{key:"$name",get:function(){return"SpinTrigger"}},{key:"type",get:function(){return"spintrigger"}},{key:"configurable",get:function(){return{repeat:{$config:["nullify"],value:!0}}}}]),n}(tv.Trigger),tv.Trigger.initClass(),tv.SpinTrigger.initClass(),uc.register(tv.Trigger,"trigger"),uc.register(tv.SpinTrigger,"spintrigger"),tv._$name="Field";var rv=function(e){Ye()(n,e);var t=nv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){"hidden"===e.inputType&&(e.hidden=!0),tt()(Ze()(n.prototype),"construct",this).apply(this,arguments)}}],[{key:"type",get:function(){return"textfield"}},{key:"alias",get:function(){return"text"}},{key:"configurable",get:function(){return{nullValue:""}}},{key:"$name",get:function(){return"TextField"}}]),n}(tv);function iv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}rv.initClass(),rv._$name="TextField";var ov=function(e){Ye()(n,e);var t=iv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"doDestroy",value:function(){var e;null===(e=this.globalTapListener)||void 0===e||e.call(this),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"updateEditable",value:function(e){var t,r=this,i=r.element;(tt()(Ze()(n.prototype),"updateEditable",this).apply(this,arguments),!1===e)?(null===(t=r.globalTapListener)||void 0===t||t.call(r),i.classList.add("b-not-editable"),Tu.on({element:r.input,click:"onTriggerClick",thisObj:r})):r.globalTapListener=Fi.on({globaltap:"showKeyboard",thisObj:r})}},{key:"changePicker",value:function(e,t){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}},{key:"childItems",get:function(){if(this._picker)return[this.picker]}},{key:"onEditComplete",value:function(){tt()(Ze()(n.prototype),"onEditComplete",this).call(this),this.autoClosePicker()}},{key:"onElementResize",value:function(e){var t=this;t.pickerVisible&&t.picker.requestAnimationFrame(t.picker.realign,null,t.picker),tt()(Ze()(n.prototype),"onElementResize",this).call(this,e)}},{key:"internalOnKeyEvent",value:function(e){var t=this,r=!0;if("keydown"===e.type&&!t.disabled)if(t.pickerVisible){var i=t.picker;"Escape"===e.key?(e.stopImmediatePropagation(),t.hidePicker(),r=!1):i.onInternalKeyDown?i.onInternalKeyDown(e):"ArrowDown"===e.key&&i.focusable&&i.focus()}else"ArrowDown"===e.key&&(e.stopImmediatePropagation(),e.preventDefault(),t.onTriggerClick(e));r&&tt()(Ze()(n.prototype),"internalOnKeyEvent",this).call(this,e)}},{key:"onFocusIn",value:function(e){tt()(Ze()(n.prototype),"onFocusIn",this).call(this,e),this.autoExpand&&(this.minChars=0,this.onTriggerClick(e))}},{key:"onFocusOut",value:function(e){this.autoClosePicker(),tt()(Ze()(n.prototype),"onFocusOut",this).call(this,e)}},{key:"onTriggerClick",value:function(e){this.disabled||this.togglePicker("key"in e)}},{key:"showKeyboard",value:function(e){var t=e.event,n=this.input;mi.isTouchEvent&&mi.getActiveElement(n)===n&&t.target===n&&(Fi.suspendFocusEvents(),n.blur(),n.focus(),Fi.resumeFocusEvents())}},{key:"togglePicker",value:function(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}},{key:"showPicker",value:function(e){var t=this,n=t.picker;t.pickerHideShowListenersAdded||(n.on({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),n.autoClose=t.autoClose,n.show(),n.isVisible&&e&&t.focusPicker()}},{key:"onPickerShow",value:function(){var e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=Fi.on({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=Tu.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}},{key:"onPickerHide",value:function(){var e=this;e.pickerVisible=!1,e.element.classList.remove("b-open"),e.trigger("togglePicker",{show:!1}),e.pickerTapOutRemover&&e.pickerTapOutRemover(),e.pickerKeyDownRemover&&e.pickerKeyDownRemover()}},{key:"onPickerTapOut",value:function(e){var t=e.event;this.owns(t.target)||this.autoClosePicker()}},{key:"onPickerKeyDown",value:function(e){if("Tab"===e.key){var t=mi.getActiveElement(this.input),n=new KeyboardEvent("keydown",e);this.input.dispatchEvent(n),n.defaultPrevented&&e.preventDefault(),mi.getActiveElement(this.input)===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}},{key:"autoClosePicker",value:function(){this.autoClose&&this.hidePicker()}},{key:"hidePicker",value:function(){this.pickerVisible&&this.picker.hide()}},{key:"focusPicker",value:function(){}},{key:"focus",value:function(){var e=this.input;mi.isTouchEvent&&this.editable&&(e.readOnly=!0,this.setTimeout((function(){return e.readOnly=!1}),500)),tt()(Ze()(n.prototype),"focus",this).call(this)}}],[{key:"$name",get:function(){return"PickerField"}},{key:"type",get:function(){return"pickerfield"}},{key:"configurable",get:function(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:["lazy","nullify"]},inputType:"text",monitorResize:!0,nullValue:null}}}]),n}(rv);ov._$name="PickerField";var av=n(92),sv=n.n(av);function lv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var uv,cv,fv=function(e){Ye()(n,e);var t=lv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateOwnerCmp",value:function(e){this.itemSelector||(this.itemSelector=".".concat(this.ownerCmp.itemCls))}},{key:"onKeyDown",value:function(e){var t=this,n=t.ownerCmp,r=t.itemSelector,i=t.activeItem,o=t.itemsTabbable,a=e.target,s=t.target.querySelector(r),l=(e.key||"").trim()||e.code,u="".concat(e.ctrlKey?"CTRL+":"").concat(e.shiftKey?"SHIFT+":"").concat(e.altKey?"ALT+":"").concat(l),c=a.matches(r)||a===t.keyEventTarget;if(!t.disabled&&s&&t.target.offsetParent&&c){if(!o){if(null==t.inlineFlow){var f=s.parentNode,d=mi.getStyleValue(s,"position"),h=mi.getStyleValue(s,"display"),v=mi.getStyleValue(s,"float");t.inlineFlow="absolute"===d||"inline"===h||"inline-block"===h||"left"===v||"right"===v||"flex"===mi.getStyleValue(f,"display")&&"row"===mi.getStyleValue(f,"flex-direction")}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.processEvent&&!(e=t.processEvent.call(n,e)))return;if(i)switch(l){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),t.navigateNext(e);break;default:var p=t.keys&&t.keys[u];if(p&&!t.disabled?t.callback(p,t.thisObj||n,[e]):n.onInternalKeyDown&&n.onInternalKeyDown(e),mi.getActiveElement(a)!==a&&e.preventDefault(),o)return}else{if(o)return;t.activeItem=t.previousActiveItem||t.getDefaultNavigationItem(e)}t.activeItem!==i&&t.triggerNavigate(e)}}},{key:"getDefaultNavigationItem",value:function(e){var t=this.target,n=this.itemSelector,r=this.prevKey,i=this.nextKey;return 4&t.compareDocumentPosition(e.target)&&e.key===r?t.querySelector("".concat(n,":last-of-type")):2&t.compareDocumentPosition(e.target)&&e.key===i?t.querySelector("".concat(n)):void 0}},{key:"navigatePrevious",value:function(e){var t=this,n=t.previous;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((function(){t.activeItem=n,t.triggerNavigate(e)}))}},{key:"navigateNext",value:function(e){var t=this,n=t.next;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((function(){t.activeItem=n,t.triggerNavigate(e)}))}},{key:"owner",get:function(){return this.ownerCmp}},{key:"previous",get:function(){return this.getAdjacent(-1)}},{key:"next",get:function(){return this.getAdjacent(1)}},{key:"getAdjacent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeItem,n=this.treeWalker;if(n.currentNode=t,n[e<0?"previousNode":"nextNode"](),n.currentNode!==this.activeItem)return n.currentNode}},{key:"onTargetFocusIn",value:function(e){var t=this,n=e.target,r=t.itemsTabbable,i=t.skipScrollIntoView;if(!n.matches(".b-focus-trap"))if(n.matches(t.itemSelector))t.skipScrollIntoView=!0,t.activeItem=n,t.skipScrollIntoView=i,t.activeItem&&r&&t.triggerNavigate(e);else{var o,a,s,l=uc.fromElement(e.target);if(!l||!t.owner.owns(l))if(!r&&null!==(o=e.relatedTarget)&&void 0!==o&&null!==(a=o.matches)&&void 0!==a&&a.call(o,t.itemSelector))null===(s=t.owner.previousSibling)||void 0===s||s.focus()}}},{key:"onTargetFocusOut",value:function(e){var t=this,n=e.relatedTarget;null!=n&&n.matches(".b-focus-trap")||n&&t.target.contains(n)&&n.matches(t.itemSelector)||t.activeItem&&(t.activeItem=null,t.itemsTabbable&&t.triggerNavigate(e))}},{key:"onTargetMouseDown",value:function(e){var t=this,n=e.target.closest(t.itemSelector);t.mouseDownEvent=e,!1===t.ownerCmp.itemsFocusable?t.onFocusGesture(e):n&&(e.preventDefault(),mi.focusWithoutScrolling(n))}},{key:"onTargetClick",value:function(e){var t,n=this,r=n.skipScrollIntoView;n.skipNextClick||null!==(t=n.mouseDownEvent)&&void 0!==t&&t.ignoreNavigation?n.skipNextClick=!1:n.disabled||(n.skipScrollIntoView=!0,n.processEvent&&(e=n.processEvent.call(n.ownerCmp,e)),e&&(n.activeItem=e.target.closest(n.itemSelector),n.triggerNavigate(e)),n.skipScrollIntoView=r)}},{key:"onFocusGesture",value:function(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&!1===this.ownerCmp.itemsFocusable)&&e.preventDefault()}},{key:"acceptNode",value:function(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},{key:"changeActiveItem",value:function(e){return null!=e&&this.ownerCmp.getItem&&(e=this.ownerCmp.getItem(e)),e}},{key:"updateActiveItem",value:function(e,t){var n=this,r=n.ownerCmp,i=t&&n.target.contains(t);if(i&&(n.previousActiveItem=t),null!=e){if(n.skipScrollIntoView||r.scrollable.scrollIntoView(e,{block:"nearest",focus:mi.isFocusable(e)&&e!==mi.getActiveElement(e),silent:n.scrollSilently}),e===t&&i)return;t&&t.classList.remove(n.focusCls),e.classList.add(n.focusCls),n._activeItem=e}else t&&(t.classList.remove(n.focusCls),t===mi.getActiveElement(t)&&r.revertFocus()),n._activeItem=null}},{key:"updateTarget",value:function(e,t){var n=this,r={element:e,thisObj:n,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut"};n.itemsTabbable||(r.mousedown="onTargetMouseDown",r.click="onTargetClick"),Object.prototype.hasOwnProperty.call(n,"acceptNode")||(n.acceptNode=n.acceptNode.bind(n),n.acceptNode.acceptNode=n.acceptNode),Tu.on(r),n.treeWalker=n.setupTreeWalker(e,NodeFilter.SHOW_ELEMENT,n.acceptNode,!1),n.keyEventTarget||(n.keyEventTarget=e),(n.targetMutationMonitor=new MutationObserver(n.onTargetChildListChange.bind(n))).observe(e,{childList:!0,subtree:!0})}},{key:"setupTreeWalker",value:function(e,t,n,r){return document.createTreeWalker(e,t,n,r)}},{key:"onTargetChildListChange",value:function(){var e=this.activeItem;e&&(this.target.contains(e)?e.classList.add(this.focusCls):this.activeItem=this.target.querySelector("".concat(this.itemSelector,'[data-id="').concat(e.dataset.id,'"]'))||null)}},{key:"changeKeyEventTarget",value:function(e){this._keyEventTarget=e,Tu.on({element:e,keydown:"onKeyDown",thisObj:this})}},{key:"triggerNavigate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeItem,r={event:e,item:n,oldItem:this.previousActiveItem};this.trigger("navigate",r),null===(t=this.ownerCmp)||void 0===t||t.trigger("navigate",r)}}],[{key:"configurable",get:function(){return{ownerCmp:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,testConfig:{scrollDuration:1}}}}]),n}(Ot($e));function dv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return hv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hv(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fv._$name="Navigator";var pv,gv=document.createRange(),yv=function(e){Ye()(n,e);var t=vv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t,r=this;Array.isArray(e)&&(e={items:e});for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(t=tt()(Ze()(n.prototype),"construct",this)).call.apply(t,[this,e].concat(o));var s=r.element,l=s.classList;r.multiSelect&&l.add("b-multiselect"),r.store&&r.store.count?r.refresh():l.add("b-empty"),r.store.isGrouped&&(l.add("b-grouped"),r.store.on({groupchange:function(){return r.refresh()},thisObj:r})),Tu.on({element:s,delegate:r.itemSelector,mouseover:"onMouseOver",click:"onClick",thisObj:r})}},{key:"doDestroy",value:function(){var e;this.detachListeners("store"),null===(e=this.navigator)||void 0===e||e.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"onFocusIn",value:function(e){var t=e._target.classList.contains(this.itemCls)?e._target.dataset.id:0;this.restoreActiveItem(this.navigator.previousActiveItem||this.getItem(t)),tt()(Ze()(n.prototype),"onFocusIn",this).call(this,e)}},{key:"contentTpl",value:function(){var e=this,t=e.store.records.map((function(t,n){return e.itemWrapperTpl(t,n)}));return e.multiSelect&&!1!==e.selectAllItem&&t.unshift(e.selectAllItemTpl()),ud.tpl(uv||(uv=sv()(["",""])),t)}},{key:"itemWrapperTpl",value:function(e,t){return ud.tpl(cv||(cv=sv()(['<div class="','" data-index="','" data-id="','" ',">\n            ","\n            </div>"])),this.getItemClasses(e,t),t,te.encodeHtml(e.id),this.itemsFocusable?'tabindex="-1"':"",this.itemContentTpl(e,t))}},{key:"itemContentTpl",value:function(e,t){return"groupRowFor"in e.meta?this.groupHeaderTpl(e,te.capitalize(e.groupChildren[0][e.meta.groupField])):"".concat(this.itemIconTpl(e,t)).concat(this.itemTpl(e,t))}},{key:"itemIconTpl",value:function(e,t){return this.multiSelect?'<div class="b-selected-icon b-icon '.concat(this.selectIconCls,'"></div>'):""}},{key:"selectAllItemTpl",value:function(){return'<div class="'.concat(this.itemCls,' b-select-all-item" data-noselect data-select-all data-id="select-all">').concat(this.itemIconTpl(),"<div>").concat(this.optionalL("Select All"),"</div></div>")}},{key:"getItemClasses",value:function(e){var t,n=this,r=null===(t=n._navigator)||void 0===t?void 0:t.activeItem,i=(null==r?void 0:r.dataset.id)==e.id,o="groupRowFor"in e.meta?"b-list-item-group-header":"",a=n.selected.includes(e);return"".concat(n.itemCls," ").concat(e.cls||""," ").concat(a?n.selectedCls:""," ").concat(i?n.navigator.focusCls:""," ").concat(o)}},{key:"onBeforeStoreLoad",value:function(){this.mask(this.L("L{loading}"))}},{key:"onAfterStoreRequest",value:function(){this.unmask()}},{key:"onStoreChange",value:function(e){e.source;var t=e.action,n=e.records,r=e.record,i=e.changes,o=this;switch(t){case"remove":o.selected.remove(n);break;case"clear":o.selected.clear();break;case"update":var a=i.id;return a&&mi.setAttributes(o.contentElement.querySelector('[data-id="'.concat(te.encodeHtml(a.oldValue),'"]')),{"data-id":a.value}),void o.refreshItem(r)}o.refresh()}},{key:"onStoreRefresh",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;if(e.isVisible){var t=e.navigator.activeItem;e.paintListener=null;var n=mi.createElementFromTemplate(e.contentTpl(),{fragment:!0});e.clearItems().insertNode(n),t&&e.restoreActiveItem(t),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty")}else e.paintListener||(e.paintListener=e.on({paint:"refresh",thisObj:e,once:!0}))}},{key:"clearItems",value:function(){var e=this,t=e.contentElement.querySelector(e.itemSelector),n=e.contentElement.lastChild;if(t){var r=e.contentElement.querySelectorAll("".concat(e.itemSelector,":not(.b-mask)"));gv.setStartBefore(t),gv.setEndAfter(r[r.length-1]),gv.deleteContents()}else n?(gv.setStartAfter(n),gv.setEndAfter(n)):(gv.setStart(e.contentElement,0),gv.setEnd(e.contentElement,0));return gv}},{key:"refreshItem",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r],a=this.getItem(o);if(a){var s=this.store.indexOf(o),l=mi.createElementFromTemplate(this.itemWrapperTpl(o,s));mi.sync(l,a)}}}},{key:"getItem",value:function(e){var t;if(null!=e)return"number"==typeof e?this.contentElement.querySelector('[data-index="'.concat(e,'"]')):(e.nodeType===Element.ELEMENT_NODE&&(e=e.dataset.id),null!=(null===(t=e)||void 0===t?void 0:t.id)&&(e=e.id),this.contentElement.querySelector('[data-id="'.concat(te.encodeHtml(e),'"]')))}},{key:"getRecord",value:function(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}},{key:"updateItems",value:function(e){var t=this;t.store&&t.store.autoCreated&&t.store.destroy(),t.store=ts.getStore(e)}},{key:"updateSelected",value:function(e){e&&e instanceof na||(e=new na(e)),this._selected=e,e.on({change:"onSelectionChange",thisObj:this})}},{key:"itemSelector",get:function(){return".".concat(this.itemCls)}},{key:"selected",get:function(){return this._selected}},{key:"store",get:function(){return this._thisIsAUsedExpression(this.items),this._store}},{key:"changeStore",value:function(e){if(e instanceof ts||(e=new ts(e)),this.detachListeners("store"),e){var t={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:this};e.readUrl&&(t.beforeLoad="onBeforeStoreLoad",t.afterRequest="onAfterStoreRequest"),e.on(t)}return e}},{key:"updateStore",value:function(){this.refresh()}},{key:"changeNavigator",value:function(e){var t=this.element;return t&&(e=(e.class||fv).new({ownerCmp:this,target:t,keyEventTarget:t},e)).keyEventTarget===t&&(t.tabIndex=0),e}},{key:"minAlignHeight",get:function(){var e=this.element.lastElementChild,t=this.minHeight;if(null!=t)return this.store.count?Math.min(e.offsetTop+e.offsetHeight,t):0}},{key:"alignTo",value:function(){var e;gh()(Ze()(n.prototype),"minHeight",this.minAlignHeight,this,!0);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=tt()(Ze()(n.prototype),"alignTo",this)).call.apply(e,[this].concat(r))}},{key:"hide",value:function(){var e;this.navigator.activeItem=null;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=tt()(Ze()(n.prototype),"hide",this)).call.apply(e,[this].concat(r))}},{key:"show",value:function(){var e=this.refreshCount,t=this.navigator.previousActiveItem;gh()(Ze()(n.prototype),"minHeight",this._minHeight,this,!0);var r=tt()(Ze()(n.prototype),"show",this).call(this);return this.refreshCount===e&&this.restoreActiveItem(t,!0),r}},{key:"restoreActiveItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.navigator.previousActiveItem,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nearest",n=this,r=n.navigator,i=n.lastAlignSpec;if(null!=e){if("string"!=typeof t){var o=i?i.zone:1;t=1&o?"nearest":o?"start":"end"}(e=n.getItem(e))&&(n.scrollable.scrollIntoView(e,{block:t}),r.activeItem=e)}}},{key:"onMouseOver",value:function(e){var t=this,n=e.currentTarget;!mi.isTouchEvent&&n&&t.navigator&&t.activateOnMouseover&&t.setTimeout({fn:"handleMouseOver",delay:30,args:[n],cancelOutstanding:!0})}},{key:"handleMouseOver",value:function(e){this.navigator.activeItem=e}},{key:"onClick",value:function(e){var t=e.target.closest(this.itemSelector);t&&this.onItemClick(t,e)}},{key:"onInternalKeyDown",value:function(e){var t=this.navigator.activeItem;switch(e.key){case" ":if("INPUT"===e.target.nodeName.toUpperCase()&&!e.target.readOnly)break;case"Enter":t&&(this.onItemClick(t,e),e.stopImmediatePropagation(),e.preventDefault())}}},{key:"onItemClick",value:function(e,t){var n=this,r=parseInt(e.dataset.index),i=n.store.getAt(r);if(n._isUserAction=!0,n.trigger("item",{item:e,record:i,index:r,event:t,userAction:!0}),n.allowGroupSelect||!i.isSpecialRow){if(e.contains(t.target.closest("[data-noselect]")))e.contains(t.target.closest("[data-select-all]"))&&n.onSelectAllClick(e,t);else{var o=n.selected,a=o.includes(i);n.multiSelect?(n.toggleAllIfCtrlPressed&&t.ctrlKey?i=n.store.getRange():n.allowGroupSelect&&i.isSpecialRow&&(a=!i.groupChildren.some((function(e){return!o.includes(e)})),i=i.groupChildren),o[a?"remove":"add"](i)):o.splice(0,o.count,i)}n.lastClicked=i,n._isUserAction=!1}}},{key:"onSelectionChange",value:function(e){var t,n,r=e.action,i=e.removed,o=e.added,a=(e.replaced,this),s=a.selectedCls,l=a.unselectedCls;if("clear"===r){var u,c=dv(a.element.querySelectorAll(".".concat(s)));try{for(c.s();!(u=c.n()).done;)(n=u.value).classList.remove(s),l&&n.classList.remove(l)}catch(e){c.e(e)}finally{c.f()}}else{var f,d=dv(i);try{for(d.s();!(f=d.n()).done;)t=f.value,(n=a.getItem(t))&&n.classList.remove(s)}catch(e){d.e(e)}finally{d.f()}var h,v=dv(o);try{for(v.s();!(h=v.n()).done;)t=h.value,(n=a.getItem(t))&&n.classList.add(s)}catch(e){v.e(e)}finally{v.f()}}a.selectAllItem&&a.updateSelectAllState()}},{key:"onSelectAllClick",value:function(e,t){var n=this,r=e.classList.contains(n.selectedCls);n.selected[r?"remove":"add"](n.store.getRange())}},{key:"updateSelectAllState",value:function(){var e=this,t=e.element.querySelector(".b-select-all-item"),n=e.selected.count===e.store.count?"add":"remove";t.classList[n](e.selectedCls)}}],[{key:"$name",get:function(){return"List"}},{key:"type",get:function(){return"list"}},{key:"configurable",get:function(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",items:null,store:null,navigator:!0,scrollable:{x:!1,y:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,selectAllItem:!1,itemTpl:function(e){return te.encodeHtml(e.text)},groupHeaderTpl:function(e,t){return te.encodeHtml(t)},allowGroupSelect:!0,selected:{},activateOnMouseover:null}}}]),n}(uc);function mv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}yv.initClass(),yv.prototype.navigatorClass=fv,yv._$name="List";var bv=function(e){Ye()(n,e);var t=mv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"itemContentTpl",value:function(e,t){var n=this;return ud.tpl(pv||(pv=sv()(["","\n            ","\n            ",""])),n.iconTpl?this.iconTpl(e):"",n.itemTpl(e,t),n.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':"")}},{key:"onInternalKeyDown",value:function(e){this.closable&&this.selected.count&&("Delete"===e.key||"Backspace"===e.key)?this.callback(this.closeHandler,this.owner,[this.selected.values,{isKeyEvent:!0}]):tt()(Ze()(n.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"updateClosable",value:function(e){this.element.classList[e?"add":"remove"]("b-chips-closable"),this.navigator.disabled=!e,this.isConfiguring||this.refresh()}},{key:"onClick",value:function(e){var t=this,r=e.target.closest(".".concat(t.itemCls));if(t.closable&&e.target.classList.contains("b-close-icon")){var i=t.store.getAt(parseInt(r.dataset.index));t.callback(t.closeHandler,t.owner,[[i]])}else tt()(Ze()(n.prototype),"onClick",this).call(this,e)}}],[{key:"$name",get:function(){return"ChipView"}},{key:"type",get:function(){return"chipview"}},{key:"configurable",get:function(){return{itemCls:"b-chip",closable:!0,iconTpl:null,closeHandler:null}}}]),n}(yv);function kv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bv.initClass(),bv._$name="ChipView";var Cv="L{Field.fieldRequired}",Rv="L{Field.validateFilter}",Sv=function(e){Ye()(n,e);var t=wv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}},{key:"startConfigure",value:function(e){this.usingRecordAsValue=null===e.valueField,tt()(Ze()(n.prototype),"startConfigure",this).apply(this,arguments)}},{key:"afterConfigure",value:function(){tt()(Ze()(n.prototype),"afterConfigure",this).call(this);var e=this;"_value"in e||(e._value=e.valueField===e.displayField?"":null,e._lastValue=e._lastValue||e._value)}},{key:"childItems",get:function(){var e=this._chipView,t=this._picker,n=[];return e&&n.push(e),t&&n.push(t),n}},{key:"innerElements",get:function(){var e,t=null===(e=this._chipView)||void 0===e?void 0:e.element,n=this.input,r=this.inputElement;return t&&du.sync({targetElement:n,domConfig:r}),[t||r]}},{key:"changeChipStore",value:function(e){return!e||e instanceof ts||(e=new ts(ts.mergeConfigs({storage:this.valueCollection},e))),e}},{key:"updateChipStore",value:function(e,t){null==t||t.destroy()}},{key:"changeChipView",value:function(e,t){var n=this;if(n.element.classList[e?"add":"remove"]("b-uses-chipview"),e){var r=n.input;return n.chipStore||(n.chipStore={}),xv.reconfigure(t,e,{defaults:{parent:n,insertBefore:r,store:n.chipStore,closable:!n.readOnly,navigator:{class:Ev,keyEventTarget:r}}})}null==t||t.destroy()}},{key:"updateChipView",value:function(e){var t,n=this;n._chipViewEventDetacher=null===(t=n._chipViewEventDetacher)||void 0===t?void 0:t.call(n),n.chipStore=null==e?void 0:e.store,e&&(e.element.appendChild(n.input),n._chipViewEventDetacher=Tu.on({element:e.element,mousedown:"onChipViewMousedown",thisObj:n}))}},{key:"updateMultiSelect",value:function(e,t){var n=this,r=n.input,i=n.element,o=!n.isConfiguring,a=n.value;if(i.classList[e?"add":"remove"]("b-multiselect"),e){var s=n.chipView,l=r.parentNode,u=null==s?void 0:s.element;u&&u!==l&&(l.insertBefore(u,r),u.appendChild(r),n.chipView.refresh()),r.value="",o&&!Array.isArray(a)&&(a=a?[a]:null)}else{var c=n._chipView,f=r.parentNode,d=null==c?void 0:c.element;d===f&&(d.parentNode.insertBefore(r,d),d.remove(),i.classList.remove("b-uses-chipview")),o&&"string"!=typeof a&&(a=a&&a.length?a[0]:null)}o&&(n.value=a)}},{key:"onChipViewMousedown",value:function(e){e.preventDefault(),this.containsFocus||this.focus()}},{key:"onChipClose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t.isKeyEvent&&""===this.input.value||!t.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(e),this._isUserAction=!1)}},{key:"updateFilterParamName",value:function(e){!1!==this.hideTrigger&&(this.hideTrigger=Boolean(e))}},{key:"updateHideTrigger",value:function(e){this.element.classList[e?"add":"remove"]("b-hide-trigger")}},{key:"updateKeyStrokeFilterDelay",value:function(e){var t=this;e&&(t.filterList=t.buffer(t.doFilter,e))}},{key:"updateReadOnly",value:function(e){tt()(Ze()(n.prototype),"updateReadOnly",this).apply(this,arguments),this._chipView&&(this._chipView.closable=!e)}},{key:"updateFilterOperator",value:function(e){this.primaryFilter&&(this.primaryFilter.operator=e)}},{key:"minChars",get:function(){var e=this._minChars;return null!=e?e:this.remoteFilter?4:1}},{key:"items",get:function(){return this.store.allRecords}},{key:"changeItems",value:function(e){var t=this;if(null==e){if(t.store&&!t.store.isItemStore)return;e=[]}if(e instanceof ts)t.store=e;else{var n,r,i=t.displayField,o=t.valueField;if(Array.isArray(e)?r=e.map((function(e){var r,a,s=e;e instanceof Lo?(n=e.constructor,o||(t.valueField=o=n.idField)):"string"==typeof e||"number"==typeof e?(o||(t.valueField=o=t.displayField),r={},Qe()(r,o,e),Qe()(r,i,e),s=r):(o||(t.valueField=o="value"),Array.isArray(e)&&(a={},Qe()(a,o,e[0]),Qe()(a,i,e[1]),s=a));return e.selected&&(t.value=s),s})):(o||(t.valueField=o="value"),r=[],Object.entries(e).forEach((function(e){var t,n=N()(e,2),a=n[0],s=n[1];r.push((t={},Qe()(t,o,a),Qe()(t,i,s),t))}))),t.store)t.store.data=r;else{var a=o===i?{name:"value",dataSource:i}:o;t.store=new ts({isItemStore:!0,data:r,idField:o,modelClass:n||function(e){Ye()(r,e);var n=wv(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,null,[{key:"idField",get:function(){return t.valueField},set:function(e){gh()(Ze()(r),"idField",e,this,!0)}},{key:"fields",get:function(){return[a,i]}}]),r}(Lo)})}}}},{key:"value",get:function(){var e=this,t=e.valueCollection,n=e.valueField;return null==n?e.multiSelect?t.values.slice():t.first:e.multiSelect?t.count?t.map((function(e){return e[n]})):e._lastValue||[]:t.count?t.first[n]:e._lastValue},set:function(e){gh()(Ze()(n.prototype),"value",e,this,!0)}},{key:"changeValue",value:function(e,t){var n,r=this;if(e!==t){if(!r.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");r.triggerConfig("items");var i,o=r.valueField,a=r.displayField,s=r.store,l=r.valueCollection,u=r._picker,c=s.storage,f=null!==(n=r.hidePickerOnSelect)&&void 0!==n?n:!r.multiSelect,d=r._isUserAction||(null==u?void 0:u._isUserAction)||f&&r.pickerVisible||!1;if(!r.remoteFilter&&s.isAjaxStore&&!s.count)return s.on("load",(function(){return r.value=e}),{once:!0,thisObj:r}),void(r._lastValue=e);if(r.remoteFilter){if(null!=e){if(he.isObject(e)||e.isModel)this.store.data=[e],this.valueCollection.splice(0,this.valueCollection.count,this.store.first);else{var h=r.isConfiguring;r.primaryFilter.setConfig({value:e,disabled:!1}),s.performFilter(!0).then((function(){var e=r.isConfiguring;r.isConfiguring=h,l.splice(0,l.count,s.allRecords),r.isConfiguring=e}))}return}}else s.filtered&&(r.primaryFilter.disabled=!0,s.filter());if(null!=e){for(var v=Array.isArray(e),p=v?e.slice():[e],g=0,y=p.length;g<y;g++){var m=p[g];if(m instanceof Lo)c.includes(m)||s.add(m);else{var b=Qn.isObject(m);b&&(m=m[o]),(i=c.getBy(a,m)||c.getBy(o,m)||l.getBy(a,m)||l.getBy(o,m))instanceof Set&&(i=F()(i)[0]),i?(b&&i.set(p[g]),p[g]=i):(p.splice(g,1),y--,g--)}}var k,w=!p.length,C=l.generation;if(l.splice(0,l.count,p),w)r._value=v?null!==(k=e[0])&&void 0!==k?k:null:e,r._lastValue=r._value;(w||l.generation===C)&&r.syncInputFieldValue(),r.syncEmpty(),w&&!r.isConfiguring&&r.triggerFieldChange({value:e,oldValue:t,userAction:d,valid:r.isValid})}else if(l.count)l.clear();else{var R=r._value;r._value=null,r.syncInputFieldValue(),r.syncEmpty(),r.isConfiguring||r.triggerFieldChange({value:e,oldValue:R,userAction:d,valid:r.isValid})}r._lastValue=r._value}else r.syncInputFieldValue(!0)}},{key:"hasChanged",value:function(e,t){return this.multiSelect?!Qn.isEqual(e,t):tt()(Ze()(n.prototype),"hasChanged",this).apply(this,arguments)}},{key:"onComboStoreChange",value:function(e){"filter"!==e.action&&this.syncInputFieldValue(!0)}},{key:"syncInputFieldValue",value:function(e){this.usesChipView||tt()(Ze()(n.prototype),"syncInputFieldValue",this).call(this,e)}},{key:"usesChipView",get:function(){return Boolean(this.multiSelect&&this._chipView)}},{key:"isEmpty",get:function(){return 0===this.valueCollection.count}},{key:"inputValue",get:function(){var e=this,t=e.selected?e.selected[e.displayField]:e.value;return e.displayValueRenderer&&(t=e.callback(e.displayValueRenderer,e,[e.selected,e])),null==t?"":t}},{key:"changeValueCollection",value:function(e,t){if(null==t||t.destroy(),e)return e.isCollection||(e=new na({listeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),e}},{key:"changePrimaryFilter",value:function(e){return e instanceof zo||("function"==typeof e&&(e={filterBy:e}),e=new zo(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kv(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive},e))),e}},{key:"changeStore",value:function(e){if(!Array.isArray(e)){if(e){"string"==typeof e?e=ts.getStore(e):Qn.isObject(e)&&(e=new(e.readUrl?ss:ts)(e),this.destroyStore=!0);var t=this,n=t.remoteFilter||e.restfulFilter,r=t.filterParamName,i=t.valueCollection,o=[];n&&r&&(e.filterParamName=r,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams)),t.valueField||t.usingRecordAsValue||(t.valueField=e.modelClass.idField),o.push(t.primaryFilter),n?t.filterSelected&&(e.storage.autoFilter=!0,e.storage.addFilter({id:"".concat(t.id,"-selected-filter"),filterBy:function(e){return!i.includes(e)}})):t.filterSelected&&(t.selectedItemsFilter=function(e){return!i.includes(e)},o.push(t.selectedItemsFilter),e.reapplyFilterOnAdd=!0),i.addIndex({property:t.displayField,unique:!1}),i.addIndex({property:t.valueField,unique:!0}),e.filter(o)}return e}this.items=e}},{key:"updateStore",value:function(e,t){var n,r=this,i=r._picker;if(this.destroyStore&&t&&t.destroy(),i&&(i.store=e),e.storage.addIndex({property:r.displayField,unique:!1}),e.storage.addIndex({property:r.valueField,unique:!0}),r.remoteFilter&&(n={filter:"onRemoteFilter"}),r.displayValueRenderer&&((n||(n={})).change="onComboStoreChange",r.syncInputFieldValue()),r.detachListeners("store"),t){var o=r.value;r.isConfiguring=!0,r.value=null,r.isConfiguring=!1,r.value=o}n&&(n.name="store",n.thisObj=r,e.on(n))}},{key:"remoteFilter",get:function(){var e;return Boolean(this.filterParamName||(null===(e=this._store)||void 0===e?void 0:e.restfulFilter))}},{key:"record",get:function(){return this.selected}},{key:"records",get:function(){return this.valueCollection.values.slice()}},{key:"selected",get:function(){return this.valueCollection.first}},{key:"onEditComplete",value:function(){var e=this,t=e.valueCollection.count;tt()(Ze()(n.prototype),"onEditComplete",this).call(this),t&&(e.clearError(Rv),e.syncInputFieldValue()),e.required&&!t&&e.setError(Cv)}},{key:"onTriggerClick",value:function(){var e,t=this;if(!t.remoteFilter||!t.filterOnEnter)if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled)switch(null===(e=t.triggerAction)||void 0===e?void 0:e.toLowerCase()){case"all":t.doFilter(null);break;case"last":t.doFilter(t.lastQuery);break;default:t.doFilter(t.input.value)}}},{key:"internalOnInput",value:function(e){var t=this,n=t.input.value,r=n.length;t.editable&&(t.syncEmpty(),t.syncInputWidth(),t.inputting=!0,r>=t.minChars&&!t.filterOnEnter?t.filterList(n):(t.validateFilter&&!t.remoteFilter&&t[r?"setError":"clearError"](Rv),t.hidePicker()),t.inputting=!1,t.trigger("input",{value:n,event:e}))}},{key:"syncInputWidth",value:function(){var e=this;if(e.usesChipView){var t=e.input,n=e._inputPadding||(e._inputPadding=mi.getEdgeSize(t,"padding","lr")),r=t.value||"",i=mi.measureText(r+"W",t,!1,e.element)+n.width;t.style.flex="1 1 ".concat(Math.ceil(i),"px")}}},{key:"filterList",value:function(e){this.doFilter(e)}},{key:"doFilter",value:function(e){var t=this,n=t.store,r=t._picker,i=null==e||""===e;t.lastQuery=e,t.primaryFilter.setConfig({value:e,disabled:i}),t.remoteFilter&&n.clear(!0),t.getConfig("picker"),n.filter(),null!=r&&r.isVisible?0===r.lastAlignSpec.zone&&r.realign():t.showPicker(),n.count?i||(t.picker.navigator.activeItem=0):t.remoteFilter||i||!t.validateFilter||t.setError(Rv)}},{key:"onRemoteFilter",value:function(){var e=this,t=e._picker;e.store.count?t&&(t.navigator.activeItem=0):e.validateFilter&&e.setError(Rv),e.filterSelected&&e.valueCollection.count&&(e.store.storage.onFiltersChanged(),t&&t.refresh())}},{key:"onValueCollectionChange",value:function(e){var t,n=e.source,r=this,i=r.multiSelect,o=r._picker,a=null!==(t=r.hidePickerOnSelect)&&void 0!==t?t:!i,s=i?n.values.slice():n.first,l=n.values.slice(),u=r._isUserAction||(null==o?void 0:o._isUserAction)||a&&r.pickerVisible||!1,c=r._value;a&&r.hidePicker(),!n.count&&r.required?r.setError(Cv):(r.clearError(Cv),r.clearError(Rv)),r.validateFilter&&s&&r.clearError(Rv),r.filterSelected&&(r.remoteFilter?(r.store.storage.onFiltersChanged(),r._picker&&r._picker.refresh()):r.store.filter()),r._value=null,r._lastValue=null;var f=r.cacheCurrentValue(r.value);r.syncInputFieldValue(),r.syncEmpty(),r.isConfiguring||(r.triggerFieldChange({value:f,oldValue:c,userAction:u,valid:r.isValid}),r.trigger("select",{record:s,records:l,userAction:u}),"select"===r.defaultAction&&r.trigger("action",{value:f,record:s,records:l,userAction:u}))}},{key:"cacheCurrentValue",value:function(e){return this._value=e}},{key:"onValueCollectionNoChange",value:function(e){var t=e.toAdd;!this.multiSelect&&t.length&&this.pickerVisible&&this.picker.hide()}},{key:"showPicker",value:function(){var e=this,t=e.picker;e.readOnly||(t.multiSelect=e.multiSelect,tt()(Ze()(n.prototype),"showPicker",this).call(this),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),!e.multiSelect&&e.selected&&t.restoreActiveItem(e.selected,!0),e.input.focus())}},{key:"changePicker",value:function(e,t){var n,r=this,i=r.pickerWidth||(null===(n=e)||void 0===n?void 0:n.width);return(e=yv.reconfigure(t,e?yv.mergeConfigs({owner:r,store:r.store,selected:r.valueCollection,multiSelect:r.multiSelect,cls:r.listCls,itemTpl:r.listItemTpl||function(e){return te.encodeHtml(e[r.displayField])},forElement:r[r.pickerAlignElement],align:{matchSize:null==i,anchor:r.overlayAnchor,target:r[r.pickerAlignElement],minHeight:40*Math.min(3,r.store.count)},width:i,navigator:{keyEventTarget:r.input}},e):null,r))&&(e.element.dataset.emptyText=r.emptyText||r.L("L{noResults}")),e}},{key:"onPickerHide",value:function(){var e=this;tt()(Ze()(n.prototype),"onPickerHide",this).call(this),e.multiSelect&&e.clearTextOnPickerHide&&(e.input.value="")}},{key:"internalOnKeyEvent",value:function(e){var t=this,r=t.input.value,i=r.length;tt()(Ze()(n.prototype),"internalOnKeyEvent",this).apply(this,arguments),"keydown"===e.type&&"Enter"===e.key&&t.filterOnEnter&&i>=t.minChars&&(e.stopPropagation(),t.filterList(r))}}],[{key:"$name",get:function(){return"Combo"}},{key:"type",get:function(){return"combo"}},{key:"alias",get:function(){return"combobox,dropdown"}},{key:"configurable",get:function(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:void 0,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:function(e){return e.map((function(e){return e.value}))},filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,valueCollection:{$config:["nullify","lazy"],value:{}},validateFilter:!0,clearTextOnPickerHide:!0,destroyStore:!1}}},{key:"queryLast",get:function(){return"last"}}]),n}(ov),xv=function(e){Ye()(n,e);var t=wv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"ComboChipView"}},{key:"type",get:function(){return"combochipview"}},{key:"defaultConfig",get:function(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl:function(e){return te.encodeHtml(e[this.owner.displayField])},scrollable:{overflowY:"auto"}}}}]),n}(bv),Ev=function(e){Ye()(n,e);var t=wv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onTargetClick",value:function(e){var t=e.target.closest(this.itemSelector);!t||e.shiftKey||t.contains(e.target.closest("[data-noselect]"))||this.ownerCmp.selected.clear(),this.inClickHandler=!0,this.activeItem=t,this.inClickHandler=!1}},{key:"onKeyDown",value:function(e){"Enter"!==e.key&&tt()(Ze()(n.prototype),"onKeyDown",this).call(this,e)}},{key:"updateActiveItem",value:function(e,t){var r=this.ownerCmp;tt()(Ze()(n.prototype),"updateActiveItem",this).call(this,e,t),e&&!this.inClickHandler&&r.selected.add(r.getRecord(e))}},{key:"navigatePrevious",value:function(e){var t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.previous?tt()(Ze()(n.prototype),"navigatePrevious",this).call(this,e):this.activeItem=null}},{key:"navigateNext",value:function(e){var t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.next?tt()(Ze()(n.prototype),"navigateNext",this).call(this,e):this.activeItem=null}}],[{key:"defaultConfig",get:function(){return{allowShiftKey:!0}}}]),n}(fv);function Dv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Sv.initClass(),xv.initClass(),Sv._$name="Combo";var Tv=function(e){Ye()(n,e);var t=Dv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"afterConstruct",value:function(){this.updateUndoRedoControls()}},{key:"changeStm",value:function(e){return e.on({recordingstop:"updateUndoRedoControls",restoringstop:"updateUndoRedoControls",queueReset:"updateUndoRedoControls",disabled:"updateUndoRedoControls",thisObj:this}),e}},{key:"changeItems",value:function(e){var t=e.undoBtn,r=e.redoBtn;return this.color&&(t&&(t.color=this.color),r&&(r.color=this.color)),this.text&&(t&&(t.text="L{UndoRedo.Undo}"),r&&(r.text="L{UndoRedo.Redo}")),tt()(Ze()(n.prototype),"changeItems",this).call(this,e)}},{key:"updateProject",value:function(e){this.stm=e.stm}},{key:"fillUndoRedoCombo",value:function(){var e=this.widgetMap.transactionsCombo;e&&(e.items=this.stm.queue.map((function(e,t){return[t,e||"Transaction ".concat(t)]})))}},{key:"updateUndoRedoControls",value:function(){var e=this.stm,t=this.showZeroActionBadge,n=this.widgetMap,r=n.undoBtn,i=n.redoBtn;r.badge=e.position||(t?"0":""),i.badge=e.length-e.position||(t?"0":""),r.disabled=!e.canUndo,i.disabled=!e.canRedo,this.fillUndoRedoCombo()}},{key:"transactionsDisplayValueRenderer",value:function(e,t){var n,r=(null===(n=this.stm)||void 0===n?void 0:n.position)||0;return"".concat(r," undo actions / ").concat(t.store.count-r," redo actions")}},{key:"onUndo",value:function(){this.stm.canUndo&&this.stm.undo()}},{key:"onRedo",value:function(){this.stm.canRedo&&this.stm.redo()}},{key:"onTransactionSelected",value:function(e){var t=this.stm,n=e.value;n>=0&&(t.canUndo&&n<t.position?t.undo(t.position-n):t.canRedo&&n>=t.position&&t.redo(n-t.position+1))}}],[{key:"$name",get:function(){return"UndoRedoBase"}},{key:"type",get:function(){return"undoredobase"}},{key:"configurable",get:function(){return{project:null,stm:null,text:null,color:null,showZeroActionBadge:null,cls:"b-undo-controls b-toolbar",layoutStyle:{alignItems:"stretch",flexFlow:"row nowrap",overflow:"visible"},items:{undoBtn:{type:"button",icon:"b-icon-undo",tooltip:"L{UndoRedo.UndoLastAction}",onAction:"up.onUndo"},transactionsCombo:{type:"combo",valueField:"idx",editable:!1,store:{},emptyText:"No items in the undo queue",onAction:"up.onTransactionSelected",displayValueRenderer:"up.transactionsDisplayValueRenderer"},redoBtn:{type:"button",icon:"b-icon-redo",tooltip:"L{UndoRedo.RedoLastAction}",onAction:"up.onRedo"}}}}}]),n}(Rc);function Ov(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Tv._$name="UndoRedoBase";var Mv=function(e){Ye()(n,e);var t=Ov(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeStore",value:function(e,t){var r=this;return tt()(Ze()(n.prototype),"changeStore",this).call(this,new ts({data:[{id:r.positiveValue,text:r.positiveText||r.L("L{Object.Yes}")},{id:r.negativeValue,text:r.negativeText||r.L("L{Object.No}")}]}),t)}}],[{key:"$name",get:function(){return"BooleanCombo"}},{key:"type",get:function(){return"booleancombo"}},{key:"configurable",get:function(){return{positiveValue:!0,positiveText:null,negativeValue:!1,negativeText:null,store:{value:[],$config:"lazy"},value:!1}}}]),n}(Sv);function Av(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Mv.initClass(),Mv._$name="BooleanCombo";var Iv=function(e){Ye()(n,e);var t=Av(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onChildAdd",value:function(e){tt()(Ze()(n.prototype),"onChildAdd",this).call(this,e),e.on({click:"onItemClick",thisObj:this,prio:1e4})}},{key:"onChildRemove",value:function(e){e.un({click:"onItemClick",thisObj:this}),tt()(Ze()(n.prototype),"onChildRemove",this).call(this,e)}},{key:"onItemClick",value:function(){this._value=null}},{key:"createWidget",value:function(e){var t=this;return t.constructor.resolveType(e.type||"button").isButton&&(t.color&&!e.color&&(e.color=t.color),t.toggleGroup&&!e.toggleGroup&&("boolean"==typeof t.toggleGroup&&(t.toggleGroup=n.generateId("toggleGroup")),e.toggleGroup=t.toggleGroup)),t.columns&&(e.width="".concat(100/t.columns,"%")),e=tt()(Ze()(n.prototype),"createWidget",this).call(this,e),t.relayEvents(e,["click","action","toggle"]),e}},{key:"updateRotate",value:function(e){this.eachWidget((function(t){!1!==t.rotate&&(t.rotate=e)}))}},{key:"value",get:function(){if(!this._value){var e=[];this.items.forEach((function(t){t.pressed&&void 0!==t.value&&e.push(t.value)})),this._value=e.join(this.valueSeparator)}return this._value},set:function(e){Array.isArray(e)||(e=null==e?[]:"string"==typeof e?e.split(this.valueSeparator):[e]),this._value=e,this.items.forEach((function(t){void 0!==t.value&&(t.pressed=e.indexOf(t.value)>-1)}))}},{key:"disabled",get:function(){return tt()(Ze()(n.prototype),"disabled",this)},set:function(e){gh()(Ze()(n.prototype),"disabled",e,this,!0),this.items.forEach((function(t){return t.disabled=e}))}},{key:"widgetClassList",get:function(){var e=tt()(Ze()(n.prototype),"widgetClassList",this);return this.columns&&e.push("b-columned"),e}}],[{key:"$name",get:function(){return"ButtonGroup"}},{key:"type",get:function(){return"buttongroup"}},{key:"configurable",get:function(){return{defaultType:"button",cls:null,items:null,color:null,toggleGroup:null,valueSeparator:",",columns:null,hideWhenEmpty:!0}}}]),n}(Rc.mixin(Fc));Iv.initClass(),Iv._$name="ButtonGroup";n(198);function Pv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Fv=function(e){Ye()(n,e);var t=Pv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e),this.refreshCount||this.refresh()}},{key:"onPaint",value:function(e){var t,r=e.firstPaint;null===(t=tt()(Ze()(n.prototype),"onPaint",this))||void 0===t||t.apply(this,arguments),r&&(this.refreshCount||this.refresh(),this.getConfig("minColumnWidth"),this.getConfig("minRowHeight"))}},{key:"overflowElement",get:function(){return this.weeksElement}},{key:"doDestroy",value:function(){var e;null===(e=this.tip)||void 0===e||e.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"changeMinRowHeight",value:function(e){var t=parseInt(mi.getStyleValue(this.element,"--min-row-height"),10)||75;return null==e?e:Math.max(parseInt(e)||0,t)}},{key:"updateMinRowHeight",value:function(e){this.weekElements.forEach((function(t){return mi.setLength(t,"flexBasis",e)})),this.scrollable={overflowY:!!e&&"auto"}}},{key:"changeMinColumnWidth",value:function(e){var t=parseInt(mi.getStyleValue(this.element,"--min-column-width"),10)||75;return null==e?e:Math.max(parseInt(e)||0,t)}},{key:"updateMinColumnWidth",value:function(e){var t=this;t.weekdayCells.forEach((function(t){return mi.setLength(t,"minWidth",e)})),t.cellElements.forEach((function(n){return n.matches(".".concat(t.dayCellCls))&&mi.setLength(n,"minWidth",e)})),t.scrollable={overflowX:!!e&&"auto"},t.overflowElement.classList[e?"add":"remove"]("b-min-columnwidth")}},{key:"getDateFromEvent",value:function(e){var t=(e.nodeType===Element.ELEMENT_NODE?e:e.target).closest("#".concat(this.id," [data-date]"));if(t)return Un.parseKey(t.dataset.date)}},{key:"changeTip",value:function(e,t){var n=this;return kh.reconfigure(t,e,{owner:n,defaults:{type:"tooltip",owner:n,id:"".concat(n.id,"-cell-tip"),forElement:n.bodyElement,forSelector:".".concat(n.dayCellCls)}})}},{key:"updateTip",value:function(e){this.detachListeners("tip"),null==e||e.on({pointerOver:"onTipOverCell",name:"tip",thisObj:this})}},{key:"updateElement",value:function(e,t){var r=this;tt()(Ze()(n.prototype),"updateElement",this).call(this,e,t),r.updateHideNonWorkingDays(r.hideNonWorkingDays),r.weekdayCells=Array.from(e.querySelectorAll(".b-calendar-day-header")),r.weekElements=Array.from(e.querySelectorAll(".b-calendar-week")),r.weekDayElements=Array.from(e.querySelectorAll(".b-calendar-days")),r.cellElements=[];for(var i=0,o=r.weekDayElements.length;i<o;i++){var a;(a=r.cellElements).push.apply(a,[r.weekDayElements[i].previousSibling].concat(F()(r.weekDayElements[i].children)))}}},{key:"changeDate",value:function(e){if(e="string"==typeof e?Un.parse(e):new Date(e),isNaN(e))throw new Error("CalendarPanel date ingestion must be passed a Date, or a YYYY-MM-DD date string");return Un.clearTime(e)}},{key:"updateDate",value:function(e){this.month.date=e}},{key:"updateDayNameFormat",value:function(){var e=new Date("2000-06-04T12:00:00");this.shortDayNames=[];for(var t=4;t<11;t++)e.setDate(t),this.shortDayNames.push(Un.format(e,this.dayNameFormat))}},{key:"weekStartDay",get:function(){return"number"==typeof this._weekStartDay?this._weekStartDay:Un.weekStartDay}},{key:"updateWeekStartDay",value:function(e){var t=this;if(t._month){t.month.weekStartDay=e,t.dayNames=[];for(var n=0;n<7;n++)t.dayNames[n]=t.shortDayNames[t.canonicalDayNumbers[n]];t.refreshCount&&t.refresh()}}},{key:"updateHideNonWorkingDays",value:function(e){var t;this.contentElement.classList[e?"add":"remove"](this.hideNonWorkingDaysCls),null===(t=this.scrollable)||void 0===t||t.syncOverflowState(),this._month&&(this.month.hideNonWorkingDays=e)}},{key:"nonWorkingDays",get:function(){return this._nonWorkingDays||Un.nonWorkingDays}},{key:"changeNonWorkingDays",value:function(e){return Qn.assign({},e)}},{key:"updateNonWorkingDays",value:function(e){var t;this._month&&(this.month.nonWorkingDays=e,this.refresh(),null===(t=this.scrollable)||void 0===t||t.syncOverflowState())}},{key:"visibleDayColumnIndex",get:function(){return this.month.visibleDayColumnIndex}},{key:"dayColumnIndex",get:function(){return this.month.dayColumnIndex}},{key:"canonicalDayNumbers",get:function(){return this.month.canonicalDayNumbers}},{key:"visibleColumnCount",get:function(){return this.month.visibleColumnCount}},{key:"weekLength",get:function(){return this.month.weekLength}},{key:"startDate",get:function(){return this.month.startDate}},{key:"duration",get:function(){return Un.diff(this.month.startDate,this.month.endDate,"day")+1}},{key:"endDate",get:function(){var e=this.month.endDate;if(e)return Un.add(e,1,"day")}},{key:"changeMonth",value:function(e,t){var n=this;if(!(e instanceof Oh)){if("number"==typeof e){if(t)return void(t.month=e);var r=n.date||Un.clearTime(new Date);r.setMonth(e),e={date:r}}e=Oh.new({weekStartDay:n.weekStartDay,nonWorkingDays:n.nonWorkingDays,hideNonWorkingDays:n.hideNonWorkingDays,sixWeeks:n.sixWeeks},e)}return e.on({dateChange:"onMonthDateChange",thisObj:n}),e}},{key:"onMonthDateChange",value:function(e){var t=e.source,n=e.newDate,r=e.oldDate,i=e.changes,o=this;o.year=t.year,o.isConfiguring||((i.m||i.y)&&o.refresh(),o.trigger("dateChange",{value:n,oldValue:r}))}},{key:"updateYear",value:function(e){this.month.year=e}},{key:"updateShowWeekNumber",value:function(e){this.updateShowWeekColumn(e)}},{key:"updateShowWeekColumn",value:function(e){var t=this;t.element.classList[e?"add":"remove"]("b-show-week-column"),t.floating&&(t.isAligning||t.realign())}},{key:"updateSixWeeks",value:function(e){this.month&&(this.month.sixWeeks=e,this.refresh())}},{key:"refresh",value:function(){this.doRefresh()}},{key:"doRefresh",value:function(){this.getConfig("element");var e=this,t=Un.clearTime(new Date),n=e.cellElements,r=e.weekElements,i=e.weekDayElements,o=e.date,a=e.month,s=e.dayCellCls,l=e.dayHeaderCls,u=e.disabledCls,c=e.otherMonthCls,f=e.weekendCls,d=e.todayCls,h=e.nonWorkingDayCls,v=e.nonWorkingDays,p=e.canonicalDayNumbers;o||(e.date=t),e.getConfig("dayNameFormat");for(var g=0,y=n.length;g<y;g++)n[g].className=s;for(var m=0;m<7;m++){var b=e.weekdayCells[m],k=e.canonicalDayNumbers[m],w=b.classList;b.className=b.innerHTML="",e.headerRenderer?e.callback(e.headerRenderer,e,[b,m,k]):b.innerHTML=e.shortDayNames[k],w.add(l),Un.weekends[k]&&w.add(f),v[k]&&w.add(h),b.dataset.columnIndex=m,b.dataset.cellDay=k}for(var C=0,R=0,S=6,x=6;x>=0;x--)if(!v[p[x]]){S=x;break}for(a.eachWeek((function(n,o){var s=i[C],l=[s.previousSibling].concat(F()(s.children));r[C].dataset.week="".concat(n[0],",").concat(n[1]),r[C].classList.remove("b-hide-display"),l[0].className="b-week-number-cell",e.weekRenderer?e.callback(e.weekRenderer,e,[l[0],n]):l[0].innerHTML=n[1];for(var p=0;p<7;p++){var g=o[p],y=g.getDay(),m=l[p+1],b=m.classList;e.isDisabledDate(g)&&b.add(u),g.getMonth()!==a.month&&b.add(c),Un.weekends[y]&&b.add(f),g.getTime()===t.getTime()&&b.add(d),v[y]&&b.add(h),b[p===S?"add":"remove"]("b-last-working-day"),m.dataset.date=Un.makeKey(g),m.dataset.cellIndex=R,m.dataset.columnIndex=p,m.lastDomConfig&&(delete m.lastDomConfig.class,delete m.lastDomConfig.className),e.cellRenderer?e.callback(e.cellRenderer,e,[{cell:m,date:g,day:y,row:r[C],rowIndex:C,cellIndex:R,columnIndex:p,visibleColumnIndex:e.visibleDayColumnIndex[y],week:n}]):m.innerHTML=g.getDate(),R++}C++})),e.visibleWeekCount=C;C<6;C++)r[C].classList[e.sixWeeks?"remove":"add"]("b-hide-display");e.floating&&(e.isAligning||e.realign()),e.refreshCount=(e.refreshCount||0)+1,e.trigger("refresh")}},{key:"isDisabledDate",value:function(e){var t=e.getDay(),n=this.disabledDates,r=this.nonWorkingDays;return!(!this.disableWeekends||!r[t])||(n?Array.isArray(n)?(e=Un.clearTime(e,!0),n.some((function(t){return!(Un.clearTime(t,!0)-e)}))):this.callback(this.disabledDates,this,[e]):void 0)}},{key:"bodyConfig",get:function(){var e=tt()(Ze()(n.prototype),"bodyConfig",this),t=[];e.children=[{tag:"div",className:"b-calendar-row b-calendar-weekdays",reference:"weekdaysHeader",children:[{class:"b-week-number-cell"}].concat(F()(it.fill(7,{class:this.dayHeaderCls})),[mi.scrollBarPadElement])},{className:"b-weeks-container notranslate",reference:"weeksElement",children:t}];for(var r=0;r<6;r++){t.push({className:"b-calendar-row b-calendar-week",children:[{},{className:"b-calendar-days",children:[{},{},{},{},{},{},{}],syncOptions:{ignoreRefs:!0,strict:!1}}]})}return e}},{key:"firstVisibleDate",get:function(){for(var e=this,t=e.month.startDate;;t.setDate(t.getDate()+1))if(!e.hideNonWorkingDays||!e.nonWorkingDays[t.getDay()])return t}},{key:"getCell",value:function(e){return"string"!=typeof e&&(e=Un.makeKey(e)),this.weeksElement.querySelector('[data-date="'.concat(e,'"]'))}},{key:"onTipOverCell",value:function(e){var t=e.source,n=e.target;t.date=Un.parseKey(n.dataset.date)}},{key:"updateLocalization",value:function(){this.updateDayNameFormat(),this.updateWeekStartDay(this.weekStartDay),tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"CalendarPanel"}},{key:"type",get:function(){return"calendarpanel"}},{key:"configurable",get:function(){return{textContent:!1,date:{$config:{equal:"date"},value:null},month:{},year:null,weekStartDay:null,sixWeeks:!0,showWeekNumber:null,showWeekColumn:null,disabledDates:null,headerRenderer:null,weekRenderer:null,cellRenderer:null,disableWeekends:null,hideNonWorkingDays:null,hideNonWorkingDaysCls:"b-hide-nonworking-days",nonWorkingDays:null,tip:null,dayCellCls:"b-calendar-cell",dayHeaderCls:"b-calendar-day-header",disabledCls:"b-disabled-date",otherMonthCls:"b-other-month",weekendCls:"b-weekend",todayCls:"b-today",nonWorkingDayCls:"b-nonworking-day",dayNameFormat:"ddd",minRowHeight:{$config:["lazy"],value:null},minColumnWidth:{$config:["lazy"],value:null}}}}]),n}(Rf);function Lv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Fv.initClass(),Fv._$name="CalendarPanel";var Bv=function(e){Ye()(n,e);var t=Lv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){"checked"in e&&((e=Qn.assign({},e)).value=e.checked,delete e.checked),tt()(Ze()(n.prototype),"construct",this).call(this,e),this.syncHasText()}},{key:"innerElements",get:function(){return[this.inputElement,{tag:"label",class:"b-checkbox-label",for:"".concat(this.id,"-input"),reference:"textLabel",html:this.text||""}]}},{key:"inputElement",get:function(){var e=this,t=tt()(Ze()(n.prototype),"inputElement",this);return e.readOnly&&(t.disabled=!0),e.toggleGroup&&(t.dataset={group:e.toggleGroup}),t}},{key:"checked",get:function(){return this.value},set:function(e){this.value=e}},{key:"syncHasText",value:function(){this.element.classList[this.text?"add":"remove"]("b-text")}},{key:"updateText",value:function(e){this.textLabel&&(this.syncHasText(),this.textLabel.innerHTML=e)}},{key:"changeValue",value:function(e){return"false"!==e&&Boolean(e)}},{key:"updateValue",value:function(e){var t=this,n=t.input.checked!==e;t.input.checked=e,n&&!t.inputting&&(t.uncheckToggleGroupMembers(),t.isConfiguring||t.triggerChange(!1))}},{key:"inputValueAttr",get:function(){return"checked"}},{key:"updateColor",value:function(e,t){var n=this.element.classList;t&&n.remove(t),e&&n.add(e)}},{key:"getToggleGroupMembers",value:function(){var e=this,t=e.checked,n=e.toggleGroup,r=e.input,i=[];return t&&n&&mi.forEachSelector(e.rootElement,"input[type=checkbox][data-group=".concat(n,"]"),(function(e){if(e!==r){var t=uc.fromElement(e);t&&i.push(t)}})),i}},{key:"uncheckToggleGroupMembers",value:function(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((function(e){return e.checked=!1}))}},{key:"updateReadOnly",value:function(e){this.input&&(this.input.disabled=e),tt()(Ze()(n.prototype),"updateReadOnly",this).call(this,e)}},{key:"check",value:function(){this.checked=!0}},{key:"uncheck",value:function(){this.checked=!1}},{key:"toggle",value:function(){this.checked=!this.checked}},{key:"internalOnChange",value:function(e){var t=this;t.value=t.input.checked,t.inputting||(t.inputting=!0,t.triggerChange(!0),t.inputting=!1)}},{key:"triggerChange",value:function(e){var t=this,n=t.input.checked,r={checked:n,value:n,userAction:e,valid:!0};if(!(!n&&e&&t.toggleGroup&&t.getToggleGroupMembers().filter((function(e){return e.isVisible&&!e.disabled})).length||!1===t.trigger("beforeChange",r)))return t.triggerFieldChange(r,!1),e&&t.uncheckToggleGroupMembers(),t.trigger("action",r),t.trigger("change",r),!0;t.input.checked=t._value=!n}}],[{key:"$name",get:function(){return"Checkbox"}},{key:"type",get:function(){return"checkbox"}},{key:"alias",get:function(){return"check"}},{key:"configurable",get:function(){return{inputType:"checkbox",text:"",color:null,value:"",toggleGroup:null,defaultBindProperty:"value",localizableProperties:["label","text"]}}}]),n}(tv);function jv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Bv.initClass(),Bv._$name="Checkbox";for(var _v=function(){return Un.getMonthNames().map((function(e,t){return[t,e]}))},Hv=[],Nv=(new Date).getFullYear(),zv=Nv-20;zv<Nv+21;zv++)Hv.push(zv);(function(e){Ye()(n,e);var t=jv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onSelect",value:function(e){var t=e.record;this.value=t.value}},{key:"value",get:function(){return tt()(Ze()(n.prototype),"value",this)},set:function(e){gh()(Ze()(n.prototype),"value",e,this,!0),this.input.innerHTML=this.input.value}}],[{key:"$name",get:function(){return"ReadOnlyCombo"}},{key:"type",get:function(){return"readonlycombo"}},{key:"configurable",get:function(){return{editable:!1,inputAttributes:{tag:"div",tabIndex:-1},highlightExternalChange:!1,triggers:{expand:!1},picker:{align:{align:"t-b",axisLock:!0,matchSize:!1},cls:"b-readonly-combo-list",scrollable:{overflowX:!1}}}}}]),n})(Sv).initClass();var Vv=function(e){Ye()(n,e);var t=jv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;e.editOnHover&&z.a.deprecate("Grid","5.0.0","`editOnHover` config deprecated, it now has no effect and will be removed in 5.0"),t.selection=e.date?[e.date]:[],tt()(Ze()(n.prototype),"construct",this).call(this,e),t.externalCellRenderer=t.cellRenderer,t.cellRenderer=t.internalCellRenderer,t.element.setAttribute("aria-activedescendant","".concat(t.id,"-active-day")),Tu.on({element:t.weeksElement,click:"onCellClick",delegate:".".concat(t.dayCellCls,":not(.").concat(t.disabledCls,"):not(.").concat(t.outOfRangeCls,")"),thisObj:t}),t.widgetMap.monthField.readOnly=t.widgetMap.yearField.readOnly=!t.editMonth}},{key:"doDestroy",value:function(){var e,t;null===(e=this.yearField)||void 0===e||e.destroy(),null===(t=this.monthField)||void 0===t||t.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"focusElement",get:function(){return this.element}},{key:"internalCellRenderer",value:function(e){var t,n=e.cell,r=e.date,i=this,o=i.activeCls,a=i.selectedCls,s=n.classList;n.innerHTML=r.getDate(),n.setAttribute("aria-label",Un.format(r,"MMMM D, YYYY")),i.isActiveDate(r)?(s.add(o),n.id="".concat(i.id,"-active-day")):n.removeAttribute("id"),i.isSelectedDate(r)&&s.add(a),(i.minDate&&r<i.minDate||i.maxDate&&r>i.maxDate)&&s.add(i.outOfRangeCls),null===(t=i.externalCellRenderer)||void 0===t||t.call.apply(t,[i].concat(Array.prototype.slice.call(arguments)))}},{key:"onCellClick",value:function(e){var t=e.target.closest("[data-date]");this.onUIDateSelect(Un.parseKey(t.dataset.date),e)}},{key:"onUIDateSelect",value:function(e,t){var n=this,r=n.lastClickedDate,i=n.selection;n.activeDate=e,n.lastClickedDate=e,n.isDisabledDate(e)||(n.activatingEvent=t,n.multiSelect?n.multiRange||r&&e.getTime()===r.getTime()||(r&&t.shiftKey?(i[1]=e,i.sort()):(i.length=0,i[0]=e),n.trigger("selectionChange",{selection:i,userAction:Boolean(t)})):n.value&&n.value.getTime()===e.getTime()?n.floating&&n.hide():n.value=e,n.activatingEvent=null),n.refresh()}},{key:"onInternalKeyDown",value:function(e){var t=this,n=e.key.trim()||e.code,r=t.activeDate,i=new Date(r);if("Escape"===n&&t.floating)return t.hide();if(r&&e.target===t.focusElement){do{switch(n){case"ArrowLeft":e.preventDefault(),e.ctrlKey?i=t.gotoPrevMonth():i.setDate(i.getDate()-1);break;case"ArrowUp":e.preventDefault(),i.setDate(i.getDate()-7);break;case"ArrowRight":e.preventDefault(),e.ctrlKey?i=t.gotoNextMonth():i.setDate(i.getDate()+1);break;case"ArrowDown":e.preventDefault(),i.setDate(i.getDate()+7);break;case"Enter":return t.onUIDateSelect(r,e)}}while(t.isDisabledDate(i)&&!t.focusDisabledDates);if(t.minDate&&i<t.minDate)return;if(t.maxDate&&i>t.maxDate)return;t.activeDate=i}}},{key:"changeMinDate",value:function(e){return e?this.changeDate(e):null}},{key:"updateMinDate",value:function(){this.refresh()}},{key:"changeMaxDate",value:function(e){return e?this.changeDate(e):null}},{key:"updateMaxDate",value:function(){this.refresh()}},{key:"updateDate",value:function(e){tt()(Ze()(n.prototype),"updateDate",this).call(this,e),this.activeDate=e}},{key:"changeActiveDate",value:function(e){if(e=e?this.changeDate(e):this.date||(this.date=Un.clearTime(new Date)),isNaN(e))throw new Error("DatePicker date ingestion must be passed a Date, or a YYYY-MM-DD date string");return e}},{key:"updateActiveDate",value:function(e){this.month.date=e,this.widgetMap.monthField.value=e.getMonth(),this.widgetMap.yearField.value=e.getFullYear(),this.refresh()}},{key:"value",get:function(){return this.selection[this.selection.length-1]},set:function(e){var t,n=this,r=n.selection;if(e){if(void 0===(e=n.changeDate(e,n.value)))return;n.value&&e.getTime()===n.value.getTime()||(r.length=0,r[0]=e,t=!0),n.date=e}else t=r.length,r.length=0,n.date=new Date;t&&n.trigger("selectionChange",{selection:r,userAction:Boolean(n.activatingEvent)})}},{key:"gotoPrevMonth",value:function(){var e=this,t=e.activeDate,n=t&&e.getCell(t)?t:e.date,r=Un.add(n,-1,"month");if(!e.minDate||r>=e.minDate)return e.date=r}},{key:"gotoNextMonth",value:function(){var e=this,t=e.activeDate,n=t&&e.getCell(t)?t:e.date,r=Un.add(n,1,"month");if(!e.maxDate||r<=e.maxDate)return e.date=r}},{key:"isActiveDate",value:function(e){return this.activeDate&&this.changeDate(e).getTime()===this.activeDate.getTime()}},{key:"isSelectedDate",value:function(e){return this.selection.some((function(t){return Un.isEqual(t,e,"day")}))}},{key:"onMonthPicked",value:function(e){var t=e.record;this.activeDate=Un.add(this.activeDate,t.value-this.activeDate.getMonth(),"month"),this.focusElement.focus()}},{key:"onYearPicked",value:function(e){var t=e.record,n=new Date(this.activeDate);n.setFullYear(t.value),this.activeDate=n,this.focusElement.focus()}},{key:"yearItems",get:function(){for(var e=[],t=(new Date).getFullYear(),n=t-20;n<t+21;n++)e.push(n);return e}},{key:"updateLocalization",value:function(){var e=this.widgetMap.monthField,t=_v();t[e.value].selected=!0,e.items=t,tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"DatePicker"}},{key:"type",get:function(){return"datepicker"}},{key:"delayable",get:function(){return{refresh:"raf"}}},{key:"configurable",get:function(){return{activeDate:{value:null,$config:{equal:"date"}},focusable:!0,textContent:!1,tbar:{overflow:null,items:[{ref:"prevMonth",cls:"b-icon b-icon-prev",onAction:"up.gotoPrevMonth"},{type:"container",flex:1,defaultType:"readonlycombo",cls:"b-datepicker-title",items:[{ref:"monthField",cls:"b-datepicker-monthfield",items:_v(),listeners:{select:"up.onMonthPicked"}},{ref:"yearField",cls:"b-datepicker-yearfield",items:Hv,listeners:{select:"up.onYearPicked"}}]},{ref:"nextMonth",cls:"b-icon b-icon-next",onAction:"up.gotoNextMonth"}]},date:new Date,minDate:{value:null,$config:{equal:"date"}},maxDate:{value:null,$config:{equal:"date"}},focusDisabledDates:null,multiSelect:!1,editOnHover:!0,editMonth:!0,dayNameFormat:"dd"}}},{key:"prototypeProperties",get:function(){return{outOfRangeCls:"b-out-of-range",activeCls:"b-active-date",selectedCls:"b-selected-date"}}}]),n}(Fv);function Wv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Vv.initClass(),Vv._$name="DatePicker";var $v=function(e){Ye()(n,e);var t=Wv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changePicker",value:function(e,t){var n=this,r={owner:n,forElement:n[n.pickerAlignElement],minDate:n.min,maxDate:n.max,weekStartDay:n._weekStartDay,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},onSelectionChange:function(e){var t=e.selection,r=e.source;r.isVisible&&(n._isUserAction=!0,n._isPickerInput=!0,n.value=t[0],n._isPickerInput=!1,n._isUserAction=!1,r.hide())}};return n.calendarContainerCls&&(r.cls=n.calendarContainerCls),n.value?r.value=n.value:r.date=new Date,Vv.reconfigure(t,e,{owner:n,defaults:r})}},{key:"backShiftDate",get:function(){return Un.add(this.value,-1*this._step.magnitude,this._step.unit)}},{key:"onBackClick",value:function(){var e=this,t=e.min;if(!e.readOnly&&e.value){var n=e.backShiftDate;(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"forwardShiftDate",get:function(){return Un.add(this.value,this._step.magnitude,this._step.unit)}},{key:"onForwardClick",value:function(){var e=this,t=e.max;if(!e.readOnly&&e.value){var n=e.forwardShiftDate;(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"showPicker",value:function(e){if(!this.readOnly){var t=this._picker;t&&(t.value=this.value),tt()(Ze()(n.prototype),"showPicker",this).call(this,e)}}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"isValid",get:function(){var e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);var t=e.value;if(t){var r=e.min,i=e.max;if(t=t.getTime(),r&&r.getTime()>t)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(i&&i.getTime()<t)return e.setError("L{Field.maximumValueViolation}",!0),!1}return tt()(Ze()(n.prototype),"isValid",this)}},{key:"transformDateValue",value:function(e){return null!=e&&(Un.isDate(e)||(e="string"==typeof e?Un.parse(e,this.format)||Un.parse(e,this.fallbackFormat):new Date(e)),Un.isValidDate(e))?this.transformTimeValue(e):null}},{key:"transformTimeValue",value:function(e){var t=this,n=t.keepTime;if(e=Un.clone(e),n)if("entered"!==n){var r=Un.parse(n,t.timeFormat);Un.isValidDate(r)?Un.copyTimeValues(e,r):Un.isValidDate(t.value)&&Un.copyTimeValues(e,t.value)}else t._isPickerInput&&Un.isValidDate(t.value)&&Un.copyTimeValues(e,t.value);else Un.clearTime(e,!1);return e}},{key:"changeMin",value:function(e){return this.transformDateValue(e)}},{key:"updateMin",value:function(e){var t=this.input,n=this._picker;t&&(null==e?t.removeAttribute("min"):t.min=e),n&&(n.minDate=e),this.syncInvalid()}},{key:"changeMax",value:function(e){return this.transformDateValue(e)}},{key:"updateMax",value:function(e){var t=this.input,n=this._picker;t&&(null==e?t.removeAttribute("max"):t.max=e),n&&(n.maxDate=e),this.syncInvalid()}},{key:"weekStartDay",get:function(){return"number"==typeof this._weekStartDay?this._weekStartDay:Un.weekStartDay}},{key:"updateWeekStartDay",value:function(e){this._picker&&(this._picker.weekStartDay=e)}},{key:"changeValue",value:function(e,t){var r=this,i=r.transformDateValue(e);if(!e||i){if(r.clearError("L{invalidDate}"),r.hasChanged(t,i))return tt()(Ze()(n.prototype),"changeValue",this).call(this,i,t);r.inputting||r.syncInputFieldValue()}else r.setError("L{invalidDate}")}},{key:"updateValue",value:function(e,t){var r=this._picker;r&&!this.inputting&&(r.value=e),tt()(Ze()(n.prototype),"updateValue",this).call(this,e,t)}},{key:"changeStep",value:function(e,t){var n=I()(e);return e?("number"===n?e={magnitude:Math.abs(e),unit:t?t.unit:"day"}:"string"===n&&(e=Un.parseDuration(e)),e&&e.unit&&e.magnitude?(e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e):void 0):null}},{key:"updateStep",value:function(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}},{key:"hasChanged",value:function(e,t){return null!=e&&e.getTime&&null!=t&&t.getTime&&"entered"!==this.keepTime?!Un.isEqual(Un.clearTime(e),Un.clearTime(t)):tt()(Ze()(n.prototype),"hasChanged",this).call(this,e&&e.getTime(),t&&t.getTime())}},{key:"inputValue",get:function(){var e=this.value;return e?Un.format(e,this.format):""}},{key:"updateFormat",value:function(){this.syncInputFieldValue(!0)}},{key:"updateLocalization",value:function(){tt()(Ze()(n.prototype),"updateLocalization",this).call(this),this.syncInputFieldValue(!0)}},{key:"internalOnKeyEvent",value:function(e){tt()(Ze()(n.prototype),"internalOnKeyEvent",this).call(this,e),"Enter"===e.key&&this.isValid&&this.picker.hide()}}],[{key:"$name",get:function(){return"DateField"}},{key:"type",get:function(){return"datefield"}},{key:"alias",get:function(){return"date"}},{key:"configurable",get:function(){return{format:"L",fallbackFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss:SSS",keepTime:!1,pickerFormat:null,triggers:{expand:{cls:"b-icon-calendar",handler:"onTriggerClick",weight:200},back:{cls:"b-icon b-icon-angle-left b-step-trigger",handler:"onBackClick",align:"start",weight:100},forward:{cls:"b-icon b-icon-angle-right b-step-trigger",handler:"onForwardClick",align:"end",weight:100}},calendarContainerCls:"",min:null,max:null,step:!1,stepTriggers:null,weekStartDay:null,picker:{type:"datepicker",floating:!0,scrollAction:"realign",align:{align:"t0-b0",axisLock:!0}},value:null}}}]),n}(ov);function Uv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}$v.initClass(),$v._$name="DateField";var Gv=function(e){Ye()(n,e);var t=Uv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e);var t=this;t.input.addEventListener("dblclick",(function(){t.select()})),"number"==typeof t.changeOnSpin&&(t.bufferedSpinChange=t.buffer(t.triggerChange,t.changeOnSpin))}},{key:"acceptValue",value:function(e,t){var n=!isNaN(e);if(n&&!this.hasTextSelection){n=!1;var r=this.input.value,i=parseFloat(r);r!==t&&(n=!this.acceptValue(i,r))}return n}},{key:"okMax",value:function(e){return isNaN(this.max)||e<=this.max}},{key:"okMin",value:function(e){return isNaN(this.min)||e>=this.min}},{key:"internalOnKeyEvent",value:function(e){if("keydown"===e.type){var t,r=this,i=e.key;if("ArrowUp"===i)r.doSpinUp(e.shiftKey),t=!0;else if("ArrowDown"===i)r.doSpinDown(e.shiftKey),t=!0;else if(!e.altKey&&!e.ctrlKey&&i&&1===i.length){var o=r.getAfterValue(i),a=r.formatter.parseStrict(o);t=!(a===r.value||"-"===o&&(isNaN(r.min)||r.min<0))&&!r.acceptValue(a,o)}"Enter"===i&&r._changedBySilentSpin&&(r.triggerChange(e,!0),r._changedBySilentSpin=!1),t&&e.preventDefault()}tt()(Ze()(n.prototype),"internalOnKeyEvent",this).call(this,e)}},{key:"doSpinUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=(t.value||0)+(e?t.largeStep:t.step);t.okMin(n)||(n=t.min),t.okMax(n)&&t.applySpinChange(n)}},{key:"doSpinDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=(t.value||0)-(e?t.largeStep:t.step);t.okMax(n)||(n=t.max),t.okMin(n)&&t.applySpinChange(n)}},{key:"applySpinChange",value:function(e){var t=this;t._isUserAction=!0,!0!==t.changeOnSpin&&(t._changedBySilentSpin=!0,t.silenceChange=!0,t.bufferedSpinChange&&t.bufferedSpinChange(null,!0)),t.value=e,t._isUserAction=!1,t.silenceChange=!1}},{key:"triggerChange",value:function(){this.silenceChange||tt()(Ze()(n.prototype),"triggerChange",this).apply(this,arguments)}},{key:"onFocusOut",value:function(e){tt()(Ze()(n.prototype),"onFocusOut",this).apply(this,arguments);var t=this,r=t.input,i=r.value,o=t.formatter.truncate(i),a=isNaN(o)?i:t.formatValue(o);i!==a&&(r.value=a),t._changedBySilentSpin&&(t.triggerChange(e,!0),t._changedBySilentSpin=!1)}},{key:"internalOnInput",value:function(e){var t=this,r=t.formatter,i=t.input,o=r.parser,a=i.value,s=o.decimalPlaces(a);if(r.truncator&&s){var l=a,u=r.truncate(a);if(!isNaN(u)&&(l=t.formatValue(u),o.decimalPlaces(l)<s)){var c=a.length-t.caretPos;i.value=l,t.caretPos=l.length-c}}tt()(Ze()(n.prototype),"internalOnInput",this).call(this,e)}},{key:"formatValue",value:function(e){return this.formatter.format(e)}},{key:"changeFormat",value:function(e){if(""===e){var t=this.leadingZeroes,n=this.decimalPrecision;e=t?"".concat(t,">9"):null,null!=n?e="".concat(e||"","9.").concat("#".repeat(n)):e&&(e+=".*")}return e}},{key:"formatter",get:function(){var e=this,t=e.format,n=e._formatter;return n&&e._lastFormat===t||(n=Pd.get(e._lastFormat=t),e._formatter=n),n}},{key:"updateStep",value:function(e){this.element.classList[e?"remove":"add"]("b-hide-spinner"),this._step=e}},{key:"changeLargeStep",value:function(e){return e||10*this.step}},{key:"validity",get:function(){var e=this.value,t={};return null!=e&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}},{key:"changeValue",value:function(e,t){var r,i=this;e||0===e?("number"!=typeof e&&(e="string"==typeof e?i.formatter.parse(e):Number(e),(r=isNaN(e))&&(e="")),!r&&i.format&&(e=i.formatter.round(e))):e=void 0;return tt()(Ze()(n.prototype),"changeValue",this).call(this,e,t)}},{key:"inputValue",get:function(){var e=this.value;return null!=e&&this.format&&(e=this.formatValue(e)),e}}],[{key:"$name",get:function(){return"NumberField"}},{key:"type",get:function(){return"numberfield"}},{key:"alias",get:function(){return"number"}},{key:"configurable",get:function(){return{min:null,max:null,step:1,largeStep:0,value:null,format:"",decimalPrecision:null,leadingZeroes:null,triggers:{spin:{type:"spintrigger"}},changeOnSpin:!0,inputType:null}}}]),n}(tv);function Yv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Gv.initClass(),Gv._$name="NumberField";var qv=function(e){Ye()(n,e);var t=Yv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;tt()(Ze()(n.prototype),"construct",this).call(this,e),t._pm=!1,t.fieldHours.on("change",t.onFieldChange,t),t.fieldMinutes.on("change",t.onFieldChange,t),t.buttonAM.on("click",t.onButtonAMClick,t),t.buttonPM.on("click",t.onButtonPMClick,t),Tu.on({element:t.element,keydown:"onPickerKeyDown",thisObj:t}),Tu.on({element:t.fieldHours.element,keydown:"onPickerKeyDown",thisObj:t}),Tu.on({element:t.fieldMinutes.element,keydown:"onPickerKeyDown",thisObj:t}),t.refresh()}},{key:"onFieldChange",value:function(){var e=this;e._time&&(e.value=e.pickerToTime())}},{key:"onButtonAMClick",value:function(){var e=this;e._pm=!1,e._time&&(e.value=e.pickerToTime())}},{key:"onButtonPMClick",value:function(){var e=this;e._pm=!0,e._time&&(e.value=e.pickerToTime())}},{key:"onPickerKeyDown",value:function(e){var t=this;switch(e.key&&e.key.trim()||e.code){case"Escape":t.triggerTimeChange(t._initialValue),t.hide(),e.preventDefault();break;case"Enter":t.value=t.pickerToTime(),t.hide(),e.preventDefault()}}},{key:"pickerToTime",value:function(){var e=this,t=e._pm;e.fieldHours.format=e._is24Hour?"2>9":null;var n=e.fieldHours.value,r=new Date(e._time);return e._is24Hour||(t&&n<12&&(n+=12),t||12!==n||(n=0)),r.setHours(n),r.setMinutes(e.fieldMinutes.value),e._min&&(r=Un.max(e._min,r)),e._max&&(r=Un.min(e._max,r)),r}},{key:"triggerTimeChange",value:function(e){this.trigger("timeChange",{time:e})}},{key:"value",get:function(){return this._time},set:function(e){var t=this,r=!1;e&&t._time?e.getTime()!==t._time.getTime()&&(t._time=e,r=!0):(t._time=n.defaultConfig.value,r=!0),r&&(t.isVisible&&t.triggerTimeChange(t.value),t.refresh())}},{key:"format",get:function(){return this._format},set:function(e){var t=this;t._format=e,t._is24Hour=Un.is24HourFormat(t._format),t.refresh()}},{key:"min",get:function(){return this._min},set:function(e){this._min=e}},{key:"max",get:function(){return this._max},set:function(e){this._max=e}},{key:"initialValue",get:function(){return this._initialValue},set:function(e){this.value=e,this._initialValue=e}},{key:"buttonAM",get:function(){return this.widgetMap.buttonAM}},{key:"buttonPM",get:function(){return this.widgetMap.buttonPM}},{key:"fieldHours",get:function(){return this.widgetMap.fieldHours}},{key:"fieldMinutes",get:function(){return this.widgetMap.fieldMinutes}},{key:"refresh",value:function(){var e=this;if(!e.isConfiguring){var t=e._time,n=e._is24Hour,r=t.getHours(),i=e._pm=r>=12,o=e.fieldHours;e.element.classList[n?"add":"remove"]("b-24h"),o.min=n?0:1,o.max=n?23:12,o.value=n?r:r%12||12,e.fieldMinutes.value=t.getMinutes(),e.buttonAM.pressed=!i,e.buttonPM.pressed=i,e.buttonAM.hidden=e.buttonPM.hidden=n}}}],[{key:"$name",get:function(){return"TimePicker"}},{key:"type",get:function(){return"timepicker"}},{key:"defaultConfig",get:function(){return{items:[{type:"number",ref:"fieldHours",min:0,max:23,highlightExternalChange:!1,format:"2>9"},{html:"<label>:</label>"},{type:"number",ref:"fieldMinutes",min:0,max:59,highlightExternalChange:!1,format:"2>9"},{type:"button",text:"AM",toggleGroup:"am-pm",ref:"buttonAM",cls:"b-blue"},{type:"button",text:"PM",toggleGroup:"am-pm",ref:"buttonPM",cls:"b-blue"}],float:"1",autoShow:!1,trapFocus:!0,value:Un.getTime(0),format:null}}}]),n}(xf);function Kv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}qv.initClass(),qv._$name="TimePicker";var Xv=function(e){Ye()(n,e);var t=Kv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changePicker",value:function(e,t){var n=this;return qv.reconfigure(t,e,{owner:n,defaults:{forElement:n[n.pickerAlignElement],owner:n,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},onTimeChange:function(e){var t=e.time;n._isUserAction=!0,n.value=t,n._isUserAction=!1}}})}},{key:"onBackClick",value:function(){var e=this,t=e.min;if(!e.readOnly&&e.value){var n=Un.add(e.value,-1*e.step.magnitude,e.step.unit);(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"onForwardClick",value:function(){var e=this,t=e.max;if(!e.readOnly&&e.value){var n=Un.add(e.value,e.step.magnitude,e.step.unit);(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"isValid",get:function(){var e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);var t=e.value;if(t){if(t=t.getTime(),e._min&&e._min.getTime()>t)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(e._max&&e._max.getTime()<t)return e.setError("L{Field.maximumValueViolation}",!0),!1}return tt()(Ze()(n.prototype),"isValid",this)}},{key:"hasChanged",value:function(e,t){return e&&e.getTime&&t&&t.getTime?e.getHours()!==t.getHours()||e.getMinutes()!==t.getMinutes()||e.getSeconds()!==t.getSeconds()||e.getMilliseconds()!==t.getMilliseconds():tt()(Ze()(n.prototype),"hasChanged",this).call(this,e,t)}},{key:"showPicker",value:function(e){var t=this,r=t.picker;t.readOnly||(r.initialValue=t.value,r.format=t.format,r.maxTime=t.max,r.minTime=t.min,t.value=r.value,tt()(Ze()(n.prototype),"showPicker",this).call(this,e))}},{key:"onPickerShow",value:function(){var e;tt()(Ze()(n.prototype),"onPickerShow",this).call(this),this.pickerKeyDownRemover=null===(e=this.pickerKeyDownRemover)||void 0===e?void 0:e.call(this)}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"transformTimeValue",value:function(e){return null!=e&&(Un.isDate(e)||(e="string"==typeof e?Un.parse(e,this.format):new Date(e)),Un.isValidDate(e))?Un.getTime(e):null}},{key:"changeMin",value:function(e){return this.transformTimeValue(e)}},{key:"updateMin",value:function(e){var t=this.input;t&&(null==e?t.removeAttribute("min"):t.min=e),this.syncInvalid()}},{key:"changeMax",value:function(e){return this.transformTimeValue(e)}},{key:"updateMax",value:function(e){var t=this.input;t&&(null==e?t.removeAttribute("max"):t.max=e),this.syncInvalid()}},{key:"changeValue",value:function(e,t){var r=this,i=r.transformTimeValue(e);if(e&&!i||r.isRequired&&""===e)r.setError("L{invalidTime}");else{if(r.clearError("L{invalidTime}"),r.hasChanged(t,i))return tt()(Ze()(n.prototype),"changeValue",this).call(this,i,t);r.inputting||r.syncInputFieldValue(!0)}}},{key:"updateValue",value:function(e,t){var r=this.triggers.expand;r&&e&&(r.element.firstElementChild.style.animationDelay=-(60*e.getHours()+e.getMinutes())/10+"s"),tt()(Ze()(n.prototype),"updateValue",this).call(this,e,t)}},{key:"changeStep",value:function(e,t){var n=I()(e);return e?("number"===n?e={magnitude:Math.abs(e),unit:t?t.unit:"hour"}:"string"===n&&(e=Un.parseDuration(e)),e&&e.unit&&e.magnitude?(e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e):void 0):null}},{key:"updateStep",value:function(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}},{key:"updateFormat",value:function(){this.syncInputFieldValue(!0)}},{key:"inputValue",get:function(){return Un.format(this.value,this.format)}},{key:"updateLocalization",value:function(){tt()(Ze()(n.prototype),"updateLocalization",this).call(this),this.syncInputFieldValue(!0)}}],[{key:"$name",get:function(){return"TimeField"}},{key:"type",get:function(){return"timefield"}},{key:"alias",get:function(){return"time"}},{key:"configurable",get:function(){return{picker:{type:"timepicker",floating:!0,align:{align:"t0-b0",axisLock:!0}},format:"LT",triggers:{expand:{align:"end",handler:"onTriggerClick",compose:function(){return{children:[{class:{"b-icon-clock-live":1}}]}}},back:{align:"start",cls:"b-icon b-icon-angle-left b-step-trigger",handler:"onBackClick"},forward:{align:"end",cls:"b-icon b-icon-angle-right b-step-trigger",handler:"onForwardClick"}},min:null,max:null,step:"5m",stepTriggers:null,value:null}}}]),n}(ov);function Zv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Xv.initClass(),Xv._$name="TimeField";var Jv=function(e){Ye()(n,e);var t=Zv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"focusElement",get:function(){return this.dateField.input}},{key:"innerElements",get:function(){return[this.dateField.element,this.timeField.element]}},{key:"internalOnKeyEvent",value:function(){}},{key:"updateRevertOnEscape",value:function(e){this.timeField.revertOnEscape=e,this.dateField.revertOnEscape=e}},{key:"changeTimeField",value:function(e){var t=this,n=Xv.new({revertOnEscape:t.revertOnEscape,syncInvalid:function(){for(var e=t.updatingInvalid,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];Xv.prototype.syncInvalid.apply(this,r),t.timeField&&!e&&t.syncInvalid()}},e);return Tu.on({element:n.element,keydown:"onTimeFieldKeyDown",thisObj:t}),t.readOnly&&(n.readOnly=!0),n}},{key:"updateTimeField",value:function(e){var t=this;e.on({change:function(e){var n=e.userAction,r=e.value;if(n&&!t.$settingValue){var i=t.dateField.value;t._isUserAction=!0,t.value=i?Un.copyTimeValues(i,r):null,t._isUserAction=!1}},thisObj:t})}},{key:"changeDateField",value:function(e){var t=this,n=this,r=(null==e?void 0:e.type)||"datefield",i=uc.resolveType(e.type||"datefield"),o=uc.create(Qn.assign({type:r,revertOnEscape:n.revertOnEscape,syncInvalid:function(){for(var e=n.updatingInvalid,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];i.prototype.syncInvalid.apply(this,r),n.dateField&&!e&&n.syncInvalid()}},e));return Tu.on({element:o.element,keydown:"onDateFieldKeyDown",thisObj:n}),n.readOnly&&(o.readOnly=!0),o.on({keydown:function(e){var n,r=e.event;"Tab"===r.key&&!r.shiftKey&&null!==(n=t.timeField)&&void 0!==n&&n.isVisible&&(r.stopPropagation(),r.cancelBubble=!0)}}),o}},{key:"childItems",get:function(){return[this.dateField,this.timeField]}},{key:"updateDateField",value:function(e){var t=this;e.on({change:function(e){var n=e.userAction,r=e.value;n&&!t.$isInternalChange&&(t._isUserAction=!0,t.value=r,t._isUserAction=!1)},thisObj:t})}},{key:"updateWeekStartDay",value:function(e){this.dateField&&(this.dateField.weekStartDay=e)}},{key:"changeWeekStartDay",value:function(e){var t,n;return"number"==typeof e?e:null!==(t=null===(n=this.dateField)||void 0===n?void 0:n.weekStartDay)&&void 0!==t?t:Un.weekStartDay}},{key:"syncInputFieldValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.isConfiguring;tt()(Ze()(n.prototype),"syncInputFieldValue",this).call(this,!0),e||this.highlightExternalChange||(e=!0);var t=this,r=t.dateField.highlightExternalChange,i=t.timeField.highlightExternalChange;t.$isInternalChange=!0,t.dateField.highlightExternalChange=!1,t.dateField.value=null,t.dateField.highlightExternalChange=r,e&&(t.timeField.highlightExternalChange=t.dateField.highlightExternalChange=!1),t.timeField.value=t.dateField.value=t.inputValue,t.dateField.highlightExternalChange=r,t.timeField.highlightExternalChange=i,t.$isInternalChange=!1,t.syncInvalid()}},{key:"onTimeFieldKeyDown",value:function(e){var t=this;if("Enter"===e.key||"Tab"===e.key){var n=t.dateField.value;t._isUserAction=!0,t.value=n?Un.copyTimeValues(n,t.timeField.value):null,t._isUserAction=!1}}},{key:"onDateFieldKeyDown",value:function(e){var t=this;"Tab"===e.key&&(e.stopPropagation(),e.preventDefault(),t.timeField.focus()),"Enter"===e.key&&(t.value=t.dateField.value)}},{key:"updateRequired",value:function(e,t){this.timeField.required=this.dateField.required=e}},{key:"updateReadOnly",value:function(e,t){tt()(Ze()(n.prototype),"updateReadOnly",this).call(this,e,t),this.isConfiguring||(this.timeField.readOnly=this.dateField.readOnly=e)}},{key:"onDisabled",value:function(e){this.timeField.disabled=this.dateField.disabled=e}},{key:"focus",value:function(){this.dateField.focus()}},{key:"hasChanged",value:function(e,t){return!Un.isEqual(e,t)}},{key:"isValid",get:function(){return this.timeField.isValid&&this.dateField.isValid}},{key:"setError",value:function(e,t){[this.dateField,this.timeField].forEach((function(n){return n.setError(e,t)}))}},{key:"getErrors",value:function(){var e=[].concat(F()(this.dateField.getErrors()||[]),F()(this.timeField.getErrors()||[]));return e.length?e:null}},{key:"clearError",value:function(e,t){[this.dateField,this.timeField].forEach((function(n){return n.clearError(e,t)}))}},{key:"updateInvalid",value:function(){this.updatingInvalid=!0,[this.dateField,this.timeField].forEach((function(e){return e.updateInvalid()})),this.updatingInvalid=!1}}],[{key:"configurable",get:function(){return{timeField:{},dateField:{keepTime:!0,step:"1 d"},weekStartDay:null,inputTemplate:function(){return""}}}},{key:"$name",get:function(){return"DateTimeField"}},{key:"type",get:function(){return"datetimefield"}},{key:"alias",get:function(){return"datetime"}}]),n}(tv);function Qv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Jv.initClass(),Jv._$name="DateTimeField";var ep=function(e){Ye()(n,e);var t=Qv(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"focusElement",get:function(){}},{key:"changeReadOnly",value:function(){return!0}},{key:"changeEditable",value:function(){return!1}},{key:"inputElement",get:function(){return{tag:"span",html:this.template?this.template(this.value):te.encodeHtml(this.value)}}}],[{key:"$name",get:function(){return"DisplayField"}},{key:"type",get:function(){return"displayfield"}},{key:"alias",get:function(){return"display"}},{key:"configurable",get:function(){return{readOnly:!0,editable:!1,cls:"b-display-field",template:null}}}]),n}(rv);function tp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ep.initClass(),ep._$name="DisplayField";var np=function(e){Ye()(n,e);var t=tp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeMin",value:function(e){return"string"==typeof e?new Bo(e):e}},{key:"changeMax",value:function(e){return"string"==typeof e?new Bo(e):e}},{key:"changeAllowedUnits",value:function(e){return"string"==typeof e&&(e=e.split(",")),e}},{key:"updateAllowedUnits",value:function(e){this.allowedUnitsRe=new RegExp("(".concat(e.join("|"),")"),"i")}},{key:"inputValue",get:function(){return null==this.value?"":this.calcValue(!0).toString(this.useAbbreviation)}},{key:"unit",get:function(){return this._unit},set:function(e){this._unit=e,this.value=this.calcValue()}},{key:"magnitude",get:function(){return this._magnitude},set:function(e){this.clearError("L{invalidUnit}"),this._magnitude=e,gh()(Ze()(n.prototype),"value",this.calcValue(),this,!0)}},{key:"roundMagnitude",value:function(e){return e&&null!=this.decimalPrecision?Qn.round(e,this.decimalPrecision):e}},{key:"allowDecimals",get:function(){return 0!==this.decimalPrecision}},{key:"isValid",get:function(){var e=this,t=null==e.value||e.value&&null==e.value.magnitude;return tt()(Ze()(n.prototype),"isValid",this)&&(t&&!e.required||!t&&(e.allowNegative||e.value.magnitude>=0))}},{key:"internalOnChange",value:function(e){var t=this,n=t.value,r=t._lastValue;t.hasChanged(r,n)&&(t._lastValue=n,t.triggerFieldChange({value:n,event:e,userAction:!0,valid:t.isValid}))}},{key:"onFocusOut",value:function(e){return this.syncInputFieldValue(!0),tt()(Ze()(n.prototype),"onFocusOut",this).call(this,e)}},{key:"value",get:function(){return tt()(Ze()(n.prototype),"value",this)},set:function(e){var t,r,i=this;if(this.clearError("L{invalidUnit}"),"number"==typeof e)t=e,r=i._unit;else if("string"==typeof e){var o=Un.parseDuration(e,i.allowDecimals,i._unit||n.defaultConfig.defaultUnit);o&&(!i.allowedUnitsRe||i.allowedUnitsRe.test(o.unit)?(r=o.unit,t=o.magnitude):i.setError("L{invalidUnit}"))}else e&&"unit"in e&&"magnitude"in e?(r=e.unit,t=e.magnitude):(r=null,t=null);i._magnitude===t&&i._unit===r||(i._magnitude=t,i._unit=r,gh()(Ze()(n.prototype),"value",i.calcValue(),this,!0))}},{key:"okMax",value:function(e){return null==this.max||e<=this.max}},{key:"okMin",value:function(e){return null==this.min||e>=this.min}},{key:"validity",get:function(){var e=this.value,t={};return null!=e&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}},{key:"calcValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;return t._unit&&null!=t._magnitude||!t.clearable?new Bo(e?this.roundMagnitude(t._magnitude):this._magnitude,t._unit||n.defaultConfig.defaultUnit):null}},{key:"hasChanged",value:function(e,t){return t&&!e||!t&&e||t&&e&&!e.isEqual(t)}},{key:"milliseconds",get:function(){return this.value?this.value.milliseconds:0}},{key:"onInternalKeyDown",value:function(e){"ArrowUp"===e.key?this.doSpinUp():"ArrowDown"===e.key&&this.doSpinDown()}},{key:"doSpinUp",value:function(){var e=this,t=(e.magnitude||0)+e.step;e._isUserAction=!0,e.okMin(t)||(t=e.min),e.okMax(t)&&(e.value=t),e._isUserAction=!1}},{key:"doSpinDown",value:function(){var e=this,t=(e.magnitude||0)-e.step;e.okMax(t)||(t=e.max),(e.okMin(t)&&e.allowNegative||(e.magnitude||0)>0)&&(e._isUserAction=!0,e.value=t,e._isUserAction=!1)}}],[{key:"$name",get:function(){return"DurationField"}},{key:"type",get:function(){return"durationfield"}},{key:"alias",get:function(){return"duration"}},{key:"defaultConfig",get:function(){return{value:null,step:1,unit:null,defaultUnit:"day",magnitude:null,useAbbreviation:!1,allowNegative:!1,decimalPrecision:null,triggers:{spin:{type:"spintrigger"}},nullValue:null}}},{key:"configurable",get:function(){return{min:null,max:null,allowedUnits:null}}}]),n}(rv);function rp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}np.initClass(),np._$name="DurationField";var ip=function(e){Ye()(n,e);var t=rp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"Fit"}},{key:"type",get:function(){return"fit"}},{key:"configurable",get:function(){return{containerCls:"b-fit-container",itemCls:"b-fit-item"}}}]),n}(fc);function op(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ap(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ip.initClass(),ip._$name="Fit";var sp=function(e){Ye()(r,e);var t,n=ap(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"afterConfigure",value:function(){var e=this;tt()(Ze()(r.prototype),"afterConfigure",this).call(this),e.onTargetSizeChange=e.onTargetSizeChange.bind(e),(e.completeKey||e.cancelKey)&&Tu.on({element:e.element,keydown:"onKeyDown",thisObj:e}),e.on({hide:"afterEditorHide",thisObj:e}),Yt.on({locale:"onLocaleChange",thisObj:e})}},{key:"onLocaleChange",value:function(){var e=this.inputField;e&&!e.isDestroyed&&e.syncInputFieldValue&&e.syncInputFieldValue(!0)}},{key:"startEdit",value:function(e){var t=e.target,n=e.align,r=void 0===n?this.align:n,i=e.hideTarget,o=void 0!==i&&i,a=e.matchSize,s=void 0===a||a,l=e.matchFont,u=void 0===l||l,c=e.fitTargetContent,f=void 0!==c&&c,d=e.value,h=e.record,v=e.field,p=void 0===v?this.inputField.name:v,g=e.focus,y=void 0===g||g,m=this,b=m.inputField,k=mi.getStyleValue(t,"font-size"),w=mi.getStyleValue(t,"font-family");if(!1!==m.trigger("beforeStart",{value:d})){var C;if(h&&p&&void 0===d&&(m.record=h,m.dataField=p,d=h[p]),s&&(t instanceof HTMLElement&&m.updateSize(t),t instanceof HTMLElement&&bu.addResizeListener(t,m.onTargetSizeChange)),b.input&&(u?(b.input.style.fontSize=k,b.input.style.fontFamily=w):b.input.style.fontSize=b.input.style.fontFamily=""),m._isSettingValues=!0,b.clearError&&b.clearError(),b.value=d,m._isSettingValues=!1,m.showBy(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?op(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):op(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({target:t},r)),f){var R=b.input.scrollWidth-b.input.clientWidth;R>0&&(m.width+=R+mi.scrollBarWidth)}return y&&m.inputField.focus&&m.inputField.focus(),t.nodeType===Element.ELEMENT_NODE&&(t.classList.add("b-editing"),o&&t.classList.add("b-hide-visibility")),m.editing=!0,m.trigger("start",{value:b.value}),Array.isArray(b.value)&&b.editingRecords&&null!==(C=b.value[0])&&void 0!==C&&C.isModel?m.oldValue=b.value.map((function(e){return e.copy(e.id)})):(m.oldValue=b.value,Array.isArray(m.oldValue)&&(m.oldValue=m.oldValue.slice())),b.initialValue=m.oldValue,!0}return!1}},{key:"refreshEdit",value:function(){if(this.isVisible){var e=this.record,t=this.dataField,n=this.inputField;if(e&&t){var r=e[t];Qn.isEqual(n.value,r)||(n.value=r)}}}},{key:"finishEdit",value:function(){var e=this.lastAlignSpec.target;e.nodeType===Element.ELEMENT_NODE&&(e.classList.remove("b-editing"),e.classList.remove("b-hide-visibility")),this.editing=!1,this.trigger("finishEdit")}},{key:"onKeyDown",value:function(e){var t,n=this;switch(e.key){case n.completeKey:n.completeEdit(null,e),e.stopImmediatePropagation();break;case n.cancelKey:n.cancelEdit(e),e.stopImmediatePropagation()}null===(t=n.trigger)||void 0===t||t.call(n,"keydown",{event:e})}},{key:"onFocusOut",value:function(e){tt()(Ze()(r.prototype),"onFocusOut",this).call(this,e);var t=this;if(!t.isFinishing&&t.editing){var n=t["".concat(t.blurAction,"Edit")];null==n||n.call(t)}}},{key:"completeEdit",value:(t=Pt()(At.a.mark((function e(t,n){var r,i,o,a,s,l,u,c,f,d,h;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(r=this).inputField,o=r.oldValue,a=r.record,s=i.invalidAction||(!1===i.allowInvalid?"block":r.invalidAction),l=i.value,r.isVisible){e.next=3;break}return e.abrupt("return");case 3:if(i.isValid||"allow"===s){e.next=14;break}if("block"!==s){e.next=9;break}return i.focus&&i.focus(),e.abrupt("return",!1);case 9:if("revert"!==s){e.next=12;break}return r.cancelEdit(n),e.abrupt("return",!0);case 12:e.next=35;break;case 14:if(!Qn.isEqual(l,o)){e.next=19;break}return r.cancelEdit(n),e.abrupt("return",!0);case 19:if(u={inputField:i,record:a,value:l,oldValue:o},!1!==r.trigger("beforeComplete",u)){e.next=24;break}i.focus&&i.focus(),e.next=35;break;case 24:if(t||(t=u.finalize||u.editorContext&&u.editorContext.finalize),!t){e.next=33;break}return e.next=28,t(u);case 28:return!0===(c=e.sent)?r.onEditComplete():(i.setError&&(f=c||i.invalidValueError,d=function(){h(),i.clearError(f)},h=i.on({change:d,input:d}),i.setError(f)),"block"===s?i.focus&&i.focus():"revert"===s&&(i.value=o,c=!0),c=!1),e.abrupt("return",c);case 33:return r.onEditComplete(),e.abrupt("return",!0);case 35:return e.abrupt("return",!1);case 36:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"cancelEdit",value:function(e){var t=this,n=t.inputField,r=t.oldValue,i=n.value;t.editing&&!t.isFinishing&&!1!==t.trigger("beforeCancel",{value:i,oldValue:r,event:e})&&(t.isFinishing=!0,t.hide(),t.trigger("cancel",{value:i,oldValue:r,event:e}),t.finishEdit(),t.isFinishing=!1)}},{key:"onEditComplete",value:function(){var e=this,t=e.record,n=e.dataField,r=e.inputField,i=e.oldValue,o=r.value;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){var a="set".concat(te.capitalize(n));t[a]?t[a](o):t[n]=o}e.trigger("complete",{value:o,oldValue:i}),e.finishEdit(),e.isFinishing=!1}}},{key:"doDestroy",value:function(){this.createdInputField&&this.inputField.destroy(),tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"owner",get:function(){return this._owner||uc.fromElement(this.element.parentNode)},set:function(e){this._owner=e}},{key:"changeInputField",value:function(e,t){var n=this;return t&&t.destroy(),"string"==typeof e&&(e={type:e}),e instanceof uc||(e=uc.create(e),n.createdInputField=!0),n.completeOnChange&&e.on({change:"onInputFieldChange",thisObj:n}),e.parent=n,e}},{key:"updateInputField",value:function(e){this.removeAll(),this.add(e)}},{key:"inputField",get:function(){return this.items[0]}},{key:"onInputFieldChange",value:function(){this.containsFocus&&this.completeEdit()}},{key:"onTargetSizeChange",value:function(e,t,n){t&&n&&this.updateSize(e)}},{key:"updateSize",value:function(e){var t=e.getBoundingClientRect();this.width=t.width-this.align.offset[0],this.height=t.height}},{key:"afterEditorHide",value:function(){bu.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}}],[{key:"$name",get:function(){return"Editor"}},{key:"type",get:function(){return"editor"}},{key:"configurable",get:function(){return{positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null,isolateFields:!0}}}]),r}(Rc);function lp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}sp.initClass(),sp._$name="Editor";var up=function(e){Ye()(n,e);var t=lp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"internalOnChange",value:function(e){tt()(Ze()(n.prototype),"internalOnInput",this).call(this,e),tt()(Ze()(n.prototype),"internalOnChange",this).call(this,e)}},{key:"internalOnInput",value:function(){}},{key:"files",get:function(){return this.input.files}},{key:"pickFile",value:function(){this.input.click()}},{key:"multiple",get:function(){return this._multiple?"":null}},{key:"clear",value:function(){this.input.value=null}},{key:"triggerChange",value:function(e){this.triggerFieldChange({event:e,value:this.input.value,oldValue:this._lastValue,userAction:!0,valid:!0})}}],[{key:"$name",get:function(){return"FileField"}},{key:"type",get:function(){return"filefield"}},{key:"configurable",get:function(){return{multiple:null,accept:null,inputType:"file",attributes:["multiple","accept"]}}}]),n}(tv);function cp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}up.initClass(),up._$name="FileField";var fp=function(e){Ye()(n,e);var t=cp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.items=[Object.assign({type:"button",ref:"fileButton",text:"L{FilePicker.file}",localeClass:this},e.buttonConfig),Object.assign({type:"filefield",ref:"fileField",style:"display: none"},e.fileFieldConfig)].concat(e.items||[]),tt()(Ze()(n.prototype),"construct",this).call(this,e),t.button.on({click:t.onButtonClick,thisObj:t}),t.fileField.on({change:t.onFileFieldChange,thisObj:t}),t._thisIsAUsedExpression(t.fileTip)}},{key:"button",get:function(){return this.widgetMap.fileButton}},{key:"fileField",get:function(){return this.widgetMap.fileField}},{key:"files",get:function(){return this.fileField.files}},{key:"fileTip",get:function(){var e=this;return e._fileTip||(e._fileTip=new kh({cls:"b-file-tip",forElement:e.button.element,showOnHover:!0,align:"b-t",scrollAction:"realign",listeners:{beforeshow:function(){var t=e.files;return!(!t||!t.length)&&(this.html="".concat(Array.from(t).map((function(e){return e.name})).join("<br>")),!0)}}}))}},{key:"clear",value:function(){var e=this;e.fileField.clear(),e.button.badge="",e.trigger("clear")}},{key:"onButtonClick",value:function(e){var t=e.event;this.fileField.pickFile(),t.preventDefault()}},{key:"onFileFieldChange",value:function(e){var t=e.valid,n=this;n.button.badge=n.files.length||"",n.triggerFieldChange({files:n.files,valid:t})}}],[{key:"$name",get:function(){return"FilePicker"}},{key:"type",get:function(){return"filepicker"}},{key:"defaultConfig",get:function(){return{defaultBindProperty:"value",buttonConfig:null,fileFieldConfig:null}}}]),n}(Rc);function dp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fp.initClass(),fp._$name="FilePicker";var hp=function(e){Ye()(n,e);var t=dp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateValue",value:function(e,t){tt()(Ze()(n.prototype),"updateValue",this).call(this,e,t),e&&this.isConfiguring&&this.onChange({value:e})}}],[{key:"$name",get:function(){return"FilterField"}},{key:"type",get:function(){return"filterfield"}},{key:"configurable",get:function(){return{field:null,store:null,filterFunction:null,clearable:!0,keyStrokeChangeDelay:100,onChange:function(e){var t=e.value,n=this.store,r=this.field,i=this.filterFunction;if(n){var o,a="".concat(r||this.id,"-Filter");if(0===t.length)n.removeFilter(a);else i?o=function(e){return i(e,t)}:(t=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=function(e){return e.get(r).match(new RegExp(t,"i"))}),n.filter({id:a,filterBy:o})}}}}}]),n}(rv);function vp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}hp.initClass(),hp._$name="FilterField";var pp=function(e){Ye()(n,e);var t=vp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){return{tag:"label",text:this.text,html:this.html}}}]),n}(uc);function gp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Qe()(pp,"$name","Label"),Qe()(pp,"type","label"),Qe()(pp,"configurable",{text:null}),pp.initClass(),pp._$name="Label";var yp=[{ref:"cancelButton",cls:"b-messagedialog-cancelbutton b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelClick"},{ref:"okButton",cls:"b-messagedialog-okbutton b-raised b-blue",text:"L{Object.Ok}",onClick:"up.onOkClick"}];pe.a.isWindows&&yp.reverse();var mp=function(e){Ye()(o,e);var t,n,r,i=gp(o);function o(){return B()(this,o),i.apply(this,arguments)}return _()(o,[{key:"construct",value:function(){this.okButton=this.yesButton=1,this.cancelButton=3,tt()(Ze()(o.prototype),"construct",this).apply(this,arguments)}},{key:"confirm",value:(r=Pt()(At.a.mark((function e(){var t=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.showDialog.apply(this,["confirm"].concat(Array.prototype.slice.call(t))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"alert",value:(n=Pt()(At.a.mark((function e(){var t=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.showDialog.apply(this,["alert"].concat(Array.prototype.slice.call(t))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"prompt",value:(t=Pt()(At.a.mark((function e(t){var n,r,i=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.textField,r=this.widgetMap.input,uc.reconfigure(r,n),r.value="",e.abrupt("return",this.showDialog.apply(this,["prompt"].concat(Array.prototype.slice.call(i))));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"showDialog",value:function(e,t){var n=t.message,r=void 0===n?"":n,i=t.title,o=void 0===i?" ":i,a=t.cancelButton,s=t.okButton,l=t.rootElement,u=void 0===l?document.body:l,c=this;return c.rootElement=u,c.getConfig("lazyItems"),c.title=c.optionalL(o),c.widgetMap.message.html=c.optionalL(r),c.element.classList.remove(c.showClass),c.showClass="b-messagedialog-".concat(e),c.element.classList.add(c.showClass),s&&(s="string"==typeof s?{text:s}:s),a&&(a="string"==typeof a?{text:a}:a),s=Object.assign({},c.widgetMap.okButton.initialConfig,s),a=Object.assign({},c.widgetMap.cancelButton.initialConfig,a),s.text=c.optionalL(s.text),a.text=c.optionalL(a.text),uc.reconfigure(c.widgetMap.okButton,s),uc.reconfigure(c.widgetMap.cancelButton,a),c.show(),c.promise=new Promise((function(e){c.resolve=e}))}},{key:"doResolve",value:function(e){var t=this,n=t.resolve;if(n){var r="b-messagedialog-prompt"===t.showClass;if(r&&e===t.okButton&&!t.widgetMap.input.isValid)return;t.resolve=t.reject=t.promise=null,n(r?{button:e,text:t.widgetMap.input.value}:e),t.hide()}}},{key:"onInternalKeyDown",value:function(e){"Escape"===e.key&&(e.stopImmediatePropagation(),this.onCancelClick()),"Enter"===e.key&&(e.stopImmediatePropagation(),e.preventDefault(),this.onOkClick()),tt()(Ze()(o.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"onOkClick",value:function(){this.doResolve(bp.okButton)}},{key:"onCancelClick",value:function(){this.doResolve(bp.cancelButton)}}],[{key:"$name",get:function(){return"MessageDialog"}},{key:"type",get:function(){return"messagedialog"}},{key:"configurable",get:function(){return{centered:!0,modal:!0,hidden:!0,autoShow:!1,closeAction:"hide",title:" ",lazyItems:{$config:["lazy"],value:[{cls:"b-messagedialog-message",ref:"message"},{type:"textfield",cls:"b-messagedialog-input",ref:"input"}]},bbar:{items:yp}}}}]),o}(xf);mp.initClass();var bp=new mp,kp=bp;function wp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Cp=function(e){Ye()(n,e);var t=wp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"parent",get:function(){return tt()(Ze()(n.prototype),"parent",this)},set:function(e){gh()(Ze()(n.prototype),"parent",e,this,!0),this.store||(this.store=e.store)}},{key:"store",get:function(){return this._store},set:function(e){var t=this,n={beforerequest:"onStoreBeforeRequest",afterrequest:"onStoreChange",change:"onStoreChange",thisObj:t};t.store&&t.store.un(n),t._store=e,e&&(e.on(n),e.isLoading&&t.onStoreBeforeRequest())}},{key:"onStoreBeforeRequest",value:function(){this.eachWidget((function(e){return e.disable()}))}},{key:"updateLocalization",value:function(){var e=this,t=e.widgetMap,r=t.reloadButton,i=t.firstPageButton,o=t.previousPageButton,a=t.nextPageButton,s=t.lastPageButton;i.tooltip=e.L("L{firstPage}"),o.tooltip=e.L("L{prevPage}"),a.tooltip=e.L("L{nextPage}"),s.tooltip=e.L("L{lastPage}"),r.tooltip=e.L("L{reload}"),e.updateSummary(),tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}},{key:"updateSummary",value:function(){var e,t,n,r,i,o=this,a=o.widgetMap,s=a.pageCount,l=a.dataSummary;if(e=t=n=r=i=0,o.store){var u=o.store,c=u.pageSize,f=u.currentPage;e=u.count,t=u.lastPage,i=u.allCount,n=Math.max(0,(f-1)*c+1),r=Math.min(i,n+c-1)}s.html=o.L("L{pageCountTemplate}")({lastPage:t}),l.html=e?o.L("L{summaryTemplate}")({start:n,end:r,allCount:i}):o.L("L{noRecords}")}},{key:"onStoreChange",value:function(){var e=this,t=e.widgetMap,n=e.store,r=n.count,i=n.lastPage,o=n.currentPage,a=t.pageNumber,s=t.pageCount,l=t.firstPageButton,u=t.previousPageButton,c=t.nextPageButton,f=t.lastPageButton,d=t.dataSummary;e.eachWidget((function(e){return e.enable()})),a.value=o,a.max=i,d.disabled=a.disabled=s.disabled=!r,l.disabled=u.disabled=o<=1||!r,c.disabled=f.disabled=o>=i||!r,e.updateSummary()}},{key:"onPageNumberChange",value:function(e){var t=e.value;this.store.currentPage!==t&&this.store.loadPage(t)}},{key:"onFirstPageClick",value:function(){this.store.loadPage(1)}},{key:"onPreviousPageClick",value:function(){this.store.previousPage()}},{key:"onNextPageClick",value:function(){this.store.nextPage()}},{key:"onLastPageClick",value:function(){this.store.loadPage(this.store.lastPage)}},{key:"onReloadClick",value:function(){this.store.loadPage(this.store.currentPage)}}],[{key:"$name",get:function(){return"PagingToolbar"}},{key:"type",get:function(){return"pagingtoolbar"}},{key:"defaultConfig",get:function(){return{store:null,defaults:{localeClass:this},items:{firstPageButton:{onClick:"up.onFirstPageClick",icon:"b-icon-first"},previousPageButton:{onClick:"up.onPreviousPageClick",icon:"b-icon-previous"},pageNumber:{type:"numberfield",label:"L{page}",min:1,max:1,triggers:null,onChange:"up.onPageNumberChange",highlightExternalChange:!1},pageCount:{type:"widget",cls:"b-pagecount b-toolbar-text"},nextPageButton:{onClick:"up.onNextPageClick",icon:"b-icon-next"},lastPageButton:{onClick:"up.onLastPageClick",icon:"b-icon-last"},separator:{type:"widget",cls:"b-toolbar-separator"},reloadButton:{onClick:"up.onReloadClick",icon:"b-icon-reload"},spacer:{type:"widget",cls:"b-toolbar-fill"},dataSummary:{type:"widget",cls:"b-toolbar-text"}}}}}]),n}(df);function Rp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Cp.initClass(),Cp._$name="PagingToolbar";var Sp=function(e){Ye()(n,e);var t=Rp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e=this.id,t=this.min,n=this.max,r=this.showValue,i=this.step,o=this.text,a=this.value,s="".concat(e,"-input"),l=Boolean(o||r);return{class:{"b-has-label":l,"b-text":l},children:{input:{tag:"input",type:"range",id:s,reference:"input",min:t,max:n,step:i,value:a,listeners:{input:"onInternalInput",change:"onInternalChange",mouseover:"onInternalMouseOver",mouseout:"onInternalMouseOut"}},label:{tag:"label",for:s,html:r?o?"".concat(o," (").concat(a,")"):a:o}}}}},{key:"focusElement",get:function(){return this.input}},{key:"percentProgress",get:function(){return(this.value-this.min)/(this.max-this.min)*100}},{key:"onInternalChange",value:function(){this.updateUI(),this.triggerChange(!0),this.trigger("action",{value:this.value})}},{key:"onInternalInput",value:function(){this.value=parseInt(this.input.value,10),this.trigger("input",{value:this.value})}},{key:"onInternalMouseOver",value:function(){var e;null===(e=this.tooltip)||void 0===e||e.showBy({target:this.calcThumbPosition(),offset:5})}},{key:"onInternalMouseOut",value:function(){var e;null===(e=this.tooltip)||void 0===e||e.hide()}},{key:"triggerChange",value:function(e){this.triggerFieldChange({value:this.value,valid:!0,userAction:e})}},{key:"updateMax",value:function(e){var t=this;t.input&&t._value>e&&(t.value=e,t.trigger("input",{value:t.value}))}},{key:"updateMin",value:function(e){var t=this;t.input&&t._value<e&&(t.value=e,t.trigger("input",{value:t.value}))}},{key:"changeTooltip",value:function(e,t){return e&&(e.owner=this),kh.reconfigure(t,e,{owner:this,defaults:{forElement:this.input,html:String(this.value)}})}},{key:"updateValue",value:function(e){var t=this,n=t.input,r=t._tooltip;r&&(r.html=t.value),n&&n.value!==String(e)&&(n.value=e,t.triggerChange(!1)),t.updateUI()}},{key:"calcThumbPosition",value:function(){var e=this,t=Cr.from(e.input),n=(t.width-e.thumbSize)*e.percentProgress/100;return new Cr(t.x+n,t.y+t.height/2-e.thumbSize/2,e.thumbSize,e.thumbSize)}},{key:"updateUI",value:function(){var e;null===(e=this._tooltip)||void 0===e||e.alignTo({target:this.calcThumbPosition(),offset:5})}}],[{key:"$name",get:function(){return"Slider"}},{key:"type",get:function(){return"slider"}},{key:"configurable",get:function(){return{text:null,showValue:!0,showTooltip:!1,min:0,max:100,step:1,value:50,thumbSize:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip",align:"b-t",anchor:!1,axisLock:!0}},localizableProperties:["text"]}}}]),n}(uc);function xp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Sp.initClass(),Sp._$name="Slider";var Ep=function(e){Ye()(n,e);var t=xp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){null!=e&&e.checked&&(e.cls=(e.cls||"")+" "+this.constructor.properties.toggledCls),tt()(Ze()(n.prototype),"construct",this).call(this,e)}},{key:"innerElements",get:function(){return[this.inputElement,this.toggleElement,{tag:"label",class:"b-slidetoggle-label",for:"".concat(this.id,"-input"),reference:"textLabel",html:this.text||""}]}},{key:"toggleElement",get:function(){return{class:"b-slidetoggle-toggle",reference:"slideToggle",children:[{class:"b-slidetoggle-thumb",reference:"slideThumb"}]}}},{key:"internalOnChange",value:function(){tt()(Ze()(n.prototype),"internalOnChange",this).call(this),this.element.classList[this.value?"add":"remove"](this.toggledCls)}}],[{key:"$name",get:function(){return"SlideToggle"}},{key:"type",get:function(){return"slidetoggle"}},{key:"properties",get:function(){return{toggledCls:"b-slidetoggle-checked"}}}]),n}(Bv);function Dp(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Tp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tp(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Tp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Op(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Op(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Op(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ap(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ep.initClass(),Ep._$name="SlideToggle";var Ip=function(e){return parseInt(mi.getStyleValue(e,"flex-basis"),10)||parseInt(mi.getStyleValue(e,"flex-grow"),10)},Pp=function(e){Ye()(n,e);var t=Ap(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"doDestroy",value:function(){this.mouseDetacher&&this.mouseDetacher(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"compose",value:function(){return{class:{"b-splitter":1},listeners:Mp({pointerdown:"onMouseDown"},!pe.a.supportsPointerEvents&&{mousedown:"onMouseDown",touchstart:"onMouseDown"})}}},{key:"currentOrientation",get:function(){return this._currentOrientation}},{key:"orientation",get:function(){return this._orientation},set:function(e){this._orientation=e,this._currentOrientation="auto"===e?null:e,this.updateOrientation()}},{key:"updateOrientation",value:function(){var e=this,t=this.element;if(e._prevOrientation&&t.classList.remove(e._prevOrientation),!e._currentOrientation&&e.rendered&&t.offsetParent){var n=mi.getStyleValue(t.parentElement,"flex-direction");if(n)e._currentOrientation=n.startsWith("column")?"horizontal":"vertical";else{var r=t.previousElementSibling,i=t.nextElementSibling;if(!r||!i)return;var o=r.getBoundingClientRect(),a=i.getBoundingClientRect(),s=o.top<a.top?o:a,l=s===a?o:a;e._currentOrientation=s.top!==l.top?"horizontal":"vertical"}}e._currentOrientation&&t.classList.add("b-".concat(e._currentOrientation)),e._prevOrientation=e._currentOrientation}},{key:"onMouseDown",value:function(e){e.preventDefault(),e.touches&&(e=e.touches[0]);var t=this,n=t.element,r=n.previousElementSibling,i=n.nextElementSibling,o=Ip(r),a=Ip(i),s=[];t.mouseDetacher&&t.mouseDetacher();var l,u=Dp(n.parentElement.children);try{for(u.s();!(l=u.n()).done;){var c=l.value;Ip(c)&&c!==n&&s.push({element:c,width:c.offsetWidth,height:c.offsetHeight})}}catch(e){u.e(e)}finally{u.f()}t.context={startX:e.pageX,startY:e.pageY,prevWidth:r.offsetWidth,prevHeight:r.offsetHeight,nextWidth:i.offsetWidth,nextHeight:i.offsetHeight,prevHasFlex:o,nextHasFlex:a,flexed:s,prev:r,next:i};var f={element:document,pointermove:"onMouseMove",pointerup:"onMouseUp",thisObj:t};pe.a.supportsPointerEvents||(f.mousemove="onMouseMove",f.touchmove="onMouseMove",f.mouseup=f.touchend="onMouseUp"),t.mouseDetacher=Tu.on(f)}},{key:"onMouseMove",value:function(e){var t=this,n=t.context,r=e.pageX-n.startX,i=e.pageY-n.startY;if(e.preventDefault(),Object.assign(n,{deltaX:r,deltaY:i}),n.started||(n.started=!0,t.trigger("start",{context:n,event:e}),n.flexed.forEach((function(e){"vertical"===t.currentOrientation?e.element.style.flexGrow=e.width:e.element.style.flexGrow=e.height,e.element.style.flexBasis="0"}))),"vertical"===t.currentOrientation){var o=n.prevWidth+r,a=n.nextWidth-r;n.prevHasFlex?n.prev.style.flexGrow=o:n.prev.style.width="".concat(o,"px"),n.nextHasFlex?n.next.style.flexGrow=a:n.next.style.width="".concat(a,"px")}else{var s=n.prevHeight+i,l=n.nextHeight-i;n.prevHasFlex?n.prev.style.flexGrow=s:n.prev.style.height="".concat(s,"px"),n.nextHasFlex?n.next.style.flexGrow=l:n.next.style.height="".concat(l,"px")}t.trigger("move",{context:n,event:e})}},{key:"onMouseUp",value:function(e){var t=this;t.mouseDetacher&&t.mouseDetacher(),t.mouseDetacher=null,t.context.started&&t.trigger("end",{context:t.context,event:e}),t.context=null}},{key:"render",value:function(){tt()(Ze()(n.prototype),"render",this).apply(this,arguments);var e=this;e._currentOrientation||(e.updateOrientation(),e._currentOrientation||e.requestAnimationFrame((function(){return e.updateOrientation()})))}}],[{key:"$name",get:function(){return"Splitter"}},{key:"type",get:function(){return"splitter"}},{key:"defaultConfig",get:function(){return{orientation:"auto"}}}]),n}(uc);function Fp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fp(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Pp.initClass(),Pp._$name="Splitter";var jp=function(e){Ye()(n,e);var t=Bp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"compose",value:function(){var e=this.active,t=this.cls,n=this.index;return{tabindex:-1,class:Lp({"b-tabpanel-tab":1,"b-active":e,"b-tab-first":this.isFirst,"b-tab-last":this.isLast},t),dataset:{index:n}}}},{key:"updateIndex",value:function(e){this.isFirst=!e}},{key:"updateItem",value:function(e,t){var n,r,i=this;(null==t?void 0:t.tab)===i&&(t.tab=null),e&&(e.tab=i,i[i.titleProperty]=e[i.titleSource],i.itemCls=e.cls),null===(n=i.itemChangeDetacher)||void 0===n||n.call(i),i.itemChangeDetacher=e&&at.after(e,"onConfigChange","onItemConfigChange",i,{return:!1}),null===(r=i.itemHideDetacher)||void 0===r||r.call(i),i.itemHideDetacher=null==e?void 0:e.on({beforeChangeHidden:"onItemBeforeChangeHidden",beforeHide:"onItemBeforeHide",beforeUpdateDisabled:"onItemBeforeUpdateDisabled",thisObj:i,prio:1e3}),i.syncMinMax()}},{key:"updateItemCls",value:function(e,t){var n=this.element,r=n&&xr.from(null==n?void 0:n.classList,!0);n&&(r.remove(t).add(e),n.className=r.value)}},{key:"updateRotate",value:function(e,t){!e!=!t&&this.syncMinMax()}},{key:"syncMinMax",value:function(){var e=this,t=e.rotate,n=e.tabPanel,r=e._minWidth,i=e._minHeight,o=e._maxWidth,a=e._maxHeight;if(n){var s=n.tabMinWidth,l=n.tabMaxWidth;null!=s&&(t?(r===s&&(r=null),i=s):(i===s&&(i=null),r=s)),null!=l&&(t?(o===l&&(o=null),a=l):(a===l&&(a=null),o=l)),e.minWidth=r,e.minHeight=i,e.maxWidth=o,e.maxHeight=a}}},{key:"onItemBeforeChangeHidden",value:function(e){var t=e.source,n=e.hidden;if(!t.$isDeactivating&&!t.$isActivating){var r=this.tabPanel;this.hidden=n,n&&t===r.activeItem&&r.activateAvailableTab(t)}}},{key:"onItemBeforeHide",value:function(){this.item.$isDeactivating||this.hide()}},{key:"onItemBeforeUpdateDisabled",value:function(e){var t=e.source,n=e.disabled,r=this.tabPanel;this.disabled=n,t===r.activeItem&&r.activateAvailableTab(t)}},{key:"onItemConfigChange",value:function(e){var t=e.name,n=e.value;t===this.titleSource&&(this[this.titleProperty]=n)}}],[{key:"$name",get:function(){return"Tab"}},{key:"type",get:function(){return"tab"}},{key:"configurable",get:function(){return{active:null,index:null,isFirst:null,isLast:null,item:{value:null,$config:"nullify"},itemCls:null,tabPanel:null,titleProperty:"text",titleSource:"title"}}}]),n}(nf);function _p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}jp.initClass(),jp._$name="Tab";var Hp=function(e){return e.isTab},Np=function(e){Ye()(n,e);var t=_p(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"firstTab",get:function(){return this.tabAt(0)}},{key:"lastTab",get:function(){return this.tabAt(-1)}},{key:"tabCount",get:function(){return this._items.countOf(Hp)}},{key:"tabs",get:function(){return it.from(this._items,Hp)}},{key:"compose",value:function(){return{children:{toolbarContent:{class:{"b-tabpanel-tabs":1}}}}}},{key:"indexOfTab",value:function(e){return this._items.indexOf(e,Hp)}},{key:"onChildAdd",value:function(e){tt()(Ze()(n.prototype),"onChildAdd",this).call(this,e),null==e.index&&this.syncTabs()}},{key:"onChildRemove",value:function(e){tt()(Ze()(n.prototype),"onChildRemove",this).call(this,e),this.syncTabs()}},{key:"syncTabs",value:function(){for(var e=this.tabs,t=0,n=e.length;t<n;++t)e[t].index=t,e[t].isFirst=!t,e[t].isLast=t===n-1}},{key:"tabAt",value:function(e){return this._items.find(Hp,e)||null}}],[{key:"$name",get:function(){return"TabBar"}},{key:"type",get:function(){return"tabbar"}},{key:"configurable",get:function(){return{defaultType:"tab",overflow:"scroll"}}}]),n}(df);function zp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Np.initClass(),Np._$name="TabBar";var Vp=["b-slide-out-left","b-slide-out-right","b-slide-in-left","b-slide-in-right"],Wp=function(e){Ye()(n,e);var t=zp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onChildAdd",value:function(e){tt()(Ze()(n.prototype),"onChildAdd",this).call(this,e);var t=this,r=t.activeItem,i=t.owner,o=null!=i.activeIndex?i.activeIndex:t.activeIndex||0,a=i.items.indexOf(e),s=null!=r?e===r:a===o;e.on({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:t}),s?(e.show(),t._activeIndex=a,t._activeItem=e):(e.$isDeactivating=!0,e.hide(),e.$isDeactivating=!1)}},{key:"onChildRemove",value:function(e){tt()(Ze()(n.prototype),"onChildRemove",this).call(this,e),this._activeItem===e&&this.activateSiblingOf(e),e.un({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:this})}},{key:"onBeforeChildShow",value:function(e){var t=e.source;if(!this.owner.isConfiguring&&!t.$isActivating)return this.activeItem=t,!1}},{key:"onBeforeChildHide",value:function(e){var t=e.source;if(!this.owner.isConfiguring&&!t.$isDeactivating)return this.activateSiblingOf(t),!1}},{key:"activateSiblingOf",value:function(e){var t=this.owner.items.slice(),n=t.indexOf(e);t.splice(n,1),this.activeIndex=Math.min(n,t.length-1)}},{key:"setActiveItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeIndex,n=this,r=n.owner,i=r.items,o=e instanceof uc,a=i[t],s=r.items[e=o?e=i.indexOf(e):parseInt(e)],l={prevActiveIndex:t,prevActiveItem:a};if(s&&!s.$isActivating&&s!==a){var u,c=a&&a.element,f=s&&s.element;if(n.animateDetacher){var d=n.animateDetacher.event;n.animateDetacher(),mi.removeClasses(d.prevActiveItem.element,Vp),mi.removeClasses(d.activeItem.element,Vp),n.animateDetacher=null}if(l.activeIndex=e,l.activeItem=s,!1===r.trigger("beforeActiveItemChange",l))return null;null===(u=r.onBeginActiveItemChange)||void 0===u||u.call(r,l),l.promise=new Promise((function(i,o){if(c&&r.isVisible&&n.animateCardChange){var u=a.monitorResize;a.monitorResize=!1,n.contentElement.style.overflowX="hidden",a._hidden=!0,s.$isActivating=!0,s.show(),s.$isActivating=!1,c.classList.add(e>t?"b-slide-out-left":"b-slide-out-right"),f.classList.add(e<t?"b-slide-in-left":"b-slide-in-right"),r.isAnimating=!0,n.animateDetacher=Tu.onTransitionEnd({mode:"animation",element:f,once:!0,thisObj:a,handler:function(){n.animateDetacher?(n.animateDetacher=null,r.isAnimating=!1,mi.removeClasses(f,Vp),c&&(mi.removeClasses(c,Vp),a.$isDeactivating=!0,a._hidden=!1,a.hide(),a.monitorResize=u,a.$isDeactivating=!1),n.contentElement.style.overflowX="",n.onActiveItemChange(l,i)):n.setActiveItem(e,t)}}),n.animateDetacher.reject=o,n.animateDetacher.event=l}else s.$isActivating=!0,s.show(),s.focus(),s.$isActivating=!1,a&&(a.$isDeactivating=!0,a.hide(),a.$isDeactivating=!1),n.onActiveItemChange(l,i)}))}return l}},{key:"onActiveItemChange",value:function(e,t){var n=this;n._activeItem=e.activeItem,n._activeIndex=e.activeIndex,n.owner.trigger("activeItemChange",e),e.activeItem.focus(),t(e)}},{key:"renderChildren",value:function(){var e=this.owner;pe.a.isIE11&&(this.animateCardChange=!1),e.contentElement.classList[e.suppressChildHeaders?"add":"remove"](this.hideChildHeaderCls),tt()(Ze()(n.prototype),"renderChildren",this).call(this)}},{key:"changeActiveIndex",value:function(e){var t=this.owner;return t.isConfiguring&&!t._items?e:Math.min(e,t.items.length-1)}},{key:"updateActiveIndex",value:function(e,t){this.owner.isConfiguring||this.setActiveItem(e,t)}},{key:"updateActiveItem",value:function(e){this.owner.isConfiguring||this.setActiveItem(e,this.activeIndex)}}],[{key:"$name",get:function(){return"Card"}},{key:"type",get:function(){return"card"}},{key:"configurable",get:function(){return{containerCls:"b-card-container",itemCls:"b-card-item",hideChildHeaderCls:"b-hide-child-headers",animateCardChange:!0,activeItem:null,activeIndex:null}}}]),n}(fc);function $p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Wp.initClass(),Wp._$name="Card";var Up=function(e){Ye()(n,e);var t=$p(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"activeIndex",get:function(){return this.layout.activeIndex}},{key:"activeItem",get:function(){return this.layout.activeItem}},{key:"activeTabItemIndex",get:function(){var e,t=this.activeTab,n=this.items,r=this.tabBar;return n.indexOf(null===(e=r.tabs[t])||void 0===e?void 0:e.item)}},{key:"bodyConfig",get:function(){return Qn.merge({className:{"b-tabpanel-body":1}},tt()(Ze()(n.prototype),"bodyConfig",this))}},{key:"focusElement",get:function(){var e,t=this.items[this.activeTab||0];return(null==t?void 0:t.focusElement)||(null==t||null===(e=t.tab)||void 0===e?void 0:e.focusElement)}},{key:"tabPanelBody",get:function(){return this.bodyElement}},{key:"finalizeInit",value:function(){tt()(Ze()(n.prototype),"finalizeInit",this).call(this);var e=this,t=e.activeTab,r=e.layout,i=e.tabBar.tabs;if(!(t>=0&&t<i.length))throw new Error("Invalid activeTab ".concat(t," (").concat(i.length," tabs)"));r.activeIndex=e.items.indexOf(i[t].item),r.animateCardChange=e.animateTabChange}},{key:"onChildAdd",value:function(e){if(tt()(Ze()(n.prototype),"onChildAdd",this).call(this,e),!this.initialItems){var t=this,r=t.tabBar,i=t.makeTabConfig(e),o=i&&r.firstTab,a=o&&r._items,s=o&&it.from(t._items,(function(t){return t.tab||t===e})),l=o?s.indexOf(e)+a.indexOf(o):0;i&&(o&&null==e.weight&&l<a.count-1?r.insert(i,l):r.add(i))}}},{key:"onChildRemove",value:function(e){var t,r;null===(t=e.tab)||void 0===t||null===(r=t.destroy)||void 0===r||r.call(t),tt()(Ze()(n.prototype),"onChildRemove",this).call(this,e)}},{key:"isDisabledOrHiddenTab",value:function(e){var t=this.tabBar.tabs,n=null==t?void 0:t[e];return n&&(n.disabled||n.hidden)}},{key:"findAvailableTab",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.tabBar.tabs,i=r.length,o=Math.max(0,r.indexOf(e.tab));o&&(n=-n);for(var a=1;a<=i&&(t=(o+(n<0?i:0)+a*n)%i,this.isDisabledOrHiddenTab(t));++a);return t}},{key:"activateAvailableTab",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.activeTab=this.findAvailableTab(e,t)}},{key:"changeActiveTab",value:function(e){var t=this,n=t.tabBar,r=n.tabCount;if(e.isWidget||Qn.isObject(e)?(-1===t.items.indexOf(e)&&(e=t.add(e)),e=n.indexOfTab(e.tab)):e=parseInt(e,10),!t.initialItems&&(e<-1||e>=r))throw new Error("Invalid activeTab ".concat(e," (").concat(r," tabs)"));return t.isDisabledOrHiddenTab(e)&&(e=t.findAvailableTab(e)),e}},{key:"updateActiveTab",value:function(){if(!this.initialItems){var e=this.activeTabItemIndex;e>-1&&(this.layout.activeIndex=e)}}},{key:"changeTabBar",value:function(e){return this.getConfig("strips"),this.strips={tabBar:e},this.strips.tabBar}},{key:"makeTabConfig",value:function(e){var t=e.tab,n={item:e,type:"tab",tabPanel:this,disabled:Boolean(e.disabled),hidden:e.initialConfig.hidden,weight:e.weight||0,listeners:{click:"onTabClick",thisObj:this},localizableProperties:{text:!1}};return!1===t?null:Qn.isObject(t)?jp.mergeConfigs(n,t):n}},{key:"updateItems",value:function(e,t){var r,i=this,o=i.activeTab,a=i.initialItems,s=0;tt()(Ze()(n.prototype),"updateItems",this).call(this,e,t),a&&(r=Array.from(e,(function(e){return i.makeTabConfig(e)})).filter((function(e){if(e)return e.index=s++,!0})),s&&(r[0].isFirst=!0,r[s-1].isLast=!0,r[o].active=!0,i.tabBar.add(r),i.activeTab=o))}},{key:"updateTabMinWidth",value:function(e){var t;null===(t=this.tabBar)||void 0===t||t.items.forEach((function(t){t.isTab&&(t.minWidth=e)}))}},{key:"updateTabMaxWidth",value:function(e){var t;null===(t=this.tabBar)||void 0===t||t.items.forEach((function(t){t.isTab&&(t.maxWidth=e)}))}},{key:"updateAutoHeight",value:function(e){this.detachListeners("themeAutoHeight"),e&&Fi.on({name:"themeAutoHeight",theme:"internalOnThemeChange",thisObj:this}),this.$measureHeight=e}},{key:"applyAutoHeight",value:function(){var e=this,t=e.layout,n=e.activeTab,r=e.element,i=t.animateCardChange;t.animateCardChange=!1,e.height=null,e.height=Math.max.apply(Math,F()(e.items.map((function(t){return e.activeTab=t,r.clientHeight}))))+1,e.activeTab=n,t.animateCardChange=i,e.$measureHeight=!1}},{key:"internalOnThemeChange",value:function(){this.isVisible?this.applyAutoHeight():this.$measureHeight=!0}},{key:"onBeginActiveItemChange",value:function(e){var t=this.tabBar.tabs,n=e.activeItem,r=e.prevActiveItem;this.activeTab=t.indexOf(null==n?void 0:n.tab),null!=r&&r.tab&&(r.tab.active=!1),null!=n&&n.tab&&(n.tab.active=!0,n.tab.show())}},{key:"onActiveItemChange",value:function(e){this.trigger("tabChange",e)}},{key:"onTabClick",value:function(e){this.activeTab=e.source.item}},{key:"onPaint",value:function(){tt()(Ze()(n.prototype),"onPaint",this).apply(this,arguments),this.$measureHeight&&this.applyAutoHeight()}}],[{key:"$name",get:function(){return"TabPanel"}},{key:"type",get:function(){return"tabpanel"}},{key:"alias",get:function(){return"tabs"}},{key:"configurable",get:function(){return{activeTab:0,animateTabChange:!0,autoHeight:!1,defaultType:"container",itemCls:"b-tabpanel-item",layout:{type:"card"},suppressChildHeaders:!0,tabBar:{type:"tabbar",weight:-2e3},tabMinWidth:null,tabMaxWidth:null}}}]),n}(Rf);function Gp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Up.initClass(),Up._$name="TabPanel";var Yp=function(e){Ye()(n,e);var t=Gp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"startConfigure",value:function(e){this.getConfig("inline"),tt()(Ze()(n.prototype),"startConfigure",this).call(this,e)}},{key:"inputElement",get:function(){var e=tt()(Ze()(n.prototype),"inputElement",this),t=this.inline,r=this.resize;return t?(e.tag="textarea",e.style=(e.style||"")+";resize:".concat(r)):(e.readOnly="readonly",e.reference="displayElement"),e}},{key:"focusElement",get:function(){return this.inline||this._picker&&this._picker.isVisible?this.input:this.displayElement}},{key:"showPicker",value:function(){var e=this,t=e.picker;e.inline||(t.width=e.pickerWidth||e[e.pickerAlignElement].offsetWidth,tt()(Ze()(n.prototype),"showPicker",this).call(this,!0))}},{key:"focusPicker",value:function(){this.input.focus()}},{key:"onPickerKeyDown",value:function(e){var t=this,r=t.input;switch(e.key.trim()||e.code){case"Escape":return void t.picker.hide();case"Enter":e.ctrlKey&&(t.syncInputFieldValue(),t.picker.hide())}t.input=t.displayElement;var i=tt()(Ze()(n.prototype),"onPickerKeyDown",this).call(this,e);return t.input=r,i}},{key:"syncInputFieldValue",value:function(e){this.displayElement&&(this.displayElement.value=this.inputValue),tt()(Ze()(n.prototype),"syncInputFieldValue",this).call(this,e)}},{key:"changeValue",value:function(e){return null==e?"":e}},{key:"updateInline",value:function(e){e||this.triggers||(this.triggers={})}},{key:"changeTriggers",value:function(e,t){return this.inline||((e||(e={})).expand={cls:"b-icon-picker",handler:"onTriggerClick"}),tt()(Ze()(n.prototype),"changeTriggers",this).call(this,e,t)}},{key:"changePicker",value:function(e,t){var r,i=this,o=i.pickerWidth||(null===(r=e)||void 0===r?void 0:r.width);if(e=n.reconfigure(t,e?he.merge({owner:i,forElement:i[i.pickerAlignElement],align:{matchSize:null==o,anchor:i.overlayAnchor,target:i[i.pickerAlignElement]},html:'<textarea id="'.concat(i.id+"-input",'" style="resize:').concat(i.resize,'">').concat(i.value,"</textarea>")},e):null,i)){var a=i.input=e.element.querySelector("#".concat(i.id,"-input"));i.inputListenerRemover=Tu.on({element:a,thisObj:i,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput",keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}return e}}],[{key:"$name",get:function(){return"TextAreaField"}},{key:"type",get:function(){return"textareafield"}},{key:"alias",get:function(){return"textarea"}},{key:"configurable",get:function(){return{picker:{type:"widget",cls:"b-textareafield-picker",floating:!0,scrollAction:"realign",align:{align:"t-b",axisLock:!0},autoShow:!1},triggers:null,inline:!0,resize:"none",inputType:null}}}]),n}(ov);function qp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Yp.initClass(),Yp._$name="TextAreaField";var Kp=function(e){var t,n;return n=t=function(e){Ye()(n,e);var t=qp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeBreakpoints",value:function(e){return Qn.assertObject(e,"breakpoints"),null!=e&&e.width&&Object.keys(e.width).forEach((function(t){e.width[t].maxWidth=t})),null!=e&&e.height&&Object.keys(e.height).forEach((function(t){e.height[t].maxHeight=t})),e}},{key:"updateBreakpoints",value:function(e){e&&(this.monitorResize=!0)}},{key:"getBreakpoint",value:function(e,t){var n=Object.keys(e).map((function(e){return parseInt(e)})).sort().find((function(e){return t<=e}));return e[null!=n?n:e["*"]&&"*"]}},{key:"activateBreakpoint",value:function(e,t){var n,r,i=this,o=i["current".concat(e,"Breakpoint")];t!==o&&(i["current".concat(e,"Breakpoint")]=t,i.setConfig(t.configs),o&&i.element.classList.remove("b-breakpoint-".concat(o.name.toLowerCase())),i.element.classList.add("b-breakpoint-".concat(t.name.toLowerCase())),i.trigger("responsive".concat(e,"Change"),{breakpoint:t,prevBreakpoint:o}),null===(n=t.callback)||void 0===n||n.call(t,{source:i,breakpoint:t,prevBreakpoint:o}),null===(r=i.recompose)||void 0===r||r.call(i))}},{key:"applyResponsiveness",value:function(e,t){var n,r=this,i=null!==(n=r.breakpoints)&&void 0!==n?n:{},o=i.width,a=i.height;if(o){var s=r.getBreakpoint(o,e);r.activateBreakpoint("Width",s)}if(a){var l=r.getBreakpoint(a,t);r.activateBreakpoint("Height",l)}}},{key:"onInternalResize",value:function(e,t,r,i,o){tt()(Ze()(n.prototype),"onInternalResize",this).call(this,e,t,r,i,o),this.applyResponsiveness(t,r)}}]),n}(e||$e),Qe()(t,"$name","Responsive"),Qe()(t,"configurable",{breakpoints:null}),n};function Xp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Zp=function(e){var t,n;return n=t=function(e){Ye()(n,e);var t=Xp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeCssVarPrefix",value:function(e){return Qn.assertString(e,"prefix"),e&&!e.endsWith("-")&&(e+="-"),e||""}},{key:"changeCss",value:function(e){Qn.assertObject(e,"css");var t=this;if(!pe.a.global.Proxy)throw new Error("Proxy not supported");var n=new Proxy({},{get:function(e,n){var r;return null===(r=getComputedStyle(t.element||document.documentElement).getPropertyValue("--".concat(t.cssVarPrefix).concat(te.hyphenate(n))))||void 0===r?void 0:r.trim()},set:function(e,n,r){return(t.element||document.documentElement).style.setProperty("--".concat(t.cssVarPrefix).concat(te.hyphenate(n)),r),!0}});return e&&(t._element?Qn.assign(n,e):t.$initialCSS=e),n}},{key:"updateElement",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"updateElement",this)).call.apply(t,[this,e].concat(i)),this.$initialCSS&&Qn.assign(this.css,this.$initialCSS)}},{key:"widgetClass",get:function(){}}]),n}(e||$e),Qe()(t,"$name","Styleable"),Qe()(t,"configurable",{cssVarPrefix:"",css:{}}),n};function Jp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Qp="http://www.w3.org/2000/svg",eg={bar:1,outline:2,text:3},tg=function(e,t){return parseInt(e.dataset.order,10)-parseInt(t.dataset.order,10)},ng=function(e){return e.field},rg=function(){return!1},ig=function(e){Ye()(n,e);var t=Jp(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}},{key:"tip",set:function(e){var t,n=this;null===(t=n.tip)||void 0===t||t.destroy(),n._tip=e?kh.new({owner:n,forElement:n.svgElement,forSelector:"rect",listeners:{beforeShow:"up.onBeforeTipShow"}},e):null}},{key:"onElementResize",value:function(){tt()(Ze()(n.prototype),"onElementResize",this).apply(this,arguments);var e=this.svgElement.getBoundingClientRect();this.scaledSvgGroup.setAttribute("transform","scale(".concat(e.width," ").concat(e.height,")"))}},{key:"onBeforeTipShow",value:function(e){var t=e.source,n=parseInt(t.activeTarget.dataset.index);t.html=t.contentTemplate({histogram:this,index:n})}},{key:"series",get:function(){return this._series},set:function(e){var t=this._series={};for(var n in e)if(!1!==e[n]){var r=t[n]=Object.assign({},e[n]);!r.type&&e[n].type&&(r.type=e[n].type),!r.field&&e[n].field&&(r.field=e[n].field),"order"in t||(r.order=eg[r.type]),r.id=n}this.scheduleRefresh()}},{key:"data",get:function(){return this._data},set:function(e){var t=this;if(t._data=e,!t.topValue)for(var n=Object.values(t.series).map(ng),r=0,i=e.length;r<i;r++)for(var o=0,a=n.length;o<a;o++)t.topValue=Math.max(t.topValue||0,e[r][n[o]]);t.scheduleRefresh()}},{key:"topValue",get:function(){return this._topValue},set:function(e){this._topValue=e,this.scheduleRefresh()}},{key:"scheduleRefresh",value:function(){}},{key:"refresh",value:function(){var e=this,t=e.series,n=e._tip,r=[];for(var i in t){var o=t[i],a=e["draw".concat(te.capitalize(o.type))](o);Array.isArray(a)?r.push.apply(r,a):r.push(a)}r.sort(tg),du.syncChildren({domConfig:{children:r},configEquality:rg},e.scaledSvgGroup),du.syncChildren({domConfig:{children:e.drawText()}},e.unscaledSvgGroup),n&&n.isVisible&&e.onBeforeTipShow({source:n})}},{key:"drawBar",value:function(e){for(var t,n=this,r=n.topValue,i=n.data,o=n.omitZeroHeightBars,a=n.barStyle,s=e.field,l=e.order,u=1/i.length,c=[],f=0,d=0,h=i.length;f<h;f++,d+=t){var v=i[f],p=v[s],g=(p>r?r:p)/r,y=1-g,m=v.rectConfig={ns:Qp,tag:"rect",dataset:{}};if(t=v.width||u,pe.a.isEdge||pe.a.isIE11){var b=n.svgElement.getBoundingClientRect();m.dataset.scaleX=b.width,m.dataset.scaleY=b.height}a?m.style=a:delete m.style,Object.assign(m.dataset,{index:f,order:l}),Object.assign(m,{x:d,y:y,width:t,height:g,class:n.callback("getRectClass",n,[e,m,v,f])});var k=n.callback("getBarTip",n,[e,m,v,f]);k?m.dataset.btip=k:delete m.dataset.btip,!g&&o||c.push(m)}return c}},{key:"drawOutline",value:function(e){var t=this,n=t.topValue,r=t.data,i=e.field,o=e.order,a=1/r.length,s=["M 0,1"],l=e.outlineElement||(e.outlineElement={ns:Qp,tag:"path",dataset:{order:o}});if(pe.a.isEdge||pe.a.isIE11){var u=t.svgElement.getBoundingClientRect();l.style="stroke-width: ".concat(1/Math.min(u.width,u.height),"px")}for(var c,f="M",d="L",h=0,v=0,p=r.length;h<p;h++){var g=1-r[h][i]/n;c=r[h].width||a,s.push("".concat(f," ").concat(v,",").concat(g," ").concat(d," ").concat(v+=c,",").concat(g)),f=d=""}return l.d=s.join(" "),l}},{key:"drawText",value:function(){for(var e,t=this,n=t.data,r=1/n.length,i=[],o=0,a=0,s=n.length;o<s;o++,a+=e){e=n[o].width||r,t.callback("getBarText",t,[n[o],o])&&i.push({ns:Qp,tag:"text",className:"b-bar-legend",html:t.callback("getBarText",t,[n[o],o]),x:"".concat(100*(a+e/2),"%"),y:"100%",dataset:{index:o}})}return i}},{key:"getBarText",value:function(e,t){return""}},{key:"getBarTip",value:function(e,t,n,r){}},{key:"getRectClass",value:function(e,t,n,r){return""}}],[{key:"type",get:function(){return"histogram"}},{key:"$name",get:function(){return"Histogram"}},{key:"defaultConfig",get:function(){return{data:null,values:null,series:null,topValue:null,element:{children:[{ns:Qp,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:Qp,tag:"g",reference:"scaledSvgGroup"},{ns:Qp,tag:"g",reference:"unscaledSvgGroup"}]}]},omitZeroHeightBars:null,monitorResize:!0,getRectClass:null,getBarTip:null,getBarText:null}}}]),n}(uc);function og(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ag(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ag(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ag(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ig.initClass(),ig._$name="Histogram";var lg="http://www.w3.org/2000/svg",ug=function(e){Ye()(n,e);var t=sg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}},{key:"changeAlign",value:function(e){return e||(e=this.horizontal?"bottom":"right"),e}},{key:"updateAlign",value:function(e,t){this.element.classList.remove("b-align-".concat(t)),this.element.classList.add("b-align-".concat(e))}},{key:"updateHorizontal",value:function(e,t){this.element.classList.remove("b-scale-".concat(t?"horizontal":"vertical")),this.element.classList.add("b-scale-".concat(e?"horizontal":"vertical"))}},{key:"onElementResize",value:function(){tt()(Ze()(n.prototype),"onElementResize",this).apply(this,arguments),this.scheduleRefresh()}},{key:"scheduleRefresh",value:function(){}},{key:"refresh",value:function(){var e=this,t=e.horizontal,n=e.width,r=e.height,i=e.align,o=e.scalePoints,a=e.scaleMaxPadding,s=o[o.length-1].value,l=[],u=[],c=1/(s+a*s);e.scaledSvgGroup.setAttribute("transform","scale(".concat(t?n:1," ").concat(t?1:r,")"));var f,d=og(o);try{for(d.s();!(f=d.n()).done;){var h=f.value,v=Boolean(h.text),p=c*h.value;if(v){var g={ns:lg,tag:"text",className:"b-scale-tick-label",html:h.text,dataset:{tick:h.value}};t?(g.x="".concat(100*p,"%"),g.y="top"===i?"1.6em":r-12):(g.x="left"===i?"12":"".concat(n-12),g.y="".concat(100*(1-p),"%")),u.push(g)}t?"top"===i?l.push("M".concat(p,",0 L").concat(p,",").concat(v?10:5)):l.push("M".concat(p,",").concat(r," L").concat(p,",").concat(r-(v?10:5))):"left"===i?l.push("M0,".concat(1-p," L").concat(v?10:5,",").concat(1-p)):l.push("M".concat(n,",").concat(1-p," L").concat(n-(v?10:5),",").concat(1-p))}}catch(e){d.e(e)}finally{d.f()}e.pathElement.setAttribute("d",l.join("")),du.syncChildren({domConfig:{children:u}},e.unscaledSvgGroup)}}],[{key:"type",get:function(){return"scale"}},{key:"$name",get:function(){return"Scale"}},{key:"configurable",get:function(){return{scalePoints:null,scaleMaxPadding:.1,horizontal:!1,align:{value:!1,$config:{merge:"replace"}},element:{children:[{ns:lg,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:lg,tag:"g",reference:"scaledSvgGroup",children:[{ns:lg,tag:"path",reference:"pathElement"}]},{ns:lg,tag:"g",reference:"unscaledSvgGroup"}]}]},monitorResize:!0}}}]),n}(uc);function cg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ug._$name="Scale";var fg=function(e){Ye()(n,e);var t=cg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateElement",value:function(e){Tu.on({element:e,delegate:".b-resource-image",error:"onImageErrorEvent",thisObj:this,capture:!0})}},{key:"failedUrls",get:function(){return this._failedUrls||(this._failedUrls=new Set),this._failedUrls}},{key:"getResourceAvatar",value:function(e){var t=e.initials,n=e.color,r=e.iconCls,i=e.imageUrl,o=e.defaultImageUrl,a=e.dataset,s=void 0===a?{}:a,l=e.alt;return this.getImageConfig(t,n,i,o,s,l)||this.getIconConfig(r,s)||this.getResourceInitialsConfig(t,n,s)}},{key:"getImageConfig",value:function(e,t,n,r,i,o){if(n=this.failedUrls.has(n)?r:n||r)return{tag:"img",draggable:"false",class:{"b-resource-avatar":1,"b-resource-image":1},ontouchstart:"return false",alt:o,elementData:{defaultImageUrl:r,imageUrl:n,initials:e,color:t,dataset:i},src:n,dataset:i}}},{key:"getIconConfig",value:function(e,t){if(e)return e&&{tag:"i",class:Qe()({"b-resource-avatar":1,"b-resource-icon":1},e,1),dataset:t}}},{key:"getResourceInitialsConfig",value:function(e,t,n){var r=mi.isNamedColor(t)&&t,i=!r&&t;return{tag:"div",class:Qe()({"b-resource-avatar":1,"b-resource-initials":1},"".concat(this.colorPrefix).concat(r),r),style:{backgroundColor:i||null},children:[te.encodeHtml(e)],dataset:n}}},{key:"onImageErrorEvent",value:function(e){var t=e.target;if(t.matches(".b-resource-avatar")){var n=t.elementData,r=n.defaultImageUrl,i=n.initials,o=n.color,a=n.imageUrl,s=n.dataset;if(r&&!t.src.endsWith(r.replace(/^[./]*/gm,"")))t.src=r;else{var l=mi.createElement(this.getResourceInitialsConfig(i,o,s));t.parentElement.replaceChild(l,t)}this.failedUrls.add(a)}}}],[{key:"$name",get:function(){return"AvatarRendering"}},{key:"configurable",get:function(){return{element:null,colorPrefix:"b-sch-"}}}]),n}($e);fg._$name="AvatarRendering";function dg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}window&&!window.bryntum&&(window.bryntum={});var hg=function(e){return"number"==typeof e||(null==e?void 0:e.endsWith("px"))},vg=function(e){Ye()(n,e);var t=dg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;r.masterStore=t,t&&(r._grid=Array.isArray(t)?t[0].grid:t.grid),r.localizableProperties=e.localizableProperties||["text"],e.localeClass&&(r.localeClass=e.localeClass),tt()(Ze()(n.prototype),"construct",this).call(this,e,t,null,!1),"field"in r.data||(r.field="_"+(r.type||"")+ ++n.emptyCount,r.noFieldSpecified=!0),r.hasComplexMapping=r.field&&r.field.includes("."),r.width||r.flex||r.children||r.set({width:n.defaultWidth,flex:null},null,!0)}},{key:"doDestroy",value:function(){var e,t,r;null===(e=this.data)||void 0===e||null===(t=e.editor)||void 0===t||null===(r=t.destroy)||void 0===r||r.call(t),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"remove",value:function(){var e=this.subGrid,t=this.grid,r=e&&t&&t.focusedCell;r&&r.columnId===this.id&&(t.owns(mi.getActiveElement(t))?t.navigateRight():r.columnId=e.columns.getAdjacentVisibleLeafColumn(this.id,!0,!0).id),tt()(Ze()(n.prototype),"remove",this).call(this)}},{key:"getRawValue",value:function(e){var t=this;return t.hasComplexMapping?Qn.getPath(e,t.field):e[t.field]}},{key:"owner",get:function(){return this._owner||this.subGrid},set:function(e){this._owner=e}},{key:"nextVisibleSibling",get:function(){for(var e=this.region,t=this.nextSibling;t&&(t.hidden||t.region!==e);)t=t.nextSibling;return t}},{key:"isLastInSubGrid",get:function(){return!this.nextVisibleSibling&&(!this.parent||this.parent.isLastInSubGrid)}},{key:"element",get:function(){return this.grid.getHeaderElement(this)}},{key:"textWrapper",get:function(){return mi.getChild(this.element,".b-grid-header-text")}},{key:"textElement",get:function(){return mi.down(this.element,".b-grid-header-text-content")}},{key:"contentElement",get:function(){return mi.down(this.element,".b-grid-header-children")}},{key:"editor",get:function(){var e=this.data.editor;if(e&&!(e instanceof uc)){var t=this.grid.processCellEditor({editor:e,field:this.field});t?e=this.data.editor=t.editor:("string"==typeof e&&(e={type:e}),e=this.data.editor=uc.create(Qn.merge(this.defaultEditor,e,{owner:this.grid})))}return e},set:function(e){this.data.editor=e}},{key:"defaultEditor",get:function(){return{type:"textfield",name:this.field}}},{key:"isFocusable",get:function(){return this.isLeaf}},{key:"grid",get:function(){return this._grid||this.parent&&this.parent.grid}},{key:"locked",get:function(){return"locked"===this.data.region},set:function(e){this.region=e?"locked":"normal"}},{key:"sortable",get:function(){return this.isLeaf&&this.data.sortable},set:function(e){this.set("sortable",e)}},{key:"groupable",get:function(){return this.isLeaf&&this.data.groupable},set:function(e){this.set("groupable",e)}},{key:"headerText",get:function(){return this.htmlEncodeHeaderText?te.encodeHtml(this.text):this.text}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.parent;if(!t.hidden){if(t.hidden=!0,n&&!n.isRoot){var r=n.children.some((function(e){return!0!==e.hidden}));r||n.hidden||(e=!0,n.hide())}t.children&&t.children.forEach((function(e){return e.hide(!0)})),e||t.stores.forEach((function(e){return e.trigger("columnHide",{column:t})}))}}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.parent;t.hidden&&(t.hidden=!1,n&&n.hidden&&n.show(),t.children&&t.children.forEach((function(e){return e.show(!0)})),e||t.stores.forEach((function(e){return e.trigger("columnShow",{column:t})})))}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.hidden&&void 0===e||!0===e?this.show():!this.hidden&&void 0===e||!1===e?this.hide():void 0}},{key:"generateId",value:function(){return n.generatedIdIndex||(n.generatedIdIndex=0),(this.field?this.field.replace(/\./g,"-"):"col")+ ++n.generatedIdIndex}},{key:"allIndex",get:function(){return this.masterStore.indexOf(this)}},{key:"calcMinWidth",get:function(){var e=this.data,t=e.width,n=e.minWidth;return hg(t)&&hg(n)?Math.max(parseInt(t)||0,parseInt(n)||0):t}},{key:"width",get:function(){return this.data.width},set:function(e){var t={width:e};e&&"flex"in this.data&&(t.flex=null),this.set(t)}},{key:"flex",get:function(){return this.data.flex},set:function(e){var t={flex:e};e&&"width"in this.data&&(t.width=null),this.set(t)}},{key:"subGrid",get:function(){return this._subGrid||(this.grid?this.grid.getSubGridFromColumn(this):void 0)},set:function(e){this._subGrid=e}},{key:"subGridElement",get:function(){return this.subGrid.element}},{key:"measureSize",value:function(e){return mi.measureSize(e,this.subGrid?this.subGrid.element:void 0)}},{key:"calculateMinWidth",value:function(){var e=this,t=e.measureSize(e.width),n=e.measureSize(e.minWidth),r=0;return e.children&&(r=e.children.reduce((function(e,t){return e+t.calculateMinWidth()}),0)),Math.max(t,n,r)}},{key:"resizeToFitContent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.grid,o=r.element,a=r.fitMode,s=i.rowManager,l=i.store,u=l.count;if(!(u<=0||"none"===r.fitMode)&&r.fitMode){var c,f,d,h,v,p,g=N()(s.rows,1),y=g[0],m=i.beginGridMeasuring(),b=m.rowElement,k=m.cellElement,w=0,C={length:0,record:null};if(k._domData={columnId:r.id,row:y,rowElement:b},k.innerHTML="",i.resizeToFitIncludesHeader){if(!i.$headerPadding){var R=window.getComputedStyle(o);i.$headerPadding=parseInt(R.paddingLeft)}var S=o.querySelector(".b-grid-header-text-content");S.style.cssText="flex: none; width: auto",w=S.offsetWidth+2*i.$headerPadding+2,S.style.cssText=""}for(u>1e3?f=(c=Math.max(Math.min(s.topIndex+Math.round(s.rowCount/2)-500,u-1e3),0))+1e3:(c=0,f=u),d=c;d<f;d++){if(h=l.getAt(d),v=r.getRawValue(h),"value"===a)p=String(v).length;else if(y.renderCell({cellElement:k,record:h,updatingSingleRow:!0,isMeasuring:!0}),"textContent"===a)p=k.textContent.length;else{var x=k.offsetWidth;x>w&&(w=x)}p>C.length&&(C={record:h,length:p})}if("value"!==a&&"textContent"!==a||(y.renderCell({cellElement:k,record:C.record,updatingSingleRow:!0,isMeasuring:!0}),w=Math.max(w,k.offsetWidth)),Array.isArray(e)){var E=e,D=N()(E,2);e=D[0],t=D[1]}return w=Math.max(w,e||0),w=Math.min(w,t||1e6),n||i.endGridMeasuring(),r.width=w,w}}},{key:"getState",value:function(){var e,t=this,n=(e={id:t.id},Qe()(e,t.flex?"flex":"width",t.flex?t.flex:t.width),Qe()(e,"hidden",t.hidden),Qe()(e,"region",t.region),Qe()(e,"locked",t.locked),e);return t.children&&(n.children=t.children.map((function(e){return e.getState()}))),n}},{key:"applyState",value:function(e){var t=this;t.beginBatch(),"locked"in e&&(t.locked=e.locked),"width"in e&&(t.width=e.width),"flex"in e&&(t.flex=e.flex),"width"in e&&t.flex?t.flex=void 0:"flex"in e&&t.width&&(t.width=void 0),"region"in e&&(t.region=e.region),t.endBatch(),"hidden"in e&&t.toggle(!0!==e.hidden)}},{key:"refreshCell",value:function(e){this.grid.rowManager.refreshCell(e,this.id)}},{key:"clearCell",value:function(e){e.innerHTML="",delete e._content}},{key:"canEdit",value:function(e){if(e.isEditable){var t=e.isEditable(this.field);if(void 0!==t)return t}return!0}}],[{key:"fields",get:function(){return["text","field","renderer","width","flex","autoWidth","autoHeight",{name:"fitMode",defaultValue:"exact"},{name:"editor",defaultValue:{}},"finalizeCellEdit",{name:"revertOnEscape",defaultValue:!0},{name:"invalidAction",defaultValue:"block"},{name:"sortable",defaultValue:!0,convert:function(e,t){if(!e)return!1;var n={};return"function"==typeof e?n.sortFn=e.bind(t):"object"===I()(e)&&(Object.assign(n,e),n.fn&&(n.sortFn=n.fn,delete n.fn)),n}},{name:"searchable",defaultValue:!0},{name:"filterable",defaultValue:!0,convert:function(e){if(!e)return!1;var t={columnOwned:!0};return"function"==typeof e?t.filterFn=e:"object"===I()(e)&&Object.assign(t,e),t}},{name:"hideable",defaultValue:!0},{name:"draggable",defaultValue:!0},{name:"groupable",defaultValue:!0},{name:"resizable",defaultValue:!0},"groupRenderer","headerRenderer","tooltip","tooltipRenderer","cellCls","cls","icon","align",{name:"minWidth",defaultValue:60},{name:"hidden",defaultValue:!1},{name:"locked"},{name:"region"},{name:"showColumnPicker",defaultValue:!0},{name:"enableHeaderContextMenu",defaultValue:!0},{name:"enableCellContextMenu",defaultValue:!0},"headerMenuItems","cellMenuItems","sum","summaries","summaryRenderer","responsiveLevels","tags","touchConfig","tree","filterType",{name:"htmlEncode",defaultValue:!0},{name:"htmlEncodeHeaderText",defaultValue:!0},{name:"autoSyncHtml",defaultValue:!1},"type",{name:"instantUpdate",defaultValue:!1},{name:"repaintOnResize",defaultValue:!1},"editTargetSelector",{name:"exportable",defaultValue:!0},{name:"exportedType"}]}},{key:"autoExposeFields",get:function(){return!1}},{key:"type",get:function(){return"column"}},{key:"text",get:function(){return this.$meta.fields.defaults.text}}]),n}(Ot(en(Lo)));function pg(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return gg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gg(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function gg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}vg.emptyCount=0,vg.defaultWidth=100,vg.exposeProperties(),vg._$name="Column";var mg={boolean:{type:"check"},date:{type:"date"},integer:{type:"number",format:{maximumFractionDigits:0}},number:{type:"number"}},bg=function(e){Ye()(n,e);var t=yg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;e.grid&&(e.grid._columnStore=t,t.id="".concat(e.grid.id,"-columns"),e.grid.on({subGridCollapse:"clearSubGridCaches",subGridExpand:"clearSubGridCaches",thisObj:t})),tt()(Ze()(n.prototype),"construct",this).call(this,e),t.on({change:t.onStoreChange,thisObj:t,prio:1})}},{key:"modelClass",get:function(){return this._modelClass},set:function(e){this._modelClass=e}},{key:"doDestroy",value:function(){var e=[];this.isChained||this.traverse((function(t){return e.push(t)})),tt()(Ze()(n.prototype),"doDestroy",this).call(this),this.isChained||e.forEach((function(e){return e.destroy()}))}},{key:"getById",value:function(e){return tt()(Ze()(n.prototype),"getById",this).call(this,e)||this.idRegister[e]}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.traverseWhile((function(n,r){return e.call(t,n,r)}),!0)}},{key:"totalFixedWidth",get:function(){var e,t=this,n=0,r=pg(this);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.hidden||(i.children?i.children.forEach((function(e){return n+=t.calculateFixedWidth(e)})):n+=this.calculateFixedWidth(i))}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"calculateFixedWidth",value:function(e){return e.flex?e.measureSize(vg.defaultWidth):Math.max(e.measureSize(e.width),e.measureSize(e.minWidth))}},{key:"topColumns",get:function(){return this.isChained?this.masterStore.rootNode.children.filter(this.chainedFilterFn):this.rootNode.children}},{key:"visibleColumns",get:function(){var e=this;return e._visibleColumns||(e._visibleColumns=e.leaves.filter((function(e){return!(e.hidden||e.subGrid&&e.subGrid.collapsed)}))),e._visibleColumns}},{key:"onStoreChange",value:function(e){var t=e.action,n=e.changes;("update"!==t||"hidden"in n)&&this.clearCaches()}},{key:"clearSubGridCaches",value:function(e){e.columns.clearCaches(),this.clearCaches()}},{key:"clearCaches",value:function(){var e;this._visibleColumns=null,null===(e=this.masterStore)||void 0===e||e.clearCaches()}},{key:"onMasterDataChanged",value:function(e){tt()(Ze()(n.prototype),"onMasterDataChanged",this).call(this,e),("update"!==e.action||"hidden"in e.changes)&&this.clearCaches()}},{key:"getAdjacentVisibleLeafColumn",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.visibleColumns,i=e instanceof vg?e:this.getById(e),o=r.indexOf(i)+(t?1:-1);if(!r[o]){if(!n)return null;o=t?0:r.length-1}return r[o]}},{key:"bottomColumns",get:function(){return this.leaves}},{key:"get",value:function(e){return this.findRecord("field",e,!0)}},{key:"createRecord",value:function(e){var t,r,i=this.grid,o=void 0===i?{}:i,a=o.store,s=null==a||null===(t=a.modelClass)||void 0===t||null===(r=t.fieldMap)||void 0===r?void 0:r[e.field],l=this.modelClass;if(null!=s&&s.column&&(e=he.merge({},s.column,e)),e.type&&!(l=n.getColumnClass(e.type)))throw new Error("Column type '".concat(e.type,"' not registered"));e.locked&&(e.region="locked",delete e.locked);var u=new l(e,this);if(u.data.region||(u.data.region=o.defaultRegion||"normal"),this.autoAddField&&!u.noFieldSpecified&&a&&!s){var c=u.field;u.constructor.fieldType&&(c={name:u.field,type:u.constructor.fieldType}),a.modelClass.addField(c)}return u}},{key:"indexOf",value:function(e){var t=tt()(Ze()(n.prototype),"indexOf",this).call(this,e);return t>-1?t:this.records.findIndex((function(t){return t.field===e}))}},{key:"usesAutoHeight",get:function(){return this.find((function(e){return e.autoHeight}))}},{key:"usesFlexAutoHeight",get:function(){return this.find((function(e){return e.autoHeight&&null!=e.flex}))}},{key:"generateColumnForField",value:function(e,t){var n;"string"==typeof e&&this.grid&&(e=null===(n=this.grid.store)||void 0===n?void 0:n.modelClass.fieldMap[e]);var r=e.column||mg[e.type]||{};return"string"==typeof r&&(r={type:r}),r=Object.assign({text:e.text||te.separate(e.name),field:e.name},t,r),null!=e.precision&&(r.format.maximumFractionDigits=e.precision),e.columnType&&(r.type=e.columnType),this.createRecord(r)}}],[{key:"defaultConfig",get:function(){return{modelClass:vg,tree:!0,autoAddField:!1}}},{key:"registerColumnType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.columnTypes||(n.columnTypes={}),e.simpleRenderer=t,n.columnTypes[e.type]=e}},{key:"getColumnClass",value:function(e){return n.columnTypes&&n.columnTypes[e]}}]),n}(en(ts));function kg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(vg,!0),bg._$name="ColumnStore";var Cg=function(e){Ye()(n,e);var t=wg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"groupHeaderReserved",get:function(){return!0}},{key:"construct",value:function(e,t){var r=this;r.internalCellCls="b-action-cell",tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),e.width||e.flex||r.grid.on("paint",r.updateAutoWidth,r),r.disableIfGridReadOnly&&r.grid.element.classList.add("b-actioncolumn-readonly")}},{key:"renderer",value:function(e){var t,n=e.column,r=e.record,i=r&&"groupRowFor"in r.meta;return{className:{"b-action-ct":1},children:null===(t=n.actions)||void 0===t?void 0:t.map((function(e,t){if("visible"in e){if("function"==typeof e.visible&&!1===e.visible({record:r}))return"";if(!1===e.visible)return""}if(i&&!e.showForGroup||!i&&e.showForGroup)return"";var o;if(o="function"==typeof e.tooltip?e.tooltip({record:r}):e.tooltip||"",e.renderer&&"function"==typeof e.renderer){var a=e.renderer({index:t,record:r,column:n,tooltip:o,action:e});return"string"==typeof a?{tag:"span",dataset:{index:t},html:a}:(a.dataset=a.dataset||{},a.dataset.index=t,a)}return{tag:"i",dataset:{index:t,btip:o},className:Qe()({"b-action-item":1},e.cls,e.cls)}}))}}},{key:"onCellClick",value:function(e){e.grid;var t,n=e.column,r=e.record,i=e.target;if(n===this&&i.classList.contains("b-action-item")){var o=i.dataset.index;o||(o=i.parentElement.dataset&&i.parentElement.dataset.index);var a=null===(t=n.actions)||void 0===t?void 0:t[o],s=a&&a.onClick;s&&this.callback(s,n,[{record:r,action:a}])}}},{key:"updateAutoWidth",value:function(){var e,t=this,n=[];if(t.element){var r=[];null===(e=t.actions)||void 0===e||e.forEach((function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kg(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);delete t.visible,t.showForGroup?(delete t.showForGroup,n.push(t)):r.push(t)})),n.length>r.length&&(r=n);var i=mi.createElement(t.renderer({column:{actions:r}})).outerHTML;t.width=mi.measureText(i,t.element,!0,t.element.parentElement)}}}],[{key:"type",get:function(){return"action"}},{key:"fields",get:function(){return["actions",{name:"disableIfGridReadOnly",defaultValue:!1}]}},{key:"defaults",get:function(){return{filterable:!1,groupable:!1,sortable:!1,editor:!1,searchable:!1,htmlEncode:!1,resizable:!1,minWidth:30}}}]),n}(vg);function Rg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Cg),Cg.exposeProperties(),Cg._$name="ActionColumn";var Sg=function(e){Ye()(n,e);var t=Rg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.configuredAlign="align"in e,this.configuredEditor="editor"in e,tt()(Ze()(n.prototype),"construct",this).apply(this,arguments);var r=t.grid;r&&(this.owner=r,r.on({paint:"onGridPaint",thisObj:this,prio:1e3}))}},{key:"onGridPaint",value:function(e){var t=e.source;this.store=t.store}},{key:"store",get:function(){return this._store},set:function(e){var t=this,n={update:"onRecordUpdate",thisObj:t,prio:1e3},r=t._store;if(e!==r){r&&r.un(n),t._store=e;var i=e.modelClass.fieldMap[t.field];i&&"number"===i.type&&(t.configuredAlign||(t.align="end"),t.configuredEditor||(t.editor="number")),e.on(n)}}},{key:"canEdit",value:function(e){return e.isLeaf}},{key:"sum",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n.length;i<o;i++)e+=parseInt(n[i]||0,10);return e}},{key:"avg",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=n.length,o=0;o<i;o++)e+=parseInt(n[o]||0,10);return e/i}},{key:"onRecordUpdate",value:function(e){var t=e.record,n=e.changes,r=this,i=r.grid.rowManager;r.field in n&&t.isLeaf&&t.bubble((function(e){var t=i.getRowFor(e);if(t){var n=t.getCell(r.field);n&&t.renderCell({cellElement:n,record:e})}}),!0)}},{key:"getRawValue",value:function(e){var t=0;if(e.children){for(var n=this,r=n.function,i="string"==typeof r&&"function"==typeof Math[r]?{handler:Math[r],thisObj:Math}:n.resolveCallback(r),o=i.handler,a=i.thisObj,s=0,l=e.children.length;s<l;s++)t=o.call(a,t,n.getRawValue(e.children[s]));e.setData(n.field,t)}else t=e[this.field];return t}}],[{key:"type",get:function(){return"aggregate"}},{key:"fields",get:function(){return["function"]}},{key:"defaults",get:function(){return{function:"sum"}}}]),n}(vg);function xg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Sg,!0),Sg.exposeProperties(),Sg._$name="AggregateColumn";var Eg=function(e){Ye()(n,e);var t=xg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;r.widgetMap={},r.internalCellCls="b-widget-cell",tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),r.externalRenderer=r.renderer,r.renderer=r.internalRenderer}},{key:"doDestroy",value:function(){for(var e=0,t=Object.values(this.widgetMap);e<t.length;e++){var r=t[e];r.destroy&&r.destroy()}tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"internalRenderer",value:function(e){var t,n=this,r=e.cellElement,i=e.column,o=e.value,a=e.record,s=e.isExport,l=i.widgets;if(!s&&l&&(r.widgets||n.clearCell(r),r.widgets=e.widgets=l.map((function(t,s){var l,u,c,f;if(r.widgets&&(f=(c=r.widgets[s]).element.nextElementSibling,t.recreate&&c&&(delete n.widgetMap[c.id],c.destroy(),r.widgets[s]=null)),c||(n.onBeforeWidgetCreate(t,e),t.recomposeAsync=!1,c=vd.append(t,f?{insertBefore:f}:r)[0],n.widgetMap[c.id]=c,n.onAfterWidgetCreate(c,e)),c.cellInfo={cellElement:r,value:o,record:a,column:i},n.grid&&!n.isSelectionColumn&&(c.readOnly=n.grid.readOnly),!1!==(null===(l=n.onBeforeWidgetSetValue)||void 0===l?void 0:l.call(n,c,e))&&!t.noValueOnRender){var d=t.valueProperty||"value"in c&&"value";d?c[d]=o:c.defaultBindProperty?c[c.defaultBindProperty]=o:c.text=c.value=o}return null===(u=n.onAfterWidgetSetValue)||void 0===u||u.call(n,c,e),c}))),null===(t=this.externalRenderer)||void 0===t||t.call(this,e),s)return null}},{key:"onBeforeWidgetCreate",value:function(e,t){}},{key:"onAfterWidgetCreate",value:function(e,t){}},{key:"clearCell",value:function(e){var t=this;e.widgets&&(e.widgets.forEach((function(e){delete t.widgetMap[e.id],e.destroy()})),e.widgets=null),tt()(Ze()(n.prototype),"clearCell",this).call(this,e)}},{key:"resizeToFitContent",value:function(){}}],[{key:"type",get:function(){return"widget"}},{key:"fields",get:function(){return["widgets"]}},{key:"defaults",get:function(){return{filterable:!1,sortable:!1,editor:!1,searchable:!1,fitMode:!1}}}]),n}(vg);function Dg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Eg),Eg.exposeProperties(),Eg._$name="WidgetColumn";var Tg=function(e){Ye()(n,e);var t=Dg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r;tt()(Ze()(n.prototype),"construct",this).apply(this,arguments);var i=this;i.externalHeaderRenderer=i.headerRenderer,i.externalOnBeforeWidgetSetValue=i.onBeforeWidgetSetValue,i.externalOnAfterWidgetSetValue=i.onAfterWidgetSetValue,i.onBeforeWidgetSetValue=i.internalOnBeforeWidgetSetValue,i.onAfterWidgetSetValue=i.internalOnAfterWidgetSetValue,i.headerRenderer=i.internalHeaderRenderer,i.internalCellCls="b-check-cell",null===(r=i.grid)||void 0===r||r.on({destroy:function(){var e;return null===(e=i.headerCheckbox)||void 0===e?void 0:e.destroy()},thisObj:i})}},{key:"internalHeaderRenderer",value:function(e){var t,n,r=e.headerElement,i=e.column;return r.classList.add("b-check-header"),i.showCheckAll?(r.classList.add("b-check-header-with-checkbox"),i.headerCheckbox?r.appendChild(i.headerCheckbox.element):i.headerCheckbox=new Bv({appendTo:r,owner:this.grid,listeners:{change:function(e){var t=e.checked;i.trigger("toggleAll",{checked:t})}}})):n=i.headerText,n=i.externalHeaderRenderer?(t=i.externalHeaderRenderer).call.apply(t,[this].concat(Array.prototype.slice.call(arguments))):n,i.showCheckAll?void 0:n}},{key:"updateCheckAllState",value:function(e){this.headerCheckbox&&(this.suspendEvents(),this.headerCheckbox.checked=e,this.resumeEvents())}},{key:"internalRenderer",value:function(e){var t=e.value,r=e.isExport;return r?null==t?"":t:tt()(Ze()(n.prototype),"internalRenderer",this).apply(this,arguments)}},{key:"onBeforeWidgetCreate",value:function(e,t){e.cls=this.checkCls}},{key:"onAfterWidgetCreate",value:function(e,t){t.cellElement.widget=e,e.on({beforeChange:"onBeforeCheckboxChange",change:"onCheckboxChange",thisObj:this})}},{key:"internalOnBeforeWidgetSetValue",value:function(e){var t;e.record=e.cellInfo.record,this.isInitialSet=!0,null===(t=this.externalOnBeforeWidgetSetValue)||void 0===t||t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"internalOnAfterWidgetSetValue",value:function(e){var t;this.isInitialSet=!1,null===(t=this.externalOnAfterWidgetSetValue)||void 0===t||t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"onBeforeCheckboxChange",value:function(e){var t=e.source,n=e.checked;if(!this.isInitialSet)return this.trigger("beforeToggle",{record:t.cellInfo.record,checked:n})}},{key:"onCheckboxChange",value:function(e){var t=e.source,n=e.checked;if(!this.isInitialSet){var r=t.cellInfo.record,i=this.field;if(i){var o="set".concat(te.capitalize(i));r[o]?r[o](n):r.set(i,n)}this.trigger("toggle",{record:r,checked:n})}}},{key:"onCellKeyDown",value:function(e){var t=e.event,n=e.cellElement;if(" "===t.key){var r=n.widget;null==r||r.toggle(),t.preventDefault()}}}],[{key:"type",get:function(){return"check"}},{key:"fields",get:function(){return["checkCls","showCheckAll","onAfterWidgetSetValue","onBeforeWidgetSetValue"]}},{key:"defaults",get:function(){return{align:"center",checkCls:null,showCheckAll:!1,widgets:[{type:"checkbox",valueProperty:"checked"}]}}}]),n}(Eg);function Og(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Tg,!0),Tg._$name="CheckColumn";var Mg=function(e){Ye()(n,e);var t=Og(n);function n(e,r){var i;return B()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-date-cell",i}return _()(n,[{key:"defaultRenderer",value:function(e){var t=e.value;return t?this.formatValue(t):""}},{key:"groupRenderer",value:function(e){var t=e.cellElement,n=e.groupRowFor;t.innerHTML=this.formatValue(n)}},{key:"formatValue",value:function(e){return"string"==typeof e&&(e=Un.parse(e,this.format||void 0)),Un.format(e,this.format||void 0)}},{key:"format",get:function(){return this.get("format")},set:function(e){var t=this,n=t.data.editor;t.set("format",e),n&&(n.format=t.format)}},{key:"defaultEditor",get:function(){var e=this;return{name:e.field,type:"date",calendarContainerCls:"b-grid-cell-editor-related",weekStartDay:e.grid.weekStartDay,format:e.format,step:e.step}}}],[{key:"$name",get:function(){return"DateColumn"}},{key:"type",get:function(){return"date"}},{key:"fieldType",get:function(){return"date"}},{key:"fields",get:function(){return["format","pickerFormat","step"]}},{key:"defaults",get:function(){return{format:"L",step:1,minWidth:85,filterType:"date"}}}]),n}(vg);function Ag(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Mg,!0),Mg.exposeProperties(),Mg._$name="DateColumn";var Ig=function(e){Ye()(n,e);var t=Ag(n);function n(e,r){var i;return B()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-number-cell",i}return _()(n,[{key:"defaultEditor",get:function(){var e=this.format,t=this.name,n=this.max,r=this.min,i=this.step,o=this.largeStep,a=this.align;return Qn.cleanupProperties({type:"numberfield",format:e,name:t,max:n,min:r,step:i,largeStep:o,textAlign:a})}},{key:"formatter",get:function(){var e=this,t=e.format,n=e._formatter;return n&&e._lastFormat===t||(e._formatter=n=Pd.get(e._lastFormat=t)),n}},{key:"defaultRenderer",value:function(e){var t=e.value;return null!=t&&(t=this.formatter.format(t),this.unit&&(t="".concat(t).concat(this.unit))),t}}],[{key:"type",get:function(){return"number"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["format","min","max","step","largeStep","unit"]}},{key:"defaults",get:function(){return{filterType:"number",format:""}}}]),n}(vg);function Pg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Ig,!0),Ig.exposeProperties(),Ig._$name="NumberColumn";var Fg=function(e){Ye()(n,e);var t=Pg(n);function n(e,r){var i;return B()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-percent-bar-cell",i}return _()(n,[{key:"defaultRenderer",value:function(e){var t=e.value;return{className:"b-percent-bar-outer",children:[{tag:"div",className:{"b-percent-bar":1,"b-zero":0===(t=t||0),"b-low":t<this.lowThreshold},style:{width:t+"%"},children:[this.showValue?{tag:"span",text:t+"%"}:void 0]}]}}},{key:"resizeToFitContent",value:function(){}}],[{key:"type",get:function(){return"percent"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["showValue","lowThreshold"]}},{key:"defaults",get:function(){return{editor:{type:"number",min:0,max:100},showValue:!1,lowThreshold:20,filterType:"number",htmlEncode:!1,searchable:!1,summaryRenderer:function(e){return"".concat(e,"%")},fitMode:!1}}}]),n}(vg);function Lg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Fg.sum="average",bg.registerColumnType(Fg,!0),Fg._$name="PercentColumn";var Bg=function(e){Ye()(n,e);var t=Lg(n);function n(e,r){var i;return B()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-rating-cell",i}return _()(n,[{key:"renderer",value:function(e){var t=this,n=e.value;return{className:{"b-rating-cell-inner":1,"b-not-editable":!this.editable},children:it.populate(this.max,(function(e){var r=e<n;return{tag:"i",className:Qe()({"b-rating-icon":!0,"b-filled":r,"b-empty":!r},r?t.filledIcon:t.emptyIcon,!0)}}))}}},{key:"onCellClick",value:function(e){var t=e.grid,n=e.column,r=e.record,i=e.target,o=e.event;if(i.classList.contains("b-rating-icon")&&!t.readOnly&&n.editable){var a=[].indexOf.call(i.parentNode.childNodes,i);i.classList.contains("b-filled")&&(o.metaKey||o.shiftKey)&&(a-=1),1===r.get(n.field)&&0===a&&(a=-1),r.set(n.field,a+1)}}}],[{key:"type",get:function(){return"rating"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["emptyIcon","filledIcon","editable"]}},{key:"defaults",get:function(){return{min:0,max:5,emptyIcon:"b-icon b-icon-star",filledIcon:"b-icon b-icon-star",editable:!0,filterType:"number",searchable:!1,width:"11.2em",htmlEncode:!1,minWidth:"11.2em",editor:!1,fitMode:"value"}}}]),n}(Ig);function jg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Bg,!0),Bg.exposeProperties(),Bg._$name="RatingColumn";var _g=function(e){Ye()(n,e);var t=jg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).apply(this,arguments);var t=this,r=t.grid;t.internalCellCls="b-row-number-cell",r&&(r.on({bindStore:"bindStore",thisObj:t}),t.bindStore({store:r.store,initial:!0}),r.store.count&&!r.rendered&&r.on({paint:"resizeToFitContent",thisObj:t,once:!0}))}},{key:"groupHeaderReserved",get:function(){return!0}},{key:"bindStore",value:function(e){var t,n=e.store,r=e.initial,i=this;i.detachListeners("grid"),n.on((t={name:"grid"},Qe()(t,"change".concat(i.grid.asyncEventSuffix),"onStoreChange"),Qe()(t,"thisObj",i),t)),r||i.resizeToFitContent()}},{key:"onStoreChange",value:function(e){var t=e.action;"dataset"!==t&&"add"!==t&&"remove"!==t&&"removeall"!==t||this.resizeToFitContent()}},{key:"renderer",value:function(e){var t=e.record,n=e.grid;return t.isSpecialRow?"":n.store.indexOf(t,!0)+1}},{key:"resizeToFitContent",value:function(){var e=this.grid,t=e.store.count;if(t&&!this.hidden){var n=e.element.querySelector('.b-grid-cell[data-column-id="'.concat(this.id,'"]'));if(n){var r=parseInt(mi.getStyleValue(n,"padding-left")),i=mi.measureText(t,n);this.width=Math.max(this.minWidth,i+2*r)}}}},{key:"flex",set:function(e){}}],[{key:"defaults",get:function(){return{groupable:!1,sortable:!1,filterable:!1,searchable:!1,resizable:!1,minWidth:50,width:50,align:"right",text:"#",editor:!1}}},{key:"type",get:function(){return"rownumber"}}]),n}(vg);bg.registerColumnType(_g,!0),_g._$name="RowNumberColumn";var Hg=n(137),Ng=n.n(Hg);function zg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Vg=function(e){Ye()(n,e);var t=zg(n);function n(e,r){var i;B()(this,n),i=t.apply(this,arguments);var o=Ng()(i);if(!o.template)throw new Error("TemplateColumn needs a template");if("function"!=typeof o.template)throw new Error("TemplateColumn.template must be a function");return i}return _()(n,[{key:"renderer",value:function(e){if(!e.record.isSpecialRow)return this.template({value:e.value,record:e.record,field:e.column.field})}}],[{key:"fields",get:function(){return["template"]}},{key:"defaults",get:function(){return{htmlEncode:!1}}},{key:"type",get:function(){return"template"}}]),n}(vg);function Wg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Vg,!0),Vg.exposeProperties(),Vg._$name="TemplateColumn";var $g=function(e){Ye()(n,e);var t=Wg(n);function n(e,r){var i;return B()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-time-cell",i}return _()(n,[{key:"defaultRenderer",value:function(e){var t=e.value;return t?this.formatValue(t):""}},{key:"groupRenderer",value:function(e){var t=e.cellElement,n=e.groupRowFor;t.innerHTML=this.formatValue(n)}},{key:"formatValue",value:function(e){return"string"==typeof e&&(e=Un.parse(e,this.format)),Un.format(e,this.format)}},{key:"format",get:function(){return this.get("format")},set:function(e){var t=this,n=t.editor;t.set("format",e),n&&(n.format=t.format)}},{key:"defaultEditor",get:function(){return{name:this.field,type:"time",format:this.format}}}],[{key:"type",get:function(){return"time"}},{key:"fieldType",get:function(){return"date"}},{key:"fields",get:function(){return["format"]}},{key:"defaults",get:function(){return{format:"LT",minWidth:140,filterType:"time"}}}]),n}(vg);function Ug(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType($g,!0),$g.exposeProperties(),$g._$name="TimeColumn";var Gg=!1,Yg=function(e){Ye()(n,e);var t=Ug(n);function n(e,r){var i;B()(this,n),i=t.apply(this,arguments);var o=Ng()(i);return o.internalCellCls="b-tree-cell",o.shouldHtmlEncode=o.htmlEncode,o.setData("htmlEncode",!1),o.renderer&&(o.originalRenderer=o.renderer),o.renderer=o.treeRenderer.bind(o),i}return _()(n,[{key:"treeRenderer",value:function(e){var t,n,r,i=this,o=e.grid,a=e.column,s=e.cellElement,l=e.row,u=e.record,c=e.isExport,f=u.instanceMeta(o.store),d={className:"b-tree-cell-value"},h=[d],v={className:"b-tree-cell-inner",tag:u.href?"a":"div",href:u.href,target:u.target,children:h},p={"b-tree-parent-row":0,"b-tree-collapsed":0,"b-tree-expanded":0,"b-loading-children":0},g=e.value;if(i.originalRenderer){var y,m=i.originalRenderer(e),b=null===(y=o.hasFrameworkRenderer)||void 0===y?void 0:y.call(o,{cellContent:m,column:a});t="object"===I()(m)&&!b,g=b?"":!1===m?s.innerHTML:m,e.rendererHtml=m}t||(g=String(null!==(r=g)&&void 0!==r?r:""));if(c)return g;if(u.isLeaf)s.classList.add("b-tree-leaf-cell"),n=e.iconCls||u.iconCls||i.leafIconCls;else{var k=f.collapsed,w=k?i.expandIconCls:i.collapseIconCls,C=k?i.collapsedFolderIconCls:i.expandedFolderIconCls;p["b-tree-parent-row"]=1,p["b-tree-collapsed"]=k,p["b-tree-expanded"]=!k,p["b-loading-children"]=f.isLoadingChildren,s.classList.add("b-tree-parent-cell"),h.unshift({className:"b-tree-expander",children:w?[{tag:"i",className:Qe()({},w,1)}]:null}),Gg=n=e.iconCls||u.iconCls||C}l.isRow&&l.assignCls(p),t||i.shouldHtmlEncode||!g.includes("<")?(t&&Object.assign(d,g),d.children=d.children||[],d.children.unshift(n?{tag:"i",className:Qe()({"b-tree-icon":1},n,1)}:null,t?null:g)):d.html="".concat(n?'<i class="b-tree-icon '.concat(n,'"></i>'):"").concat(g);var R=u.childLevel*i.indentSize+(u.isLeaf?Gg?2:n?.5:.4:0);return v.style="padding-left:".concat(R,"em"),v}}],[{key:"defaults",get:function(){return{tree:!0,hideable:!1,minWidth:150}}},{key:"fields",get:function(){return[{name:"expandIconCls",defaultValue:"b-icon b-icon-tree-expand"},{name:"collapseIconCls",defaultValue:"b-icon b-icon-tree-collapse"},{name:"collapsedFolderIconCls"},{name:"expandedFolderIconCls"},{name:"indentSize",defaultValue:1.7},{name:"leafIconCls",defaultValue:"b-icon b-icon-tree-leaf"},{name:"editTargetSelector",defaultValue:".b-tree-cell-value"}]}},{key:"type",get:function(){return"tree"}}]),n}(vg);function qg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(Yg,!0),Yg.exposeProperties(),Yg._$name="TreeColumn";var Kg=function(e){Ye()(n,e);var t=qg(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"fields",get:function(){return[{name:"iconCls",internal:!0},{name:"expanded",internal:!0},{name:"cls",internal:!0},{name:"rowHeight",internal:!0},{name:"href",internal:!0},{name:"target",internal:!0}]}}]),n}(Lo);Kg.exposeProperties(),Kg._$name="GridRowModel";var Xg=new Map,Zg=new Map,Jg="Grid",Qg={Grid:"GridBase",Scheduler:"SchedulerBase",Gantt:"GanttBase"},ey=/\$\d+$/,ty=function(){function e(){B()(this,e)}return _()(e,null,[{key:"registerFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r=(r=te.uncapitalize(r||Object.prototype.hasOwnProperty.call(e,"$name")&&e.$$name||e.name)).replace(ey,""),Array.isArray(n)||(n=[n||Jg]),n.forEach((function(n){var i=Qg[n]||n,o=Xg.get(i)||new Map,a=Zg.get(i)||new Map;o.set(r,e),a.set(e,t),Xg.set(i,o),Zg.set(i,a)}))}},{key:"getTypeNameFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jg,t=Qg[e]||e,n=Xg.get(t),r={};return n&&n.forEach((function(e,t){return r[t]=e})),r}},{key:"getTypeNameDefaultFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jg,t=Qg[e]||e,n=Xg.get(t),r=Zg.get(t),i={};return n&&r&&n.forEach((function(e,t){r.get(e)&&(i[t]=e)})),i}},{key:"getInstanceFeatures",value:function(e){var t=this;return e.$meta.names.reduce((function(e,n){return Object.assign(e,t.getTypeNameFeatures(n))}),{})}},{key:"getInstanceDefaultFeatures",value:function(e){var t=this;return e.$meta.names.reduce((function(e,n){return Object.entries(t.getTypeNameFeatures(n)).reduce((function(e,r){var i=N()(r,2),o=i[0],a=i[1];return t.isDefaultFeatureForTypeName(a,n)?e[o]=a:delete e[o],e}),e)}),{})}},{key:"isDefaultFeatureForTypeName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jg,n=Qg[t]||t,r=Zg.get(n);return r&&r.get(e)||!1}},{key:"isDefaultFeatureForInstance",value:function(e,t){for(var n=t.$meta.names.slice().reverse(),r=null,i=0,o=n.length;i<o&&null===r;++i){var a=Zg.get(n[i]);a&&a.has(e)&&(r=a.get(e))}return r||!1}},{key:"reset",value:function(){Xg.clear(),Zg.clear()}}]),e}();function ny(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ty._$name="GridFeatureManager";var ry={Enter:1,F2:1},iy={ArrowUp:1,ArrowDown:1,ArrowLeft:1,ArrowRight:1},oy=function(e){Ye()(u,e);var t,n,r,i,o,a,s,l=ny(u);function u(){return B()(this,u),l.apply(this,arguments)}return _()(u,[{key:"construct",value:function(e,t){tt()(Ze()(u.prototype),"construct",this).call(this,e,t);var n=this,r={renderRows:"onGridRefreshed",cellClick:"onCellClick",thisObj:n};n.grid=e,"cellclick"!==n.triggerEvent&&(r[n.triggerEvent]="onTriggerEditEvent"),e.on(r),e.rowManager.on({changeTotalHeight:"onGridRefreshed",thisObj:n}),n.bindStore(e.store)}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",update:"onStoreUpdate",thisObj:this})}},{key:"confirm",value:(s=Pt()(At.a.mark((function e(t){var n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!0,!this.editorContext){e.next=8;break}return kp.owner=this.editorContext.editor.inputField,t.rootElement=this.grid.rootElement,e.next=6,kp.confirm(t);case 6:n=e.sent,kp.owner=null;case 8:return e.abrupt("return",n===kp.yesButton);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"doDestroy",value:function(){this.grid.columns.allRecords.forEach((function(e){var t;null===(t=e._cellEditor)||void 0===t||t.destroy()})),tt()(Ze()(u.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e&&this.cancelEditing(!0),tt()(Ze()(u.prototype),"doDisable",this).call(this,e)}},{key:"disabled",get:function(){var e=this.grid;return Boolean(tt()(Ze()(u.prototype),"disabled",this)||e.disabled||e.readOnly)},set:function(e){gh()(Ze()(u.prototype),"disabled",e,this,!0)}},{key:"isEditing",get:function(){return Boolean(this.editorContext)}},{key:"activeRecord",get:function(){var e;return(null===(e=this.editorContext)||void 0===e?void 0:e.record)||null}},{key:"getEditorForCell",value:function(e){var t=e.cell,n=e.column,r=e.selector,i=e.editor,o=this,a=o.grid,s=n._cellEditor,l=0;n.editTargetSelector&&(l=t.querySelector(n.editTargetSelector).offsetLeft);return i.autoSelect=o.autoSelect,s?(s.inputField!==i&&(s.remove(s.items[0]),s.add(i)),s.align.offset[0]=l):s=n._cellEditor=new o.editorClass({constrainTo:null,cls:"b-cell-editor",inputField:i,blurAction:"none",invalidAction:n.invalidAction,completeKey:!1,cancelKey:!1,owner:a,align:{align:"t0-t0",offset:[l,0]},listeners:o.getEditorListeners()}),n.instantUpdate&&!i.cellEditValueSetter&&(Qn.wrapProperty(i,"value",null,(function(e){var t=o.editorContext;null!=t&&t.editor.isValid&&!Qn.isEqual(t.record[t.column.field],e)&&(t.record[t.column.field]=e)})),i.cellEditValueSetter=!0),Object.assign(s.element.dataset,{rowId:r.id,columnId:r.columnId,field:n.field}),s.inputField.revertOnEscape=n.revertOnEscape,o.editor=s}},{key:"getEditorListeners",value:function(){return{focusOut:"onEditorFocusOut",focusIn:"onEditorFocusIn",start:"onEditorStart",beforeComplete:"onEditorBeforeComplete",complete:"onEditorComplete",cancel:"onEditorCancel",thisObj:this}}},{key:"onEditorStart",value:function(e){var t=e.source,n=this,r=n.editorContext=t.cellEditorContext;if(r){var i=n.grid;r.cell.classList.add("b-editing"),"cellclick"!==n.triggerEvent&&i.on({cellclick:"onCellClickWhileEditing"},n),n.removeEditingListeners=Fi.addListener({globaltap:"onTapOut",thisObj:n}),i.trigger("startCellEdit",{grid:i,editorContext:r})}}},{key:"onEditorBeforeComplete",value:function(e){var t=this.grid,n=e.source.cellEditorContext;return e.grid=t,e.editorContext=n,t.trigger("beforeFinishCellEdit",e)}},{key:"onEditorComplete",value:function(e){var t=e.source,n=this.grid,r=t.cellEditorContext;r.value=t.inputField.value,n.trigger("finishCellEdit",{grid:n,editorContext:r}),this.cleanupAfterEdit(r)}},{key:"onEditorCancel",value:function(e){var t=e.event,n=this.editorContext,r=this.muteEvents,i=this.grid;n&&this.cleanupAfterEdit(n),r||i.trigger("cancelCellEdit",{grid:i,event:t})}},{key:"cleanupAfterEdit",value:function(e){var t=this,n=e.editor;e.cell.classList.remove("b-editing"),n.cellEditorContext=t.editorContext=null,t.grid.un({cellclick:"onCellClickWhileEditing",viewportResize:"onViewportResizeWhileEditing"},t),t.removeEditingListeners(),Fi.suspendFocusEvents(),n.element.remove(),Fi.resumeFocusEvents()}},{key:"getAdjacentEditableCell",value:function(e,t){for(var n=this.grid,r=n.store,i=n.columns,o=i.visibleColumns,a=e.id,s=i.getAdjacentVisibleLeafColumn(e.columnId,t);a;)if(s){if(s.editor&&s.canEdit(r.getById(a)))return{id:a,columnId:s.id};s=i.getAdjacentVisibleLeafColumn(s,t)}else{var l=r.getAdjacent(e.id,t,!1,!0);a=null==l?void 0:l.id,l&&(s=t?o[0]:o[o.length-1])}return null}},{key:"doAddNewAtEnd",value:function(){var e="object"===I()(this.addNewAtEnd)?Qn.clone(this.addNewAtEnd):{},t=this.grid,n=t.store.add(e)[0];return t.rowManager.getRowFor(n)||t.rowManager.displayRecordAtBottom(),n}},{key:"getEditingContext",value:function(e){e=this.grid.normalizeCellContext(e);var t=this.grid,n=t.columns.getById(e.columnId),r=t.store.getById(e.id);if(n&&!n.hidden&&n.editor&&r&&!r.isSpecialRow&&n.canEdit(r)){var i=null==r?void 0:r[n.field];return{column:n,record:r,value:void 0===i?null:i,selector:e,editor:n.editor}}return!1}},{key:"startEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;if(!t.disabled){var n=t.grid,r=n.normalizeCellContext(e),i=t.getEditingContext(r);if(!i)return!1;if(t.editorContext&&t.cancelEditing(),n.focusCell(e),i.cell=n.getCell(e),!1===n.trigger("beforeCellEditStart",{grid:n,editorContext:i}))return!1;mi.focusWithoutScrolling(n.focusElement);var o=i.editor=t.getEditorForCell(i),a=i.cell,s=i.record,l=i.column;return o.inputField.highlightExternalChange=!1,o.cellEditorContext=i,o.render(t.grid.getSubGridFromColumn(l).element),o.startEdit({target:a,record:s,field:o.inputField.name||i.column.field}),!0}return!1}},{key:"cancelEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this,r=n.editorContext,i=n.editor,o=n.grid;r&&(i.containsFocus&&(n.editorContext=null,!o.isDestroying&&i.inputField.owns(mi.getActiveElement(o))&&mi.focusWithoutScrolling(o.focusElement),n.editorContext=r),n.muteEvents=e,i.cancelEdit(t),n.muteEvents=!1)}},{key:"finishEditing",value:(a=Pt()(At.a.mark((function e(){var t,n,r,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).editorContext,r=!1,!n){e.next=11;break}return i=n.column,t.finishEditingPromise=n.editor.completeEdit(i.bindCallback(i.finalizeCellEdit)),e.next=7,t.finishEditingPromise;case 7:return r=e.sent,e.next=10,t.grid.waitForAnimations();case 10:t.finishEditingPromise=null;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onCellClickWhileEditing",value:(o=Pt()(At.a.mark((function e(t){var n,r,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.event,r=t.cellSelector,!(i=this).finishEditingPromise){e.next=4;break}return e.abrupt("return");case 4:if(!i.editorContext||i.editorContext.editor.owns(n.target)){e.next=17;break}if(!i.getEditingContext(r)){e.next=16;break}return e.next=8,i.finishEditing();case 8:if(!e.sent){e.next=12;break}i.startEditing(r),e.next=14;break;case 12:i.grid.focusCell(i.editorContext.selector),i.editor.inputField.focus();case 14:e.next=17;break;case 16:i.finishEditing();case 17:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"onCellClick",value:function(e){var t=e.source,n=e.cellSelector,r=e.target,i=e.event;if(!e.column.onCellClick){var o=t.focusedCell||{};if(r.closest(".b-tree-expander"))return this.cancelEditing(void 0,i),!1;mi.isTouchEvent&&n.id==o.id&&n.columnId==o.columnId?this.startEditing(n):"cellclick"===this.triggerEvent&&this.onTriggerEditEvent({cellSelector:n,target:r})}}},{key:"onTriggerEditEvent",value:(i=Pt()(At.a.mark((function e(t){var n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.cellSelector,!t.target.closest(".b-tree-expander")){e.next=3;break}return e.abrupt("return");case 3:if(!this.editorContext){e.next=8;break}return e.next=6,this.finishEditing();case 6:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:this.startEditing(n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onStoreUpdate",value:function(e){var t=e.changes,n=e.record,r=this.editorContext;null!=r&&r.editor.isVisible&&n===r.record&&r.editor.dataField in t&&r.editor.refreshEdit()}},{key:"onGridRefreshed",value:function(){var e=this,t=e.grid;if(e.editorContext&&t.focusedCell){var n=t.getCell(t.focusedCell);n?e.editorContext.editor.showBy(n):e.cancelEditing()}}},{key:"onElementKeyDown",value:(r=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,!t.handled&&n.grid.focusElement.contains(t.target)){e.next=3;break}return e.abrupt("return");case 3:if(n.editorContext){e.next=8;break}r=t.key,i="Backspace"===r,((o=n.autoEdit&&(1===r.length||i))||ry[r])&&n.grid.focusedCell&&(n.startEditing(n.grid.focusedCell)&&(a=n.editor.inputField,s=a.input,o&&s&&(a.internalOnKeyEvent(t),t.defaultPrevented||(s.value=i?"":r,a.internalOnInput(t),a.moveCaretToEnd()))),t.preventDefault()),e.next=23;break;case 8:e.t0=t.key,e.next="Enter"===e.t0?11:"F2"===e.t0?13:"Escape"===e.t0?16:"Tab"===e.t0?20:22;break;case 11:return n.onEnterKeyPress(t),e.abrupt("break",22);case 13:return t.preventDefault(),n.finishEditing(),e.abrupt("break",22);case 16:return t.stopPropagation(),t.preventDefault(),n.cancelEditing(void 0,t),e.abrupt("break",22);case 20:return n.onTabKeyPress(t),e.abrupt("break",22);case 22:iy[t.key]&&(t.handled=!0);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onEnterKeyPress",value:(n=Pt()(At.a.mark((function e(t){var n,r,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=this).grid,t.preventDefault(),t.stopPropagation(),e.next=5,n.finishEditing();case 5:if(!e.sent){e.next=21;break}if(!n.isDestroyed){e.next=8;break}return e.abrupt("return");case 8:if(n.isEditing){e.next=21;break}if(!(t.ctrlKey||t.metaKey||t.altKey||r.touch)){e.next=11;break}return e.abrupt("return");case 11:if(!t.shiftKey){e.next=15;break}r.internalNextPrevRow(!1,!0,t,!1)&&n.startEditing(r.focusedCell),e.next=21;break;case 15:if(!n.addNewAtEnd){e.next=20;break}if(r.store.getById(null===(i=r.focusedCell)||void 0===i?void 0:i.id)!==r.store.last){e.next=20;break}return e.next=20,n.doAddNewAtEnd();case 20:r.internalNextPrevRow(!0,!0)&&n.startEditing(r.focusedCell);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onTabKeyPress",value:(t=Pt()(At.a.mark((function e(t){var n,r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(r=(n=this).grid.focusedCell)){e.next=20;break}if(i=!t.shiftKey,(o=n.getAdjacentEditableCell(r,i))||!i||!n.addNewAtEnd){e.next=13;break}return e.next=8,n.finishEditing();case 8:if(!0!==e.sent){e.next=13;break}return e.next=12,this.doAddNewAtEnd();case 12:o=n.getAdjacentEditableCell(r,i);case 13:if(!o){e.next=20;break}if(a=!0,!n.isEditing){e.next=19;break}return e.next=18,n.finishEditing();case 18:a=e.sent;case 19:a&&(n.grid.focusCell(o,{animate:n.focusCellAnimationDuration}),n.startEditing(o));case 20:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onElementMouseDown",value:function(e){2===e.button&&this.editorContext&&e.preventDefault()}},{key:"onEditorFocusOut",value:function(e){var t=this,n=t.grid,r=t.editor,i=t.editorContext;i&&!r.isFinishing&&r.inputField.owns(e._target)&&(e.toWidget!==n||n.isLocationEqual(n.focusedCell,i.selector))&&("cancel"===t.blurAction?t.cancelEditing(void 0,e):t.finishEditingPromise||t.finishEditing())}},{key:"onEditorFocusIn",value:function(e){var t=e.toWidget;t===this.editor.inputField&&this.autoSelect&&t.selectAll&&!t.readOnly&&!t.disabled&&t.selectAll()}},{key:"onTapOut",value:function(e){var t=e.event,n=this;n.grid.bodyContainer.contains(t.target)||n.editor.owns(t.target)||("cancel"===n.blurAction?n.cancelEditing(void 0,t):n.finishEditing())}},{key:"onElementClick",value:function(e){e.target.classList.contains("b-grid-body-container")&&this.editorContext&&this.finishEditing()}}],[{key:"$name",get:function(){return"CellEdit"}},{key:"defaultConfig",get:function(){return{autoSelect:!0,blurAction:"complete",addNewAtEnd:null,autoEdit:!1,editorClass:sp,triggerEvent:"celldblclick",focusCellAnimationDuration:!1}}},{key:"pluginConfig",get:function(){return{assign:["startEditing"],before:["onElementKeyDown","onElementMouseDown"],chain:["onElementClick","bindStore"]}}}]),u}(el(_i));function ay(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}oy._$name="CellEdit",ty.registerFeature(oy,!0);var sy=function(e){Ye()(n,e);var t=ay(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"showContextMenu",value:function(e){var t=e.cellSelector,r=e.id,i=e.event;this.client.focusCell(t,{doSelect:!this.client.isSelected(r),event:i}),tt()(Ze()(n.prototype),"showContextMenu",this).call(this,e)}},{key:"shouldShowMenu",value:function(e){var t=e.column;return t&&!1!==t.enableCellContextMenu}},{key:"getDataFromEvent",value:function(e){return Qn.assign(tt()(Ze()(n.prototype),"getDataFromEvent",this).call(this,e),this.client.getCellDataFromEvent(e))}},{key:"beforeContextMenuShow",value:function(e){e.record&&!e.record.isSpecialRow||(e.items.removeRow=!1)}},{key:"populateCellMenu",value:function(e){var t=e.items,n=e.column,r=this.client;null!=n&&n.cellMenuItems&&(Array.isArray(n.cellMenuItems)&&z.a.deprecate("Grid","5.0.0","`cellMenuItems` column config specified as an array is deprecated, need to specify the config as a named object. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."),Qn.merge(t,n.cellMenuItems)),r.readOnly||(t.removeRow={text:"L{removeRow}",localeClass:this,icon:"b-fw-icon b-icon-trash",name:"removeRow",cls:"b-separator",weight:100,onItem:function(){return r.store.remove(r.selectedRecords)}},r.showRemoveRowInContextMenu||(z.a.deprecate("Grid","5.0.0","`showRemoveRowInContextMenu` config is deprecated, in favor of `CellMenu` feature configuration. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."),t.removeRow=!1))}},{key:"showMenu",get:function(){return!0}}],[{key:"$name",get:function(){return"CellMenu"}},{key:"defaultConfig",get:function(){return{processItems:null,items:null,type:"cell"}}},{key:"pluginConfig",get:function(){var e=tt()(Ze()(n),"pluginConfig",this);return e.chain.push("populateCellMenu"),e}}]),n}(Bf);function ly(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}sy.featureClass="",sy._$name="CellMenu",ty.registerFeature(sy,!0,["Grid","Scheduler"]),ty.registerFeature(sy,!1,["Gantt"]);var uy=function(e){Ye()(n,e);var t=ly(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,this.processConfig(t))}},{key:"initTip",value:function(){var e=this;e.tip=kh.new({forElement:e.client.element,forSelector:".b-grid-row:not(.b-group-row) .b-grid-cell",hoverDelay:1e3,trackMouse:!1,cls:"b-celltooltip-tip",getHtml:e.getTooltipContent.bind(e),listeners:{pointerOver:"onPointerOver",thisObj:e}},e.initialConfig),e.relayEvents(e.tip,["beforeshow","show"])}},{key:"onPointerOver",value:function(e){var t=e.target;return!1!==this.client.getColumnFromElement(t).tooltipRenderer}},{key:"processConfig",value:function(e){return"function"==typeof e?{tooltipRenderer:e}:e}},{key:"setConfig",value:function(e){tt()(Ze()(n.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e?this.tip&&(this.tip.destroy(),this.tip=null):this.initTip(),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"getTooltipContent",value:function(e){var t,n=e.tip,r=e.activeTarget,i=e.event,o=this,a=o.client.getRecordFromElement(r),s=o.client.getColumnFromElement(r);return o.forSelector||a!==o.lastRecord||s!==o.lastColumn?(o.lastRecord=a,o.lastColumn=s,s.tooltipRenderer?!1===(t=s.tooltipRenderer({cellElement:r,record:a,column:s,event:i,tip:n,cellTooltip:o}))&&z.a.deprecate("Grid","5.0.0","Returning false to indicate loading is deprecated. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/3.0.1.md for more information"):o.tooltipRenderer&&!1!==s.tooltipRenderer&&!1===(t=o.tooltipRenderer({cellElement:r,record:a,column:s,event:i,tip:n,cellTooltip:o}))&&z.a.deprecate("Grid","5.0.0","Returning false to indicate loading is deprecated. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/3.0.1.md for more information"),t):o.tip._html}}],[{key:"$name",get:function(){return"CellTooltip"}},{key:"defaultConfig",get:function(){return{tooltipRenderer:null}}}]),n}(_i);function cy(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fy(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function fy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}uy._$name="CellTooltip",ty.registerFeature(uy);var hy,vy,py,gy="store",yy=function(e){Ye()(n,e);var t=dy(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t;tt()(Ze()(n.prototype),"construct",this).call(this,e);var r=null===(t=this.client)||void 0===t?void 0:t.store;r&&this.bindStore(r)}},{key:"doDestroy",value:function(){this.unbindStore(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"bindStore",value:function(e){this.lastSync=null,e.on(Qe()({name:gy},"change".concat(this.client.asyncEventSuffix),"onStoreChange"),this)}},{key:"unbindStore",value:function(){this.detachListeners(gy)}},{key:"columnAutoWidthPending",get:function(){return null===this.lastSync||this.hasTimeout("syncAutoWidthColumns")}},{key:"onStoreChange",value:function(e){if("move"!==e.action){var t,n=this;++n.storeGeneration,null!==(t=n.client.features.cellEdit)&&void 0!==t&&t.isEditing?n.syncAutoWidthColumns():n.hasTimeout("syncAutoWidthColumns")||n.setTimeout("syncAutoWidthColumns",n.delay)}}},{key:"syncAutoWidthColumns",value:function(){var e=this,t=e.client,n=e.storeGeneration;if(e.lastSync!==n){var r,i;e.lastSync=n;var o,a=cy(t.columns.visibleColumns);try{for(a.s();!(o=a.n()).done;){var s=o.value;(r=s.autoWidth)&&(!0===r&&(r=e.default),t.resizingColumns=i=!0,s.resizeToFitContent(r))}}catch(e){a.e(e)}finally{a.f()}i&&(t.resizingColumns=!1,t.afterColumnsResized())}e.hasTimeout("syncAutoWidthColumns")&&e.clearTimeout("syncAutoWidthColumns")}}],[{key:"$name",get:function(){return"ColumnAutoWidth"}},{key:"defaultConfig",get:function(){return{default:null,delay:0}}},{key:"pluginConfig",get:function(){return{after:{bindStore:"bindStore",unbindStore:"unbindStore",renderRows:"syncAutoWidthColumns"},assign:["columnAutoWidthPending","syncAutoWidthColumns"]}}}]),n}(el(_i));function my(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}yy.prototype.storeGeneration=0,yy._$name="ColumnAutoWidth",ty.registerFeature(yy,!0);var by=function(e){Ye()(r,e);var t,n=my(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"construct",value:function(e,t){e.features.columnReorder&&e.features.columnReorder.on("beforedestroy",this.onColumnReorderBeforeDestroy,this),this.grid=e,tt()(Ze()(r.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){var e=this;e.grid.features.columnReorder&&!e.grid.features.columnReorder.isDestroyed&&e.detachFromColumnReorder(),e.element&&e.element.remove(),e.element=null,tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.initialized&&(e?this.detachFromColumnReorder():this.init()),tt()(Ze()(r.prototype),"doDisable",this).call(this,e)}},{key:"init",value:function(){var e=this,t=e.grid;t.features.columnReorder&&(e.reorderDetacher=t.features.columnReorder.on({gridheaderdragstart:function(n){var r=n.context,i=t.columns.getById(r.element.dataset.columnId);e.showToolbar(i)},gridheaderdrag:function(t){var n=t.context;return e.onDrag(n)},gridheaderabort:function(){e.hideToolbar()},gridheaderdrop:function(t){var n=t.context;n.valid?e.hideToolbar():e.onDrop(n)},thisObj:e}),e.initialized=!0)}},{key:"onColumnReorderBeforeDestroy",value:function(){this.detachFromColumnReorder()}},{key:"detachFromColumnReorder",value:function(){var e=this;e.grid.features.columnReorder.un("beforedestroy",e.onColumnReorderBeforeDestroy,e),e.reorderDetacher&&e.reorderDetacher(),e.reorderDetacher=null}},{key:"render",value:function(){this.initialized||this.init()}},{key:"showToolbar",value:function(e){var t=this,n=t.grid.getColumnDragToolbarItems(e,[]),r=[];t.clearTimeout(t.buttonHideTimer),n.forEach((function(e){e.text=e.localeClass.L(e.text);var t=r.find((function(t){return t.text===e.group}));t||(t={text:e.localeClass.L(e.group),buttons:[]},r.push(t)),t.buttons.push(e)})),t.element=mi.append(t.grid.element,t.template(r)),t.groups=r,t.buttons=n,t.column=e}},{key:"hideToolbar",value:(t=Pt()(At.a.mark((function e(){var t,n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=(t=this).element)){e.next=7;break}return n.classList.add("b-remove"),e.next=5,Tu.waitForTransitionEnd({element:n,mode:"animation",thisObj:t.client});case 5:n.remove(),t.element=null;case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onDrag",value:function(e){var t,n=this;if(e.dragProxy.getBoundingClientRect().top-n.grid.element.getBoundingClientRect().top>100?n.element.classList.add("b-closer"):n.element.classList.remove("b-closer"),n.hoveringButton&&(n.hoveringButton.classList.remove("b-hover"),n.hoveringButton=null),null!==(t=e.targetElement)&&void 0!==t&&t.closest(".b-columndragtoolbar")){n.element.classList.add("b-hover");var r=e.targetElement.closest(".b-columndragtoolbar  .b-target-button:not([data-disabled=true])");r&&(r.classList.add("b-hover"),n.hoveringButton=r)}else n.element.classList.remove("b-hover")}},{key:"onDrop",value:function(e){var t=this;if(e.targetElement&&e.targetElement.matches(".b-columndragtoolbar .b-target-button:not([data-disabled=true])")){var n=e.targetElement,r=t.buttons.find((function(e){return e.name===n.dataset.name}));r&&(n.classList.add("b-activate"),t.buttonHideTimer=t.setTimeout((function(){t.hideToolbar(),r.onDrop({column:t.column})}),100))}else t.hideToolbar()}},{key:"template",value:function(e){return ud.tpl(hy||(hy=sv()(['\n            <div class="b-columndragtoolbar">     \n            <div class="b-title"></div>          \n            ',"\n            </div>"])),e.map((function(e){return ud.tpl(vy||(vy=sv()(['\n                <div class="b-group">\n                    <div class="b-buttons">\n                    ','\n                    </div>\n                    <div class="b-title">',"</div>\n                </div>\n            "])),e.buttons.map((function(e){return ud.tpl(py||(py=sv()(['\n                        <div class="b-target-button" data-name="','" data-disabled="','">\n                            <i class="','"></i>\n                            ',"\n                        </div>\n                    "])),e.name,e.disabled,e.icon,e.text)})),e.text)})))}}],[{key:"$name",get:function(){return"ColumnDragToolbar"}},{key:"pluginConfig",get:function(){return{after:["render"]}}}]),r}(el(_i));function ky(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}by.featureClass="b-hascolumndragtoolbar",by._$name="ColumnDragToolbar",ty.registerFeature(by,pe.a.isTouchDevice);var wy=function(e){Ye()(n,e);var t=ky(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.grid=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"getColumnPickerItems",value:function(e){var t,n=this,r=n.createColumnsFromModel;if(n.groupByRegion)t=n.grid.regions.map((function(e){var t=n.grid.getSubGrid(e).columns.topColumns;return{text:te.capitalize(e),menu:n.buildColumnMenu(t),disabled:0===t.length,region:e}})),r&&t.push({text:n.L("L{newColumns}"),menu:n.createAutoColumnItems()});else if(n.groupByTag){var i={};e.topColumns.forEach((function(e){e.tags&&e.hideable&&e.tags.forEach((function(e){i[e]||(i[e]=1)}))})),t=Object.keys(i).sort().map((function(e){return{text:te.capitalize(e),menu:n.buildColumnMenu(n.getColumnsForTag(e)),tag:e,onBeforeSubMenu:function(e){var t=e.item,r=e.itemEl;n.refreshTagMenu(t,r)}}})),r&&t.push({text:n.L("L{newColumns}"),menu:n.createAutoColumnItems()})}else{var o;if(t=n.buildColumnMenu(e.topColumns),r)(o=t.items).push.apply(o,F()(Qn.transformNamedObjectToArray(n.createAutoColumnItems())))}return t}},{key:"createAutoColumnItems",value:function(){for(var e=this,t=e.grid,n=t.columns,r=t.store.modelClass.allFields,i={},o=function(t,o){var a=r[t],s=a.name;n.get(s)||a.internal||(i[s]={text:a.text||te.separate(a.name),checked:!1,onToggle:function(t){var r=n.get(s);r?r[t.checked?"show":"hide"]():n.add(n.generateColumnForField(a,{region:e.forColumn.region})),t.bubbles=!1}})},a=0,s=r.length;a<s;a++)o(a);return i}},{key:"getColumnsForTag",value:function(e){return this.grid.columns.records.filter((function(t){return t.tags&&t.tags.includes(e)&&!1!==t.hideable}))}},{key:"refreshTagMenu",value:function(e,t){this.getColumnsForTag(e.tag).forEach((function(t){var n=e.items.find((function(e){return e.column===t}));n&&(n.checked=!0!==t.hidden)}))}},{key:"buildColumnMenu",value:function(e){var t=this,n=e.length>0&&e[0].region,r=this.grid,i=e.reduce((function(e,i){var o=r.columns.visibleColumns.filter((function(e){return e.region===i.region}));if(!1!==i.hideable){var a={grid:r,text:i.headerText,column:i,name:i.id,checked:!0!==i.hidden,disabled:!0!==i.hidden&&1===o.length,cls:i.region!==n?"b-separator":""};n=i.region,i.children&&(a.menu=t.buildColumnMenu(i.children)),e.push(a)}return e}),[]);return{cls:this.menuCls,items:i}}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this,i=r.grid.columns;if(r.forColumn=t,!1!==t.showColumnPicker&&i.some((function(e){return e.hideable}))&&(n.columnPicker={text:"L{columnsMenu}",localeClass:r,name:"columnPicker",icon:"b-fw-icon b-icon-columns",cls:"b-separator",weight:200,menu:r.getColumnPickerItems(i),onToggle:r.onColumnToggle,disabled:r.disabled}),!1!==t.hideable){var o=i.visibleColumns.filter((function(e){return e.region===t.region}));n.hideColumn={text:"L{hideColumn}",localeClass:r,icon:"b-fw-icon b-icon-hide-column",weight:210,name:"hideColumn",disabled:1===o.length||r.disabled,onItem:function(){return t.hide()}}}}},{key:"onColumnToggle",value:function(e){var t=e.menu,n=e.item,r=e.checked;if(!!n.column.hidden!=!r){n.column[r?"show":"hide"]();var i=n.grid,o=n.column,a=i.columns,s=i.features,l=t.items,u=a.visibleColumns.filter((function(e){return e.region===n.column.region})),c=s.contextMenu,f=s.headerMenu,d=c&&!c.disabled,h=d?c:f,v=h&&h[d?"currentMenu":"menu"],p=d?v.items.find((function(e){return"hideColumn"===e.name})):v.widgetMap.hideColumn;if(1===u.length){var g=l.find((function(e){return e.name===u[0].id}));g&&(g.disabled=!0),p&&o.region===n.column.region&&(p.disabled=!0)}else u.forEach((function(e){var t=l.find((function(t){return t.column===e}));t&&(t.disabled=!1)})),p&&o.region===n.column.region&&(p.disabled=!1);n.menu&&n.menu.eachWidget((function(e){e.checked=r}));var y=t.owner;y&&y.column===o.parent&&(y.checked=l.some((function(e){return!0===e.checked})))}}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this.grid.columns.visibleColumns.filter((function(t){return t.region===e.region}));return!1!==e.hideable&&n.length>1&&t.push({text:"L{hideColumnShort}",group:"L{column}",localeClass:this,icon:"b-fw-icon b-icon-hide-column",weight:101,name:"hideColumn",onDrop:function(e){return e.column.hide()}}),t}}],[{key:"$name",get:function(){return"ColumnPicker"}},{key:"configurable",get:function(){return{groupByRegion:!1,groupByTag:!1,createColumnsFromModel:!1,menuCls:"b-column-picker-menu b-sub-menu"}}},{key:"pluginConfig",get:function(){return{chain:["populateHeaderMenu","getColumnDragToolbarItems"]}}}]),n}(_i);function Cy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}wy._$name="ColumnPicker",ty.registerFeature(wy,!0);var Ry=function(e){Ye()(n,e);var t=Cy(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.ignoreSelectors=[".b-grid-header-resize-handle",".b-field"],this.grid=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){this.dragHelper&&this.dragHelper.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"init",value:function(){var e=this,t=e.grid,n=t.element,r=mi.children(n,".b-grid-headers");r.push.apply(r,F()(mi.children(n,".b-grid-header-children"))),e.dragHelper?e.dragHelper.containers=r:(e.dragHelper=new Xf({name:"columnReorder",mode:"container",dragThreshold:10,targetSelector:".b-grid-header",floatRootOwner:t,outerElement:n.querySelector("header.b-grid-header-container"),containers:r,isElementDraggable:function(n){if(Boolean(mi.up(n,e.ignoreSelectors.join(",")))||e.disabled)return!1;var r=mi.up(n,this.targetSelector),i=r&&t.columns.getById(r.dataset.columnId),o=i&&0===i.childLevel&&1===t.subGrids[i.region].columns.count;return Boolean(i)&&!1!==i.draggable&&!o},ignoreSelector:".b-filter-icon,.b-grid-header-resize-handle",listeners:{dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,thisObj:e}}),e.relayEvents(e.dragHelper,["dragStart","drag","drop","abort"],"gridHeader"))}},{key:"onDrag",value:function(e){var t=e.context,n=e.event,r=uc.fromElement(n.target,"gridheader");r&&r.subGrid.sealedColumns?t.valid=!1:this.grid.features.columnDragToolbar||(t.valid=Boolean(n.target.closest(".b-grid-headers")))}},{key:"onDragStart",value:function(){var e=this;if(!e.grid.features.columnDragToolbar){var t=e.grid.element.querySelector(".b-grid-header-container").getBoundingClientRect();e.dragHelper.minY=t.top,e.dragHelper.maxY=t.bottom}this.grid.headerContainer.classList.add("b-dragging-header")}},{key:"onDrop",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n,r=this.grid,i=t.dragging,o=mi.up(t.target,".b-grid-header"),a=r.columns.get(o.dataset.column),s=t.draggedTo.dataset.region||a.region,l=t.insertBefore,u=r.columns.getById(i.dataset.columnId),c=l?r.columns.getById(l.dataset.columnId):r.subGrids[s].columns.last.nextSibling;if(c)n=c.parent;else{var f=mi.up(o.parentElement,".b-grid-header");n=f?r.columns.getById(f.dataset.columnId):r.columns.rootNode}if(r.headerContainer.classList.remove("b-dragging-header"),s!==u.region||a!==u.previousSibling&&c!==u.nextSibling){var d=u.parent&&1===u.parent.children.length&&u.parent;d&&d.parent.removeChild(d),i.remove(),u.region=s,n.insertChild(u,c)}else this.dragHelper.abort()}},{key:"onInvalidDrop",value:function(){this.grid.headerContainer.classList.remove("b-dragging-header")}},{key:"renderContents",value:function(){this.init()}},{key:"onPaint",value:function(){this.init()}}],[{key:"$name",get:function(){return"ColumnReorder"}},{key:"pluginConfig",get:function(){return{after:["onPaint","renderContents"]}}}]),n}(el(_i));function Sy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ry.featureClass="b-column-reorder",Ry._$name="ColumnReorder",ty.registerFeature(Ry,!0);var xy=function(e){Ye()(n,e);var t=Sy(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;r.grid=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t),r.resizer=new ad({name:"columnResize",targetSelector:".b-grid-header",handleSelector:".b-grid-header-resize-handle",outerElement:e.element,listeners:{beforeresizestart:r.onBeforeResizeStart,resizestart:r.onResizeStart,resizing:r.onResizing,resize:r.onResize,thisObj:r}})}},{key:"liveResize",get:function(){return this._liveResize},set:function(e){"auto"===e&&(e=!pe.a.isMobileSafari),this._liveResize=e}},{key:"doDestroy",value:function(){this.resizer&&this.resizer.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"onBeforeResizeStart",value:function(){return!this.disabled}},{key:"onResizeStart",value:function(e){var t=e.context,n=this.grid,r=this.resizer,i=t.column=n.columns.getById(t.element.dataset.columnId),o=n.subGrids[i.region].scrollable;r.minWidth=i.minWidth,o.scrollWidth=o.scrollWidth,t.element.style.minWidth="",n.element.classList.add("b-column-resizing")}},{key:"onResizing",value:function(e){var t=e.context;t.valid&&this.liveResize&&(this.grid.resizingColumns=!0,t.column.width=t.newWidth)}},{key:"onResize",value:function(e){var t=e.context,n=this.grid,r=t.column;if(n.element.classList.remove("b-column-resizing"),t.valid&&(this.liveResize?(n.resizingColumns=!1,n.afterColumnsResized()):r.width=t.newWidth,pe.a.isIE11&&r.parent&&r.parent.flex)){var i=r.parent;n.getHeaderElement(i.id).style.flexBasis=i.children.reduce((function(e,t){return e+n.getHeaderElement(t.id).offsetWidth}),0)+"px"}}}],[{key:"$name",get:function(){return"ColumnResize"}},{key:"defaultConfig",get:function(){return{liveResize:"auto"}}},{key:"pluginConfig",get:function(){return[]}}]),n}(_i);function Ey(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}xy._$name="ColumnResize",ty.registerFeature(xy,!0);var Dy=function(e){Ye()(n,e);var t=Ey(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),this.grid=e,z.a.deprecate("Grid","5.0.0","`ContextMenu` feature is deprecated, in favor of `CellMenu` and `HeaderMenu` features. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/3.1.0.md for more information."),e.features.cellMenu&&(e.features.cellMenu.disabled=!0),e.features.headerMenu&&(e.features.headerMenu.disabled=!0)}},{key:"doDestroy",value:function(){this.currentMenu&&this.currentMenu.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(".b-grid-header.b-depth-0"))switch(e.key){case" ":case"ArrowDown":this.showContextMenu(e)}}},{key:"showContextMenu",value:function(e){if(!this.disabled){var t=mi.up(e.target,".b-grid-header"),n=this.grid.getCellDataFromEvent(e);t?this.handleHeaderContextMenu(t,e):n&&!this.disableCellContextMenu&&this.handleCellContextMenu(n,e)}}},{key:"handleHeaderContextMenu",value:function(e,t){if(e.dataset.column){var n=this,r=n.grid,i=r.columns.getById(e.dataset.columnId);if(!1!==i.enableHeaderContextMenu){var o=[].concat(F()(n.headerItems),F()(i.headerMenuItems||[])),a=Qn.transformArrayToNamedObject(o),s={owner:n.client,constrainTo:document,cls:"b-context-menu",scrollAction:"hide",onItem:function(e){var t=e.item,n=e.element;r.trigger("contextMenuItem",{source:r,item:t,column:i,element:n})},onToggle:function(e){var t=e.item,n=e.checked,o=e.element;r.trigger("contextMenuToggleItem",{source:r,item:t,column:i,checked:n,element:o})},onDestroy:function(){n.currentMenu=null},listeners:{show:function(e){var t=e.source;c.menu=t,r.trigger("headerContextMenuShow",c)}}};r.populateHeaderMenu({column:i,items:a,menu:s});var l=Qn.transformNamedObjectToArray(a),u=n.processHeaderItems,c={items:l,column:i,event:t,element:e};Qn.merge(s,{items:l}),(!u||!1!==u(c))&&l.length>0&&(t.preventDefault(),l.sort((function(e,t){return(e.weight||150)-(t.weight||150)})),!1!==r.trigger("headerContextMenuBeforeShow",c)&&(n.currentMenu=vd.showContextMenu("keydown"===t.type?e:[t.clientX+1,t.clientY+1],s),n.currentMenu.eachWidget((function(e){!e.column&&e instanceof Af&&(e.column=i)}),!0)))}}}},{key:"handleCellContextMenu",value:function(e,t){var n=this,r=n.grid,i=r.columns.getById(e.columnId);if(!1!==i.enableCellContextMenu){r.focusCell(e.cellSelector,{doSelect:!r.isSelected(e.id),event:t});var o=e.record,a=[].concat(F()(n.cellItems||[]),F()(i.cellMenuItems||[])),s=Qn.transformArrayToNamedObject(a);r.populateCellMenu({column:i,record:o,items:s});var l=Qn.transformNamedObjectToArray(s),u=n.processCellItems,c=e.cellElement,f={items:l,column:i,event:t,record:o,element:c},d={owner:n.client,items:l,onBeforeItem:function(e){Object.assign(e,f)},onItem:function(e){var t=e.item;r.trigger("contextMenuItem",{source:r,item:t,column:i,record:o,cell:c})},onClose:function(e){"outside"!==e.reason&&r.focus()},onDestroy:function(){n.currentMenu=null},listeners:{show:function(e){var t=e.source;f.menu=t,r.trigger("cellContextMenuShow",f)}}};(!u||!1!==u(f))&&l.length>0&&(l.forEach((function(e){e.column=i,e.record=o})),t.preventDefault(),l.sort((function(e,t){return(e.weight||150)-(t.weight||150)})),!1!==r.trigger("cellContextMenuBeforeShow",f)&&(n.currentMenu=vd.showContextMenu([t.clientX+1,t.clientY+1],d)))}}},{key:"hideContextMenu",value:function(e){var t;null===(t=this.currentMenu)||void 0===t||t.hide(e)}},{key:"triggerEvent",get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent},set:function(e){this._triggerEvent=e}}],[{key:"$name",get:function(){return"ContextMenu"}},{key:"defaultConfig",get:function(){return{headerItems:[],processHeaderItems:null,cellItems:[],processCellItems:null,triggerEvent:null,disableCellContextMenu:null}}},{key:"pluginConfig",get:function(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onElementKeyDown"]}}}]),n}(_i);function Ty(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ty(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ty(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function My(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ay(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ay(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ay(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Iy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Dy.featureClass="",Dy._$name="ContextMenu",ty.registerFeature(Dy);var Py={date:"date",integer:"number",number:"number",string:"text",duration:"duration"},Fy=function(e){Ye()(n,e);var t=Iy(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){if(e.features.filterBar)throw new Error("Grid.feature.Filter feature may not be used together with Grid.feature.FilterBar. These features are mutually exclusive.");var r=this;if(r.grid=e,r.closeFilterEditor=r.closeFilterEditor.bind(r),tt()(Ze()(n.prototype),"construct",this).call(this,e,t),r.bindStore(e.store),t&&"object"===I()(t)){var i=Qn.clone(t);delete i.prioritizeColumns,Qn.isEmpty(i)||e.store.filter(i,null,e.isConfiguring)}}},{key:"doDestroy",value:function(){var e,t;null===(e=this.filterTip)||void 0===e||e.destroy(),null===(t=this.filterEditorPopup)||void 0===t||t.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"store",get:function(){return this.grid.store}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",beforeFilter:"onStoreBeforeFilter",filter:"onStoreFilter",thisObj:this})}},{key:"refreshHeaders",value:function(e){var t=this,n=t.grid,r=n.headerContainer;if(r){mi.children(r,".b-filter-icon.b-latest").forEach((function(e){return e.classList.remove("b-latest")})),t.filterTip||(t.filterTip=new kh({forElement:r,forSelector:".b-filter-icon",getHtml:function(e){return e.activeTarget.dataset.filterText}})),n.store.isFiltered||t.filterTip.hide();var i,o=My(n.columns);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(!1!==a.filterable){var s=t.store.filters.getBy("property",a.field),l=a.element;if(l){var u=a.textWrapper,c=null==u?void 0:u.querySelector(".b-filter-icon"),f=void 0;if(s){var d=s.displayValue||s.value||"";a.formatValue&&(d=a.formatValue(d)),f=t.L("L{filter}")+": "+("string"==typeof s?s:"".concat(s.operator," ").concat(d))}else f=t.L("L{applyFilter}");c?c.dataset.filterText=f:(c=mi.createElement({parent:u,tag:"div",className:"b-filter-icon",dataset:{filterText:f}}),l.classList.add("b-filterable")),a.field===t.store.latestFilterField&&c.classList.add("b-latest"),l.classList[s?"add":"remove"]("b-filter")}a.meta.isFiltered=!!s}}}catch(e){o.e(e)}finally{o.f()}e&&n.refreshRows()}}},{key:"applyFilter",value:function(e,t){this.store.filter(Oy(Oy(Oy({},e.filterable),t),{},{property:e.field}))}},{key:"removeFilter",value:function(e){this.store.removeFilter(e.field)}},{key:"getPopupDateItems",value:function(e,t,n,r,i,o,a,s){var l=this,u=o;function c(){l.removeFilter(e)}function f(e){"Enter"===e.event.key&&o()}function d(t){var n=t.source,r=t.value;null==r?c():(l.clearSiblingsFields(n),l.applyFilter(e,{operator:n.operator,value:r,displayValue:n._value,type:"date"}))}return[Qn.assign({type:"date",ref:"on",placeholder:"L{on}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"="===(null==n?void 0:n.operator)?n.value:r,operator:"=",onKeydown:f,onChange:d,onClose:u,onClear:c},s),Qn.assign({type:"date",ref:"before",placeholder:"L{before}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-before"></i>',value:"<"===(null==n?void 0:n.operator)?n.value:null,operator:"<",onKeydown:f,onChange:d,onClose:u,onClear:c},s),Qn.assign({type:"date",ref:"after",cls:"b-last-row",placeholder:"L{after}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-after"></i>',value:">"===(null==n?void 0:n.operator)?n.value:null,operator:">",onKeydown:f,onChange:d,onClose:u,onClear:c},s)]}},{key:"getPopupNumberItems",value:function(e,t,n,r,i,o,a,s){var l=this,u=o;function c(){l.removeFilter(e)}function f(e){"Enter"===e.event.key&&o()}function d(t){var n=t.source,r=t.value;null==r?c():(l.clearSiblingsFields(n),l.applyFilter(e,{operator:n.operator,value:r}))}return[Qn.assign({type:"number",placeholder:"L{Filter.equals}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"="===(null==n?void 0:n.operator)?n.value:r,operator:"=",onKeydown:f,onChange:d,onEsc:u,onClear:c},s),Qn.assign({type:"number",placeholder:"L{lessThan}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:"<"===(null==n?void 0:n.operator)?n.value:null,operator:"<",onKeydown:f,onChange:d,onEsc:u,onClear:c},s),Qn.assign({type:"number",cls:"b-last-row",placeholder:"L{moreThan}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:">"===(null==n?void 0:n.operator)?n.value:null,operator:">",onKeydown:f,onChange:d,onEsc:u,onClear:c},s)]}},{key:"clearSiblingsFields",value:function(e){var t;null===(t=this.filterEditorPopup)||void 0===t||t.items.forEach((function(t){t!==e&&(null==t||t.clear())}))}},{key:"getPopupDurationItems",value:function(e,t,n,r,i,o,a,s){var l=this,u=o,c=a;function f(t){var n=t.source,r=t.value;null==r?a():(l.applyFilter(e,{operator:n.operator,value:r}),o())}return[Qn.assign({type:"duration",placeholder:"L{Filter.equals}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"="===(null==n?void 0:n.operator)?n.value:r,operator:"=",onChange:f,onEsc:u,onClear:c},s),Qn.assign({type:"duration",placeholder:"L{lessThan}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:"<"===(null==n?void 0:n.operator)?n.value:null,operator:"<",onChange:f,onEsc:u,onClear:c},s),Qn.assign({type:"duration",cls:"b-last-row",placeholder:"L{moreThan}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:">"===(null==n?void 0:n.operator)?n.value:null,operator:">",onChange:f,onEsc:u,onClear:c},s)]}},{key:"getPopupStringItems",value:function(e,t,n,r,i,o,a,s){var l=this;return[Qn.assign({type:t,cls:"b-last-row",placeholder:"L{filter}",localeClass:l,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:n?n.value||n:r,operator:"*",onChange:function(t){var n=t.source,r=t.value;""===r?a():(l.applyFilter(e,{operator:n.operator,value:r,displayValue:n.displayField&&n.records?n.records.map((function(e){return e[n.displayField]})).join(", "):void 0}),n.multiSelect||o())},onClose:o,onClear:a},s)]}},{key:"getPopupItems",value:function(e,t,n,r,i,o,a,s){switch(t){case"date":return this.getPopupDateItems.apply(this,arguments);case"number":return this.getPopupNumberItems.apply(this,arguments);case"duration":return this.getPopupDurationItems.apply(this,arguments);default:return this.getPopupStringItems.apply(this,arguments)}}},{key:"showFilterEditor",value:function(e,t){var n=this,r=this,i=r.store,o="string"==typeof e?r.grid.columns.getById(e):e,a=o.element,s=i.modelClass.fieldMap[o.field],l=i.filters.getBy("property",o.field),u=o.filterType,c=u?Py[u]:Py[o.type]||s&&Py[s.type]||"text";if(!1!==o.filterable){r.closeFilterEditor();var f=r.getPopupItems(o,c,l,t,i,r.closeFilterEditor,(function(){r.removeFilter(o),r.closeFilterEditor()}),o.filterable.filterField);f.forEach((function(e){return e.placeholder=n.L(e.placeholder)})),r.filterEditorPopup=vd.openPopup(a,{owner:r.grid,width:"16em",cls:"b-filter-popup",scrollAction:"realign",items:f})}}},{key:"closeFilterEditor",value:function(){var e;null===(e=this.filterEditorPopup)||void 0===e||e.setTimeout(this.filterEditorPopup.destroy),this.filterEditorPopup=null}},{key:"populateCellMenuWithDateItems",value:function(e){var t=e.column,n=e.record,r=e.items,i=t.field,o=n.getFieldDefinition(i);if("date"===(t.filterType||(null==o?void 0:o.type)||t.type)){var a=this,s=n[i],l=function(e){a.applyFilter(t,{operator:e,value:s,displayValue:t.formatValue?t.formatValue(s):s,type:"date"})};r.filterDateEquals={text:"L{on}",localeClass:a,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterDateEquals",weight:300,disabled:a.disabled,onItem:function(){return l("=")}},r.filterDateBefore={text:"L{before}",localeClass:a,icon:"b-fw-icon b-icon-filter-before",name:"filterDateBefore",weight:310,disabled:a.disabled,onItem:function(){return l("<")}},r.filterDateAfter={text:"L{after}",localeClass:a,icon:"b-fw-icon b-icon-filter-after",name:"filterDateAfter",weight:320,disabled:a.disabled,onItem:function(){return l(">")}}}}},{key:"populateCellMenuWithNumberItems",value:function(e){var t=e.column,n=e.record,r=e.items,i=t.field,o=n.getFieldDefinition(i);if("number"===(t.filterType||t.type||(null==o?void 0:o.type))){var a=this,s=n[i],l=function(e){a.applyFilter(t,{operator:e,value:s})};r.filterNumberEquals={text:"L{equals}",localeClass:a,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterNumberEquals",weight:300,disabled:a.disabled,onItem:function(){return l("=")}},r.filterNumberLess={text:"L{lessThan}",localeClass:a,icon:"b-fw-icon b-icon-filter-less",name:"filterNumberLess",weight:310,disabled:a.disabled,onItem:function(){return l("<")}},r.filterNumberMore={text:"L{moreThan}",localeClass:a,icon:"b-fw-icon b-icon-filter-more",name:"filterNumberMore",weight:320,disabled:a.disabled,onItem:function(){return l(">")}}}}},{key:"populateCellMenuWithDurationItems",value:function(e){var t=e.column,n=e.record,r=e.items,i=t.field,o=n.getFieldDefinition(i);if("duration"===(t.filterType||(null==o?void 0:o.type)||t.type)){var a=this,s=n[i],l=function(e){a.applyFilter(t,{operator:e,value:s})};r.filterDurationEquals={text:"L{equals}",localeClass:a,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterDurationEquals",weight:300,disabled:a.disabled,onItem:function(){return l("=")}},r.filterDurationLess={text:"L{lessThan}",localeClass:a,icon:"b-fw-icon b-icon-filter-less",name:"filterDurationLess",weight:310,disabled:a.disabled,onItem:function(){return l("<")}},r.filterDurationMore={text:"L{moreThan}",localeClass:a,icon:"b-fw-icon b-icon-filter-more",name:"filterDurationMore",weight:320,disabled:a.disabled,onItem:function(){return l(">")}}}}},{key:"populateCellMenuWithStringItems",value:function(e){var t=e.column,n=e.record,r=e.items,i=t.field,o=n.getFieldDefinition(i),a=t.filterType||(null==o?void 0:o.type)||t.type;if(!/(date|number|duration)/.test(a)){var s,l,u=this,c=n[i],f=null!==(s=null===(l=t.filterable.filterField)||void 0===l?void 0:l.operator)&&void 0!==s?s:"*";r.filterStringEquals={text:"L{equals}",localeClass:u,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterStringEquals",weight:300,disabled:u.disabled,onItem:function(){return u.applyFilter(t,{value:c,operator:f})}}}}},{key:"populateCellMenu",value:function(e){var t=e.column,n=(e.record,e.items),r=this;!1!==t.filterable&&(r.populateCellMenuWithDateItems.apply(r,arguments),r.populateCellMenuWithNumberItems.apply(r,arguments),r.populateCellMenuWithDurationItems.apply(r,arguments),r.populateCellMenuWithStringItems.apply(r,arguments),t.meta.isFiltered&&(n.filterRemove={text:"L{removeFilter}",localeClass:r,icon:"b-fw-icon b-icon-clear",cls:"b-separator",weight:400,name:"filterRemove",disabled:r.disabled,onItem:function(){return r.removeFilter(t)}}))}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this;t.meta.isFiltered?(n.editFilter={text:"L{editFilter}",localeClass:r,name:"editFilter",weight:100,icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:r.disabled,onItem:function(){return r.showFilterEditor(t)}},n.removeFilter={text:"L{removeFilter}",localeClass:r,name:"removeFilter",weight:110,icon:"b-fw-icon b-icon-remove",disabled:r.disabled,onItem:function(){return r.removeFilter(t)}}):!1!==t.filterable&&(n.filter={text:"L{filter}",localeClass:r,name:"filter",weight:100,icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:r.disabled,onItem:function(){return r.showFilterEditor(t)}})}},{key:"onStoreBeforeFilter",value:function(e){for(var t=this,n=e.filters,r=this.client.columns,i=function(e){var i,o=n.getAt(e),a=(o.columnOwned||t.prioritizeColumns)&&r.get(o.property);null!=a&&null!==(i=a.filterable)&&void 0!==i&&i.filterFn&&(a.$filter||(a.$filter=new zo({columnOwned:!0,property:o.property,operator:o.operator,value:o.value,filterBy:function(e){return a.filterable.filterFn({value:this.value,record:e,operator:this.operator,property:this.property})}})),a.$filter.value=o.value,a.$filter.displayValue=o.displayValue,a.$filter.operator=o.operator,n.splice(e,1,a.$filter))},o=0;o<n.count;o++)i(o)}},{key:"onStoreFilter",value:function(){this.refreshHeaders(!1)}},{key:"renderHeader",value:function(){this.refreshHeaders(!1)}},{key:"onElementClick",value:function(e){var t=e.target;if(this.filterEditorPopup&&this.closeFilterEditor(),t.classList.contains("b-filter-icon")){var n=mi.up(t,".b-grid-header");return this.showFilterEditor(n.dataset.columnId),!1}}}],[{key:"$name",get:function(){return"Filter"}},{key:"configurable",get:function(){return{prioritizeColumns:!1}}},{key:"pluginConfig",get:function(){return{chain:["renderHeader","populateCellMenu","populateHeaderMenu","onElementClick","bindStore"]}}}]),n}(_i);function Ly(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function By(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return jy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jy(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function jy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Fy._$name="Filter",ty.registerFeature(Fy);var Hy=function(e){Ye()(n,e);var t=_y(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){if(e.features.filter)throw new Error("Grid.feature.FilterBar feature may not be used together with Grid.feature.Filter, These features are mutually exclusive.");var r=this;r.grid=e,r.onColumnFilterFieldChange=r.onColumnFilterFieldChange.bind(r),tt()(Ze()(n.prototype),"construct",this).call(this,e,Array.isArray(t)?{filter:t}:t),r.bindStore(e.store),r.filter&&e.store.filter(r.filter),r.gridDetacher=e.on("beforeelementclick",r.onBeforeElementClick,r)}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",beforeFilter:"onStoreBeforeFilter",filter:"onStoreFilter",thisObj:this})}},{key:"doDestroy",value:function(){var e;this.destroyFilterBar(),null===(e=this.gridDetacher)||void 0===e||e.call(this),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this,r=this.grid.columns;null==r||r.forEach((function(n){var r=t.getColumnFilterField(n);r&&(r.disabled=e)})),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"updateCompactMode",value:function(e){for(var t in this.client.headerContainer.classList[e?"add":"remove"]("b-filter-bar-compact"),this._columnFilters){var n=this._columnFilters[t];n.placeholder=e?n.column.headerText:null}}},{key:"destroyFilterBar",value:function(){var e;null===(e=this.grid.columns)||void 0===e||e.forEach(this.destroyColumnFilterField,this)}},{key:"hideFilterBar",value:function(){var e,t=this;t.clearStoreFiltersOnHide&&t.suspendStoreTracking(),null===(e=t.grid.columns)||void 0===e||e.forEach((function(e){return t.hideColumnFilterField(e,!0)})),t.grid.store.filter(),t.clearStoreFiltersOnHide&&t.resumeStoreTracking(),t.hidden=!0}},{key:"showFilterBar",value:function(){this.renderFilterBar(),this.hidden=!1}},{key:"toggleFilterBar",value:function(){this.hidden?this.showFilterBar():this.hideFilterBar()}},{key:"renderFilterBar",value:function(){var e=this;this.grid.columns.visibleColumns.forEach((function(t){return e.renderColumnFilterField(t)})),this.rendered=!0}},{key:"renderColumnFilterField",value:function(e){var t=this,n=t.grid,r=t.getColumnFilterable(e);if(r&&!e.hidden){var i=e.element,o=n.store.filters.getBy("property",e.field),a=t.getColumnFilterField(e);if(a)t.onColumnFilterFieldChange({source:a,value:a.value}),a.render(i),a.show();else{var s="".concat(e.filterType||"text","field");a=vd.append(Qn.assign({type:s,column:e,owner:t.grid,clearable:!0,name:e.field,value:o&&!o._filterBy&&t.buildFilterString(o),cls:t.filterFieldCls,inputCls:t.filterFieldInputCls,keyStrokeChangeDelay:t.keyStrokeFilterDelay,onChange:t.onColumnFilterFieldChange,onClear:t.onColumnFilterFieldChange,disabled:t.disabled,placeholder:t.compactMode?e.headerText:null},r.filterField),i)[0],t.setColumnFilterField(e,a)}i.classList.add(t.filterableColumnCls)}}},{key:"updateColumnFilterFields",value:function(){var e,t,n,r=this.grid,i=r.columns,o=r.store,a=By(i.visibleColumns);try{for(a.s();!(n=a.n()).done;){var s=n.value;(e=this.getColumnFilterField(s))&&((t=o.filters.getBy("property",s.field))?t._filterBy?e.value=t.value:e.value=this.buildFilterString(t):e.value="")}}catch(e){a.e(e)}finally{a.f()}}},{key:"getColumnFilterable",value:function(e){if(!e.isRoot&&!1!==e.filterable&&e.field)return"function"==typeof e.filterable&&(e.filterable={filterFn:e.filterable}),e.filterable}},{key:"destroyColumnFilterField",value:function(e){var t=this.getColumnFilterField(e);t&&(this.hideColumnFilterField(e,!0),t.destroy(),this.setColumnFilterField(e,void 0))}},{key:"hideColumnFilterField",value:function(e,t){var n=this,r=n.grid.store,i=e.element,o=n.getColumnFilterField(e);o&&(n.isDestroying||o.hide(),n.clearStoreFiltersOnHide&&e.field&&r.removeFilter(e.field,t),null==i||i.classList.remove(n.filterableColumnCls))}},{key:"getColumnFilterField",value:function(e){var t;return null===(t=this._columnFilters)||void 0===t?void 0:t[e.data.id]}},{key:"setColumnFilterField",value:function(e,t){this._columnFilters=this._columnFilters||{},this._columnFilters[e.data.id]=t}},{key:"parseFilterValue",value:function(e){if(Array.isArray(e))return{value:e};var t=String(e).match(this.filterParseRegExp);return{operator:t[1]||"*",value:t[2]}}},{key:"buildFilterString",value:function(e){return("*"===e.operator?"":e.operator)+e.value}},{key:"onStoreBeforeFilter",value:function(e){for(var t=this,n=e.filters,r=this.client.columns,i=function(e){var i,o=n.getAt(e),a=(o.columnOwned||t.prioritizeColumns)&&r.get(o.property);null!==(i=a.filterable)&&void 0!==i&&i.filterFn&&(a.$filter||(a.$filter=new zo({columnOwned:!0,property:o.property,filterBy:function(e){return a.filterable.filterFn({value:this.value,record:e,property:this.property})}})),a.$filter.value=o.value,n.splice(e,1,a.$filter))},o=0;o<n.count;o++)i(o)}},{key:"onStoreFilter",value:function(){!this.storeTrackingSuspended&&this.rendered&&this.updateColumnFilterFields()}},{key:"suspendStoreTracking",value:function(){this.storeTrackingSuspended++}},{key:"resumeStoreTracking",value:function(){this.storeTrackingSuspended--}},{key:"renderHeader",value:function(){this.hidden||this.renderFilterBar()}},{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(this.filterFieldInputSelector))switch(e.key){case"ArrowLeft":case"ArrowRight":e.handled=!0}}},{key:"onBeforeElementClick",value:function(e){if(e.event.target.closest(".".concat(this.filterFieldCls)))return!1}},{key:"onColumnFilterFieldChange",value:function(e){var t=e.source,n=e.value,r=this,i=r.grid.store;r.suspendStoreTracking(),null==n||""===n||Array.isArray(n)&&0===n.length?i.removeFilter(t.name):i.filter(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ly(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ly(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({columnOwned:!0,property:t.name},r.parseFilterValue(n))),r.resumeStoreTracking()}},{key:"populateHeaderMenu",value:function(e){var t=this;e.items.toggleFilterBar={text:this.hidden?"L{enableFilterBar}":"L{disableFilterBar}",localeClass:this,name:"toggleFilterBar",weight:120,icon:"b-fw-icon b-icon-filter",cls:"b-separator",onItem:function(){return t.toggleFilterBar()}}}}],[{key:"$name",get:function(){return"FilterBar"}},{key:"configurable",get:function(){return{prioritizeColumns:!1,keyStrokeFilterDelay:300,compactMode:!1,clearStoreFiltersOnHide:!0}}},{key:"properties",get:function(){return{filterFieldCls:"b-filter-bar-field",filterFieldInputCls:"b-filter-bar-field-input",filterableColumnCls:"b-filter-bar-enabled",filterFieldInputSelector:".b-filter-bar-field-input",filterableColumnSelector:".b-filter-bar-enabled",filterParseRegExp:/^\s*([<>=*])?(.*)$/,storeTrackingSuspended:0}}},{key:"pluginConfig",get:function(){return{before:["onElementKeyDown"],chain:["renderHeader","populateHeaderMenu","bindStore"]}}}]),n}(_i);function Ny(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return zy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zy(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function zy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Hy.featureClass="b-filter-bar",Hy._$name="FilterBar",ty.registerFeature(Hy);var Wy=function(e){Ye()(n,e);var t=Vy(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;e.features.tree||(r._thisIsAUsedExpression(e.features.groupSummary),t=r.processConfig(t),r.grid=e,r.rowManager=e.rowManager,tt()(Ze()(n.prototype),"construct",this).call(this,e,t),r.bindStore(e.store),r.rowManager.on({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1100,thisObj:r}))}},{key:"processConfig",value:function(e){return"string"==typeof e?{field:e,ascending:null}:e}},{key:"setConfig",value:function(e){null===e?this.store.clearGroupers():tt()(Ze()(n.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",group:"onStoreGroup",thisObj:this})}},{key:"updateRenderer",value:function(e){this.groupRenderer=e}},{key:"updateField",value:function(e){this.store.group({field:e,ascending:this.ascending,fn:this.groupSortFn})}},{key:"updateGroupSortFn",value:function(e){this.isConfiguring||this.store.group({field:this.field,ascending:this.ascending,fn:e})}},{key:"doDestroy",value:function(){tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this.store;if(e&&t.isGrouped){var r=t.sorters;r.unshift.apply(r,F()(t.groupers)),t.clearGroupers(),t.sort(r)}tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"store",get:function(){return this.grid.store}},{key:"toggleCollapse",value:function(e,t){this.internalToggleCollapse(e,t)}},{key:"internalToggleCollapse",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.store,o=i.getById(e),a=o.meta;void 0!==a.groupRowFor&&((t=void 0===t?!a.collapsed:t)?i.excludeGroupRecords(o):i.includeGroupRecords(o),a.collapsed=t,r.grid.trigger("toggleGroup",{groupRecord:o,collapse:t}),n||r.rowManager.renderFromRecord(o))}},{key:"collapseAll",value:function(){var e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((function(t){return e.internalToggleCollapse(t,!0,!0)})),e.grid.refreshRows(!0))}},{key:"expandAll",value:function(){var e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((function(t){return e.internalToggleCollapse(t,!1,!0)})),e.grid.refreshRows())}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,n=(e.record,t.grid.store.getById(t.id));t.forceInnerHTML=t.forceInnerHTML||n&&"groupRowFor"in n.meta}},{key:"renderCell",value:function(e){var t=this,n=e.cellElement,r=e.row,i=e.column,o=e.record.meta,a={"b-group-row":0,"b-grid-group-collapsed":0};if(!t.disabled&&t.store.isGrouped)if("groupRowFor"in o){if("action"===i.type)return;i.clearCell(n),a["b-grid-group-collapsed"]=o.collapsed,a["b-group-row"]=1,i===t.groupHeaderColumn&&n.classList.add("b-group-title"),t.buildGroupHeader(e)}else n.classList.remove("b-group-title");r.assignCls(a)}},{key:"buildGroupHeader",value:function(e){var t=this,n=e.record,r=e.cellElement,i=e.column,o=e.persist,a=t.grid,s=n.meta,l=s.childCount-(a.features.groupSummary?1:0),u=null,c=!0;if(o||i){var f=a.columns.get(s.groupField),d=e.isFirstColumn=i===t.groupHeaderColumn;null!=f&&f.groupRenderer?d&&(u=f.groupRenderer(Object.assign({},e,{groupRowFor:s.groupRowFor,groupRecords:n.groupChildren,groupColumn:f,count:l})),c=!1):t.groupRenderer&&(u=t.groupRenderer(Object.assign({},e,{groupRowFor:s.groupRowFor,groupRecords:n.groupChildren,groupColumn:f,count:l,isFirstColumn:d}))),d&&null==u&&c&&0===mi.getChildElementCount(r)&&(u=te.encodeHtml("".concat("__novalue__"===s.groupRowFor?"":s.groupRowFor," (").concat(l,")")))}else t.groupRenderer&&(u=t.groupRenderer(e));return"string"==typeof u?r.innerHTML=u:"object"===I()(u)&&du.sync({targetElement:r,domConfig:{onlyChildren:!0,children:Array.isArray(u)?u:[u]}}),mi.getChildElementCount(r)>0&&(r._hasHtml=!0),r.innerHTML}},{key:"groupHeaderColumn",get:function(){return this.grid.columns.visibleColumns.find((function(e){return!e.groupHeaderReserved}))}},{key:"renderHeader",value:function(e){var t=this.store,n=this.grid;if(t.isGrouped){var r,i=Ny(t.groupers);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=n.columns.get(o.field),s=a&&n.getHeaderElement(a.id);s&&(s.classList.add("b-group"),s.classList.add(o.ascending?"b-asc":"b-desc"))}}catch(e){i.e(e)}finally{i.f()}}}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this;!1!==t.groupable&&(n.groupAsc={text:"L{groupAscending}",localeClass:r,icon:"b-fw-icon b-icon-group-asc",name:"groupAsc",cls:"b-separator",weight:400,disabled:r.disabled,onItem:function(){return r.store.group(t.field,!0)}},n.groupDesc={text:"L{groupDescending}",localeClass:r,icon:"b-fw-icon b-icon-group-desc",name:"groupDesc",weight:410,disabled:r.disabled,onItem:function(){return r.store.group(t.field,!1)}}),r.store.isGrouped&&(n.groupRemove={text:"L{stopGrouping}",localeClass:r,icon:"b-fw-icon b-icon-clear",name:"groupRemove",cls:t.groupable?"":"b-separator",weight:420,disabled:r.disabled,onItem:function(){return r.store.clearGroupers()}})}},{key:"getColumnDragToolbarItems",value:function(e,t){var n,r=this,i=r.store;t.push({text:"L{groupAscendingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-group-asc",name:"groupAsc",cls:"b-separator",weight:110,disabled:r.disabled,onDrop:function(e){var t=e.column;return i.group(t.field,!0)}}),t.push({text:"L{groupDescendingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-group-desc",name:"groupDesc",weight:110,disabled:r.disabled,onDrop:function(e){var t=e.column;return i.group(t.field,!1)}});var o=(null===(n=i.groupers)||void 0===n?void 0:n.some((function(t){return t.field===e.field})))&&!r.disabled;return t.push({text:"L{stopGroupingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-clear",name:"groupRemove",disabled:!o,weight:110,onDrop:function(e){var t=e.column;return i.removeGrouper(t.field)}}),t}},{key:"onStoreGroup",value:function(e){var t=e.groupers,n=this.grid,r=n.element,i=r&&mi.children(r,".b-grid-header.b-group");if(r){var o,a=Ny(i);try{for(a.s();!(o=a.n()).done;){var s=o.value;mi.removeClasses(s,["b-group","b-asc","b-desc"])}}catch(e){a.e(e)}finally{a.f()}if(t){var l,u=Ny(t);try{for(u.s();!(l=u.n()).done;){var c=l.value,f=n.getHeaderElementByField(c.field);f&&mi.addClasses(f,["b-group",c.ascending?"b-asc":"b-desc"])}}catch(e){u.e(e)}finally{u.f()}}}}},{key:"onElementTouchStart",value:function(e){var t=this,n=e.target,r=mi.up(n,".b-grid-header"),i=r&&t.grid.getColumnFromElement(r);e.touches.length>1&&i&&!1!==i.groupable&&!t.disabled&&t.store.group(i.field)}},{key:"onElementClick",value:function(e){var t=this,n=t.store,r=e.target,i=mi.up(r,".b-group-row"),o=mi.up(r,".b-grid-header"),a=null==o?void 0:o.dataset.column;if(!(r.classList.contains("b-resizer")||t.disabled||r.classList.contains("b-action-item"))){if(o&&a){var s,l=null===(s=n.groupers)||void 0===s?void 0:s.find((function(e){return e.field===a}));if(l&&!e.shiftKey)return n.group(a,!l.ascending),!1;e.shiftKey&&!1!==t.grid.columns.get(a).groupable&&(e.altKey?n.removeGrouper(a):n.group(a))}return i?(t.internalToggleCollapse(ls.get(i).id),!1):void 0}}},{key:"onElementKeyDown",value:function(e){var t=this;!t.disabled&&t.store.isGrouped&&e.target===t.grid.focusElement&&" "===e.key&&t.grid.focusedCell&&(e.preventDefault(),t.internalToggleCollapse(t.grid.focusedCell.id))}}],[{key:"$name",get:function(){return"Group"}},{key:"configurable",get:function(){return{field:null,groupSortFn:null,renderer:null}}},{key:"pluginConfig",get:function(){return{assign:["collapseAll","expandAll"],chain:["renderHeader","populateHeaderMenu","getColumnDragToolbarItems","onElementTouchStart","onElementClick","onElementKeyDown","bindStore"]}}}]),n}(_i);function $y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Wy._$name="Group",ty.registerFeature(Wy,!0,["Grid","Scheduler"]);var Uy=function(e){return function(e){Ye()(n,e);var t=$y(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"generateHtml",value:function(e,t,n,r,i,o){var a=this.store,s=e.summaries||(e.sum?[{sum:e.sum,renderer:e.summaryRenderer}]:[]),l='<table class="'.concat(n,'">');return s.forEach((function(n){var r=n.sum,i=null;switch(!0===r&&(r="sum"),r){case"sum":case"add":i=a.sum(e.field,t);break;case"max":i=a.max(e.field,t);break;case"min":i=a.min(e.field,t);break;case"average":case"avg":i=a.average(e.field,t);break;case"count":i=t.length;break;case"countNotEmpty":i=t.reduce((function(t,n){return t+(null!=n[e.field]?1:0)}),0)}if("function"==typeof r&&(i=t.reduce(r,"seed"in n?n.seed:0)),null!==i){var o,s="b-grid-summary-value",u=n.label?'<td class="b-grid-summary-label">'.concat(n.label,"</td>"):"",c=n.renderer?n.renderer({config:n,sum:i}):i;null==c&&(c=""),o=String(c).includes("<td>")?c:u?"".concat(u,'<td class="').concat(s,'">').concat(c,"</td>"):'<td colspan="2" class="'.concat(s,'">').concat(c,"</td>"),l+="<tr>".concat(o,"</tr>")}})),l+"</table>"}}],[{key:"$name",get:function(){return"SummaryFormatter"}}]),n}(e||$e)};function Gy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Yy=function(e){Ye()(n,e);var t=Gy(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){if(this.grid=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t),!e.features.group)throw new Error("Requires Group feature to work, please enable");this.bindStore(e.store),e.rowManager.on({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1e3,thisObj:this})}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",update:"onStoreUpdate",prio:1,thisObj:this})}},{key:"store",get:function(){return this.grid.store}},{key:"doDisable",value:function(e){this.store.useGroupFooters=!e,this.isConfiguring||this.store.group(),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,n=e.record;t.isGroupFooter&&!("groupFooterFor"in n.meta)?(t.isGroupFooter=!1,t.forceInnerHTML=!0):t.isGroupHeader&&!n.meta.collapsed&&t.eachElement(this.removeSummaryElements)}},{key:"removeSummaryElements",value:function(e){}},{key:"renderCell",value:function(e){var t=e.column,n=e.cellElement,r=e.row,i=e.record,o=e.size,a=e.isFirstColumn,s=this,l=i.meta,u="groupRowFor"in l,c="groupFooterFor"in l,f={"b-group-footer":0,"b-header-summary":0};if(s.store.isGrouped&&(c||s.collapseToHeader&&u&&l.collapsed&&!a)){var d=u?i:l.groupRecord;r.isGroupFooter=c,r.isGroupHeader=u,c?f["b-group-footer"]=1:f["b-header-summary"]=1;var h=s.updateSummaryHtml(n,t,d),v="number"==typeof h?h:h.count;v>1&&(o.height=s.grid.rowHeight+(i.meta.collapsed?0:v*s.grid.rowHeight*.1)),h.height&&(o.height+=h.height)}r.assignCls(f)}},{key:"updateSummaryHtml",value:function(e,t,n){var r=n.groupChildren.slice();r.pop();var i=this.generateHtml(t,r,"b-grid-group-summary",n,n.meta.groupField,n.meta.groupRowFor);return e.children.length?mi.sync(i,e.firstElementChild):e.innerHTML=i,t.summaries?t.summaries.length:t.sum?1:0}},{key:"onStoreUpdate",value:function(e){var t=this,n=e.source,r=e.changes;if(!this.disabled&&n.isGrouped){if(r&&n.groupers.find((function(e){return e.field in r})))return;Object.keys(r).some((function(e){var n=t.grid.columns.get(e);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))}))&&(this.grid.forceFullRefresh=!0)}}},{key:"refresh",value:function(){var e=this;this.grid.columns.visibleColumns.forEach((function(t){e.hasSummary(t)&&e.grid.refreshColumn(t)}))}},{key:"hasSummary",value:function(e){return e.sum||e.summaries}}],[{key:"$name",get:function(){return"GroupSummary"}},{key:"configurable",get:function(){return{collapseToHeader:null}}},{key:"pluginConfig",get:function(){return{chain:["bindStore"]}}}]),n}(Uy(_i));function qy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Yy.featureClass="b-group-summary",Yy._$name="GroupSummary",ty.registerFeature(Yy);var Ky=function(e){Ye()(n,e);var t=qy(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(".b-grid-header.b-depth-0"))switch(e.key){case" ":this.internalShowContextMenu(this.createContextMenuEventForElement(e.target))}}},{key:"shouldShowMenu",value:function(e){var t=e.column;return t&&!1!==t.enableHeaderContextMenu&&(this._showForTimeAxis||t!==this.client.timeAxisColumn)}},{key:"showContextMenu",value:function(e){var t=e.column;tt()(Ze()(n.prototype),"showContextMenu",this).apply(this,arguments),t===this.client.timeAxisColumn&&this.menu&&(this.menu.scrollAction="realign")}},{key:"getDataFromEvent",value:function(e){return Qn.assign(tt()(Ze()(n.prototype),"getDataFromEvent",this).call(this,e),this.client.getHeaderDataFromEvent(e))}},{key:"populateHeaderMenu",value:function(e){var t=e.items,n=e.column;return null!=n&&n.headerMenuItems&&(Array.isArray(n.headerMenuItems)&&z.a.deprecate("Grid","5.0.0","`headerMenuItems` column config specified as an array is deprecated, need to specify the config as a named object. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."),Qn.merge(t,n.headerMenuItems)),t}}],[{key:"$name",get:function(){return"HeaderMenu"}},{key:"defaultConfig",get:function(){return{processItems:null,items:null,type:"header",_showForTimeAxis:!1}}},{key:"pluginConfig",get:function(){var e=tt()(Ze()(n),"pluginConfig",this);return e.chain.push("populateHeaderMenu"),e}}]),n}(Bf);Ky.featureClass="",Ky._$name="HeaderMenu",ty.registerFeature(Ky,!0);n(181);function Xy(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Zy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zy(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Zy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Qy=function(e){Ye()(n,e);var t=Jy(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.grid=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDisable",value:function(e){e&&this.clear(),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"store",get:function(){return this.grid.store}},{key:"showQuickFind",value:function(){var e=this,t=e.grid.getHeaderElement(e.columnId);if(t){if(!e.headerField){var n=mi.createElement({tag:"div",className:"b-quick-hit-header",children:[{tag:"div",className:"b-quick-hit-field"},{tag:"div",className:"b-quick-hit-badge"}]},!0),r=N()(n,3),i=r[0],o=r[1],a=r[2];"header"===e.mode?t.appendChild(i):(i.className+=" b-quick-hit-mode-grid",e.grid.element.appendChild(i)),e.headerField={header:i,field:o,badge:a,colHeader:t}}e.headerField.field.innerHTML=e.find,e.headerField.badge.innerHTML=e.found.length,t.classList.add("b-quick-find-header"),e.renderListenerInitialized||(e.grid.rowManager.on({rendercell:e.renderCell,thisObj:e}),e.renderListenerInitialized=!0)}}},{key:"hideQuickFind",value:function(){var e,t=this,n=t.grid,r=t.headerField,i=Xy(t.prevFound||t.found);try{for(i.s();!(e=i.n()).done;){var o=e.value,a=n.getRowById(o.id);if(a){a.forceInnerHTML=!0;var s=a.getCell(t.columnId);s._content=null,a.renderCell({cellElement:s,record:o.data}),a.forceInnerHTML=!1}}}catch(e){i.e(e)}finally{i.f()}r&&(r.header.parentNode.removeChild(r.header),r.colHeader.classList.remove("b-quick-find-header"),t.headerField=null),t.renderListenerInitialized&&(n.rowManager.un({rendercell:t.renderCell},t),t.renderListenerInitialized=!1),n.trigger("hideQuickFind")}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.columnId,n=this,r=n.grid,i=r.columns.getById(t)||r.columns.get(t),o=n.store.findByField(i.field,e),a=1;Object.assign(n,{foundMap:{},prevFound:n.found,found:o,find:e,columnId:i.id}),e?n.showQuickFind():n.hideQuickFind();var s,l=Xy(mi.children(r.element,".b-quick-hit"));try{for(l.s();!(s=l.n()).done;){var u=s.value;u.classList.remove("b-quick-hit"),u.classList.remove("b-quick-hit-cell");var c=ls.get(u).row;u._content=u.lastDomConfig=null,u.innerHTML="",c.renderCell({cellElement:u})}}catch(e){l.e(e)}finally{l.f()}if(o){o.length>0&&n.gotoClosestHit(r.focusedCell,o);var f,d=Xy(o);try{for(d.s();!(f=d.n()).done;){var h=f.value;n.foundMap[h.id]=a++;var v=r.getRowById(h.data.id);if(null==v||v.renderCell({cellElement:v.getCell(i.id)}),a>1e3)break}}catch(e){d.e(e)}finally{d.f()}r.trigger("quickFind",{find:e,found:o})}}},{key:"clear",value:function(){var e;null!==(e=this.found)&&void 0!==e&&e.length&&this.search("")}},{key:"foundCount",get:function(){var e,t;return null!==(e=null===(t=this.found)||void 0===t?void 0:t.length)&&void 0!==e?e:0}},{key:"gotoHit",value:function(e){var t=this.found[e];return t&&this.grid.focusCell({columnId:this.columnId,id:t.id}),!!t}},{key:"gotoClosestHit",value:function(e,t){var n=e?this.grid.store.indexOf(e.id):0,r=t.slice().sort((function(e,t){return Math.abs(e.index-n)-Math.abs(t.index-n)}));this.gotoHit(t.indexOf(r[0]))}},{key:"gotoFirstHit",value:function(){this.gotoHit(0)}},{key:"gotoLastHit",value:function(){this.gotoHit(this.found.length-1)}},{key:"gotoNextHit",value:function(){var e,t=this,n=t.grid,r=n._focusedCell?n._focusedCell.id:null===(e=n.lastFocusedCell)||void 0===e?void 0:e.id,i=n.store.indexOf(r)||0,o=t.found.find((function(e){return e.index>i}));o?n.focusCell({columnId:t.columnId,id:o.id}):t.gotoFirstHit()}},{key:"gotoPrevHit",value:function(){var e,t,n=this,r=n.grid,i=n.found,o=r._focusedCell?r._focusedCell.id:null===(e=r.lastFocusedCell)||void 0===e?void 0:e.id,a=r.store.indexOf(o)||0;if(i.length){for(var s=i.length-1;s--;s>=0)if(i[s].index<a){t=i[s];break}t?r.focusCell({columnId:n.columnId,id:t.id}):n.gotoLastHit()}}},{key:"renderCell",value:function(e){var t,n=this,r=e.cellElement,i=n.columnId===e.column.id&&(null===(t=n.foundMap)||void 0===t?void 0:t[e.record.id]);if(i){var o=e.column.htmlEncode||e.column.shouldHtmlEncode;if(r.classList.add("b-quick-hit"),o){var a,s=mi.down(r,".b-grid-cell-value,.b-tree-cell-value")||r,l=te.encodeHtml(s.innerText),u=null===(a=l)||void 0===a?void 0:a.toLowerCase().indexOf(n.find.toLowerCase());if(u>-1){var c=u+n.find.length,f=l.slice(u,c),d="";" "===l[u-1]&&(d="&nbsp;"),l=l.slice(0,u)+'<span class="b-quick-hit-text">'.concat(d).concat(f,"</span>")+l.slice(c),s.innerHTML=l+'<div class="b-quick-hit-cell-badge">'.concat(i,"</div>")}else r.classList.add("b-quick-hit-cell")}else r.classList.add("b-quick-hit-cell")}}},{key:"onElementKeyDown",value:function(e){var t=this,n=t.grid.features.filter;t.disabled||mi.up(e.target,pe.a.isIE11?".b-widget:not(.b-grid-subgrid):not(.b-grid)":".b-widget:not(.b-grid)")||t.find.length>0&&("Backspace"===e.key?(e.preventDefault(),t.find=t.find.substr(0,t.find.length-1),t.search(t.find)):"Escape"===e.key?(e.preventDefault(),t.find="",t.search(t.find)):"F3"===e.key||"g"===e.key.toLowerCase()&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),e.shiftKey?t.gotoPrevHit():t.gotoNextHit()):n&&t.columnId&&t.foundCount&&e.ctrlKey&&e.shiftKey&&"F"===e.key&&(t.clear(),n.showFilterEditor(t.grid.columns.getById(t.columnId),t.find)))}},{key:"onElementKeyPress",value:function(e){var t=this,n=t.grid;if(!t.disabled&&!mi.up(e.target,pe.a.isIE11?".b-widget:not(.b-grid-subgrid):not(.b-grid)":".b-widget:not(.b-grid)")&&"Enter"!==e.key&&n._focusedCell){var r,i=n.columns.getById(n._focusedCell.columnId);if(i&&!1!==i.searchable)t.columnId=n._focusedCell.columnId,1===(null===(r=e.key)||void 0===r?void 0:r.length)&&(t.find+=e.key,t.search(t.find))}}},{key:"onCellNavigate",value:function(e,t,n){var r=this;!(r.prevFound||r.found)||n&&n.columnId===r.columnId||r.clear()}}],[{key:"$name",get:function(){return"QuickFind"}},{key:"defaultConfig",get:function(){return{mode:"header",find:""}}},{key:"pluginConfig",get:function(){return{chain:["onElementKeyDown","onElementKeyPress","onCellNavigate"]}}}]),n}(_i);function em(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Qy._$name="QuickFind",ty.registerFeature(Qy);var tm=function(e){Ye()(n,e);var t=em(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.grid=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"onElementDblClick",value:function(e){var t=this,n=t.grid,r=mi.up(e.target,".b-grid-splitter-collapsed");if(r&&!t.expanding){t.expanding=!0;var i=r.dataset.region,o=n.getSubGrid(i);o.collapsed||(i=n.getLastRegions()[1],o=n.getSubGrid(i)),o.expand().then((function(){return t.expanding=!1}))}}},{key:"startMove",value:function(e,t){var n=this.grid,r=e.dataset.region,i=n.element,o=n.regions[n.regions.indexOf(r)+1],a=n.getSubGrid(o),s=n.getSubGrid(r),l=s,u=1;if(null!=l.flex&&null==a.flex&&(l=a,u=-1),!e.classList.contains("b-grid-splitter-collapsed")){var c=l.element.offsetWidth+a.element.offsetWidth;this.dragContext={element:e,headerEl:l.header.element,subGridEl:l.element,subGrid:l,splitterSubGrid:s,originalWidth:l.element.offsetWidth,originalX:t,minWidth:l.minWidth||0,maxWidth:Math.min(c,l.maxWidth||c),flip:u},i.classList.add("b-moving-splitter"),s.toggleSplitterCls("b-moving")}}},{key:"endMove",value:function(){var e=this.dragContext;e&&(this.grid.element.classList.remove("b-moving-splitter"),e.splitterSubGrid.toggleSplitterCls("b-moving",!1),this.dragContext=null)}},{key:"onCollapseClick",value:function(e,t){var n=this.grid,r=t.dataset.region,i=n.getLastRegions();if(i[0]===r){var o=n.getSubGrid(i[1]);if(o.collapsed)return void o.expand()}e.collapse()}},{key:"onExpandClick",value:function(e,t){var n=this.grid,r=t.dataset.region,i=n.getLastRegions();if(i[0]===r&&!e.collapsed)return void n.getSubGrid(i[1]).collapse();e.expand()}},{key:"updateMove",value:function(e){var t=this.dragContext;if(t){var n=e-t.originalX,r=Math.min(t.maxWidth,t.originalWidth+n*t.flip);t.subGrid.width=Math.max(r,t.minWidth)}}},{key:"onElementTouchStart",value:function(e){var t=e.target.closest(".b-grid-splitter");t&&this.startMove(t,e.touches[0].clientX)}},{key:"onElementTouchMove",value:function(e){this.dragContext&&(this.updateMove(e.touches[0].clientX),e.preventDefault())}},{key:"onElementTouchEnd",value:function(e){this.dragContext&&(this.endMove(),e.preventDefault())}},{key:"onElementMouseDown",value:function(e){var t=this,n=e.target,r=n.closest(":not(.b-row-reordering):not(.b-dragging-event):not(.b-dragging-task):not(.b-dragging-header):not(.b-dragselecting) .b-grid-splitter"),i=r&&t.grid.getSubGrid(r.dataset.region);0===e.button&&(n.classList.contains("b-grid-splitter")||n.classList.contains("b-grid-splitter-inner")?t.startMove(r,e.clientX):n.classList.contains("b-icon-collapse-gridregion")?t.onCollapseClick(i,r):n.classList.contains("b-icon-expand-gridregion")&&t.onExpandClick(i,r))}},{key:"onElementMouseMove",value:function(e){this.dragContext&&(this.updateMove(e.clientX),e.preventDefault())}},{key:"onElementMouseUp",value:function(e){this.dragContext&&(this.endMove(),e.preventDefault())}},{key:"onSubGridCollapse",value:function(e){var t=this.grid.resolveSplitter(e);this.grid.getLastRegions()[1]===e.region&&t.classList.add("b-grid-splitter-allow-collapse")}},{key:"onSubGridExpand",value:function(e){this.grid.resolveSplitter(e).classList.remove("b-grid-splitter-allow-collapse")}},{key:"render",value:function(){var e=this.grid,t=e.regions,n=e.subGrids;t.length>2&&(n[t[0]].splitterElement.classList.add("b-left-only"),n[t[1]].splitterElement.classList.add("b-right-only"))}}],[{key:"$name",get:function(){return"RegionResize"}},{key:"pluginConfig",get:function(){return{chain:["onElementTouchStart","onElementTouchMove","onElementTouchEnd","onElementMouseDown","onElementMouseMove","onElementDblClick","onElementMouseUp","onSubGridCollapse","onSubGridExpand","render"]}}}]),n}(_i);function nm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}tm.featureClass="b-split",tm._$name="RegionResize",ty.registerFeature(tm);var rm=function(e){Ye()(n,e);var t=nm(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),e.rowManager.on({beforeRenderRow:"onBeforeRenderRow",thisObj:this}),this.grid=e}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,n=e.record;t.cls["b-cut-row"]=n.meta.isCut}},{key:"onElementKeyDown",value:function(e){if(e.ctrlKey)switch(e.key.toLowerCase()){case"c":this.onCtrlCKey();break;case"x":this.onCtrlXKey();break;case"v":this.onCtrlVKey()}}},{key:"copyRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.client;n.readOnly||(t._isCut=e,t.recordsFromClipboard=F()(n.selectedRecords),n.store.forEach((function(e){e.meta.isCut=t._isCut&&t.recordsFromClipboard.includes(e)})),n.refreshRows())}},{key:"onCtrlCKey",value:function(){this.copyRows()}},{key:"onCtrlXKey",value:function(){this.copyRows(!0)}},{key:"onCtrlVKey",value:function(){this.pasteRows()}},{key:"pasteRows",value:function(e){var t=this,n=t.recordsFromClipboard,r=e||t.client.selectedRecord,i=[],o=[];n.length&&(n.forEach((function(e){var n={};t._isCut?(i.push(e),e.meta.isCut=!1):(n.name="".concat(e.name," - copy"),o.push(e.copy(n)))})),o.length?t.doCloneRecords(r,o):i.length&&t.doMoveRecords(r,i,n),t._isCut&&(t._isCut=!1,t.recordsFromClipboard=[]))}},{key:"doCloneRecords",value:function(e,t){var n=this.client.store,r=n.indexOf(e);return n.tree?e.parent.insertChild(t,e):n.insert(r,t)}},{key:"doMoveRecords",value:function(e,t){var n=this.client.store;if(n.tree)return e.parent.insertChild(t,e);n.move(t,e)}},{key:"populateCellMenu",value:function(e){var t=e.record,n=e.items,r=this;r.client.readOnly||!t||t.isSpecialRow||(n.copyRow={text:r.copyRecordText,localeClass:r,icon:"b-icon b-icon-copy",name:"copyRow",weight:10,onItem:function(){return r.copyRows()}},n.cutRow={text:r.cutRecordText,localeClass:r,icon:"b-icon b-icon-cut",name:"cutRow",weight:10,onItem:function(){return r.copyRows(!0)}},r.recordsFromClipboard.length&&(n.pasteRow={text:r.pasteRecordText,localeClass:r,icon:"b-icon b-icon-paste",name:"pasteRow",weight:10,onItem:function(){return r.pasteRows(t)}}))}}],[{key:"$name",get:function(){return"RowCopyPaste"}},{key:"type",get:function(){return"rowCopyPaste"}},{key:"pluginConfig",get:function(){return{assign:["copyRows","pasteRows"],chain:["onElementKeyDown","populateCellMenu"]}}},{key:"properties",get:function(){return{recordsFromClipboard:[]}}},{key:"configurable",get:function(){return{copyRecordText:"L{copyRecord}",cutRecordText:"L{cutRecord}",pasteRecordText:"L{pasteRecord}",localizableProperties:["copyRecordText","cutRecordText","pasteRecordText"]}}}]),n}(_i);function im(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}rm.featureClass="b-row-copypaste",rm._$name="RowCopyPaste",ty.registerFeature(rm,!0,"Grid"),ty.registerFeature(rm,!1,"Gantt"),ty.registerFeature(rm,!1,"SchedulerPro"),ty.registerFeature(rm,!1,"ResourceHistogram");var om=function(e){Ye()(i,e);var t,n,r=im(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"construct",value:function(e,t){this.grid=e,tt()(Ze()(i.prototype),"construct",this).apply(this,arguments)}},{key:"doDestroy",value:function(){var e;null===(e=this.dragHelper)||void 0===e||e.destroy(),tt()(Ze()(i.prototype),"doDestroy",this).call(this)}},{key:"init",value:function(){var e=this,t=e.grid;e.dragHelper=new Xf({name:"rowReorder",mode:"translateXY",cloneTarget:!0,dragThreshold:10,targetSelector:".b-grid-row",lockX:!0,transitionDuration:t.transitionDuration,scrollManager:t.scrollManager,dragWithin:t.element,outerElement:t.verticalScroller,monitoringConfig:{scrollables:[{element:t.scrollable.element,direction:"vertical"}]},ignoreSamePositionDrop:!1,createProxy:function(e){var n=e.cloneNode(!0),r=document.createElement("div");if(n.removeAttribute("id"),n.style.transform="",r.appendChild(n),t.selectedRecords.length>1){var i=n.cloneNode(!0);i.classList.add("b-row-dragging-multiple"),r.appendChild(i)}return mi.removeClsGlobally(r,"b-selected","b-hover","b-focused"),r},listeners:{beforedragstart:e.onBeforeDragStart,dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,reset:e.onReset,prio:1e4,thisObj:e}}),e.dropIndicator=mi.createElement({parent:t.bodyContainer,className:"b-row-drop-indicator"}),e.relayEvents(e.dragHelper,["beforeDragStart","dragStart","drag","abort"],"gridRow")}},{key:"onBeforeDragStart",value:function(e){var t=e.context,n=this.grid,r=n.regions[0],i=n.subGrids[r].element;if(this.disabled||n.readOnly||!i.contains(t.element))return!1;var o=t.records=n.selectedRecords.slice().sort((function(e,t){return n.store.indexOf(e)-n.store.indexOf(t)}));return t.startRecord=n.getRecordFromElement(t.element),t.originalRowTop=n.rowManager.getRowFor(t.startRecord).top,t.record=t.startRecord,o.length>0&&!o.some((function(e){return e.isSpecialRow}))}},{key:"onDragStart",value:function(e){var t,n,r,i=e.context,o=this,a=o.grid.features,s=a.cellEdit,l=a.contextMenu,u=a.cellMenu,c=a.headerMenu;s&&(o.cellEditDisabledState=s.disabled,s.disabled=!0),null==l||null===(t=l.hideContextMenu)||void 0===t||t.call(l,!1),null==u||null===(n=u.hideContextMenu)||void 0===n||n.call(u,!1),null==c||null===(r=c.hideContextMenu)||void 0===r||r.call(c,!1),o.grid.element.classList.add("b-row-reordering");var f=i.element.querySelector(".b-focused");null==f||f.classList.remove("b-focused"),mi.removeClasses(i.element.firstElementChild,["b-selected","b-hover"])}},{key:"onDrag",value:function(e){var t=e.context,n=e.event,r=this,i=r.grid,o=i.store,a=i.rowManager;if(r.dragHelper.dragWithin.contains(n.target)){var s,l,u,c,f=t.valid,d=i.rowManager.getRowAt(n.clientY);if(d){var h=d.top+i._bodyRectangle.y-i.scrollable.y+d.height/2;l=d.dataIndex,s=o.getAt(l),u=n.clientY>h}else n.clientY<i._bodyRectangle.y?(l=0,s=o.first,u=!1):(l=o.count-1,s=o.last,u=!0),d=i.rowManager.getRow(l);if(s!==r.overRecord||r.after!==u){if(r.overRecord=s,r.after=u,s===t.startRecord&&(f=!1),o.tree){if(c=u?s.nextSibling:s,t.records.some((function(e){return e.contains(s)}))&&(f=!1),t.parent){var v=a.getRowById(t.parent);null==v||v.removeCls("b-row-reordering-target-parent")}if(t.parent=s.parent,!t.parent.isRoot){var p=a.getRowById(t.parent);null==p||p.addCls("b-row-reordering-target-parent")}r.clearTimeout(r.hoverTimer),s&&s.isParent&&!s.isExpanded(o)&&(r.hoverTimer=r.setTimeout((function(){return i.expand(s)}),r.hoverExpandTimeout))}else c=u?o.getAt(l+1):s;mi.setTranslateY(r.dropIndicator,d.top+(u?d.height:0)),t.insertBefore=c,t.valid=r.reorderValid=f}else t.valid=r.reorderValid}else t.valid=!1}},{key:"onDrop",value:(n=Pt()(At.a.mark((function e(t){var n,r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,(r=t.context).valid=r.valid&&n.reorderValid,!r.valid){e.next=14;break}return r.asyncCleanup=r.async=!0,e.next=6,n.trigger("gridRowBeforeDropFinalize",t);case 6:return!1===e.sent&&(r.valid=!1),r.valid,r.element.classList.add("b-dropping"),e.next=12,Tu.waitForTransitionEnd({element:r.element.firstElementChild,property:"transform",thisObj:n.client});case 12:return e.next=14,n.finalizeReorder(r);case 14:n.clearTimeout(n.hoverTimer),n.trigger("gridRowDrop",t);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"finalizeReorder",value:(t=Pt()(At.a.mark((function e(t){var n,r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.grid,r=n.store,i=t.records,t.valid=t.valid&&!i.some((function(e){return!r.includes(e)})),!t.valid){e.next=15;break}if(!r.tree){e.next=13;break}return i=i.filter((function(e){return!e.parent||!i.includes(e.parent)})),e.next=8,t.parent.tryInsertChild(i,t.insertBefore);case 8:o=e.sent,n.rowManager.forEach((function(e){return e.removeCls("b-row-reordering-target-parent")})),t.valid=!1!==o,e.next=14;break;case 13:r.move(i,t.insertBefore);case 14:r.clearSorters();case 15:t.finalize(t.valid),n.element.classList.remove("b-row-reordering");case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onReset",value:function(){var e=this,t=e.grid.features.cellEdit;e.grid.element.classList.remove("b-row-reordering"),t&&(t.disabled=e.cellEditDisabledState),mi.removeClsGlobally(e.grid.element,"b-row-reordering-target-parent")}},{key:"onPaint",value:function(){this.init()}}],[{key:"$name",get:function(){return"RowReorder"}},{key:"defaultConfig",get:function(){return{hoverExpandTimeout:1e3}}},{key:"pluginConfig",get:function(){return{after:["onPaint"]}}}]),i}(el(_i));function am(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return sm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sm(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function sm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}om.featureClass="",om._$name="RowReorder",ty.registerFeature(om,!1),ty.registerFeature(om,!0,"Gantt");var um=function(e){Ye()(n,e);var t=lm(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),Object.assign(this,{grid:e,find:"",hitEls:[]})}},{key:"doDestroy",value:function(){this.clear(!0),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e&&this.clear(),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"store",get:function(){return this.grid.store}},{key:"search",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;if(!e)return r.clear();if((n||e!==r.find)&&!r.disabled){var i=r.grid,o=r.store,a=i.columns.visibleColumns.filter((function(e){return!1!==e.searchable})),s=a.map((function(e){return e.field})),l=o.search(e,s),u=1;if(Object.assign(r,{foundMap:{},prevFound:r.found,found:l,find:e}),r.clearHits(),l){r.hitColumns.forEach((function(e){e.disableHtmlEncode=!1})),r.hitColumns.clear();var c,f,d=am(l);try{for(d.s();!(c=d.n()).done;){var h=c.value;r.foundMap[h.field+"-"+h.id]=u++;var v=i.columns.get(h.field);if(v&&!r.hitColumns.has(v)&&(v.disableHtmlEncode=!0,r.hitColumns.add(v)),u>r.limit)break}}catch(e){d.e(e)}finally{d.f()}if(!r.listenersInitialized)i.rowManager.on({name:"renderCell",renderCell:"renderCell",thisObj:r}),o.on((f={name:"storeRefresh"},Qe()(f,"refresh".concat(i.asyncEventSuffix),"onStoreRefresh"),Qe()(f,"thisObj",r),f)),r.listenersInitialized=!0;return i.refreshRows(),i.trigger("search",{grid:i,find:e,found:l}),t&&!r.isHitFocused&&r.gotoNextHit(!0),l}}}},{key:"clearHits",value:function(){var e,t=am(mi.children(this.grid.element,"."+this.hitCls));try{for(t.s();!(e=t.n()).done;){var n=e.value;n.classList.remove(this.hitCls),n.classList.remove(this.hitCellCls);var r=ls.get(n).row;r.forceInnerHTML=!0,r.renderCell({cellElement:n}),r.forceInnerHTML=!1}}catch(e){t.e(e)}finally{t.f()}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.grid;t.foundMap&&delete t.foundMap,delete t.find,t.clearHits(),t.listenersInitialized&&(this.detachListeners("renderCell"),this.detachListeners("storeRefresh"),t.listenersInitialized=!1),e||n.trigger("clearSearch",{grid:n})}},{key:"foundCount",get:function(){var e,t;return null!==(e=null===(t=this.found)||void 0===t?void 0:t.length)&&void 0!==e?e:0}},{key:"isHitFocused",get:function(){var e=this.grid,t=e.focusedCell?e.store.indexOf(e.focusedCell.id):-1,n=e.focusedCell?e.columns.getById(e.focusedCell.columnId):null;return-1!==t&&this.found.some((function(e){return e.index===t&&n&&e.field===n.field}))}},{key:"gotoNextHit",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this;if(null!==(e=n.found)&&void 0!==e&&e.length){var r=n.grid,i=r.focusedCell||r.lastFocusedCell,o=i&&!t?r.store.indexOf(i.id):-1,a=n.found.findIndex((function(e){return e.index>o}));-1!==a&&n.gotoHit(a)}}},{key:"gotoPrevHit",value:function(){var e,t=this;if(null!==(e=t.found)&&void 0!==e&&e.length)for(var n=t.grid,r=t.found,i=n.focusedCell||n.lastFocusedCell,o=i?n.store.indexOf(i.id):0,a=r.length-1;a--;a>=0){if(r[a].index<o){t.gotoHit(a);break}}}},{key:"gotoHit",value:function(e){var t=this.grid,n=this.found[e];return n&&t.focusCell({field:n.field,id:n.id}),Boolean(n)}},{key:"gotoFirstHit",value:function(){this.gotoHit(0)}},{key:"gotoLastHit",value:function(){this.gotoHit(this.found.length-1)}},{key:"renderCell",value:function(e){var t,n=e.cellElement,r=e.column,i=e.record,o=e.value,a=this,s=null===(t=a.foundMap)||void 0===t?void 0:t[r.field+"-"+i.id];if(s){n.classList.add(a.hitCls);var l=n.innerHTML,u=mi.down(n,".b-grid-cell-value")||n,c=String(a.find).toLowerCase();if(String(o).toLowerCase()===c)u.innerHTML='<span class="'.concat(a.hitTextCls,'">').concat(l,'</span><div class="').concat(a.hitCellBadgeCls,'">').concat(s,"</div>");else{var f=null==l?void 0:l.toLowerCase().indexOf(c);if(l&&f>-1){var d=f+c.length,h=l.slice(f,d);u.innerHTML="".concat(l.slice(0,f),'<span class="').concat(a.hitTextCls,'">').concat(h,"</span>").concat(l.slice(d),'<div class="').concat(a.hitCellBadgeCls,'">').concat(s,"</div>")}else n.classList.add(a.hitCellCls)}a.hitEls.push(n)}}},{key:"populateCellMenu",value:function(e){var t=e.column,n=e.record,r=e.items,i=this;t.searchable&&(r.search={text:"L{searchForValue}",localeClass:i,icon:"b-fw-icon b-icon-search",cls:"b-separator",name:"search",weight:200,disabled:i.disabled,onItem:function(){var e=window.getSelection().toString();e||(e=n[t.field]),i.search(e)}})}},{key:"onElementKeyDown",value:function(e){var t=this;t.find&&""!==t.find&&("F3"===e.key||"g"===e.key.toLowerCase()&&(e.ctrlKey||e.metaKey))&&(e.preventDefault(),e.shiftKey?t.gotoPrevHit():t.gotoNextHit())}},{key:"onStoreRefresh",value:function(){this.search(this.find,!1,!0)}}],[{key:"$name",get:function(){return"Search"}},{key:"configurable",get:function(){return{limit:1e3}}},{key:"properties",get:function(){return{hitCls:"b-search-hit",hitCellCls:"b-search-hit-cell",hitCellBadgeCls:"b-search-hit-cell-badge",hitTextCls:"b-search-hit-text",hitColumns:new Set}}},{key:"pluginConfig",get:function(){return{chain:["populateCellMenu","onElementKeyDown"]}}}]),n}(_i);function cm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cm(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dm(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return hm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hm(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}um.featureClass="b-search",um._$name="Search",ty.registerFeature(um);var pm=function(e){Ye()(n,e);var t=vm(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){t=this.processConfig(t),this.grid=e,this.bindStore(e.store),tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"processConfig",value:function(e){return"string"==typeof e||Array.isArray(e)?{field:e,ascending:null}:e}},{key:"setConfig",value:function(e){tt()(Ze()(n.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",beforeSort:"onStoreBeforeSort",sort:"syncHeaderSortState",thisObj:this})}},{key:"field",set:function(e){var t=this.grid.columns.get(e);t&&"object"===I()(t.sortable)&&(t.sortable.field=t.sortable.property||e,e=t.sortable),this.store.sort(e,this.ascending)}},{key:"store",get:function(){return this.grid.store}},{key:"syncHeaderSortState",value:function(){var e=this,t=e.grid;if(!t.hideHeaders&&t.isPainted){var n,r,i=e.store.sorters,o=i.length,a=new xr,s=dm(t.columns.visibleColumns);try{var l=function(){var t,s=r.value,l=s.element,u=null===(t=s.textWrapper)||void 0===t?void 0:t.dataset;(null==u?void 0:u.sortIndex)&&delete u.sortIndex,a.value=l.classList,!1!==s.sortable?(a.add(e.sortableCls),(n=i.find((function(e){return e.field===s.field||e.sortFn&&e.sortFn===s.sortable.sortFn})))?(o>1&&u&&(u.sortIndex=i.indexOf(n)+1),a.add(e.sortedCls),n.ascending?(a.add(e.sortedAscCls),a.remove(e.sortedDescCls)):(a.add(e.sortedDescCls),a.remove(e.sortedAscCls))):(a.remove(e.sortedCls),a["b-group"]||(a.remove(e.sortedAscCls),a.remove(e.sortedDescCls)))):a.remove(e.sortableCls),mi.syncClassList(l,a)};for(s.s();!(r=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}}}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this,i=r.store,o=fm(fm({},t.sortable),{},{field:t.field,columnOwned:!0});if(!1!==t.sortable&&(n.sortAsc={text:"L{sortAscending}",localeClass:r,icon:"b-fw-icon b-icon-sort-asc",name:"sortAsc",cls:"b-separator",weight:300,disabled:r.disabled,onItem:function(){return i.sort(o,!0)}},n.sortDesc={text:"L{sortDescending}",localeClass:r,icon:"b-fw-icon b-icon-sort-desc",name:"sortDesc",weight:310,disabled:r.disabled,onItem:function(){return i.sort(o,!1)}},r.multiSort&&r.grid.columns.records.some((function(e){return e.sortable})))){var a=i.sorters.find((function(e){return e.field===t.field||t.sortable.sortFn&&t.sortable.sortFn===e.sortFn}));n.multiSort={text:"L{multiSort}",localeClass:r,icon:"b-fw-icon b-icon-sort",name:"multiSort",weight:320,disabled:r.disabled,menu:{addSortAsc:{text:a?"L{toggleSortAscending}":"L{addSortAscending}",localeClass:r,icon:"b-fw-icon b-icon-sort-asc",name:"addSortAsc",disabled:a&&(null==a?void 0:a.ascending),weight:330,onItem:function(){return i.addSorter(o,!0)}},addSortDesc:{text:a?"L{toggleSortDescending}":"L{addSortDescending}",localeClass:r,icon:"b-fw-icon b-icon-sort-desc",name:"addSortDesc",disabled:a&&!a.ascending,weight:340,onItem:function(){return i.addSorter(o,!1)}},removeSorter:{text:"L{removeSorter}",localeClass:r,icon:"b-fw-icon b-icon-remove",name:"removeSorter",weight:350,disabled:!a,onItem:function(){i.removeSorter(o.field)}}}}}}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this,r=n.store,i=n.disabled;if(!1!==e.sortable){var o=r.sorters.find((function(t){return t.field===e.field}));t.push({text:"L{sortAscendingShort}",group:"L{sort}",localeClass:n,icon:"b-icon b-icon-sort-asc",name:"sortAsc",cls:"b-separator",weight:105,disabled:i,onDrop:function(e){var t=e.column;return r.sort(t.field,!0)}},{text:"L{sortDescendingShort}",group:"L{sort}",localeClass:n,icon:"b-icon b-icon-sort-desc",name:"sortDesc",weight:105,disabled:i,onDrop:function(e){var t=e.column;return r.sort(t.field,!1)}},{text:"L{addSortAscendingShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-sort-asc",name:"multisortAddAsc",disabled:i||o&&o.ascending,weight:105,onDrop:function(e){var t=e.column;return r.addSorter(t.field,!0)}},{text:"L{addSortDescendingShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-sort-desc",name:"multisortAddDesc",disabled:i||o&&!o.ascending,weight:105,onDrop:function(e){var t=e.column;return r.addSorter(t.field,!1)}},{text:"L{removeSorterShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-remove",name:"multisortRemove",weight:105,disabled:i||!o,onDrop:function(e){var t=e.column;return r.removeSorter(t.field)}})}return t}},{key:"onStoreBeforeSort",value:function(e){for(var t=e.sorters,n=this.client.columns,r=0;r<t.length;r++){var i,o=t[r],a=(o.columnOwned||this.prioritizeColumns)&&n.get(o.field);null!=a&&null!==(i=a.sortable)&&void 0!==i&&i.sortFn&&(t[r]=fm(fm(fm({},o),a.sortable),{},{columnOwned:!0}))}}},{key:"onElementClick",value:function(e){var t=this,n=t.store,r=e.target,i=mi.up(r,".b-grid-header.b-sortable"),o=null==i?void 0:i.dataset.column;if(!t.ignoreRe.test(r.className)&&!t.disabled&&i&&o){var a=t.grid.columns.getById(i.dataset.columnId);if(n.isGrouped&&n.groupers.find((function(e){return e.field===o}))&&!e.shiftKey)return;if(a.sortable&&!e.shiftKey)if(e.ctrlKey&&e.altKey)n.removeSorter(a.field);else{var s={columnOwned:!0,field:a.field};"object"===I()(a.sortable)&&Qn.assign(s,a.sortable),n.sort(s,null,e.ctrlKey)}}}},{key:"renderHeader",value:function(){this.syncHeaderSortState()}},{key:"onPaint",value:function(){this.syncHeaderSortState()}}],[{key:"$name",get:function(){return"Sort"}},{key:"configurable",get:function(){return{multiSort:!0,prioritizeColumns:!1}}},{key:"properties",get:function(){return{ignoreRe:new RegExp(["b-grid-header-resize-handle","b-filter-icon"].join("|")),sortableCls:"b-sortable",sortedCls:"b-sort",sortedAscCls:"b-asc",sortedDescCls:"b-desc"}}},{key:"pluginConfig",get:function(){return{chain:["onElementClick","populateHeaderMenu","getColumnDragToolbarItems","renderHeader","onPaint","bindStore"]}}}]),n}(_i);function gm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}pm.featureClass="b-sort",pm._$name="Sort",ty.registerFeature(pm,!0);var ym=function(e){Ye()(n,e);var t=gm(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),e.on({scroll:"onGridScroll",thisObj:this}),Object.assign(this,mi.createElement({reference:"element",parent:e.element,className:"b-grid-sticky-row",children:[{reference:"contentElement",className:"b-grid-cell"}]},!1,{})),this.removeClasses=Qe()({"b-focused":!1,"b-hover":!1,"b-selected":!1},this.currentTopRowCls,!1)}},{key:"renderRows",value:function(){this.element.classList.add("b-hide-visibility")}},{key:"onGridScroll",value:function(){var e=this,t=e.client,n=e.element,r=e.contentElement,i=Cr.client(t.bodyContainer).roundPx(),o=t.rowManager.getRowAt(i.y),a=o!==e.currentTopRow;if(o){a&&(e.currentTopRow&&(e.currentTopRow.removeCls(e.currentTopRowCls),e.currentTopRow.removeCls("b-not-enough-height")),e.currentTopRow=o,o.addCls(e.currentTopRowCls),r.innerHTML="",r.appendChild(e.updateStickyContent()));var s=e.currentTopRow.bottom-e.client.scrollable.y<=e.stickyContentHeight;e.element.classList[s?"add":"remove"]("b-hide-visibility"),e.currentTopRow[s?"addCls":"removeCls"]("b-not-enough-height"),i.y+=e.stickyContentTop,mi.alignTo(n,e.stickyEls[0],{align:"t0-t0",constrainTo:i},!0)}e.lastProcessedTopRow=o}},{key:"updateStickyContent",value:function(){var e=this,t=e.currentTopRow,n=e.removeClasses,r={"b-grid-sticky-row":1},i={},o=e.stickyContent||(e.stickyContent=document.createDocumentFragment()),a=e.stickyEls||(e.stickyEls=[]);for(a.forEach((function(e){e.classList.remove("b-sticky-content-el")})),a.length=0,t.eachElement((function(t){a.push.apply(a,F()(t.querySelectorAll(e.contentSelector)))}));o.firstChild;)o.remove(o.firstChild);return e.stickyContentHeight=0,e.stickyContentTop=0,a.map((function(t){t.closest(".b-grid-cell").classList.forEach((function(e){return i[e]=1})),t.closest(".b-grid-row").classList.forEach((function(e){return r[e]=1})),Object.assign(i,n),Object.assign(r,n);var a=t.offsetTop;e.stickyContentTop=Math.max(e.stickyContentTop,a),t.style.alignSelf="flex-end",e.stickyContentHeight=Math.max(e.stickyContentHeight,e.currentTopRow.height-t.offsetTop+a),t.style.alignSelf="";var s=t.cloneNode(!0);return t.classList.add("b-sticky-content-el"),o.appendChild(s),s})),i["b-focused"]=!1,mi.syncClassList(e.contentElement,i),mi.syncClassList(e.element,r),o}}],[{key:"$name",get:function(){return"StickyCells"}},{key:"defaultConfig",get:function(){return{contentSelector:null,currentTopRowCls:"b-sticky-cells-current-top-row"}}},{key:"pluginConfig",get:function(){return{before:["renderRows"]}}}]),n}(_i);function mm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ym._$name="StickyCells",ty.registerFeature(ym,!1);var bm=function(e){Ye()(n,e);var t=mm(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),e.rowManager.on({renderrow:"onRenderRow",thisObj:this})}},{key:"doDisable",value:function(e){this.isConfiguring||this.client.refreshRows(),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"onRenderRow",value:function(e){var t=e.row,n=this.disabled,r=t.dataIndex%2==0;t.assignCls({"b-even":!n&&r,"b-odd":!n&&!r})}}],[{key:"$name",get:function(){return"Stripe"}}]),n}(_i);function km(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bm._$name="Stripe",ty.registerFeature(bm);var wm=function(e){Ye()(n,e);var t=km(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.grid=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t),this.bindStore(e.store),e.hideFooters=this.hideFooters}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",change:"onStoreChange",thisObj:this})}},{key:"store",get:function(){return this.grid.store}},{key:"doDestroy",value:function(){tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){tt()(Ze()(n.prototype),"doDisable",this).call(this,e),e?this.grid.element.classList.add("b-summary-disabled"):(this.updateSummaries(),this.grid.element.classList.remove("b-summary-disabled"))}},{key:"renderRows",value:function(){this.updateSummaries()}},{key:"updateSummaries",value:function(){var e=this,t=e.grid,n=e.store,r=mi.children(t.element,".b-grid-footer"),i=e.selectedOnly&&t.selectedRecords.length>0,o=n.storage.values.filter((function(e){return!e.isSpecialRow&&(!i||t.isSelected(e))}));t.columns.forEach((function(e){e.summaries&&e.summaries.forEach((function(e){"seed"in e&&("initialSeed"in e||(e.initialSeed=e.seed),["number","string","date"].includes(I()(e.initialSeed))?e.seed=e.initialSeed:e.seed=Object.assign({},e.initialSeed))}))})),r.forEach((function(n){if(n.dataset.column){var r=t.columns.get(n.dataset.column),i=e.generateHtml(r,o,"b-grid-footer-summary");(r.summaries?r.summaries.length:!!r.sum)&&(n.children.length?mi.sync(i,n.firstElementChild):n.innerHTML=i)}}))}},{key:"onStoreChange",value:function(e){var t=this,n=e.action,r=e.changes,i=!0;this.disabled||("update"===n&&(i=Object.keys(r).some((function(e){var n=t.grid.columns.get(e);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))}))),i&&this.updateSummaries())}},{key:"updateSelectedOnly",value:function(e){var t=this;t.detachListeners("selectionChange"),e&&t.grid.on({name:"selectionChange",selectionChange:t.refresh,thisObj:t}),t.refresh()}},{key:"refresh",value:function(){this.updateSummaries()}}],[{key:"configurable",get:function(){return{selectedOnly:null,hideFooters:!1}}},{key:"pluginConfig",get:function(){return{chain:["renderRows","bindStore"]}}},{key:"$name",get:function(){return"Summary"}}]),n}(Uy(_i));function Cm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}wm.featureClass="b-summary",wm._$name="Summary",ty.registerFeature(wm);var Rm=Promise.resolve(),Sm=function(e){Ye()(l,e);var t,n,r,i,o,a,s=Cm(l);function l(){return B()(this,l),s.apply(this,arguments)}return _()(l,[{key:"construct",value:function(e,t){tt()(Ze()(l.prototype),"construct",this).call(this,e,t);var n=e.columns.find((function(e){return e instanceof Yg}));Object.assign(this,{grid:e,rowManager:e.rowManager,treeColumn:n}),e.store&&this.bindStore(e.store)}},{key:"doDisable",value:function(e){}},{key:"store",get:function(){return this.grid.store}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",beforeLoadChildren:"onBeforeLoadChildren",loadChildren:"onLoadChildren",loadChildrenException:"onLoadChildrenException",beforeToggleNode:"onBeforeToggleNode",thisObj:this})}},{key:"toggleCollapse",value:(a=Pt()(At.a.mark((function e(t,n){var r,i,o,a,s,l,u,c,f=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.length>2&&void 0!==f[2]&&f[2],i=(r=this).store,o=r.grid,a=o.rowManager,s=i.getById(t),l=s.instanceMeta(i),e.next=4,i.toggleCollapse(s,n);case 4:if(!e.sent){e.next=10;break}(u=a.getRowFor(s))&&(c=u.getCell(r.treeColumn.id))&&u.renderCell({cellElement:c,record:s}),r.isTogglingNode||(o.element.classList.add("b-toggling-node"),r.isTogglingNode=!0,r.requestAnimationFrame((function(){o.element.classList.remove("b-toggling-node"),r.isTogglingNode=!1}))),o.trigger(l.collapsed?"collapseNode":"expandNode",{source:o,record:s}),o.trigger("toggleNode",{source:o,record:s,collapse:l.collapsed});case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"collapse",value:(o=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toggleCollapse(t,!0));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"expand",value:(i=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toggleCollapse(t,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onBeforeToggleNode",value:function(e){var t=e.record,n=e.collapse;this.grid.trigger("beforeToggleNode",{record:t,collapse:n})}},{key:"onBeforeLoadChildren",value:function(e){var t=e.source,n=e.params,r=t.getById(n[t.modelClass.idField]),i=this.grid.rowManager.getRowFor(r);i&&i.addCls("b-loading-children")}},{key:"onLoadChildren",value:function(e){var t=e.source,n=e.params,r=t.getById(n[t.modelClass.idField]),i=this.grid.rowManager.getRowFor(r);i&&i.removeCls("b-loading-children")}},{key:"onLoadChildrenException",value:function(e){var t=e.record,n=this.grid.rowManager.getRowFor(t);n&&n.removeCls("b-loading-children")}},{key:"expandOrCollapseAll",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.store.rootNode,r=this.grid,i=this.store,o=[],a=[];return r.trigger("beforeToggleAllNodes",{source:r,collapse:t}),i.suspendEvents(),i.traverse((function(n){var r=n.instanceMeta(i);n.isLeaf||(t&&!r.collapsed?(e.toggleCollapse(n,!0,!0),a.push.apply(a,F()(n.children))):!t&&r.collapsed&&(Array.isArray(n.children)&&a.push.apply(a,F()(n.children)),o.push(e.toggleCollapse(n,!1,!0))))}),n,n===i.rootNode),i.resumeEvents(),(t?Rm:Promise.all(o)).then((function(){r.refreshRows(t),a.length&&(t?i.trigger("remove",{records:a,isCollapse:!0,isCollapseAll:!0}):i.trigger("add",{records:a,isExpand:!0,isExpandAll:!0})),r.trigger("toggleAllNodes",{source:r,collapse:t})}))}},{key:"collapseAll",value:(r=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.expandOrCollapseAll(!0));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"expandAll",value:(n=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.expandOrCollapseAll(!1));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"expandTo",value:(t=Pt()(At.a.mark((function e(t){var n,r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(r=(n=this).store.getById(t)).instanceMeta(n.store).hiddenByCollapse){e.next=3;break}return e.abrupt("return");case 3:for(i=!1,o=r.parent,a=[];o&&!o.isRoot;)a.push(o),o=o.parent;return e.next=8,a.reverse().forEach(function(){var e=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.instanceMeta(n.store).collapsed&&(i=!0),e.next=3,n.toggleCollapse(t,!1,!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return i&&n.grid.refreshRows(),e.next=11,n.grid.scrollRowIntoView(r);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onElementClick",value:function(e){var t=this,n=e.target,r=t.grid.getCellDataFromEvent(e),i=n.closest(".b-tree-expander");(i||t.expandOnCellClick&&r&&r.record.isParent)&&(i&&e.preventDefault(),t.toggleCollapse(r.record))}},{key:"onElementKeyDown",value:function(e){var t=this.grid;e.target===t.focusElement&&" "===e.key&&t.focusedCell&&(e.preventDefault(),this.toggleCollapse(t.focusedCell.id))}},{key:"navigateRight",value:function(e){var t=this.grid,n=t.focusedCell;if(n){var r=t.store.getById(n.id);if(t.columns.getById(n.columnId).tree&&(e.shiftKey||1===t.columns.count))return r.isParent&&r.instanceMeta(t.store).collapsed?this.expand(r):t.navigateDown(e),!1}}},{key:"navigateLeft",value:function(e){var t=this.grid,n=t.focusedCell;if(n){var r=t.store.getById(n.id);if(t.columns.getById(n.columnId).tree&&(e.shiftKey||1===t.columns.count))return r.isParent&&!r.instanceMeta(t.store).collapsed?this.collapse(r):r.parent&&t.focusCell({id:r.parent.id,columnId:n.columnId}),!1}}}],[{key:"$name",get:function(){return"Tree"}},{key:"defaultConfig",get:function(){return{expandOnCellClick:!1}}},{key:"pluginConfig",get:function(){return{assign:["collapseAll","expandAll","collapse","expand","expandTo","toggleCollapse"],before:["navigateRight","navigateLeft"],chain:["onElementClick","onElementKeyDown","bindStore"]}}}]),l}(_i.mixin(el));Sm.featureClass="b-tree",Sm._$name="Tree",ty.registerFeature(Sm,!1,"Grid"),ty.registerFeature(Sm,!0,"TreeGrid");var xm={all:"all",visible:"visible"},Em={A6:{width:4.13,height:5.81},A5:{width:5.81,height:8.25},A4:{width:8.25,height:11.69},A3:{width:11.69,height:16.49},Legal:{width:8.5,height:14},Letter:{width:8.5,height:11}},Dm={portrait:"portrait",landscape:"landscape"},Tm={pdf:"pdf",png:"png"},Om={pdf:"application/pdf",png:"image/png"};function Mm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Am=function(e){return function(e){Ye()(n,e);var t=Mm(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"items",get:function(){return tt()(Ze()(n.prototype),"items",this)},set:function(e){!0===e&&(e=this.buildLocalizedItems()),gh()(Ze()(n.prototype),"items",e,this,!0)}},{key:"construct",value:function(){var e;this.inConstruct=!0;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this].concat(r)),this.inConstruct=!1}},{key:"buildLocalizedItems",value:function(){return[]}},{key:"updateLocalizedItems",value:function(){var e=this;if(e.store&&!e.inConstruct){var t=e.value;e.store.data=e.buildLocalizedItems(),e.value=null,e.value=t,e.syncInputFieldValue(!0)}}},{key:"updateLocalization",value:function(){this.updateLocalizedItems(),tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"LocalizableComboItems"}},{key:"defaultConfig",get:function(){return{items:!0}}}]),n}(e||Sv)};function Im(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Pm=function(e){Ye()(n,e);var t=Im(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"LocalizableCombo"}},{key:"type",get:function(){return"localizablecombo"}}]),n}(Am(Sv));function Fm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Pm.initClass(),Pm._$name="LocalizableCombo";var Lm=function(e){Ye()(n,e);var t=Fm(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildLocalizedItems",value:function(){return[{id:xm.all,text:this.L("L{all}")},{id:xm.visible,text:this.L("L{visible}")}]}}],[{key:"$name",get:function(){return"ExportRowsCombo"}},{key:"type",get:function(){return"exportrowscombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),n}(Pm);function Bm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Lm.initClass(),Lm._$name="ExportRowsCombo";var jm=function(e){Ye()(n,e);var t=Bm(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildLocalizedItems",value:function(){return[{id:Dm.portrait,text:this.L("L{portrait}")},{id:Dm.landscape,text:this.L("L{landscape}")}]}}],[{key:"$name",get:function(){return"ExportOrientationCombo"}},{key:"type",get:function(){return"exportorientationcombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),n}(Pm);function _m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}jm.initClass(),jm._$name="ExportOrientationCombo";var Hm=function(e){Ye()(n,e);var t=_m(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=e.client;if(!r)throw new Error("`client` config is required");var i,o=t.buildDialogItems(e);e.items?Array.isArray(e.items)?(i=e.items).push.apply(i,F()(o)):o.forEach((function(t){e.items[t.ref]=t,delete t.ref})):e.items=o;e.width=e.width||t.L("L{width}"),tt()(Ze()(n.prototype),"construct",this).call(this,e),Yt.on({locale:"onLocaleChange",prio:-1,thisObj:t})}},{key:"fieldProperties",get:function(){return["exporterType","orientation","fileFormat","paperFormat","alignRows","rowsRange","repeatHeader"]}},{key:"getDefaultFieldValues",value:function(e){var t=Qn.copyProperties({},e,this.fieldProperties);return Qn.copyPropertiesIf(t,this.getDefaultConfiguration(),this.fieldProperties)}},{key:"buildDialogItems",value:function(e){var t=this,n=this,r=e.exporters,i=e.client,o=n.getDefaultFieldValues(e),a=o.exporterType,s=o.orientation,l=o.paperFormat,u=o.fileFormat,c=o.alignRows,f=o.rowsRange,d=o.repeatHeader,h=n.L("L{ExportDialog.labelWidth}");function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return Object.keys(e).map((function(e){return{id:e,text:t(e)}}))}return n.columnsStore=i.columns.chain((function(e){return e.isLeaf&&e.exportable})),[{labelWidth:h,type:"combo",ref:"columnsField",label:"L{ExportDialog.columns}",store:n.columnsStore,value:null,valueField:"id",displayField:"text",multiSelect:!0},{labelWidth:h,type:"exportrowscombo",ref:"rowsRangeField",label:"L{ExportDialog.rows}",value:f},{labelWidth:h,type:"localizablecombo",ref:"exporterTypeField",label:"L{ExportDialog.exporterType}",editable:!1,value:a,buildLocalizedItems:function(){return r.map((function(e){return{id:e.type,text:n.optionalL(e.title,t)}}))},onChange:function(e){var t=e.value;this.owner.widgetMap.alignRowsField.hidden="singlepage"===t,this.owner.widgetMap.repeatHeaderField.hidden="multipagevertical"!==t}},{labelWidth:h,type:"checkbox",ref:"alignRowsField",label:"L{ExportDialog.alignRows}",checked:c,hidden:"singlepage"===a},{labelWidth:h,type:"checkbox",ref:"repeatHeaderField",label:"L{ExportDialog.repeatHeader}",localeClass:this,value:d,hidden:"multipagevertical"!==a},{labelWidth:h,type:"combo",ref:"fileFormatField",label:"L{ExportDialog.fileFormat}",localeClass:this,editable:!1,value:u,items:v(Tm,(function(e){return e.toUpperCase()})),onChange:function(e){var t=e.value,r=e.oldValue;if(n.hidePNGMultipageOption){var i=n.widgetMap.exporterTypeField,o=i.store.find((function(e){return"singlepage"===e.id}));t===Tm.png&&o?(this._previousDisabled=i.disabled,i.disabled=!0,this._previousValue=i.value,i.value="singlepage"):r===Tm.png&&this._previousValue&&(i.disabled=this._previousDisabled,i.value=this._previousValue)}}},{labelWidth:h,type:"combo",ref:"paperFormatField",label:"L{ExportDialog.paperFormat}",editable:!1,value:l,items:v(Em)},{labelWidth:h,type:"exportorientationcombo",ref:"orientationField",label:"L{ExportDialog.orientation}",value:s}]}},{key:"onShow",value:function(){var e;null===(e=tt()(Ze()(n.prototype),"onShow",this))||void 0===e||e.apply(this,arguments),this.widgetMap.columnsField.value=this.columnsStore.query((function(e){return!e.hidden}))}},{key:"onLocaleChange",value:function(){var e=this.L("L{labelWidth}");this.width=this.L("L{width}"),this.eachWidget((function(t){t instanceof tv&&(t.labelWidth=e)}))}},{key:"onExportClick",value:function(){var e=this.values;this.trigger("export",{values:e})}},{key:"onCancelClick",value:function(){this.trigger("cancel"),this.hide()}},{key:"values",get:function(){var e=/field/i,t={};return this.eachWidget((function(n){e.test(n.ref)&&(t[n.ref.replace(e,"")]=n instanceof Bv?n.checked:n.value)})),t}}],[{key:"$name",get:function(){return"ExportDialog"}},{key:"type",get:function(){return"exportdialog"}},{key:"defaultConfig",get:function(){return{autoShow:!1,autoClose:!1,closable:!0,centered:!0,client:null,hidePNGMultipageOption:!0,exporterType:"singlepage",orientation:"portrait",paperFormat:"A4",fileFormat:"pdf",alignRows:!1,rowsRange:"all",title:"L{exportSettings}",defaults:{localeClass:this},bbar:{defaults:{type:"button",localeClass:this},items:{exportButton:{color:"b-green",text:"L{ExportDialog.export}",weight:100,onClick:"up.onExportClick"},cancelButton:{color:"b-gray",text:"L{ExportDialog.cancel}",weight:200,onClick:"up.onCancelClick"}}}}}}]),n}(xf);Hm._$name="ExportDialog";n(218);var Nm,zm=n(119),Vm=n.n(zm),Wm=n(129),$m=n.n(Wm);function Um(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Gm=function(e){Ye()(l,e);var t,n,r,i,o,a,s=Um(l);function l(){return B()(this,l),s.apply(this,arguments)}return _()(l,[{key:"pageTpl",value:function(e){var t=e.title,n=e.header,r=e.footer,i=e.styles,o=e.htmlClasses,a=e.bodyStyle,s=e.bodyClasses,l=void 0===s?[]:s,u=e.paperHeight,c=e.paperWidth,f=e.html;return l.push("b-".concat(this.constructor.type)),mi.scrollBarWidth?l.push("b-visible-scrollbar"):l.push("b-overlay-scrollbar"),pe.a.isChrome?l.push("b-chrome"):pe.a.isSafari?l.push("b-safari"):pe.a.isFirefox?l.push("b-firefox"):pe.a.isIE11?l.push("b-ie"):pe.a.isEdge&&l.push("b-edge"),ud.tpl(Nm||(Nm=sv()(['\n            <!DOCTYPE html>\n            <html class="','" style="width: ',"in; height: ",'in;">\n                <head>\n                    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />\n                    <title>',"</title>\n                    ",'\n                </head>\n                <body class="b-export ','" style="width: ',"in; height: ","in; ",'">\n                    <div class="b-export-content">\n                        ','\n                        <div class="b-export-body"><div class="b-export-viewport">',"</div></div>\n                        ","\n                    </div>\n                </body>\n            </html>"])),o,c,u,t,i.join(""),l.join(" "),c,u,a,n&&'<div class="b-export-header" style="width: 100%">'.concat(n,"</div>"),f,r&&'<div class="b-export-footer" style="width: 100%">'.concat(r,"</div>"))}},{key:"stylesheets",get:function(){var e=this,t=this;if(t._stylesheets)return t._stylesheets;var n=t.translateURLsToAbsolute,r=window.origin,i=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')),o=[];return i.forEach((function(i){var a,s;(i=i.cloneNode(!0),n&&i.href)&&(a=!0===n?i.href:e.keepPathName?i.href.replace(r,n):new URL(i.getAttribute("href"),n),i.setAttribute("href",a));if(s=pe.a.isIE11&&i.styleSheet&&/style/i.test(i.tagName)?'<style type="text/css">'.concat(i.styleSheet.cssText,"</style>"):i.outerHTML,n&&/style/i.test(i.tagName)){var l=t.getStyleTagURLConverter(n);s=s.replace(/url\(['"]?(.+?)['"]?\)/g,l)}o.push(s)})),o.push("<style>\n                body, html {\n                    overflow: auto;\n                }\n                body {\n                    position: relative;\n                    margin: 0;\n                }\n            </style>"),t._stylesheets=o},set:function(e){this._stylesheets=e}},{key:"getStyleTagURLConverter",value:function(e){return function(t,n){var r;try{var i;/^#/.test(n)?r=t:(i=!0===e?window.location.href:this.keepPathName?window.location.href.replace(window.location.origin,e):e,r="url('".concat(new URL(n,i).href,"')"))}catch(e){r=t}return r}.bind(this)}},{key:"saveState",value:function(e){var t=e.client;this.state=t.state;var n=t.tbar,r=t.bbar;n&&(this.state.tbar_hidden=n.hidden,n.hide(!1)),r&&(this.state.bbar_hidden=r.hidden,r.hide(!1))}},{key:"restoreState",value:(a=Pt()(At.a.mark((function e(t){var n,r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=[],i=new Set,o=n.tbar,a=n.bbar,i.add(n.scrollable.on({scroll:function(){r.push(n.scrollable.await("scrollEnd"))}})),n.eachSubGrid((function(e){var t=e.header,n=e.scrollable;i.add(n.on({scroll:function(){r.push(n.await("scrollEnd"))}})),i.add(t.scrollable.on({scroll:function(){r.push(t.scrollable.await("scrollEnd"))}}))})),o&&(o.hidden=this.state.tbar_hidden,delete this.state.tbar_hidden),a&&(a.hidden=this.state.bbar_hidden,delete this.state.bbar_hidden),n.state=this.state,e.next=9,Promise.all(r);case 9:i.forEach((function(e){return e()}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"beforeExport",value:function(){this.element=document.createElement("div")}},{key:"cloneElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.element,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&(t.innerHTML=""),pe.a.isChrome?t.appendChild(e.cloneNode(!0)):t.innerHTML=e.outerHTML,mi.removeEachSelector(t,".b-grid-row");var r=t.querySelector(".b-gridbase > .b-mask");r&&r.remove()}},{key:"measureElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e instanceof HTMLElement&&(e=e.outerHTML);var t=mi.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:'<div style="height: 1px"></div>'.concat(e,'<div style="height: 1px"></div>')}),n=t.offsetHeight-2;return t.remove(),n}},{key:"prepareHTML",value:function(e){e instanceof HTMLElement&&(e=e.outerHTML);for(var t=mi.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:e}),n=t.querySelectorAll("img"),r=0,i=n.length;r<i;r++)n[r].setAttribute("src",n[r].src);var o=t.innerHTML;return t.remove(),o}},{key:"createPlaceholder",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t&&(e.innerHTML=""),mi.createElement({parent:e,id:Wo.generateId("export")})}},{key:"getVirtualScrollerHeight",value:function(e){var t=0;return e.eachSubGrid((function(e){e.overflowingHorizontally&&(t=mi.scrollBarWidth)})),0===t?t:t+1}},{key:"inchToPx",value:function(e){return 96*e}},{key:"getScaleValue",value:function(e,t){return Math.floor(1e4*e/t)/1e4}},{key:"getVisibleRowsCount",value:function(e){var t=e.rowManager,n=t.rows.indexOf(t.firstVisibleRow),r=t.rows.indexOf(t.lastVisibleRow);return-1!==n?-1===r?e.store.count-n:r-n+1:e.store.count}},{key:"export",value:(o=Pt()(At.a.mark((function e(t){var n,r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this).beforeExport(),n.saveState(t),e.next=5,n.prepareComponent(t);case 5:return e.prev=5,e.next=8,n.getPages(t);case 8:r=e.sent;case 9:return e.prev=9,e.next=12,n.restoreComponent(t);case 12:return n.stylesheets=null,e.next=15,new Promise((function(e){return n.requestAnimationFrame(e)}));case 15:return e.next=17,n.restoreState(t);case 17:return e.finish(9);case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,this,[[5,,9,18]])}))),function(e){return o.apply(this,arguments)})},{key:"getPages",value:(i=Pt()(At.a.mark((function e(t){var n,r,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.pagesExtractor(t),r=[];case 1:return e.next=3,n.next();case 3:if(e.t0=i=e.sent,!e.t0){e.next=6;break}e.t0=!i.done;case 6:if(!e.t0){e.next=10;break}r.push(i.value),e.next=1;break;case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"adjustRowBuffer",value:function(e){var t=this.exportMeta.contentHeight,n=e.rowManager;this.oldRowManagerConfig={prependRowBuffer:n.prependRowBuffer,appendRowBuffer:n.appendRowBuffer};var r=Math.ceil(t/n.rowOffsetHeight);n.prependRowBuffer=r,n.appendRowBuffer=r,e.renderRows(),e.rowManager.jumpToPosition(e.scrollable.y)}},{key:"restoreRowBuffer",value:function(e){e.rowManager.prependRowBuffer=this.oldRowManagerConfig.prependRowBuffer,e.rowManager.appendRowBuffer=this.oldRowManagerConfig.appendRowBuffer}},{key:"prepareComponent",value:(r=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=t.client,i=t.columns,o=t.rowsRange,a=t.keepRegionSizes,s=r.rowManager,l=n.exportMeta={totalWidth:0,totalHeight:0-n.getVirtualScrollerHeight(r),subGrids:{}},r.columns.forEach((function(e){i.includes(e.id)?e.show():e.hide()})),!(r.rowManager.rowCount>0)){e.next=13;break}if(o!==xm.all){e.next=9;break}return l.firstVisibleDataIndex=s.rows[0].dataIndex,e.next=7,r.scrollRowIntoView(r.store.first,{block:"start"});case 7:e.next=13;break;case 9:return u=l.firstVisibleDataIndex=s.firstVisibleRow.dataIndex,e.next=12,r.scrollRowIntoView(r.store.getAt(u),{block:"start"});case 12:t.alignRows=!0;case 13:this.cloneElement(r.element),c=n.element,r.eachSubGrid((function(e){var t,i,o=n.createPlaceholder(c.querySelector('[id="'.concat(e.id,'"]')),!1);i=null!=a&&a[e.region]?e.element.offsetWidth:e.columns.visibleColumns.reduce((function(e,t){return"number"==typeof t.width?e+=t.width:e+=r.getHeaderElement(t.id).offsetWidth,e}),0),l.totalWidth+=i;var s=(null===(t=e.splitterElement)||void 0===t?void 0:t.offsetWidth)||0;l.totalWidth+=s,l.subGrids[e.region]={id:e.id,headerId:e.header&&e.header.id||null,footerId:e.footer&&e.footer.id||null,rows:[],splitterWidth:s,placeHolder:o,width:i}}));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta;return Object.values(t.subGrids).forEach((function(t){var n=t.width;[t.id,t.headerId,t.footerId].forEach((function(t){if(t){var r=e.querySelector('[id="'.concat(t,'"]'));r&&(r.style.width="".concat(n,"px"),r.style.flex="")}}))})),e.innerHTML}},{key:"restoreComponent",value:(n=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"scrollRowIntoView",value:(t=Pt()(At.a.mark((function e(t,n){var r=this;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollRowIntoView(t.store.getAt(n),{block:"start"});case 2:return e.next=4,new Promise((function(e){return r.requestAnimationFrame(e)}));case 4:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}],[{key:"defaultConfig",get:function(){return{translateURLsToAbsolute:!0,keepPathName:!0}}}]),l}(el(Ot(en($e))));function Ym(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Gm.prototype.pagesExtractor=function(){var e=$m()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,"";case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Gm._$name="Exporter";var qm=function(e){Ye()(s,e);var t,n,r,i,o,a=Ym(s);function s(){return B()(this,s),a.apply(this,arguments)}return _()(s,[{key:"stateNextPage",value:(o=Pt()(At.a.mark((function e(t){var n,r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,++(r=this.exportMeta).currentPage,++r.verticalPosition,delete r.lastExportedRowBottom,!(r.verticalPosition>=r.verticalPages)){e.next=10;break}return r.verticalPosition=r.currentPageTopMargin=0,++r.horizontalPosition,e.next=10,this.scrollRowIntoView(n,r.firstVisibleDataIndex,{block:"start"});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"prepareComponent",value:(i=Pt()(At.a.mark((function e(t){var n,r,i,o,a,l,u,c,f,d,h,v,p,g,y,m,b,k,w,C,R,S,x;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt()(Ze()(s.prototype),"prepareComponent",this).call(this,t);case 2:r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,l=t.alignRows,u=t.rowsRange,c=Em[t.paperFormat],f=t.orientation===Dm.portrait,d=f?c.width:c.height,h=f?c.height:c.width,v=n.inchToPx(d),p=n.inchToPx(h),g=Math.ceil(r.totalWidth/v),y=r.totalHeight+i.height-i.bodyHeight+i.scrollable.scrollHeight,m=p,o&&(m-=n.measureElement(o({totalWidth:r.totalWidth,totalPages:-1,currentPage:-1}))),a&&(m-=n.measureElement(a({totalWidth:r.totalWidth,totalPages:-1,currentPage:-1}))),k=i.store.count,u===xm.visible&&(k=n.getVisibleRowsCount(i),w=i.rowManager.rows[k-1].bottom,y=y-i.scrollable.scrollHeight+w),l&&u!==xm.visible?(C=i.rowManager.rowOffsetHeight,R=Math.floor((m-i.headerHeight)/C),S=Math.floor(m/C),x=k-R,b=1+Math.ceil(x/S)):b=Math.ceil(y/m),Object.assign(r,{paperWidth:d,paperHeight:h,pageWidth:v,pageHeight:p,horizontalPages:g,verticalPages:b,totalHeight:y,contentHeight:m,totalRows:k,totalPages:g*b,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0}),this.adjustRowBuffer(i);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"restoreComponent",value:(r=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt()(Ze()(s.prototype),"restoreComponent",this).call(this,t);case 2:this.restoreRowBuffer(t.client);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"buildPage",value:(n=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,f,d,h,v,p,g,y,m,b,k,w,C,R,S,x,E,D,T,O,M;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,s=t.alignRows,l=r.totalWidth,u=r.totalPages,c=r.currentPage,f=r.subGrids,d=r.currentPageTopMargin,h=r.verticalPosition,v=r.totalRows,p=i.rowManager,g=p.rows,Object.values(f).forEach((function(e){return e.rows=[]})),t.rowsRange===xm.all&&(r.totalHeight=i.height-i.bodyHeight+i.scrollable.scrollHeight-n.getVirtualScrollerHeight(i)),y=0,m=0,b=t.rowsRange===xm.visible?g.findIndex((function(e){return e.bottom>i.scrollable.y})):g.findIndex((function(e){return e.bottom+d+i.headerHeight>0})),R=b,S=0===h?0:g[b].top+d+i.headerHeight,o&&(w=n.prepareHTML(o({totalWidth:l,totalPages:u,currentPage:c})),y=n.measureElement(w)),a&&(C=n.prepareHTML(a({totalWidth:l,totalPages:u,currentPage:c})),m=n.measureElement(C)),k=r.pageHeight-y-m-S,0===h&&(k-=i.headerHeight),E=0;k>0;)D=g[b],s&&k<D.offsetHeight?(E=-k,k=0,n.exportMeta.lastExportedRowBottom=g[b-1].bottom):(n.collectRow(D),k-=D.offsetHeight,x=D.dataIndex,(++b===g.length&&k>0||t.rowsRange===xm.visible&&b-R===v)&&(k=0));return(T=g[b-1])&&(r.exactGridHeight=T.bottom+i.footerContainer.offsetHeight+i.headerContainer.offsetHeight),e.next=15,n.onRowsCollected(g.slice(R,b),t);case 15:if(t.rowsRange!==xm.visible){e.next=19;break}r.exactGridHeight-=r.scrollableTopMargin=i.scrollable.y,e.next=23;break;case 19:return O=p.on("offsetrows",(function(e){var t=e.offset;return E+=t})),e.next=22,n.scrollRowIntoView(i,x+1);case 22:O();case 23:return M=n.buildPageHtml(),e.abrupt("return",{html:M,header:w,footer:C,offset:E});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onRowsCollected",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(e){var n=N()(e,2),r=n[0],i=n[1];t[r].rows.push(i.outerHTML)}))}},{key:"buildPageHtml",value:function(){var e=this.exportMeta.subGrids,t=this.prepareExportElement();return Object.values(e).forEach((function(e){var n=e.placeHolder,r=e.rows,i=n.outerHTML;t=t.replace(i,r.join(""))})),t}},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta;return t.scrollableTopMargin&&(e.querySelector(".b-grid-vertical-scroller").style.marginTop="-".concat(t.scrollableTopMargin,"px")),tt()(Ze()(s.prototype),"prepareExportElement",this).call(this)}}],[{key:"$name",get:function(){return"MultiPageExporter"}},{key:"type",get:function(){return"multipage"}},{key:"title",get:function(){return this.L("L{multipage}")}},{key:"exportingPageText",get:function(){return"L{exportingPage}"}}]),s}(Gm);function Km(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}qm.prototype.pagesExtractor=function(){var e=$m()(At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,f,d,h,v,p,g;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(n=this).exportMeta,i=n.stylesheets,o=r.totalWidth,a=r.totalPages,s=r.paperWidth,l=r.paperHeight,u=r.contentHeight;case 1:if(!((c=r.currentPage)<a)){e.next=18;break}return n.trigger("exportStep",{text:n.L(qm.exportingPageText,{currentPage:c,totalPages:a}),progress:Math.round((c+1)/a*90)}),e.next=5,Vm()(n.buildPage(t));case 5:return f=e.sent,d=f.html,h=f.header,v=f.footer,p=f.offset,g=[].concat(F()(i),["\n                <style>\n                    #".concat(t.client.id," {\n                        height: ").concat(r.exactGridHeight,"px !important;\n                        width: ").concat(o,"px !important;\n                    }\n                    .b-export-body .b-export-viewport {\n                        margin-left : ").concat(-s*r.horizontalPosition,"in;\n                        margin-top  : ").concat(r.currentPageTopMargin,"px;\n                    }\n                </style>\n            ")]),r.currentPageTopMargin-=u+p,e.next=14,Vm()(n.stateNextPage(t));case 14:return e.next=16,{html:n.pageTpl({html:d,header:h,footer:v,styles:g,paperWidth:s,paperHeight:l})};case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),qm._$name="MultiPageExporter";var Xm=function(e){Ye()(s,e);var t,n,r,i,o,a=Km(s);function s(){return B()(this,s),a.apply(this,arguments)}return _()(s,[{key:"stateNextPage",value:(o=Pt()(At.a.mark((function e(t){var n,r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.client,n=this.exportMeta,r=n.totalRows,i=n.processedRows,o=n.totalPages,++n.currentPage,++n.verticalPosition,n.currentPage===o&&i.size!==r&&(++n.totalPages,++n.verticalPages);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"estimateTotalPages",value:function(e){var t,n=this,r=n.exportMeta,i=e.client,o=e.headerTpl,a=e.footerTpl,s=e.alignRows,l=e.rowsRange,u=e.repeatHeader,c=r.pageWidth,f=r.pageHeight,d=r.totalWidth,h=n.getScaleValue(c,d),v=0-n.getVirtualScrollerHeight(i)+i.height-i.bodyHeight+i.scrollable.scrollHeight,p=f/h,g=i.store.count,y=0;if(o&&(p-=n.measureElement(o({totalWidth:d,totalPages:-1,currentPage:-1}))),a&&(p-=n.measureElement(a({totalWidth:d,totalPages:-1,currentPage:-1}))),u&&(p-=i.headerHeight,v-=i.headerHeight),l===xm.visible){var m=i.rowManager,b=m.firstVisibleRow,k=m.lastVisibleRow;y=b.top,g=n.getVisibleRowsCount(i),v=v-i.scrollable.scrollHeight+k.bottom-b.top}if(s&&!u&&l!==xm.visible){var w=i.rowManager.rowOffsetHeight,C=Math.floor((p-i.headerHeight)/w),R=Math.floor(p/w),S=g-C;t=1+Math.ceil(S/R)}else t=Math.ceil(v/p);Object.assign(r,{scale:h,contentHeight:p,totalRows:g,totalHeight:v,verticalPages:t,initialScroll:y,horizontalPages:1,totalPages:t})}},{key:"prepareComponent",value:(i=Pt()(At.a.mark((function e(t){var n,r,i,o,a,l,u,c,f;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt()(Ze()(s.prototype),"prepareComponent",this).call(this,t);case 2:r=(n=this).exportMeta,i=t.client,o=Em[t.paperFormat],a=t.orientation===Dm.portrait,l=a?o.width:o.height,u=a?o.height:o.width,c=n.inchToPx(l),f=n.inchToPx(u),Object.assign(r,{paperWidth:l,paperHeight:u,pageWidth:c,pageHeight:f,horizontalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0,processedRows:new Set}),n.estimateTotalPages(t),n.adjustRowBuffer(i);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"restoreComponent",value:(r=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt()(Ze()(s.prototype),"restoreComponent",this).call(this,t);case 2:this.restoreRowBuffer(t.client);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"buildPage",value:(n=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,f,d,h,v,p,g,y,m,b,k,w,C,R,S,x,E,D,T,O,M,A;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,s=t.alignRows,l=t.repeatHeader,u=r.totalWidth,c=r.totalPages,f=r.currentPage,d=r.subGrids,h=r.currentPageTopMargin,v=r.verticalPosition,p=r.totalRows,g=r.contentHeight,y=l?0:i.headerHeight,m=i.rowManager,b=m.rows,Object.values(d).forEach((function(e){return e.rows=[]})),t.rowsRange===xm.all&&(r.totalHeight=i.height-i.bodyHeight+i.scrollable.scrollHeight-n.getVirtualScrollerHeight(i)),k=t.rowsRange===xm.visible?b.findIndex((function(e){return e.bottom>i.scrollable.y})):b.findIndex((function(e){return e.bottom+h+y>0})),S=k,x=0===v?0:b[k].top+h+y,o&&(C=n.prepareHTML(o({totalWidth:u,totalPages:c,currentPage:f}))),a&&(R=n.prepareHTML(a({totalWidth:u,totalPages:c,currentPage:f}))),w=g-x,0===v&&(w-=y),D=0;w>0;)T=b[k],s&&w<T.offsetHeight?(D=-w,w=0):(n.collectRow(T),(w-=T.offsetHeight)>0&&r.processedRows.add(T.dataIndex),E=T.dataIndex,(++k===b.length&&w>0||t.rowsRange===xm.visible&&k-S===p)&&(w=0));return(O=b[k-1])&&(r.exactGridHeight=O.bottom+i.footerContainer.offsetHeight+i.headerContainer.offsetHeight),e.next=15,n.onRowsCollected(b.slice(S,k),t);case 15:if(t.rowsRange!==xm.visible){e.next=19;break}r.scrollableTopMargin=i.scrollable.y,e.next=23;break;case 19:return M=m.on("offsetrows",(function(e){var t=e.offset;return D+=t})),e.next=22,n.scrollRowIntoView(i,E+1);case 22:M();case 23:return A=n.buildPageHtml(),e.abrupt("return",{html:A,header:C,footer:R,offset:D});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onRowsCollected",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(e){var n=N()(e,2),r=n[0],i=n[1];t[r].rows.push(i.outerHTML)}))}},{key:"buildPageHtml",value:function(){var e=this.exportMeta.subGrids,t=this.prepareExportElement();return Object.values(e).forEach((function(e){var n=e.placeHolder,r=e.rows,i=n.outerHTML;t=t.replace(i,r.join(""))})),t}}],[{key:"$name",get:function(){return"MultiPageVerticalExporter"}},{key:"type",get:function(){return"multipagevertical"}},{key:"title",get:function(){return this.L("L{multipagevertical}")}},{key:"exportingPageText",get:function(){return"L{exportingPage}"}}]),s}(Gm);function Zm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Xm.prototype.pagesExtractor=function(){var e=$m()(At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,f,d,h,v,p,g,y,m,b,k;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(n=this).exportMeta,i=n.stylesheets,o=r.totalWidth,a=r.paperWidth,s=r.paperHeight,l=r.contentHeight,u=r.scale,c=r.initialScroll,f=r.totalPages;case 2:if(!((d=r.currentPage)<f)){e.next=21;break}return n.trigger("exportStep",{text:n.L(Xm.exportingPageText,{currentPage:d,totalPages:f}),progress:Math.round((d+1)/f*90)}),e.next=6,Vm()(n.buildPage(t));case 6:return h=e.sent,v=h.html,p=h.header,g=h.footer,y=h.offset,m=[].concat(F()(i),["\n                <style>\n                    #".concat(t.client.id," {\n                        width: ").concat(o,"px !important;\n                    }\n                    .b-export .b-export-content {\n                        transform: scale(").concat(u,");\n                        transform-origin: top left;\n                        height: auto;\n                    }\n                </style>\n            ")]),t.repeatHeader?(b=r.exactGridHeight?"".concat(r.exactGridHeight+r.currentPageTopMargin,"px"):"100%",m.push("\n                <style>\n                    #".concat(t.client.id," {\n                        height: ").concat(b," !important;\n                    }\n                    .b-export .b-export-content {\n                        height: ").concat(100/u,"%;\n                    }\n                    .b-export-body {\n                        height: 100%;\n                        display: flex;\n                    }\n                    .b-export-viewport {\n                        height: 100%;\n                    }\n                    .b-grid-vertical-scroller {\n                        margin-top: ").concat(r.currentPageTopMargin-c,"px;\n                    }\n                </style>\n                "))):(k=r.exactGridHeight||l-r.currentPageTopMargin,m.push("\n                <style>\n                    #".concat(t.client.id," {\n                        height: ").concat(k,"px !important;\n                    }\n                    .b-export-body {\n                        overflow: hidden;\n                    }\n                    .b-export .b-export-content {\n                        height: ").concat(100/u,"%;\n                    }\n                    .b-export-body .b-export-viewport {\n                        margin-top: ").concat(r.currentPageTopMargin,"px;\n                    }\n                    .b-grid-vertical-scroller {\n                        margin-top: -").concat(c,"px;\n                    }\n                </style>\n                "))),r.currentPageTopMargin-=l+y,e.next=16,Vm()(n.stateNextPage(t));case 16:return f=r.totalPages,e.next=19,{html:n.pageTpl({html:v,header:p,footer:g,styles:m,paperWidth:a,paperHeight:s})};case 19:e.next=2;break;case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Xm._$name="MultiPageVerticalExporter";var Jm=function(e){Ye()(i,e);var t,n,r=Zm(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"prepareComponent",value:(n=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt()(Ze()(i.prototype),"prepareComponent",this).call(this,t);case 2:Object.assign(this.exportMeta,{verticalPages:1,horizontalPages:1,totalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onRowsCollected",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=0;return e.map((function(e){var n=N()(e,2),r=n[0],i=n[1],o=r.replace(/translate\(\d+px, \d+px\)/,"translate(0px, ".concat(t,"px)"));return t+=i,o}))}},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(n){var r=N()(n,2),i=r[0],o=r[1];t[i].rows.push([o.outerHTML,e.offsetHeight])}))}},{key:"buildPageHtml",value:function(){var e=this,t=e.exportMeta.subGrids,n=e.prepareExportElement();return Object.values(t).forEach((function(t){var r=t.placeHolder,i=t.rows,o=r.outerHTML;n=n.replace(o,e.positionRows(i).join(""))})),n}}],[{key:"$name",get:function(){return"SinglePageExporter"}},{key:"type",get:function(){return"singlepage"}},{key:"title",get:function(){return this.localize("L{singlepage}")}},{key:"defaultConfig",get:function(){return{centerContentHorizontally:!1}}}]),i}(Gm);function Qm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Jm.prototype.pagesExtractor=function(){var e=$m()(At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,f,d,h,v,p,g,y,m,b,k,w,C,R,S,x,E,D,T,O,M;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=t.client,i=r.rowManager,o=r.store,a=n.stylesheets,s=t.orientation===Dm.portrait,l=Em[t.paperFormat],u=s?l.width:l.height,c=s?l.height:l.width,f=t.rowsRange===xm.visible&&o.count?n.getVisibleRowsCount(r):o.count,d=n.exportMeta,h=d.totalHeight,v=d.totalWidth,p=0,g=-1,!(i.rows.length>0)){e.next=16;break}t.rowsRange===xm.visible&&(g=i.firstVisibleRow.dataIndex-1);case 4:if(!(p<f)){e.next=16;break}return b=i.rows,k=b[b.length-1],w=p,b.forEach((function(e){e.dataIndex>g&&p<f&&(++p,h+=e.offsetHeight,n.collectRow(e))})),C=b.findIndex((function(e){return e.dataIndex===g+1})),R=C+(p-w),e.next=10,Vm()(n.onRowsCollected(b.slice(C,R),t));case 10:if(!(p<f)){e.next=14;break}return g=k.dataIndex,e.next=14,Vm()(n.scrollRowIntoView(r,g+1));case 14:e.next=4;break;case 16:return S=n.buildPageHtml(),h+=r.height-r.bodyHeight,x=h,t.headerTpl&&(y=n.prepareHTML(t.headerTpl({totalWidth:v})),E=n.measureElement(y),h+=E),t.footerTpl&&(m=n.prepareHTML(t.footerTpl({totalWidth:v})),D=n.measureElement(m),h+=D),T=Math.min(1,n.getScaleValue(n.inchToPx(u),v)),O=Math.min(1,n.getScaleValue(n.inchToPx(c),h)),M=Math.min(T,O),a.push("<style>\n                #".concat(r.id," {\n                    height: ").concat(x,"px !important;\n                    width: ").concat(v,"px !important;\n                }\n                .b-export-content {\n                    ").concat(n.centerContentHorizontally?"left: 50%;":"","\n                    transform: scale(").concat(M,") ").concat(n.centerContentHorizontally?"translateX(-50%)":"",";\n                    transform-origin: top left;\n                    height: ").concat(1===M?"inherit":"auto !important",";\n                }\n            </style>")),pe.a.isIE11&&a.push("<style>\n                .b-export-body {\n                   min-height: ".concat(x,"px !important;\n                }\n         </style>")),e.next=26,{html:n.pageTpl({html:S,header:y,footer:m,styles:a,paperWidth:u,paperHeight:c})};case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Jm._$name="SinglePageExporter";var eb=function(e){Ye()(a,e);var t,n,r,i,o=Qm(a);function a(){return B()(this,a),o.apply(this,arguments)}return _()(a,[{key:"doDestroy",value:function(){this.exportDialog&&this.exportDialog.destroy(),tt()(Ze()(a.prototype),"doDestroy",this).call(this)}},{key:"currentExportPromise",get:function(){return this._currentExportPromise},set:function(e){this._currentExportPromise=e}},{key:"exportersMap",get:function(){return this._exportersMap||(this._exportersMap=new Map)}},{key:"getExporter",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=n.exportersMap,i=t,o=i.type;if(r.has(o))e=r.get(o);else{var a=this.exporters.find((function(e){return e.type===o}));if(!a)throw new Error("Exporter type ".concat(o," is not found. Make sure you've configured it"));delete(t=Qn.clone(t)).type,(e=new a(t)).relayAll(n),r.set(o,e)}return e}},{key:"buildRequest",value:function(e,t){return{html:JSON.stringify(e),fileFormat:t.fileFormat,format:t.paperFormat,orientation:t.orientation}}},{key:"buildExportConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=t.client,r=t.exportServer,i=t.clientURL,o=t.fileFormat,a=t.fileName,s=t.paperFormat,l=t.rowsRange,u=t.alignRows,c=t.repeatHeader,f=t.keepRegionSizes,d=t.orientation,h=t.exporters,v=t.translateURLsToAbsolute,p=t.keepPathName,g=t.sendAsBinary,y=t.headerTpl,m=t.footerTpl;e.columns||(e.columns=n.columns.visibleColumns.map((function(e){return e.id})));var b=Qn.assign({client:n,exportServer:r,clientURL:i,fileFormat:o,paperFormat:s,rowsRange:l,alignRows:u,repeatHeader:c,keepRegionSizes:f,orientation:d,translateURLsToAbsolute:v,keepPathName:p,sendAsBinary:g,headerTpl:y,footerTpl:m,exporterType:h[0].type,fileName:a||n.$$name},e);if("multipagevertical"!==b.exporterType&&(b.repeatHeader=!1),!("alignRows"in e)&&e.repeatHeader&&(b.alignRows=!0),!("keepRegionSizes"in e)&&!b.keepRegionSizes){var k=[],w={};n.eachSubGrid((function(e){return e.collapsed&&k.push(e.region)})),k.length&&(n.eachSubGrid((function(e){k.includes(e.region)||(w[e.region]=!0)})),b.keepRegionSizes=w)}return b}},{key:"export",value:(i=Pt()(At.a.mark((function e(){var t,n,r,i,o,a,s,l,u=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},r=(n=this).client,i=n.pagesPerRequest,(t=n.buildExportConfig(t)).exporterConfig=Qn.assign({type:t.exporterType,translateURLsToAbsolute:t.translateURLsToAbsolute,keepPathName:t.keepPathName},t.exporterConfig||{}),!1===r.trigger("beforeExport",t)){e.next=32;break}if(r.mask(n.exportMask),e.prev=6,a=n.getExporter(t.exporterConfig),0!==i){e.next=19;break}return e.next=11,a.export(t);case 11:return s=e.sent,n.trigger("exportStep",{progress:90,text:n.exportProgressMask}),e.next=15,n.receiveExportContent(s,t);case 15:return l=e.sent,o={response:l},e.next=19,n.processExportContent(l,t);case 19:e.next=25;break;case 21:throw e.prev=21,e.t0=e.catch(6),o=e.t0 instanceof Response?{response:e.t0}:{error:e.t0},e.t0;case 25:return e.prev=25,n.exportDialog&&n.exportDialog.close(),r.unmask(),n.trigger("export",o),o.error?hd.show({html:n.L("L{Export failed}"),rootElement:this.rootElement}):o.response.ok||hd.show({html:n.L("L{Server error}"),rootElement:this.rootElement}),r.trigger("export",o),e.finish(25);case 32:return e.abrupt("return",o);case 33:case"end":return e.stop()}}),e,this,[[6,21,25,32]])}))),function(){return i.apply(this,arguments)})},{key:"receiveExportContent",value:(r=Pt()(At.a.mark((function e(t,n){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vt.post(n.exportServer,{html:t,orientation:n.orientation,format:n.paperFormat,fileFormat:n.fileFormat,fileName:n.fileName,clientURL:n.clientURL,sendAsBinary:n.sendAsBinary},Object.assign({credentials:"omit"},this.fetchOptions)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"processExportContent",value:(n=Pt()(At.a.mark((function e(t,n){var r,i,o,a,s;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,!t.ok||!r.openAfterExport){e.next=18;break}if(t=t.clone(),!(i=t.headers.get("content-type")).match(/application\/octet-stream/)){e.next=13;break}return o=Om[n.fileFormat],e.next=8,r.responseBlobToObjectURL(t,o);case 8:a=e.sent,r.getDownloadLink(n.fileName,a).click(),e.next=18;break;case 13:if(!i.match(/application\/json/)){e.next=18;break}return e.next=16,t.json();case 16:(s=e.sent).success?pe.a.isIE11?window.open(s.url,"ExportedPanel"):r.getDownloadLink(n.fileName,s.url).click():hd.show({html:s.msg,rootElement:this.rootElement});case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"responseBlobToObjectURL",value:(t=Pt()(At.a.mark((function e(t,n){var r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.blob();case 2:return r=e.sent,e.abrupt("return",URL.createObjectURL(r.slice(0,r.size,n)));case 4:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"getDownloadLink",value:function(e,t){var n=document.createElement("a");return n.download=e,n.href=t,this.openInNewTab&&(n.target="_blank"),n}},{key:"defaultExportDialogConfig",get:function(){return Qn.copyProperties({},this,["client","exporters","exporterType","orientation","fileFormat","paperFormat","alignRows","rowsRange","repeatHeader"])}},{key:"showExportDialog",value:function(){var e=this;return e.exportDialog||(e.exportDialog=Hm.new({rootElement:e.rootElement,listeners:{export:e.onExportDialogExport,thisObj:e}},e.defaultExportDialogConfig)),e.exportDialog.show()}},{key:"onExportDialogExport",value:function(e){var t=e.values,n=this;n.mask=new qu({progress:0,maxProgress:100,text:n.exportMask,target:n.exportDialog.element});var r=n.on({export:function(){n.mask.close(),r()},exportstep:function(e){var t=e.progress,r=e.text;n.mask.progress=t,null!=r&&(n.mask.text=r)}});n.currentExportPromise=n.export(t),n.currentExportPromise.then((function(){return n.currentExportPromise=null}))}}],[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exportServer:void 0,fileName:null,fileFormat:"pdf",clientURL:null,paperFormat:"A4",orientation:"portrait",rowsRange:"all",alignRows:!1,repeatHeader:!1,keepRegionSizes:null,pagesPerRequest:0,exporterConfig:null,exporterType:"singlepage",exporters:[Jm,qm,Xm],translateURLsToAbsolute:!0,keepPathName:!0,openAfterExport:!0,sendAsBinary:!1,openInNewTab:!1,headerTpl:null,footerTpl:null,fetchOptions:null,exportMask:"L{Generating pages}",exportProgressMask:"L{Waiting for response from server}",localizableProperties:["exportMask","exportProgressMask"]}}}]),a}(_i);function tb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}eb._$name="PdfExport",ty.registerFeature(eb,!1,"Grid");var nb=function(e){Ye()(n,e);var t=tb(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return e=Qn.assign({},t.config,e),t.normalizeColumns(e),t.generateExportData(e)}},{key:"generateExportData",value:function(e){var t=this.generateColumns(e);return{rows:this.generateRows(e),columns:t}}},{key:"normalizeColumns",value:function(e){var t=this,n=e.columns||this.target.columns.visibleColumns.filter((function(e){return!1!==e.exportable}));e.columns=n.map((function(e){return"string"==typeof e?t.target.columns.find((function(t){return t.field===e}))||{field:e}:e}))}},{key:"generateColumns",value:function(e){var t=this;return e.columns.map((function(n){return t.processColumn(n,e)}))}},{key:"generateRows",value:function(e){var t=e.columns;if(!t.length)return[];var n=this;return n.target.store.map((function(r){return n.processRecord(r,t,e)})).filter((function(e){return null==e?void 0:e.length}))}},{key:"getColumnType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.target.store,n=e.exportedType||"object";if(void 0===e.exportedType&&e.field){var r=t.modelClass.getFieldDefinition(e.field);r&&"auto"!==r.type&&(n=r.type)}return n}},{key:"processColumn",value:function(e,t){var n=this.target,r=t.defaultColumnWidth,i=e.field,o=e.text,a=e.width,s=e.minWidth;if(i in n.store.modelClass.fieldMap||(i=""),!o||!a){var l=n.columns.find((function(e){return e.field===i}));o||(o=l&&l.text||i),null==a&&(a=l&&l.width||r)}return a=Math.max(a||r,s||r),{field:i,value:o,width:a,type:this.getColumnType(e)}}},{key:"processRecord",value:function(e,t,n){var r,i=this.target,o=n.showGroupHeader,a=n.indent,s=n.indentationSymbol;return e?e.isSpecialRow?o&&e.meta.groupRowFor&&(r=t.map((function(t){return i.features.group.buildGroupHeader({cellElement:mi.createElement(),grid:i,record:e,column:t})}))):r=t.map((function(t){var r,o=null!==(r=t.field)&&void 0!==r&&r.includes(".")?e.get(t.field):e[t.field],l=t.renderer||t.defaultRenderer;return!l||o&&t.isDateColumn&&n.exportDateAsInstance||(o=l.call(t,{value:o,record:e,column:t,grid:i,isExport:!0})),a&&t.tree&&(o="".concat(s.repeat(e.childLevel)).concat(o)),o})):r=t.map((function(){return""})),r}}],[{key:"defaultConfig",get:function(){return{target:null,defaultColumnWidth:100,exportDateAsInstance:!0,showGroupHeader:!0,columns:null,indent:!0,indentationSymbol:"    "}}}]),n}($e);nb._$name="TableExporter";var rb=function(){function e(t){B()(this,e),this._value=t}return _()(e,[{key:"value",get:function(){return this._value}},{key:"toString",value:function(){return Boolean(this.value)?"✓":""}}]),e}();function ib(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}rb._$name="BooleanUnicodeSymbol";var ob=function(e){Ye()(n,e);var t=ib(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"processValue",value:function(e){return null==e||Number.isNaN(e)||"function"==typeof e||"object"===I()(e)&&"[object Object]"===String(e)?"":e}},{key:"generateExportData",value:function(e){var t=this,n=t.exporter.export(e.exporterConfig),r=n.rows,i=n.columns;return{rows:r.map((function(n){return n.map((function(n,r){var o;return n instanceof Date?n=Un.format(n,e.dateFormat):"boolean"==typeof n&&(n=new rb(n)),t.convertEmptyValueToEmptyString&&(n=t.processValue(n)),{value:n,type:"number"===(null===(o=i[r])||void 0===o?void 0:o.type)?"number":"string"}}))})),columns:i.map((function(e){var t=e.field,n=e.value,r=e.width;e.type;return"string",{field:t,value:n,width:r,type:"string"}}))}}},{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=t.zipcelx||window.zipcelx;if(!n)throw new Error('ExcelExporter: "zipcelx" library is required');if(!t.disabled){(e=Qn.assign({},t.config,e)).filename||(e.filename=t.client.$$name);var r=e,i=r.filename,o=t.generateExportData(e),a=o.rows,s=o.columns;n({filename:i,sheet:{data:[s].concat(a),cols:s}})}}},{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),this.zipcelx||"undefined"!=typeof zipcelx&&(this.zipcelx=window.zipcelx)}},{key:"exporter",get:function(){var e=this;return e._exporter||(e._exporter=e.exporterClass.new({target:e.client},e.exporterConfig))}}],[{key:"$name",get:function(){return"ExcelExporter"}},{key:"defaultConfig",get:function(){return{filename:null,dateFormat:"YYYY-MM-DD",exporterClass:nb,exporterConfig:null,zipcelx:null,convertEmptyValueToEmptyString:!0}}}]),n}(_i);function ab(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ob._$name="ExcelExporter",ty.registerFeature(ob,!1,"Grid");var sb=function(e){Ye()(n,e);var t=ab(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){Object.assign(this,{_elements:{},_elementsArray:[],_cells:{},_allCells:[],_regions:[],lastHeight:0,lastTop:-1,_dataIndex:0,_top:0,_height:0,_id:null,forceInnerHTML:!1,isGroupFooter:!1},e),tt()(Ze()(n.prototype),"construct",this).call(this)}},{key:"doDestroy",value:function(){var e=this;e.rowManager.isDestroying||(e.removeElements(),e.rowManager.idMap[e.id]===e&&delete e.rowManager.idMap[e.id]),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"dataIndex",get:function(){return this._dataIndex},set:function(e){this._dataIndex!==e&&(this._dataIndex=e,this.eachElement((function(t){return t.dataset.index=e})))}},{key:"id",get:function(){return this._id},set:function(e){var t=this,n={id:e},r=t.rowManager.idMap;t._id===e&&r[e]===t||(r[t._id]===t&&delete r[t._id],r[e]=t,t._id=e,t.eachElement((function(t){ls.assign(t,n),t.dataset.id=e})),t.eachCell((function(e){return ls.assign(e,n)})))}},{key:"addElement",value:function(e,t){var n=this,r=t.firstElementChild;for(n._elements[e]=t,n._elementsArray.push(t),n._regions.push(e),ls.assign(t,{index:n.index}),n._cells[e]=[];r;)n._cells[e].push(r),n._allCells.push(r),ls.set(r,{column:r.dataset.column,columnId:r.dataset.columnId,rowElement:r.parentNode,row:n}),r=r.nextElementSibling;t.dataset.index=n.index}},{key:"getElement",value:function(e){return this._elements[e]}},{key:"eachElement",value:function(e){this._elementsArray.forEach(e)}},{key:"eachCell",value:function(e){this._allCells.forEach(e)}},{key:"elements",get:function(){return this._elements}},{key:"cells",get:function(){return this._allCells}},{key:"getCells",value:function(e){return this._cells[e]}},{key:"getCell",value:function(e){return this._allCells.find((function(t){var n=ls.get(t);return n.columnId===e||n.column===e}))}},{key:"removeElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.rowManager.trigger("removeRow",{row:t}),e||t.eachElement((function(e){return e.remove()})),t._elements={},t._cells={},t._elementsArray.length=t._regions.length=t._allCells.length=t.lastHeight=t.height=0,t.lastTop=-1}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"offsetHeight",get:function(){return this.height+this.grid._rowBorderHeight}},{key:"updateElementsHeight",value:function(){var e=this;e.rowManager.storeKnownHeight(e.id,e.height),e.lastHeight!==e.height&&(this.eachElement((function(t){return t.style.height="".concat(e.offsetHeight,"px")})),e.lastHeight=e.height)}},{key:"addCls",value:function(e){this.updateCls(this.cls.add(e))}},{key:"removeCls",value:function(e){this.updateCls(this.cls.remove(e))}},{key:"assignCls",value:function(e){this.updateCls(this.cls.assign(e))}},{key:"changeCls",value:function(e){return null!=e&&e.isDomClassList?e:new xr(e)}},{key:"updateCls",value:function(e){this.eachElement((function(t){return mi.syncClassList(t,e)}))}},{key:"isFirst",get:function(){return 0===this.dataIndex}},{key:"top",get:function(){return this._top}},{key:"bottom",get:function(){return this._top+this._height+this.grid._rowBorderHeight}},{key:"setTop",value:function(e,t){this._top!==e&&(this._top=e,this.translateElements(t))}},{key:"setBottom",value:function(e,t){this.setTop(e-this.offsetHeight,t)}},{key:"translateElements",value:function(e){var t=this,n=t.grid.positionMode;t.lastTop!==t.top&&(t.eachElement((function(e){var r=e.style;"translate"===n?r.transform="translate(0,".concat(t.top,"px)"):"translate3d"===n?r.transform="translate3d(0,".concat(t.top,"px,0)"):"position"===n&&(r.top="".concat(t.top,"px"))})),e||t.rowManager.trigger("translateRow",{row:t}),t.lastTop=t.top)}},{key:"offset",value:function(e){var t=this._top+e;return t<0&&(e-=t,t=0),this.setTop(t),e}},{key:"render",value:function(e,t){var n,r,i,o,a,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=this,c=u.cls,f=u.cells,d=u.grid,h=u.rowManager,v=u.height,p=u._id,g=ls.get(u._elementsArray[0]),y=h._rowHeight,m=0;t||!1===t||(t=d.store.getById(g.id),e=d.store.indexOf(t));var b=null===(n=t)||void 0===n?void 0:n.cls,k=b?b.isDomClassList?b:new xr(b):null;c.assign({"b-grid-row-updating":s&&d.transitionDuration,"b-selected":d.isSelected(null===(r=t)||void 0===r?void 0:r.id)}),u.lastRecordCls&&c.remove(u.lastRecordCls),k?(c.add(k),u.lastRecordCls=Object.assign({},k)):u.lastRecordCls=null,u.updateCls(c),h.trigger("beforeRenderRow",{row:u,record:t,recordIndex:e,oldId:p}),s&&d.transitionDuration&&u.setTimeout((function(){c.remove("b-grid-row-updating"),u.updateCls(c)}),d.transitionDuration),u.id=t.id,u.dataIndex=e;var w=!d.fixedRowHeight&&d.getRowHeight(t)||y,C=u.maxRequestedHeight=null;for(m=0;m<f.length;m++)o=f[m],a=u.renderCell({cellElement:o,record:t,height:w,maxRequestedHeight:C,updatingSingleRow:s}),h.fixedRowHeight||null!=a.height&&(u.maxRequestedHeight=C=Math.max(C,a.height));u.height=null!==(i=C)&&void 0!==i?i:w,u.updateElementsHeight(),s&&(v!==u.height&&h.translateFromRow(u,l),h.trigger("updateRow",{row:u,record:t,recordIndex:e,oldId:p}),h.trigger("renderDone")),h.trigger("renderRow",{row:u,record:t,recordIndex:e,oldId:p}),u.forceInnerHTML=!1}},{key:"renderCell",value:function(e){var t,n,r=e.cellElement,i=e.record,o=e.height,a=e.maxRequestedHeight,s=e.updatingSingleRow,l=void 0===s||s,u=e.isMeasuring,c=void 0!==u&&u,f=this,d=f.grid,h=ls.get(r),v=d.columns.getById(h.columnId),p=h.rowElement,g=ls.get(p),y=v.internalCellCls,m=v.cellCls,b=v.align,k=v.renderer,w=v.defaultRenderer,C={columnId:v.id,id:g.id};if(!i){if(null===g.id)return void(r.className="b-grid-cell");if(!(i=d.store.getById(g.id)))return}var R=v.getRawValue(i),S=i.fieldMap[v.field],x={configuredHeight:o,height:null,maxRequestedHeight:a},E={cellElement:r,dataField:S,rowElement:p,value:R,record:i,column:v,size:x,grid:d,row:h.row,updatingSingleRow:l,isMeasuring:c},D=(t={"b-grid-cell":1},Qe()(t,y,y),Qe()(t,m,i.isSpecialRow&&"b-check-cell"===v.internalCellCls?void 0:m),Qe()(t,"b-cell-dirty",i.isFieldModified(v.field)),Qe()(t,"b-grid-cell-align-".concat(b),b),Qe()(t,"b-selected",d.isSelected(C)),Qe()(t,"b-focused",d.isFocused(C)),Qe()(t,"b-auto-height",v.autoHeight),t),T=k||w;mi.syncClassList(r,D);var O=!0;T?void 0===(R=T.call(v,E))&&(O=!1):S&&(R=S.print(R));var M=null===(n=d.hasFrameworkRenderer)||void 0===n?void 0:n.call(d,{cellContent:R,column:v});M&&i.isSpecialRow&&(R="");var A,P=M&&!v.data.tree&&!i.isSpecialRow;if(O&&!P){var F=null!=R&&"object"===I()(R),L="string"==typeof R,B=F||null==R?"":String(R);f.forceInnerHTML&&(r.innerHTML="",delete r._content,r.lastDomConfig=null),F||!v.htmlEncode||v.disableHtmlEncode?!v.autoSyncHtml||L&&!mi.getChildElementCount(r)?F?du.sync({targetElement:r,domConfig:{onlyChildren:!0,children:Array.isArray(R)?R:[R]}}):r._content!==B&&(r.innerHTML=r._content=B):L?mi.sync(B,r.firstElementChild):F&&du.sync({domConfig:R,targetElement:r}):pe.a.isLinux||r._hasHtml?(r.innerText=B,r._hasHtml=!1):mi.setInnerText(r,B)}i.isSpecialRow||(null===(A=d.processCellContent)||void 0===A||A.call(d,{cellElementData:h,rendererData:E,rendererHtml:E.rendererHtml||R}));return v.autoHeight&&null==x.height&&(r.classList.add("b-measuring-auto-height"),x.height=r.offsetHeight,r.classList.remove("b-measuring-auto-height")),c||f.rowManager.trigger("renderCell",E),x}}],[{key:"configurable",get:function(){return{cls:{$config:{equal:function(e,t){return(null==e?void 0:e.isDomClassList)&&(null==t?void 0:t.isDomClassList)&&e.isEqual(t)}},value:"b-grid-row"}}}}]),n}(el($e));function lb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}sb._$name="Row";var ub,cb,fb=function(e){Ye()(n,e);var t=lb(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"columns",get:function(){return this._columns||this.subGrid.columns},set:function(e){this._columns=e}},{key:"fixCellWidths",value:function(){var e,t=this,n=!1;t.columns.traverse((function(r){var i=t.getBarCellElement(r.id),o=mi.setLength(r.width),a=mi.setLength(r.minWidth);if(i){if(e=pe.a.isIE11?"calc(".concat(o," - ").concat(t.getLrPadding(i),"px)"):o,n=n||Boolean(r.flex),r.isParent&&null==r.width&&null==r.flex){var s=r.children.reduce((function(e,t){return e+(!t.hidden&&t.flex||0)}),0);i.style.flex=s>0?"".concat(s," 0 auto"):"",s>0&&r.traverse((function(e){return e.data.minWidth=null}))}else if(parseInt(r.minWidth)>=0&&(i.style.minWidth=a),i.style.flex=i.style.flexBasis=i.style.width="",r.flex)!isNaN(parseInt(r.flex))&&r.children?i.style.flex="".concat(r.flex," 0 auto"):i.style.flex=r.flex;else if(parseInt(r.width)>=0){var l=r.parent;!t.isHeader||l.isRoot||l.width?i.style.flexBasis=e:i.style.width=o}r.height>=0&&(i.style.height=mi.setLength(r.height))}})),t.element.classList[n?"add":"remove"]("b-has-flex")}},{key:"getLrPadding",value:function(e){if(!this.cellLrPadding){var t=e.ownerDocument.defaultView.getComputedStyle(e);this.cellLrPadding=parseInt(t.getPropertyValue("padding-left"))+parseInt(t.getPropertyValue("padding-right"))+parseInt(t.getPropertyValue("border-left-width"))+parseInt(t.getPropertyValue("border-right-width"))}return this.cellLrPadding}},{key:"getBarCellElement",value:function(e){return this.element.querySelector('[data-column-id="'.concat(e,'"]'))}}],[{key:"$name",get:function(){return"Bar"}},{key:"type",get:function(){return"gridbar"}},{key:"defaultConfig",get:function(){return{htmlCls:"",scrollable:{}}}}]),n}(uc);function db(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fb.initClass(),fb._$name="Bar";var hb=function(e){Ye()(n,e);var t=db(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"startConfigure",value:function(e){e.scrollable.overflowX="hidden-scroll",tt()(Ze()(n.prototype),"startConfigure",this).call(this,e)}},{key:"subGrid",get:function(){return this._subGrid},set:function(e){this._subGrid=this.owner=e}},{key:"refreshContent",value:function(){this.element.firstElementChild.innerHTML=this.contentTemplate(),this.fixFooterWidths()}},{key:"onPaint",value:function(e){e.firstPaint&&this.refreshContent()}},{key:"template",value:function(){var e=this.subGrid.region;return ud.tpl(ub||(ub=sv()(['\n            <div class="b-grid-footer-scroller b-grid-footer-scroller-','">\n                <div data-reference="footersElement" class="b-grid-footers b-grid-footers-','" data-region="','"></div>\n            </div>\n        '])),e,e,e)}},{key:"overflowElement",get:function(){return this.footersElement}},{key:"getFooter",value:function(e){return this.getBarCellElement(e)}},{key:"contentTemplate",value:function(){return this.columns.visibleColumns.map((function(e){return e.hidden?"":ud.tpl(cb||(cb=sv()(['\n                <div\n                    class="b-grid-footer '," ",'"\n                    data-column="','" data-column-id="','" data-all-index="','"\n                    >\n                    ',"\n                </div>"])),e.align?"b-grid-footer-align-".concat(e.align):"",e.cls||"",e.field||"",e.id,e.allIndex,e.footerText||"")})).join("")}},{key:"fixFooterWidths",value:function(){this.fixCellWidths()}}],[{key:"$name",get:function(){return"Footer"}},{key:"type",get:function(){return"gridfooter"}}]),n}(fb);function vb(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pb(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function pb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}hb.initClass(),hb._$name="Footer";var yb=function(e){Ye()(n,e);var t=gb(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){e.grid._rowManager=this,tt()(Ze()(n.prototype),"construct",this).call(this,e.grid,e)}},{key:"doDestroy",value:function(){this._rows.forEach((function(e){return e.destroy()})),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"initWithHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return n.autoHeight&&(e=n.store.allCount*n.preciseRowOffsetHeight),n.viewHeight=e,n.calculateRowCount(t),e}},{key:"reinitialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.calculateRowCount(!1,!0,!0),t.topIndex+t.rowCount-1>t.store.count&&(e=!0);var n=t.topRow&&!e?t.topRow.top:0;t.scrollTargetRecordId=null,e&&(t.topIndex=t.lastScrollTop=0);var r=t.topRow;r&&(r.dataIndex=t.topIndex,r.setTop(n,!0)),t.estimateTotalHeight(),t.renderFromRow(r)}},{key:"matchRowCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.rows,r=t.grid,i=n.length,o=i-t.rowCount;if(o)if(o<0){for(var a=[],s=i,l=i?n[i-1].dataIndex+1:0;s<t.rowCount;s++,l++)a.push(new sb({rowManager:t,grid:r,index:s,dataIndex:l}));n.push.apply(n,a),t.trigger("addRows",{rows:a}),e||t.renderFromRow(n[Math.max(0,i-1)])}else{var u=n.splice(i-o,o);t.trigger("removeRows",{rows:u}),u.forEach((function(e){return e.destroy()}))}}},{key:"calculateRowCount",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this,o=i.store,a=Math.ceil(i.viewHeight/i.minRowOffsetHeight),s=a+i.prependRowBuffer+i.appendRowBuffer;return null===(e=i.grid.columns)||void 0===e||!e.count||isNaN(a)?(i.rowCount=0,0):(s<i.rowCount&&!n||(i.visibleRowCount=a,i.rowCount=Math.min(o.count,s),t||(i.rows&&i.rowCount!==i.rows.length?i.matchRowCount(r):i.rowCount||i.trigger("changeTotalHeight",{totalHeight:i.totalHeight}),i.grid.toggleEmptyText())),i.rowCount)}},{key:"removeAllRows",value:function(){var e=this,t=e.topRow,n=t?e.refreshDetails={topRowIndex:t.dataIndex,topRowTop:t.top}:e.refreshDetails,r=e.rows.slice();return e.trigger("removeRows",{rows:r}),e.rows.forEach((function(e){return e.destroy()})),e.rows.length=0,e.idMap={},n}},{key:"setPosition",value:function(e){var t=this.topRow,n=e.topRowIndex,r=e.topRowTop;t.setTop(r),t.dataIndex=n}},{key:"store",get:function(){return this.client.store}},{key:"rows",get:function(){return this._rows}},{key:"getRow",value:function(e){return this.rowCount&&this.rows[e-this.topIndex]}},{key:"getRowById",value:function(e){return e&&e.isModel&&(e=e.id),this.idMap[e]}},{key:"getRowFromElement",value:function(e){return(e=e.closest(".b-grid-row"))&&this.getRow(e.dataset.index)}},{key:"getRowAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t||(e-=Cr.from(this.grid.bodyContainer,null,!0).roundPx(1).top,e+=this.grid.scrollable.y),e=mi.roundPx(e),this.rows.find((function(t){return e>=t.top&&e<t.bottom}))}},{key:"getRowFor",value:function(e){return e instanceof HTMLElement?this.getRowFromElement(e):this.getRowById(e)}},{key:"getNextRow",value:function(e){var t="number"==typeof e?e:e.index;return this.getRow((t+1)%this.rowCount)}},{key:"topRow",get:function(){return this.rows[0]}},{key:"bottomRow",get:function(){var e=Math.min(this.rowCount,this.store.count);return this.rows[e-1]}},{key:"firstVisibleRow",get:function(){var e=this;return this.rows.find((function(t){return t.bottom>e.grid.scrollable.y}))}},{key:"firstFullyVisibleRow",get:function(){var e=this;return this.rows.find((function(t){return t.top>=e.grid.scrollable.y}))}},{key:"lastVisibleRow",get:function(){var e=this.grid;return it.findLast(this.rows,(function(t){return t.top<e.scrollable.y+e.bodyHeight}))}},{key:"offsetRows",value:function(e){if(0!==e)for(var t=this.rows,n=t.length,r=0;r<n;r++)t[r].offset(e);this.trigger("offsetRows",{offset:e})}},{key:"prependBufferHeight",get:function(){return this.prependRowBuffer*this.rowOffsetHeight}},{key:"appendBufferHeight",get:function(){return this.appendRowBuffer*this.rowOffsetHeight}},{key:"rowHeight",get:function(){return this._rowHeight},set:function(e){var t=this,n=t.grid,r=t.fixedRowHeight,i=t.rowHeight;if(Qn.assertNumber(e,"rowHeight"),e<10&&(e=10),t.trigger("beforeRowHeight",{height:e}),t.minRowHeight=t._rowHeight=e,r&&(t.averageRowHeight=e),t.rows.length){var o,a,s=n.scrollable.y,l=t.getRowAt(s,!0),u=l?l.top-s:0;r?(o=e,a=i):(a=o=t.averageRowHeight,t.clearKnownHeights(),o*=e/i),t.calculateRowCount(!1,!0,!0),t.topRow.setTop(t.topRow.dataIndex*(o+n._rowBorderHeight),!0),t.refresh(),s*(o/a)!==s&&n.scrollRowIntoView(l.id,{block:"start",edgeOffset:u})}t.trigger("rowHeight",{height:e})}},{key:"rowOffsetHeight",get:function(){return Math.floor(this.preciseRowOffsetHeight)}},{key:"preciseRowOffsetHeight",get:function(){return(this.averageRowHeight||this._rowHeight)+this.grid._rowBorderHeight}},{key:"minRowOffsetHeight",get:function(){return(this.minRowHeight||this._rowHeight)+this.grid._rowBorderHeight}},{key:"allHeightsKnown",get:function(){return this.fixedRowHeight||this.heightMap.size>=this.store.count}},{key:"storeKnownHeight",value:function(e,t){var n=this,r=n.heightMap;n.fixedRowHeight||(r.has(e)&&(n.totalKnownHeight-=r.get(e)),r.set(e,t),n.totalKnownHeight+=t,t<n.minRowHeight&&(n.minRowHeight=t),n.averageRowHeight=n.totalKnownHeight/r.size)}},{key:"getOffsetHeight",value:function(e){var t=this;return(t.heightMap.get(e.id)||t.grid.getRowHeight(e)||t.averageRowHeight||t.rowHeight)+t.grid._rowBorderHeight}},{key:"invalidateKnownHeight",value:function(e){var t=this;if(!t.fixedRowHeight){var n=t.heightMap;Array.isArray(e)||(e=[e]),e.forEach((function(e){e&&n.has(e.id)&&(t.totalKnownHeight-=n.get(e.id),n.delete(e.id))})),t.averageRowHeight=t.totalKnownHeight/n.size}}},{key:"clearKnownHeights",value:function(){this.heightMap.clear(),this.averageRowHeight=this.totalKnownHeight=0}},{key:"calculateTop",value:function(e){if(this.fixedRowHeight)return e*this.rowOffsetHeight;for(var t=this.store,n=0,r=0;r<e;r++){var i=t.getAt(r);n+=this.getOffsetHeight(i)}return Math.floor(n)}},{key:"getRecordCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i="string"==typeof e||"number"==typeof e?e:e.id,o=r.getRowById(e),a=r.client._bodyRectangle;return t||(a=r.client._bodyRectangle=Cr.client(r.client.bodyContainer)),o?new Cr(a.x,t?Math.round(o.top):Math.round(o.top+a.y-r.client.scrollable.y),a.width,o.offsetHeight):r.getRecordCoordsByIndex(r.store.indexOf(i),t,n)}},{key:"getRecordCoordsByIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.topRow,o=r.bottomRow,a=r.client._bodyRectangle,s=r.store.getAt(e),l=s.id,u=r.preciseRowOffsetHeight,c=i.dataIndex,f=o.dataIndex,d=e>f?{index:e-f-1,y:o.bottom,from:"bottomRow"}:e>c/2?{index:e-c,y:i.top,from:"topRow"}:{index:e,y:0,from:"top"},h=r.allHeightsKnown&&!n?r.calculateTop(e):Math.floor(d.y+d.index*u),v=new Cr(a.x,t?h:h+a.y-r.client.scrollable.y,a.width,Math.floor(r.heightMap.get(l)||u));return v.virtual=!0,v.block=v.bottom<a.y?"start":v.y>a.bottom?"end":"nearest",v}},{key:"totalHeight",get:function(){return this._totalHeight}},{key:"forEach",value:function(e){this.rows.forEach(e)}},{key:Symbol.iterator,value:function(){return this.rows[Symbol.iterator]()}},{key:"refreshCell",value:function(e,t){var n=this.getRowFor(e);if(n){var r=n.getCell(t);if(r)return n.renderCell({cellElement:r}),!0}return!1}},{key:"returnToTop",value:function(){var e=this;e.topIndex=0,e.lastScrollTop=0,e.topRow&&(e.topRow.dataIndex=0,e.topRow.setTop(0,!0)),e.refresh(),e.grid.scrollable.y=0}},{key:"renderFromRecord",value:function(e){var t=this.getRowById(e.id);t&&this.renderFromRow(t)}},{key:"renderFromRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t.rows,r=t.store,i=r.count;if(0!==t.calculateRowCount(!1,i<n.length,!0)){for(var o,a=e?n.indexOf(e):0,s=e?e.dataIndex:n[0].dataIndex,l=i-s-1,u=Math.min(n.length-1,a+l),c=n.length-u-1,f=a>0?n[a-1].bottom:n[a].top,d=a;d<=u;d++)(o=n[d]).dataIndex=s,o.setTop(f,!0),o.render(s,r.getAt(s++),!1),f+=o.offsetHeight;for(;c-- >0;)t.displayRecordAtTop();t.bottomRow.bottom<t.viewHeight&&t.calculateRowCount(),t.estimateTotalHeight(!0),t.trigger("renderDone")}}},{key:"renderRows",value:function(e){var t,n=!1;(e=Array.from(e)).sort((function(e,t){return e.dataIndex-t.dataIndex}));var r,i=vb(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o.height,o.render(null,null,!1),n|=o.height!==t}}catch(e){i.e(e)}finally{i.f()}n&&this.translateFromRow(e[0]),this.trigger("renderDone")}},{key:"translateFromRow",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this,o=e.bottom;for(n=e.dataIndex+1,t=i.getRow(n);t;t=i.getRow(++n))t.setTop(o),o+=t.offsetHeight;r||i.estimateTotalHeight(!0)}},{key:"refresh",value:function(){var e=this,t=e.topRow;t&&(e.idMap={},e.renderFromRow(t),e.trigger("refresh"))}},{key:"jumpToPosition",value:function(e,t){var n=this,r=n.store,i=n.heightMap,o=r.count;if(n.allHeightsKnown&&!n.fixedRowHeight){for(var a=e-n.prependBufferHeight,s=n.grid._rowBorderHeight,l=0,u=0;l<a;){var c=r.getAt(u);l+=i.get(c.id)+s,u++}var f=Math.max(Math.min(u,o-n.rowCount),0);n.lastScrollTop=e,n.topRow.dataIndex=n.topIndex=f,n.topRow.setTop(n.calculateTop(f),!1),n.refresh()}else{var d=n.preciseRowOffsetHeight,h=null==t?Math.floor(e/d)-n.prependRowBuffer:t-Math.floor(n.rowCount/2),v=Math.max(Math.min(h,o-n.rowCount),0),p=n.client.scrollable.y,g=Math.min(n.client._bodyRectangle.height+p+n.appendBufferHeight,n.totalHeight);if(n.lastScrollTop=e,n.topRow.dataIndex=n.topIndex=v,n.topRow.setTop(Math.floor(v*d),!1),n.refresh(),n.bottomRow.bottom<g)for(n.calculateRowCount(!1,!1,!1);n.bottomRow.bottom<g&&n._rows[n.prependRowBuffer].top<p&&n.bottomRow.dataIndex<o-1;)n.displayRecordAtBottom();n.estimateTotalHeight()}if(null!=t){var y=n.grid.scrollable,m=n.getRow(t),b=m&&Cr.from(m._elementsArray[0]).center.y,k=y.viewport.center.y;m&&(y.y=e=Math.floor(y.y+(b-k)))}return e}},{key:"warpIfNeeded",value:function(e){var t,n=this,r={newScrollTop:e,deltaTop:e-n.lastScrollTop};Math.abs(r.deltaTop)>n.rowCount*n.rowOffsetHeight*3&&(n.scrollTargetRecordId&&(t=n.store.indexOf(n.scrollTargetRecordId)),r.newScrollTop=n.jumpToPosition(e,t),r.deltaTop=0);return r}},{key:"updateRenderedRows",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.client._bodyRectangle;if(0===r.rowCount)return 0;var o=r.totalHeight;if(t||Math.abs(e-r.lastScrollTop)>=r.rowOffsetHeight||r.topRow.top>e||r.bottomRow.bottom<e+i.height){var a=r.warpIfNeeded(e);r.scrollTargetRecordId=null,r.lastScrollTop=a.newScrollTop,a.deltaTop>0?r.fillBelow(a.newScrollTop):a.deltaTop<0&&r.fillAbove(a.newScrollTop),r.fixedRowHeight||n||r.correctError(a,i,e),o=r.estimateTotalHeight()}return o}},{key:"correctError",value:function(e,t,n){var r=this,i=0;(r.allHeightsKnown||e.deltaTop<0&&n<2*t.height||e.deltaTop>0&&n>r.totalHeight-2*t.height-3)&&(i=r.topRow.top-r.calculateTop(r.topRow.dataIndex)),i&&(r.offsetRows(-i),r.grid.scrollable.y=r.lastScrollTop=r.grid.scrollable.y-i)}},{key:"fillAbove",value:function(e){for(var t=this,n=e-t.topRow.top-t.prependBufferHeight,r=0;r>n&&t.topIndex>0;)r-=t.displayRecordAtTop();t.trigger("renderDone")}},{key:"fillBelow",value:function(e){for(var t=this,n=e-t.topRow.top-t.prependBufferHeight,r=t.store.count,i=t.rowCount,o=0;o<n&&t.topIndex+i<r&&t.topRow.top+t.topRow.offsetHeight<e;)o+=t.displayRecordAtBottom();t.trigger("renderDone")}},{key:"estimateTotalHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(!t.grid.renderingRows){var n,r=t.store.count,i=r-t.heightMap.size,o=t.bottomRow;if(t.fixedRowHeight)n=r*t.rowOffsetHeight;else{if(n=t.totalKnownHeight+t.heightMap.size*t.grid._rowBorderHeight+i*t.preciseRowOffsetHeight,o&&i){var a=o.bottom;(a>n||t.topIndex+t.rowCount>=r&&n>a&&a>0)&&(n=a,o.dataIndex<r-1&&(n+=(r-1-o.dataIndex)*t.preciseRowOffsetHeight))}n=Math.floor(n)}return n!==t.totalHeight&&!1!==t.trigger("changeTotalHeight",{totalHeight:n,immediate:e})&&(t._totalHeight=n),n}}},{key:"displayRecordAtTop",value:function(){var e=this,t=e.topIndex-1,n=e.store.getAt(t),r=e.bottomRow,i=r.top;return e.trigger("beforeTranslateRow",{row:r,newRecord:n}),r._top=e.topRow.top-e.getOffsetHeight(n),r.estimatedTop=!e.fixedRowHeight,r.render(t,n,!1),r._top=i,r.setBottom(e.topRow.top),r.estimatedTop=!1,e.topIndex--,e._rows.unshift(e._rows.pop()),r.offsetHeight}},{key:"displayRecordAtBottom",value:function(){var e=this,t=e.topIndex+e.rowCount,n=e.store.getAt(t),r=e.topRow;return e.trigger("beforeTranslateRow",{row:r,newRecord:n}),r.dataIndex=t,r.setTop(e.bottomRow.bottom),r.render(t,n,!1),e.topIndex++,e._rows.push(e._rows.shift()),r.offsetHeight}}],[{key:"pluginConfig",get:function(){return{chain:["getRowById","getRecordCoords","getRow","getRowFor","getRowFromElement","destroy"],assign:["rowHeight","topRow","bottomRow","firstVisibleRow","lastVisibleRow","firstFullyVisibleRow"]}}},{key:"defaultConfig",get:function(){return{prependRowBuffer:5,appendRowBuffer:5,rowHeight:null,fixedRowHeight:null,autoHeight:!1}}},{key:"properties",get:function(){return{idMap:{},topIndex:0,lastScrollTop:0,_rows:[],heightMap:new Map,totalKnownHeight:0,_totalHeight:0,averageRowHeight:0,scrollTargetRecordId:null,refreshDetails:{topRowIndex:0,topRowTop:0}}}}]),n}(_i);function mb(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bb(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function bb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}yb.featureClass="",yb._$name="RowManager";var wb,Cb,Rb={x:1},Sb=function(e){Ye()(n,e);var t=kb(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"addScroller",value:function(e){(this.xScrollers||(this.xScrollers=[])).push(e)}},{key:"addPartner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rb;"string"==typeof t&&(t=Qe()({},t,1)),t.x&&this.xScrollers.forEach((function(t,n){return t.addPartner(e.xScrollers[n],"x")})),t.y&&tt()(Ze()(n.prototype),"addPartner",this).call(this,e,"y")}},{key:"removePartner",value:function(e){this.xScrollers.forEach((function(t,n){t.isDestroyed||t.removePartner(e.xScrollers[n])})),tt()(Ze()(n.prototype),"removePartner",this).call(this,e)}},{key:"updateOverflowX",value:function(e){this.xScrollers&&this.xScrollers.forEach((function(t){return t.overflowX=e})),this.widget.virtualScrollers.classList[!1===e?"add":"remove"]("b-hide-display")}},{key:"scrollIntoView",value:function(e,t){if(e.nodeType!==Element.ELEMENT_NODE)return tt()(Ze()(n.prototype),"scrollIntoView",this).call(this,e,t);var r,i=mb(this.xScrollers);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.element.contains(e))return o.scrollIntoView(e,t)}}catch(e){i.e(e)}finally{i.f()}}},{key:"x",get:function(){return this.xScrollers?this.xScrollers[0].x:0},set:function(e){this.xScrollers&&(this.xScrollers[0].x=e)}}]),n}(ju);function xb(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Eb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Eb(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Eb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Db(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Sb._$name="GridScroller";var Tb=function(e){Ye()(n,e);var t=Db(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"startConfigure",value:function(e){e.scrollable.overflowX="hidden-scroll",tt()(Ze()(n.prototype),"startConfigure",this).call(this,e)}},{key:"subGrid",get:function(){return this._subGrid},set:function(e){this._subGrid=this.owner=e}},{key:"region",get:function(){return this.subGrid&&this.subGrid.region}},{key:"template",value:function(){var e=this.region;return ud.tpl(wb||(wb=sv()(['\n            <div class="b-grid-header-scroller b-grid-header-scroller-','">\n                <div data-reference="headersElement" class="b-grid-headers b-grid-headers-','" data-region="','" data-max-depth="','" data-reference="headersElement"></div>\n            </div>\n        '])),e,e,e,this.maxDepth)}},{key:"overflowElement",get:function(){return this.headersElement}},{key:"contentTemplate",value:function(e){var t=this;return e.hidden?"":ud.tpl(Cb||(Cb=sv()(['\n                <div class="b-grid-header" data-column="','" data-column-id="','" '," ",'>\n                    <div class="b-grid-header-text">\n                        <div class="b-grid-header-text-content"></div>\n                    </div>\n                    ','\n                    <div class="b-grid-header-resize-handle"></div>\n                </div>\n            '])),e.field||"",e.id,e.isFocusable?'tabindex="0"':"",e.tooltip?'data-btip="'.concat(e.tooltip,'"'):"",e.children?'\n                    <div class="b-grid-header-children">\n                            '.concat(e.children.map((function(e){return t.contentTemplate(e)})).join(""),"\n                    </div>\n                    "):"")}},{key:"calculateMinWidthForSafari",value:function(){var e=0;return this.columns.visibleColumns.forEach((function(t){e+=t.calculateMinWidth()})),e}},{key:"fixHeaderWidths",value:function(){this.fixCellWidths()}},{key:"refreshHeaders",value:function(){var e=this;e.columns.traverse((function(t){var n=e.getBarCellElement(t.id);if(n){var r,i=new xr((r={"b-grid-header":1,"b-grid-header-parent":t.isParent},Qe()(r,"b-level-".concat(t.childLevel),1),Qe()(r,"b-depth-".concat(t.meta.depth),1),Qe()(r,"b-grid-header-align-".concat(t.align),t.align),Qe()(r,"b-grid-header-resizable",t.resizable&&t.isLeaf),Qe()(r,t.cls,t.cls),Qe()(r,"b-last-parent",t.isParent&&t.isLastInSubGrid),Qe()(r,"b-last-leaf",t.isLeaf&&t.isLastInSubGrid),r)),o=t.headerText;n.className=i,t.headerRenderer&&(o=t.headerRenderer.call(t.thisObj||e,{column:t,headerElement:n})),t.icon&&(o='<i class="'.concat(te.encodeHtml(t.icon),'"></i>')+(o||""));var a=n.querySelector(".b-grid-header-text-content");a&&(a.innerHTML=o||"")}})),e.fixHeaderWidths()}},{key:"columns",get:function(){var e=this,t=tt()(Ze()(n.prototype),"columns",this);return e.columnsDetacher||(e.columnsDetacher=t.on({change:function(){e.initDepths()},thisObj:e}),e.initDepths()),t},set:function(e){gh()(Ze()(n.prototype),"columns",e,this,!0)}},{key:"initDepths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.columns.topColumns,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=0;t&&t.meta&&t.meta.depth++;var i,o=xb(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.meta.depth=0,a.children&&(n.initDepths(a.children.filter(n.columns.chainedFilterFn),a),a.meta.depth&&t&&(t.meta.depth+=a.meta.depth)),a.meta.depth>r&&(r=a.meta.depth)}}catch(e){o.e(e)}finally{o.f()}return t||(n.maxDepth=r),r}},{key:"getHeader",value:function(e){return this.getBarCellElement(e)}},{key:"contentElement",get:function(){return this.element.firstElementChild}},{key:"refreshContent",value:function(){var e=this;e.content=e.columns.topColumns.map((function(t){return e.contentTemplate(t)})).join(""),e.refreshHeaders()}},{key:"onPaint",value:function(e){e.firstPaint&&this.refreshContent()}}],[{key:"$name",get:function(){return"Header"}},{key:"type",get:function(){return"gridheader"}}]),n}(fb);function Ob(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Tb.initClass(),Tb._$name="Header";var Mb={touchstart:"onElementTouchStart",touchmove:"onElementTouchMove",touchend:"onElementTouchEnd",mouseover:"onElementMouseOver",mouseout:"onElementMouseOut",mousedown:"onElementMouseDown",mousemove:"onElementMouseMove",mouseup:"onElementMouseUp",click:"onHandleElementClick",dblclick:"onElementDblClick",keydown:"onElementKeyDown",keyup:"onElementKeyUp",keypress:"onElementKeyPress",contextmenu:"onElementContextMenu"},Ab=function(e){return function(e){Ye()(n,e);var t=Ob(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"initInternalEvents",value:function(){for(var e=Object.keys(Mb),t=e.length,n={element:this.bodyElement,thisObj:this},r=0;r<t;r++)n[e[r]]="handleEvent";Tu.on(n),Tu.on({focus:"onGridElementFocus",element:this.focusElement,thisObj:this})}},{key:"getCellDataFromEvent",value:function(e){var t=mi.up(e.target,".b-grid-cell");if(t){var n=ls.get(t),r=n.id,i=n.columnId,o=this.store.getById(r),a=this.columns.getById(i);return o?{cellElement:t,cellData:n,columnId:i,id:r,record:o,column:a,cellSelector:{id:r,columnId:i}}:null}}},{key:"getHeaderDataFromEvent",value:function(e){var t=mi.up(e.target,".b-grid-header");if(t){var n=Qn.assign({},t.dataset),r=n.columnId,i=this.columns.getById(r);return i?{headerElement:t,headerData:n,columnId:r,column:i}:null}}},{key:"handleEvent",value:function(e){this.disabled||Mb[e.type]&&this[Mb[e.type]](e)}},{key:"onElementTouchStart",value:function(e){var t=this,n=t.getCellDataFromEvent(e);mi.isTouchEvent=!0,1===e.touches.length&&(t.longPressTimeout=t.setTimeout((function(){t.onElementLongPress(e),e.preventDefault(),t.longPressPerformed=!0}),t.longPressTime)),n&&!e.defaultPrevented&&t.onFocusGesture(n,e)}},{key:"onElementTouchMove",value:function(e){var t=this;t.longPressTimeout&&(t.clearTimeout(t.longPressTimeout),t.longPressTimeout=null)}},{key:"onElementTouchEnd",value:function(e){var t=this;t.longPressPerformed&&(e.cancelable&&e.preventDefault(),t.longPressPerformed=!1),t.longPressTimeout&&(t.clearTimeout(t.longPressTimeout),t.longPressTimeout=null)}},{key:"onElementLongPress",value:function(e){}},{key:"triggerCellMouseEvent",value:function(e,t){var n=this,r=n.getCellDataFromEvent(t);if(r){var i,o=n.columns.getById(r.columnId),a={grid:n,record:r.record,column:o,cellSelector:r.cellSelector,cellElement:r.cellElement,target:t.target,event:t};if(n.trigger("cell"+te.capitalize(e),a),"click"===e)null===(i=o.onCellClick)||void 0===i||i.call(o,a)}}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.getCellDataFromEvent(e);t.skipFocusSelection=!0,t.isScrollbarClick(e)?e.preventDefault():(t.triggerCellMouseEvent("mousedown",e),n&&!e.defaultPrevented&&t.onFocusGesture(n,e))}},{key:"isScrollbarClick",value:function(e){var t=e.target,n=e.x,r=e.y;return t.matches(".b-vertical-overflow")?n>t.getBoundingClientRect().right-mi.scrollBarWidth:t.matches(".b-horizontal-overflow")?r>t.getBoundingClientRect().bottom-mi.scrollBarWidth:void 0}},{key:"onElementMouseMove",value:function(e){this.mouseMoveEvent=e}},{key:"onElementMouseUp",value:function(e){}},{key:"onHandleElementClick",value:function(e){!1!==this.trigger("beforeElementClick",{event:e})&&this.onElementClick(e)}},{key:"onElementClick",value:function(e){var t=this.getCellDataFromEvent(e);t&&(this.triggerCellMouseEvent("click",e),ls.get(t.cellElement).row.removeCls("b-hover"))}},{key:"onFocusGesture",value:function(e,t){e&&!t.target.matches(".b-icon-tree-expand, .b-icon-tree-collapse")&&this.focusCell(e.cellSelector,{scroll:!1,doSelect:!0,event:t})}},{key:"onElementDblClick",value:function(e){var t=e.target;if(this.triggerCellMouseEvent("dblClick",e),t.classList.contains("b-grid-header-resize-handle")){var n=mi.up(t,".b-grid-header");this.columns.getById(n.dataset.columnId).resizeToFitContent()}}},{key:"onElementMouseOver",value:function(e){if(!this.scrolling){var t=mi.up(e.target,".b-grid-cell");if(t){var n=ls.get(t).row;!n||"number"==typeof e.buttons&&0!==e.buttons||(this.hoveredRow=n),this.triggerCellMouseEvent("mouseOver",e)}this.trigger("mouseOver",{event:e})}}},{key:"onElementMouseOut",value:function(e){(this.hoveredRow=null,this.scrolling)||(mi.up(e.target,".b-grid-cell")&&this.triggerCellMouseEvent("mouseOut",e),this.trigger("mouseOut",{event:e}))}},{key:"hoveredRow",set:function(e){var t=this;t._hoveredRow&&!t._hoveredRow.isDestroyed&&(t._hoveredRow.removeCls("b-hover"),t._hoveredRow=null),e&&!t.scrolling&&(t._hoveredRow=e,e.addCls("b-hover"))}},{key:"onElementKeyDown",value:function(e){var t,n=this,r=e.target,i=e.currentTarget,o=e.ctrlKey,a=e.key;if(!e.handled){var s=n.focusedCell,l=n.store.stm;if(l&&o&&"z"===a.toLowerCase()&&n.enableUndoRedoKeys&&(null===(t=n.features.cellEdit)||void 0===t||!t.isEditing)&&l.onUndoKeyPress(e),r.matches(".b-grid-header.b-depth-0"))n.handleHeaderKeyDown(e);else if(r===n.focusElement||pe.a.isIE11&&i===n.focusElement){if(n.handleViewKeyDown(e),s){var u,c=s.element,f=n.columns.getById(c.dataset.columnId);null===(u=f.onCellKeyDown)||void 0===u||u.call(f,{event:e,cellElement:c})," "===a&&f.onCellClick&&f.onCellClick({grid:n,column:f,record:n.store.getById(s.id),cellElement:c,target:r,event:e})}}else if("Escape"===a&&n.isActionableLocation){var d=Qn.clone(s);d.element=null,n.focusCell(d),mi.focusWithoutScrolling(n.element)}}}},{key:"handleViewKeyDown",value:function(e){var t=this;switch(e.key){case"ArrowLeft":return e.preventDefault(),t.navigateLeft(e);case"ArrowRight":return e.preventDefault(),t.navigateRight(e);case"ArrowUp":return e.preventDefault(),t.navigateUp(e);case"ArrowDown":return e.preventDefault(),t.navigateDown(e)}}},{key:"handleHeaderKeyDown",value:function(e){var t=this,n=t.columns.getById(e.target.dataset.columnId);switch(n.onKeyDown&&n.onKeyDown(e),e.key){case"ArrowLeft":t.onHeaderLeftKey(n);break;case"ArrowRight":t.onHeaderRightKey(n);break;case"ArrowDown":e.preventDefault(),t.onHeaderDownKey(n);break;case"Enter":t.onHeaderEnterKey(n)}}},{key:"onHeaderLeftKey",value:function(e){var t=this.columns.getAdjacentVisibleLeafColumn(e,!1);t&&this.getHeaderElement(t.id).focus()}},{key:"onHeaderRightKey",value:function(e){var t=this.columns.getAdjacentVisibleLeafColumn(e,!0);t&&this.getHeaderElement(t.id).focus()}},{key:"onHeaderDownKey",value:function(e){var t=this.firstFullyVisibleRow;t&&this.focusCell({columnId:e.id,id:t.id})}},{key:"onHeaderEnterKey",value:function(e){this.getHeaderElement(e.id).click()}},{key:"onElementKeyPress",value:function(e){}},{key:"onElementKeyUp",value:function(e){}},{key:"onElementContextMenu",value:function(e){var t=this,n=t.getCellDataFromEvent(e);n&&(t.triggerCellMouseEvent("contextMenu",e),mi.isTouchEvent&&t.onFocusGesture(n,e))}},{key:"onInternalResize",value:function(e,t,r,i,o){var a=this;a._devicePixelRatio&&a._devicePixelRatio!==window.devicePixelRatio&&mi.resetScrollBarWidth(),a._devicePixelRatio=window.devicePixelRatio,a._bodyRectangle=Cr.client(a.bodyContainer),tt()(Ze()(n.prototype),"onInternalResize",this).apply(this,arguments),r!==o&&(a._bodyHeight=a.bodyContainer.offsetHeight,a.isPainted&&a.rowManager.initWithHeight(a._bodyHeight)),a.refreshVirtualScrollbars(),t!==i&&a.setTimeout((function(){a.isDestroyed||a.updateResponsive(t,i)}),0)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridElementEvents"}},{key:"configurable",get:function(){return{longPressTime:400,enableUndoRedoKeys:!0}}}]),n}(e||$e)};function Ib(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Pb={string:1,object:1,function:1},Fb=function(e){return function(e){Ye()(n,e);var t=Ib(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"features",get:function(){return this._features},set:function(e){var t=this,n=ty.getInstanceDefaultFeatures(this);e=t._features=Qn.assign({},e),n&&Object.keys(n).forEach((function(t){t in e||(e[t]=!0)}));for(var r=ty.getInstanceFeatures(this),i=0,o=Object.keys(e);i<o.length;i++){var a=o[i],s=e[a];if(s){var l=!window.__bryntum_code_editor_changed;if(te.uncapitalize(a)!==a){var u="Invalid feature name '".concat(a,"', must start with a lowercase letter");if(l)throw new Error(u);console.error(u),t._errorDuringConfiguration=u}var c=r[a];if(!c){var f="Feature '".concat(a,"' not available, make sure you have imported it");if(l)throw new Error(f);return console.error(f),void(t._errorDuringConfiguration=f)}Reflect.defineProperty(e,a,t.createFeatureInitializer(e,a,c,s))}}}},{key:"createFeatureInitializer",value:function(e,t,n,r){var i=[this],o=n.prototype.construct;return Pb[I()(r)]&&(i[1]=r),{configurable:!0,get:function(){return delete e[t],n.prototype.construct=function(){e[t]=this;for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];o.apply(this,i),n.prototype.construct=o},jt()(n,i)}}}},{key:"hasFeature",value:function(e){if(this.features){var t=Object.getOwnPropertyDescriptor(this.features,e);if(t)return Boolean(t.value||t.get)}return!1}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridFeatures"}}]),n}(e||$e)};function Lb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Bb=Object.freeze({doSelect:!0}),jb=Object.freeze({x:!1,y:!1});function _b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Hb=function(e){return function(e){Ye()(n,e);var t=_b(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getClosestBiggerLevel",value:function(e){var t=this,n=Object.keys(Qn.assign({},t.responsiveLevels)),r=null,i=99995,o=null;return n.forEach((function(n){var a=t.responsiveLevels[n];if(["number","string"].includes(I()(a))||(a=a.levelWidth),"*"===a)o=n;else if(e<a){var s=a-e;s<i&&(i=s,r=n)}})),r||o}},{key:"responsiveLevel",get:function(){return this.getClosestBiggerLevel(this.width)}},{key:"updateResponsive",value:function(e,t){var n=this,r=n.getClosestBiggerLevel(t),i=n.getClosestBiggerLevel(e);if(0===t||r!==i){var o=n.responsiveLevels[i];["number","string"].includes(I()(o))||n.applyState(o),n.columns.forEach((function(e){var t=e.responsiveLevels;t&&(t[i]?e.applyState(t[i]):t["*"]&&e.applyState(t["*"]))})),n.element.classList.remove("b-responsive-"+r),n.element.classList.add("b-responsive-"+i),n.trigger("responsive",{level:i,width:e,oldLevel:r,oldWidth:t})}}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridResponsive"}},{key:"defaultConfig",get:function(){return{responsiveLevels:Object.freeze({small:400,medium:600,large:"*"})}}}]),n}(e||$e)};function Nb(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return zb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zb(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function zb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Wb={string:1,number:1},$b={dataset:1,batch:1},Ub=function(e){return function(e){Ye()(n,e);var t=Vb(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"afterConfigure",value:function(){var e=this;if(e.selectionMode.checkbox){var t=bg.getColumnClass("check");if(!t)throw new Error("CheckColumn must be imported for checkbox selection mode to work");var r=e.checkboxColumn=new t({id:"".concat(e.id,"-selection-column"),width:"4em",minWidth:"4em",field:null,cellCls:"b-checkbox-selection",region:e.items[0].region,showCheckAll:e.selectionMode.showCheckAll},e.columns);r.isSelectionColumn=!0,r.meta.depth=0,r._grid=e;var i=r.renderer;r.renderer=function(t){t.value=e.isSelected(t.record),i.call(r,t)},r.on({toggle:"onCheckChange",toggleAll:"onCheckAllChange",thisObj:e});var o=e.columns.indexOf(e.columns.findRecord("type","rownumber"))+1;e.columns.insert(o,r)}tt()(Ze()(n.prototype),"afterConfigure",this).call(this)}},{key:"bindStore",value:function(e){var t;this.detachListeners("selectionStoreFilter"),e.on({name:"selectionStoreFilter",filter:"onStoreFilter",thisObj:this}),null===(t=tt()(Ze()(n.prototype),"bindStore",this))||void 0===t||t.call(this,e)}},{key:"unbindStore",value:function(e){this.detachListeners("selectionStoreFilter"),tt()(Ze()(n.prototype),"unbindStore",this).call(this,e)}},{key:"onStoreFilter",value:function(e){e.records;if(this.selectionMode.deselectFilteredOutRecords){var t=this.store.filtersFunction,n=this.selectedRecordCollection.values.filter((function(e){return!t(e)}));this.selectedRecordCollection.remove(n)}}},{key:"onStoreRecordIdChange",value:function(e){var t=e.record,r=e.oldValue;tt()(Ze()(n.prototype),"onStoreRecordIdChange",this)&&tt()(Ze()(n.prototype),"onStoreRecordIdChange",this).apply(this,arguments);var i=this.selectedRecordCollection.get(r);i===t&&this.selectedRecordCollection.rebuildIndices()}},{key:"onSelectedRecordCollectionChange",value:function(e){e.source,e.action;var t=e.added,n=void 0===t?[]:t,r=e.removed,i=this;i._selectedCell&&!i.isSelectable(i._selectedCell)&&i.deselectCell(i._selectedCell),n=n.filter((function(e){return i.isSelectable(e)})),i.triggerChangeEvent({mode:"row",action:n.length?"select":"deselect",selection:i.selectedRecords,selected:n,deselected:r},i.silent)}},{key:"onCheckChange",value:function(e){var t=e.source,n=e.checked,r=e.record,i=this,o=i.selectionMode,a=i.store,s=o.includeChildren&&!1!==o.multiSelect&&!r.isLeaf&&r.allChildren,l=[r].concat(F()(s||[]));n?(i.selectRows(l,!1!==o.multiSelect),t.headerCheckbox&&i.selectedRecords.length===a.count-(a.groupRecords?a.groupRecords.length:0)&&(t.suspendEvents(),t.headerCheckbox.checked=!0,t.resumeEvents())):(i.deselectRows(l),t.headerCheckbox&&(t.suspendEvents(),t.headerCheckbox.checked=!1,t.resumeEvents()))}},{key:"onCheckAllChange",value:function(e){this[e.checked?"selectAll":"deselectAll"](this.store.isPaged&&this.selectionMode.preserveSelectionOnPageChange)}},{key:"selectedRecordCollection",get:function(){return this._selectedRecordCollection},set:function(e){e instanceof na||(e=new na(e)),this._selectedRecordCollection=e,e.on({change:"onSelectedRecordCollectionChange",thisObj:this})}},{key:"spliceSelectedRecords",value:function(e,t,n){this._selectedRecordCollection.splice(e,t,n)}},{key:"isSelected",value:function(e){var t,n=this;return null!==(t=e)&&void 0!==t&&t.isModel&&(e=e.id),Wb[I()(e)]?n.selectedRecordCollection.includes(e):n._selectedCell&&n._selectedCell.id==e.id&&n._selectedCell.columnId===e.columnId}},{key:"isSelectable",value:function(e){if(!e)return!1;var t=this.store.getById(e.id||e);return t&&!(t.meta&&t.isSpecialRow)}},{key:"selectedCell",get:function(){return this._selectedCell},set:function(e){this.selectCell(e)}},{key:"selectionMode",get:function(){return this._selectionMode},set:function(e){e&&e.rowCheckboxSelection&&(e.row=e.checkbox=!0,e.cell=!1),this._selectionMode=e}},{key:"selectedRecord",get:function(){return this.selectedRecordCollection.last||null},set:function(e){this.selectRow({record:e})}},{key:"selectedRecords",get:function(){return this.selectedRecordCollection.values},set:function(e){this.selectRows(e)}},{key:"selectedCellCSSSelector",get:function(){var e=this._selectedCell,t=e&&this.getRowById(e.id);return e&&t?"[data-index=".concat(t.dataIndex,"] [data-column-id=").concat(e.columnId,"]"):""}},{key:"selectRow",value:function(e){var t=e.record,n=e.column,r=void 0===n?this.columns.visibleColumns[0]:n,i=e.scrollIntoView,o=void 0===i||i,a=e.addToSelection,s=void 0!==a&&a,l=this;(t=arguments[0].isModel?arguments[0]:l.store.getById(t))?l.selectCell({id:t.id,column:r},o,s):l.deselectAll()}},{key:"selectCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.selectedRecordCollection,a=i.selectionMode,s=i.normalizeCellContext(e),l=s.record||i.store.getById(s.id);if(i.isSelectable(l)){if(t&&i.scrollRowIntoView(s.id,{column:s.columnId}),a.row&&(r&&(i.silent=(i.silent||0)+1),n?o.add(l):o.splice(0,o.count,l),r&&i.silent--,1===i.selectedRecordCollection.count&&(i.startCell=s,i.lastRange=null)),a.cell&&(s.columnId||s.column)&&!i.isSelected(s)){var u=i._selectedCell?[i._selectedCell]:[];i._selectedCell=s,i.triggerChangeEvent({mode:"cell",action:"select",selected:[s],deselected:u,selection:[s]},r)}return s}i.deselectAll()}},{key:"selectAll",value:function(){var e,t=this;t.store.isFiltered&&!t.selectionMode.deselectFilteredOutRecords?(e=t.selectedRecordCollection).add.apply(e,F()(t.store.records.filter((function(e){return!e.isSpecialRow})))):t.selectRows(t.store.allRecords.filter((function(e){return!e.isSpecialRow})),!0)}},{key:"deselectAll",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this;t?(e=n.selectedRecordCollection).remove.apply(e,F()(n.store.records)):n.selectedRecordCollection.clear();n._selectedCell&&n.deselectCell(n._selectedCell)}},{key:"deselectRow",value:function(e){this.deselectRows(e)}},{key:"selectRows",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.store,i=[],o=Nb(e=Array.isArray(e)?e:null==e?[]:[e]);try{for(o.s();!(t=o.n()).done;){var a=t.value;(a=r.getById(a))&&i.push(a)}}catch(e){o.e(e)}finally{o.f()}n?this.selectedRecordCollection.add(i):this.selectedRecordCollection.splice(0,this.selectedRecordCollection.count,i)}},{key:"deselectRows",value:function(e){var t=this,n=(e=Array.isArray(e)?e:[e]).map((function(e){return t.store.getById(e)}));this.selectedRecordCollection.remove(n)}},{key:"deselectCell",value:function(e){var t=this,n=t.normalizeCellContext(e),r=t.selectionMode,i=n.record||t.store.getById(n.id),o=t._selectedCell;return r.row&&t.selectedRecordCollection.remove(i),r.cell&&n.columnId&&o&&o.id===n.id&&o.columnId===n.columnId&&(t._selectedCell=null,t.triggerChangeEvent({mode:"cell",action:"deselect",selected:[],deselected:[n],selection:[]})),n}},{key:"selectRange",value:function(e,t){var n=this.store,r=this.selectedRecordCollection,i=n.indexOf(e),o=n.indexOf(t),a=Math.min(i,o),s=Math.max(i,o);if(-1===a||-1===s)throw new Error("Record not found in selectRange");r.splice(0,r.count,n.getRange(a,s+1,!1))}},{key:"onStoreRemove",value:function(e){tt()(Ze()(n.prototype),"onStoreRemove",this)&&tt()(Ze()(n.prototype),"onStoreRemove",this).call(this,e),e.isCollapse||this.selectedRecordCollection.remove(e.records)}},{key:"onStoreDataChange",value:function(e){var t=e.action,r=e.source,i=this,o=i.selectionMode,a=i.checkboxColumn,s=i.selectedRecordCollection;if(tt()(Ze()(n.prototype),"onStoreDataChange",this)&&tt()(Ze()(n.prototype),"onStoreDataChange",this).apply(this,arguments),"pageLoad"===t)o.preserveSelectionOnPageChange||i.deselectAll(),null==a||a.updateCheckAllState(!r.find((function(e){return!s.includes(e)})));else if($b[t]){var l=[];!1===o.preserveSelectionOnDatasetChange?i.deselectAll():(s.forEach((function(e){var t=r.getById(e.id);if(t){var n=s.indexOf(e);s.splice(n,1,t)}else l.push(e)})),s.remove(l))}}},{key:"onStoreRemoveAll",value:function(){tt()(Ze()(n.prototype),"onStoreRemoveAll",this)&&tt()(Ze()(n.prototype),"onStoreRemoveAll",this).call(this),this.deselectAll()}},{key:"handleMouseMultiSelect",value:function(e,t){var n=this,r=e.id;(t.metaKey||t.ctrlKey)&&n.isSelected(r)?n.deselectRow(r):n.selectionMode.multiSelect&&(t.shiftKey&&n.startCell?function(e,t){var r=n.store,i=n.selectedRecordCollection,o=r.indexOf(e),a=r.indexOf(t),s=Math.min(o,a),l=Math.max(o,a);if(-1===s||-1===l)throw new Error("Record not found in selectRange");var u=r.getRange(s,l+1,!1).filter((function(e){return n.isSelectable(e)}));i.splice(0,n.lastRange||0,u),n.lastRange=u}(n.startCell.id,r):(t.ctrlKey||t.metaKey)&&n.selectRow({record:r,scrollIntoView:!1,addToSelection:!0}))}},{key:"onCellNavigate",value:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(e.columns.getById(n.columnId)!==e.checkboxColumn&&!e.selectionMode.rowCheckboxSelection&&!(!i||e.returningFocus||r&&r.target.closest(".b-tree-expander"))){var o=t&&n.id===t.id,a=r&&"mousedown"===r.type,s=a&&r.ctrlKey;if(!r||r.button&&2!==r.button||!r.shiftKey&&!s){var l=o&&(!r||r.shiftKey||r.ctrlKey),u=r&&e.isSelected(n.id),c=s;e.selectCell(n,!1,l||c||u)}else e.handleMouseMultiSelect(n,r);e.startCell&&!s||(e.startCell=n,e.lastRange=null)}}},{key:"triggerChangeEvent",value:function(e,t){var n,r,i,o,a=this,s=e.mode,l=e.selected,u=e.deselected;if("row"===s){for(n=0,r=l.length;n<r;n++)(i=a.getRowFor(l[n]))&&(i.addCls("b-selected"),!a.checkboxColumn||a.checkboxColumn.hidden||l[n].isSpecialRow||(i.getCell(a.checkboxColumn.id).widget.checked=!0));for(n=0,r=u.length;n<r;n++)(i=a.getRowFor(u[n]))&&(i.removeCls("b-selected"),!a.checkboxColumn||a.checkboxColumn.hidden||u[n].isSpecialRow||(i.getCell(a.checkboxColumn.id).widget.checked=!1))}else if("cell"===s){for(n=0,r=l.length;n<r;n++)(o=a.getCell(l[n]))&&o.classList.add("b-selected");for(n=0,r=u.length;n<r;n++)(o=a.getCell(u[n]))&&o.classList.remove("b-selected")}t||a.trigger("selectionChange",e)}},{key:"onCellClick",value:function(e){var t=e.event,n=e.record,r=this;r.selectionMode.checkbox||!r.selectionMode.multiSelect||t.shiftKey||t.metaKey||t.ctrlKey||r.deselectRows(r.selectedRecords.filter((function(e){return e!==n})))}},{key:"doDestroy",value:function(){var e;null===(e=this.selectedRecordCollection)||void 0===e||e.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridSelection"}},{key:"defaultConfig",get:function(){return{selectionMode:{row:!0,cell:!0,rowCheckboxSelection:!1,multiSelect:!0,checkbox:!1,showCheckAll:!1,deselectFilteredOutRecords:!1,includeChildren:!1,preserveSelectionOnPageChange:!1,preserveSelectionOnDatasetChange:!0},selectedRecordCollection:{}}}}]),n}(e||$e)};function Gb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Yb=function(e){return e.columns.suspendEvents()},qb=function(e){return e.columns.resumeEvents()},Kb=function(e){e.columns.clearCaches(),e.columns.fillFromMaster()},Xb=function(e,t){return e.stateSortIndex-t.stateSortIndex},Zb=function(e){return function(e){Ye()(n,e);var t=Gb(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getState",value:function(){var e=this,t=e.element.style.cssText,n={rowHeight:e.rowHeight,readOnly:e.readOnly};if(t&&(n.style=t),e.selectedCell){var r=e.selectedCell,i=r.id,o=r.columnId;n.selectedCell={id:i,columnId:o}}return n.selectedRecords=e.selectedRecords.map((function(e){return e.id})),n.columns=e.columns.map((function(e){return e.getState()})),n.store=e.store.state,n.scroll=e.storeScroll(),n.subGrids={},e.eachSubGrid((function(e){var t,r=n.subGrids[e.region]=n.subGrids[e.region]||{};null==e.flex&&(r.width=e.width),r.collapsed=null!==(t=e.collapsed)&&void 0!==t&&t,r.collapsed&&(r._beforeCollapseState=e._beforeCollapseState)})),n}},{key:"applyState",value:function(e){var t=this;if("columns"in e){var n=!1,r=!1;t.columns.suspendEvents(),t.eachSubGrid(Yb),e.columns.forEach((function(e,i){var o=t.columns.getById(e.id);if(o){var a=o.generation;o.applyState(e),n=n||o.generation!==a,o.stateSortIndex=i,o.allIndex!==i&&(r=n=!0)}})),n&&t.eachSubGrid(Kb),r&&(t.eachSubGrid((function(e){e.columns.records.sort(Xb),e.columns.allRecords.sort(Xb)})),t.columns.sort({fn:Xb,ascending:!0})),t.isPainted&&n&&t.renderContents(),t.columns.resumeEvents(),t.eachSubGrid(qb)}"subGrids"in e&&t.eachSubGrid((function(t){if(t.region in e.subGrids){var n=e.subGrids[t.region];"width"in n&&(t.width=n.width),"collapsed"in n&&(t.collapsed=n.collapsed,t._beforeCollapseState=n._beforeCollapseState)}})),"readOnly"in e&&(t.readOnly=e.readOnly),"rowHeight"in e&&(t.rowHeight=e.rowHeight),"style"in e&&(t.style=e.style),"selectedCell"in e&&(t.selectedCell=e.selectedCell),"store"in e&&(t.store.state=e.store),"selectedRecords"in e&&(t.selectedRecords=e.selectedRecords),"scroll"in e&&t.restoreScroll(e.scroll)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridState"}}]),n}(e||$e)};function Jb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Qb=Promise.resolve(),ek={block:"nearest"},tk=function(e){Ye()(n,e);var t=Jb(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"scrollIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ek,n=this,r=n.getDeltaTo(e,t),i=r.xDelta,o=r.yDelta,a=i||o?n.scrollBy(i,o,t):Qb;return(t.highlight||t.focus)&&a.then((function(){t.highlight&&(e instanceof Cr?e.translate(-i,-o).highlight():mi.highlight(e)),t.focus&&e.focus&&e.focus()})),a}},{key:"scrollBy",value:function(e,t,r){var i=t&&this.yScroller.scrollBy(0,t,r),o=e&&tt()(Ze()(n.prototype),"scrollBy",this).call(this,e,0,r);if(o&&o.cancel&&i&&i.cancel){var a=o.cancel,s=i.cancel;return o.cancel=i.cancel=function(){a(),s()},Promise.all([o,i])}return o||i||Qb}},{key:"scrollTo",value:function(e,t,r){var i=null!=t&&this.yScroller.scrollTo(null,t,r),o=null!=e&&tt()(Ze()(n.prototype),"scrollTo",this).call(this,e,null,r);if(r&&r.animate||this.syncPartners(),o&&o.cancel&&i&&i.cancel){var a=o.cancel,s=i.cancel;return o.cancel=i.cancel=function(){a(),s()},Promise.all([o,i])}return o||i||Qb}},{key:"viewport",get:function(){var e=Cr.from(this.element);return e.intersect(Cr.from(this.yScroller.element))||new Cr(e.x,e.y,e.width,0)}},{key:"y",get:function(){return this.yScroller?this.yScroller.y:0},set:function(e){this.yScroller&&(this.yScroller.y=e)}},{key:"maxY",get:function(){return this.yScroller?this.yScroller.maxY:0}},{key:"scrollHeight",get:function(){return this.yScroller?this.yScroller.scrollHeight:0}},{key:"clientHeight",get:function(){return this.yScroller?this.yScroller.clientHeight:0}}]),n}(ju);function nk(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return rk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rk(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function rk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ik(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}tk._$name="SubGridScroller";var ok=function(e){Ye()(i,e);var t,n,r=ik(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"construct",value:function(e){tt()(Ze()(i.prototype),"construct",this).call(this,e),this.rowManager.on("addrows",this.onAddRow,this)}},{key:"doDestroy",value:function(){var e,t=this;t.header.destroy(),t.footer.destroy(),null===(e=t.fakeScroller)||void 0===e||e.destroy(),t.virtualScrollerElement.remove(),t.splitterElement.remove(),t.headerSplitter.remove(),t.scrollerSplitter.remove(),t.footerSplitter.remove(),tt()(Ze()(i.prototype),"doDestroy",this).call(this)}},{key:"barConfig",get:function(){var e=this,t=e.element.style,n=t.width,r=t.flex,i={subGrid:e,parent:e};return r?i.flex=r:n&&(i.width=n),i}},{key:"changeHeader",value:function(e){return new this.headerClass(Qn.assign({id:this.id+"-header"},this.barConfig,e))}},{key:"changeFooter",value:function(e){return new this.footerClass(Qn.assign({id:this.id+"-footer"},this.barConfig,e))}},{key:"toggleSplitterCls",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=[n.splitterElement,n.headerSplitter,n.footerSplitter,n.scrollerSplitter];r.forEach((function(n){return null==n?void 0:n.classList[t?"add":"remove"](e)}))}},{key:"changeElement",value:function(e,t){var n,r=this.region;return tt()(Ze()(i.prototype),"changeElement",this).call(this,{className:(n={"b-grid-subgrid":1},Qe()(n,"b-grid-subgrid-".concat(r),r),Qe()(n,"b-grid-horizontal-scroller",1),Qe()(n,"b-grid-subgrid-collapsed",this.collapsed),n),dataset:{region:r}},t)}},{key:"rowElementConfig",get:function(){return{className:"b-grid-row",children:this.columns.visibleColumns.map((function(e){return{className:"b-grid-cell",dataset:{column:e.field||"",columnId:e.id}}}))}}},{key:"changeVirtualScrollerElement",value:function(){var e=mi.createElement({reference:"virtualScrollerElement",className:"b-virtual-scroller",dataset:{region:this.region},children:[{reference:"virtualScrollerWidth",className:"b-virtual-width"}]});return this.virtualScrollerWidth=e.virtualScrollerWidth,e.virtualScrollerElement}},{key:"changeSplitterElement",value:function(){var e=mi.createElement({reference:"splitterElement",className:{"b-grid-splitter":1,"b-grid-splitter-collapsed":this.collapsed,"b-hide-display":1},dataset:{region:this.region},children:[{className:"b-grid-splitter-inner b-grid-splitter-main",children:[{className:"b-grid-splitter-buttons",reference:"splitterButtons",children:[{tag:"i",className:"b-icon b-icon-collapse-gridregion"},{tag:"i",className:"b-icon b-icon-expand-gridregion"}]}]}]});return this.splitterButtons=e.splitterButtons,e.splitterElement}},{key:"splitterConfig",get:function(){return{className:this.splitterElement.className.trim(),children:[{className:"b-grid-splitter-inner"}],dataset:{region:this.region}}}},{key:"changeHeaderSplitter",value:function(){return mi.createElement(this.splitterConfig)}},{key:"changeScrollerSplitter",value:function(){return mi.createElement(this.splitterConfig)}},{key:"changeFooterSplitter",value:function(){return mi.createElement(this.splitterConfig)}},{key:"hideSplitter",value:function(){this.splitterElement.classList.add("b-hide-display"),this.headerSplitter.classList.add("b-hide-display"),this.scrollerSplitter.classList.add("b-hide-display"),this.footerSplitter.classList.add("b-hide-display"),this.$showingSplitter=!1}},{key:"showSplitter",value:function(){this.splitterElement.classList.remove("b-hide-display"),this.headerSplitter.classList.remove("b-hide-display"),this.scrollerSplitter.classList.remove("b-hide-display"),this.footerSplitter.classList.remove("b-hide-display"),this.$showingSplitter=!0}},{key:"render",value:function(){for(var e,t=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];(e=tt()(Ze()(i.prototype),"render",this)).call.apply(e,[this].concat(r)),t.grid&&(t.updateHasFlex(),t.element.parentNode.insertBefore(t.splitterElement,t.element.nextElementSibling),Tu.on({element:t.grid.element,delegate:".b-grid-splitter[data-region=".concat(t.region,"]"),mouseover:"onSplitterMouseOver",mouseout:"onSplitterMouseOut",thisObj:t}),t._collapsed&&t.collapse())}},{key:"refreshHeader",value:function(){this.header.refreshContent()}},{key:"refreshFooter",value:function(){var e;null===(e=this.footer)||void 0===e||e.refreshContent()}},{key:"eachWidget",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=[n.header,n.footer],i=0;i<r.length;i++){var o=r[i];if(!1===e(o))return;t&&o.eachWidget&&o.eachWidget(e,t)}}},{key:"fixCellWidths",value:function(e){for(var t=this.columns.visibleColumns,n=e.firstElementChild,r=0;n;){var i=t[r];i.minWidth&&(n.style.minWidth=mi.setLength(i.minWidth)),i.flex?(n.style.flex=i.flex,n.style.width=""):i.width?(n.style.width=mi.setLength(i.width),pe.a.isIE11&&(n.style.flex="",n.style.minWidth=mi.setLength(i.calcMinWidth))):n.style.flex=n.style.width=n.style.minWidth="",n=n.nextElementSibling,r++}}},{key:"totalFixedWidth",get:function(){return this.columns.totalFixedWidth}},{key:"fixWidths",value:function(){var e=this,t=e.element,n=e.header,r=e.footer;if(!e.collapsed){if(e.flex)n.flex=e.flex,r&&(r.flex=e.flex),t.style.flex=e.flex;else{if(e.hasCalculatedWidth&&!e.columns.some((function(e){return!e.hidden&&e.flex}))&&e.totalFixedWidth!==e.width)return e.width=e.totalFixedWidth,void(e.hasCalculatedWidth=!0);var i=e.width;if(!i){i=0;var o,a=nk(e.columns);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.flex||s.hidden||(i+=s.width)}}catch(e){a.e(e)}finally{a.f()}}t.style.width="".concat(i,"px"),n.width=i,r&&(r.width=i)}e.syncScrollingPartners(!1)}}},{key:"fixRowWidthsInSafariEdge",value:function(){if(pe.a.isSafari||pe.a.isEdge){var e=this,t=e.region,n=e.header,r=n.calculateMinWidthForSafari();e.rowManager.forEach((function(e){var n=e.getElement(t);n&&(n.style.width="".concat(r,"px"))})),n.headersElement.style.width="".concat(r,"px")}}},{key:"width",get:function(){return tt()(Ze()(i.prototype),"width",this)},set:function(e){var t=this;t.hasCalculatedWidth=!1,gh()(Ze()(i.prototype),"width",e,this,!0),t.header.width=e,t.footer.width=e,t.isPainted&&t.onElementResize()}},{key:"flex",get:function(){return tt()(Ze()(i.prototype),"flex",this)},set:function(e){var t=this;t.hasCalculatedWidth=!1,t.header.flex=e,t.footer.flex=e,gh()(Ze()(i.prototype),"flex",e,this,!0),t.isPainted&&t.onElementResize()}},{key:"onInternalResize",value:function(e,t,n,r,o){var a=this,s=a.grid;tt()(Ze()(i.prototype),"onInternalResize",this).call(this,e,t,n,r,o),s&&(a.syncSplitterButtonPosition(),t!==r&&(s.trigger("horizontalScroll",{subGrid:a,grid:s,scrollLeft:a.scrollable.x}),a.refreshFakeScroll(),a.fixRowWidthsInSafariEdge()),a.trigger("afterInternalResize",a))}},{key:"syncParallelSplitters",value:function(e){var t=this,n=t.grid;if(t.splitterElement&&t.$showingSplitter)t.toggleSplitterCls("b-grid-splitter-collapsed",e);else{var r=n.getSubGrid(n.getPreviousRegion(t.region));r&&r.splitterElement&&r.syncParallelSplitters(e)}}},{key:"onSplitterMouseOver",value:function(){var e=this,t=e.nextSibling;e.collapsed||t&&t.collapsed||e.toggleSplitterCls("b-hover"),e.startSplitterButtonSyncing()}},{key:"onSplitterMouseOut",value:function(){var e=this,t=e.nextSibling;e.toggleSplitterCls("b-hover",!1),e.collapsed||t&&t.collapsed||e.stopSplitterButtonSyncing()}},{key:"startSplitterButtonSyncing",value:function(){var e=this;e.splitterElement&&(e.syncSplitterButtonPosition(),e.splitterSyncScrollListener||(e.splitterSyncScrollListener=e.grid.scrollable.on({scroll:"syncSplitterButtonPosition",thisObj:e})))}},{key:"stopSplitterButtonSyncing",value:function(){this.splitterSyncScrollListener&&(this.splitterSyncScrollListener(),this.splitterSyncScrollListener=null)}},{key:"syncSplitterButtonPosition",value:function(){var e=this;e.splitterButtons.style.transform="translateY(".concat(e.grid.scrollable.y+e.grid.bodyHeight/2-(e.headerSplitter?e.grid.headerHeight:0),"px)")}},{key:"viewRectangle",get:function(){var e=this.scrollable;return new Cr(e.x,e.y,this.width||0,this.rowManager.viewHeight)}},{key:"updateHasFlex",value:function(){var e=this.columns.visibleColumns.some((function(e){return e.flex}));mi.toggleClasses(this.element,["b-has-flex"],e)}},{key:"updateResizable",value:function(e){var t=this;[t.splitterElement,t.headerSplitter,t.scrollerSplitter,t.footerSplitter].forEach((function(t){return mi.toggleClasses(t,["b-disabled"],!e)}))}},{key:"resizeColumnsToFitContent",value:function(){this.grid.beginGridMeasuring(),this.columns.visibleColumns.forEach((function(e){e.resizeToFitContent(null,null,!0)})),this.grid.endGridMeasuring()}},{key:"overflowingHorizontally",get:function(){var e=this.scrollable;return e.scrollWidth>e.clientWidth+(pe.a.isEdge?1:0)}},{key:"overflowingVertically",get:function(){var e=this.scrollable;return e.scrollHeight>e.clientHeight+(pe.a.isEdge?1:0)}},{key:"refreshFakeScroll",value:function(){var e=this,t=e.element,n=e.virtualScrollerElement,r=e.virtualScrollerWidth,i=e.totalFixedWidth,o=e.store,a=e.header,s=e.footer,l=e.scrollable;l.scrollWidth=null!=o&&o.count?null:i,n.style.width=t.style.width,n.style.flex=t.style.flex,e.collapsed||(e.overflowingHorizontally?(r.style.width="".concat((null==l?void 0:l.scrollWidth)||0,"px"),a.element.classList.add("b-overflowing"),s.element.classList.add("b-overflowing"),e.grid.virtualScrollers.classList.remove("b-hide-display")):(r.style.width=0,a.element.classList.remove("b-overflowing"),s.element.classList.remove("b-overflowing")))}},{key:"initScroll",value:function(){var e=this,t=e.scrollable,n=e.virtualScrollerElement;e.syncPartnersOnFrame=e.createOnFrame(e.syncScrollingPartners),pe.a.isFirefox&&t.element.addEventListener("wheel",(function(e){e.deltaX&&(t.x+=e.deltaX,e.preventDefault())})),t.yScroller=e.grid.scrollable,t.yScroller.addScroller(t),e.fakeScroller=new ju({element:n,overflowX:!0}),t.on({scroll:"onSubGridScroll",scrollend:"onSubGridScrollEnd",thisObj:e}),t.addPartner(e.fakeScroller,"x"),t.addPartner(e.header.scrollable,"x"),t.addPartner(e.footer.scrollable,"x")}},{key:"onSubGridScrollEnd",value:function(){this.forceScrollUpdate||this.syncScrollingPartners(),this.scrolling=!1}},{key:"onSubGridScroll",value:function(){this.forceScrollUpdate?(this.syncScrollingPartners(),this.forceScrollUpdate=!1):this.syncPartnersOnFrame()}},{key:"scrolling",get:function(){return this._scrolling},set:function(e){this._scrolling=e}},{key:"syncScrollingPartners",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=t.grid;!t.scrolling&&e&&(t.scrolling=!0),n.trigger("horizontalScroll",{subGrid:t,grid:n,scrollLeft:t.scrollable.x})}},{key:"scrollColumnIntoView",value:function(e,t){var n=this,r=n.header.scrollable;if(e=e instanceof vg?e:n.columns.get(e)||n.columns.getById(e)||n.columns.getAt(e)){var i=n.header.getHeader(e.id);if(i)return r.scrollIntoView(Cr.from(i,null,!0),t)}}},{key:"onAddRow",value:function(e){var t=e.rows,n=this,r=n.rowElementConfig,i=document.createDocumentFragment();t.forEach((function(e){var t=mi.createElement(r);i.appendChild(t),e.addElement(n.region,t),n.fixCellWidths(t)})),n.fixRowWidthsInSafariEdge(),n.element.insertBefore(i,n.insertRowsBefore)}},{key:"rowElements",get:function(){return this.fromCache(".b-grid-row",!0)}},{key:"clearRows",value:function(){this.emptyCache();var e=this.element.querySelectorAll(".b-grid-row"),t=document.createRange();e.length&&(t.setStartBefore(e[0]),t.setEndAfter(e[e.length-1]),t.deleteContents())}},{key:"addNewRowElement",value:function(){var e=mi.append(this.element,this.rowElementConfig);return this.fixCellWidths(e),e}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e,this.element.dataset.emptyText=e}},{key:"store",get:function(){return this.grid.store}},{key:"rowManager",get:function(){var e;return null===(e=this.grid)||void 0===e?void 0:e.rowManager}},{key:"toggleTransitionClasses",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=n.resolveSplitter(r);r.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),r.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),i.classList[e?"remove":"add"]("b-grid-splitter-animate")}},{key:"collapsed",get:function(){return this._collapsed},set:function(e){this.isConfiguring?this._collapsed=e:e?this.collapse():this.expand()}},{key:"collapse",value:(n=Pt()(At.a.mark((function e(){var t,n,r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=t.splitterElement?t:t.previousSibling,o=0,n.eachSubGrid((function(e){e!==t&&!e._collapsed&&++o})),0!==o){e.next=6;break}return e.next=6,r.expand();case 6:return e.abrupt("return",new Promise((function(e){if(!t._beforeCollapseState){t._beforeCollapseState={};var n=!1;t.width&&(n=!0,t.on({afterinternalresize:function(){e(t)},thisObj:t,once:!0})),t._beforeCollapseState.width=t.width,t._beforeCollapseState.elementWidth=t.element.style.width,""===r.element.style.flex&&(t._beforeCollapseState.nextRegionWidth=r.width,r.width+=t._beforeCollapseState.width),""!==t.element.style.flex&&(t._beforeCollapseState.flex=t.element.style.flex,t.header.element.style.flex=t.element.style.flex=""),t.element.classList.add("b-grid-subgrid-collapsed"),t.virtualScrollerElement.classList.add("b-collapsed"),t.header.element.classList.add("b-collapsed"),t.footer.element.classList.add("b-collapsed"),t.width="",t._collapsed=!0,n||(t.syncParallelSplitters(!0),e(!1))}})).then((function(e){var n;t.isDestroyed||(!1!==e&&(t.syncParallelSplitters(!0),null===(n=i.startSplitterButtonSyncing)||void 0===n||n.call(i)),t.grid.trigger("subGridCollapse",t))})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"expand",value:(t=Pt()(At.a.mark((function e(){var t,n,r,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this).grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=t.splitterElement?t:t.previousSibling,e.abrupt("return",new Promise((function(e){if(null!=t._beforeCollapseState){var n=!1;t.width!==t._beforeCollapseState.elementWidth&&(n=!0,t.on({afterinternalresize:function(){t.setTimeout((function(){return e(t)}),10)},thisObj:t,once:!0})),""===r.element.style.flex&&(r.width=t._beforeCollapseState.nextRegionWidth),t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,t.virtualScrollerElement.classList.remove("b-collapsed"),t.header.element.classList.remove("b-collapsed"),t.footer.element.classList.remove("b-collapsed"),t._beforeCollapseState.flex?(t.width=t._beforeCollapseState.width,t.header.flex=t.flex=t._beforeCollapseState.flex,t.footer.flex=t._beforeCollapseState.flex,t._width=null):t.width=t._beforeCollapseState.elementWidth,t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,n||e(!1),delete t._beforeCollapseState}})).then((function(e){!1!==e&&(i.stopSplitterButtonSyncing(),t.syncParallelSplitters(!1),t.grid.trigger("subGridExpand",t))})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"$name",get:function(){return"SubGrid"}},{key:"type",get:function(){return"subgrid"}},{key:"defaultConfig",get:function(){return{localizableProperties:["emptyText"],insertRowsBefore:null,appendTo:null,monitorResize:!0,headerClass:null,footerClass:null,collapsed:null,scrollable:{overflowX:!0},scrollerClass:tk,hasCalculatedWidth:null,sealedColumns:null,emptyText:null}}},{key:"configurable",get:function(){return{element:!0,header:{},footer:{},virtualScrollerElement:!0,splitterElement:!0,headerSplitter:!0,scrollerSplitter:!0,footerSplitter:!0,resizable:null}}}]),i}(uc);function ak(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return sk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sk(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function sk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ok.initClass(),ok._$name="SubGrid";var uk=function(e){return function(e){Ye()(n,e);var t=lk(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeSubGridConfigs",value:function(e){var t,n=this,r=new Set,i=ak(n.columns);try{for(i.s();!(t=i.n()).done;){var o=t.value.region;o&&(e[o]||(e[o]={}),r.add(o))}}catch(e){i.e(e)}finally{i.f()}e.normal&&Qn.isEmpty(e.normal)&&(e.normal=bk.defaultConfig.subGridConfigs.normal);var a,s=ak(r);try{for(s.s();!(a=s.n()).done;){var l=a.value;n.createSubGrid(l,e[l])}}catch(e){s.e(e)}finally{s.f()}return n.items=n.subGrids,e}},{key:"createSubGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=n.columns.makeChained((function(t){return t.region===e}),["region"]),i=Qn.assign({type:"subgrid",id:"".concat(n.id,"-").concat(e,"Subgrid"),grid:n,region:e,headerClass:n.headerClass,footerClass:n.footerClass,columns:r,weight:e},t||n.subGridConfigs[e]),o=!1;i.flex||i.width||(i.width=r.totalFixedWidth,o=!0);var a=n.subGrids[e]=ok.create(i);return a.hasCalculatedWidth=o,e===n.regions[0]&&(a.isFirstRegion=!0),a}},{key:"onChildAdd",value:function(e){if(e.isSubGrid){var t=this,r=t.items,i=t.headerContainer,o=t.virtualScrollers,a=t.footerContainer,s=2*r.indexOf(e);t.hideHeaders||(mi.insertAt(i,e.headerSplitter,s),mi.insertAt(i,e.header.element,s)),mi.insertAt(o,e.scrollerSplitter,s),mi.insertAt(o,e.virtualScrollerElement,s),mi.insertAt(a,e.footerSplitter,s),mi.insertAt(a,e.footer.element,s),r.forEach((function(e,t){t<r.length-1&&e.showSplitter()}))}return tt()(Ze()(n.prototype),"onChildAdd",this).call(this,e)}},{key:"onChildRemove",value:function(e){if(tt()(Ze()(n.prototype),"onChildRemove",this).call(this,e),e.isSubGrid){var t=this.items;delete this.subGrids[e.region],it.remove(this.regions,e.region),e.destroy(),t.length&&t[t.length-1].hideSplitter()}}},{key:"doDestroy",value:function(){this.eachSubGrid((function(e){return e.destroy()})),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"eachSubGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.items.forEach((function(n,r){n.isSubGrid&&e.call(t||n,n,r++)}))}},{key:"callEachSubGrid",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=null;return this.items.forEach((function(t,r){if(t[e]){var o=t[e].apply(t,n);0===r&&(i=o)}})),i}},{key:"regions",get:function(){return this.items.map((function(e){return e.region}))}},{key:"getLastRegions",value:function(){var e=this.regions.slice(-2);return 2===e.length?e:[e[0],e[0]]}},{key:"getNextRegion",value:function(e){var t=this.regions;return t[t.indexOf(e)+1]||t[t.length-2]}},{key:"getPreviousRegion",value:function(e){return this.regions[this.regions.indexOf(e)-1]}},{key:"getSubGrid",value:function(e){return this.subGrids[e]}},{key:"getSubGridFromColumn",value:function(e){return e=e instanceof vg?e:this.columns.getById(e)||this.columns.get(e),this.getSubGrid(e.region)}},{key:"resolveSplitter",value:function(e){var t=this.getLastRegions(),n=e instanceof ok?e.region:e;return t[1]===n&&(n=t[0]),this.subGrids[n].splitterElement}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridSubGrids"}},{key:"properties",get:function(){return{subGrids:{}}}}]),n}(e||$e)},ck=Ut.mergeLocales(Nu,{ColumnPicker:{column:"Column",columnsMenu:"Columns",hideColumn:"Hide column",hideColumnShort:"Hide",newColumns:"New columns"},Filter:{applyFilter:"Apply filter",filter:"Filter",editFilter:"Edit filter",on:"On",before:"Before",after:"After",equals:"Equals",lessThan:"Less than",moreThan:"More than",removeFilter:"Remove filter"},FilterBar:{enableFilterBar:"Show filter bar",disableFilterBar:"Hide filter bar"},Group:{group:"Group",groupAscending:"Group ascending",groupDescending:"Group descending",groupAscendingShort:"Ascending",groupDescendingShort:"Descending",stopGrouping:"Stop grouping",stopGroupingShort:"Stop"},Search:{searchForValue:"Search for value"},Sort:{sort:"Sort",sortAscending:"Sort ascending",sortDescending:"Sort descending",multiSort:"Multi sort",removeSorter:"Remove sorter",addSortAscending:"Add ascending sorter",addSortDescending:"Add descending sorter",toggleSortAscending:"Change to ascending",toggleSortDescending:"Change to descending",sortAscendingShort:"Ascending",sortDescendingShort:"Descending",removeSorterShort:"Remove",addSortAscendingShort:"+ Ascending",addSortDescendingShort:"+ Descending"},GridBase:{loadFailedMessage:"Data loading failed!",syncFailedMessage:"Data synchronization failed!",unspecifiedFailure:"Unspecified failure",networkFailure:"Network error",parseFailure:"Failed to parse server response",noRows:"No records to display",moveColumnLeft:"Move to left section",moveColumnRight:"Move to right section",removeRow:"Delete",moveColumnTo:function(e){return"Move column to ".concat(e)}},CellMenu:{removeRow:"Delete"},RowCopyPaste:{copyRecord:"Copy",cutRecord:"Cut",pasteRecord:"Paste"},PdfExport:{"Waiting for response from server":"Waiting for response from server...","Export failed":"Export failed","Server error":"Server error","Generating pages":"Generating pages..."},ExportDialog:{width:"40em",labelWidth:"12em",exportSettings:"Export settings",export:"Export",exporterType:"Control pagination",cancel:"Cancel",fileFormat:"File format",rows:"Rows",alignRows:"Align rows",columns:"Columns",paperFormat:"Paper format",orientation:"Orientation",repeatHeader:"Repeat header"},ExportRowsCombo:{all:"All rows",visible:"Visible rows"},ExportOrientationCombo:{portrait:"Portrait",landscape:"Landscape"},SinglePageExporter:{singlepage:"Single page"},MultiPageExporter:{multipage:"Multiple pages",exportingPage:function(e){var t=e.currentPage,n=e.totalPages;return"Exporting page ".concat(t,"/").concat(n)}},MultiPageVerticalExporter:{multipagevertical:"Multiple pages (vertical)",exportingPage:function(e){var t=e.currentPage,n=e.totalPages;return"Exporting page ".concat(t,"/").concat(n)}}}),fk=ck;function dk(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return hk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hk(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Yt.registerLocale("En",{desc:"English",locale:ck});var pk=new Promise((function(e){return e()})),gk="GridBase:store",yk={block:"nearest",inline:"nearest"},mk={dataset:1,pageLoad:1,filter:1},bk=function(e){Ye()(r,e);var t,n=vk(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"finishConfigure",value:function(e){var t=this;tt()(Ze()(r.prototype),"finishConfigure",this).call(this,e),Yt.on({locale:"onBeforeLocaleChange",prio:1,thisObj:t}),Yt.on({locale:"onLocaleChange",prio:-1,thisObj:t}),Fi.on({theme:"onThemeChange",thisObj:t}),t.on({subGridExpand:"onSubGridExpand",prio:-1,thisObj:t}),t.bufferedFixElementHeights=t.buffer("fixElementHeights",350,t),t.setGridClassList(t.element.classList)}},{key:"onSubGridExpand",value:function(){this.renderContents()}},{key:"onBeforeLocaleChange",value:function(){this._suspendRenderContentsOnColumnsChanged=!0}},{key:"onLocaleChange",value:function(){this._suspendRenderContentsOnColumnsChanged=!1,this.isPainted&&this.renderContents()}},{key:"finalizeInit",value:function(){tt()(Ze()(r.prototype),"finalizeInit",this).call(this),this.store.isLoading&&this.onStoreBeforeRequest()}},{key:"changeScrollManager",value:function(e,t){return null==t||t.destroy(),e?hh.new({element:this.element},e):null}},{key:"doDestroy",value:function(){var e,t=this;t.detachListeners(gk),null===(e=t.scrollManager)||void 0===e||e.destroy();for(var n=0,i=Object.values(t.features);n<i.length;n++){var o,a=i[n];null===(o=a.destroy)||void 0===o||o.call(a)}t.columns.destroy(),tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"setGridClassList",value:function(e){Object.values(this.features).forEach((function(t){var n;t.disabled||(n=Object.prototype.hasOwnProperty.call(t.constructor,"featureClass")?t.constructor.featureClass:"b-".concat(t instanceof $e?t.$$name:t.constructor.name))&&e.add(n.toLowerCase())}))}},{key:"compose",value:function(){var e,t=this.autoHeight,n=this.enableSticky,r=this.enableTextSelection,i=this.fillLastColumn,o=this.positionMode,a=this.showDirty;return{class:(e={},Qe()(e,"b-grid-".concat(o),1),Qe()(e,"b-enable-sticky",n),Qe()(e,"b-grid-notextselection",!r),Qe()(e,"b-autoheight",t),Qe()(e,"b-fill-last-column",i),Qe()(e,"b-show-dirty",a),e)}}},{key:"bodyConfig",get:function(){var e=this.autoHeight,t=this.hideFooters;return{reference:"bodyElement",className:{"b-autoheight":e,"b-grid-panel-body":1},children:{headerContainer:{tag:"header",className:{"b-grid-header-container":1,"b-hidden":this.hideHeaders}},bodyContainer:{className:"b-grid-body-container",tabIndex:-1,children:{verticalScroller:{className:"b-grid-vertical-scroller"}}},virtualScrollers:{className:"b-virtual-scrollers b-hide-display",style:pe.a.isFirefox?{height:"".concat(mi.scrollBarWidth,"px")}:void 0},footerContainer:{tag:"footer",className:{"b-grid-footer-container":1,"b-hidden":t}}}}}},{key:"contentElement",get:function(){return this.verticalScroller}},{key:"overflowElement",get:function(){return this.bodyContainer}},{key:"focusElement",get:function(){return this.bodyContainer}},{key:"updateHideFooters",value:function(e){var t;null===(t=this.footerContainer)||void 0===t||t.classList[e?"add":"remove"]("b-hidden")}},{key:"changeColumns",value:function(e,t){var n=this;if(!e&&t)return n.isDestroying?t.owner===n&&t.destroy():t.removeAll(),t;if(e.isStore)return(null==t?void 0:t.owner)===n&&t.destroy(),e.grid=n,e;if(Array.isArray(e)){if(t)return t.data=e,t;e={data:e}}if(t)throw new Error("Replacing ColumnStore is not supported");return bg.new({grid:n,owner:n},e)}},{key:"updateColumns",value:function(e){var t,n,r=this;e.on("change",r.onColumnsChanged,r),e.on((t=r.onColumnsResized,n=r,{update:function(e){var r=e.store,i=e.record,o=e.changes,a=!0;return("width"in o||"minWidth"in o||"flex"in o)&&(a=t.call(n,{store:r,record:i,changes:o})),a}})),pe.a.isTouchDevice&&(r.touch=!0,e.forEach((function(e){var t=e.touchConfig;t&&e.applyState(t)})))}},{key:"onColumnsChanged",value:function(e){var t=e.action,n=e.changes,r=e.record,i=this;if(i.isPainted){if("update"===t){if("width"in n||"minWidth"in n||"flex"in n){var o=r.region;return void i.columns.visibleColumns.forEach((function(e){e.region===o&&e.repaintOnResize&&i.refreshColumn(e)}))}if("hidden"in n){var a=i.getSubGridFromColumn(r.id);a.header.fixHeaderWidths(),a.footer.fixFooterWidths(),a.updateHasFlex()}}if("dataset"===t||"update"===t&&"region"in n){var s=i.columns.getDistinctValues("region"),l=it.delta(s,i.regions,!0),u=l.toRemove,c=l.toAdd;i.remove(u.map((function(e){return i.getSubGrid(e)}))),i.add(c.map((function(e){return i.createSubGrid(e)})))}i._suspendRenderContentsOnColumnsChanged||i.renderContents()}}},{key:"onColumnsResized",value:function(e){var t=e.changes,n=e.record,r=this;if(!r.isConfiguring){var i=mi.setLength(n.width),o=mi.setLength(n.minWidth),a=r.getSubGridFromColumn(n.id);a.header.fixHeaderWidths(),a.footer.fixFooterWidths(),a.updateHasFlex(),r.cellEls&&n===r.lastColumnResized||(r.cellEls=mi.children(r.element,'.b-grid-cell[data-column-id="'.concat(n.id,'"]')),r.lastColumnResized=n);var s,l=dk(r.cellEls);try{for(l.s();!(s=l.n()).done;){var u,c=s.value;if("width"in t&&(c.style.width=i,pe.a.isIE11&&(c.style.flex="",c.style.minWidth=mi.setLength(n.calcMinWidth))),"minWidth"in t&&(c.style.minWidth=o),"flex"in t)c.style.flex=null!==(u=n.flex)&&void 0!==u?u:null}}catch(e){l.e(e)}finally{l.f()}r.resizingColumns||r.afterColumnsResized()}}},{key:"afterColumnsResized",value:function(){var e=this;e.eachSubGrid((function(e){e.collapsed||(e.fixWidths(),e.fixRowWidthsInSafariEdge())})),e.lastColumnResized=e.cellEls=null,e.bufferedAfterColumnsResized(),e.onHeightChange()}},{key:"bufferedAfterColumnsResized",value:function(){this.columns.usesAutoHeight&&this.refreshRows(),this.refreshVirtualScrollbars(),this.eachSubGrid((function(e){e.collapsed||e.refreshFakeScroll()}))}},{key:"processCellEditor",value:function(e){}},{key:"bufferedElementResize",value:function(e,t,n,r){this.isPainted&&t!==r&&this.columns.usesFlexAutoHeight&&this.refreshRows()}},{key:"onInternalResize",value:function(e,t,n,i,o){mi.scrollBarWidth&&t<i&&this.eachSubGrid((function(e){e.flex&&e.onElementResize(e.element)})),tt()(Ze()(r.prototype),"onInternalResize",this).apply(this,arguments),this.bufferedElementResize.apply(this,arguments)}},{key:"changeRowManager",value:function(e,t){var n=this;if(n._isRowMeasured||n.measureRowHeight(),null==t||t.destroy(),e){var r=yb.new({grid:n,rowHeight:n.rowHeight,rowScrollMode:n.rowScrollMode||"move",autoHeight:n.autoHeight,fixedRowHeight:n.fixedRowHeight,listeners:{changeTotalHeight:n.onRowManagerChangeTotalHeight,requestScrollChange:n.onRowManagerRequestScrollChange,thisObj:n}},e);return n._rowManager=null,r}}},{key:"getRowHeight",value:function(e){return e.rowHeight}},{key:"bindStore",value:function(e){var t,n=this.asyncEventSuffix;e.on((t={name:gk},Qe()(t,"refresh".concat(n),"onStoreDataChange"),Qe()(t,"add".concat(n),"onStoreAdd"),Qe()(t,"remove".concat(n),"onStoreRemove"),Qe()(t,"move".concat(n),"onStoreMove"),Qe()(t,"replace".concat(n),"onStoreReplace"),Qe()(t,"removeAll".concat(n),"onStoreRemoveAll"),Qe()(t,"idChange","onStoreRecordIdChange"),Qe()(t,"update","onStoreUpdateRecord"),Qe()(t,"beforeRequest","onStoreBeforeRequest"),Qe()(t,"afterRequest","onStoreAfterRequest"),Qe()(t,"clearChanges","onStoreDataChange"),Qe()(t,"exception","onStoreException"),Qe()(t,"commit","onStoreCommit"),Qe()(t,"thisObj",this),t)),tt()(Ze()(r.prototype),"bindStore",this).call(this,e)}},{key:"unbindStore",value:function(e){this.detachListeners(gk),this.destroyStore&&e.destroy()}},{key:"changeStore",value:function(e){if(null==e)return null;var t;("string"==typeof e&&(e=ts.getStore(e)),e instanceof ts)||((e=Qn.assign({data:this.data,tree:Boolean(null===(t=this.initialConfig.features)||void 0===t?void 0:t.tree)},e)).data||delete e.data,e.modelClass||(e.modelClass=function(e){Ye()(n,e);var t=vk(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Kg)),e=new(e.readUrl?ss:ts)(e));return e}},{key:"updateStore",value:function(e,t){var n,r=this;(t&&r.unbindStore(t),e&&(t&&r.deselectAll(),r.bindStore(e)),r.trigger("bindStore",{store:e,oldStore:t}),r.isDestroying||!r.isPainted||r.refreshSuspended)||(null===(n=r._rowManager)||void 0===n||n.reinitialize())}},{key:"onStoreUpdateRecord",value:function(e){var t=e.source,n=e.record,r=e.changes,i=this;if(i.forceFullRefresh)i.rowManager.refresh(),i.forceFullRefresh=!1;else{var o;if(n.isFieldModified("id")&&(o=i.getRowFor(n.meta.modified.id)),!(o=o||i.getRowFor(n)))return;if(i.fullRowRefresh||n.isSpecialRow){var a=t.indexOf(n);-1!==a&&o.render(a,n)}else i.columns.visibleColumns.forEach((function(e){var t=e.field;if(!(e.constructor.simpleRenderer&&!Object.prototype.hasOwnProperty.call(e.data,"renderer"))||r[t]){var i=o.getCell(t);i&&o.renderCell({cellElement:i,record:n})}}))}}},{key:"refreshFromRowOnStoreAdd",value:function(e,t){var n=this,r=n.rowManager;r.renderFromRow(e),r.trigger("changeTotalHeight",{totalHeight:r.totalHeight}),1===n.store.count&&n.callEachSubGrid("refreshFakeScroll")}},{key:"onMaskAutoClose",value:function(e){tt()(Ze()(r.prototype),"onMaskAutoClose",this).call(this,e),this.toggleEmptyText()}},{key:"onStoreAdd",value:function(e){var t=e.source,n=e.records,r=e.index,i=e.oldIndex,o=e.isChild,a=e.oldParent,s=e.isMove,l=e.isExpandAll;if(this.isPainted&&!l&&(!o||n[0].ancestorsExpanded(t))){this.rowManager.calculateRowCount(!1,!0,!0),t.isFiltered&&(r=t.indexOf(n[0]));var u=this,c=u.rowManager,f=c.topIndex,d=c.rows,h=c.rowCount,v=c.topIndex+c.rowCount-1,p=r,g=r+n.length-1,y=v>=t.count-n.length-1;if(a||i>-1||o&&s)c.refresh();else if(p>=f&&p<f+h)u.refreshFromRowOnStoreAdd.apply(u,[d[p-f]].concat(Array.prototype.slice.call(arguments)));else if(g>=f&&g<f+h)c.refresh();else{var m=c.totalHeight;y&&r>v&&c.fillBelow(u._scrollTop||0),m!==c.totalHeight&&c.trigger("changeTotalHeight",{totalHeight:c.totalHeight})}}}},{key:"onStoreException",value:function(e){var t,n=e.action,r=e.type,i=e.response,o=e.exceptionType,a=e.error,s=this;switch(r){case"server":t=i.message||s.L("L{unspecifiedFailure}");break;case"exception":t="network"===o?s.L("L{networkFailure}"):a&&a.message||s.L("L{parseFailure}")}s.applyMaskError('<div class="b-grid-load-failure">\n                <div class="b-grid-load-fail">'.concat(s.L("read"===n?"L{loadFailedMessage}":"L{syncFailedMessage}"),'</div>\n                <div class="b-grid-load-fail">').concat(i&&i.url?i.url+" responded with":"",'</div>\n                <div class="b-grid-load-fail">').concat(t,"</div>\n            </div>"))}},{key:"onStoreDataChange",value:function(e){var t=e.action,n=e.changes,i=e.source;if(!this.refreshSuspended){tt()(Ze()(r.prototype),"onStoreDataChange",this)&&tt()(Ze()(r.prototype),"onStoreDataChange",this).apply(this,arguments);var o=this,a=i.isGrouped&&n&&i.groupers.some((function(e){return e.field in n}));"dataset"===t&&o.rowManager.clearKnownHeights(),o.isPainted&&!a&&o.renderRows(Boolean(!(t in mk)||o.preserveScrollOnDatasetChange)),o.toggleEmptyText()}}},{key:"onStoreRecordIdChange",value:function(){tt()(Ze()(r.prototype),"onStoreRecordIdChange",this)&&tt()(Ze()(r.prototype),"onStoreRecordIdChange",this).apply(this,arguments)}},{key:"onStoreBeforeRequest",value:function(){this.applyLoadMask()}},{key:"onStoreAfterRequest",value:function(e){this.loadMask&&!e.exception&&(this.masked=null,this.toggleEmptyText())}},{key:"needsFullRefreshOnStoreRemove",value:function(){var e=this._features;return(null==e?void 0:e.group)&&!e.group.disabled||(null==e?void 0:e.groupSummary)&&!e.groupSummary.disabled}},{key:"onStoreRemove",value:function(e){var t=e.records,n=e.isCollapse,i=e.isChild,o=e.isMove,a=e.isCollapseAll;if(this.isPainted&&!o&&!a){tt()(Ze()(r.prototype),"onStoreRemove",this)&&tt()(Ze()(r.prototype),"onStoreRemove",this).apply(this,arguments);var s=Math.pow(2,53)-1,l=this,u=l.rowManager,c=t.reduce((function(e,t){var n=u.getRowById(t.id);return n&&(e.push(n),s=Math.min(s,u.rows.indexOf(n))),e}),[]);if(u.invalidateKnownHeight(t),l.animateRemovingRows&&c.length&&!n&&!i){var f=c[0];l.isAnimating=!0,Tu.onTransitionEnd({element:f._elementsArray[0],property:"left",duration:l.transitionDuration,thisObj:l,handler:function(){l.isAnimating=!1,c.forEach((function(e){return!e.isDestroyed&&e.removeCls("b-removing")})),u.refresh(),l.trigger("rowRemove")}}),c.forEach((function(e){return e.addCls("b-removing")}))}else l.needsFullRefreshOnStoreRemove.apply(l,arguments)?u.refresh():(u.calculateRowCount(!1,!0,!0),u.rows[s]?u.renderFromRow(u.rows[s]):u.trigger("changeTotalHeight",{totalHeight:u.totalHeight}),l.trigger("rowRemove",{isCollapse:n}))}}},{key:"onStoreMove",value:function(e){var t=e.from,n=e.to,r=this.rowManager,i=r.topIndex,o=r.rowCount,a=[t,n].sort(),s=N()(a,2),l=s[0],u=s[1];l>=i&&l<i+o?r.renderFromRow(r.rows[l-i]):u>=i&&u<i+o&&r.refresh()}},{key:"onStoreReplace",value:function(e){var t=this,n=e.records,r=e.all,i=this.rowManager;if(r)i.clearKnownHeights(),i.refresh();else{var o=n.reduce((function(e,n){var r=N()(n,2)[1],i=t.getRowFor(r);return i&&e.push(i),e}),[]);i.invalidateKnownHeight(n),i.renderRows(o)}}},{key:"onStoreRemoveAll",value:function(){tt()(Ze()(r.prototype),"onStoreRemoveAll",this)&&tt()(Ze()(r.prototype),"onStoreRemoveAll",this).apply(this,arguments),this.isPainted&&(this.rowManager.clearKnownHeights(),this.renderRows(),this.toggleEmptyText())}},{key:"onStoreCommit",value:function(e){var t=this,n=e.changes;if(this.showDirty&&n.modified.length){var r=[];n.modified.forEach((function(e){var n=t.rowManager.getRowFor(e);n&&r.push(n)})),this.rowManager.renderRows(r)}}},{key:"data",get:function(){return this._store?this._store.records:this._data},set:function(e){this._store?this._store.data=e:this._data=e}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e,this.eachSubGrid((function(t){return t.emptyText=e}))}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this,i=r.subGrids,o=r.regions,a=!0;Object.entries(i).forEach((function(e){var s=N()(e,2),l=s[0],u=s[1];if(!u.sealedColumns&&t.draggable&&l!==t.region&&(!t.parent&&i[t.region].columns.count>1||t.parent&&t.parent.children.length>1)){var c=u.element.compareDocumentPosition(i[t.region].element)===document.DOCUMENT_POSITION_PRECEDING,f=o.length>2?r.L("L{moveColumnTo}",r.optionalL(l)):r.L(c?"L{moveColumnRight}":"L{moveColumnLeft}");n["".concat(l,"Region")]={targetSubGrid:l,text:f,icon:"b-fw-icon "+(c?"b-icon-column-move-right":"b-icon-column-move-left"),name:"moveColumn",cls:a?"b-separator":"",onItem:function(e){var n=e.item;t.traverse((function(e){return e.region=l})),r.columns.insert(r.columns.indexOf(i[n.targetSubGrid].columns.last)+1,t),r.scrollColumnIntoView(t)}},a=!1}}))}},{key:"populateCellMenu",value:function(e){var t,n=e.record,r=e.items,i=this;(null===(t=i.features)||void 0===t?void 0:t.contextMenu)&&!i.features.contextMenu.disabled&&i.showRemoveRowInContextMenu&&!i.readOnly&&n&&!n.isSpecialRow&&(r.removeRow={text:"L{removeRow}",localeClass:this,icon:"b-fw-icon b-icon-trash",name:"removeRow",onItem:function(){return i.store.remove(i.selectedRecords)}})}},{key:"getColumnDragToolbarItems",value:function(e,t){return t}},{key:"normalizeCellContext",value:function(e){var t=this.columns,n=this.store;if(e instanceof n.modelClass)return{record:e,id:e.id,columnId:t.visibleColumns[0].id};if(!("columnId"in e)){if("field"in e){var r=t.get(e.field);e.columnId=r&&r.id}else if("column"in e){var i="number"==typeof e.column?t.visibleColumns[e.column]:e.column;e.columnId=i&&i.id}"columnId"in e||(e.columnId=t.visibleColumns[0].id)}if("id"in e){if(e.element&&!n.getById(e.id)){var o=this.getRecordFromElement(e.element);o&&(e.id=o.id)}}else{var a="row"in e?n.getAt(e.row):e.record;a&&(e.id=a.id)}return e}},{key:"getCell",value:function(e){var t,n=null;return"id"in(e=this.normalizeCellContext(e))&&(t=this.getRowById(e.id)),t&&"columnId"in e&&(n=t.getCell(e.columnId)),n}},{key:"getHeaderElement",value:function(e){return"string"!=typeof e&&(e=e.id),this.fromCache('.b-grid-header[data-column-id="'.concat(e,'"]'))}},{key:"getHeaderElementByField",value:function(e){var t=this.columns.get(e);return t?this.getHeaderElement(t):null}},{key:"bodyHeight",get:function(){return this._bodyHeight}},{key:"headerHeight",get:function(){var e=this;return e.isPainted&&!e._headerHeight&&(e._headerHeight=e.headerContainer.offsetHeight),e._headerHeight}},{key:"getRecordFromElement",value:function(e){var t=e.closest(".b-grid-row");return t?this.store.getAt(t.dataset.index):null}},{key:"getColumnFromElement",value:function(e){var t=mi.up(e,".b-grid-cell, .b-grid-header");if(!t)return null;if(t.matches(".b-grid-header"))return this.columns.getById(t.dataset.columnId);var n=ls.get(t);return this.columns.getById(n.columnId)}},{key:"updateAutoHeight",value:function(e){Qn.assertBoolean(e,"autoHeight")}},{key:"columnLines",get:function(){return this._columnLines},set:function(e){Qn.assertBoolean(e,"columnLines"),mi.toggleClasses(this.element,"b-no-column-lines",!e),this._columnLines=e}},{key:"fixSizes",value:function(){this.callEachSubGrid("fixWidths")}},{key:"onRowManagerChangeTotalHeight",value:function(e){var t=e.totalHeight,n=e.immediate;return this.refreshTotalHeight(t,n)}},{key:"refreshTotalHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rowManager.totalHeight,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;if(n.renderingRows||!n.isVisible)return!1;n.rowManager.bottomRow&&(e=Math.max(e,n.rowManager.bottomRow.bottom));var r=n.scrollable,i=Math.abs(n.virtualScrollHeight-e),o=n._bodyRectangle.height,a=e-o;if(i){var s=a-n._scrollTop<2*o||n._verticalScrollHeight&&n._verticalScrollHeight-o<n._scrollTop;r.scrollHeight=n.virtualScrollHeight=e,n.isPainted&&(n.scrolling&&!s||i<100)&&!t?n.bufferedFixElementHeights():(n.virtualScrollHeightDirty&&n.virtualScrollHeightDirty(),n.bufferedFixElementHeights.cancel(),n.fixElementHeights())}}},{key:"fixElementHeights",value:function(){var e=this,t=e.virtualScrollHeight,n="".concat(t,"px");e._verticalScrollHeight=t,e.verticalScroller.style.height=n,e.virtualScrollHeightDirty=!1,e.autoHeight&&(e.bodyContainer.style.height=n,e._bodyHeight=t,e._bodyRectangle=Cr.client(e.bodyContainer)),e.refreshVirtualScrollbars()}},{key:"scrolling",get:function(){return this._scrolling},set:function(e){this._scrolling=e}},{key:"enableScrollingCloseToEdges",value:function(e){"string"==typeof e&&(e=this.subGrids[e]),this.scrollManager.startMonitoring({scrollables:[{element:e.scrollable.element,direction:"horizontal"},{element:this.scrollable.element,direction:"vertical"}]})}},{key:"disableScrollingCloseToEdges",value:function(e){"string"==typeof e&&(e=this.subGrids[e]),this.scrollManager.stopMonitoring([e.element,this.scrollable.element])}},{key:"onRowManagerRequestScrollChange",value:function(e){var t=e.bottom;this.scrollable.y=t-this.bodyHeight}},{key:"initScroll",value:function(){var e=this;if(!e.scrollInitialized){var t,n=e.createOnFrame((function(){(t=e.scrollable.y)!==e._scrollTop&&(e._scrollTop=t,e.scrolling||(e.scrolling=!0,e.eachSubGrid((function(e){return e.suspendResizeMonitor=!0}))),e.rowManager.updateRenderedRows(t),e.trigger("scroll",{scrollTop:t}))}));e.scrollInitialized=!0,e.scrollable.on({scroll:n,scrollend:function(){e.scrolling=!1,e.eachSubGrid((function(e){return e.suspendResizeMonitor=!1}))}}),e.callEachSubGrid("initScroll")}}},{key:"scrollRowIntoView",value:(t=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c,f,d,h,v,p,g=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=g.length>1&&void 0!==g[1]?g[1]:yk,r=this,i=n.block||"nearest",o=r.rowManager,!(a=r.store.getById(t))){e.next=35;break}if(-1!==r.store.indexOf(a)){e.next=5;break}return e.abrupt("return",pk);case 5:if(l=r.scrollable,u=r.getRecordCoords(a),c=Cr.from(l.element),!u.virtual){e.next=32;break}if(f=u.block,d="nearest"!==i?n:{block:f},s=l.scrollIntoView(u,{block:"center"}),o.scrollTargetRecordId=a,o.updateRenderedRows(l.y,!0),u=r.getRecordCoords(a),o.lastScrollTop=l.y,!u.virtual){e.next=16;break}return e.abrupt("return",pk);case 16:if(!n.animate){e.next=25;break}l.suspendEvents(),"end"===i||"nearest"===i&&"end"===f?l.y-=c.bottom-u.bottom:("start"===i||"nearest"===i&&"start"===f)&&(l.y+=u.y-c.y),o.updateRenderedRows(l.y,!1,!0),"end"===f?l.y-=o.appendRowBuffer*o.rowHeight-1:l.y+=o.prependRowBuffer*o.rowHeight-1,l.scrollIntoView(r.getRecordCoords(a),Object.assign({},n,d)),l.resumeEvents(),e.next=30;break;case 25:if(n.recursive){e.next=28;break}return e.next=28,s;case 28:return e.next=30,null===(h=r.scrollRowIntoView)||void 0===h?void 0:h.call(r,a,Object.assign({recursive:!0},n,d));case 30:e.next=35;break;case 32:return(v=n.column)?("string"==typeof v&&(v=r.columns.getById(v)||r.columns.get(v)),v&&(l=r.getSubGridFromColumn(v).scrollable,p=Cr.from(o.getRowFor(a).getCell(v.id)),u.x=p.x,u.width=p.width)):n.x=!1,e.abrupt("return",l.scrollIntoView(u,n));case 35:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"scrollColumnIntoView",value:function(e,t){return e=e instanceof vg?e:this.columns.get(e)||this.columns.getById(e)||this.columns.getAt(e),this.getSubGridFromColumn(e).scrollColumnIntoView(e,t)}},{key:"scrollCellIntoView",value:function(e,t){return this.scrollRowIntoView(e.id,Object.assign({column:e.columnId},"boolean"==typeof t?{animate:t}:t))}},{key:"scrollToBottom",value:function(e){return this.scrollRowIntoView(this.store.last,e)}},{key:"scrollToTop",value:function(e){return this.scrollable.scrollBy(0,-this.scrollable.y,e)}},{key:"storeScroll",value:function(){var e=this,t=e.storedScrollState={scrollTop:e.scrollable.y,scrollLeft:{}};return e.eachSubGrid((function(e){t.scrollLeft[e.region]=e.scrollable.x})),t}},{key:"restoreScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.storedScrollState,t=this;t.eachSubGrid((function(t){var n,r=e.scrollLeft[t.region];t.scrollable.updateX(r),t.header.scrollable.updateX(r),t.footer.scrollable.updateX(r),null===(n=t.fakeScroller)||void 0===n||n.updateX(r)})),t.scrollable.updateY(e.scrollTop)}},{key:"beginGridMeasuring",value:function(){var e=this;if(e.$measureCellElements||(e.$measureCellElements=mi.createElement({className:"b-grid-subgrid "+(!e._isRowMeasured&&e.hasFeature("stripe")?"b-stripe":""),reference:"subGridElement",style:{position:"absolute",top:"-10000px",left:"-100000px",visibility:"hidden",contain:"strict"},children:[{className:"b-grid-row",reference:"rowElement",children:[{className:"b-grid-cell",reference:"cellElement",style:{width:"auto",contain:pe.a.isFirefox?"layout paint":"layout style paint"}}]}]})),e.getConfig("element"),e.verticalScroller.appendChild(e.$measureCellElements.subGridElement),!e.rendered){var t=e.appendTo||e.insertBefore||document.body,n=mi.getRootElement("string"==typeof t?document.getElementById(t):t);e.adopt&&n.contains(e.element)||(n.appendChild(e.element),e.$removeAfterMeasuring=!0)}return e.$measureCellElements}},{key:"endGridMeasuring",value:function(){this.$removeAfterMeasuring&&(this.element.remove(),this.$removeAfterMeasuring=!1),this.$measureCellElements.subGridElement.remove()}},{key:"measureRowHeight",value:function(){var e=this,t=e.beginGridMeasuring().rowElement,n=mi.getStyleValue(t,["height","border-top-width","border-bottom-width"]),r=parseInt(n.height),i=pe.a.isFirefox?devicePixelRatio:1,o=n["border-top-width"]?Math.round(i*parseFloat(n["border-top-width"])):0,a=n["border-bottom-width"]?Math.round(i*parseFloat(n["border-bottom-width"])):0;null!=e.rowHeight&&e.rowHeight!==e._rowHeightFromStyle||(e.rowHeight=!isNaN(r)&&r?r:e.defaultRowHeight,e._rowHeightFromStyle=e.rowHeight),e._rowBorderHeight=o+a,e._isRowMeasured=!0,e.endGridMeasuring()}},{key:"onThemeChange",value:function(e){var t=e.theme,n=this;n.isVisible?n.measureRowHeight():-1===n.findListener("paint","measureRowHeight",n)&&n.on({paint:"measureRowHeight",thisObj:n,once:!0}),n.trigger("theme",{theme:t})}},{key:"refreshRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.element,n=this.rowManager;t.classList.add("b-notransition"),e?n.returnToTop():n.refresh(),t.classList.remove("b-notransition")}},{key:"refreshColumn",value:function(e){if(!e.hidden){var t=e.field;this.rowManager.forEach((function(e){var n=e.getCell(t);e.renderCell({cellElement:n})}))}}},{key:"refreshVirtualScrollbars",value:function(){var e=this,t=e.headerContainer,n=e.footerContainer,r=e.virtualScrollers,i=e.hasVerticalOverflow,o=!r.classList.contains("b-hide-display"),a=Object.values(e.subGrids).some((function(e){return e.overflowingHorizontally})),s=a!==o,l=i?"add":"remove";s&&r.classList[a?"remove":"add"]("b-hide-display"),mi.scrollBarWidth&&(t.classList[l]("b-show-yscroll-padding"),n.classList[l]("b-show-yscroll-padding"),r.classList[l]("b-show-yscroll-padding"),s&&(a&&e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange()))}},{key:"hasVerticalOverflow",get:function(){var e=this.scrollable;return pe.a.isEdge||pe.a.isIE11?Math.abs(e.scrollHeight-e.clientHeight)>1:e.scrollHeight>e.clientHeight}},{key:"contentHeight",get:function(){var e=this.rowManager;return Math.max(e.totalHeight,e.bottomRow?e.bottomRow.bottom:0)}},{key:"onContentChange",value:function(){var e=this,t=e.rowManager;e.isVisible?(t.estimateTotalHeight(),e.paintListener=null,e.refreshTotalHeight(e.contentHeight),e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange()):e.paintListener||(e.paintListener=e.on({paint:"onContentChange",once:!0,thisObj:e}))}},{key:"triggerPaint",value:function(){this.isPainted||(this._bodyRectangle=Cr.client(this.bodyContainer)),tt()(Ze()(r.prototype),"triggerPaint",this).call(this)}},{key:"onHeightChange",value:function(){var e=this;e._bodyRectangle=Cr.client(e.bodyContainer),e._bodyHeight=e.autoHeight?e.contentHeight:e.bodyContainer.offsetHeight}},{key:"renderHeader",value:function(e,t){}},{key:"renderFooter",value:function(e,t){}},{key:"suspendRefresh",value:function(){this.refreshSuspended++}},{key:"resumeRefresh",value:function(e){this.refreshSuspended&&!--this.refreshSuspended&&(e&&this.refreshRows(),this.trigger("resumeRefresh"))}},{key:"renderRows",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=e&&t.storeScroll();t.refreshSuspended||(t.trigger("beforeRenderRows"),t.renderingRows=!0,t.element.classList.add("b-grid-refreshing"),e||(t.scrollable.y=t._scrollTop=0),t.rowManager.reinitialize(!e),t.trigger("renderRows"),t.renderingRows=!1,t.onContentChange(),e&&t.restoreScroll(n),t.element.classList.remove("b-grid-refreshing"))}},{key:"renderContents",value:function(){var e=this,t=e.element,n=e.headerContainer,r=e.footerContainer,i=e.rowManager;if(e.emptyCache(),e.isPainted){e._headerHeight=null,e.callEachSubGrid("refreshHeader",n),e.callEachSubGrid("refreshFooter",r),e.renderHeader(n,t),e.renderFooter(r,t),e.fixSizes();var o=i.removeAllRows();i.calculateRowCount(!1,!0,!0),i.rowCount&&(i.setPosition(o),e.renderRows())}}},{key:"onPaintOverride",value:function(){}},{key:"onPaint",value:function(e){var t=e.firstPaint,n=this;if(!n.onPaintOverride()&&t){var r,i=n.rowManager,o=n.store,a=n.element,s=n.headerContainer,l=n.bodyContainer,u=n.footerContainer,c=mi.scrollBarPadElement,f=0;n.columns.on({change:function(){return r=!0},once:!0}),n.updateResponsive(n.width,0),r&&(n.callEachSubGrid("refreshHeader",s),n.callEachSubGrid("refreshFooter",u)),n.renderHeader(s,a),n.renderFooter(u,a),mi.append(s,c),mi.append(u,c),mi.append(n.virtualScrollers,c),n._bodyRectangle=Cr.client(n.bodyContainer);var d=n.bodyContainer.offsetHeight;if(n.autoHeight?(n._bodyHeight=i.initWithHeight(a.offsetHeight-s.offsetHeight-u.offsetHeight,!0),l.style.height=n.bodyHeight+"px"):(n._bodyHeight=d,i.initWithHeight(n._bodyHeight,!0)),n.eachSubGrid((function(e){e.header.maxDepth>f&&(f=e.header.maxDepth)})),s.dataset.maxDepth=f,n.fixSizes(),!o.count&&o.isLoading||n.renderRows(),n.columns.usesAutoHeight){var h=document.fonts;"loaded"!==(null==h?void 0:h.status)&&h.ready.then((function(){return!n.isDestroyed&&n.refreshRows()}))}n.initScroll(),n.initInternalEvents()}}},{key:"render",value:function(){var e=this;e.requireSize=Boolean(e.owner),tt()(Ze()(r.prototype),"render",this).apply(this,arguments),e.autoHeight||(e.headerContainer.offsetHeight&&!e.bodyContainer.offsetHeight&&console.warn("Grid element not sized correctly, please check your CSS styles and review how you size the widget"),"minHeight"in e.initialConfig||"height"in e.initialConfig||parseInt(window.getComputedStyle(e.element).minHeight)!==e.height||console.warn("The ".concat(e.$$name," is sized by its predefined minHeight, likely this is not intended. ")+'Please check your CSS and review how you size the widget, or assign a fixed height in the config. For more information, see the "Basics/Sizing the component" guide in docs.'))}},{key:"maskBody",value:function(e){var t=this;if(t.bodyContainer){t.unmaskBody();var n=(t.activeMask=qu.mask(e,t.element)).maskElement;return n.style.marginTop="".concat(t.bodyContainer.offsetTop,"px"),n.style.height="".concat(t.virtualScrollers.offsetTop+t.virtualScrollers.offsetHeight-t.bodyContainer.offsetTop,"px"),t.activeMask}}},{key:"unmaskBody",value:function(){var e=this;e.loadmaskHideTimer&&e.clearTimeout(e.loadmaskHideTimer),e.loadmaskHideTimer=null,e.activeMask&&e.activeMask.destroy(),e.activeMask=null}},{key:"toggleEmptyText",value:function(){this.bodyContainer&&mi.toggleClasses(this.bodyContainer,"b-grid-empty",!(this.rowManager.rowCount>0||this.store.isLoading||this.store.isCommitting))}}],[{key:"$name",get:function(){return"GridBase"}},{key:"type",get:function(){return"gridbase"}},{key:"delayable",get:function(){return{onGridScroll:{type:"raf"},bufferedAfterColumnsResized:250,bufferedElementResize:250}}},{key:"configurable",get:function(){return{autoHeight:null,enableSticky:null,enableTextSelection:null,fillLastColumn:!0,positionMode:"translate",showDirty:null,subGridConfigs:{normal:{flex:1}},store:{value:{},$config:"nullify"},rowManager:{value:{},$config:["nullify","lazy"]},scrollManager:{value:{},$config:["nullify","lazy"]},columns:{value:[],$config:"nullify"},minHeight:"10em",hideFooters:!0,contentElMutationObserver:!1}}},{key:"defaultConfig",get:function(){return{rowHeight:null,fixedRowHeight:null,defaultRowHeight:45,emptyText:"L{noRows}",fullRowRefresh:!0,hideHeaders:null,preserveScrollOnDatasetChange:null,preserveFocusOnDatasetChange:!0,showRemoveRowInContextMenu:!0,data:null,defaultRegion:"normal",destroyStore:null,maskDefaults:{cover:"body",target:"element"},columnLines:!0,resizeToFitIncludesHeader:!0,animateRemovingRows:!pe.a.isIE11,disableGridRowModelWarning:null,headerClass:Tb,footerClass:hb,testPerformance:!1,rowScrollMode:"move",monitorResize:!0,features:!0,scrollable:{overflowY:!0},scrollerClass:Sb,refreshSuspended:0,transitionDuration:500,contextMenuTriggerEvent:"contextmenu",localizableProperties:["emptyText"],asyncEventSuffix:""}}},{key:"getLKey",value:function(){return"4fec9e57-e475-11eb-a5fc-d094663d5c88"}},{key:"properties",get:function(){return{_selectedRecords:[],_verticalScrollHeight:0,virtualScrollHeight:0,_scrollTop:null}}},{key:"deprecatedEvents",get:function(){return{cellContextMenuBeforeShow:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`cellContextMenuBeforeShow` event is deprecated, in favor of `cellMenuBeforeShow` event. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."},cellContextMenuShow:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`cellContextMenuShow` event is deprecated, in favor of `cellMenuShow` event. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."},headerContextMenuBeforeShow:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`headerContextMenuBeforeShow` event is deprecated, in favor of `headerMenuBeforeShow` event. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."},headerContextMenuShow:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`headerContextMenuShow` event is deprecated, in favor of `headerMenuShow` event. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."},contextMenuItem:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`contextMenuItem` event is deprecated, in favor of `cellMenuItem` and `headerMenuItem` events. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."},contextMenuToggleItem:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`contextMenuToggleItem` event is deprecated, in favor of `cellMenuToggleItem` and `headerMenuToggleItem` events. Please see https://bryntum.com/docs/grid/#Grid/guides/upgrades/4.0.0.md for more information."}}}}]),r}(Rf.mixin(Ni,Vi,Ab,Fb,(function(e){return function(e){Ye()(n,e);var t=Lb(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"focusedCell",get:function(){var e=this._focusedCell;if(e&&this.getCell(e))return e;this.clearFocus()},set:function(e){this.focusCell(e,{doSelect:!1})}},{key:"isActionableLocation",get:function(){var e=this._focusedCell;return Boolean(e&&e.element&&this.getCell(e).contains(e.element))}},{key:"focusedRecord",get:function(){if(this._focusedCell)return this.store.getById(this._focusedCell.id)}},{key:"cellCSSSelector",get:function(){var e=this._focusedCell,t=e&&this.getRowById(e.id);return e&&t?"[data-index=".concat(t.index,"] [data-column-id=").concat(e.columnId,"]"):""}},{key:"onGridElementFocus",value:function(e){var t=this,n={doSelect:!1,event:e};if(t._initialFocusedCellContext){var r=t._initialFocusedCellContext,i=r.cellSelector,o=r.options;t._focusedCell=null,t.focusCell(i,o),t._initialFocusedCellContext=null}else if(t._focusedCell)t.focusCell(t._focusedCell,n);else{var a=t.element.contains(e.relatedTarget)?null:t.lastFocusedCell;if(a){var s=t.getCell(a);if(!s||!mi.isVisible(s)||!t.store.getById(a.id))return void t.revertFocus();t.returningFocus=!0,t.focusCell(a,n),t.returningFocus=!1}else if(!t.scrolling&&!t.skipFocusSelection&&t.store.first){var l=t.mouseMoveEvent,u=t.rowManager,c=t._bodyRectangle,f=l&&u.getRowAt(Math.min(Math.max(l.clientY,c.y),c.bottom))||t.firstFullyVisibleRow,d=l&&t.getCellDataFromEvent(l)||{id:f.id,columnId:t.columns.visibleColumns[0].id};t.getCell(d)&&t.focusCell(d,n)}}t.skipFocusSelection=!1}},{key:"onFocusOut",value:function(e){tt()(Ze()(n.prototype),"onFocusOut",this).call(this,e),this.clearFocus()}},{key:"afterHide",value:function(){tt()(Ze()(n.prototype),"afterHide",this).apply(this,arguments),this.lastFocusedCell=this.mouseMoveEvent=null}},{key:"isFocused",value:function(e){return Boolean(this._focusedCell)&&this.isLocationEqual(e,this._focusedCell)}},{key:"focusCell",value:function(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bb;if(document.hasFocus()||!pe.a.isMac||2!==(null===(t=i)||void 0===t||null===(n=t.event)||void 0===n?void 0:n.button)){var o=this,a=mi.getActiveElement(o);e=o.normalizeCellContext(e===Object?Object.assign({},e):e);var s=!1!==i.doSelect,l=i,u=l.event,c=l.scroll,f=o.lastFocusedCell=o._focusedCell,d=o.isLocationEqual(e,f),h=f&&o.getCell(f),v=o.getSubGridFromColumn(e.columnId),p=o.getCell(e);if(u&&"mousedown"===u.type)for(var g=u.target;g!==p;g=g.parentElement)if(mi.isFocusable(g))return void(e.element=g);if(d)return u&&o.onCellNavigate&&o.onCellNavigate(o,null,o._focusedCell,u,s),e;h&&h.classList.remove("b-focused");var y=p||o.getCell({row:o.rowManager.topIndex,columnId:e.columnId}),m=Cr.from(v.element),b=Cr.from(o.bodyContainer),k=Cr.from(y).moveTo(null,m.y);return!1===c?i=Object.assign({},i,jb):(i=Object.assign({},i,c),k.width>m.width||k.height>b.height?i.x=i.y=!1:i.column=e.columnId,o.scrollRowIntoView(e.id,i)),a===o.focusElement||o.focusElement.contains(a)||(null===(r=uc.fromElement(a))||void 0===r?void 0:r.owner)===o?((p=o.getCell(e))&&(e.element=p,p.classList.add("b-focused")),o._focusedCell=e,o.onCellNavigate&&o.onCellNavigate(o,f,o._focusedCell,u,s),o.trigger("navigate",{lastFocusedCell:f,focusedCell:o._focusedCell,event:u}),e):(o._initialFocusedCellContext={cellSelector:e,options:i},mi.focusWithoutScrolling(o.focusElement),void(o.isLocationEqual(e,o._focusedCell)||pe.a.isIE11||(o._initialFocusedCellContext=null)))}}},{key:"isLocationEqual",value:function(e,t){return e&&t&&e.id===t.id&&e.columnId===t.columnId&&(!e.element||!t.element||e.element===t.element)}},{key:"blurCell",value:function(e){var t=this.getCell(e);t&&t.classList.remove("b-focused")}},{key:"clearFocus",value:function(e){var t=this;t._focusedCell&&(t.lastFocusedCell=e?null:t._focusedCell,t.blurCell(t._focusedCell),t._focusedCell=null)}},{key:"internalNextPrevCell",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this,r=n._focusedCell;return r?n.focusCell({id:r.id,columnId:n.columns.getAdjacentVisibleLeafColumn(r.columnId,e,!0).id},{doSelect:!0,event:t}):null}},{key:"navigateRight",value:function(e){return this.internalNextPrevCell(!0,e)}},{key:"navigateLeft",value:function(e){return this.internalNextPrevCell(!1,e)}},{key:"internalNextPrevRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this,o=i._focusedCell;if(!o)return!1;var a=i.store["get".concat(e?"Next":"Prev")](o.id,!1,t);return a?i.focusCell({id:a.id,columnId:o.columnId,scroll:{x:!1}},{doSelect:!0,event:n}):!e&&r?(this.clearFocus(),this.getHeaderElement(o.columnId).focus()):void 0}},{key:"navigateDown",value:function(e){return this.internalNextPrevRow(!0,!1,e)}},{key:"navigateUp",value:function(e){return this.internalNextPrevRow(!1,!1,e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridNavigation"}}]),n}(e||$e)}),Hb,Ub,Zb,uk,uh));function kk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bk.initClass(),z.a.setVersion("grid","4.2.1"),bk._$name="GridBase";var wk=function(e){Ye()(n,e);var t=kk(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"Grid"}},{key:"type",get:function(){return"grid"}}]),n}(bk);function Ck(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}wk.initClass(),wk._$name="Grid";var Rk=function(e){Ye()(n,e);var t=Ck(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateStore",value:function(e,t){if(e&&!e.tree)throw new Error("TreeGrid requires a Store configured with tree : true");tt()(Ze()(n.prototype),"updateStore",this).call(this,e,t)}}],[{key:"$name",get:function(){return"TreeGrid"}},{key:"type",get:function(){return"treegrid"}},{key:"configurable",get:function(){return{store:{tree:!0}}}}]),n}(wk);Rk.initClass(),Rk._$name="TreeGrid";n(246),n(261);var Sk=n(279);function xk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ek(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Dk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dk(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Dk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Tk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Ok=function(e){Ye()(n,e);var t=Tk(n);function n(){var e,r,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return B()(this,n),i=t.call(this,o.message||o.request&&te.capitalize(null===(e=o.request)||void 0===e?void 0:e.type)+" failed"||"Crud Manager request failed"),Object.assign(Ng()(i),o),i.action=null===(r=i.request)||void 0===r?void 0:r.type,i}return n}(function(e){Ye()(n,e);var t=Tk(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(n.n(Sk)()(Error))),Mk=function(e,t,n){return e.store&&(e=e.store),t.store&&(t=t.store),(e=e[n]||0)<(t=t[n]||0)?-1:e>t?1:0},Ak=function(e,t){return Mk(e,t,"loadPriority")},Ik=function(e,t){return Mk(e,t,"syncPriority")},Pk=function(e){var t;e.$$meta=e.$meta;var n=[];return e.isEvents||n.push(Ot),e.isDelayable||n.push(el),function(e){Ye()(s,e);var t,n,r,i,o,a=Tk(s);function s(){return B()(this,s),a.apply(this,arguments)}return _()(s,[{key:"isCrudManager",get:function(){return!0}},{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._requestId=0,this.activeRequests={},this.crudStoresIndex={},tt()(Ze()(s.prototype),"construct",this).call(this,e)}},{key:"afterConstruct",value:function(){tt()(Ze()(s.prototype),"afterConstruct",this).call(this),this.autoLoad&&(this._autoLoadPromise=this.doAutoLoad())}},{key:"doAutoLoad",value:function(){return this.load().catch((function(e){}))}},{key:"getStoreDescriptor",value:function(e){return e?e instanceof ts?this.crudStores.find((function(t){return t.store===e})):"object"===I()(e)?this.crudStoresIndex[e.storeId]:this.crudStoresIndex[e]||this.getStoreDescriptor(ts.getStore(e)):null}},{key:"fillStoreDescriptor",value:function(e){var t=e.store,n=t.storeIdProperty,r=void 0===n?this.storeIdProperty:n,i=t.modelClass;return e.storeId||(e.storeId=t[r]),e.idField||(e.idField=i.idField),e.phantomIdField||(e.phantomIdField=i.phantomIdField),e.phantomParentIdField||(e.phantomParentIdField=i.phantomParentIdField),"writeAllFields"in e||(e.writeAllFields=t.writeAllFields),e}},{key:"updateCrudStoreIndex",value:function(){var e=this.crudStoresIndex={};this.crudStores.forEach((function(t){return t.storeId&&(e[t.storeId]=t)}))}},{key:"getCrudStore",value:function(e){var t=this.getStoreDescriptor(e);return null==t?void 0:t.store}},{key:"forEachCrudStore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(!e)throw new Error("Iterator function must be provided");this.crudStores.every((function(n){return!1!==e.call(t,n.store,n.storeId,n)}))}},{key:"crudStores",get:function(){return this._crudStores},set:function(e){this._crudStores=[],this.addCrudStore(e);var t,n=Ek(this._crudStores);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.loadPriority=r.syncPriority=0}}catch(e){n.e(e)}finally{n.f()}}},{key:"orderedCrudStores",get:function(){return this._orderedCrudStores},set:function(e){return this._orderedCrudStores=e}},{key:"syncApplySequence",get:function(){return this._syncApplySequence},set:function(e){this._syncApplySequence=[],this.addStoreToApplySequence(e)}},{key:"internalAddCrudStore",value:function(e){var t,n=this;return e instanceof ts?t={store:e}:"object"===I()(e)?(e.stores?(Array.isArray(e.stores)||(e.stores=[e.stores]),e.stores.forEach((function(t,n){var r=t;"string"==typeof t&&(r={storeId:t}),r.masterStoreInfo=e,e.stores[n]=r}))):e.store||(e={storeId:e.id,store:new ts(e)}),t=e):t={store:ts.getStore(e)},n.fillStoreDescriptor(t),(e=t.store).setCrudManager?e.setCrudManager(n):e.crudManager=n,e.pageSize=null,e.load&&(e.autoCommit=!1,e.autoLoad=!1),n.bindCrudStoreListeners(e),t}},{key:"addCrudStore",value:function(e,t,n){var r;if(e&&(Array.isArray(e)||(e=[e]),e.length)){var i,o,a=this,s=e.map(a.internalAddCrudStore,a);if(void 0===t)(i=a.crudStores).push.apply(i,F()(s));else n&&((n instanceof ts||"object"!==I()(n))&&(n=a.getStoreDescriptor(n)),t+=a.crudStores.indexOf(n)),(o=a.crudStores).splice.apply(o,[t,0].concat(F()(s)));(r=a.orderedCrudStores).push.apply(r,F()(s)),a.updateCrudStoreIndex()}}},{key:"addPrioritizedStore",value:function(e){var t=this;t.hasCrudStore(e)||this.addCrudStore(e,it.findInsertionIndex(e,t.crudStores,Ak)),t.hasApplySequenceStore(e)||this.addStoreToApplySequence(e,it.findInsertionIndex(e,t.syncApplySequence,Ik))}},{key:"hasCrudStore",value:function(e){var t;return null===(t=this.crudStores)||void 0===t?void 0:t.some((function(t){return t===e||t.store===e||t.storeId===e}))}},{key:"removeCrudStore",value:function(e){var t=this,n=t.crudStores,r=n.find((function(t){return t===e||t.store===e||t.storeId===e}));if(!r)throw new Error("Store not found in stores collection");t.unbindCrudStoreListeners(r.store),delete t.crudStoresIndex[r.storeId],it.remove(n,r),t.syncApplySequence&&t.removeStoreFromApplySequence(e)}},{key:"bindCrudStoreListeners",value:function(e){e.on({name:e.id,addConfirmed:"onCrudStoreChange",change:"onCrudStoreChange",destroy:"onCrudStoreDestroy",thisObj:this})}},{key:"unbindCrudStoreListeners",value:function(e){this.detachListeners(e.id)}},{key:"addStoreToApplySequence",value:function(e,t,n){if(e){Array.isArray(e)||(e=[e]);var r=this,i=e.reduce((function(e,t){var n=r.getStoreDescriptor(t);return n&&e.push(n),e}),[]);if(void 0===t){var o;(o=r.syncApplySequence).push.apply(o,F()(i))}else{var a,s=t;n&&((n instanceof ts||"object"!==I()(n))&&(n=r.getStoreDescriptor(n)),s+=r.syncApplySequence.indexOf(n)),(a=r.syncApplySequence).splice.apply(a,[s,0].concat(F()(i)))}var l=r.syncApplySequence.map((function(e){return e.storeId}));r.orderedCrudStores=F()(r.syncApplySequence),r.crudStores.forEach((function(e){l.includes(e.storeId)||r.orderedCrudStores.push(e)}))}}},{key:"removeStoreFromApplySequence",value:function(e){var t=this.syncApplySequence.findIndex((function(t){return t===e||t.store===e||t.storeId===e}));t>-1&&(this.syncApplySequence.splice(t,1),this.orderedCrudStores.splice(t,1))}},{key:"hasApplySequenceStore",value:function(e){return this.syncApplySequence.some((function(t){return t===e||t.store===e||t.storeId===e}))}},{key:"onCrudStoreDestroy",value:function(e){var t=e.source;this.removeCrudStore(t)}},{key:"onCrudStoreChange",value:function(){var e=this;e.crudIgnoreUpdates||(e.crudStoreHasChanges()?(e.trigger("hasChanges"),e.autoSync&&e.scheduleAutoSync()):e.trigger("noChanges"))}},{key:"suspendAutoSync",value:function(){this.autoSyncSuspendCounter++}},{key:"resumeAutoSync",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this;t.autoSyncSuspendCounter--,t.autoSyncSuspendCounter<=0&&(t.autoSyncSuspendCounter=0,t.autoSync&&e&&t.sync())}},{key:"scheduleAutoSync",value:function(){var e=this;e.autoSyncTimerId||e.autoSyncSuspendCounter||(e.autoSyncTimerId=e.setTimeout((function(){e.autoSyncTimerId=null,e.sync().catch((function(e){}))}),e.autoSyncTimeout))}},{key:"triggerFailedRequestEvents",value:(o=Pt()(At.a.mark((function e(t,n,r,i){var o,a,s;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this,a=t.options,s=t.type,o.trigger("requestFail",{requestType:s,response:n,responseText:r,responseOptions:i}),o.trigger(s+"Fail",{response:n,responseOptions:i,responseText:r,options:a});case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return o.apply(this,arguments)})},{key:"internalOnResponse",value:(i=Pt()(At.a.mark((function e(t,n,r){var i,o,a,s;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this,o=n?i.decode(n):null,a=t.options,s=t.type,n&&!o&&console.error("Failed to parse response: "+n),null!=o&&o.success){e.next=6;break}i.triggerFailedRequestEvents(t,o,n,r),e.next=13;break;case 6:if(!1===i.trigger("beforeResponseApply",{requestType:s,response:o})||!1===i.trigger("before"+te.capitalize(s)+"Apply",{response:o,options:a})){e.next=13;break}return i.crudRevision=o.revision,e.next=10,i.applyResponse(t,o,a);case 10:i.trigger("requestDone",{requestType:s,response:o,responseOptions:r}),i.trigger(s,{response:o,responseOptions:r,options:a}),"load"!==s&&i.crudStoreHasChanges()||(i.trigger("noChanges"),"load"===s&&i.emitCrudStoreEvents(t.pack.stores,"afterRequest"));case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"suspendChangesTracking",value:function(){this.crudIgnoreUpdates++}},{key:"resumeChangesTracking",value:function(e){!this.crudIgnoreUpdates||--this.crudIgnoreUpdates||e||this.onCrudStoreChange()}},{key:"isBatchingChanges",get:function(){return this.crudIgnoreUpdates>0}},{key:"crudStoreHasChanges",value:function(e){return e?this.isCrudStoreDirty(this.getCrudStore(e)):this.crudStores.some(this.isCrudStoreDirty)}},{key:"isCrudStoreDirty",value:function(e){return Boolean(null==e?void 0:e.store.changes)}},{key:"emitCrudStoreEvents",value:function(e,t,n){var r,i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xk(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({action:"read"+t},n),o=Ek(this.crudStores);try{for(o.s();!(r=o.n()).done;){var a=r.value;e.includes(a.storeId)&&a.store.trigger(t,i)}}catch(e){o.e(e)}finally{o.f()}}},{key:"getLoadPackage",value:function(e){var t={type:"load",requestId:this.requestId},n=this.crudStores,r=Object.assign({},e);return delete r.request,t.stores=n.map((function(e){var t,n=null==r?void 0:r[e.storeId],i=e.pageSize||(null===(t=e.store)||void 0===t?void 0:t.pageSize);if(n||i){var o=Object.assign({storeId:e.storeId,page:1},n);return i&&(o.pageSize=i),e.currentPage=o.page,n&&delete r[e.storeId],o}return e.storeId})),Object.assign(t,r),t}},{key:"loadCrudStore",value:function(e,t,n){var r=null==t?void 0:t.rows;null!=n&&n.append||null!=t&&t.append?e.add(r):e.data=r,e.trigger("load",{data:r})}},{key:"loadDataToCrudStore",value:function(e,t,n){var r,i=this,o=e.store,a=e.stores,s=e.idField||"id",l=o.tree,u=null==t?void 0:t.rows;(o.__loading=!0,u)&&(a&&(r=i.getSubStoresData(u,a,s,l)),i.loadCrudStore(o,t,n,e),r&&r.forEach((function(e){i.loadDataToCrudStore(Object.assign({store:o.getById(e.id).get(e.storeDesc.storeId)},e.storeDesc),e.data)})));o.__loading=!1}},{key:"loadCrudManagerData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.suspendChangesTracking(),this.crudStores.forEach((function(r){var i=r.storeId,o=e[i];o&&t.loadDataToCrudStore(r,o,n[i])})),this.resumeChangesTracking(!0)}},{key:"isCrudManagerLoading",get:function(){return Boolean(this.activeRequests.load||this.applyingLoadResponse)}},{key:"isCrudManagerSyncing",get:function(){return Boolean(this.activeRequests.sync||this.applyingSyncResponse)}},{key:"isLoadingOrSyncing",get:function(){return Boolean(this.isCrudManagerLoading||this.isCrudManagerSyncing)}},{key:"load",value:function(e){var t=this,n=t.getLoadPackage(e);return new Promise((function(r,i){if(!1!==t.trigger("beforeLoad",{pack:n})){var o=t.activeRequests.load;o&&(t.cancelRequest(o.desc,o.reject),t.trigger("loadCanceled",{pack:n}));var a=he.assign({id:n.requestId,data:t.encode(n),type:"load",success:t.onCrudRequestSuccess,failure:t.onCrudRequestFailure,thisObj:t},null==e?void 0:e.request);t.activeRequests.load={type:"load",options:e,pack:n,resolve:r,reject:function(){a.success=a.failure=null,i.apply(void 0,arguments)},id:n.requestId,desc:t.sendRequest(a)},t.emitCrudStoreEvents(n.stores,"loadStart"),t.trigger("loadStart",{pack:n})}else t.trigger("loadCanceled",{pack:n}),i({cancelled:!0})}))}},{key:"getActiveCrudManagerRequest",value:function(e){var t=this.activeRequests[e];return!t&&this.trackResponseType&&(t=Object.values(this.activeRequests)[0]),t}},{key:"getSubStoresData",value:function(e,t,n,r){var i=this;if(e){var o=[];return r?e.forEach((function(e){a(e,t);var r=i.getSubStoresData(e.children,t,n,!0);r&&o.push.apply(o,F()(r))})):e.forEach((function(e){return a(e,t)})),o}function a(e,t){t.forEach((function(t){var r=t.storeId;e[r]&&(o.push({id:e[n],storeDesc:t,data:e[r]}),delete e[r])}))}}},{key:"prepareAdded",value:function(e,t){var n=this,r=t.store,i=t.stores,o=r.isTree,a=t.phantomIdField||this.phantomIdField,s=t.phantomParentIdField||this.phantomParentIdField;return e.filter((function(e){return e.isValid})).map((function(e){var t=e.constructor,r=Object.assign(e.persistableData,Qe()({},a,e.id));if(o){var l=e.parent;l&&!l.isRoot&&l.isPhantom&&(r[s]=l.id)}return n.resetIdsBeforeSync&&Qn.deletePath(r,t.getFieldDataSource(t.idField)),i&&n.processSubStores(e,r,i),r}))}},{key:"prepareUpdated",value:function(e,t){var n=this,r=t.store,i=t.stores,o=r.isTree,a=t.writeAllFields||!1!==t.writeAllFields&&this.writeAllFields,s=t.phantomParentIdField||this.phantomParentIdField;if(t.store.tree){var l=t.store.rootNode;e=e.filter((function(e){return e!==l}))}return e.filter((function(e){return e.isValid})).reduce((function(e,t){var r;if(r=a?t.persistableData:t.modificationDataToWrite,o){var l=t.parent;l&&!l.isRoot&&l.isPhantom&&(r[s]=l.id)}return i&&n.processSubStores(t,r,i),Qn.isEmpty(r)||e.push(r),e}),[])}},{key:"prepareRemoved",value:function(e){return e.map((function(e){var t=e.constructor;return Qn.setPath({},t.getFieldDataSource(t.idField),e.id)}))}},{key:"processSubStores",value:function(e,t,n){var r=this;n.forEach((function(n){var i=n.storeId,o=e.get(i);if(o){var a=r.getCrudStoreChanges(Object.assign({store:o},n));a?t[i]=Object.assign(a,{$store:!0}):delete t[i]}else delete t[i]}))}},{key:"getCrudStoreChanges",value:function(e){var t,n=e.store.changes||{},r=n.added,i=void 0===r?[]:r,o=n.modified,a=void 0===o?[]:o,s=n.removed,l=void 0===s?[]:s;return i.length&&(i=this.prepareAdded(i,e)),a.length&&(a=this.prepareUpdated(a,e)),l.length&&(l=this.prepareRemoved(l)),(i.length||a.length||l.length)&&(t={},i.length&&(t.added=i),a.length&&(t.updated=a),l.length&&(t.removed=l)),t}},{key:"getChangeSetPackage",value:function(){var e=this.changes;return e?Object.assign({type:"sync",requestId:this.requestId,revision:this.crudRevision},e):null}},{key:"changes",get:function(){var e=this,t={};return this.crudStores.forEach((function(n){var r=e.getCrudStoreChanges(n);r&&(t[n.storeId]=r)})),Object.keys(t).length>0?t:null}},{key:"applyChangesToRecord",value:function(e,t,n){var r,i=this,o=e.constructor,a=o.fieldDataSourceMap,s=o.prototype,l={},u=e.data,c=Qe()({},i.phantomIdField,!0);n&&n.forEach((function(n){var r=n.storeId;if(Object.prototype.hasOwnProperty.call(t,r)){c[r]=!0;var o=e.get(r);o?i.applyChangesToStore(Object.assign({store:o},n),t[r]):console.log("Can't find store for the response sub-package")}}));var f={};for(var d in t)Object.prototype.hasOwnProperty.call(t,d)&&!c[d]&&(f[d]=t[d]);var h=Qn.pathifyKeys(f);for(var v in h){var p=a[v],g=p?p.name:v,y=o.processField(g,h[v]),m=v in s?e[g]:Qn.getPath(u,v);(null!=p&&p.isEqual?p.isEqual(m,y):Qn.isEqual(m,y))||(r=!0,l[g]=y)}if(r){for(var b in i.suspendChangesTracking(),l)e[b]=l[b];i.resumeChangesTracking(!0)}i.clearRecordChanges(e,l)}},{key:"clearRecordChanges",value:function(e,t){e.clearChanges(!0,!1)}},{key:"applyRemovals",value:function(e,t,n){var r=this,i=e.removed,o=e.modelClass,a=o.getFieldDataSource(o.idField),s=0;return null==t||t.forEach((function(t){var n=t[a],o=!1;if(i.includes(n)&&(i.remove(n),o=!0,s++),!o){var l=e.getById(n);l?(r.suspendChangesTracking(),l.remove(),i.remove(l),s++,r.resumeChangesTracking(!0)):console.log("Can't find record to remove from the response package")}})),s}},{key:"getRowsToApplyChangesTo",value:function(e,t,n){var r,i,o,a,s=e.store,l=(e.storeId,s.modelClass),u=l.getFieldDataSource(l.idField),c=n||{},f=c.updated,d=c.removed;if(t){var h={};o=t.rows||[],a=t.removed||[],[].concat(F()(o),F()(a)).forEach((function(e){var t=Qn.getPath(e,u);h[t]=!0})),this.supportShortSyncResponse&&(null==f||f.forEach((function(e){var t=Qn.getPath(e,u);h[t]||o.push(Qe()({},u,t))})),null==d||d.forEach((function(e){var t=Qn.getPath(e,u);h[t]||a.push(Qe()({},u,t))})))}else(f||d)&&(o=f,a=d);return o=null!==(r=o)&&void 0!==r&&r.length?o:null,a=null!==(i=a)&&void 0!==i&&i.length?a:null,{rows:o,removed:a}}},{key:"applyChangesToStore",value:function(e,t,n){var r=this,i=e.phantomIdField||r.phantomIdField,o=e.store,a=e.stores,s=o.modelClass,l=s.getFieldDataSource(s.idField),u=r.getRowsToApplyChangesTo(e,t,n),c=u.rows,f=u.removed;null==c||c.forEach((function(e){var t=e[i],n=Qn.getPath(e,l),s=null;null!=t?s=o.getById(t):null!=n&&(s=o.getById(n)),s?r.applyChangesToRecord(s,e,a,o):(r.suspendChangesTracking(),s=o.add(e)[0],r.resumeChangesTracking(!0),s.clearChanges())})),f&&r.applyRemovals(o,f)&&o.trigger("dataChanged",{source:o})}},{key:"applySyncResponse",value:function(e,t){var n=this,r=n.orderedCrudStores;n.applyingSyncResponse=!0;var i,o=Ek(r);try{for(o.s();!(i=o.n()).done;){var a,s=i.value;n.applyChangesToStore(s,e[s.storeId],null==t||null===(a=t.pack)||void 0===a?void 0:a[s.storeId])}}catch(e){o.e(e)}finally{o.f()}n.applyingSyncResponse=!1}},{key:"applyLoadResponse",value:function(e,t){this.applyingLoadResponse=!0,this.loadCrudManagerData(e,t),this.applyingLoadResponse=!1}},{key:"applyResponse",value:(r=Pt()(At.a.mark((function e(t,n,r){var i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.type,this.trackResponseType&&(i=n.type||t.type),e.t0=i,e.next="load"===e.t0?5:"sync"===e.t0?7:9;break;case 5:return this.applyLoadResponse(n,r),e.abrupt("break",9);case 7:return this.applySyncResponse(n,t),e.abrupt("break",9);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"requestId",get:function(){return Number.parseInt("".concat(Date.now()).concat(this._requestId++))}},{key:"sync",value:function(){var e=this;return e.activeRequests.sync?(e.trigger("syncDelayed"),e.activeSyncPromise=e.activeSyncPromise.finally((function(){return e.sync()}))):e.activeSyncPromise=new Promise((function(t,n){var r=e.getChangeSetPackage();r?!1!==e.trigger("beforeSync",{pack:r})?(e.trigger("syncStart",{pack:r}),e.activeRequests.sync={type:"sync",pack:r,resolve:t,reject:n,id:r.requestId,desc:e.sendRequest({id:r.requestId,data:e.encode(r),type:"sync",success:e.onCrudRequestSuccess,failure:e.onCrudRequestFailure,thisObj:e})}):(e.trigger("syncCanceled",{pack:r}),n({cancelled:!0})):t(null)})).catch((function(e){if(e&&!e.cancelled)throw e;return e}))}},{key:"onCrudRequestSuccess",value:(n=Pt()(At.a.mark((function e(t,n,r){var i,o,a,s,l,u,c;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,s=(a=r).type,l=a.id,!o.isDestroyed){e.next=3;break}return e.abrupt("return");case 3:return u="",r=o.activeRequests[s],e.prev=5,e.next=8,t.text();case 8:u=e.sent,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:if(!o.isDestroyed){e.next=15;break}return e.abrupt("return");case 15:if((null===(i=r)||void 0===i?void 0:i.id)===l){e.next=17;break}throw new Error("Interleaved ".concat(s," operation detected"));case 17:return o.activeRequests[s]=null,e.next=20,o.internalOnResponse(r,u,n);case 20:if(c=e.sent,!o.isDestroyed){e.next=23;break}return e.abrupt("return");case 23:null!=c&&c.success||r.reject(new Ok({rawResponse:t,response:c,request:r})),o["crud"+te.capitalize(r.type)+"ed"]=!0,r.resolve({response:c,rawResponse:t,responseText:u,request:r});case 26:case"end":return e.stop()}}),e,this,[[5,11]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"onCrudRequestFailure",value:(t=Pt()(At.a.mark((function e(t,n,r){var i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDestroyed){e.next=2;break}return e.abrupt("return");case 2:if(r=this.activeRequests[r.type],o=null==n||null===(i=n.abortController)||void 0===i?void 0:i.signal,Boolean(null==o?void 0:o.aborted)){e.next=20;break}return a="",e.prev=6,e.next=9,t.text();case 9:a=e.sent,e.next=14;break;case 12:e.prev=12,e.t0=e.catch(6);case 14:if(!this.isDestroyed){e.next=16;break}return e.abrupt("return");case 16:if(this.triggerFailedRequestEvents(r,null,a,n),!this.isDestroyed){e.next=19;break}return e.abrupt("return");case 19:r.reject(new Ok({rawResponse:t,request:r}));case 20:this.activeRequests[r.type]=null;case 21:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e,n,r){return t.apply(this,arguments)})},{key:"commitCrudStores",value:function(){z.a.deprecate("Scheduler","5.0.0","commitCrudStores is deprecated, in favor of acceptChanges"),this.acceptChanges()}},{key:"acceptChanges",value:function(){this.crudStores.forEach((function(e){return e.store.acceptChanges()}))}},{key:"revertChanges",value:function(){this.orderedCrudStores.forEach((function(e){return e.store.revertChanges()}))}},{key:"rejectCrudStores",value:function(){z.a.deprecate("Scheduler","5.0.0","rejectCrudStores is deprecated, in favor of revertChanges"),this.revertChanges()}},{key:"doDestroy",value:function(){var e=this,t=e.activeRequests,n=t.load,r=t.sync;for(n&&e.cancelRequest(n.desc,n.reject),r&&e.cancelRequest(r.desc,r.reject);e.crudStores.length>0;)e.removeCrudStore(e.crudStores[0]);tt()(Ze()(s.prototype),"doDestroy",this)&&tt()(Ze()(s.prototype),"doDestroy",this).call(this)}}],[{key:"$name",get:function(){return"AbstractCrudManagerMixin"}},{key:"defaultConfig",get:function(){return{crudRevision:null,crudStores:[],storeIdProperty:"storeId",crudFilterParam:"filter",transport:{},trackResponseType:!1,supportShortSyncResponse:!0,phantomIdField:"$PhantomId",phantomParentIdField:"$PhantomParentId",autoLoad:!1,autoSyncTimeout:100,autoSync:!1,resetIdsBeforeSync:!0,syncApplySequence:[],orderedCrudStores:[],writeAllFields:!1,crudIgnoreUpdates:0,autoSyncSuspendCounter:0,crudLoaded:!1,autoSyncTimerId:null,applyingLoadResponse:!1,applyingSyncResponse:!1,callOnFunctions:!0}}}]),s}((t=e||$e).mixin.apply(t,n))};function Fk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Lk=function(e){Ye()(n,e);var t=Fk(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"revision",get:function(){return this.crudRevision},set:function(e){this.crudRevision=e}},{key:"json",get:function(){return te.safeJsonStringify(this)},set:function(e){"string"==typeof e&&(e=te.safeJsonParse(e)),this.forEachCrudStore((function(t){var n="".concat(t.storeId,"Data");e[n]&&(t.data=e[n])}))}},{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.stores&&(e.crudStores=e.stores,delete e.stores),tt()(Ze()(n.prototype),"construct",this).call(this,e)}},{key:"toJSON",value:function(){var e={};return this.forEachCrudStore((function(t,n){return e["".concat(n,"Data")]=t.toJSON()})),e}},{key:"inlineData",get:function(){return this.toJSON()},set:function(e){this.json=e}},{key:"stores",get:function(){return this.crudStores},set:function(e){e!==this.crudStores&&(this.crudStores=e)}},{key:"isLoading",get:function(){return this.isCrudManagerLoading}},{key:"commit",value:function(){z.a.deprecate("Scheduler","5.0.0","commit is deprecated, in favor of acceptChanges"),this.commitCrudStores()}},{key:"reject",value:function(){z.a.deprecate("Scheduler","5.0.0","reject is deprecated, in favor of revertChanges"),this.revertChanges()}},{key:"addStore",value:function(){return this.addCrudStore.apply(this,arguments)}},{key:"removeStore",value:function(){return this.removeCrudStore.apply(this,arguments)}},{key:"getStore",value:function(){return this.getCrudStore.apply(this,arguments)}},{key:"hasChanges",value:function(){return this.crudStoreHasChanges.apply(this,arguments)}},{key:"loadData",value:function(){return this.loadCrudManagerData.apply(this,arguments)}}],[{key:"defaultConfig",get:function(){return{stores:null}}}]),n}($e.mixin(Pk));function Bk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Lk._$name="AbstractCrudManager";var jk=function(e){return function(e){Ye()(n,e);var t=Bk(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"cancelRequest",value:function(e,t){var n;null===(n=e.abort)||void 0===n||n.call(e),t({cancelled:!0})}},{key:"shouldUseBodyForRequestData",value:function(e,t,n){return!("HEAD"===t||"GET"===t||n)}},{key:"sendRequest",value:function(e){var t=this,r=e.data,i=t.transport[e.type]||{},o=he.assign({},i,i.requestConfig);o.method=o.method||n.defaultMethod[e.type],o.params=he.assign(o.params||{},e.params);var a=o.paramName;if(t.shouldUseBodyForRequestData(i,o.method,a)?(o.body=r,o.headers=o.headers||{},o.headers["Content-Type"]=o.headers["Content-Type"]||"application/json"):(a=a||"data",o.params[a]=r),!o.url)throw new Error("Trying to request without URL specified");delete o.requestConfig,delete o.paramName,t.trigger("beforeSend",{params:o.params,type:e.type,requestConfig:o,config:e}),o.queryParams=o.params,delete o.params;var s,l=!1,u=he.assign({},o,o.fetchOptions),c=Vt.fetch(o.url,u);c.catch((function(e){var t;c.done=!0;var n=null===(t=u.abortController)||void 0===t?void 0:t.signal;return n&&((l=n.aborted)||console.warn(e)),{error:e,cancelled:l}})).then((function(n){c.done=!0;var r=null!=n&&n.ok?e.success:e.failure;s=null==r?void 0:r.call(e.thisObj||t,n,u,e)}));var f=Promise.all([c,s]);return f.abort=function(){var e;c.done||(null===(e=c.abort)||void 0===e||e.call(c))},f}}],[{key:"$name",get:function(){return"AjaxTransport"}},{key:"defaultMethod",get:function(){return{load:"GET",sync:"POST"}}}]),n}(e||$e)};function _k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Hk=function(e){return function(e){Ye()(n,e);var t=_k(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"encode",value:function(e){var t;return e=Object.assign({},null===(t=this.encoder)||void 0===t?void 0:t.requestData,e),te.safeJsonStringify(e)}},{key:"decode",value:function(e){return te.safeJsonParse(e)}}],[{key:"$name",get:function(){return"JsonEncoder"}},{key:"defaultConfig",get:function(){return{encoder:{}}}}]),n}(e||$e)};function Nk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var zk=function(e){return function(e){Ye()(n,e);var t=Nk(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"afterConstruct",value:function(){tt()(Ze()(n.prototype),"afterConstruct",this).call(this);var e=this.crudManager,t=this.project;this.loadMask&&(e||t).isCrudManagerLoading&&this.onCrudManagerLoadStart()}},{key:"applySyncMask",value:function(){var e=this.syncMask;e&&(this.masked=qu.mergeConfigs(this.loadMaskDefaults,e))}},{key:"bindCrudManager",value:function(e){this.detachListeners("crudManager"),null==e||e.on({name:"crudManager",loadStart:"onCrudManagerLoadStart",load:"onCrudManagerLoad",loadCanceled:"onCrudManagerLoadCanceled",syncStart:"onCrudManagerSyncStart",sync:"onCrudManagerSync",syncCanceled:"onCrudManagerSyncCanceled",requestFail:"onCrudManagerRequestFail",thisObj:this})}},{key:"onCrudManagerLoadStart",value:function(){var e;this.applyLoadMask(),null===(e=this.toggleEmptyText)||void 0===e||e.call(this)}},{key:"onCrudManagerSyncStart",value:function(){this.applySyncMask()}},{key:"onCrudManagerRequestFinalize",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=this;t?(i.masked=null,null===(e=i.toggleEmptyText)||void 0===e||e.call(i)):i.applyMaskError('<div class="b-grid-load-failure">\n                    <div class="b-grid-load-fail">'.concat(i.L("L{GridBase.".concat(n,"FailedMessage}")),"</div>\n                    ").concat(r&&r.message?'<div class="b-grid-load-fail">'.concat(i.L("L{CrudManagerView.serverResponseLabel}")," ").concat(r.message,"</div>"):"","\n                </div>"))}},{key:"onCrudManagerLoadCanceled",value:function(){this.onCrudManagerRequestFinalize(!0,"load")}},{key:"onCrudManagerSyncCanceled",value:function(){this.onCrudManagerRequestFinalize(!0,"sync")}},{key:"onCrudManagerLoad",value:function(){this.onCrudManagerRequestFinalize(!0,"load")}},{key:"onCrudManagerSync",value:function(){this.onCrudManagerRequestFinalize(!0,"sync"),this.refresh()}},{key:"onCrudManagerRequestFail",value:function(e){var t=e.requestType,n=e.response;this.onCrudManagerRequestFinalize(!1,t,n)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"CrudManagerView"}}]),n}(e.mixin(uh))};function Vk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Wk=function(e){return function(e){Ye()(n,e);var t=Vk(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onIsCreatingToggle",value:function(e,t){var r;tt()(Ze()(n.prototype),"onIsCreatingToggle",this).call(this,e,t),!e.isCreating&&null!==(r=this.project)&&void 0!==r&&r.autoSync&&this.project.sync()}}],[{key:"$name",get:function(){return"PartOfProject"}}]),n}(e||$e)};function $k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Uk=function(e){return function(e){Ye()(n,e);var t=$k(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t;null!=(e=e||{}).eventId&&(e.event=e.eventId),null!=e.resourceId&&(e.resource=e.resourceId);for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=tt()(Ze()(n.prototype),"construct",this)).call.apply(t,[this,e].concat(i))}},{key:"eventResourceKey",get:function(){var e=this;return"".concat(e.event?e.eventId:e.getData("eventId")||e.internalId,"-").concat(e.resource?e.resourceId:e.getData("resourceId")||e.internalId)}},{key:"set",value:function(e,t){var r,i,o,a=this.fieldToKeys(e,t);"resource"in a&&(a.resourceId=null===(i=a.resource)||void 0===i?void 0:i.id);"event"in a&&(a.eventId=null===(o=a.event)||void 0===o?void 0:o.id);for(var s=arguments.length,l=new Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];(r=tt()(Ze()(n.prototype),"set",this)).call.apply(r,[this,a,null].concat(l))}},{key:"resourceId",get:function(){var e;return this.get("resourceId")||(null===(e=this.resource)||void 0===e?void 0:e.id)},set:function(e){var t=this.resource;null!=t&&t.isModel&&t.id===e?this.set("resourceId",e):this.resource=e}},{key:"eventId",get:function(){var e;return this.get("eventId")||(null===(e=this.event)||void 0===e?void 0:e.id)},set:function(e){var t=this.event;null!=t&&t.isModel&&t.id===e?this.set("eventId",e):this.event=e}},{key:"eventName",get:function(){var e;return null===(e=this.event)||void 0===e?void 0:e.name}},{key:"resourceName",get:function(){var e;return null===(e=this.resource)||void 0===e?void 0:e.name}},{key:"getResource",value:function(){return this.resource}},{key:"isAssignment",get:function(){return!0}},{key:"isPersistable",get:function(){var e=this.event,t=this.resource,r=this.unjoinedStores,i=this.assignmentStore,o=null==i?void 0:i.crudManager;return(i?this.isValid&&e.isPersistable&&(o||!e.hasGeneratedId&&!t.hasGeneratedId):!this.isPhantom&&Boolean(r[0]))&&tt()(Ze()(n.prototype),"isPersistable",this)}},{key:"isValid",get:function(){return null!=this.resource&&null!=this.event}},{key:"toString",value:function(){return this.resourceName?"".concat(this.resourceName," ").concat(this.units,"%"):""}}],[{key:"$name",get:function(){return"AssignmentModelMixin"}},{key:"fields",get:function(){return["resourceId","eventId",{name:"drawDependencies",type:"boolean"},"event","resource"]}}]),n}(e)};n(228),n(239);function Gk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Yk=At.a.mark(iw),qk=At.a.mark(ow),Kk=At.a.mark(aw),Xk=At.a.mark(sw),Zk=At.a.mark(lw),Jk=At.a.mark(uw),Qk=At.a.mark(cw),ew=At.a.mark(fw);function tw(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return nw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nw(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function nw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rw(e){var t,n=[],r=[],i=At.a.mark((function i(){var o,a;return At.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t||(t=e[Symbol.iterator]());case 1:if(!n.length){i.next=5;break}return i.delegateYield(n,"t0",4);case 4:n.length=0;case 5:if(t){i.next=7;break}return i.abrupt("break",17);case 7:if(o=t.next(),a=o.value,!o.done){i.next=12;break}return t=null,e=null,i.abrupt("break",17);case 12:return r.push(a),i.next=15,a;case 15:i.next=1;break;case 17:case"end":return i.stop()}}),i)})),o=At.a.mark((function i(){var o,a;return At.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t||(t=e[Symbol.iterator]());case 1:if(!r.length){i.next=5;break}return i.delegateYield(r,"t0",4);case 4:r.length=0;case 5:if(t){i.next=7;break}return i.abrupt("break",17);case 7:if(o=t.next(),a=o.value,!o.done){i.next=12;break}return t=null,e=null,i.abrupt("break",17);case 12:return n.push(a),i.next=15,a;case 15:i.next=1;break;case 17:case"end":return i.stop()}}),i)}));return[i(),o()]}function iw(e,t){var n,r,i,o;return At.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(t<0)){a.next=2;break}throw new Error("Batch size needs to a natural number");case 2:t|=0,n=[],r=tw(e),a.prev=5,r.s();case 7:if((i=r.n()).done){a.next=16;break}if(o=i.value,n.length!==t){a.next=13;break}return a.next=12,n;case 12:n.length=0;case 13:n.push(o);case 14:a.next=7;break;case 16:a.next=21;break;case 18:a.prev=18,a.t0=a.catch(5),r.e(a.t0);case 21:return a.prev=21,r.f(),a.finish(21);case 24:if(!(n.length>0)){a.next=27;break}return a.next=27,n;case 27:case"end":return a.stop()}}),Yk,null,[[5,18,21,24]])}function ow(e,t){var n,r,i,o;return At.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0,r=tw(e),a.prev=2,r.s();case 4:if((i=r.n()).done){a.next=11;break}if(o=i.value,!t(o,n++)){a.next=9;break}return a.next=9,o;case 9:a.next=4;break;case 11:a.next=16;break;case 13:a.prev=13,a.t0=a.catch(2),r.e(a.t0);case 16:return a.prev=16,r.f(),a.finish(16);case 19:case"end":return a.stop()}}),qk,null,[[2,13,16,19]])}function aw(e,t){var n,r,i,o;return At.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0,r=tw(e),a.prev=2,r.s();case 4:if((i=r.n()).done){a.next=11;break}if(o=i.value,!(++n>t)){a.next=9;break}return a.next=9,o;case 9:a.next=4;break;case 11:a.next=16;break;case 13:a.prev=13,a.t0=a.catch(2),r.e(a.t0);case 16:return a.prev=16,r.f(),a.finish(16);case 19:case"end":return a.stop()}}),Kk,null,[[2,13,16,19]])}function sw(e,t){var n,r,i,o;return At.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0,r=tw(e),a.prev=2,r.s();case 4:if((i=r.n()).done){a.next=10;break}return o=i.value,a.next=8,t(o,n++);case 8:a.next=4;break;case 10:a.next=15;break;case 12:a.prev=12,a.t0=a.catch(2),r.e(a.t0);case 15:return a.prev=15,r.f(),a.finish(15);case 18:case"end":return a.stop()}}),Xk,null,[[2,12,15,18]])}function lw(e){var t,n,r,i;return At.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t=new Set,n=tw(e),o.prev=2,n.s();case 4:if((r=n.n()).done){o.next=12;break}if(i=r.value,t.has(i)){o.next=10;break}return t.add(i),o.next=10,i;case 10:o.next=4;break;case 12:o.next=17;break;case 14:o.prev=14,o.t0=o.catch(2),n.e(o.t0);case 17:return o.prev=17,n.f(),o.finish(17);case 20:case"end":return o.stop()}}),Zk,null,[[2,14,17,20]])}function uw(e,t){var n,r,i,o,a;return At.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:n=new Set,r=tw(e),s.prev=2,r.s();case 4:if((i=r.n()).done){s.next=13;break}if(o=i.value,a=t(o),n.has(a)){s.next=11;break}return n.add(a),s.next=11,o;case 11:s.next=4;break;case 13:s.next=18;break;case 15:s.prev=15,s.t0=s.catch(2),r.e(s.t0);case 18:return s.prev=18,r.f(),s.finish(18);case 21:case"end":return s.stop()}}),Jk,null,[[2,15,18,21]])}function cw(e,t){var n,r,i,o;return At.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0,r=tw(e),a.prev=2,r.s();case 4:if((i=r.n()).done){a.next=14;break}if(o=i.value,!t(o,n++)){a.next=11;break}return a.next=9,o;case 9:a.next=12;break;case 11:return a.abrupt("return");case 12:a.next=4;break;case 14:a.next=19;break;case 16:a.prev=16,a.t0=a.catch(2),r.e(a.t0);case 19:return a.prev=19,r.f(),a.finish(19);case 22:case"end":return a.stop()}}),Qk,null,[[2,16,19,22]])}function fw(e){var t,n,r;return At.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=tw(e),i.prev=1,t.s();case 3:if((n=t.n()).done){i.next=8;break}return r=n.value,i.delegateYield(r,"t0",6);case 6:i.next=3;break;case 8:i.next=13;break;case 10:i.prev=10,i.t1=i.catch(1),t.e(i.t1);case 13:return i.prev=13,t.f(),i.finish(13);case 16:case"end":return i.stop()}}),ew,null,[[1,10,13,16]])}var dw=function(){function e(t){if(B()(this,e),this.iterable=void 0,!t)throw new Error("Require an iterable instance for chaining");this.iterable=t}return _()(e,[{key:"derive",value:function(t){return this.iterable=void 0,new e(t)}},{key:"copy",value:function(){var t=rw(this.iterable),n=N()(t,2),r=n[0],i=n[1];return this.iterable=i,new e(r)}},{key:"split",value:function(){var t=rw(this.iterable),n=N()(t,2),r=n[0],i=n[1];return[new e(r),this.derive(i)]}},{key:"inBatchesBySize",value:function(e){return this.derive(iw(this.iterable,e))}},{key:"filter",value:function(e){return this.derive(ow(this.iterable,e))}},{key:"drop",value:function(e){return this.derive(aw(this.iterable,e))}},{key:"map",value:function(e){return this.derive(sw(this.iterable,e))}},{key:"reduce",value:function(e,t){return function(e,t,n){var r,i=0,o=n,a=tw(e);try{for(a.s();!(r=a.n()).done;)o=t(o,r.value,i++)}catch(e){a.e(e)}finally{a.f()}return o}(this,e,t)}},{key:"concat",value:function(){return this.derive(fw(this.iterable))}},{key:"uniqueOnly",value:function(){return this.derive(lw(this.iterable))}},{key:"uniqueOnlyBy",value:function(e){return this.derive(uw(this.iterable,e))}},{key:"every",value:function(e){return function(e,t){var n,r=0,i=tw(e);try{for(i.s();!(n=i.n()).done;)if(!t(n.value,r++))return!1}catch(e){i.e(e)}finally{i.f()}return!0}(this,e)}},{key:"some",value:function(e){return function(e,t){var n,r=0,i=tw(e);try{for(i.s();!(n=i.n()).done;)if(t(n.value,r++))return!0}catch(e){i.e(e)}finally{i.f()}return!1}(this,e)}},{key:"takeWhile",value:function(e){return this.derive(cw(this.iterable,e))}},{key:Symbol.iterator,value:At.a.mark((function e(){var t;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.iterable){e.next=3;break}throw new Error("Chained iterator already exhausted or used to derive the new one");case 3:return this.iterable=void 0,e.delegateYield(t,"t0",5);case 5:t=void 0;case 6:case"end":return e.stop()}}),e,this)}))},{key:"toArray",value:function(){return Array.from(this)}},{key:"sort",value:function(e){return Array.from(this).sort(e)}},{key:"toSet",value:function(){return new Set(this)}},{key:"toMap",value:function(){return new Map(this)}},{key:"flush",value:function(){var e,t=tw(this);try{for(t.s();!(e=t.n()).done;)e.value}catch(e){t.e(e)}finally{t.f()}}},{key:"memoize",value:function(){return new vw(this)}}]),e}(),hw=function(e){return new dw(e)},vw=function(e){Ye()(n,e);var t=Gk(n);function n(){var e;return B()(this,n),(e=t.apply(this,arguments)).elements=[],e.$iterator=void 0,e}return _()(n,[{key:"iterable",get:function(){return this},set:function(e){this.$iterable=e}},{key:"derive",value:function(e){return new dw(e)}},{key:Symbol.iterator,value:At.a.mark((function e(){var t,n,r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.elements,!this.$iterable){e.next=33;break}if(this.$iterator||(this.$iterator=this.$iterable[Symbol.iterator]()),n=this.$iterator,!((r=t.length)>0)){e.next=7;break}return e.delegateYield(t,"t0",7);case 7:if(!(t.length>r)){e.next=17;break}i=r;case 10:if(!(i<t.length)){e.next=16;break}return e.next=13,t[i];case 13:i++,e.next=10;break;case 16:r=t.length;case 17:if(n){e.next=19;break}return e.abrupt("break",31);case 19:if(o=n.next(),a=o.value,!o.done){e.next=25;break}n=this.$iterator=null,this.$iterable=null,e.next=29;break;case 25:return t.push(a),r++,e.next=29,a;case 29:e.next=7;break;case 31:e.next=34;break;case 33:return e.delegateYield(t,"t1",34);case 34:case"end":return e.stop()}}),e,this)}))}]),n}(dw),pw=function(e){return new vw(e)};function gw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var yw=Symbol("MixinIdentity"),mw=Symbol("MixinStateProperty"),bw=function(){function e(){B()(this,e),this.baseEl=void 0,this.sourceEl=void 0,this.$elementsByTopoLevel=void 0,this.$topoLevels=void 0,this.linearizedByTopoLevelsSource=pw(this.linearizedByTopoLevels())}return _()(e,[{key:"topoLevels",get:function(){return void 0!==this.$topoLevels?this.$topoLevels:this.$topoLevels=this.buildTopoLevels()}},{key:"buildTopoLevels",value:function(){return Array.from(this.elementsByTopoLevel.keys()).sort((function(e,t){return e-t}))}},{key:"elementsByTopoLevel",get:function(){return void 0!==this.$elementsByTopoLevel?this.$elementsByTopoLevel:this.$elementsByTopoLevel=this.buildElementsByTopoLevel()}},{key:"getOrCreateLevel",value:function(e,t){var n=e.get(t);return n||(n=[],e.set(t,n)),n}},{key:"buildElementsByTopoLevel",value:function(){var e=this,t=0,n=this.baseEl?hw(this.baseEl.walkDepthState.elementsByTopoLevel.values()).concat().toSet():new Set,r=hw(this.sourceEl.requirements).map((function(e){return e.walkDepthState.elementsByTopoLevel})).concat().reduce((function(n,r){var i=N()(r,2),o=i[0],a=i[1];return o>t&&(t=o),e.getOrCreateLevel(n,o).push(a),n}),new Map);return this.getOrCreateLevel(r,t+1).push([this.sourceEl]),hw(r).map((function(e){var t=N()(e,2),r=t[0],i=t[1];return[r,hw(i).concat().uniqueOnly().filter((function(e){return!n.has(e)})).sort((function(e,t){return e.id-t.id}))]})).toMap()}},{key:"linearizedByTopoLevels",value:At.a.mark((function e(){var t=this;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(hw(this.topoLevels).map((function(e){return t.elementsByTopoLevel.get(e)})).concat(),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))}],[{key:"new",value:function(e){var t=new this;return e&&Object.assign(t,e),t}}]),e}(),kw=1,ww=function(e){return function(e){Ye()(n,e);var t=gw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(e)},Cw=function e(){B()(this,e)},Rw=function(){function e(){B()(this,e),this.id=kw++,this.requirements=[],this.baseClass=Cw,this.identitySymbol=void 0,this.mixinLambda=ww,this.walkDepthState=void 0,this.$minimalClass=void 0,this.name=""}return _()(e,[{key:"minimalClass",get:function(){return void 0!==this.$minimalClass?this.$minimalClass:this.$minimalClass=this.buildMinimalClass()}},{key:"getBaseClassMixinId",value:function(e){var t=this.constructor,n=t.baseClassesIds.get(e);if(void 0!==n)return n;var r=kw++;return t.baseClassesIds.set(e,r),r}},{key:"buildMinimalClass",value:function(){var e,t=this.constructor,n=this.baseClass,r=this.walkDepthState.linearizedByTopoLevelsSource.reduce((function(e,n){var r=e.cls,i=e.hash+String.fromCharCode(n.id),o=t.minimalClassesByLinearHash.get(i);return o||(o=n.mixinLambda(r),n.name=o.name,t.minimalClassesByLinearHash.set(i,o)),e.cls=o,e.hash=i,e}),{cls:n,hash:String.fromCharCode(this.getBaseClassMixinId(n))}).cls,i=Object.assign(r,(e={},Qe()(e,yw,this.identitySymbol),Qe()(e,mw,this),Qe()(e,"mix",this.mixinLambda),Qe()(e,"derive",(function(e){return Tw([i,e],(function(e){return function(e){Ye()(n,e);var t=gw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(e)}))})),Qe()(e,"$",this),Qe()(e,"toString",this.toString.bind(this)),e));return Object.defineProperty(i,Symbol.hasInstance,{value:Ew}),i}},{key:"toString",value:function(){return this.walkDepthState.linearizedByTopoLevelsSource.reduce((function(e,t){return"".concat(t.name,"(").concat(e,")")}),this.baseClass.name)}}],[{key:"new",value:function(e){var t,n=new this;e&&Object.assign(n,e),n.walkDepthState=bw.new({sourceEl:n,baseEl:Sw(n.baseClass)});var r=n.mixinLambda,i=n.identitySymbol=Symbol(r.name),o=Object.assign((function(e){var t=r(e);return t.prototype[i]=!0,t}),(t={},Qe()(t,yw,i),Qe()(t,mw,n),t));return Object.defineProperty(o,Symbol.hasInstance,{value:Ew}),n.mixinLambda=o,n}}]),e}();Rw.minimalClassesByLinearHash=new Map,Rw.baseClassesIds=new Map;var Sw=function(e){return Object.getPrototypeOf(e.prototype).constructor[mw]},xw=function(e,t){var n,r;if(e.length>0){var i=e[e.length-1];r=i,Object.getPrototypeOf(r.prototype).constructor.hasOwnProperty(mw)||i===Cw||(n=i)}var o=[];return e.forEach((function(t,r){var i=t[mw];if(void 0!==i){var a=i.baseClass;if(a!==Cw)if(n){if(n!==a){var s=a.prototype.isPrototypeOf(n.prototype),l=n.prototype.isPrototypeOf(a.prototype);if(!s&&!l)throw new Error("Base class mismatch");n=l?a:n}}else n=a;o.push(i)}else if(r!==e.length-1)throw new Error("Base class should be provided as the last element of the requirements array")})),Rw.new({requirements:o,mixinLambda:t,baseClass:n||Cw}).minimalClass},Ew=function(e){return Boolean(e&&e[this[yw]])},Dw=function(e,t){return Boolean(e&&e[t[yw]])},Tw=xw;function Ow(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Mw=function(e){Ye()(n,e);var t=Ow(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([],(function(e){e.prototype;return function(e){Ye()(r,e);var t,n=Ow(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"commitAsync",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.project.commitAsync());case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"project",get:function(){return this.$project},set:function(e){this.$project=e}},{key:"calculateProject",value:function(){throw new Error("Implement me")}},{key:"setProject",value:function(e){return this.project=e}},{key:"getProject",value:function(){return this.project?this.project:this.setProject(this.calculateProject())}},{key:"getAssignmentStore",value:function(){var e=this.getProject();return null==e?void 0:e.assignmentStore}},{key:"getDependencyStore",value:function(){var e=this.getProject();return null==e?void 0:e.dependencyStore}},{key:"getEventStore",value:function(){var e=this.getProject();return null==e?void 0:e.eventStore}},{key:"getResourceStore",value:function(){var e=this.getProject();return null==e?void 0:e.resourceStore}},{key:"getCalendarManagerStore",value:function(){var e=this.getProject();return null==e?void 0:e.calendarManagerStore}}]),r}(e)})));function Aw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Iw=function(e){Ye()(n,e);var t=Aw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Mw],(function(e){e.prototype;return function(e){Ye()(n,e);var t=Aw(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"eventStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.eventStore}},{key:"resourceStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.resourceStore}},{key:"assignmentStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.assignmentStore}},{key:"dependencyStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.dependencyStore}},{key:"calendarManagerStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.calendarManagerStore}},{key:"getEventById",value:function(e){var t;return null===(t=this.eventStore)||void 0===t?void 0:t.getById(e)}},{key:"getDependencyById",value:function(e){var t;return null===(t=this.dependencyStore)||void 0===t?void 0:t.getById(e)}},{key:"getResourceById",value:function(e){var t;return null===(t=this.resourceStore)||void 0===t?void 0:t.getById(e)}},{key:"getAssignmentById",value:function(e){var t;return null===(t=this.assignmentStore)||void 0===t?void 0:t.getById(e)}},{key:"getCalendarById",value:function(e){var t;return null===(t=this.calendarManagerStore)||void 0===t?void 0:t.getById(e)}}]),n}(e)})));function Pw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Fw=function(e){Ye()(n,e);var t=Pw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Mw,ts],(function(e){var t=e.prototype;return function(e){Ye()(s,e);var n,r,i,o,a=Pw(s);function s(){var e;return B()(this,s),(e=a.apply(this,arguments)).isLoadingData=!1,e}return _()(s,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.asyncEvents={add:!0,remove:!0,removeAll:!0,change:!0,refresh:!0,replace:!0,move:!0,update:!0},t.construct.call(this,e)}},{key:"trigger",value:function(e,n){var r=this,i=r.asyncEvents,o=r.project,a=null==i?void 0:i[e];return a&&(!0===a||a[n.action])?(t.trigger.call(r,"".concat(e,"PreCommit"),Object.assign({},n)),!o||o.isEngineReady()&&!o.isWritingData?t.trigger.call(r,e,n):r.eventsSuspended||null==o||o.on({dataReady:function(){t.trigger.call(r,e,n)},once:!0,thisObj:this}),!0):t.trigger.call(r,e,n)}},{key:"calculateProject",value:function(){return this.project}},{key:"setStoreData",value:function(e){var n;this.project&&(this.project.hasLoadedDataToCommit=!0),this.isLoadingData=!0,t.setStoreData.call(this,e),this.isLoadingData=!1,null===(n=this.project)||void 0===n||n.trigger("storeRefresh",{store:this})}},{key:"doAutoCommit",value:(o=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.suspendCount<=0&&this.project)||this.project.isEngineReady()){e.next=3;break}return e.next=3,this.project.commitAsync();case 3:t.doAutoCommit.call(this);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"addAsync",value:(i=Pt()(At.a.mark((function e(t,n){var r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.add(t,n),e.next=3,this.project.commitAsync();case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"insertAsync",value:(r=Pt()(At.a.mark((function e(t,n,r){var i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.insert(t,n,r),e.next=3,this.project.commitAsync();case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"loadDataAsync",value:(n=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.data=t,e.next=3,this.project.commitAsync();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),s}(e)})));function Lw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Bw=function(e){Ye()(n,e);var t=Lw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Mw,Lo],(function(e){var t=e.prototype;return function(e){Ye()(o,e);var n,r,i=Lw(o);function o(){return B()(this,o),i.apply(this,arguments)}return _()(o,[{key:"joinStore",value:function(e){var n=!1;if(Dw(e,Fw)){var r=e.getProject();!r||r.isRepopulatingStores||this.getProject()||(this.setProject(r),n=!0)}t.joinStore.call(this,e),n&&this.joinProject()}},{key:"unjoinStore",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.unjoinStore.call(this,e,n);var r=this.getProject(),i=Dw(e,Fw)&&r===e.getProject();r&&!r.isDestroying&&!r.isRepopulatingStores&&i&&(this.leaveProject(n),this.setProject(null)),i&&(this.graph=null)}},{key:"joinProject",value:function(){}},{key:"leaveProject",value:function(){}},{key:"calculateProject",value:function(){var e=this.stores.find((function(e){return Dw(e,Fw)&&!!e.getProject()}));return null==e?void 0:e.getProject()}},{key:"setAsync",value:(r=Pt()(At.a.mark((function e(t,n,r){var i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.set(t,n,r),e.next=3,null===(i=this.project)||void 0===i?void 0:i.commitAsync();case 3:return e.abrupt("return",o);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"getAsync",value:(n=Pt()(At.a.mark((function e(t){var n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.project)||void 0===n?void 0:n.commitAsync();case 2:return e.abrupt("return",this.get(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),o}(e)})));function jw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var _w=function(e){Ye()(n,e);var t=jw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Bw,Iw,Lo],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=jw(r);function r(){var e;return B()(this,r),(e=n.apply(this,arguments)).$isCalculating=!1,e.$changed={},e.$beforeChange={},e}return _()(r,[{key:"joinProject",value:function(){this.invalidate()}},{key:"leaveProject",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.leaveProject.call(this,n),null===(e=this.project)||void 0===e||e.bufferedCommitAsync()}},{key:"invalidate",value:function(){var e;null===(e=this.project)||void 0===e||e.invalidate(this)}},{key:"getCurrentOrProposed",value:function(e){var t;return e in this.$changed?this.$changed[e]:null!==(t=this.get(e))&&void 0!==t?t:null}},{key:"hasCurrentOrProposed",value:function(e){return null!=this.$changed[e]||null!=this.get(e)}},{key:"propose",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n];this.$changed[r]=e[r]}this.invalidate()}},{key:"setChanged",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this;i.$changed[e]=t,r&&(e in i.$beforeChange||(i.$beforeChange[e]=i.get(e)),i.setData(e,t)),n&&i.invalidate()}},{key:"calculateInvalidated",value:function(){}},{key:"finalizeInvalidated",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.$isCalculating=!0,e?t.setData(t.$changed):(t.setData(t.$beforeChange),t.set(t.$changed)),t.$changed={},t.$beforeChange={},t.$isCalculating=!1}}]),r}(e)})));function Hw(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Nw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nw(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Nw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Vw=function(e){Ye()(n,e);var t=zw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([_w],(function(e){var t=e.prototype;return function(e){Ye()(a,e);var n,r,i,o=zw(a);function a(){var e;return B()(this,a),(e=o.apply(this,arguments))._startDate=null,e._endDate=null,e._duration=null,e}return _()(a,[{key:"startDate",get:function(){var e,t;return null!==(t=null!==(e=this._startDate)&&void 0!==e?e:this.get("startDate"))&&void 0!==t?t:null},set:function(e){this.proposeStartDate(e)}},{key:"endDate",get:function(){var e,t;return null!==(t=null!==(e=this._endDate)&&void 0!==e?e:this.get("endDate"))&&void 0!==t?t:null},set:function(e){this.proposeEndDate(e)}},{key:"duration",get:function(){var e,t;return null!==(t=null!==(e=this._duration)&&void 0!==e?e:this.get("duration"))&&void 0!==t?t:null},set:function(e){this.proposeDuration(e)}},{key:"getStartDate",value:function(){return this.startDate}},{key:"proposeStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._startDate=e,this.propose({startDate:e,keepDuration:t})}},{key:"setStartDate",value:(i=Pt()(At.a.mark((function e(t){var n,r,i=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],this.proposeStartDate(t,n),e.abrupt("return",null===(r=this.project)||void 0===r?void 0:r.commitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getEndDate",value:function(){return this.endDate}},{key:"proposeEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._endDate=e,this.propose({endDate:e,keepDuration:t})}},{key:"setEndDate",value:(r=Pt()(At.a.mark((function e(t){var n,r,i=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],this.proposeEndDate(t,n),e.abrupt("return",null===(r=this.project)||void 0===r?void 0:r.commitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getDuration",value:function(){return this.duration}},{key:"proposeDuration",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._duration=e,this.propose({duration:e,keepStart:n}),t&&this.propose({durationUnit:t})}},{key:"setDuration",value:(n=Pt()(At.a.mark((function e(t,n){var r,i,o=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(o.length>2&&void 0!==o[2])||o[2],this.proposeDuration(t,n,r),e.abrupt("return",null===(i=this.project)||void 0===i?void 0:i.commitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getDurationUnit",value:function(){return this.durationUnit}},{key:"joinProject",value:function(){var e,n=this,r=n.$changed,i=n.getCurrentOrProposed("startDate"),o=n.getCurrentOrProposed("endDate"),a=n.getCurrentOrProposed("duration");if(null!=i&&(r.startDate=n._startDate=i),null!=o&&(r.endDate=n._endDate=o),null!=a&&(r.duration=n._duration=a),n.eventStore&&!n.eventStore.isLoadingData){var s=null===(e=n.assignmentStore)||void 0===e?void 0:e.storage.findItem("event",null);if(s){var l,u=Hw(s);try{for(u.s();!(l=u.n()).done;){var c=l.value;c.getCurrentOrProposed("event")===n.id&&c.setChanged("event",n)}}catch(e){u.e(e)}finally{u.f()}}}t.joinProject.call(n)}},{key:"applyValue",value:function(e,n,r,i,o){"startDate"!==n&&"duration"!=n&&"endDate"!==n||(e=!0,this["_"+n]=r),i&&(e=!1),t.applyValue.call(this,e,n,r,i,o)}},{key:"afterChange",value:function(e,n,r,i,o){this.$isCalculating||o||this.setData(this.$changed),t.afterChange.call(this,e,n,r,i,o)}},{key:"calculateInvalidated",value:function(){var e=this,t=e.$changed,n="startDate"in t,r="endDate"in t,i="duration"in t,o=t.startDate,a=t.endDate,s=t.duration,l=t.keepDuration,u=t.keepStart,c=null;!n||r||i?n||!r||i?n||r||!i?n&&r&&!i?null===o&&null===a?t.duration=null:c="duration":n&&!r&&i?c="endDate":!n&&r&&i?c="startDate":n&&r&&i&&(c=null==s?"duration":null==o?"startDate":"endDate"):null===s?t.endDate=null:!e.hasCurrentOrProposed("startDate")||!u&&e.hasCurrentOrProposed("endDate")?e.hasCurrentOrProposed("endDate")&&(c="startDate"):(u&&t.duration<0&&(t.duration=0),c="endDate"):null===a?t.startDate=null:e.hasCurrentOrProposed("startDate")&&a<e.getCurrentOrProposed("startDate")&&!l?(t.startDate=a,t.duration=0):!e.hasCurrentOrProposed("duration")||!l&&e.hasCurrentOrProposed("startDate")?e.hasCurrentOrProposed("startDate")&&(c="duration"):c="startDate":null===o?t.endDate=null:e.hasCurrentOrProposed("endDate")&&o>e.getCurrentOrProposed("endDate")&&!l?(t.endDate=o,t.duration=0):!e.hasCurrentOrProposed("duration")||!l&&e.hasCurrentOrProposed("endDate")?e.hasCurrentOrProposed("endDate")&&(c="duration"):c="endDate";var f,d,h=e.getCurrentOrProposed("startDate"),v=e.getCurrentOrProposed("endDate"),p=e.getCurrentOrProposed("duration"),g=e.getCurrentOrProposed("durationUnit");switch(c){case"startDate":t.startDate=Un.add(v,-p,g);break;case"endDate":f=Un.as("hour",p,g),d=Un.as(g,f,"h"),t.endDate=Un.add(h,d,g);break;case"duration":f=Un.diff(h,v,"h"),t.duration=Un.as(g,f,"h")}void 0!==t.startDate&&(this._startDate=t.startDate),void 0!==t.endDate&&(this._endDate=t.endDate),void 0!==t.duration&&(this._duration=t.duration),delete t.keepDuration,delete t.keepStart}}],[{key:"fields",get:function(){return[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number"},{name:"durationUnit",type:"string",defaultValue:"day"}]}}]),a}(e)})));function Ww(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var $w=function(e){Ye()(n,e);var t=Ww(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([_w],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=Ww(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"assigned",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.assignmentStore.getResourcesAssignments(this)}},{key:"joinProject",value:function(){var e,n=this;this.resourceStore&&!this.resourceStore.isLoadingData&&(null===(e=this.assignmentStore)||void 0===e||e.query((function(e){return e.get("resource")===n.id})).forEach((function(e){return e.setChanged("resource",n)}))),t.joinProject.call(this)}},{key:"leaveProject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.assigned&&!e){var n=this.resourceStore;this.assigned.forEach((function(e){return n.assignmentsForRemoval.add(e)}))}t.leaveProject.call(this)}},{key:"applyValue",value:function(e,n,r,i,o){"id"===o.name&&this.assigned.forEach((function(e){e.set("resourceId",r)})),t.applyValue.call(this,e,n,r,i,o)}}]),r}(e)})));function Uw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Gw=function(e){Ye()(n,e);var t=Uw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([_w],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=Uw(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"setChanged",value:function(e,n,r){var i=this.assignmentStore,o=this.eventStore,a=this.resourceStore,s=this.project,l=!1;if("event"===e){var u=Dw(n,Vw)?n:null==o?void 0:o.getById(n);u&&(l=!0),n=u||n}if("resource"===e){var c=Dw(n,$w)?n:null==a?void 0:a.getById(n);c&&(l=!0),n=c||n}t.setChanged.call(this,e,n,r,!0),!i||!l||s.isPerformingCommit||i.isLoadingData||a.isLoadingData||i.skipInvalidateIndices||i.invalidateIndices()}},{key:"joinProject",value:function(){t.joinProject.call(this),this.setChanged("event",this.get("event")),this.setChanged("resource",this.get("resource"))}},{key:"calculateInvalidated",value:function(){var e,t,n=this.$changed,r=n.event,i=void 0===r?this.event:r,o=n.resource,a=void 0===o?this.resource:o;if(null!==i&&!Dw(i,Vw)){var s=null===(e=this.eventStore)||void 0===e?void 0:e.getById(i);s&&this.setChanged("event",s,!1)}if(null!==a&&!Dw(a,$w)){var l=null===(t=this.resourceStore)||void 0===t?void 0:t.getById(a);l&&this.setChanged("resource",l,!1)}}},{key:"finalizeInvalidated",value:function(e){var n,r;(null===(n=this.$changed.resource)||void 0===n?void 0:n.isModel)&&(this.$changed.resourceId=this.$changed.resource.id),(null===(r=this.$changed.event)||void 0===r?void 0:r.isModel)&&(this.$changed.eventId=this.$changed.event.id),t.finalizeInvalidated.call(this,e)}},{key:"event",get:function(){var e=this.get("event");return Dw(e,Vw)?e:null},set:function(e){this.setChanged("event",e)}},{key:"resource",get:function(){var e=this.get("resource");return Dw(e,$w)?e:null},set:function(e){this.setChanged("resource",e)}}],[{key:"fields",get:function(){return[{name:"resource",isEqual:function(e,t){return e===t},persist:!1},{name:"event",isEqual:function(e,t){return e===t},persist:!1}]}}]),r}(e)})));function Yw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var qw=function(e){Ye()(n,e);var t=Yw(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"AssignmentModel"}}]),n}(Uk(Wk(Gw.derive(Lo))));function Kw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}qw.exposeProperties(),qw._$name="AssignmentModel";var Xw=function(e){return function(e){Ye()(n,e);var t=Kw(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"assignmentStore",get:function(){return this.project.assignmentStore}},{key:"calendarManagerStore",get:function(){return this.project.calendarManagerStore}},{key:"dependencyStore",get:function(){return this.project.dependencyStore}},{key:"eventStore",get:function(){return this.project.eventStore}},{key:"resourceStore",get:function(){return this.project.resourceStore}}],[{key:"$name",get:function(){return"PartOfBaseProject"}}]),n}(e)};function Zw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Jw=function(e){return function(e){Ye()(n,e);var t=Zw(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"add",value:function(e){var t;Array.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++){var i=e[r];if(i instanceof Lo||(e[r]=i=this.createRecord(i)),-1!==this.storage.findIndex("eventResourceKey",i.eventResourceKey,!0))throw new Error("Duplicate assignment Event: ".concat(i.eventId," to resource: ").concat(i.resourceId))}for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];return(t=tt()(Ze()(n.prototype),"add",this)).call.apply(t,[this,e].concat(a))}},{key:"includesAssignment",value:function(e,t){return-1!==this.storage.findIndex("eventResourceKey","".concat(e,"-").concat(t),!0)}},{key:"setStoreData",value:function(e){tt()(Ze()(n.prototype),"setStoreData",this).call(this,e)}},{key:"isAssignmentStore",get:function(){return!0}},{key:"getOccurrence",value:function(e,t){if(!e||null==t||!t.isOccurrence)return e;var n=this;return{id:"".concat(t.id,":a").concat(e.id),event:t,resource:e.resource,eventId:t.id,resourceId:e.resource.id,isAssignment:!0,isOccurrenceAssignment:!0,instanceMeta:function(e){return n.occurrenceInstanceMeta(this,e)}}}},{key:"occurrenceInstanceMeta",value:function(e,t){var n=t.id||t,r=e.id,i=this.occurrenceMeta;return i||(i=this.occurrenceMeta={}),i[r]||(i[r]={}),i[r][n]||(i[r][n]={})}},{key:"mapAssignmentsForEvent",value:function(e,t,n){e=this.eventStore.getById(e);var r=Boolean(t),i=Boolean(n);return r||i?e.assignments.reduce((function(e,o){var a=r?t(o):o;return i&&!n(a)||e.push(a),e}),[]):e.assignments}},{key:"mapAssignmentsForResource",value:function(e,t,n){e=this.resourceStore.getById(e);var r=Boolean(t),i=Boolean(n);return r||i?e.assignments.reduce((function(e,o){var a=r?t(o):o;return i&&!n(a)||e.push(a),e}),[]):e.assignments}},{key:"getAssignmentsForEvent",value:function(e){return e.assignments}},{key:"removeAssignmentsForEvent",value:function(e){return this.remove(e.assignments)}},{key:"getAssignmentsForResource",value:function(e){return(e=this.resourceStore.getById(e)).assignments}},{key:"removeAssignmentsForResource",value:function(e){this.remove(this.getAssignmentsForResource(e))}},{key:"getResourcesForEvent",value:function(e){return e.resources}},{key:"getEventsForResource",value:function(e){return(e=this.resourceStore.getById(e))&&e.events}},{key:"assignEventToResource",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=i?new Set(e.assignments):null;if(t=Array.isArray(t)?t:[t],null!==(n=o.eventStore)&&void 0!==n&&n.usesSingleAssignment&&e.assignments.length)return o.isEventAssignedToResource(e,t[0])||(e.resource=t[0]),[];var s=[];return o.suspendAutoCommit(),t.forEach((function(t){var n=o.getAssignmentForEventAndResource(e,t);if(n)i&&a.delete(n);else{var l=r({event:e,resource:t});s.push(l)}})),s=o.add(s),i&&o.remove(Array.from(a)),o.resumeAutoCommit(),s}},{key:"unassignEventFromResource",value:function(e,t){var n=this,r=[];if(!t)return n.removeAssignmentsForEvent(e);Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++)n.isEventAssignedToResource(e,t[i])&&r.push(n.getAssignmentForEventAndResource(e,t[i]));return n.remove(r)}},{key:"isEventAssignedToResource",value:function(e,t){return Boolean(this.getAssignmentForEventAndResource(e,t))}},{key:"getAssignmentForEventAndResource",value:function(e,t){var n;return(e=this.eventStore.getById(e))&&(n=e.assignments)&&(t=this.resourceStore.getById(t))?this.getOccurrence(n.find((function(e){return e.resource===t})),e):null}}],[{key:"$name",get:function(){return"AssignmentStoreMixin"}},{key:"defaultConfig",get:function(){return{loadPriority:300,syncPriority:300,storeId:"assignments"}}}]),n}(e)};function Qw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var eC=function(e){Ye()(n,e);var t=Qw(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Fw,Iw,ts],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=Qw(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"setProject",value:function(e){var n=t.setProject.call(this,e);return e&&this.joinProject(e),n}},{key:"joinProject",value:function(e){}},{key:"onCommitAsync",value:function(){}}]),r}(e)}))),tC=function(e){return e instanceof Set||e instanceof Array?hw(e):hw([e])},nC=function(e){return new Promise((function(t){return setTimeout(t,e)}))};function rC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var iC=function(e){Ye()(n,e);var t=rC(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Fw],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=rC(r);function r(){var e;return B()(this,r),(e=n.apply(this,arguments)).assignmentsForRemoval=new Set,e.allAssignmentsForRemoval=!1,e}return _()(r,[{key:"remove",value:function(e,n){this.assignmentsForRemoval=tC(e).toSet();var r=t.remove.call(this,e);return this.assignmentsForRemoval.clear(),r}},{key:"removeAll",value:function(e){this.allAssignmentsForRemoval=!0;var n=t.removeAll.call(this,e);return this.allAssignmentsForRemoval=!1,n}}]),r}(e)})));function oC(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return aC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aC(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function aC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var lC=new Set,uC=function(e){Ye()(n,e);var t=sC(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([iC,eC],(function(e){e.prototype;return function(e){Ye()(n,e);var t=sC(n);function n(){var e;return B()(this,n),(e=t.apply(this,arguments)).skipInvalidateIndices=!1,e}return _()(n,[{key:"data",set:function(e){this.allAssignmentsForRemoval=!0,gh()(Ze()(n.prototype),"data",e,this,!0),this.allAssignmentsForRemoval=!1}},{key:"getEventsAssignments",value:function(e){return this.storage.findItem("event",e)||lC}},{key:"getResourcesAssignments",value:function(e){return this.storage.findItem("resource",e)||lC}},{key:"updateIndices",value:function(){this.storage.rebuildIndices()}},{key:"invalidateIndices",value:function(){this.storage.invalidateIndices()}},{key:"linkAssignments",value:function(e,t){var n=this.count&&this.storage.findItem(t,null);if(n){var r,i=oC(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=e.getById(o.getCurrentOrProposed(t));a&&o.setChanged(t,a)}}catch(e){i.e(e)}finally{i.f()}this.invalidateIndices()}}},{key:"unlinkAssignments",value:function(e){this.forEach((function(t){var n,r,i;return t.setChanged(e,null!==(i=null!==(r=null===(n=t[e])||void 0===n?void 0:n.id)&&void 0!==r?r:t[e])&&void 0!==i?i:t[e+"Id"])})),this.invalidateIndices()}},{key:"onCommitAsync",value:function(){this.updateIndices()}}],[{key:"defaultConfig",get:function(){return{modelClass:Gw,storage:{extraKeys:[{property:"event",unique:!1},{property:"resource",unique:!1}]}}}}]),n}(e)})));function cC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var fC=Wk(uC.derive(ss)),dC=function(e){Ye()(n,e);var t=cC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:qw}}}]),n}(Jw(fC));function hC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}dC._$name="AssignmentStore";var vC=function(e){return function(e){Ye()(n,e);var t=hC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"isResourceStore",get:function(){return!0}},{key:"construct",value:function(e){if(tt()(Ze()(n.prototype),"construct",this).call(this,e),!this.modelClass.isResourceModel)throw new Error("Model for ResourceStore must subclass ResourceModel")}},{key:"removeAll",value:function(){var e=tt()(Ze()(n.prototype),"removeAll",this).apply(this,arguments);return e&&this.assignmentStore.removeAll(),e}},{key:"onRecordIdChange",value:function(e){var t=e.record,r=e.oldValue,i=e.value;tt()(Ze()(n.prototype),"onRecordIdChange",this).call(this,{record:t,oldValue:r,value:i}),t.isFieldModified("id")&&(this.isChangingId=!0,t.updateAssignmentResourceIds(),this.isChangingId=!1)}}],[{key:"$name",get:function(){return"ResourceStoreMixin"}},{key:"defaultConfig",get:function(){return{loadPriority:200,syncPriority:100,storeId:"resources",autoTree:!0}}}]),n}(e||$e)};function pC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var gC=function(e){return function(e){Ye()(n,e);var t=pC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateAssignmentResourceIds",value:function(){var e=this;this.assigned.forEach((function(t){t.resourceId=e.id}))}},{key:"syncId",value:function(e){tt()(Ze()(n.prototype),"syncId",this).call(this,e),this.updateAssignmentResourceIds()}},{key:"events",get:function(){return this.assignments.reduce((function(e,t){return t.event&&e.push(t.event),e}),[])}},{key:"assignments",get:function(){return this.assigned?F()(this.assigned):[]},set:function(e){var t=this;e.forEach((function(e){e.resource=t}))}},{key:"getEvents",value:function(){return this.events}},{key:"isPersistable",get:function(){return tt()(Ze()(n.prototype),"isPersistable",this)&&(!this.parent||this.parent.isPersistable)}},{key:"unassignAll",value:function(){this.assignments&&this.assignmentStore.remove(this.assignments)}},{key:"initials",get:function(){var e=this.name,t=void 0===e?"":e;if(!t)return"";var n=t.split(" ");return n[0][0]+(n.length>1?n[n.length-1][0]:"")}}],[{key:"$name",get:function(){return"ResourceModelMixin"}},{key:"isResourceModel",get:function(){return!0}},{key:"fields",get:function(){return[{name:"name",type:"string",persist:!0},"eventColor","eventStyle","imageUrl","image",{name:"resourceMargin",type:"number"},{name:"barMargin",type:"number"},"eventLayout"]}}]),n}(e)};function yC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var mC=function(e){Ye()(n,e);var t=yC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"ResourceModel"}}]),n}(gC(Wk($w.derive(Kg))));function bC(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return kC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kC(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function kC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}mC.exposeProperties(),mC._$name="ResourceModel";var CC=function(e){Ye()(n,e);var t=wC(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Fw],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=wC(r);function r(){var e;return B()(this,r),(e=n.apply(this,arguments)).assignmentsForRemoval=new Set,e}return _()(r,[{key:"onDataChange",value:function(e){var t;tt()(Ze()(r.prototype),"onDataChange",this).call(this,e),(null===(t=e.removed)||void 0===t?void 0:t.length)&&this.afterResourceRemoval()}},{key:"remove",value:function(e,n){var r=t.remove.call(this,e);return this.afterResourceRemoval(),r}},{key:"removeAll",value:function(e){var n=t.removeAll.call(this,e);return this.afterResourceRemoval(),n}},{key:"afterResourceRemoval",value:function(){var e=this.getAssignmentStore();if(e&&!e.allAssignmentsForRemoval){var t=F()(this.assignmentsForRemoval).filter((function(t){return!e.assignmentsForRemoval.has(t)}));t.length>0&&e.remove(t)}this.assignmentsForRemoval.clear()}},{key:"processRecord",value:function(e){var t=this.getById(e.id),n=t&&t!==e;if(n){var r,i=bC(t.assigned);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.resource=e}}catch(e){i.e(e)}finally{i.f()}}return e}}]),r}(e)})));function RC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var SC=function(e){Ye()(n,e);var t=RC(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([CC,eC],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=RC(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"joinProject",value:function(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"resource")}},{key:"afterLoadData",value:function(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"resource")}},{key:"clear",value:function(e){var n;t.clear.call(this,e),null===(n=this.assignmentStore)||void 0===n||n.unlinkAssignments("resource")}}],[{key:"defaultConfig",get:function(){return{modelClass:$w}}}]),r}(e)})));function xC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var EC=Wk(SC.derive(ss)),DC=function(e){Ye()(n,e);var t=xC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:mC}}}]),n}(vC(EC));DC._$name="ResourceStore";var TC={date:"_dateIndex",startDate:"_startDateIndex"},OC=Object.values(TC),MC=Object.freeze([]),AC=Dh.MILLIS_PER_DAY,IC=function(){function e(t,n){B()(this,e),this.dayTime=n||Dh.MIDNIGHT,this.store=t,this.users=[this.dayTime]}return _()(e,[{key:"add",value:function(e,t,n){var r=this[TC[e]],i=this.dayTime.dateKey(t);(r[i]||(r[i]=new Set)).add(n)}},{key:"addEvent",value:function(e){var t,n,r=null===(t=this.dayTime.startOfDay(e.startDate))||void 0===t?void 0:t.getTime();if(r){var i,o;n=null!==(i=null===(o=e.endDate)||void 0===o?void 0:o.getTime())&&void 0!==i?i:r,this.add("startDate",r,e);do{this.add("date",r,e),r+=AC}while(r<n)}}},{key:"clear",value:function(){var e=this;OC.forEach((function(t){return e[t]=Object.create(null)}))}},{key:"get",value:function(e,t,n){!this.initialized&&this.initialize();var r,i=this[TC[e]];return t&&(r=this.dayTime.dateKey(t),i=n?[i[r],r]:i[r]),i}},{key:"initialize",value:function(){this.initialized=!0,this.clear(),this.sync("splice",this.store.storage.allValues)}},{key:"invalidate",value:function(){var e=this;this.initialized=!1,OC.forEach((function(t){return e[t]=null}))}},{key:"matches",value:function(e){return this.dayTime.startShift===e.startShift}},{key:"remove",value:function(e,t,n){var r=this[TC[e]][this.dayTime.dateKey(t)];r&&r.delete(n)}},{key:"removeEvent",value:function(e,t,n){var r,i,o=null===(r=this.dayTime.startOfDay(t))||void 0===r?void 0:r.getTime();if(o){var a;i=null!==(a=null==n?void 0:n.getTime())&&void 0!==a?a:o,this.remove("startDate",o,e);do{this.remove("date",o,e),o+=AC}while(o<i)}}},{key:"sync",value:function(e,t,n,r,i){var o,a;n=n||MC;var s,l,u,c=this,f=(t=t||MC).length,d=n.length,h=null==r?void 0:r.length;if(c.initialized)switch(e){case"clear":c.clear();break;case"splice":if(h)for(t=t.slice(),n=n.slice(),s=0;s<h;s++)n.push(r[s][0]),t.push(r[s][1]);if(d)for(s=0;s<d;s++)u=n[s],c.removeEvent(u,u.startDate,u.endDate);if(f)for(s=0;s<f;s++)(l=t[s]).isScheduled&&c.addEvent(l);break;case"reschedule":u=t[0],c.removeEvent(u,(null===(o=i.startDate)||void 0===o?void 0:o.oldValue)||u.startDate,(null===(a=i.endDate)||void 0===a?void 0:a.oldValue)||u.endDate),c.sync("splice",t)}}},{key:"register",value:function(e){this.users.push(e)}},{key:"unregister",value:function(e){var t=this.users,n=t.indexOf(e);return n>-1&&t.splice(n,1),!t.length}}]),e}(),PC=IC.prototype;function FC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}OC.forEach((function(e){return PC[e]=null})),PC.initialized=!1,IC._$name="EventDayIndex";var LC=Dh.MIDNIGHT,BC=function(){return!0},jC=function(e){return!e.isRecurring},_C=function(e){return function(e){Ye()(n,e);var t=FC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e),this.autoTree=!0,this.dayIndices=null}},{key:"afterLoadData",value:function(){this.syncIndices("splice",this.storage.allValues),tt()(Ze()(n.prototype),"afterLoadData",this)&&tt()(Ze()(n.prototype),"afterLoadData",this).call(this)}},{key:"onDataChange",value:function(e){var t=e.action,r=e.added,i=e.removed,o=e.replaced;this.syncIndices(t,r,i,o),tt()(Ze()(n.prototype),"onDataChange",this).apply(this,arguments)}},{key:"onDataReplaced",value:function(e,t){this.syncIndices("clear"),this.syncIndices("splice",this.storage.values),tt()(Ze()(n.prototype),"onDataReplaced",this).call(this,e,t)}},{key:"onModelChange",value:function(e,t,r,i,o){("startDate"in r||"endDate"in r)&&this.syncIndices("reschedule",[e],null,null,r),tt()(Ze()(n.prototype),"onModelChange",this).apply(this,arguments)}},{key:"filtersFunction",get:function(){var e=tt()(Ze()(n.prototype),"filtersFunction",this);return e&&e!==at.returnTrue?function(t){return t.meta.isCreating||e(t)}:e},set:function(e){gh()(Ze()(n.prototype),"filtersFunction",e,this,!0)}},{key:"getEventsInTimeSpan",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return z.a.deprecate("Scheduler","5.0.0","`getEventsInTimeSpan` method deprecated, in favor of `getEvents`"),this.getEvents({startDate:e,endDate:t,allowPartial:n,onlyAssigned:r})}},{key:"getEventsByStartDate",value:function(e){return z.a.deprecate("Scheduler","5.0.0","`getEventsByStartDate` method deprecated, in favor of `getEvents`"),this.getEvents({startDate:e,startOnly:!0})}},{key:"getEvents",value:function(e){var t=e.filter,n=e.date,r=e.startDate,i=e.endDate,o=e.startOnly,a=e.includeOccurrences,s=e.allowPartial,l=e.onlyAssigned,u=void 0!==l&&l,c=e.dateMap,f=void 0!==c&&c,d=(e.dayTime,e.getDateIndex,this),h=arguments[0],v=d.lastDateRange,p=d.added,g=d.filtersFunction,y=t;if(u&&(h.filter=y?function(e){return y(e)&&e.resources.length}:function(e){return e.resources.length}),"startDate"in h||(r=h.startDate=n),"includeOccurrences"in h||(a=h.includeOccurrences=!0),"allowPartial"in h||(s=h.allowPartial=!o),h.storeFilterFn=d.isFiltered?d.reapplyFilterOnAdd?g:function(e){return p.includes(e)?d.indexOf(e)>-1:g(e)}:null,!i)if(r)(i=h.endDate=Un.clearTime(r)).setDate(i.getDate()+1);else{if(a)throw new Error("getEvents MUST be passed startDate and endDate if recurring occurrences are requested");h.dateFilter=BC}h.dateFilter||(h.dateFilter=o?function(e){var t=e.hasBatchedChange("startDate")?e.get("startDate"):e.startDate;return t&&!(Un.clearTime(t)-r)}:s?function(e){var t=e.hasBatchedChange("startDate")?e.get("startDate"):e.startDate,n=e.hasBatchedChange("endDate")?e.get("endDate"):e.endDate||t;return t&&Un.intersectSpans(t,n,r,i)}:function(e){var t=e.hasBatchedChange("startDate")?e.get("startDate"):e.startDate,n=e.hasBatchedChange("endDate")?e.get("endDate"):e.endDate||t;return t&&t>=r&&n<=i});var m={startDate:r,endDate:i},b=!v||v.startDate-m.startDate||v.endDate-m.endDate;return b&&(d.processConfiguredListeners(),d.trigger("loadDateRange",{old:v||{},new:Object.assign({},m)}),d.lastDateRange=m),f?d.getEventsAsMap(h):d.getEventsAsArray(h)}},{key:"getEventsAsArray",value:function(e){var t=e.filter,n=e.date,r=e.resourceRecord,i=e.startDate,o=void 0===i?n:i,a=e.endDate,s=e.startOnly,l=e.includeOccurrences,u=void 0===l||l,c=e.dayTime,f=void 0===c?null:c,d=e.dateFilter,h=e.storeFilterFn,v=e.getDateIndex,p=this,g=[];if(p.count){var y=r?p.getEventsForResource(r):null;r||function(){var e=p.useDayIndex(f),t=new Set,n=s?"startDate":"date";p.recurringEvents.forEach((function(n){e.dayTime.startOfDay(n.startDate)<=o&&t.add(n)}));for(var r=new Date(o);r<a;r.setDate(r.getDate()+1)){var i=e.get(v?v(r):n,r);null==i||i.forEach((function(e){return t.add(e)}))}y=F()(t)}(),h&&(y=y.filter(h));for(var m=0,b=y.length;m<b;m++){var k=y[m];u&&k.isRecurring?g.push.apply(g,k.getOccurrencesForDateRange(o,a).filter(d)):d(k)&&g.push(k)}}return t?g.filter(t):g}},{key:"getEventsAsMap",value:function(e){var t=e.filter,n=e.date,r=e.resourceRecord,i=e.startDate,o=void 0===i?n:i,a=e.endDate,s=e.startOnly,l=e.includeOccurrences,u=void 0===l||l,c=e.dateMap,f=e.dayTime,d=void 0===f?null:f,h=e.storeFilterFn,v=e.getDateIndex,p=this;if(c.clear?c.clear():c=new Map,p.count){var g=p.useDayIndex(d),y=s?"startDate":"date",m=[],b=function(e){return(!t||t(e))&&(!h||h(e))};if(d=g.dayTime,r)throw new Error("Querying for events for a resource and returning a date-keyed Map is not supported");p.recurringEvents.forEach((function(e){d.startOfDay(e.startDate)<a&&m.push(e)}));for(var k=new Date(o);k<a;k.setDate(k.getDate()+1)){var w,C=g.get(v?v(k):y,k,!0),R=N()(C,2),S=R[0],x=R[1];if(S)S=F()(S).filter(jC).filter(b),(w=c.get(x)||c.set(x,[]).get(x)).push.apply(w,F()(S))}for(var E=0,D=m.length;E<D;E++)for(var T,O=m[E],M=(u?O.getOccurrencesForDateRange(o,a):[O]).filter(b),A=0,I=M.length;A<I;A++)for(var P=M[A],L=d.startOfDay(P.startDate),B="startDate"===(v?v(L):s?"startDate":"date")?Un.add(L,1,"day"):P.endDate||Un.add(P.startDate,P.duration,P.durationUnit);L<B;L.setDate(L.getDate()+1)){var j=d.dateKey(L);(T=c.get(j))||c.set(j,T=[]),T.push(P)}}return c}},{key:"forEachScheduledEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.forEach((function(n){var r=n.startDate,i=n.endDate;if(r&&i)return e.call(t,n,r,i)}))}},{key:"getTotalTimeSpan",value:function(){var e=new Date(9999,0,1),t=new Date(0);return this.forEach((function(n){n.startDate&&(e=Un.min(n.startDate,e)),n.endDate&&(t=Un.max(n.endDate,t))})),e=e<new Date(9999,0,1)?e:null,t=t>new Date(0)?t:null,this.lastTotalTimeSpan={startDate:e||null,endDate:t||e||null}}},{key:"isEventPersistable",value:function(e){return e.isPersistable}},{key:"isDateRangeAvailable",value:function(e,t,n,r){var i=this,o=new Set(this.getEventsForResource(r));null!=n&&n.isAssignment&&n.event.resources.forEach((function(e){e.id!==n.resourceId&&i.getEventsForResource(e).forEach((function(e){return o.add(e)}))}));if(n){var a=n.isAssignment?n.event:n;o.delete(a)}return!Array.from(o).some((function(n){return n.isScheduled&&Un.intersectSpans(e,t,n.startDate,n.endDate)}))}},{key:"filterEventsForResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;return e.getEvents(this).filter(t.bind(n))}},{key:"getResourcesForEvent",value:function(e){return e.isOccurrence&&(e=e.recurringTimeSpan),this.assignmentStore.getResourcesForEvent(e)}},{key:"getEventsForResource",value:function(e){return this.assignmentStore.getEventsForResource(e)}},{key:"getAssignmentsForEvent",value:function(e){return this.assignmentStore.getAssignmentsForEvent(e)||[]}},{key:"getAssignmentsForResource",value:function(e){return this.assignmentStore.getAssignmentsForResource(e)||[]}},{key:"assignEventToResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.assignmentStore.assignEventToResource(e,t,void 0,n)}},{key:"unassignEventFromResource",value:function(e,t){this.assignmentStore.unassignEventFromResource(e,t)}},{key:"reassignEventFromResourceToResource",value:function(e,t,n){var r=Lo.asId(n),i=this.assignmentStore.getAssignmentForEventAndResource(e,t);i?i.resourceId=r:this.assignmentStore.assignEventToResource(e,n)}},{key:"isEventAssignedToResource",value:function(e,t){return this.assignmentStore.isEventAssignedToResource(e,t)}},{key:"removeAssignmentsForEvent",value:function(e){this.assignmentStore.removeAssignmentsForEvent(e)}},{key:"removeAssignmentsForResource",value:function(e){this.assignmentStore.removeAssignmentsForResource(e)}},{key:"invalidateDayIndices",value:function(){var e;null===(e=this.dayIndices)||void 0===e||e.forEach((function(e){return e.invalidate()}))}},{key:"registerDayIndex",value:function(e){var t,n,r=this,i=r.dayIndices||(r.dayIndices=[]);for(n=0;!t&&n<i.length;++n)i[n].matches(e)&&(t=i[n]).register(e);return!t&&i.push(t=new IC(r,e)),t}},{key:"syncIndices",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];null===(e=this.dayIndices)||void 0===e||e.forEach((function(e){return e.sync.apply(e,n)}))}},{key:"unregisterDayIndex",value:function(e){for(var t=this.dayIndices,n=null==t?void 0:t.length;n-- >0;)if(t[n].matches(e)){t[n].unregister(e)&&t.splice(n,1);break}}},{key:"useDayIndex",value:function(e){var t=this,n=t.dayIndices;e=e||LC;for(var r=0;n&&r<n.length;++r)if(n[r].matches(e))return n[r];if(e.startShift)throw new Error("No day index registered for ".concat(e," on ").concat(t.id));return t.registerDayIndex(LC)}}],[{key:"$name",get:function(){return"EventStoreMixin"}}]),n}(e||$e)};function HC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var NC=function(e){return function(e){Ye()(n,e);var t=HC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){if(tt()(Ze()(n.prototype),"construct",this).call(this,e,!0),!this.modelClass.isEventModel)throw new Error("The model for the EventStore must subclass EventModel")}},{key:"append",value:function(e){return this.add(e)}},{key:"project",get:function(){return tt()(Ze()(n.prototype),"project",this)},set:function(e){gh()(Ze()(n.prototype),"project",e,this,!0),this.detachListeners("project"),e&&(e.on({name:"project",assignmentStoreChange:"onProjectAssignmentStoreChange",thisObj:this,prio:200}),e.assignmentStore&&e.assignmentStore.isAssignmentStore&&this.attachToAssignmentStore(e.assignmentStore))}},{key:"processRecords",value:function(e){var t,r=this.assignmentStore,i=[];return e=tt()(Ze()(n.prototype),"processRecords",this).call(this,e,r&&!(null!==(t=this.stm)&&void 0!==t&&t.isRestoring)&&function(e){var t=e.get("resourceId");e.reassignedFromReplace||null==t||r.includesAssignment(e.id,t)||i.push({id:r.modelClass.generateId(""),resourceId:t,eventId:e.id}),e.reassignedFromReplace=!1}||void 0),null==r||r.add(i),e}},{key:"joinRecordsToStore",value:function(e){this.assignmentStore?(this.assignmentStore.skipInvalidateIndices=!0,tt()(Ze()(n.prototype),"joinRecordsToStore",this).call(this,e),this.assignmentStore.storage.invalidateIndices(),this.assignmentStore.skipInvalidateIndices=!1):tt()(Ze()(n.prototype),"joinRecordsToStore",this).call(this,e)}},{key:"processRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(e=tt()(Ze()(n.prototype),"processRecord",this).call(this,e,t)).get("resourceId");if(null!=r){var i=this,o=i.assignmentStore,a=i.getById(e.id),s=a&&a!==e&&!t;if(s){var l=o.find((function(t){return t.eventId===e.id}));l&&(l.resource=r,e.reassignedFromReplace=!0)}else i.$processResourceIds=!0;i.usesSingleAssignment=!0}return e}},{key:"processResourceIds",value:function(){var e=this.assignmentStore;if(this.$processResourceIds&&null!=e&&e.isAssignmentStore){var t=[];this.forEach((function(n){var r=n.resourceId,i=n.id;null!=r&&t.push({id:e.modelClass.generateId(""),resourceId:r,eventId:i})})),e.useRawData={disableDefaultValue:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0},e.usesSingleAssignment=!1,e.data=t,e.usesSingleAssignment=!0,this.$processResourceIds=!1}}},{key:"loadData",value:function(){tt()(Ze()(n.prototype),"loadData",this).apply(this,arguments),this.processResourceIds()}},{key:"onBeforeRemoveAssignment",value:function(e){var t,n=e.records,r=this;if(r.removeUnassignedEvent&&!r.isRemoving&&!r.isSettingData&&(null===(t=r.stm)||void 0===t||!t.isRestoring)&&!r.usesSingleAssignment){var i=new Set;n.forEach((function(e){var t=e.event;t&&!t.isRemoved&&t.assignments.every((function(e){return n.includes(e)}))&&i.add(t)})),i.size&&r.remove(F()(i))}}},{key:"onProjectAssignmentStoreChange",value:function(e){var t=e.store;this.attachToAssignmentStore(t)}},{key:"attachToAssignmentStore",value:function(e){var t=this;t.detachListeners("assignmentStore"),e&&(t.processResourceIds(),e.on({name:"assignmentStore",addPreCommit:function(e){var n=e.records;!t.usesSingleAssignment||t.isSettingData||t.isAssigning||n.forEach((function(e){var t=e.event;null!=t&&t.isEvent&&t.resourceId!==e.resourceId&&(t.meta.isAssigning=!0,t.set("resourceId",e.resourceId),t.meta.isAssigning=!1)}))},beforeRemove:"onBeforeRemoveAssignment",removePreCommit:function(e){var n=e.records;t.usesSingleAssignment&&n.forEach((function(e){var n;null===(n=t.getById(e.eventId))||void 0===n||n.set("resourceId",null)}))},removeAllPreCommit:function(){t.usesSingleAssignment&&!t.isSettingData&&t.allRecords.forEach((function(e){return e.set("resourceId",null)}))},update:function(e){var n=e.record,r=e.changes;if(t.usesSingleAssignment&&"resourceId"in r){var i=n.event;i.meta.isAssigning=!0,i.set("resourceId",r.resourceId.value),i.meta.isAssigning=!1}},thisObj:t}))}},{key:"data",set:function(e){this.isSettingData=!0,this.usesSingleAssignment&&!this.syncDataOnLoad&&this.assignmentStore.removeAll(!0),gh()(Ze()(n.prototype),"data",e,this,!0),this.isSettingData=!1}},{key:"trigger",value:function(e,t){var r=t||{},i=r.changes;return i&&"resourceId"in i&&1===Object.keys(i).length&&(t.isAssign=!0),tt()(Ze()(n.prototype),"trigger",this).apply(this,arguments)}}],[{key:"$name",get:function(){return"SharedEventStoreMixin"}},{key:"defaultConfig",get:function(){return{loadPriority:100,syncPriority:200,storeId:"events",removeUnassignedEvent:!0}}}]),n}(e)};function zC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var VC=Object.freeze([]),WC=function(e){return function(e){Ye()(n,e);var t=zC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){var e,t=this;t.globalOccurrences=new Map,t.recurringEvents=new Set;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this].concat(i))}},{key:"afterLoadData",value:function(){this.globalOccurrences.clear(),this.refreshRecurringEventsCache("clear"),this.refreshRecurringEventsCache("splice",this.storage.allValues),tt()(Ze()(n.prototype),"afterLoadData",this)&&tt()(Ze()(n.prototype),"afterLoadData",this).call(this)}},{key:"onDataChange",value:function(e){var t=e.action,r=e.added,i=e.removed,o=e.replaced;this.refreshRecurringEventsCache(t,r,i,o),tt()(Ze()(n.prototype),"onDataChange",this).apply(this,arguments)}},{key:"refreshRecurringEventsCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:VC,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:VC,r=arguments.length>3?arguments[3]:void 0,i=this,o=i.recurringEvents,a=null==r?void 0:r.length;switch(e){case"clear":o.clear();break;case"splice":if(a){t=t.slice(),n=n.slice();for(var s=0;s<a;s++)n.push(r[s][0]),t.push(r[s][1])}var l=t.length,u=n.length;if(u&&o.size)for(var c=0;c<u;c++){var f=n[c];f.isRecurring&&o.delete(f)}if(l)for(var d=0;d<l;d++){var h=t[d];h.isRecurring&&o.add(h)}}}},{key:"getById",value:function(e){var t=tt()(Ze()(n.prototype),"getById",this).call(this,e);return t||(t=this.globalOccurrences.get(this.modelClass.asId(e))),t}},{key:"onModelChange",value:function(e,t,r,i,o){var a=this.isRecurrenceRelatedFieldChange(e,r);if(a&&!i&&e.removeOccurrences(),tt()(Ze()(n.prototype),"onModelChange",this).apply(this,arguments),a&&!i){var s={action:"batch",records:this.storage.values};this.trigger("refresh",s),this.trigger("change",s)}}},{key:"isRecurrenceRelatedFieldChange",value:function(e,t){return e.isRecurring||"recurrenceRule"in t}},{key:"getOccurrencesForTimeSpan",value:function(e,t,n){var r=[];return e.isRecurring&&e.recurrence.forEachOccurrence(t,n,(function(e){return r.push(e)})),r}},{key:"data",set:function(e){this.globalOccurrences.clear(),gh()(Ze()(n.prototype),"data",e,this,!0)}},{key:"getRecurringTimeSpans",value:function(){return F()(this.recurringEvents)}}],[{key:"$name",get:function(){return"RecurringTimeSpansMixin"}}]),n}(e||$e)};function $C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var UC=function(e){return function(e){Ye()(n,e);var t=$C(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getRecurringEvents",value:function(){return this.getRecurringTimeSpans()}},{key:"isEventPersistable",value:function(e){return tt()(Ze()(n.prototype),"isEventPersistable",this).call(this,e)&&(!e.supportsRecurring||!e.isOccurrence)}}],[{key:"$name",get:function(){return"RecurringEventsMixin"}}]),n}(WC(e||$e))};function GC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function YC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?GC(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var KC=function(e){Ye()(n,e);var t=qC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"afterConstruct",value:function(){tt()(Ze()(n.prototype),"afterConstruct",this).call(this),this.normalize()}},{key:"eventStore",get:function(){var e,t=this;if(t.isOccurrence)return t.recurringTimeSpan.eventStore;t._eventStore||(t._eventStore=null===(e=t.stores)||void 0===e?void 0:e.find((function(e){return e.isEventStore})));return t._eventStore}},{key:"normalize",value:function(){var e=this,t=e.startDate,n=e.endDate,r=e.duration,i=e.durationUnit,o=null!=r;t&&n&&!o?e.setData("duration",Un.diff(t,n,i,!0)):t&&!n&&o?e.setData("endDate",Un.add(t,r,i)):!t&&n&&o&&e.setData("startDate",Un.add(n,-r,i))}},{key:"cls",get:function(){return this._cls||(this._cls=new xr(tt()(Ze()(n.prototype),"get",this).call(this,"cls"))),this._cls},set:function(e){var t=this;t._cls?t._cls.value=e:t._cls=new xr(e),t.set("cls",t._cls.value)}},{key:"startDate",get:function(){return this.get("startDate")},set:function(e){this.setStartDate(e)}},{key:"endDate",get:function(){return this.get("endDate")},set:function(e){this.setEndDate(e)}},{key:"duration",get:function(){return this.get("duration")},set:function(e){this.setDuration(e,this.durationUnit)}},{key:"durationUnit",get:function(){return this.get("durationUnit")}},{key:"setDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationUnit,n={duration:e=parseFloat(e),durationUnit:t};this.startDate?n.endDate=Un.add(this.startDate,e,t):this.endDate&&(n.startDate=Un.add(this.endDate,-e,t)),this.set(n)}},{key:"getDurationInUnit",value:function(e,t){return this.starDate&&this.endDate?Un.getDurationInUnit(this.startDate,this.endDate,e,t):Un.as(e,this.duration,this.durationUnit)}},{key:"fullDuration",get:function(){return new Bo({unit:this.durationUnit,magnitude:this.duration})},set:function(e){"string"==typeof e&&(e=Un.parseDuration(e,!0,this.durationUnit)),this.setDuration(e.magnitude,e.unit)}},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r={startDate:e};if(e){var i;if(t)i=null!=n.duration;else if(n.endDate){if(r.duration=Un.diff(e,n.endDate,n.durationUnit,!0),r.duration<0)throw new Error("Negative duration")}else i=null!=this.duration;i&&(r.endDate=Un.add(e,n.getDurationInUnit("h"),"h"))}else r.duration=null;n.set(r)}},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r={endDate:e};if(e){var i;if(!0===t)i=null!=n.duration;else if(n.startDate){if(r.duration=Un.diff(n.startDate,e,n.durationUnit,!0),r.duration<0)throw new Error("Negative duration")}else i=null!=this.duration;i&&(r.startDate=Un.add(e,-n.duration,n.durationUnit))}n.set(r)}},{key:"setStartEndDate",value:function(e,t,n){this.set({startDate:e,endDate:t},null,n)}},{key:"dates",get:function(){for(var e=[],t=Un.startOf(this.startDate,"day"),n=this.endDate,r=t;r<n;r=Un.add(r,1,"day"))e.push(r);return e}},{key:"startDateMS",get:function(){var e;return null===(e=this.hasBatchedChange("startDate")?this.get("startDate"):this.startDate)||void 0===e?void 0:e.getTime()}},{key:"endDateMS",get:function(){var e;return null===(e=this.hasBatchedChange("endDate")?this.get("endDate"):this.endDate)||void 0===e?void 0:e.getTime()}},{key:"durationMS",get:function(){var e=this;return e.endDate&&e.startDate?e.endDateMS-e.startDateMS:Un.asMilliseconds(e.duration||0,e.durationUnit)}},{key:"isMilestone",get:function(){return 0===this.durationMS}},{key:"inSetNormalize",value:function(e){if("string"!=typeof e){var t=e.startDate,n=e.endDate,r=e.duration,i=e.durationUnit,o=void 0===i?this.durationUnit:i;return"string"==typeof t&&(t=this.getFieldDefinition("startDate").convert(t)),"string"==typeof n&&(n=this.getFieldDefinition("endDate").convert(n)),"duration"in e?(t&&!n&&(n=Un.add(t,r,o,!0,!0)),!t&&n&&(t=Un.add(n,-r,o,!0,!0))):t&&n&&(r=Un.as(o,Un.diff(t,n,"h",!0),"h")),t&&(e.startDate=t),n&&(e.endDate=n),null!=r&&(e.duration=r),e}}},{key:"inSet",value:function(e,t,r,i,o){return o||(e=this.inSetNormalize(e)||e),tt()(Ze()(n.prototype),"inSet",this).call(this,e,t,r,i,o)}},{key:"forEachDate",value:function(e,t){return this.dates.forEach(e.bind(t))}},{key:"isScheduled",get:function(){var e=this;return Boolean(e.startDate&&e.endDate&&e.hasValidDates)}},{key:"isValid",get:function(){var e=!0;if(e){var t=this.startDate,n=this.endDate;e=!t||!n||n-t>=0}return e}},{key:"hasValidDates",get:function(){var e=this.startDateMS,t=this.endDateMS;return!e||!t||t-e>=0}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationUnit;if("string"==typeof e){var n=e;e=t,t=n}return this.setStartDate(Un.add(this.startDate,e,t,!0),!0)}},{key:"wbsCode",get:function(){return this._wbsCode||this.indexPath.join(".")},set:function(e){this._wbsCode=e}},{key:"fullCopy",value:function(){return this.copy.apply(this,arguments)}},{key:"intersects",value:function(e){return this.intersectsRange(e.startDate,e.endDate)}},{key:"intersectsRange",value:function(e,t){var n=this.startDate,r=this.endDate;return n&&r&&Un.intersectSpans(n,r,e,t)}},{key:"split",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=this,n=t.copy(),r=t.eventStore,i=t.assignmentStore,o=t.duration*e,a=t.duration-o;if(e<=0||e>=1)throw new Error("Split point must be > 0 and < 1");return n.startDate=Un.add(t.startDate,o,t.durationUnit),n.duration=a,t.duration=o,r&&(r.add(n),i&&!r.usesSingleAssignment&&i.add(t.assignments.map((function(e){var t=Object.assign({},e.data,{eventId:n.id,event:null,resource:null});return delete t.id,t})))),n}},{key:"toICSString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isScheduled)return"";var t=Un.toUTC(new Date),n=Un.toUTC(this.startDate),r=Un.toUTC(this.endDate),i="YYYYMMDDTHHmmss",o=e.DTSTAMP||Un.format(t,i)+"Z";delete e.DTSTAMP;var a={};if(this.allDay){var s="YYYYMMDD";a={"DTSTART;VALUE=DATE":Un.format(n,s),"DTEND;VALUE=DATE":Un.format(r,s)}}else a={DTSTART:Un.format(n,i)+"Z",DTEND:Un.format(r,i)+"Z"};var l=z.a.scheduler&&z.a.getVersion("scheduler")||z.a.calendar&&z.a.getVersion("calendar")||"",u={BEGIN:"VCALENDAR",VERSION:"2.0",CALSCALE:"GREGORIAN",PRODID:"-//Bryntum AB//Bryntum Scheduler ".concat(l," //EN"),END:"VCALENDAR"},c=YC(YC(YC(YC({BEGIN:"VEVENT",UID:this.id+"@bryntum.com",CLASS:"PUBLIC",SUMMARY:this.name,DTSTAMP:o},a),this.recurrenceRule?{RRULE:this.recurrenceRule}:{}),e),{},{END:"VEVENT"}),f=Object.keys(u).map((function(e){return"".concat(e,":").concat(u[e])})),d=Object.keys(c).map((function(e){return"".concat(e,":").concat(c[e])}));return f.splice.apply(f,[f.length-1,0].concat(F()(d))),f.join("\n")}},{key:"exportToICS",value:function(e){if(this.isScheduled){var t=new Blob([this.toICSString(e)],{type:"text/calendar"});pe.a.downloadBlob(t,(this.name||"Event")+".ics")}}},{key:"isEditable",value:function(e){return!!this.getFieldDefinition(e)||void 0}},{key:"isFieldModified",value:function(e){return"fullDuration"===e?tt()(Ze()(n.prototype),"isFieldModified",this).call(this,"duration")||tt()(Ze()(n.prototype),"isFieldModified",this).call(this,"durationUnit"):tt()(Ze()(n.prototype),"isFieldModified",this).call(this,e)}}],[{key:"$name",get:function(){return"TimeSpan"}},{key:"fields",get:function(){return[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number",allowNull:!0,internal:!0},{name:"durationUnit",type:"string",defaultValue:"d",internal:!0},{name:"fullDuration",persist:!1,column:{type:"duration"},internal:!0},{name:"cls",defaultValue:"",internal:!0},{name:"iconCls",internal:!0},{name:"style",type:"object",internal:!0},{name:"name",type:"string",defaultValue:""}]}}]),n}(Lo);function XC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}KC._$name="TimeSpan";var ZC=/^([+-]?[0-9])?(SU|MO|TU|WE|TH|FR|SA)$/,JC=["SU","MO","TU","WE","TH","FR","SA"],QC=function(e){Ye()(n,e);var t=XC(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"decodeDay",value:function(e){var t,n;return(t=ZC.exec(e))&&(n=[JC.indexOf(t[2])],t[1]&&(t[1]=parseInt(t[1],10),n.push(t[1]))),n}},{key:"encodeDay",value:function(e){var t;if(Array.isArray(e)){var n=e,r=N()(n,2);e=r[0],t=r[1]}return(t?t.toString():"")+JC[e]}},{key:"decode",value:function(e){var t,n=[];if(e)for(var r=0;r<e.length;r++)(t=this.decodeDay(e[r]))&&n.push(t);return n}},{key:"encode",value:function(e){var t,n=[];if(e)for(var r=0;r<e.length;r++)(t=this.encodeDay(e[r]))&&n.push(t);return n}}]),n}($e);function eR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}QC._$name="RecurrenceDayRuleEncoder";var tR,nR=/ly$/i,rR=function(e){var t=e.replace(nR,"");return"DAI"===t?"DAY":t},iR=function(e,t,n,r){return r.buildOccurrence(e,n)},oR=function(e){return tR=e},aR=function(e){Ye()(n,e);var t=eR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"processIterationConfig",value:function(e){var t=e.recurrence,n=t.frequency,r=t.interval,i=t.timeSpan,o=t.endDate,a=t.count;if(!e.syncingStartDate&&!i.meta.isSyncedWithRule){var s=Un.add(i.startDate,r,rR(n)),l=Un.min(s,e.endDate||s);this.forEachDate({syncingStartDate:!0,startDate:i.startDate,endDate:l,recurrence:t,fn:iR})}var u=i.startDate,c=e.startDate,f=void 0===c?u:c,d=e.endDate,h=void 0===d?o:d;f<u&&(f=u),o?(!h||h>o)&&(h=o):a&&f>u&&(this.forEachDate({recurrence:t,fn:oR}),(!h||h>tR)&&(h=tR));var v=f;return e.startOnly||(f=new Date(Un.max(Un.add(f,-r,rR(n)),u))),Object.assign({extraArgs:[],startOnly:!Boolean(i.durationMS)},e,{startDate:f,endDate:h,timeSpan:i,timeSpanStart:u,earliestVisibleDate:v,durationMS:i.durationMS,spansStart:f<=u&&h>u})}},{key:"frequency",get:function(){return"NONE"}},{key:"MAX_OCCURRENCES_COUNT",get:function(){return 1e6}},{key:"getOccurrenceIndex",value:function(e){if(e.isOccurrence)return Un.diff(e.recurringTimeSpan.startDate,e.startDate,rR(e.recurringTimeSpan.recurrence.frequency))}},{key:"getNthDayInPeriod",value:function(e,t,n,r){var i,o,a;if(r){r>0?(o=1,a=e):(o=-1,a=t);var s=n-a.getDay();o*s<0&&(r+=o),((i=new Date(a.getTime()+6048e5*(r-o)+864e5*s))<e||i>t)&&(i=null)}return i}},{key:"buildDate",value:function(e,t,n){var r=new Date(e,t,n);if(r.getFullYear()===e&&r.getMonth()===t&&r.getDate()===n)return r}},{key:"isValidPosition",value:function(e){return Boolean(e)}},{key:"forEachDateAtPositions",value:function(e,t,n,r){for(var i=e.length,o={},a=0;a<t.length;a++){var s=t[a];if(this.isValidPosition(s)){var l=s>0?e[s-1]:e[i+s];if(l&&!o[l.getTime()]&&(o[l.getTime()]=!0,!1===n.call(r,l)))return!1}}}},{key:"isInView",value:function(e,t,n,r,i){return(e?t>=n:t.valueOf()+r>n)&&!i.hasException(t)}}]),n}($e);function sR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}aR._$name="AbstractRecurrenceIterator";var lR=function(e){Ye()(n,e);var t=sR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"frequency",get:function(){return"DAILY"}},{key:"forEachDate",value:function(e){var t=this.processIterationConfig(e),n=t.startOnly,r=t.startDate,i=t.endDate,o=t.timeSpan,a=t.timeSpanStart,s=t.earliestVisibleDate,l=t.durationMS,u=t.spansStart,c=t.recurrence,f=t.fn,d=t.extraArgs,h=t.scope,v=void 0===h?this:h,p=c.interval,g=r-a,y=864e5*p,m=Math.floor(g/y),b=c.count,k=0,w=Un.add(a,m*p,"day");for(i||b||(b=this.MAX_OCCURRENCES_COUNT);!i||w<=i;){if(k++,this.isInView(n,w,s,l,o)&&(i&&w>i||!1===f.apply(v,[w,k,1===k&&u,o].concat(F()(d)))||b&&k>=b))break;w=Un.add(w,p,"day")}}}]),n}(aR);function uR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}lR._$name="DailyRecurrenceIterator";var cR=function(e){Ye()(n,e);var t=uR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"frequency",get:function(){return"WEEKLY"}},{key:"forEachDate",value:function(e){var t,n,r=this.processIterationConfig(e),i=r.startOnly,o=r.startDate,a=r.endDate,s=r.timeSpan,l=r.timeSpanStart,u=r.earliestVisibleDate,c=r.durationMS,f=r.spansStart,d=r.recurrence,h=r.fn,v=r.extraArgs,p=r.scope,g=void 0===p?this:p,y=d.interval,m=d.days,b=0,k=d.count,w=QC.decode(m);for(w&&w.length?w.sort((function(e,t){return e[0]-t[0]})):w=[[l.getDay()]],t=Un.getNext(k||y>1?l:o,"week",0,0),a||k||(k=this.MAX_OCCURRENCES_COUNT);!a||t<=a;){for(var C=0;C<w.length;C++){if((n=Un.copyTimeValues(Un.add(t,w[C][0],"day"),l))>=l)if(b++,this.isInView(i,n,u,c,s)&&(a&&n>a||!1===h.apply(g,[n,b,1===b&&f,s].concat(F()(v)))||k&&b>=k))return}t=Un.getNext(t,"week",y,0)}}}]),n}(aR);function fR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}cR._$name="WeeklyRecurrenceIterator";var dR=function(e){Ye()(n,e);var t=fR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"frequency",get:function(){return"MONTHLY"}},{key:"getNthDayOfMonth",value:function(e,t){var n=Un.daysInMonth(e),r=null;return t&&Math.abs(t)<=n&&(r=new Date(e.getFullYear(),e.getMonth(),t<0?n+t+1:t)),r}},{key:"isValidPosition",value:function(e){return e&&Math.abs(e)>0&&Math.abs(e)<=31}},{key:"forEachDate",value:function(e){var t,n,r,i,o,a,s=this,l=this.processIterationConfig(e),u=l.startOnly,c=l.startDate,f=l.endDate,d=l.timeSpan,h=l.timeSpanStart,v=l.earliestVisibleDate,p=l.durationMS,g=l.spansStart,y=l.recurrence,m=l.fn,b=l.extraArgs,k=l.scope,w=void 0===k?this:k,C=y.interval,R=y.days,S=y.count,x=y.positions,E=QC.decode(R),D=x&&x.length,T={},O=y.monthDays,M=0;for(n=Un.startOf(S||C>1?h:c,"month"),r=new Date(Un.getNext(n,"month",1)-1),O&&O.length||E&&E.length||(O=[h.getDate()]),E&&E.length&&E.forEach((function(e){e[1]&&((t=t||{})[e[0]]=e[1])}));(!f||f>=n)&&(!S||M<S);){if(i=[],E&&E.length){if(E.forEach((function(e){var t=e[0],l=1,u=53;for(e[1]&&(l=u=e[1]),a=l;a<=u;a++)(o=s.getNthDayInPeriod(n,r,t,a))&&(o=Un.copyTimeValues(o,h),T[o.getTime()]||(T[o.getTime()]=!0,i.push(o)))})),i.sort((function(e,t){return e-t})),!D)for(a=0;a<i.length;a++)if((o=i[a])>=h){var A=this.isInView(u,o,v,p,d);if(M++,A&&(f&&o>f||!1===m.apply(w,[o,M,1===M&&g,d].concat(F()(b)))||S&&M>=S))return!1}}else{var I=[];for(a=0;a<O.length;a++)(o=this.getNthDayOfMonth(n,O[a]))&&!T[o.getTime()]&&(T[o.getTime()]=!0,I.push(o));for(I.sort((function(e,t){return e-t})),a=0;a<I.length;a++)if(o=Un.copyTimeValues(I[a],h),D)i.push(o);else if(o>=h){var P=this.isInView(u,o,v,p,d);if(M++,P&&(f&&o>f||!1===m.apply(w,[o,M,1===M&&g,d].concat(F()(b)))||S&&M>=S))return}}D&&i.length&&this.forEachDateAtPositions(i,x,(function(e){if(e>=h){var t=u?e>=v:e.valueOf()+p>v&&!d.hasException(e);if(M++,t&&(!f||e<=f)&&(!1===m.apply(w,[e,M,1===M&&g,d].concat(F()(b)))||S&&M>=S))return!1}})),n=Un.getNext(n,"month",C),r=new Date(Un.getNext(n,"month",1)-1)}}}]),n}(aR);function hR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}dR._$name="MonthlyRecurrenceIterator";var vR=function(e){Ye()(n,e);var t=hR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"frequency",get:function(){return"YEARLY"}},{key:"forEachDate",value:function(e){var t,n,r,i,o,a,s=this,l=this.processIterationConfig(e),u=l.startOnly,c=l.startDate,f=l.endDate,d=l.timeSpan,h=l.timeSpanStart,v=l.earliestVisibleDate,p=l.durationMS,g=l.spansStart,y=l.recurrence,m=l.fn,b=l.extraArgs,k=l.scope,w=void 0===k?this:k,C=y.interval,R=y.days,S=y.count,x=y.positions,E=QC.decode(R),D=x&&x.length,T={},O=y.months,M=0;for(i=Un.startOf(S||C>1?h:c,"year"),o=new Date(Un.getNext(i,"year",1)-1),O&&O.sort((function(e,t){return e-t})),O&&O.length||E&&E.length||(O=[h.getMonth()+1]),E&&E.length&&E.forEach((function(e){e[1]&&((a=a||{})[e[0]]=e[1])}));(!f||f>=i)&&(!S||M<S);){if(r=[],E&&E.length){if(E.forEach((function(e){var a=e[0],l=1,u=53;for(e[1]&&(l=u=e[1]),t=l;t<=u;t++)(n=s.getNthDayInPeriod(i,o,a,t))&&(n=Un.copyTimeValues(n,h),T[n.getTime()]||(T[n.getTime()]=!0,r.push(n)))})),r.sort((function(e,t){return e-t})),!D)for(t=0;t<r.length;t++)if((n=r[t])>=h){var A=this.isInView(u,n,v,p,d);if(M++,A&&(f&&n>f||!1===m.apply(w,[n,M,1===M&&g,d].concat(F()(b)))||S&&M>=S))return}}else for(t=0;t<O.length;t++)if((n=this.buildDate(i.getFullYear(),O[t]-1,h.getDate()))&&(n=Un.copyTimeValues(n,h),!T[n.getTime()]))if(T[n.getTime()]=!0,D)r.push(n);else if(n>=h){var I=u?n>=v:n.valueOf()+p>v&&!d.hasException(n);if(M++,I&&(f&&n>f||!1===m.apply(w,[n,M,1===M&&g,d].concat(F()(b)))||S&&M>=S))return}D&&r.length&&this.forEachDateAtPositions(r,x,(function(e){if(e>=h){var t=u?e>=v:e.valueOf()+p>v&&!d.hasException(e);if(M++,t&&(!f||e<=f)&&(!1===m.apply(w,[e,M,1===M&&g,d].concat(F()(b)))||S&&M>=S))return!1}})),i=Un.getNext(i,"year",C),o=new Date(Un.getNext(i,"year",1)-1)}}}]),n}(aR);function pR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}vR._$name="YearlyRecurrenceIterator";var gR={};function yR(e){return e?"string"==typeof e&&(e=e.split(",").map((function(e){return parseInt(e,10)}))):e=null,e}function mR(e){return e?"string"==typeof e&&(e=e.split(",")):e=null,e}function bR(e,t){return String(e)===String(t)}function kR(e){return this.defaultValue&&void 0===e?this.defaultValue:this.allowNull&&null==e?null:(e=parseInt(e),isNaN(e)?void 0:e)}[lR,cR,dR,vR].forEach((function(e){gR[e.frequency]=e}));var wR=function(e){Ye()(n,e);var t=pR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"isRecurrenceModel",get:function(){return!0}},{key:"dateFormat",get:function(){return this._dateFormat||"YYYYMMDDTHHmmss"},set:function(e){this._dateFormat=e}},{key:"recurrenceIterator",get:function(){return gR[this.frequency]}},{key:"timeSpan",get:function(){return this._timeSpan},set:function(e){this._timeSpan=e}},{key:"rule",get:function(){var e=this,t=[];return e.frequency&&(t.push("FREQ=".concat(e.frequency)),e.interval>1&&t.push("INTERVAL=".concat(e.interval)),e.days&&e.days.length&&t.push("BYDAY="+e.days.join(",")),e.monthDays&&e.monthDays.length&&t.push("BYMONTHDAY="+e.monthDays.join(",")),e.months&&e.months.length&&t.push("BYMONTH="+e.months.join(",")),e.count&&t.push("COUNT=".concat(e.count)),e.endDate&&t.push("UNTIL="+Un.format(e.endDate,e.dateFormat)),e.positions&&e.positions.length&&t.push("BYSETPOS="+e.positions.join(","))),t.join(";")},set:function(e){var t=this;if(t.beginBatch(),e){for(var n=e.split(";"),r=0,i=n.length;r<i;r++){var o=n[r].split("="),a=o[1];switch(o[0]){case"FREQ":t.frequency=a;break;case"INTERVAL":t.interval=a;break;case"COUNT":t.count=a,t.until=null;break;case"UNTIL":t.endDate=a?Un.parse(a,t.dateFormat):null,t.count=null;break;case"BYDAY":t.days=a;break;case"BYMONTHDAY":t.monthDays=a;break;case"BYMONTH":t.months=a;break;case"BYSETPOS":t.positions=a}}t.sanitize()}else t.set({frequency:null,interval:null,count:null,endDate:null,days:null,monthDays:null,months:null,positions:null});t.endBatch()}},{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=e.rule,i=e.timeSpan;t._suspendedTimeSpanNotifying=0,delete e.timeSpan,delete e.rule,tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),r&&(t.suspendTimeSpanNotifying(),t.rule=r,t.resumeTimeSpanNotifying()),t.timeSpan=i}},{key:"forEachOccurrence",value:function(e,t,n){this.timeSpan.startDate&&this.recurrenceIterator.forEachDate({recurrence:this,startDate:e,endDate:t,fn:function(e,t,r,i){n(i.buildOccurrence(e,r),r,t,e)}})}},{key:"sanitize",value:function(){var e=this,t=e.timeSpan,n=t&&t.startDate;switch(e.beginBatch(),e.isSanitizing=!0,e.frequency){case"DAILY":e.positions=null,e.days=null,e.monthDays=null,e.months=null;break;case"WEEKLY":e.positions=null,e.monthDays=null,e.months=null;var r=e.days;n&&r&&1==r.length&&r[0]==QC.encodeDay(n.getDay())&&(e.days=null);break;case"MONTHLY":e.monthDays&&e.monthDays.length&&(e.positions=null,e.days=null),e.months=null;var i=e.monthDays;n&&i&&1==i.length&&i[0]==n.getDate()&&(e.monthDays=null);break;case"YEARLY":e.monthDays=null;var o=e.months;n&&o&&1==o.length&&o[0]==n.getMonth()+1&&(e.months=null)}e.isSanitizing=!1,e.endBatch()}},{key:"copy",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o=(e=tt()(Ze()(n.prototype),"copy",this)).call.apply(e,[this].concat(r));return o.dateFormat=this.dateFormat,o.timeSpan=this.timeSpan,o}},{key:"afterChange",value:function(e,t,r){var i=tt()(Ze()(n.prototype),"afterChange",this).call(this,e,t,r),o=this.timeSpan;if(this.isSanitizing||this.sanitize(),o){if("endDate"in t){var a=Un.clearTime(t.endDate.value),s=o.exceptionDates;if(o.removeOccurrencesFrom(a),s)for(var l in s){Un.parseKey(l)>=a&&delete s[l]}}this.isTimeSpanNotifyingSuspended||o.onRecurrenceChanged()}return i}},{key:"count",get:function(){return this.get("count")},set:function(e){e&&(this.endDate=null),this.set("count",e)}},{key:"endDate",get:function(){return this.get("endDate")},set:function(e){e&&(this.count=null),this.set("endDate",e)}},{key:"isTimeSpanNotifyingSuspended",get:function(){return Boolean(this._suspendedTimeSpanNotifying)}},{key:"suspendTimeSpanNotifying",value:function(){this._suspendedTimeSpanNotifying++}},{key:"resumeTimeSpanNotifying",value:function(){this._suspendedTimeSpanNotifying&&this._suspendedTimeSpanNotifying--}}],[{key:"$name",get:function(){return"RecurrenceModel"}},{key:"fields",get:function(){return[{name:"frequency",defaultValue:"DAILY"},{name:"interval",defaultValue:1,convert:kR},{name:"endDate",type:"date"},{name:"count",allowNull:!0,convert:kR},{name:"days",convert:mR,isEqual:bR},{name:"monthDays",convert:yR,isEqual:bR},{name:"months",convert:yR,isEqual:bR},{name:"positions",convert:yR,isEqual:bR}]}}]),n}(Lo);function CR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}wR._$name="RecurrenceModel";function RR(e){var t={},n=this.dateFormat;return e&&(e="string"==typeof e?e.split(","):Array.isArray(e)?e:[e]).forEach((function(e){"string"==typeof e&&(e=Un.parse(e,n)),isNaN(e)||(t[Un.makeKey(e)]=1)})),t}function SR(e){var t=[],n=this.dateFormat;for(var r in e)e[r]&&t.push(Un.format(Un.parseKey(r),n));return t}var xR=[],ER=function(e){return function(e){Ye()(n,e);var t=CR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"supportsRecurring",get:function(){return!0}},{key:"remove",value:function(){if(!this.isOccurrence)return tt()(Ze()(n.prototype),"remove",this).apply(this,arguments);this.cancelBatch(),this.detachFromRecurringEvent()}},{key:"eventStore",get:function(){var e,t=this.isOccurrence?this.recurringEvent.eventStore:tt()(Ze()(n.prototype),"eventStore",this);return!t&&null!==(e=this.firstStore)&&void 0!==e&&e.isRecurringTimeSpansMixin&&(t=this.firstStore),t}},{key:"recurrenceModel",get:function(){return this._recurrenceModel||wR},set:function(e){this._recurrenceModel=e}},{key:"setRecurrence",value:function(e,t,n){var r,i=this;e&&(e.isRecurrenceModel||("string"==typeof e&&(e={frequency:e},t&&(e.interval=t),n&&(n instanceof Date?e.endDate=n:e.count=n)),e=new i.recurrenceModel(e)),e.timeSpan=i,r=e.rule),i.recurrence=e,i.recurrenceRule=r}},{key:"recurrence",get:function(){var e=this,t=e.recurrenceRule;return!e._recurrence&&t&&(e._recurrence=new e.recurrenceModel({rule:t,timeSpan:e,id:"".concat(e.id,"-recurrence")})),e._recurrence},set:function(e){var t=this;t._recurrence=e,e?(e.timeSpan=t,t.recurrenceRule=e.rule):t.isOccurrence?t.setData("recurrenceRule",null):t.recurrenceRule=null}},{key:"isRecurring",get:function(){return Boolean(!this.isOccurrence&&this.recurrence)}},{key:"isOccurrence",get:function(){return Boolean(this.recurringTimeSpan)}},{key:"recurringTimeSpan",get:function(){return this._recurringTimeSpan},set:function(e){this._recurringTimeSpan=e}},{key:"isPersistable",get:function(){return tt()(Ze()(n.prototype),"isPersistable",this)&&(!this.supportsRecurring||!this.isOccurrence)}},{key:"getOccurrencesForDateRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.eventStore.getOccurrencesForTimeSpan(this,e,t)}},{key:"occurrences",get:function(){var e=this;if(this.isRecurring){var t=[];return this.occurrenceMap.forEach((function(n){n!==e&&t.push(n)})),t}return xR}},{key:"occurrenceMap",get:function(){return this._occurrencesMap||(this._occurrencesMap=new Map)}},{key:"removeOccurrence",value:function(e){var t,n=e.isTimeSpan?e.occurrenceDate:e;null===(t=this.eventStore)||void 0===t||t.globalOccurrences.delete(this.createRecurrenceKey(n)),this.occurrenceMap.delete(Un.makeKey(n))}},{key:"removeOccurrencesFrom",value:function(e){var t=this;this.occurrenceMap.forEach((function(n,r){Un.parseKey(r)>=e&&t.removeOccurrence(n)}))}},{key:"removeOccurrences",value:function(){var e=this;[this].concat(F()(this.occurrences)).forEach((function(t){return e.removeOccurrence(t)}))}},{key:"onRecurrenceChanged",value:function(){var e;this.recurrenceRule=(null===(e=this.recurrence)||void 0===e?void 0:e.rule)||null}},{key:"occurrenceDate",get:function(){var e;return(null===(e=this.meta.modified)||void 0===e?void 0:e.startDate)||this.startDate}},{key:"occurrenceIndex",get:function(){return aR.getOccurrenceIndex(this)}},{key:"buildOccurrence",value:function(e,t){var n,r=this,i=r.occurrenceMap,o=r.recurrence,a=r.meta,s=null===(n=r.eventStore)||void 0===n?void 0:n.globalOccurrences,l=r.createRecurrenceKey(e),u=!(e-r.startDate),c=r.constructor.fieldMap,f=null==s?void 0:s.get(l),d=r.duration;!r.endDate||!r.allDay&&d||(d=Un.as(r.durationUnit,r.endDate.getTime()-r.startDate.getTime()));var h=void 0!==d?Un.add(e,d,r.durationUnit):void 0;if(!f){var v;if(t||u)f=r,u||(r.setStartEndDate(e,h,!0),o.suspendTimeSpanNotifying(),o.sanitize(),o.resumeTimeSpanNotifying()),a.isSyncedWithRule=!0;else(f=r.copy((v={},Qe()(v,c.id.dataSource,l),Qe()(v,c.startDate.dataSource,e),Qe()(v,c.endDate.dataSource,h),Qe()(v,c.duration.dataSource,d),v))).recurringTimeSpan=r;null==s||s.set(l,f),i.set(Un.makeKey(e),f)}return f}},{key:"createRecurrenceKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.startDate;return"_generated:".concat(this.id,":").concat(Un.format(e,"YYYYMMDD"))}},{key:"afterChange",value:function(e,t,r){var i,o=this,a=o.eventStore;if("recurrenceRule"in t&&(o._recurrence=null,null==a||a.recurringEvents[t.recurrenceRule.value?"add":"delete"](o)),o.isOccurrence){var s,l,u=o.recurringTimeSpan,c=o.resource,f=o.occurrenceIndex,d=o.recurrence,h=(null===(s=t.startDate)||void 0===s?void 0:s.value)||o.startDate,v=d&&u.recurrence.count,p=(null===(l=t.resourceRecords)||void 0===l?void 0:l.value)||o.data.newResource;u.beginBatch(),o.detachFromRecurringEvent(),o.clearChanges(),o.setData("id",o.generateId(u.eventStore)),p&&delete o.data.resourceId,u.eventStore.add(o,!0),o.startDate=h,v&&(o.recurrence.count=v-f),o.assign(p||c),delete o.data.resourceRecords,delete t.resourceRecords,u.endBatch()}else"newExceptionDate"in t&&(o.meta.modified.exceptionDates=!0,delete o.meta.modified.newExceptionDate,o.removeOccurrence(t.newExceptionDate.value));for(var g=arguments.length,y=new Array(g>3?g-3:0),m=3;m<g;m++)y[m-3]=arguments[m];return(i=tt()(Ze()(n.prototype),"afterChange",this)).call.apply(i,[this,e,t,r].concat(y))}},{key:"detachFromRecurringEvent",value:function(){var e=this,t=e.recurringTimeSpan,n=e.occurrenceDate,r=e.startDate;e.recurringTimeSpan=null,t.addExceptionDate(n),e.recurrenceRule&&(t.recurrence.endDate=Un.add(r,-1,"minute"))}},{key:"newExceptionDate",set:function(e){e&&((this.exceptionDates||(this.exceptionDates={}))[Un.makeKey(e)]=1)}},{key:"addExceptionDate",value:function(e){return this.set({newExceptionDate:e})}},{key:"hasException",value:function(e){var t;return null===(t=this.exceptionDates)||void 0===t?void 0:t[Un.makeKey(e)]}}],[{key:"$name",get:function(){return"RecurringTimeSpan"}},{key:"fields",get:function(){return[{name:"recurrenceRule",internal:!0},{name:"exceptionDates",convert:RR,serialize:SR,internal:!0}]}}]),n}(e||KC)};function DR(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return TR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TR(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function TR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function OR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var MR=function(e){return function(e){Ye()(n,e);var t=OR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"resources",get:function(){return this.assignments.reduce((function(e,t){return t.resource&&e.push(t.resource),e}),[])},set:function(e){Array.isArray(e)||(e=[e]);var t=this,n=e.map(t.constructor.asId),r=t.assignments.map((function(e){return e.resource.id})),i=it.delta(n,r),o=i.onlyInA,a=i.onlyInB;t.assignmentStore.add(o.map((function(e){return{resource:e,event:t}}))),t.assignmentStore.remove(a.map((function(e){return t.assignments.find((function(t){return t.resource.id===e}))})))}},{key:"forEachResource",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=DR(this.resources);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!1===e.call(n,i))return}}catch(e){r.e(e)}finally{r.f()}}},{key:"getResource",value:function(e){return null==e?this.resource:this.resourceStore?this.resourceStore.getById(e):null}},{key:"startDate",get:function(){var e,t;this.isOccurrence?e=this.get("startDate"):e=null!==(t=this._startDate)&&void 0!==t?t:tt()(Ze()(n.prototype),"startDate",this);return this.allDay&&(e=this.constructor.getAllDayStartDate(e)),e},set:function(e){this.batching?(this._startDate=e,this.set({startDate:e})):gh()(Ze()(n.prototype),"startDate",e,this,!0)}},{key:"endDate",get:function(){var e,t;this.isOccurrence?e=this.get("endDate"):e=null!==(t=this._endDate)&&void 0!==t?t:tt()(Ze()(n.prototype),"endDate",this);return this.allDay&&(e=this.constructor.getAllDayEndDate(e)),e},set:function(e){this.batching?(this._endDate=e,this.set({endDate:e})):gh()(Ze()(n.prototype),"endDate",e,this,!0)}},{key:"isEvent",get:function(){return!0}},{key:"isDraggable",get:function(){return this.draggable}},{key:"isResizable",get:function(){return!this.isMilestone&&this.resizable}},{key:"isPersistable",get:function(){return tt()(Ze()(n.prototype),"isPersistable",this)&&!this.meta.isCreating}},{key:"endBatch",value:function(){var e=this.isPersistable;tt()(Ze()(n.prototype),"endBatch",this).apply(this,arguments),this.isPersistable&&!e&&this.assignments.forEach((function(e){e.stores.forEach((function(t){t.updateModifiedBagForRecord(e)}))}))}},{key:"usesSingleAssignment",get:function(){return!this.eventStore||this.eventStore.usesSingleAssignment}},{key:"persistableData",get:function(){var e=tt()(Ze()(n.prototype),"persistableData",this);return this.usesSingleAssignment||delete e.resourceId,e}},{key:"resource",get:function(){var e=this.resources;return e.length?e[0]:null},set:function(e){this.resourceId=this.constructor.asId(e)}},{key:"resourceId",get:function(){var e;return this.usesSingleAssignment?this.get("resourceId"):null===(e=this.resource)||void 0===e?void 0:e.id},set:function(e){this.applyResourceId(e)}},{key:"applyResourceId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.assignments,i=n.assignmentStore,o=n.eventStore;if(o)if(null!=e)if(n.skipEnforcingSingleAssignment||(o.usesSingleAssignment=!0),null!=r&&r.length&&e!==r[0].resourceId){var a=Boolean(o.eventsSuspended);a&&i.suspendEvents(),r[0].resource=e,a&&i.resumeEvents()}else i.assignEventToResource(n,e);else i.remove(n.assignments);else t||n.set({resourceId:e})}},{key:"applyValue",value:function(e,t,r,i,o){if(o&&"resourceId"===o.name&&!this.meta.isAssigning){var a=this.eventStore;a&&(a.isAssigning=!0),this.applyResourceId(r,!0),a&&(a.isAssigning=!1)}tt()(Ze()(n.prototype),"applyValue",this).call(this,e,t,r,i,o)}},{key:"assignments",get:function(){return F()(this.assigned||[])}},{key:"assign",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.eventStore;n&&!n.usesSingleAssignment?n.assignEventToResource(this,e,t):(this.resourceId=this.constructor.asId(e),n||(this.meta.skipEnforcingSingleAssignment=!0))}},{key:"unassign",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;e=r.constructor.asId(e),r.meta.removingResource=n,null===(t=r.eventStore)||void 0===t||t.unassignEventFromResource(r,e),r.meta.removingResource=null}},{key:"reassign",value:function(e,t){this.eventStore&&this.eventStore.reassignEventFromResourceToResource(this,e,t)}},{key:"isAssignedTo",value:function(e){var t=this.constructor.asId(e);return this.assignments.some((function(e){return e.resourceId===t}))}},{key:"predecessors",get:function(){return F()(this.incomingDeps)}},{key:"successors",get:function(){return F()(this.outgoingDeps)}},{key:"dependencies",get:function(){return[].concat(F()(this.incomingDeps),F()(this.outgoingDeps))}},{key:"normalize",value:function(){}},{key:"inSetNormalize",value:function(){}},{key:"recurringEvent",get:function(){return this.recurringTimeSpan}},{key:"isInterDay",get:function(){var e=this.durationMS;if(e>=864e5)return!0;var t=this.endDate,n=this.startDate,r=Un.clearTime(n);return n&&t?(r.setDate(r.getDate()+1),(t||Un.add(n,e))>r):void 0}},{key:"isEditable",value:function(e){switch(e){case"endDate":case"duration":case"fullDuration":return this.isLeaf}return tt()(Ze()(n.prototype),"isEditable",this).call(this,e)}}],[{key:"$name",get:function(){return"EventModelMixin"}},{key:"isEventModel",get:function(){return!0}},{key:"fields",get:function(){return[{name:"resourceId",internal:!0},{name:"resources",column:{type:"resourceassignment"},persist:!1,internal:!0},{name:"draggable",type:"boolean",persist:!1,defaultValue:!0,internal:!0},{name:"resizable",persist:!1,defaultValue:!0,internal:!0},{name:"allDay",type:"boolean",defaultValue:!1},{name:"eventStyle",internal:!0},{name:"eventColor",internal:!0},{name:"milestoneWidth",internal:!0},{name:"$highlight",persist:!1,internal:!0},{name:"stickyContents",internal:!0}]}},{key:"getAllDayStartDate",value:function(e){return e&&e.isEvent&&(e=e.get("startDate")),e&&(e=Un.clearTime(e,!0)),e}},{key:"getAllDayEndDate",value:function(e){return e&&e.isEvent&&(e=e.get("endDate")),e&&(e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0||e.getMilliseconds()>0)&&(e=Un.getNext(e,"d",1)),e}},{key:"getAllDayDisplayStartDate",value:function(e){return e&&e.isEvent&&(e=e.get("startDate")),Un.clearTime(e,!0)}},{key:"getAllDayDisplayEndDate",value:function(e,t){return e&&e.isEvent&&(t=e.get("endDate"),e=e.get("startDate")),t&&(e=this.constructor.getAllDayDisplayStartDate(e),Un.clearTime(t,!0).valueOf()===t.valueOf()?t=Un.add(t,Un.DAY,-1):e.valueOf()!==t.valueOf()&&(t=Un.clearTime(t,!0))),t}}]),n}(e)};function AR(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return IR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IR(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function IR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function PR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var FR=function(e){Ye()(n,e);var t=PR(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Bw],(function(e){var t=e.prototype;return function(e){Ye()(o,e);var n,r,i=PR(o);function o(){return B()(this,o),i.apply(this,arguments)}return _()(o,[{key:"getAssignmentFor",value:function(e){var t,n=AR(this.assigned);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.resource===e)return r}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"isAssignedTo",value:function(e){return Boolean(this.getAssignmentFor(e))}},{key:"assign",value:(r=Pt()(At.a.mark((function e(t){var n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getAssignmentFor(t)){e.next=2;break}throw new Error("Resource can't be assigned twice to the same task");case 2:return n=this.project.assignmentStore.modelClass,this.addAssignment(new n({event:this,resource:t})),e.abrupt("return",this.commitAsync());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"unassign",value:(n=Pt()(At.a.mark((function e(t){var n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getAssignmentFor(t)){e.next=3;break}throw new Error("Can't unassign resource `".concat(t,"` from task `").concat(this,"` - resource is not assigned to the task!"));case 3:return this.removeAssignment(n),e.abrupt("return",this.commitAsync());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"leaveProject",value:function(){var e;if(this.assigned){var n=this.getEventStore();this.assigned.forEach((function(e){return n.assignmentsForRemoval.add(e)}))}(e=t.leaveProject).call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"remove",value:function(){if(!this.parent)return t.remove.call(this);var e=this.getEventStore();t.remove.call(this),e&&e.afterEventRemoval()}},{key:"addAssignment",value:function(e){return this.getProject().assignmentStore.add(e),e}},{key:"removeAssignment",value:function(e){return this.getProject().assignmentStore.remove(e),e}}]),o}(e)})));function LR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var BR=function(e){Ye()(n,e);var t=LR(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Vw,FR],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=LR(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"assigned",get:function(){var e,t=null===(e=this.project)||void 0===e?void 0:e.assignmentStore.getEventsAssignments(this);return t?this.$cachedAssignments=t:this.$cachedAssignments}},{key:"applyValue",value:function(e,n,r,i,o){var a;"id"===n&&(null===(a=this.assigned)||void 0===a||a.forEach((function(e){return e.set("eventId",r)}))),t.applyValue.call(this,e,n,r,i,o)}},{key:"copy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t.copy.call(this,e,n);return(Qn.isObject(n)&&!n.skipFieldIdentifiers||!Qn.isObject(n))&&(r.$cachedAssignments=this.assigned),r}}]),r}(e)})));function jR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var _R=function(e){Ye()(n,e);var t=jR(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Vw],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=jR(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"outgoingDeps",get:function(){return this.project.dependencyStore.getOutgoingDepsForEvent(this)}},{key:"incomingDeps",get:function(){return this.project.dependencyStore.getIncomingDepsForEvent(this)}},{key:"leaveProject",value:function(){var e=this.eventStore;this.outgoingDeps&&this.outgoingDeps.forEach((function(t){return e.dependenciesForRemoval.add(t)})),this.incomingDeps&&this.incomingDeps.forEach((function(t){return e.dependenciesForRemoval.add(t)})),t.leaveProject.call(this)}}]),r}(e)})));function HR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var NR=function(e){Ye()(n,e);var t=HR(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Vw,BR,_R],(function(e){e.prototype;return function(e){Ye()(n,e);var t=HR(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(e)})));function zR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var VR=function(e){Ye()(n,e);var t=zR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"EventModel"}}]),n}(NR.derive(KC).mixin(ER,Wk,MR));function WR(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $R(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function $R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}VR.exposeProperties(),VR._$name="EventModel";var GR=function(e){Ye()(n,e);var t=UR(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Fw],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=UR(r);function r(){var e;return B()(this,r),(e=n.apply(this,arguments)).assignmentsForRemoval=new Set,e.dependenciesForRemoval=new Set,e}return _()(r,[{key:"onDataChange",value:function(e){var t;tt()(Ze()(r.prototype),"onDataChange",this).call(this,e),(null===(t=e.removed)||void 0===t?void 0:t.length)&&this.afterEventRemoval()}},{key:"remove",value:function(e,n){var r=t.remove.call(this,e);return this.afterEventRemoval(),r}},{key:"removeAll",value:function(e){var n=t.removeAll.call(this,e);return this.afterEventRemoval(),n}},{key:"afterEventRemoval",value:function(){var e=this.assignmentsForRemoval,t=this.dependenciesForRemoval;if(e){var n=this.getAssignmentStore();if(n&&!n.allAssignmentsForRemoval&&e.size){var r=F()(e).filter((function(e){return!n.assignmentsForRemoval.has(e)}));r.length>0&&n.remove(r)}e.clear();var i=this.getDependencyStore();if(i&&!i.allDependenciesForRemoval&&t.size){var o=F()(t).filter((function(e){return!i.dependenciesForRemoval.has(e)}));o.length>0&&i.remove(o)}t.clear()}}},{key:"processRecord",value:function(e){var t;if(!(null===(t=this.project)||void 0===t?void 0:t.isRepopulatingStores)){var n=this.getById(e.id),r=n&&n!==e;if(r){var i,o=WR(n.assigned);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.event=e}}catch(e){o.e(e)}finally{o.f()}}}return e}}]),r}(e)})));function YR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var qR=function(e){Ye()(n,e);var t=YR(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([GR,eC],(function(e){e.prototype;return function(e){Ye()(n,e);var t=YR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"joinProject",value:function(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"event")}},{key:"afterLoadData",value:function(){var e;this.afterEventRemoval(),null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"event")}}],[{key:"defaultConfig",get:function(){return{modelClass:NR}}}]),n}(e)})));function KR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var XR=function(e){Ye()(n,e);var t=KR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:VR}}}]),n}(Wk(qR.derive(ss)).mixin(NC,UC,_C));function ZR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}XR._$name="EventStore";var JR=["SS","SF","FS","FF"],QR=function(e){Ye()(n,e);var t=ZR(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"sourceEvent",get:function(){return z.a.deprecate("scheduler","5.0.0","Deprecated in favor of fromEvent"),this.fromEvent},set:function(e){this.fromEvent=e}},{key:"targetEvent",get:function(){return z.a.deprecate("scheduler","5.0.0","Deprecated in favor of toEvent"),this.toEvent},set:function(e){this.targetEvent=e}},{key:"construct",value:function(e){null!=e.from&&(e.fromEvent=e.from),null!=e.to&&(e.toEvent=e.to),tt()(Ze()(n.prototype),"construct",this).apply(this,arguments)}},{key:"eventStore",get:function(){var e;return this.eventStore||(null===(e=this.unjoinedStores[0])||void 0===e?void 0:e.eventStore)}},{key:"from",get:function(){return this.get("from")},set:function(e){var t=this.fromEvent;null!=t&&t.isModel&&t.id===e?this.set("from",e):this.fromEvent=e}},{key:"to",get:function(){return this.get("to")},set:function(e){var t=this.toEvent;null!=t&&t.isModel&&t.id===e?this.set("to",e):this.toEvent=e}},{key:"hardType",get:function(){return this.getHardType()},set:function(e){this.setHardType(e)}},{key:"getHardType",value:function(){return this.get("type")}},{key:"setHardType",value:function(e){var t;return e!==this.hardType&&(t=this.set({type:e,fromSide:null,toSide:null})),t}},{key:"lag",get:function(){return this.get("lag")},set:function(e){"number"==typeof e?this.set({lag:e}):this.setLag(e)}},{key:"setLag",value:function(e,t){1!==arguments.length?(e=parseFloat(e),this.set({lag:e,lagUnit:t})):"number"==typeof e?this.lag=e:(e=Un.parseDuration(e),this.set({lag:e.magnitude,lagUnit:e.unit}))}},{key:"getLag",value:function(){return this.lag?"".concat(this.lag<0?"-":"+").concat(Math.abs(this.lag)).concat(Un.getShortNameOfUnit(this.lagUnit)):""}},{key:"fullLag",get:function(){return new Bo({unit:this.lagUnit,magnitude:this.lag})},set:function(e){"string"==typeof e?this.setLag(e):this.setLag(e.magnitude,e.unit)}},{key:"isPersistable",get:function(){var e,t=this,r=t.stores,i=t.unjoinedStores,o=r[0];if(o){var a=t.fromEvent,s=t.toEvent,l=o.crudManager;e=a&&(l||!a.hasGeneratedId)&&s&&(l||!s.hasGeneratedId)}else e=Boolean(i[0]);return e&&tt()(Ze()(n.prototype),"isPersistable",this)}},{key:"getSourceEvent",value:function(){return z.a.deprecate("scheduler","5.0.0","Deprecated in favor of fromEvent"),this.fromEvent}},{key:"getTargetEvent",value:function(){return z.a.deprecate("scheduler","5.0.0","Deprecated in favor of toEvent"),this.toEvent}},{key:"getDateRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.fromEvent,r=this.toEvent;if(t&&r&&t.isScheduled&&r.isScheduled){var i,o,a=n.Type;switch(this.type){case a.StartToStart:i=t.startDate,o=r.startDate;break;case a.StartToEnd:i=t.startDate,o=r.endDate;break;case a.EndToEnd:i=t.endDate,o=r.endDate;break;case a.EndToStart:i=t.endDate,o=r.startDate;break;default:throw new Error("Invalid dependency type: "+this.type)}return{start:e?i:Un.min(i,o),end:e?o:Un.max(i,o)}}return null}},{key:"highlight",value:function(e){var t=this.highlighted?this.highlighted.split(" "):[];t.includes(e)||(this.highlighted=t.concat(e).join(" "))}},{key:"unhighlight",value:function(e){var t=this.highlighted;if(t){var n=t.split(" "),r=n.findIndex((function(t){return t===e}));r>=0&&(n.splice(r,1),this.highlighted=n.join(" "))}}},{key:"isHighlightedWith",value:function(e){return this.highlighted&&this.highlighted.split(" ").includes(e)}},{key:"getConnectorString",value:function(e){var t=JR[this.type];return e?t:this.type===n.Type.EndToStart?"":t}},{key:"toString",value:function(){return"".concat(this.from).concat(this.getConnectorString()).concat(this.getLag())}},{key:"isValid",get:function(){var e=this.from,t=this.to;return"number"==typeof this.type&&e&&""!==e&&null!=t&&""!==t&&e!==t}},{key:"fromEventName",get:function(){var e;return(null===(e=this.fromEvent)||void 0===e?void 0:e.name)||""}},{key:"toEventName",get:function(){var e;return(null===(e=this.toEvent)||void 0===e?void 0:e.name)||""}}],[{key:"$name",get:function(){return"DependencyBaseModel"}},{key:"Type",get:function(){return{StartToStart:0,StartToEnd:1,EndToStart:2,EndToEnd:3}}},{key:"fields",get:function(){return[{name:"from"},{name:"to"},{name:"type",type:"int",defaultValue:2},{name:"cls",defaultValue:""},{name:"bidirectional",type:"boolean"},{name:"fromSide",type:"string"},{name:"toSide",type:"string"},{name:"lag",type:"number",allowNull:!0,defaultValue:0},{name:"lagUnit",type:"string",defaultValue:"d"}]}}]),n}(Lo);function eS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}QR.exposeProperties(),QR._$name="DependencyBaseModel";var tS=function(e){Ye()(n,e);var t=eS(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([_w],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=eS(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"setChanged",value:function(e,n,r){var i,o,a,s=!1;if("fromEvent"===e||"toEvent"===e){var l=Dw(n,Vw)?n:null===(i=this.eventStore)||void 0===i?void 0:i.getById(n);l&&(s=!0),n=l||n}t.setChanged.call(this,e,n,r,!0),!s||this.project.isPerformingCommit||(null===(o=this.dependencyStore)||void 0===o?void 0:o.isLoadingData)||null===(a=this.dependencyStore)||void 0===a||a.invalidateIndices()}},{key:"joinProject",value:function(){t.joinProject.call(this),this.setChanged("fromEvent",this.get("fromEvent")),this.setChanged("toEvent",this.get("toEvent"))}},{key:"calculateInvalidated",value:function(){var e,t,n=this.$changed,r=n.fromEvent,i=n.toEvent;if(null!==r&&!Dw(r,Vw)){var o=null===(e=this.eventStore)||void 0===e?void 0:e.getById(r);o&&(this.$changed.fromEvent=o)}if(null!==i&&!Dw(i,Vw)){var a=null===(t=this.eventStore)||void 0===t?void 0:t.getById(i);a&&(this.$changed.toEvent=a)}}},{key:"fromEvent",get:function(){var e=this.get("fromEvent");return Dw(e,Vw)?e:null},set:function(e){this.setChanged("fromEvent",e)}},{key:"toEvent",get:function(){var e=this.get("toEvent");return Dw(e,Vw)?e:null},set:function(e){this.setChanged("toEvent",e)}}],[{key:"fields",get:function(){return[{name:"fromEvent",isEqual:function(e,t){return e===t},persist:!1},{name:"toEvent",isEqual:function(e,t){return e===t},persist:!1}]}}]),r}(e)})));function nS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var rS=function(e){Ye()(n,e);var t=nS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getTypeFromSides",value:function(e,t,n){var r=QR.Type,i=n?"right":"left",o=n?"left":"right";return e===i?t===i?r.StartToStart:r.StartToEnd:t===o?r.EndToEnd:r.EndToStart}}],[{key:"$name",get:function(){return"DependencyModel"}}]),n}(Wk(tS.derive(QR)));function iS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}rS.exposeProperties(),rS._$name="DependencyModel";var oS=function(e){return function(e){Ye()(n,e);var t=iS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"reduceEventDependencies",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0;return o=o||function(e){return r.getEventDependencies(e)},(e=Array.isArray(e)?e:[e]).reduce((function(e,n){n.children&&!i?n.traverse((function(n){e=o(n).reduce(t,e)})):e=o(n).reduce(t,e)}),n),n}},{key:"mapEventDependencies",value:function(e,t,n,r,i){return this.reduceEventDependencies(e,(function(e,t){return n(t)&&e.push(t),e}),[],r,i)}},{key:"mapEventPredecessors",value:function(e,t,n,r){return this.reduceEventPredecessors(e,(function(e,t){return n(t)&&e.push(t),e}),[],r)}},{key:"mapEventSuccessors",value:function(e,t,n,r){return this.reduceEventSuccessors(e,(function(e,t){return n(t)&&e.push(t),e}),[],r)}},{key:"getEventDependencies",value:function(e){return[].concat(e.predecessors||[],e.successors||[])}},{key:"getEventPredecessors",value:function(e){return z.a.deprecate("scheduler","5.0.0","Superfluous, will be removed in favour of `event.predecessors`"),e.predecessors}},{key:"getEventSuccessors",value:function(e){return z.a.deprecate("scheduler","5.0.0","Superfluous, will be removed in favour of `event.successors`"),e.successors}},{key:"removeEventDependencies",value:function(e){this.remove(this.getEventDependencies(e))}},{key:"removeEventPredecessors",value:function(e){this.remove(e.predecessors)}},{key:"removeEventSuccessors",value:function(e,t){this.remove(e.successors)}},{key:"getBySourceTargetId",value:function(e){var t=this;return this.records.find((function(n){return e==t.constructor.makeDependencySourceTargetCompositeKey(n.from,n.to)}))}},{key:"getDependencyForSourceAndTargetEvents",value:function(e,t){return e=Lo.asId(e),t=Lo.asId(t),this.getBySourceTargetId(this.constructor.makeDependencySourceTargetCompositeKey(e,t))}},{key:"getEventsLinkingDependency",value:function(e,t){return this.getDependencyForSourceAndTargetEvents(e,t)||this.getDependencyForSourceAndTargetEvents(t,e)}},{key:"isValidDependency",value:function(e,t,n){return 1===arguments.length&&(t=e.to||e.toEvent,e=e.from||e.fromEvent),e instanceof KC&&t instanceof KC?this.project.isValidDependency(e,t,n):null!=e&&null!=t&&e!==t}},{key:"isValidDependencyToCreate",value:function(e,t,n){return this.isValidDependency(e,t,n)}},{key:"getHighlightedDependencies",value:function(e){return this.records.reduce((function(t,n){return n.isHighlightedWith(e)&&t.push(n),t}),[])}},{key:"getTimeSpanDependencies",value:function(e){return this.getEventDependencies(e)}}],[{key:"$name",get:function(){return"DependencyStoreMixin"}},{key:"defaultConfig",get:function(){return{loadPriority:400,syncPriority:400,storeId:"dependencies"}}},{key:"makeDependencySourceTargetCompositeKey",value:function(e,t){return"source(".concat(e,")-target(").concat(t,")")}}]),n}(e)};function aS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var sS=function(e){Ye()(n,e);var t=aS(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Fw],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=aS(r);function r(){var e;return B()(this,r),(e=n.apply(this,arguments)).dependenciesForRemoval=new Set,e.allDependenciesForRemoval=!1,e}return _()(r,[{key:"remove",value:function(e,n){this.dependenciesForRemoval=tC(e).toSet();var r=t.remove.call(this,e);return this.dependenciesForRemoval.clear(),r}},{key:"removeAll",value:function(e){this.allDependenciesForRemoval=!0;var n=t.removeAll.call(this,e);return this.allDependenciesForRemoval=!1,n}}]),r}(e)})));function lS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var uS=new Set,cS=function(e){Ye()(n,e);var t=lS(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([sS,eC],(function(e){e.prototype;return function(e){Ye()(n,e);var t=lS(n);function n(){var e;return B()(this,n),(e=t.apply(this,arguments)).dependenciesForRemoval=new Set,e.allDependenciesForRemoval=!1,e}return _()(n,[{key:"getIncomingDepsForEvent",value:function(e){return this.storage.findItem("toEvent",e)||uS}},{key:"getOutgoingDepsForEvent",value:function(e){return this.storage.findItem("fromEvent",e)||uS}},{key:"data",set:function(e){this.allDependenciesForRemoval=!0,gh()(Ze()(n.prototype),"data",e,this,!0),this.allDependenciesForRemoval=!1}},{key:"updateIndices",value:function(){this.storage.rebuildIndices()}},{key:"invalidateIndices",value:function(){this.storage.invalidateIndices()}},{key:"onCommitAsync",value:function(){this.updateIndices()}}],[{key:"defaultConfig",get:function(){return{modelClass:tS,storage:{extraKeys:[{property:"fromEvent",unique:!1},{property:"toEvent",unique:!1}]}}}}]),n}(e)})));function fS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var dS=Wk(cS.derive(ss)),hS=function(e){Ye()(n,e);var t=fS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:rS}}}]),n}(oS(dS.derive(ss)));function vS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}hS._$name="DependencyStore";var pS=function(e){return function(e){Ye()(o,e);var t,n,r,i=vS(o);function o(){return B()(this,o),i.apply(this,arguments)}return _()(o,[{key:"startConfigure",value:function(e){this.getConfig("project"),tt()(Ze()(o.prototype),"startConfigure",this).call(this,e),this._changesToClear=new Map}},{key:"doAutoLoad",value:(r=Pt()(At.a.mark((function e(){var t;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.project)){e.next=4;break}return e.next=4,t.commitAsync();case 4:return e.abrupt("return",tt()(Ze()(o.prototype),"doAutoLoad",this).call(this));case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadCrudManagerData",value:function(e){var t=this,n=t.project;t.suspendChangesTracking(),tt()(Ze()(o.prototype),"loadCrudManagerData",this).apply(this,arguments),null!=e&&e.project&&(t.applyingProjectResponse=!0,Object.assign(n,e.project),t.applyingProjectResponse=!1),t.resumeChangesTracking()}},{key:"sync",value:(n=Pt()(At.a.mark((function e(){var t,n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.project,this.suspendAutoSync(),!t){e.next=5;break}return e.next=5,t.commitAsync();case 5:return e.prev=5,e.next=8,tt()(Ze()(o.prototype),"sync",this).call(this);case 8:n=e.sent;case 9:return e.prev=9,this.resumeAutoSync(!1),e.finish(9);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this,[[5,,9,12]])}))),function(){return n.apply(this,arguments)})},{key:"applyResponse",value:(t=Pt()(At.a.mark((function e(t,n,r){var i,a,s,l;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((a=this).isDestroyed||null!==(i=a.project)&&void 0!==i&&i.isDestroyed)){e.next=3;break}return e.abrupt("return");case 3:return a.trigger("startApplyResponse"),a.clearCrudStoresChanges({clearRemovedCollection:!1}),e.next=7,tt()(Ze()(o.prototype),"applyResponse",this).call(this,t,n,r);case 7:if(a.clearCrudStoresChanges({removeAddedRecords:!1,clearAddedCollection:!1,clearModifiedCollection:!1,clearRemovedCollection:!0}),null!=n&&n.project&&(a.applyingProjectResponse=!0,Object.assign(a,n.project),a.applyingProjectResponse=!1),!a.project){e.next=18;break}return s=t.type,a.trackResponseType&&(s=n.type||s),l="propagating".concat(te.capitalize(s),"Changes"),a[l]=!0,e.next=16,a.project.commitAsync();case 16:a[l]=!1,this.commitRespondedChanges();case 18:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"commitRespondedChanges",value:function(){this._changesToClear.forEach((function(e,t){Object.entries(e).forEach((function(e){var n=N()(e,2),r=n[0],i=n[1],o=t.getFieldDefinition(r),a=t[r];(null!=o&&o.isEqual?o.isEqual(a,i):Qn.isEqual(a,i))&&delete t.meta.modified[r]}))})),this._changesToClear.clear()}},{key:"clearRecordChanges",value:function(e,t){tt()(Ze()(o.prototype),"clearRecordChanges",this).call(this,e,t),this.project&&this._changesToClear.set(e,t)}},{key:"clearCrudStoresChanges",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{removeAddedRecords:!0,clearAddedCollection:!0,clearModifiedCollection:!0,clearRemovedCollection:!0},n=t.removeAddedRecords,r=t.clearAddedCollection,i=t.clearModifiedCollection,o=t.clearRemovedCollection;this.forEachCrudStore((function(t){n&&t.remove(e.added,!0),i&&(t.modified.forEach((function(e){return e.clearChanges(!1)})),t.modified.clear()),r&&t.added.clear(),o&&t.removed.clear()}))}}],[{key:"defaultConfig",get:function(){return{project:null}}}]),o}((e||$e).mixin(Pk,jk,Hk))};function gS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var yS=function(e){Ye()(n,e);var t=gS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"isResourceTimeRange",get:function(){return!0}},{key:"resources",get:function(){return this.resource?[this.resource]:[]}}],[{key:"$name",get:function(){return"ResourceTimeRangeModel"}},{key:"fields",get:function(){return["resourceId","timeRangeColor"]}},{key:"relationConfig",get:function(){return[{relationName:"resource",fieldName:"resourceId",store:"resourceStore",collectionName:"timeRanges",nullFieldOnRemove:!0}]}}]),n}(KC);function mS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}yS._$name="ResourceTimeRangeModel";var bS=function(e){Ye()(n,e);var t=mS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"resourceStore",get:function(){return this._resourceStore},set:function(e){this._resourceStore=e,this.isConfiguring||this.initRelations(!0)}},{key:"getResourcesForEvent",value:function(e){return[e.resource]}}],[{key:"defaultConfig",get:function(){return{loadPriority:500,syncPriority:500,resourceStore:null,modelClass:yS,storeId:"resourceTimeRanges"}}}]),n}(ss);function kS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bS._$name="ResourceTimeRangeStore";var wS=function(e){return function(e){Ye()(n,e);var t=kS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"inlineData",get:function(){return te.safeJsonParse(tt()(Ze()(n.prototype),"json",this))},set:function(e){this.json=e}},{key:"construct",value:function(){tt()(Ze()(n.prototype),"construct",this).apply(this,arguments);var e=this;e.timeRangeStore||(e.timeRangeStore=new e.timeRangeStoreClass({modelClass:e.timeRangeModelClass,storeId:"timeRanges"})),e.resourceTimeRangeStore||(e.resourceTimeRangeStore=new e.resourceTimeRangeStoreClass({modelClass:e.resourceTimeRangeModelClass})),e.resourceTimeRangesData&&(e.resourceTimeRangeStore.data=e.resourceTimeRangesData),e.timeRangesData&&(e.timeRangeStore.data=e.timeRangesData)}},{key:"toJSON",value:function(){var e=this,t={eventsData:e.eventStore.toJSON(),resourcesData:e.resourceStore.toJSON(),dependenciesData:e.dependencyStore.toJSON()};return e.eventStore.usesSingleAssignment||(t.assignmentsData=e.assignmentStore.toJSON()),t}},{key:"json",get:function(){return tt()(Ze()(n.prototype),"json",this)}},{key:"changeJson",value:function(e){return"string"==typeof e&&(e=te.safeJsonParse(e)),e}},{key:"updateJson",value:function(e){e&&this.loadInlineData(e)}},{key:"afterChange",value:function(e,t){tt()(Ze()(n.prototype),"afterChange",this).apply(this,arguments),t.calendar&&this.trigger("calendarChange")}},{key:"doDestroy",value:function(){this.timeRangeStore.destroy(),this.resourceTimeRangeStore.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}}],[{key:"$name",get:function(){return"ProjectModelMixin"}},{key:"defaultConfig",get:function(){return{stm:{},eventModelClass:VR,dependencyModelClass:rS,timeRangeModelClass:KC,resourceTimeRangeModelClass:yS,resourceModelClass:mC,assignmentModelClass:qw,eventStoreClass:XR,dependencyStoreClass:hS,resourceStoreClass:DC,assignmentStoreClass:dC,timeRangeStoreClass:ts,resourceTimeRangeStoreClass:bS,eventStore:{},assignmentStore:{},dependencyStore:{},resourceStore:{},timeRangeStore:null,resourceTimeRangeStore:null}}},{key:"configurable",get:function(){return{json:null}}}]),n}(e||Lo)};function CS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var RS=function(e){Ye()(n,e);var t=CS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"eventStore",get:function(){return this._eventStore},set:function(e){var t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),t._eventStore=e,e&&e.autoCommit&&(t.eventStoreDetacher=e.on({beforecommit:t.onEventStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))}},{key:"resourceStore",get:function(){return this._resourceStore},set:function(e){var t=this;t.resourceStoreDetacher&&t.resourceStoreDetacher(),t._resourceStore=e,e&&e.autoCommit&&(t.resourceStoreDetacher=e.on({beforecommit:t.onResourceStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))}},{key:"assignmentStore",get:function(){return this._assignmentStore},set:function(e){var t=this;t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),t._assignmentStore=e,e&&e.autoSync&&(t.assignmentStoreDetacher=e.on({beforecommit:t.onAssignmentStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))}},{key:"dependencyStore",get:function(){return this._dependencyStore},set:function(e){var t=this;t.dependencyStoreDetacher&&t.dependencyStoreDetacher(),t._dependencyStore=e,e&&e.autoSync&&(t.dependencyStoreDetacher=e.on({beforecommit:t.onDependencyStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))}},{key:"onEventStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onResourceStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onAssignmentStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onDependencyStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"removeNonPersistableRecordsToCreate",value:function(e){var t,n,r=e.added||[];for(n=r.length-1;n>=0;--n)(t=r[n]).isPersistable||r.splice(r.indexOf(t),1);0===r.length&&(e.added.length=0)}},{key:"shallContinueSync",value:function(e){return Boolean(e.added&&e.added.length>0||e.modified&&e.modified.length>0||e.removed&&e.removed.length>0)}}]),n}($e);RS._$name="ModelPersistencyManager";n(453);var SS=function(){var e={version:"1.2.0"};return Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>1&&((r=Number(arguments[1]))!=r?r=0:0!=r&&r!=1/0&&r!=-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var i=r>=0?r:Math.max(n-Math.abs(r),0);i<n;i++)if(i in t&&t[i]===e)return i;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.array={},e.array.sort=function(e,t){e.sort((function(e,t){return+e-+t})),t&&0===e[0]&&e.push(e.shift())},e.array.next=function(e,t,n){for(var r,i=0!==n[0],o=0,a=t.length-1;a>-1;--a){if((r=t[a])===e)return r;if(!(r>e||0===r&&i&&n[1]>e))break;o=a}return t[o]},e.array.nextInvalid=function(e,t,n){for(var r=n[0],i=n[1],o=t.length,a=0===t[o-1]&&0!==r?i:0,s=e,l=t.indexOf(e),u=s;s===(t[l]||a);)if(++s>i&&(s=r),++l===o&&(l=0),s===u)return;return s},e.array.prev=function(e,t,n){for(var r,i=t.length,o=0!==n[0],a=i-1,s=0;s<i;s++){if((r=t[s])===e)return r;if(!(r<e||0===r&&o&&n[1]<e))break;a=s}return t[a]},e.array.prevInvalid=function(e,t,n){for(var r=n[0],i=n[1],o=t.length,a=0===t[o-1]&&0!==r?i:0,s=e,l=t.indexOf(e),u=s;s===(t[l]||a);)if(--s<r&&(s=i),-1===--l&&(l=o-1),s===u)return;return s},e.day=e.D={name:"day",range:86400,val:function(t){return t.D||(t.D=e.date.getDate.call(t))},isValid:function(t,n){return e.D.val(t)===(n||e.D.extent(t)[1])},extent:function(t){if(t.DExtent)return t.DExtent;var n=e.M.val(t),r=e.DAYS_IN_MONTH[n-1];return 2===n&&366===e.dy.extent(t)[1]&&(r+=1),t.DExtent=[1,r]},start:function(t){return t.DStart||(t.DStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)))},end:function(t){return t.DEnd||(t.DEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)))},next:function(t,n){n=n>e.D.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.D,e.M),i=e.D.extent(r)[1];return n=n>i?1:n||i,e.date.next(e.Y.val(r),e.M.val(r),n)},prev:function(t,n){var r=e.date.prevRollover(t,n,e.D,e.M),i=e.D.extent(r)[1];return e.date.prev(e.Y.val(r),e.M.val(r),n>i?i:n||i)}},e.dayOfWeekCount=e.dc={name:"day of week count",range:604800,val:function(t){return t.dc||(t.dc=Math.floor((e.D.val(t)-1)/7)+1)},isValid:function(t,n){return e.dc.val(t)===n||0===n&&e.D.val(t)>e.D.extent(t)[1]-7},extent:function(t){return t.dcExtent||(t.dcExtent=[1,Math.ceil(e.D.extent(t)[1]/7)])},start:function(t){return t.dcStart||(t.dcStart=e.date.next(e.Y.val(t),e.M.val(t),Math.max(1,7*(e.dc.val(t)-1)+1||1)))},end:function(t){return t.dcEnd||(t.dcEnd=e.date.prev(e.Y.val(t),e.M.val(t),Math.min(7*e.dc.val(t),e.D.extent(t)[1])))},next:function(t,n){n=n>e.dc.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.dc,e.M);n=n>e.dc.extent(r)[1]?1:n;var i=e.date.next(e.Y.val(r),e.M.val(r),0===n?e.D.extent(r)[1]-6:1+7*(n-1));return i.getTime()<=t.getTime()?(r=e.M.next(t,e.M.val(t)+1),e.date.next(e.Y.val(r),e.M.val(r),0===n?e.D.extent(r)[1]-6:1+7*(n-1))):i},prev:function(t,n){var r=e.date.prevRollover(t,n,e.dc,e.M),i=e.dc.extent(r)[1];return n=n>i?i:n||i,e.dc.end(e.date.prev(e.Y.val(r),e.M.val(r),1+7*(n-1)))}},e.dayOfWeek=e.dw=e.d={name:"day of week",range:86400,val:function(t){return t.dw||(t.dw=e.date.getDay.call(t)+1)},isValid:function(t,n){return e.dw.val(t)===(n||7)},extent:function(){return[1,7]},start:function(t){return e.D.start(t)},end:function(t){return e.D.end(t)},next:function(t,n){return n=n>7?1:n||7,e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n-e.dw.val(t))+(n<=e.dw.val(t)?7:0))},prev:function(t,n){return n=n>7?7:n||7,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(n-e.dw.val(t))+(n>=e.dw.val(t)?-7:0))}},e.dayOfYear=e.dy={name:"day of year",range:86400,val:function(t){return t.dy||(t.dy=Math.ceil(1+(e.D.start(t).getTime()-e.Y.start(t).getTime())/e.DAY))},isValid:function(t,n){return e.dy.val(t)===(n||e.dy.extent(t)[1])},extent:function(t){var n=e.Y.val(t);return t.dyExtent||(t.dyExtent=[1,n%4?365:366])},start:function(t){return e.D.start(t)},end:function(t){return e.D.end(t)},next:function(t,n){n=n>e.dy.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.dy,e.Y),i=e.dy.extent(r)[1];return n=n>i?1:n||i,e.date.next(e.Y.val(r),e.M.val(r),n)},prev:function(t,n){var r=e.date.prevRollover(t,n,e.dy,e.Y),i=e.dy.extent(r)[1];return n=n>i?i:n||i,e.date.prev(e.Y.val(r),e.M.val(r),n)}},e.hour=e.h={name:"hour",range:3600,val:function(t){return t.h||(t.h=e.date.getHour.call(t))},isValid:function(t,n){return e.h.val(t)===n},extent:function(){return[0,23]},start:function(t){return t.hStart||(t.hStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)))},end:function(t){return t.hEnd||(t.hEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)))},next:function(t,n){n=n>23?0:n;var r=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n<=e.h.val(t)?1:0),n);return!e.date.isUTC&&r.getTime()<=t.getTime()&&(r=e.date.next(e.Y.val(r),e.M.val(r),e.D.val(r),n+1)),r},prev:function(t,n){return n=n>23?23:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(n>=e.h.val(t)?-1:0),n)}},e.minute=e.m={name:"minute",range:60,val:function(t){return t.m||(t.m=e.date.getMin.call(t))},isValid:function(t,n){return e.m.val(t)===n},extent:function(e){return[0,59]},start:function(t){return t.mStart||(t.mStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)))},end:function(t){return t.mEnd||(t.mEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)))},next:function(t,n){var r=e.m.val(t),i=e.s.val(t),o=n>59?60-r:n<=r?60-r+n:n-r,a=new Date(t.getTime()+o*e.MIN-i*e.SEC);return!e.date.isUTC&&a.getTime()<=t.getTime()&&(a=new Date(t.getTime()+(o+120)*e.MIN-i*e.SEC)),a},prev:function(t,n){return n=n>59?59:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)+(n>=e.m.val(t)?-1:0),n)}},e.month=e.M={name:"month",range:2629740,val:function(t){return t.M||(t.M=e.date.getMonth.call(t)+1)},isValid:function(t,n){return e.M.val(t)===(n||12)},extent:function(){return[1,12]},start:function(t){return t.MStart||(t.MStart=e.date.next(e.Y.val(t),e.M.val(t)))},end:function(t){return t.MEnd||(t.MEnd=e.date.prev(e.Y.val(t),e.M.val(t)))},next:function(t,n){return n=n>12?1:n||12,e.date.next(e.Y.val(t)+(n>e.M.val(t)?0:1),n)},prev:function(t,n){return n=n>12?12:n||12,e.date.prev(e.Y.val(t)-(n>=e.M.val(t)?1:0),n)}},e.second=e.s={name:"second",range:1,val:function(t){return t.s||(t.s=e.date.getSec.call(t))},isValid:function(t,n){return e.s.val(t)===n},extent:function(){return[0,59]},start:function(e){return e},end:function(e){return e},next:function(t,n){var r=e.s.val(t),i=n>59?60-r:n<=r?60-r+n:n-r,o=new Date(t.getTime()+i*e.SEC);return!e.date.isUTC&&o.getTime()<=t.getTime()&&(o=new Date(t.getTime()+(i+7200)*e.SEC)),o},prev:function(t,n,r){return n=n>59?59:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)+(n>=e.s.val(t)?-1:0),n)}},e.time=e.t={name:"time",range:1,val:function(t){return t.t||(t.t=3600*e.h.val(t)+60*e.m.val(t)+e.s.val(t))},isValid:function(t,n){return e.t.val(t)===n},extent:function(){return[0,86399]},start:function(e){return e},end:function(e){return e},next:function(t,n){n=n>86399?0:n;var r=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n<=e.t.val(t)?1:0),0,0,n);return!e.date.isUTC&&r.getTime()<t.getTime()&&(r=e.date.next(e.Y.val(r),e.M.val(r),e.D.val(r),e.h.val(r),e.m.val(r),n+7200)),r},prev:function(t,n){return n=n>86399?86399:n,e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n>=e.t.val(t)?-1:0),0,0,n)}},e.weekOfMonth=e.wm={name:"week of month",range:604800,val:function(t){return t.wm||(t.wm=(e.D.val(t)+(e.dw.val(e.M.start(t))-1)+(7-e.dw.val(t)))/7)},isValid:function(t,n){return e.wm.val(t)===(n||e.wm.extent(t)[1])},extent:function(t){return t.wmExtent||(t.wmExtent=[1,(e.D.extent(t)[1]+(e.dw.val(e.M.start(t))-1)+(7-e.dw.val(e.M.end(t))))/7])},start:function(t){return t.wmStart||(t.wmStart=e.date.next(e.Y.val(t),e.M.val(t),Math.max(e.D.val(t)-e.dw.val(t)+1,1)))},end:function(t){return t.wmEnd||(t.wmEnd=e.date.prev(e.Y.val(t),e.M.val(t),Math.min(e.D.val(t)+(7-e.dw.val(t)),e.D.extent(t)[1])))},next:function(t,n){n=n>e.wm.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.wm,e.M),i=e.wm.extent(r)[1];return n=n>i?1:n||i,e.date.next(e.Y.val(r),e.M.val(r),Math.max(1,7*(n-1)-(e.dw.val(r)-2)))},prev:function(t,n){var r=e.date.prevRollover(t,n,e.wm,e.M),i=e.wm.extent(r)[1];return n=n>i?i:n||i,e.wm.end(e.date.next(e.Y.val(r),e.M.val(r),Math.max(1,7*(n-1)-(e.dw.val(r)-2))))}},e.weekOfYear=e.wy={name:"week of year (ISO)",range:604800,val:function(t){if(t.wy)return t.wy;var n=e.dw.next(e.wy.start(t),5),r=e.dw.next(e.Y.prev(n,e.Y.val(n)-1),5);return t.wy=1+Math.ceil((n.getTime()-r.getTime())/e.WEEK)},isValid:function(t,n){return e.wy.val(t)===(n||e.wy.extent(t)[1])},extent:function(t){if(t.wyExtent)return t.wyExtent;var n=e.dw.next(e.wy.start(t),5),r=e.dw.val(e.Y.start(n)),i=e.dw.val(e.Y.end(n));return t.wyExtent=[1,5===r||5===i?53:52]},start:function(t){return t.wyStart||(t.wyStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)-(e.dw.val(t)>1?e.dw.val(t)-2:6)))},end:function(t){return t.wyEnd||(t.wyEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(e.dw.val(t)>1?8-e.dw.val(t):0)))},next:function(t,n){n=n>e.wy.extent(t)[1]?1:n;var r=e.dw.next(e.wy.start(t),5),i=e.date.nextRollover(r,n,e.wy,e.Y);1!==e.wy.val(i)&&(i=e.dw.next(i,2));var o=e.wy.extent(i)[1],a=e.wy.start(i);return n=n>o?1:n||o,e.date.next(e.Y.val(a),e.M.val(a),e.D.val(a)+7*(n-1))},prev:function(t,n){var r=e.dw.next(e.wy.start(t),5),i=e.date.prevRollover(r,n,e.wy,e.Y);1!==e.wy.val(i)&&(i=e.dw.next(i,2));var o=e.wy.extent(i)[1],a=e.wy.end(i);return n=n>o?o:n||o,e.wy.end(e.date.next(e.Y.val(a),e.M.val(a),e.D.val(a)+7*(n-1)))}},e.year=e.Y={name:"year",range:31556900,val:function(t){return t.Y||(t.Y=e.date.getYear.call(t))},isValid:function(t,n){return e.Y.val(t)===n},extent:function(){return[1970,2099]},start:function(t){return t.YStart||(t.YStart=e.date.next(e.Y.val(t)))},end:function(t){return t.YEnd||(t.YEnd=e.date.prev(e.Y.val(t)))},next:function(t,n){return n>e.Y.val(t)&&n<=e.Y.extent()[1]?e.date.next(n):e.NEVER},prev:function(t,n){return n<e.Y.val(t)&&n>=e.Y.extent()[0]?e.date.prev(n):e.NEVER}},e.fullDate=e.fd={name:"full date",range:1,val:function(e){return e.fd||(e.fd=e.getTime())},isValid:function(t,n){return e.fd.val(t)===n},extent:function(){return[0,3250368e7]},start:function(e){return e},end:function(e){return e},next:function(t,n){return e.fd.val(t)<n?new Date(n):e.NEVER},prev:function(t,n){return e.fd.val(t)>n?new Date(n):e.NEVER}},e.modifier={},e.modifier.after=e.modifier.a=function(e,t){var n=t[0];return{name:"after "+e.name,range:(e.extent(new Date)[1]-n)*e.range,val:e.val,isValid:function(e,t){return this.val(e)>=n},extent:e.extent,start:e.start,end:e.end,next:function(t,r){return r!=n&&(r=e.extent(t)[0]),e.next(t,r)},prev:function(t,r){return r=r===n?e.extent(t)[1]:n-1,e.prev(t,r)}}},e.modifier.before=e.modifier.b=function(e,t){var n=t[t.length-1];return{name:"before "+e.name,range:e.range*(n-1),val:e.val,isValid:function(e,t){return this.val(e)<n},extent:e.extent,start:e.start,end:e.end,next:function(t,r){return r=r===n?e.extent(t)[0]:n,e.next(t,r)},prev:function(t,r){return r=r===n?n-1:e.extent(t)[1],e.prev(t,r)}}},e.compile=function(t){var n,r=[],i=0;for(var o in t){var a=o.split("_"),s=a[0],l=a[1],u=t[o],c=l?e.modifier[l](e[s],u):e[s];r.push({constraint:c,vals:u}),i++}return r.sort((function(e,t){var n=e.constraint.range,r=t.constraint.range;return r<n?-1:r>n?1:0})),n=r[i-1].constraint,{start:function(t,o){for(var a,s=o,l=e.array[t],u=1e3;u--&&!a&&s;){a=!0;for(var c=0;c<i;c++){var f=r[c].constraint,d=f.val(s),h=f.extent(s),v=l(d,r[c].vals,h);if(!f.isValid(s,v)){s=f[t](s,v),a=!1;break}}}return s!==e.NEVER&&(s="next"===t?n.start(s):n.end(s)),s},end:function(t,n){for(var o,a=e.array[t+"Invalid"],s=function(e){return"next"===e?function(e,t){return e.getTime()>t.getTime()}:function(e,t){return t.getTime()>e.getTime()}}(t),l=i-1;l>=0;l--){var u,c=r[l].constraint,f=c.val(n),d=c.extent(n),h=a(f,r[l].vals,d);void 0!==h&&(!(u=c[t](n,h))||o&&!s(o,u)||(o=u))}return o},tick:function(t,r){return new Date("next"===t?n.end(r).getTime()+e.SEC:n.start(r).getTime()-e.SEC)},tickStart:function(e){return n.start(e)}}},e.schedule=function(t){if(!t)throw new Error("Missing schedule definition.");if(!t.schedules)throw new Error("Definition must include at least one schedule.");for(var n=[],r=t.schedules.length,i=[],o=t.exceptions?t.exceptions.length:0,a=0;a<r;a++)n.push(e.compile(t.schedules[a]));for(var s=0;s<o;s++)i.push(e.compile(t.exceptions[s]));function l(t,r,a,s,l){var b,k,w,C=y(t),R=r,S=1e3,x=[],E=[],D=[],T="next"===t,O=T?0:1,M=T?1:0;if(!(a=a?new Date(a):new Date)||!a.getTime())throw new Error("Invalid start date.");for(!function(e,t,n,r){for(var i=0,o=t.length;i<o;i++)n[i]=t[i].start(e,r)}(t,n,x,a),function(t,n,r,i){y(t);for(var o=0,a=n.length;o<a;o++){var s=n[o].start(t,i);r[o]=s?[s,n[o].end(t,s)]:e.NEVER}}(t,i,E,a);S--&&R&&(b=m(x,C))&&(!s||!C(b,s));)if(o&&(f(t,i,E,b),k=v(t,E,b)))c(t,n,x,k);else{if(l){var A=p(E,C);k=g(t,n,x,b,A);var I=T?[new Date(Math.max(a,b)),k?new Date(s?Math.min(k,s):k):void 0]:[k?new Date(s?Math.max(s,k.getTime()+e.SEC):k.getTime()+e.SEC):void 0,new Date(Math.min(a,b.getTime()+e.SEC))];if(w&&I[O].getTime()===w[M].getTime()?(w[M]=I[M],R++):(w=I,D.push(w)),!k)break;c(t,n,x,k)}else D.push(T?new Date(Math.max(a,b)):h(n,x,b,s)),d(t,n,x,b);R--}for(var P=0,F=D.length;P<F;P++){var L=D[P];D[P]="[object Array]"===Object.prototype.toString.call(L)?[u(L[0]),u(L[1])]:u(L)}return 0===D.length?e.NEVER:1===r?D[0]:D}function u(e){if(e instanceof Date&&!isNaN(e.valueOf()))return new Date(e)}function c(e,t,n,r){for(var i=y(e),o=0,a=t.length;o<a;o++)n[o]&&!i(n[o],r)&&(n[o]=t[o].start(e,r))}function f(t,n,r,i){for(var o=y(t),a=0,s=n.length;a<s;a++)if(r[a]&&!o(r[a][0],i)){var l=n[a].start(t,i);r[a]=l?[l,n[a].end(t,l)]:e.NEVER}}function d(e,t,n,r){for(var i=0,o=t.length;i<o;i++)n[i]&&n[i].getTime()===r.getTime()&&(n[i]=t[i].start(e,t[i].tick(e,r)))}function h(e,t,n,r){for(var i,o=0,a=t.length;o<a;o++)if(t[o]&&t[o].getTime()===n.getTime()){var s=e[o].tickStart(n);if(r&&s<r)return r;(!i||s>i)&&(i=s)}return i}function v(e,t,n){for(var r,i=y(e),o=0,a=t.length;o<a;o++){var s=t[o];!s||i(s[0],n)||s[1]&&!i(s[1],n)||r&&!i(s[1],r)||(r=s[1])}return r}function p(e,t){for(var n,r=0,i=e.length;r<i;r++)!e[r]||n&&!t(n,e[r][0])||(n=e[r][0]);return n}function g(e,t,n,r,i){for(var o,a=y(e),s=0,l=t.length;s<l;s++){var u=n[s];if(u&&u.getTime()===r.getTime()){var c=t[s].end(e,u);if(i&&(!c||a(c,i)))return i;o&&!a(c,o)||(o=c)}}return o}function y(e){return"next"===e?function(e,t){return!t||e.getTime()>t.getTime()}:function(e,t){return!e||t.getTime()>e.getTime()}}function m(e,t){for(var n=e[0],r=1,i=e.length;r<i;r++)e[r]&&t(n,e[r])&&(n=e[r]);return n}return{isValid:function(t){return l("next",1,t,t)!==e.NEVER},next:function(e,t,n){return l("next",e||1,t,n)},prev:function(e,t,n){return l("prev",e||1,t,n)},nextRange:function(e,t,n){return l("next",e||1,t,n,!0)},prevRange:function(e,t,n){return l("prev",e||1,t,n,!0)}}},e.setTimeout=function(t,n){var r,i=e.schedule(n);return t&&function e(){var n=Date.now(),o=i.next(2,n);if(!o[0])return void(r=void 0);var a=o[0].getTime()-n;a<1e3&&(a=o[1]?o[1].getTime()-n:1e3);r=a<2147483647?setTimeout(t,a):setTimeout(e,2147483647)}(),{isDone:function(){return!r},clear:function(){clearTimeout(r)}}},e.setInterval=function(t,n){if(t){var r=e.setTimeout((function o(){i||(t(),r=e.setTimeout(o,n))}),n),i=r.isDone();return{isDone:function(){return r.isDone()},clear:function(){i=!0,r.clear()}}}},e.date={},e.date.timezone=function(t){e.date.build=t?function(e,t,n,r,i,o){return new Date(e,t,n,r,i,o)}:function(e,t,n,r,i,o){return new Date(Date.UTC(e,t,n,r,i,o))};var n=t?"get":"getUTC",r=Date.prototype;e.date.getYear=r[n+"FullYear"],e.date.getMonth=r[n+"Month"],e.date.getDate=r[n+"Date"],e.date.getDay=r[n+"Day"],e.date.getHour=r[n+"Hours"],e.date.getMin=r[n+"Minutes"],e.date.getSec=r[n+"Seconds"],e.date.isUTC=!t},e.date.UTC=function(){e.date.timezone(!1)},e.date.localTime=function(){e.date.timezone(!0)},e.date.UTC(),e.SEC=1e3,e.MIN=60*e.SEC,e.HOUR=60*e.MIN,e.DAY=24*e.HOUR,e.WEEK=7*e.DAY,e.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],e.NEVER=0,e.date.next=function(t,n,r,i,o,a){return e.date.build(t,void 0!==n?n-1:0,void 0!==r?r:1,i||0,o||0,a||0)},e.date.nextRollover=function(t,n,r,i){var o=r.val(t),a=r.extent(t)[1];return(n||a)<=o||n>a?new Date(i.end(t).getTime()+e.SEC):i.start(t)},e.date.prev=function(t,n,r,i,o,a){var s=arguments.length;return n=s<2?11:n-1,r=s<3?e.D.extent(e.date.next(t,n+1))[1]:r,i=s<4?23:i,o=s<5?59:o,a=s<6?59:a,e.date.build(t,n,r,i,o,a)},e.date.prevRollover=function(e,t,n,r){return t>=n.val(e)||!t?r.start(r.prev(e,r.val(e)-1)):r.start(e)},e.parse={},e.parse.cron=function(e,t){var n={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12,SUN:1,MON:2,TUE:3,WED:4,THU:5,FRI:6,SAT:7},r={"* * * * * *":"0/1 * * * * *","@YEARLY":"0 0 1 1 *","@ANNUALLY":"0 0 1 1 *","@MONTHLY":"0 0 1 * *","@WEEKLY":"0 0 * * 0","@DAILY":"0 0 * * *","@HOURLY":"0 * * * *"},i={s:[0,0,59],m:[1,0,59],h:[2,0,23],D:[3,1,31],M:[4,1,12],Y:[6,1970,2099],d:[5,1,7,1]};function o(e,t,r){return isNaN(e)?n[e]||null:Math.min(+e+(t||0),r||9999)}function a(e,t,n,r,i){var o=n;for(e[t]||(e[t]=[]);o<=r;)e[t].indexOf(o)<0&&e[t].push(o),o+=i||1;e[t].sort((function(e,t){return e-t}))}function s(e,t,n,r){(t.d&&!t.dc||t.dc&&t.dc.indexOf(r)<0)&&(e.push(function(e){var t,n={};for(t in e)"dc"!==t&&"d"!==t&&(n[t]=e[t].slice(0));return n}(t)),t=e[e.length-1]),a(t,"d",n,n),a(t,"dc",r,r)}function l(e,t,r,i,l,u){var c,f,d=t.schedules,h=d[d.length-1];"L"===e&&(e=i-1),null!==(c=o(e,u,l))?a(h,r,c,c):null!==(c=o(e.replace("W",""),u,l))?function(e,t,r){var i={},o={};1===r?(a(t,"D",1,3),a(t,"d",n.MON,n.FRI),a(i,"D",2,2),a(i,"d",n.TUE,n.FRI),a(o,"D",3,3),a(o,"d",n.TUE,n.FRI)):(a(t,"D",r-1,r+1),a(t,"d",n.MON,n.FRI),a(i,"D",r-1,r-1),a(i,"d",n.MON,n.THU),a(o,"D",r+1,r+1),a(o,"d",n.TUE,n.FRI)),e.exceptions.push(i),e.exceptions.push(o)}(t,h,c):null!==(c=o(e.replace("L",""),u,l))?s(d,h,c,i-1):2===(f=e.split("#")).length?s(d,h,c=o(f[0],u,l),o(f[1])):function(e,t,n,r,i,s){var l=e.split("/"),u=+l[1],c=l[0];if("*"!==c&&"0"!==c){var f=c.split("-");r=o(f[0],s,i),i=o(f[1],s,i)||i}a(t,n,r,i,u)}(e,h,r,i,l,u)}function u(e){return e.indexOf("#")>-1||e.indexOf("L")>0}function c(e,t){return u(e)&&!u(t)?1:e-t}var f=function(e){var t=e.toUpperCase();return r[t]||t}(e);return function(e){var t,n,r,o,a={schedules:[{}],exceptions:[]},s=e.replace(/(\s)+/g," ").split(" ");for(t in i)if((r=s[(n=i[t])[0]])&&"*"!==r&&"?"!==r){var u,f=(o=r.split(",").sort(c)).length;for(u=0;u<f;u++)l(o[u],a,t,n[1],n[2],n[3])}return a}(t?f:"0 "+f)},e.parse.recur=function(){var t,n,r,i,o,a,s,l,u,c=[],f=[],d=c;function h(e,c,f){if(e=o?e+"_"+o:e,t||(d.push({}),t=d[0]),t[e]||(t[e]=[]),n=t[e],i){for(r=[],l=c;l<=f;l+=i)r.push(l);u={n:e,x:i,c:n.length,m:f}}var h=(r=a?[c]:s?[f]:r).length;for(l=0;l<h;l+=1){var v=r[l];n.indexOf(v)<0&&n.push(v)}r=i=o=a=s=0}return{schedules:c,exceptions:f,on:function(){return r=arguments[0]instanceof Array?arguments[0]:arguments,this},every:function(e){return i=e||1,this},after:function(e){return o="a",r=[e],this},before:function(e){return o="b",r=[e],this},first:function(){return a=1,this},last:function(){return s=1,this},time:function(){for(var e=0,t=r.length;e<t;e++){var n=r[e].split(":");n.length<3&&n.push(0),r[e]=3600*+n[0]+60*+n[1]+ +n[2]}return h("t"),this},second:function(){return h("s",0,59),this},minute:function(){return h("m",0,59),this},hour:function(){return h("h",0,23),this},dayOfMonth:function(){return h("D",1,s?0:31),this},dayOfWeek:function(){return h("d",1,7),this},onWeekend:function(){return r=[1,7],this.dayOfWeek()},onWeekday:function(){return r=[2,3,4,5,6],this.dayOfWeek()},dayOfWeekCount:function(){return h("dc",1,s?0:5),this},dayOfYear:function(){return h("dy",1,s?0:366),this},weekOfMonth:function(){return h("wm",1,s?0:5),this},weekOfYear:function(){return h("wy",1,s?0:53),this},month:function(){return h("M",1,12),this},year:function(){return h("Y",1970,2450),this},fullDate:function(){for(var e=0,t=r.length;e<t;e++)r[e]=r[e].getTime();return h("fd"),this},customModifier:function(t,n){var i=e.modifier[t];if(!i)throw new Error("Custom modifier "+t+" not recognized!");return o=t,r=arguments[1]instanceof Array?arguments[1]:[arguments[1]],this},customPeriod:function(t){var n=e[t];if(!n)throw new Error("Custom time period "+t+" not recognized!");return h(t,n.extent(new Date)[0],n.extent(new Date)[1]),this},startingOn:function(e){return this.between(e,u.m)},between:function(e,n){return t[u.n]=t[u.n].splice(0,u.c),i=u.x,h(u.n,e,n),this},and:function(){return t=d[d.push({})-1],this},except:function(){return d=f,t=null,this}}},e.parse.text=function(t){var n,r=e.parse.recur,i=0,o="",a={eof:/^$/,rank:/^((\d\d\d\d)|([2-5]?1(st)?|[2-5]?2(nd)?|[2-5]?3(rd)?|(0|[1-5]?[4-9]|[1-5]0|1[1-3])(th)?))\b/,time:/^((([0]?[1-9]|1[0-2]):[0-5]\d(\s)?(am|pm))|(([0]?\d|1\d|2[0-3]):[0-5]\d))\b/,dayName:/^((sun|mon|tue(s)?|wed(nes)?|thu(r(s)?)?|fri|sat(ur)?)(day)?)\b/,monthName:/^(jan(uary)?|feb(ruary)?|ma((r(ch)?)?|y)|apr(il)?|ju(ly|ne)|aug(ust)?|oct(ober)?|(sept|nov|dec)(ember)?)\b/,yearIndex:/^(\d\d\d\d)\b/,every:/^every\b/,after:/^after\b/,before:/^before\b/,second:/^(s|sec(ond)?(s)?)\b/,minute:/^(m|min(ute)?(s)?)\b/,hour:/^(h|hour(s)?)\b/,day:/^(day(s)?( of the month)?)\b/,dayInstance:/^day instance\b/,dayOfWeek:/^day(s)? of the week\b/,dayOfYear:/^day(s)? of the year\b/,weekOfYear:/^week(s)?( of the year)?\b/,weekOfMonth:/^week(s)? of the month\b/,weekday:/^weekday\b/,weekend:/^weekend\b/,month:/^month(s)?\b/,year:/^year(s)?\b/,between:/^between (the)?\b/,start:/^(start(ing)? (at|on( the)?)?)\b/,at:/^(at|@)\b/,and:/^(,|and\b)/,except:/^(except\b)/,also:/(also)\b/,first:/^(first)\b/,last:/^last\b/,in:/^in\b/,of:/^of\b/,onthe:/^on the\b/,on:/^on\b/,through:/(-|^(to|through)\b)/},s={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7,"1st":1,fir:1,"2nd":2,sec:2,"3rd":3,thi:3,"4th":4,for:4};function l(e,t,n,r){return{startPos:e,endPos:t,text:n,type:r}}function u(e){var t,n,r,a,s,u,c=e instanceof Array?e:[e],f=/\s+/;for(c.push(f),s=i;!t||t.type===f;){u=-1,n=o.substring(s),t=l(s,s,o.split(f)[0]);var d,h=c.length;for(d=0;d<h;d++)(r=(a=c[d]).exec(n))&&0===r.index&&r[0].length>u&&(t=l(s,s+(u=r[0].length),n.substring(0,u),a));t.type===f&&(s=t.endPos)}return t}function c(e){var t=u(e);return i=t.endPos,t}function f(e){for(var t=+m(e),n=g(a.through)?+m(e):t,r=[],i=t;i<=n;i++)r.push(i);return r}function d(e){for(var t=f(e);g(a.and);)t=t.concat(f(e));return t}function h(e){var t,n,r,i;g(a.weekend)?e.on(s.sun,s.sat).dayOfWeek():g(a.weekday)?e.on(s.mon,s.tue,s.wed,s.thu,s.fri).dayOfWeek():(t=m(a.rank),e.every(t),n=p(e),g(a.start)?(t=m(a.rank),e.startingOn(t),y(n.type)):g(a.between)&&(r=m(a.rank),g(a.and)&&(i=m(a.rank),e.between(r,i))))}function v(e){g(a.first)?e.first():g(a.last)?e.last():e.on(d(a.rank)),p(e)}function p(e){var t=y([a.second,a.minute,a.hour,a.dayOfYear,a.dayOfWeek,a.dayInstance,a.day,a.month,a.year,a.weekOfMonth,a.weekOfYear]);switch(t.type){case a.second:e.second();break;case a.minute:e.minute();break;case a.hour:e.hour();break;case a.dayOfYear:e.dayOfYear();break;case a.dayOfWeek:e.dayOfWeek();break;case a.dayInstance:e.dayOfWeekCount();break;case a.day:e.dayOfMonth();break;case a.weekOfMonth:e.weekOfMonth();break;case a.weekOfYear:e.weekOfYear();break;case a.month:e.month();break;case a.year:e.year();break;default:n=i}return t}function g(e){var t=u(e).type===e;return t&&c(e),t}function y(e){var t=c(e);return t.type?t.text=function(e,t){var n=e;switch(t){case a.time:var r=e.split(/(:|am|pm)/),i="pm"===r[3]&&r[0]<12?parseInt(r[0],10)+12:r[0],o=r[2].trim();n=(1===i.length?"0":"")+i+":"+o;break;case a.rank:n=parseInt(/^\d+/.exec(e)[0],10);break;case a.monthName:case a.dayName:n=s[e.substring(0,3)]}return n}(t.text,e):n=i,t}function m(e){return y(e).text}return function(e){i=0,o=e,n=-1;for(var t=r();i<o.length&&n<0;){switch(y([a.every,a.after,a.before,a.onthe,a.on,a.of,a.in,a.at,a.and,a.except,a.also]).type){case a.every:h(t);break;case a.after:void 0!==u(a.time).type?(t.after(m(a.time)),t.time()):(t.after(m(a.rank)),p(t));break;case a.before:void 0!==u(a.time).type?(t.before(m(a.time)),t.time()):(t.before(m(a.rank)),p(t));break;case a.onthe:v(t);break;case a.on:t.on(d(a.dayName)).dayOfWeek();break;case a.of:t.on(d(a.monthName)).month();break;case a.in:t.on(d(a.yearIndex)).year();break;case a.at:for(t.on(m(a.time)).time();g(a.and);)t.on(m(a.time)).time();break;case a.and:break;case a.also:t.and();break;case a.except:t.except();break;default:n=i}}return{schedules:t.schedules,exceptions:t.exceptions,error:n}}(t.toLowerCase())},e}();SS.date.localTime();var xS=SS;function ES(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var DS=function(e){Ye()(n,e);var t=ES(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Bw],(function(e){e.prototype;return function(e){Ye()(n,e);var t=ES(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getCalendar",value:function(){return this.stores[0].calendar}},{key:"resetPriority",value:function(){this.priorityField=null,this.getCalendar().getDepth()}},{key:"getPriorityField",value:function(){if(null!=this.priorityField)return this.priorityField;var e=1e4+100*this.getCalendar().getDepth(),t=this.priority;return null==t&&(t=this.isRecurrent()?20:30),this.priorityField=e+t}},{key:"isRecurrent",value:function(){return Boolean(this.recurrentStartDate&&this.recurrentEndDate&&this.getStartDateSchedule()&&this.getEndDateSchedule())}},{key:"isStatic",value:function(){return Boolean(this.startDate&&this.endDate)}},{key:"parseDateSchedule",value:function(e){if(e&&e!==Object(e)&&((e=xS.parse.text(e))!==Object(e)||e.error>0))try{e=JSON.parse(e)}catch(e){return null}return e}},{key:"getStartDateSchedule",value:function(){if(this.startDateSchedule)return this.startDateSchedule;var e=this.parseDateSchedule(this.recurrentStartDate);return this.startDateSchedule=xS.schedule(e)}},{key:"getEndDateSchedule",value:function(){if(this.endDateSchedule)return this.endDateSchedule;var e=this.parseDateSchedule(this.recurrentEndDate);return this.endDateSchedule=xS.schedule(e)}}],[{key:"fields",get:function(){return["name",{name:"startDate",type:"date",format:"YYYY-MM-DDTHH:mm:ssZ"},{name:"endDate",type:"date",format:"YYYY-MM-DDTHH:mm:ssZ"},"recurrentStartDate","recurrentEndDate",{name:"isWorking",type:"boolean",defaultValue:!1},{name:"priority",type:"number"}]}}]),n}(e)})));function TS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var OS,MS,AS,IS,PS,FS,LS,BS,jS=function(e){Ye()(n,e);var t=TS(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Fw],(function(e){e.prototype;return function(e){Ye()(n,e);var t=TS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:DS}}}]),n}(e)})));!function(e){e.Millisecond="millisecond",e.Second="second",e.Minute="minute",e.Hour="hour",e.Day="day",e.Week="week",e.Month="month",e.Quarter="quarter",e.Year="year"}(OS||(OS={})),function(e){e.MustStartOn="muststarton",e.MustFinishOn="mustfinishon",e.StartNoEarlierThan="startnoearlierthan",e.StartNoLaterThan="startnolaterthan",e.FinishNoEarlierThan="finishnoearlierthan",e.FinishNoLaterThan="finishnolaterthan"}(MS||(MS={})),function(e){e.Normal="Normal",e.FixedDuration="FixedDuration",e.FixedEffort="FixedEffort",e.FixedUnits="FixedUnits"}(AS||(AS={})),function(e){e[e.NoError=0]="NoError",e[e.CyclicDependency=1]="CyclicDependency",e[e.DuplicatingDependency=2]="DuplicatingDependency"}(IS||(IS={})),function(e){e[e.StartToStart=0]="StartToStart",e[e.StartToEnd=1]="StartToEnd",e[e.EndToStart=2]="EndToStart",e[e.EndToEnd=3]="EndToEnd"}(PS||(PS={})),function(e){e.Project="Project",e.FromEvent="FromEvent",e.ToEvent="ToEvent"}(FS||(FS={})),function(e){e[e.SchedulerBasic=1]="SchedulerBasic",e[e.SchedulerPro=2]="SchedulerPro",e[e.Gantt=3]="Gantt"}(LS||(LS={})),function(e){e.Forward="Forward",e.Backward="Backward",e.None="None"}(BS||(BS={}));var _S,HS=new Date(-864e13),NS=new Date(864e13);!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(_S||(_S={}));var zS;!function(e){e[e.FullRangeIterated=0]="FullRangeIterated",e[e.StoppedByIterator=1]="StoppedByIterator",e[e.MaxCacheExtendCyclesReached=2]="MaxCacheExtendCyclesReached",e[e.MaxRangeReached=3]="MaxRangeReached"}(zS||(zS={}));var VS,WS=function(){function e(t){B()(this,e),this.cacheFilledStartDate=NS,this.cacheFilledEndDate=HS,this.intervalsCachingChunkDuration=30,this.intervalsCachingChunkUnit=OS.Day,this.maxCacheExtendCycles=100,this.maxRange=15552e7,t&&Object.assign(this,t)}return _()(e,[{key:"includeWrappingRangeFrom",value:function(e,t,n){e.ensureCacheFilledForInterval(t,n),this.intervalCache.includeWrappingRange(e.intervalCache,t,n)}},{key:"ensureCacheFilledForInterval",value:function(e,t){var n=this.cacheFilledStartDate.getTime(),r=this.cacheFilledEndDate.getTime();if(n!==NS.getTime()){var i=e.getTime(),o=t.getTime();if(n<=i&&o<=r)return;if(o<=n)t=new Date(n-1);else if(i>=r)e=new Date(r+1);else if(n<=i&&i<=r)e=new Date(r+1);else{if(!(n<=o&&o<=r))return this.ensureCacheFilledForInterval(e,new Date(n-1)),void this.ensureCacheFilledForInterval(new Date(r+1),t);t=new Date(n-1)}}(n===NS.getTime()||e.getTime()<r)&&(this.cacheFilledStartDate=e),(r===HS.getTime()||r<t.getTime())&&(this.cacheFilledEndDate=t),this.fillCache(e,t)}},{key:"fillCache",value:function(e,t){throw new Error("Abstract method")}},{key:"clear",value:function(){this.cacheFilledStartDate=NS,this.cacheFilledEndDate=HS,this.intervalCache.clear()}},{key:"forEachAvailabilityInterval",value:function(e,t,n){var r;n=n||this;var i=e.startDate,o=e.endDate,a=i&&i.getTime(),s=o&&o.getTime(),l=null!==(r=e.maxRange)&&void 0!==r?r:this.maxRange,u=!1!==e.isForward;if(u?!i:!o)throw new Error("At least `startDate` or `endDate` is required, depending from the `isForward` option");for(var c=this.intervalCache,f=u?i:o,d=u?i:o,h=d.getTime(),v=1;v<this.maxCacheExtendCycles;v++){u?this.ensureCacheFilledForInterval(f,o||Un.add(f,this.intervalsCachingChunkDuration,this.intervalsCachingChunkUnit)):this.ensureCacheFilledForInterval(i||Un.add(f,-this.intervalsCachingChunkDuration,this.intervalsCachingChunkUnit),f);for(var p=c.getIntervalOf(d,u?_S.Left:_S.Right);p;){var g=p.startDate,y=p.endDate;if(u&&s&&g.getTime()>=s||!u&&a&&y.getTime()<=a)return zS.FullRangeIterated;if(u&&g.getTime()-h>=l||!u&&h-y.getTime()>=l)return zS.MaxRangeReached;if(u&&g.getTime()>this.cacheFilledEndDate.getTime()||!u&&y.getTime()<this.cacheFilledStartDate.getTime())break;d=u?y:g;var m=a&&g.getTime()<a?i:g,b=s&&y.getTime()>s?o:y;if(!1===t.call(n,m,b,p.cacheInterval))return zS.StoppedByIterator;p=u?c.getNextInterval(p):c.getPrevInterval(p)}if(u&&d.getTime()===NS.getTime()||!u&&d.getTime()===HS.getTime())return zS.FullRangeIterated;f=u?this.cacheFilledEndDate:this.cacheFilledStartDate}return zS.MaxCacheExtendCyclesReached}}]),e}(),$S=function(){function e(t){if(B()(this,e),this.intervals=[],t&&Object.assign(this,t),!this.calendar)throw new Error("Required attribute `calendar` is missing")}return _()(e,[{key:"includeInterval",value:function(t){if(-1==this.intervals.indexOf(t)){var n=this.intervals.slice();return n.push(t),new e({intervals:n,calendar:this.calendar})}return this}},{key:"combineWith",value:function(t){return new e({intervals:this.intervals.concat(t.intervals),calendar:this.calendar})}},{key:"getIsWorking",value:function(){if(null!=this.isWorking)return this.isWorking;var e=this.intervals=this.normalizeIntervals(this.intervals);return this.isWorking=e[0].isWorking}},{key:"normalizeIntervals",value:function(e){var t,n=(t=e,Array.from(new Set(t)));return n.sort((function(e,t){return t.getPriorityField()-e.getPriorityField()})),n}}]),e}(),US=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return e-t},r=0,i=t.length;r<i;){var o=(r+i)/2|0,a=n(e,t[o]);if(0===a)return{found:!0,index:o};a<0?i=o:r=o+1}return{found:!1,index:i}};!function(e){e[e.Exact=0]="Exact",e[e.Next=1]="Next"}(VS||(VS={}));var GS=function(){function e(t){B()(this,e),this.keys=[],this.values=[],this.comparator=t||function(e,t){return e-t}}return _()(e,[{key:"set",value:function(e,t){var n=US(e,this.keys,this.comparator);return n.found?this.values[n.index]=t:(this.keys.splice(n.index,0,e),this.values.splice(n.index,0,t)),n.index}},{key:"insertAt",value:function(e,t,n){this.keys.splice(e,0,t),this.values.splice(e,0,n)}},{key:"setValueAt",value:function(e,t){this.values[e]=t}},{key:"get",value:function(e){var t=US(e,this.keys,this.comparator);return t.found?this.values[t.index]:void 0}},{key:"getEntryAt",value:function(e){return e<this.keys.length?{key:this.keys[e],value:this.values[e]}:void 0}},{key:"getKeyAt",value:function(e){return this.keys[e]}},{key:"getValueAt",value:function(e){return this.values[e]}},{key:"delete",value:function(e){var t=US(e,this.keys,this.comparator);t.found&&this.deleteAt(t.index)}},{key:"size",value:function(){return this.keys.length}},{key:"deleteAt",value:function(e){this.keys.splice(e,1),this.values.splice(e,1)}},{key:"indexOfKey",value:function(e){var t=US(e,this.keys,this.comparator);return{found:t.found?VS.Exact:VS.Next,index:t.index}}},{key:"map",value:function(e){for(var t=this.keys,n=this.values,r=[],i=0;i<t.length;i++)r.push(e(n[i],t[i],i));return r}},{key:"getAllEntries",value:function(){return this.map((function(e,t){return{value:e,key:t}}))}},{key:"clear",value:function(){this.keys.length=0,this.values.length=0}}]),e}(),YS=function(){function e(t){if(B()(this,e),this.points=new GS((function(e,t){return e.getTime()-t.getTime()})),this.leftInfinityKey=HS,this.rightInfinityKey=NS,Object.assign(this,t),void 0===this.emptyInterval||!this.combineIntervalsFn)throw new Error("All of `emptyPoint`, `combineIntervalsFn` are required");this.points.set(this.leftInfinityKey,this.emptyInterval)}return _()(e,[{key:"size",value:function(){return this.points.size()}},{key:"indexOf",value:function(e){return this.points.indexOfKey(e)}},{key:"getDateAt",value:function(e){return this.points.getKeyAt(e)}},{key:"getPointAt",value:function(e){return this.points.getValueAt(e)}},{key:"getIntervalOf",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_S.Left,r=this.indexOf(e),i=r.found,o=r.index;return t=n===_S.Left&&i===VS.Exact?o:o-1,this.getIntervalWithStartDateIndex(t)}},{key:"getPrevInterval",value:function(e){return 0===e.startDateIndex?null:this.getIntervalWithStartDateIndex(e.startDateIndex-1)}},{key:"getNextInterval",value:function(e){return e.startDateIndex>=this.size()-1?null:this.getIntervalWithStartDateIndex(e.startDateIndex+1)}},{key:"getIntervalWithStartDateIndex",value:function(e){return{startDateIndex:e,startDate:this.getDateAt(e),endDate:e+1<this.size()?this.getDateAt(e+1):this.rightInfinityKey,cacheInterval:this.getPointAt(e)}}},{key:"addInterval",value:function(e,t,n){var r,i,o=this.points,a=o.indexOfKey(e),s=a.found,l=a.index;if(s==VS.Exact){var u=n(i=o.getValueAt(l));o.setValueAt(l,u),r=l+1}else{var c=n(i=o.getValueAt(l-1));o.insertAt(l,e,c),r=l+1}for(;r<o.size();){if(o.getKeyAt(r).getTime()>=t.getTime())break;var f=n(i=o.getValueAt(r));o.setValueAt(r,f),r++}r===o.size()?o.insertAt(o.size(),t,this.emptyInterval):o.getKeyAt(r).getTime()===t.getTime()||o.insertAt(r,t,i)}},{key:"includeWrappingRange",value:function(e,t,n){for(var r=this,i=e.getIntervalOf(t);i&&(this.addInterval(i.startDate,i.endDate,(function(e){return r.combineIntervalsFn(e,i.cacheInterval)})),!(i.endDate.getTime()>n.getTime()));)i=e.getNextInterval(i)}},{key:"getSummary",value:function(){return this.points.map((function(e,t){return{label:e,date:t}}))}},{key:"clear",value:function(){this.points.clear(),this.points.set(this.leftInfinityKey,this.emptyInterval)}}]),e}();function qS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var KS=function(e){Ye()(n,e);var t=qS(n);function n(e){var r;if(B()(this,n),(r=t.call(this,e)).staticIntervalsCached=!1,!r.unspecifiedTimeInterval)throw new Error("Required attribute `unspecifiedTimeInterval` is missing");return r.intervalCache=new YS({emptyInterval:new $S({intervals:[r.unspecifiedTimeInterval],calendar:r.calendar}),combineIntervalsFn:function(e,t){return e.combineWith(t)}}),r}return _()(n,[{key:"fillCache",value:function(e,t){var n=this;this.staticIntervalsCached||(this.cacheStaticIntervals(),this.staticIntervalsCached=!0),this.parentCache&&this.includeWrappingRangeFrom(this.parentCache,e,t);var r=e.getTime(),i=t.getTime();if(r>i)throw new Error("Invalid cache fill interval");this.forEachRecurrentInterval((function(o){var a=o.getStartDateSchedule(),s=o.getEndDateSchedule(),l=a.prev(1,e),u=s.next(1,t);if(l!==xS.NEVER&&l.getTime()===r){var c=a.prev(2,e);c!==xS.NEVER&&2===c.length&&(l=c[1])}if(u!==xS.NEVER&&u.getTime()===i){var f=s.next(2,t);f!==xS.NEVER&&2===f.length&&(u=f[1])}var d=a.next(1/0,l!==xS.NEVER?l:e,u!==xS.NEVER?new Date(u.getTime()-1):t);if(d!==xS.NEVER){var h=s.next(1/0,new Date(d[0].getTime()+1),u!==xS.NEVER?u:t);h.length>d.length?h.length=d.length:h.length<d.length&&(d.length=h.length),d.forEach((function(e,t){var r=e,i=h[t];n.intervalCache.addInterval(r,i,(function(e){return e.includeInterval(o)}))}))}}))}},{key:"clear",value:function(){this.staticIntervalsCached=!1,tt()(Ze()(n.prototype),"clear",this).call(this)}},{key:"cacheStaticIntervals",value:function(){var e=this;this.forEachStaticInterval((function(t){e.intervalCache.addInterval(t.startDate,t.endDate,(function(e){return e.includeInterval(t)}))}))}},{key:"forEachStaticInterval",value:function(e){this.intervalStore.forEach((function(t){t.isStatic()&&e(t)}))}},{key:"forEachRecurrentInterval",value:function(e){this.intervalStore.forEach((function(t){t.isRecurrent()&&e(t)}))}}]),n}(WS);function XS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var ZS=function(e){Ye()(n,e);var t=XS(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([DS],(function(e){e.prototype;return function(e){Ye()(n,e);var t=XS(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getCalendar",value:function(){return this.calendar}},{key:"getPriorityField",value:function(){return null!=this.priorityField?this.priorityField:this.priorityField=this.getCalendar().getDepth()}}]),n}(e)})));function JS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var QS=function(e){Ye()(n,e);var t=JS(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Bw],(function(e){var t=e.prototype;return function(e){Ye()(r,e);var n=JS(r);function r(){var e;return B()(this,r),(e=n.apply(this,arguments)).version=1,e}return _()(r,[{key:"intervalStoreClass",get:function(){return jS}},{key:"afterConstruct",value:function(){t.afterConstruct.call(this);var e=this.getDefaultConfiguration().calendarIntervalModelClass||this.intervalStoreClass.defaultConfig.modelClass;this.intervalStore=new this.intervalStoreClass({calendar:this,modelClass:e}),this.intervals&&this.intervals.length&&this.addIntervals(this.intervals)}},{key:"isDefault",value:function(){var e=this.getProject();return!!e&&this===e.defaultCalendar}},{key:"getDepth",value:function(){return this.childLevel+1}},{key:"forEachAvailabilityInterval",value:function(e,t,n){return this.calendarCache.forEachAvailabilityInterval(e,t,n)}},{key:"accumulateWorkingTime",value:function(e,t,n){if(0===t)return{finalDate:new Date(e),remainingDurationInMs:0};if(isNaN(t))throw new Error("Invalid duration");var r=e;return this.forEachAvailabilityInterval(n?{startDate:e,isForward:!0}:{endDate:e,isForward:!1},(function(e,i,o){var a=!0;if(o.getIsWorking()){var s=e.getTimezoneOffset()-i.getTimezoneOffset(),l=i.getTime()-e.getTime()+60*s*1e3;t<=l?(r=n?new Date(e.getTime()+t):new Date(i.getTime()-t),t=0,a=!1):(r=n?i:e,t-=l)}return a})),{finalDate:new Date(r),remainingDurationInMs:t}}},{key:"calculateDurationMs",value:function(e,t){var n=0;return this.forEachAvailabilityInterval({startDate:e,endDate:t},(function(e,t,r){if(r.getIsWorking()){var i=e.getTimezoneOffset()-t.getTimezoneOffset();n+=t.getTime()-e.getTime()+60*i*1e3}})),n}},{key:"calculateEndDate",value:function(e,t){var n=t>=0,r=this.accumulateWorkingTime(e,Math.abs(t),n);return 0===r.remainingDurationInMs?r.finalDate:null}},{key:"calculateStartDate",value:function(e,t){var n=t<=0,r=this.accumulateWorkingTime(e,Math.abs(t),n);return 0===r.remainingDurationInMs?r.finalDate:null}},{key:"skipNonWorkingTime",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.forEachAvailabilityInterval(n?{startDate:e,isForward:!0}:{endDate:e,isForward:!1},(function(e,r,i){if(i.getIsWorking())return t=n?e:r,!1}));return r===zS.MaxRangeReached||r===zS.FullRangeIterated?"empty_calendar":t?new Date(t):new Date(e)}},{key:"addInterval",value:function(e){return this.addIntervals([e])}},{key:"addIntervals",value:function(e){return this.bumpVersion(),this.intervalStore.add(e)}},{key:"clearIntervals",value:function(e){return e||this.bumpVersion(),this.intervalStore.removeAll(e)}},{key:"bumpVersion",value:function(){this.clearCache(),this.version++}},{key:"calendarCache",get:function(){if(void 0!==this.$calendarCache)return this.$calendarCache;var e=new ZS({isWorking:this.unspecifiedTimeIsWorking});return e.calendar=this,this.$calendarCache=new KS({calendar:this,unspecifiedTimeInterval:e,intervalStore:this.intervalStore,parentCache:this.parent&&!this.parent.isRoot?this.parent.calendarCache:null})}},{key:"clearCache",value:function(){this.$calendarCache&&this.$calendarCache.clear(),this.$calendarCache=void 0}},{key:"resetPriorityOfAllIntervals",value:function(){this.traverse((function(e){e.intervalStore.forEach((function(e){return e.resetPriority()}))}))}},{key:"insertChild",value:function(e,n,r){var i,o=(i=t.insertChild).call.apply(i,[this].concat(Array.prototype.slice.call(arguments)));return Array.isArray(o)||(o=[o]),o.forEach((function(e){e.bumpVersion(),e.resetPriorityOfAllIntervals()})),o}},{key:"joinProject",value:function(){t.joinProject.call(this),this.intervalStore.setProject(this.getProject())}},{key:"leaveProject",value:function(){t.leaveProject.call(this),this.intervalStore.setProject(null),this.intervalStore.destroy(),this.clearCache()}},{key:"doDestroy",value:function(){this.leaveProject(),tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"isDayHoliday",value:function(e){var t=Un.clearTime(e),n=Un.getNext(e,OS.Day),r=!1;return this.forEachAvailabilityInterval({startDate:t,endDate:n,isForward:!0},(function(e,t,n){return!(r=n.getIsWorking())})),!r}},{key:"getDailyHolidaysRanges",value:function(e,t){var n=[];for(e=Un.clearTime(e);e<t;)this.isDayHoliday(e)&&n.push({startDate:e,endDate:Un.getStartOfNextDay(e,!0,!0)}),e=Un.getNext(e,OS.Day);return n}},{key:"getNonWorkingTimeRanges",value:function(e,t){var n=[];return this.forEachAvailabilityInterval({startDate:e,endDate:t,isForward:!0},(function(e,t,r){if(!r.getIsWorking()){var i=r.intervals[0];n.push({name:i.name,startDate:e,endDate:t})}})),n}},{key:"isWorkingTime",value:function(e,t){var n=this.skipNonWorkingTime(e);return!(!n||"empty_calendar"===n)&&n<t}}],[{key:"fields",get:function(){return[{name:"version",type:"number"},"name",{name:"unspecifiedTimeIsWorking",type:"boolean",defaultValue:!0},"intervals"]}}]),r}(e)})));function ex(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var tx=function(e){Ye()(n,e);var t=ex(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([QS,_w],(function(e){e.prototype;return function(e){Ye()(n,e);var t=ex(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(e)})));function nx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var rx=function(e){Ye()(n,e);var t=nx(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([Fw],(function(e){e.prototype;return function(e){Ye()(n,e);var t=nx(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"doDestroy",value:function(){var e=[];this.traverse((function(t){return e.push(t)})),tt()(Ze()(n.prototype),"doDestroy",this).call(this),e.forEach((function(e){return e.destroy()}))}}]),n}(e)})));function ix(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var ox=function(e){Ye()(n,e);var t=ix(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([rx,eC],(function(e){e.prototype;return function(e){Ye()(n,e);var t=ix(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"defaultConfig",get:function(){return{tree:!0,modelClass:tx}}}]),n}(e)})));function ax(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var sx=function(e){Ye()(n,e);var t=ax(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([],Ot)),lx=function(e){Ye()(n,e);var t=ax(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([],el)),ux=function(e){Ye()(n,e);var t=ax(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([sx,lx,Lo],(function(e){var t=e.prototype;return function(e){Ye()(i,e);var n,r=ax(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"isRepopulatingStores",get:function(){return!1}},{key:"isInitialCommit",get:function(){return!this.isInitialCommitPerformed||this.hasLoadedDataToCommit}},{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isInitialCommitPerformed=!1,this.isLoadingInlineData=!1,this.isWritingData=!1,this.hasLoadedDataToCommit=!1,t.construct.call(this,e),this.silenceInitialCommit=!("silenceInitialCommit"in e)||e.silenceInitialCommit}},{key:"repopulateStore",value:function(e){}},{key:"repopulateReplica",value:function(){}},{key:"commitAsync",value:(n=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Abstract method called");case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"isEngineReady",value:function(){throw new Error("Abstract method called")}}]),i}(e)})));function cx(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fx(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function fx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var hx=function(e){Ye()(n,e);var t=dx(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([],Ot)),vx=function(e){Ye()(n,e);var t=dx(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([],el)),px=function(e){Ye()(n,e);var t=dx(n);function n(){return B()(this,n),t.apply(this,arguments)}return n}(Tw([ux,Iw,hx,vx,Lo],(function(e){var t=e.prototype,n=function(e){Ye()(h,e);var n,r,i,o,a,s,l,u,c,f,d=dx(h);function h(){return B()(this,h),d.apply(this,arguments)}return _()(h,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$invalidated=new Set,this.isPerformingCommit=!1,this.silenceInitialCommit=!0,this.ongoing=Promise.resolve(),t.construct.call(this,e),this.defaultCalendar=new this.calendarManagerStore.modelClass({unspecifiedTimeIsWorking:this.unspecifiedTimeIsWorking}),this.defaultCalendar.project=this;var n=this.calendarsData,r=this.eventsData,i=this.dependenciesData,o=this.resourcesData,a=this.assignmentsData,s=Boolean(n||r||i||o||a);s?(this.loadInlineData({calendarsData:n,eventsData:r,dependenciesData:i,resourcesData:o,assignmentsData:a}),delete this.calendarsData,delete this.eventsData,delete this.dependenciesData,delete this.resourcesData,delete this.assignmentsData):this.bufferedCommitAsync()}},{key:"doDestroy",value:function(){var e,n,r,i,o,a,s=this;null===(e=s.eventStore)||void 0===e||e.destroy(),null===(n=s.dependencyStore)||void 0===n||n.destroy(),null===(r=s.assignmentStore)||void 0===r||r.destroy(),null===(i=s.resourceStore)||void 0===i||i.destroy(),null===(o=s.calendarManagerStore)||void 0===o||o.destroy(),s.defaultCalendar.destroy(),null===(a=s.stm)||void 0===a||a.destroy(),t.doDestroy.call(this)}},{key:"loadInlineData",value:(f=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoadingInlineData=!0,t.calendarsData&&(this.calendarManagerStore.data=t.calendarsData),t.resourcesData&&(this.resourceStore.data=t.resourcesData),t.assignmentsData&&(this.assignmentStore.data=t.assignmentsData),t.eventsData&&(this.eventStore.data=t.eventsData),t.tasksData&&(this.eventStore.data=t.tasksData),t.dependenciesData&&(this.dependencyStore.data=t.dependenciesData),e.next=9,this.commitLoad();case 9:return this.isLoadingInlineData=!1,e.abrupt("return");case 11:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"commitLoad",value:(c=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.commitAsync();case 2:this.isDestroyed||this.trigger("load");case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"joinStoreRecords",value:function(e){var t=this,n=function(e){e.setProject(t),e.joinProject()};e.rootNode?e.rootNode.traverse(n):e.forEach(n)}},{key:"unJoinStoreRecords",value:function(e){var t=this,n=function(e){e.leaveProject(),e.setProject(t)};e.rootNode?e.rootNode.traverse((function(t){t!==e.rootNode&&n(t)})):e.forEach(n)}},{key:"resolveStoreAndModelClass",value:function(e,t){var n=(null==t?void 0:t.storeClass)||this["".concat(e,"StoreClass")],r=null==t?void 0:t.modelClass;return r||(r=this.getDefaultConfiguration()["".concat(e,"ModelClass")]!==n.getDefaultConfiguration().modelClass?n.getDefaultConfiguration().modelClass:this["".concat(e,"ModelClass")]),{storeClass:n,modelClass:r}}},{key:"eventStore",get:function(){return this.$eventStore},set:function(e){var t=this,n=t.stm,r=t.$eventStore;if(e instanceof ts)e.project=t,n.addStore(e),t.joinStoreRecords(e);else{var i=t.resolveStoreAndModelClass("event",e),o=i.storeClass,a=i.modelClass;e=new o(Qn.assign({modelClass:a,project:t,stm:n},e))}if(r&&n.hasStore(r)){n.removeStore(r),t.unJoinStoreRecords(r);var s=r.assignmentsForRemoval;s.forEach((function(t){var n=t.event;if(n){var r=e.getById(n.id);r&&(t.event=r,s.delete(t))}})),r.afterEventRemoval()}e.setProject(t),t.$eventStore=e,t.trigger("eventStoreChange",{store:e})}},{key:"setEventStore",value:function(e){this.eventStore=e}},{key:"assignmentStore",get:function(){return this.$assignmentStore},set:function(e){var t=this,n=t.stm,r=t.$assignmentStore;if(r&&n.hasStore(r)&&(n.removeStore(r),t.unJoinStoreRecords(r)),e instanceof ts)e.project=t,n.addStore(e),t.joinStoreRecords(e);else{var i=t.resolveStoreAndModelClass("assignment",e),o=i.storeClass,a=i.modelClass;e=new o(Qn.assign({modelClass:a,project:t,stm:n},e))}e.setProject(t),t.$assignmentStore=e,t.trigger("assignmentStoreChange",{store:e})}},{key:"setAssignmentStore",value:function(e){this.assignmentStore=e}},{key:"resourceStore",get:function(){return this.$resourceStore},set:function(e){var t=this,n=t.stm,r=t.$resourceStore;if(e instanceof ts)e.project=t,n.addStore(e),t.joinStoreRecords(e);else{var i=t.resolveStoreAndModelClass("resource",e),o=i.storeClass,a=i.modelClass;e=new o(Qn.assign({modelClass:a,project:t,stm:n},e))}if(r&&n.hasStore(r)){n.removeStore(r),t.unJoinStoreRecords(r);var s=r.assignmentsForRemoval;s.forEach((function(t){var n=t.resource;if(n){var r=e.getById(n.id);r&&(t.resource=r,s.delete(t))}})),r.afterResourceRemoval()}e.setProject(t),t.$resourceStore=e,t.trigger("resourceStoreChange",{store:e})}},{key:"setResourceStore",value:function(e){this.resourceStore=e}},{key:"dependencyStore",get:function(){return this.$dependencyStore},set:function(e){var t=this;if(e instanceof ts)e.project=t,t.stm.addStore(e),t.joinStoreRecords(e);else{var n=t.resolveStoreAndModelClass("dependency",e),r=n.storeClass,i=n.modelClass;e=new r(Qn.assign({modelClass:i,project:t,stm:t.stm},e))}t.$dependencyStore=e,t.trigger("dependencyStoreChange",{store:e})}},{key:"setDependencyStore",value:function(e){this.dependencyStore=e}},{key:"calendarManagerStore",get:function(){return this.$calendarManagerStore},set:function(e){var t=this;if(e instanceof ts)t.stm.addStore(e);else{var n=(null==e?void 0:e.storeClass)||t.calendarManagerStoreClass,r=(null==e?void 0:e.modelClass)||n.getDefaultConfiguration().modelClass||t.calendarModelClass;e=new n(Qn.assign({modelClass:r,project:t,stm:t.stm},e))}e.setProject(t),t.$calendarManagerStore=e,t.trigger("calendarManagerStoreChange",{store:e})}},{key:"setCalendarManagerStore",value:function(e){this.calendarManagerStore=e}},{key:"calendar",get:function(){return this.$calendar||this.defaultCalendar},set:function(e){this.$calendar=e}},{key:"effectiveCalendar",get:function(){return this.calendar}},{key:"addEvent",value:(u=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventStore.add(t),e.abrupt("return",this.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"addAssignment",value:(l=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assignmentStore.add(t),e.abrupt("return",this.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"addResource",value:(s=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resourceStore.add(t),e.abrupt("return",this.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"addDependency",value:(a=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dependencyStore.add(t),e.abrupt("return",this.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"bufferedCommitAsync",value:function(){this.hasPendingAutoCommit||this.setTimeout({fn:"commitAsync",delay:10})}},{key:"hasPendingAutoCommit",get:function(){return this.hasTimeout("commitAsync")}},{key:"unScheduleAutoCommit",value:function(){this.clearTimeout("commitAsync")}},{key:"commitAsync",value:(o=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPerformingCommit){e.next=2;break}return e.abrupt("return",this.ongoing);case 2:return e.abrupt("return",this.ongoing=this.doCommitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"doCommitAsync",value:(i=Pt()(At.a.mark((function e(){var t,n,r,i,o,a,s,l,u,c,f,d,h,v;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this).isPerformingCommit=!0,t.unScheduleAutoCommit(),e.next=5,nC(0);case 5:if(t.isDestroyed){e.next=25;break}n=cx(t.$invalidated);try{for(n.s();!(r=n.n()).done;)r.value.calculateInvalidated()}catch(e){n.e(e)}finally{n.f()}if(i=t.isInitialCommit,o=t.silenceInitialCommit,a=i&&o,t.assignmentStore.onCommitAsync(),t.dependencyStore.onCommitAsync(),t.isInitialCommitPerformed=!0,t.hasLoadedDataToCommit=!1,t.isPerformingCommit=!1,(s=[t.assignmentStore,t.dependencyStore,t.eventStore,t.resourceStore,t.calendarManagerStore]).forEach((function(e){var t;return null===(t=e.suspendAutoCommit)||void 0===t?void 0:t.call(e)})),t.isWritingData=!0,t.trigger("refresh",{isInitialCommit:i}),a){l=cx(t.$invalidated);try{for(l.s();!(u=l.n()).done;)u.value.finalizeInvalidated(!0)}catch(e){l.e(e)}finally{l.f()}}else{c=cx(t.$invalidated);try{for(c.s();!(f=c.n()).done;)(d=f.value).beginBatch(!0),d.finalizeInvalidated()}catch(e){c.e(e)}finally{c.f()}h=cx(t.$invalidated);try{for(h.s();!(v=h.n()).done;)v.value.endBatch(!1,!0)}catch(e){h.e(e)}finally{h.f()}}return t.isWritingData=!1,t.$invalidated.clear(),t.trigger("dataReady"),s.forEach((function(e){var t;return null===(t=e.resumeAutoCommit)||void 0===t?void 0:t.call(e)})),e.abrupt("return",!0);case 25:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"propagateAsync",value:(r=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.commitAsync());case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"invalidate",value:function(e){this.$invalidated.add(e),this.bufferedCommitAsync()}},{key:"isValidDependency",value:(n=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"getStm",value:function(){return this.stm}},{key:"stm",get:function(){return this.$stm},set:function(e){var t,n=this;(e=this.$stm=new ql(Qn.assign({disabled:!0},e))).on({restoringStop:(t=Pt()(At.a.mark((function t(){return At.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.disable(),t.next=3,n.commitAsync();case 3:n.isDestroyed||(e.enable(),n.trigger("stateRestoringDone"));case 4:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})})}},{key:"isEngineReady",value:function(){return!this.hasPendingAutoCommit&&!this.isPerformingCommit&&this.isInitialCommitPerformed}}],[{key:"defaultConfig",get:function(){return{stm:{},eventStore:{},assignmentStore:{},resourceStore:{},dependencyStore:{},calendarManagerStore:{},eventModelClass:NR,assignmentModelClass:Gw,resourceModelClass:$w,dependencyModelClass:tS,calendarModelClass:tx,eventStoreClass:qR,assignmentStoreClass:uC,resourceStoreClass:SC,dependencyStoreClass:cS,calendarManagerStoreClass:ox,assignmentsData:null,calendarsData:null,dependenciesData:null,eventsData:null,resourcesData:null}}}]),h}(e);return n.applyConfigs=!0,n})));function gx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var yx=function(e){Ye()(n,e);var t=gx(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this].concat(r)),z.a.isTestEnv&&(pe.a.global.bryntum.testProject=this),this.modelPersistencyManager=this.createModelPersistencyManager()}},{key:"createModelPersistencyManager",value:function(){return new RS({eventStore:this,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore})}},{key:"doDestroy",value:function(){this.modelPersistencyManager.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"taskStore",get:function(){return this.eventStore}}],[{key:"$name",get:function(){return"ProjectModel"}}]),n}(wS(px));function mx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}yx.applyConfigs=!0,yx._$name="ProjectModel";var bx=function(e){Ye()(n,e);var t=mx(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildProject",value:function(){return new this.projectClass(this.buildProjectConfig())}},{key:"buildProjectConfig",value:function(){return Qn.cleanupProperties({eventStore:this.eventStore,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore,resourceTimeRangeStore:this.resourceTimeRangeStore})}},{key:"project",get:function(){return this._project},set:function(e){var t=this;e!==t._project&&(t._project=e,e&&(t.eventStore=e.eventStore,t.resourceStore=e.resourceStore,t.assignmentStore=e.assignmentStore,t.dependencyStore=e.dependencyStore,t.timeRangeStore=e.timeRangeStore,t.resourceTimeRangeStore=e.resourceTimeRangeStore),t.eventStore||(t.eventStore={}),t.resourceStore||(t.resourceStore={}),t.assignmentStore||(t.assignmentStore={}),t.dependencyStore||(t.dependencyStore={}))}},{key:"timeRangesStore",get:function(){return this.timeRangeStore}},{key:"timeRangeStore",get:function(){var e;return null===(e=this._timeRangeStore)||void 0===e?void 0:e.store},set:function(e){var t;this.setFeaturedStore("_timeRangeStore",e,null===(t=this.project)||void 0===t?void 0:t.timeRangeStoreClass)}},{key:"resourceTimeRangeStore",get:function(){var e;return null===(e=this._resourceTimeRangeStore)||void 0===e?void 0:e.store},set:function(e){var t;this.setFeaturedStore("_resourceTimeRangeStore",e,null===(t=this.project)||void 0===t?void 0:t.resourceTimeRangeStoreClass)}},{key:"resourceStore",get:function(){var e;return null===(e=this._resourceStore)||void 0===e?void 0:e.store},set:function(e){this.setFeaturedStore("_resourceStore",e,this.resourceStoreClass)}},{key:"eventStore",get:function(){var e;return null===(e=this._eventStore)||void 0===e?void 0:e.store},set:function(e){this.setFeaturedStore("_eventStore",e,this.eventStoreClass)}},{key:"assignmentStore",get:function(){var e;return null===(e=this._assignmentStore)||void 0===e?void 0:e.store},set:function(e){this.setFeaturedStore("_assignmentStore",e,this.assignmentStoreClass)}},{key:"dependencyStore",get:function(){var e;return null===(e=this._dependencyStore)||void 0===e?void 0:e.store},set:function(e){this.setFeaturedStore("_dependencyStore",e,this.dependencyStoreClass)}},{key:"setFeaturedStore",value:function(e,t,n){var r,i,o=this,a=null===(r=o[e])||void 0===r?void 0:r.store;a!==t&&(t=ts.getStore(t,(null===(i=t)||void 0===i?void 0:i.storeClass)||n),a&&o.removeStore(a),o[e]=t&&{store:t}||null,o.addPrioritizedStore(o[e]));return o[e]}},{key:"getChangeSetPackage",value:function(){var e=tt()(Ze()(n.prototype),"getChangeSetPackage",this).call(this);return e&&this.eventStore.usesSingleAssignment&&(delete e[this.assignmentStore.storeId],!this.crudStores.some((function(t){return e[t.storeId]})))?null:e}}],[{key:"defaultConfig",get:function(){return{projectClass:yx,resourceStoreClass:DC,eventStoreClass:XR,assignmentStoreClass:dC,dependencyStoreClass:hS,resourceStore:{},eventStore:{},assignmentStore:{},dependencyStore:{},project:null}}}]),n}(Lk.mixin(pS,jk,Hk));function kx(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return wx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wx(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function wx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bx._$name="CrudManager";var Rx=function(e){Ye()(n,e);var t=Cx(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),this.normalizeUnits()}},{key:"generateId",value:function(e){var t=this,n=t.headers,r=[],i=Object.getPrototypeOf(t.data).id;if(!i){for(var o=n.length-1;o>=0;o--)r.push(o?n[o].unit:te.capitalize(n[o].unit));i=r.join("And")}return e.includes(i)&&(i+="-".concat(t.tickWidth,"by").concat(t.tickHeight||t.tickWidth),e.includes(i)&&(i+="-".concat(t.bottomHeader.increment),e.includes(i)&&(i=Wo.generateId("".concat(i,"-"))))),i}},{key:"normalizeUnits",value:function(){for(var e=this,t=e.timeResolution,n=e.headers,r=0,i=n.length;r<i;r++){var o=n[r];o.unit=Un.normalizeUnit(o.unit),o.splitUnit&&(o.splitUnit=Un.normalizeUnit(o.splitUnit)),"increment"in o||(n[r]=Object.assign({increment:1},o))}t&&(t.unit=Un.normalizeUnit(t.unit)),e.shiftUnit&&(e.shiftUnit=Un.normalizeUnit(e.shiftUnit))}},{key:"set",value:function(){}},{key:"inSet",value:function(){}},{key:"columnLinesFor",get:function(){return"columnLinesFor"in this.data?this.data.columnLinesFor:this.headers.length-1}},{key:"tickSize",get:function(){return this._tickSize||this.tickWidth}},{key:"tickWidth",get:function(){return"tickWidth"in this.data?this.data.tickWidth:50}},{key:"tickHeight",get:function(){return"tickHeight"in this.data?this.data.tickHeight:50}},{key:"headerConfig",get:function(){if(this.data.headerConfig)return this.data.headerConfig;var e={},t=this.headers;switch(t.length){case 1:e.middle=t[0];break;case 2:0===this.mainHeaderLevel?(e.middle=t[0],e.bottom=t[1]):(e.top=t[0],e.middle=t[1]);break;case 3:e.top=t[0],e.middle=t[1],e.bottom=t[2];break;default:throw new Error("headerConfig object not supported for >3 header levels")}return e}},{key:"mainHeaderLevel",get:function(){return"mainHeaderLevel"in this.data?this.data.mainHeaderLevel:3===this.data.headers.length?1:this.headers.length-1},set:function(e){this.data.mainHeaderLevel=e}},{key:"mainHeader",get:function(){return this.headers[this.mainHeaderLevel]}},{key:"bottomHeader",get:function(){return this.headers[this.headers.length-1]}},{key:"leafUnit",get:function(){return this.bottomHeader.unit}},{key:"mainUnit",get:function(){return this.mainHeader}},{key:"msPerPixel",get:function(){var e=this.bottomHeader;return Math.round(Un.asMilliseconds(e.increment||1,e.unit)/this.tickWidth)}},{key:"isValid",get:function(){var e,t=this,n=!0,r=kx(t.headers);try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n&&Boolean(Un.normalizeUnit(i.unit))}}catch(e){r.e(e)}finally{r.f()}return t.timeResolution&&(n=n&&Un.normalizeUnit(t.timeResolution.unit)),t.shiftUnit&&(n=n&&Un.normalizeUnit(t.shiftUnit)),n}}],[{key:"fields",get:function(){return[{name:"name",type:"string"},{name:"rowHeight",defaultValue:24},{name:"tickWidth",defaultValue:50},{name:"tickHeight",defaultValue:50},{name:"displayDateFormat",defaultValue:"HH:mm"},{name:"shiftUnit",defaultValue:"hour"},{name:"shiftIncrement",defaultValue:1},{name:"defaultSpan",defaultValue:12},"timeResolution","headers","mainHeaderLevel","columnLinesFor"]}},{key:"normalizeHeaderConfig",value:function(e){var t=e.headerConfig,n=e.columnLinesFor,r=e.mainHeaderLevel,i=e.headers=[];if(t.top&&("top"===n&&(e.columnLinesFor=0),"top"===r&&(e.mainHeaderLevel=0),i[0]=t.top),!t.middle)throw new Error("ViewPreset.headerConfig must be configured with a middle");"middle"===n&&(e.columnLinesFor=i.length),"middle"===r&&(e.mainHeaderLevel=i.length),i.push(t.middle),t.bottom&&(e.mainHeaderLevel=i.length-1,null==n?e.columnLinesFor=i.length-1:"bottom"===n&&(e.columnLinesFor=i.length),null==r&&(e.mainHeaderLevel=i.length-1),"bottom"===r&&(e.mainHeaderLevel=i.length),i.push(t.bottom))}}]),n}(Lo);function Sx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Rx._$name="ViewPreset";var xx=function(e){Ye()(n,e);var t=Sx(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"storage",get:function(){return tt()(Ze()(n.prototype),"storage",this)},set:function(e){var t=this;gh()(Ze()(n.prototype),"storage",e,this,!0),this.storage.addSorter((function(e,n){var r=e.bottomHeader,i=n.bottomHeader;return(n.msPerPixel-e.msPerPixel||Vn[r.unit]-Vn[i.unit]||r.increment-i.increment)*t.zoomOrder}))}},{key:"createRecord",value:function(e){var t;if(e.base){var r=this.getById(e.base)||Dx.getById(e.base);e=Qn.assign({},e),Object.setPrototypeOf(e,r.data)}for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return(t=tt()(Ze()(n.prototype),"createRecord",this)).call.apply(t,[this,e].concat(o))}},{key:"updateLocalization",value:function(){tt()(Ze()(n.prototype),"updateLocalization",this).call(this);var e=this,t=e.allRecords;e.isPresetManager&&(t=new Set(t.concat(Object.values(e.basePresets)))),t.forEach((function(t){var n=e.optionalL(t.id);"string"==typeof n&&t.baseId&&(n=e.optionalL(t.baseId)),n&&"object"===I()(n)&&(t.originalDisplayDateFormat||(t.originalDisplayDateFormat=t.displayDateFormat),0===t.mainHeaderLevel&&n.topDateFormat&&(n.middleDateFormat=n.middleDateFormat||n.topDateFormat),t.setData("displayDateFormat",n.displayDateFormat||t.originalDisplayDateFormat),["top","middle","bottom"].forEach((function(e){var r=t.headerConfig[e],i=n[e+"DateFormat"];r&&(r.originalDateFormat||(r.originalDateFormat=r.dateFormat),i&&r.renderer&&(r.renderer=null),r.dateFormat=i||r.originalDateFormat)})))}))}}],[{key:"$name",get:function(){return"PresetStore"}},{key:"defaultConfig",get:function(){return{useRawData:!0,modelClass:Rx,zoomOrder:1}}}]),n}(en(ts));function Ex(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}xx._$name="PresetStore";var Dx=new(function(e){Ye()(n,e);var t=Ex(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"basePresets",get:function(){return this._basePresets},set:function(e){var t=this._basePresets={};for(var n in e)e[n].id=n,t[n]=this.createRecord(e[n])}},{key:"defaultPresets",set:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i="string"==typeof r,o=i?r:r.preset,a=void 0;if(i)a=this.basePresets[o];else{var s=Object.setPrototypeOf(Qn.clone(this.basePresets[o].data),{id:o}),l=s.timeResolution,u=s.headers[s.headers.length-1];s.id=void 0,"width"in r&&(s.tickWidth=r.width),"height"in r&&(s.tickHeight=r.height),"increment"in r&&(u.increment=r.increment),"resolution"in r&&(l.increment=r.resolution),"resolutionUnit"in r&&(l.unit=Un.getUnitByName(r.resolutionUnit)),(a=this.createRecord(s)).baseId=o}this.add(a)}}},{key:"getById",value:function(e){return tt()(Ze()(n.prototype),"getById",this).call(this,e)||this.basePresets[e]}},{key:"registerPreset",value:function(e,t){var n=this.createRecord(Object.assign({id:e},t)),r=this.find((function(e){return e.equals(n)}));if(r)return r;if(!n.isValid)throw new Error("Invalid preset, please check your configuration");return this.add(n),n}},{key:"getPreset",value:function(e){return"number"==typeof e&&(e=this.getAt(e)),"string"==typeof e?e=this.getById(e):e instanceof Rx||(e=this.createRecord(e)),e}},{key:"normalizePreset",value:function(e){var t=this;if(!(e instanceof Rx))if("string"==typeof e){if(!(e=t.getPreset(e)))throw new Error("You must define a valid view preset. See PresetManager for reference")}else if("object"===I()(e)){if(e.base){var n=this.getById(e.base);if(!n)throw new Error("ViewPreset base '".concat(e.base,"' does not exist"));e=Qn.merge(Qn.clone(n.data),e)}e.id?e=t.createRecord(e):(e=t.createRecord(Qn.assign({},e))).id=e.generateId(e)}return e}},{key:"deletePreset",value:function(e){"string"==typeof e?e=this.getById(e):"number"==typeof e&&(e=this.getAt(e)),e&&(this.remove(e),delete this.basePresets[e.id])}}],[{key:"$name",get:function(){return"PresetManager"}},{key:"defaultConfig",get:function(){return{preventSubClassingModel:!0,basePresets:{secondAndMinute:{name:"Seconds",tickWidth:30,tickHeight:40,displayDateFormat:"ll LTS",shiftIncrement:10,shiftUnit:"minute",defaultSpan:24,timeResolution:{unit:"second",increment:5},headers:[{unit:"minute",dateFormat:"llll"},{unit:"second",increment:10,dateFormat:"ss"}]},minuteAndHour:{name:"Minutes",tickWidth:60,tickHeight:60,displayDateFormat:"ll LT",shiftIncrement:1,shiftUnit:"hour",defaultSpan:24,timeResolution:{unit:"minute",increment:30},headers:[{unit:"hour",dateFormat:"ddd MM/DD, hA"},{unit:"minute",increment:30,dateFormat:"mm"}]},hourAndDay:{name:"Hours",tickWidth:70,tickHeight:40,displayDateFormat:"ll LT",shiftIncrement:1,shiftUnit:"day",defaultSpan:24,timeResolution:{unit:"minute",increment:30},headers:[{unit:"day",dateFormat:"ddd DD/MM"},{unit:"hour",dateFormat:"LT"}]},day:{name:"Hours 2",displayDateFormat:"LT",shiftIncrement:1,shiftUnit:"day",defaultSpan:1,timeResolution:{unit:"minute",increment:30},mainHeaderLevel:0,headers:[{unit:"day",dateFormat:"ddd DD/MM",splitUnit:"day"},{unit:"hour",renderer:function(e){return'\n                                    <div class="b-sch-calendarcolumn-ct"><span class="b-sch-calendarcolumn-hours">'.concat(Un.format(e,"HH"),'</span>\n                                    <span class="b-sch-calendarcolumn-minutes">').concat(Un.format(e,"mm"),"</span></div>\n                                ")}}]},week:{name:"Week/hours",displayDateFormat:"LT",shiftIncrement:1,shiftUnit:"week",defaultSpan:24,timeResolution:{unit:"minute",increment:30},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"D d",splitUnit:"day"},{unit:"hour",dateFormat:"LT",renderer:function(e){return'\n                                    <div class="sch-calendarcolumn-ct">\n                                    <span class="sch-calendarcolumn-hours">'.concat(Un.format(e,"HH"),'</span>\n                                    <span class="sch-calendarcolumn-minutes">').concat(Un.format(e,"mm"),"</span>\n                                    </div>\n                                ")}}]},dayAndWeek:{name:"Days 2",tickWidth:100,tickHeight:80,displayDateFormat:"ll LT",shiftUnit:"day",shiftIncrement:1,defaultSpan:5,timeResolution:{unit:"hour",increment:1},headers:[{unit:"week",renderer:function(e){return Un.getShortNameOfUnit("week")+"."+Un.format(e,"WW MMM YYYY")}},{unit:"day",dateFormat:"dd DD"}]},weekAndDay:{name:"Days",tickWidth:100,tickHeight:80,displayDateFormat:"ll hh:mm A",shiftUnit:"week",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"day",increment:1},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"YYYY MMMM DD"},{unit:"day",increment:1,dateFormat:"DD MMM"}]},weekAndMonth:{name:"Weeks",tickWidth:100,tickHeight:105,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:5,defaultSpan:6,timeResolution:{unit:"day",increment:1},headers:[{unit:"month",dateFormat:"MMM YYYY"},{unit:"week",dateFormat:"DD MMM"}]},weekAndDayLetter:{name:"Weeks 2",tickWidth:20,tickHeight:50,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:1,defaultSpan:10,timeResolution:{unit:"day",increment:1},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"ddd DD MMM YYYY",verticalColumnWidth:115},{unit:"day",dateFormat:"d1",verticalColumnWidth:25}]},weekDateAndMonth:{name:"Weeks 3",tickWidth:30,tickHeight:40,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:1,defaultSpan:10,timeResolution:{unit:"day",increment:1},headers:[{unit:"month",dateFormat:"YYYY MMMM"},{unit:"week",dateFormat:"DD"}]},monthAndYear:{name:"Months",tickWidth:110,tickHeight:110,displayDateFormat:"ll",shiftIncrement:3,shiftUnit:"month",defaultSpan:12,timeResolution:{unit:"day",increment:1},headers:[{unit:"year",dateFormat:"YYYY"},{unit:"month",dateFormat:"MMM YYYY"}]},year:{name:"Years",tickWidth:100,tickHeight:100,resourceColumnWidth:100,displayDateFormat:"ll",shiftUnit:"year",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"month",increment:1},headers:[{unit:"year",dateFormat:"YYYY"},{unit:"quarter",renderer:function(e,t,n){return Un.getShortNameOfUnit("quarter").toUpperCase()+(Math.floor(e.getMonth()/3)+1)}}]},manyYears:{name:"Years 2",tickWidth:40,tickHeight:50,displayDateFormat:"ll",shiftUnit:"year",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"year",increment:1},mainHeaderLevel:0,headers:[{unit:"year",dateFormat:"YYYY",increment:5},{unit:"year",dateFormat:"YY",increment:1}]}},defaultPresets:["manyYears",{width:80,increment:1,resolution:1,preset:"manyYears",resolutionUnit:"YEAR"},"year",{width:30,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},{width:50,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},{width:200,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},"monthAndYear","weekDateAndMonth","weekAndMonth","weekAndDayLetter","weekAndDay",{width:54,increment:1,resolution:1,preset:"weekAndDay",resolutionUnit:"HOUR"},"hourAndDay",{width:64,increment:6,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},{width:100,increment:6,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},{width:64,increment:2,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},"minuteAndHour",{width:30,increment:15,resolution:5,preset:"minuteAndHour"},{width:130,increment:15,resolution:5,preset:"minuteAndHour"},{width:60,increment:5,resolution:5,preset:"minuteAndHour"},{width:100,increment:5,resolution:5,preset:"minuteAndHour"},"secondAndMinute",{width:60,increment:10,resolution:5,preset:"secondAndMinute"},{width:130,increment:5,resolution:5,preset:"secondAndMinute"}],listeners:{locale:"updateLocalization"}}}}]),n}(xx));function Tx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Ox=function(e){Ye()(n,e);var t=Tx(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;if(t.generateTicksValidatorFn=function(){return!0},tt()(Ze()(n.prototype),"construct",this).call(this,e),t.originalContinuous=t.continuous,t.on({change:function(e){"filter"!==e.action&&t.trigger("reconfigure",{supressRefresh:!1})},refresh:function(){return t.trigger("reconfigure",{supressRefresh:!1})},endreconfigure:function(e){return t.trigger("reconfigure",e)}}),t.startDate)t.internalOnReconfigure(),t.trigger("reconfigure");else if(t.viewPreset){var r=t.getAdjustedDates(new Date);t.startDate=r.startDate,t.endDate=r.endDate}}},{key:"isTimeAxis",get:function(){return!0}},{key:"reconfigure",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getAdjustedDates(e.startDate,e.endDate),o={};if(!1!==r.trigger("beforeReconfigure",{startDate:i.startDate,endDate:i.endDate,config:e})){for(var a in r.trigger("beginReconfigure"),r._configuredStartDate=e.startDate,r._configuredEndDate=e.endDate,e)o[a]=r[a];if(Object.assign(r,e),!1===r.internalOnReconfigure(n))return!1;r.trigger("endReconfigure",{suppressRefresh:t,config:e,oldConfig:o})}}},{key:"internalOnReconfigure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.isConfigured=!0;var n=t.getAdjustedDates(t.startDate,t.endDate,!0),r=t.getAdjustedDates(t.startDate,t.endDate),i=r.startDate,o=r.endDate;if(i>=o)throw new Error("Invalid start/end dates. Start date must less than end date. Start date: ".concat(i,". End date: ").concat(o,"."));var a=t.unit,s=t.increment||1,l=t.generateTicks(i,o,a,s);t.suspendEvents(),t.data=l;var u=t.count;if(0===u){if(e)return t.resumeEvents(),!1;throw new Error("Invalid time axis configuration or filter, please check your input data.")}t.startDate=t.first.startDate,t.resumeEvents();var c=t.last.endDate;t.isContinuous?(t.adjustedStart=n.startDate,t.adjustedEnd=Un.getNext(u>1?l[u-1].startDate:n.startDate,a,s,t.weekStartDay)):(t.adjustedStart=t.startDate,t.adjustedEnd=c);do{t.visibleTickStart=(t.startDate-t.adjustedStart)/(Un.asMilliseconds(a)*s),t.autoAdjust&&(t.visibleTickStart=Math.floor(t.visibleTickStart)),t.visibleTickStart>=1&&(t.adjustedStart=Un.getNext(t.adjustedStart,a,s,t.weekStartDay))}while(t.visibleTickStart>=1);do{t.visibleTickEnd=u-(t.adjustedEnd-c)/(Un.asMilliseconds(a)*s),u-t.visibleTickEnd>=1&&(t.adjustedEnd=Un.getNext(t.adjustedEnd,a,-1,t.weekStartDay))}while(u-t.visibleTickEnd>=1);t.fullTicks=!t.visibleTickStart&&t.visibleTickEnd===u,t.updateTickCache(!0)}},{key:"viewPreset",get:function(){return this._viewPreset},set:function(e){if(!((e=Dx.getPreset(e))instanceof Rx))throw new Error("TimeAxis must be configured with the ViewPreset instance that the Scheduler is using");this._viewPreset=e,Object.assign(this,{unit:e.bottomHeader.unit,increment:e.bottomHeader.increment||1,resolutionUnit:e.timeResolution.unit,resolutionIncrement:e.timeResolution.increment,mainUnit:e.mainHeader.unit,shiftUnit:e.shiftUnit,shiftIncrement:e.shiftIncrement||1,defaultSpan:e.defaultSpan||1,presetName:e.id,headers:e.headers})}},{key:"weekStartDay",get:function(){return null==this._weekStartDay?Un.weekStartDay:this._weekStartDay},set:function(e){this._weekStartDay=e}},{key:"resolution",get:function(){return{unit:this.resolutionUnit,increment:this.resolutionIncrement}},set:function(e){this.resolutionUnit=e.unit,this.resolutionIncrement=e.increment}},{key:"resolutionUnit",get:function(){return this._resolutionUnit},set:function(e){this._resolutionUnit=e}},{key:"resolutionIncrement",get:function(){return this._resolutionIncrement},set:function(e){this._resolutionIncrement=e||1}},{key:"mainUnit",get:function(){return this._mainUnit},set:function(e){this._mainUnit=e}},{key:"shiftUnit",get:function(){return this._shiftUnit||this._mainUnit},set:function(e){this._shiftUnit=e}},{key:"shiftIncrement",get:function(){return this._shiftIncrement||1},set:function(e){this._shiftIncrement=e}},{key:"unit",get:function(){return this._unit},set:function(e){this._unit=e}},{key:"increment",get:function(){return this._increment},set:function(e){this._increment=e}},{key:"defaultSpan",get:function(){return this._defaultSpan},set:function(e){this._defaultSpan=e}},{key:"setTimeSpan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&e-t==0&&(t=null);var r=this,i=r.getAdjustedDates(e,t),o=i.startDate,a=i.endDate;if(r.startDate-o!=0||r.endDate-a!=0)return r.reconfigure({startDate:o,endDate:a},!1,n)}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shiftUnit,n=this,r=n.startDate,i=n.endDate;n.isFiltered&&(r=n.allRecords[0].startDate,i=n.allRecords[n.allCount-1].endDate);var o=0;do{r=Un.add(r,e,t),i=Un.add(i,e,t)}while(o++<100&&!1===n.setTimeSpan(r,i,{preventThrow:!0}))}},{key:"shiftNext",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shiftIncrement;this.shift(e)}},{key:"shiftPrevious",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shiftIncrement;this.shift(-e)}},{key:"filterBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=this;r.filters.clear(),tt()(Ze()(n.prototype),"filterBy",this).call(this,(function(n,r){return e.call(t,n.data,r)})),0===r.count&&(r.trigger("invalidFilter"),r.clearFilters())}},{key:"triggerFilterEvent",value:function(e){var t=this;e.filters.count?t.continuous=!1:t.continuous=t.originalContinuous,t.updateTickCache(),tt()(Ze()(n.prototype),"triggerFilterEvent",this).call(this,e)}},{key:"isContinuous",get:function(){return!1!==this.continuous&&!this.filtered}},{key:"getAdjustedDates",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return t&&e-t==0&&(t=null),e=e||r.startDate,t=t||Un.add(e,r.defaultSpan,r.mainUnit),r.autoAdjust||n?{startDate:r.floorDate(e,!1,r.autoAdjust?r.mainUnit:r.unit,1),endDate:r.ceilDate(t,!1,r.autoAdjust?r.mainUnit:r.unit,1)}:{startDate:e,endDate:t}}},{key:"startDate",get:function(){return this._start||(this.first?new Date(this.first.startDate):null)},set:function(e){this._start=Un.parse(e)}},{key:"endDate",get:function(){return this._end||(this.last?new Date(this.last.endDate):null)},set:function(e){e&&(this._end=Un.parse(e))}},{key:"startMS",get:function(){return this._startMS}},{key:"endMS",get:function(){return this._endMS}},{key:"floorDate",value:function(e,t,n,r){var i=this,o=(t=!1!==t)?Un.clone(i.startDate):null,a=r||i.resolutionIncrement,s=n||(t?i.resolutionUnit:i.mainUnit),l=function(e,t){return Math.floor(e/t)*t};if(t){var u=l(Un.diff(o,e,s),a);return Un.add(o,u,s)}var c=Un.clone(e);if("week"===s){var f=c.getDay()||7,d=i.weekStartDay||7;(c=Un.add(Un.startOf(c,"day"),f>=d?d-f:-(7-d+f),"day")).getDay()!==d&&23===c.getHours()&&(c=Un.add(c,1,"hour"))}else{c=Un.startOf(c,s);var h=["day","year"].includes(s)?1:0,v="day"===s?"date":s,p=l(Un.get(c,v)-h,a)+h;c=Un.set(c,v,p)}return c}},{key:"roundDate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.resolutionUnit,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.resolutionIncrement||1,i=this,o=Un.clone(e);switch(t=Un.clone(t||i.startDate),n){case"week":Un.startOf(o,"day");var a,s=o.getDay()-i.weekStartDay;return s<0&&(s=7+s),a=1===Math.round(s/7)?7-s:-s,Un.add(o,a,"day");case"month":var l=Un.diff(t,o,"month")+Un.as("month",o.getDay()/Un.daysInMonth(o)),u=Math.round(l/r)*r;return Un.add(t,u,"month");case"quarter":return Un.startOf(o,"month"),Un.add(o,"month",3-o.getMonth()%3);default:var c=Un.as(n,Un.diff(t,o)),f=Un.as(n,t.getTimezoneOffset()-o.getTimezoneOffset(),"minute"),d=Math.round((c+f)/r)*r;return Un.add(t,d-f,n)}}},{key:"ceilDate",value:function(e,t,n,r){var i=this;t=!1!==t,r=r||(t?this.resolutionIncrement:1);var o=Un.clone(e),a=!1,s=n||(t?i.resolutionUnit:i.mainUnit);switch(s){case"minute":a=!Un.isStartOf(o,"minute");break;case"hour":a=!Un.isStartOf(o,"hour");break;case"day":case"date":a=!Un.isStartOf(o,"day");break;case"week":a=(o=Un.startOf(o,"day")).getDay()!==i.weekStartDay||!Un.isEqual(o,e);break;case"month":a=1!==(o=Un.startOf(o,"day")).getDate()||!Un.isEqual(o,e);break;case"quarter":a=(o=Un.startOf(o,"day")).getMonth()%3!=0||1!==o.getDate()||!Un.isEqual(o,e);break;case"year":a=0!==(o=Un.startOf(o,"day")).getMonth()||1!==o.getDate()||!Un.isEqual(o,e)}return a?Un.getNext(o,s,r,i.weekStartDay):o}},{key:"include",get:function(){return this._include},set:function(e){var t=this;t._include=e,t.continuous=!e,t.isConfiguring||(t.startDate=t._configuredStartDate,t.endDate=t._configuredEndDate,t.internalOnReconfigure(),t.trigger("includeChange"))}},{key:"processExclusion",value:function(e,t,n){var r=this.include;return!!r&&Object.entries(r).some((function(r){var i=N()(r,2),o=i[0],a=i[1];if(!a)return!1;var s=a.from,l=a.to;if(Un.compareUnits("day",n)>=0&&Un.getLargerUnit(o)===n&&(s&&Un.set(e,o,s),l)){var u,c=n;"day"===n&&(c="date"),Un.set(t,(u={},Qe()(u,c,Un.get(t,c)-1),Qe()(u,o,l),u))}if(Un.compareUnits(o,n)>=0){var f="day"===o?e.getDay():Un.get(e,o);if(s&&f<s||l&&f>=l)return!0}}))}},{key:"initExclusion",value:function(){Object.entries(this.include).forEach((function(e){var t=N()(e,2),n=t[0],r=t[1];if(r){var i=r.from,o=r.to;r.lengthFactor=Un.getUnitToBaseUnitRatio(n,Un.getLargerUnit(n))/(o-i),r.lengthFactorExcl=Un.getUnitToBaseUnitRatio(n,Un.getLargerUnit(n))/(o-i-1),r.center=i+i/(r.lengthFactor-1)}}))}},{key:"generateTicks",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.unit,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.increment,s=this,l=[],u=Boolean(s.include),c=0,f=s.getAdjustedDates(e,t),d=f.startDate,h=f.endDate;for(s.tickCache={},u&&s.initExclusion();d<h;){if(n=Un.getNext(d,o,a,s.weekStartDay),!s.autoAdjust&&n>h&&(n=h),"hour"===o&&a>1&&l.length>0&&0===c){var v=l[l.length-1];0!==(c=(v.startDate.getHours()+a)%24-v.endDate.getHours())&&(n=Un.add(n,c,"hour"))}i=!1,u?(r=new Date(n.getTime()),i=s.processExclusion(d,n,o)):r=n,s.generateTicksValidatorFn(d)&&!i&&(l.push({id:l.length+1,startDate:d,endDate:n}),s.tickCache[d.getTime()]=l.length-1),d=r}return l}},{key:"visibleTickTimeSpan",get:function(){var e=this;return e.isContinuous?e.visibleTickEnd-e.visibleTickStart:e.count}},{key:"getTickFromDate",value:function(e){var t,n,r,i,o=this,a=o.records,s=e.getTime(),l=0,u=a.length-1;if(!a.length||e<a[0].startDate||e>a[u].endDate)return-1;if(o.isContinuous){for(;l<u;)s>a[t=l+u+1>>1].endDate.getTime()?l=t+1:s<a[t].startDate.getTime()?u=t-1:l=t;return s>(r=(n=a[l]).startDate.getTime())&&(l+=(s-r)/((i=n.endDate.getTime())-r)),Math.min(Math.max(l,o.visibleTickStart),o.visibleTickEnd)}for(var c=0;c<=u;c++)if(e<=(i=a[c].endDate))return n=c+(e>(r=a[c].startDate)?(e-r)/(i-r):0)}},{key:"getDateFromTick",value:function(e,t){var n=this;if(e===n.visibleTickEnd)return n.endDate;var r=Math.floor(e),i=e-r,o=n.getAt(r);if(!o)return null;var a=0===r?n.adjustedStart:o.startDate,s=r===n.count-1&&n.isContinuous?n.adjustedEnd:o.endDate,l=Un.add(a,i*(s-a),"millisecond");return t&&(l=n[t+"Date"](l)),l}},{key:"ticks",get:function(){return this.records}},{key:"updateTickCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.count?(t._start=t.first.startDate,t._end=t.last.endDate,t._startMS=t.startDate.getTime(),t._endMS=t.endDate.getTime()):t._start=t._end=t._startMs=t._endMS=null,e||(t.tickCache={},t.forEach((function(e,n){return t.tickCache[e.startDate.getTime()]=n})))}},{key:"dateInAxis",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.startDate,i=n.endDate;if(n.isContinuous)return t?Un.betweenLesserEqual(e,r,i):Un.betweenLesser(e,r,i);for(var o,a,s,l=n.getCount(),u=0;u<l;u++)if(o=(s=n.getAt(u)).startDate,a=s.endDate,t&&e<=a||!t&&e<a)return e>=o;return!1}},{key:"timeSpanInAxis",value:function(e,t){var n=this;return t&&t.getTime()!==e.getTime()?n.isContinuous?Un.intersectSpans(e,t,n.startDate,n.endDate):e<n.startDate&&t>n.endDate||n.getTickFromDate(e)!==n.getTickFromDate(t):this.dateInAxis(e,!0)}},{key:"isTimeSpanInAxis",value:function(e){var t=this,n=t.startMS,r=t.endMS,i=e.startDateMS,o=e.endDateMS;if(!i||!o)return!1;if(o===i)return t.dateInAxis(e.startDate,!0);if(t.isContinuous)return o>n&&i<r;var a=t.getTickFromDate(e.startDate),s=t.getTickFromDate(e.endDate);return!(a===t.count&&Un.isEqual(e.startDate,t.last.endDate)||0===s&&Un.isEqual(e.endDate,t.first.startDate))&&(i<n&&o>r||a!==s)}},{key:"forEachAuxInterval",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this,o=this.endDate,a=this.startDate,s=0;if(a>o)throw new Error("Invalid time axis configuration");for(;a<o;)t=Un.min(Un.getNext(a,e,n,this.weekStartDay),o),r.call(i,a,t,s,t>=o),a=t,s++}}],[{key:"defaultConfig",get:function(){return{modelClass:KC,continuous:!0,originalContinuous:null,include:null,autoAdjust:!0,unit:null,increment:null,resolutionUnit:null,resolutionIncrement:null,weekStartDay:null,mainUnit:null,shiftUnit:null,shiftIncrement:1,adjustedStart:null,adjustedEnd:null,visibleTickStart:null,visibleTickEnd:null,defaultSpan:1,tickCache:{},viewPreset:null}}}]),n}(ts);function Mx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ox._$name="TimeAxis";var Ax=function(e){Ye()(n,e);var t=Mx(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"RecurrenceLegend"}},{key:"allDaysValueAsArray",get:function(){return["SU","MO","TU","WE","TH","FR","SA"]}},{key:"allDaysValue",get:function(){return this.allDaysValueAsArray.join(",")}},{key:"workingDaysValue",get:function(){return this.allDaysValueAsArray.filter((function(e,t){return!Un.nonWorkingDays[t]})).join(",")}},{key:"nonWorkingDaysValue",get:function(){return this.allDaysValueAsArray.filter((function(e,t){return Un.nonWorkingDays[t]})).join(",")}},{key:"getLegend",value:function(e,t){var n,r=this,i=e.timeSpan,o=e.interval,a=e.days,s=e.monthDays,l=e.months,u=e.positions,c=t||i.startDate,f={interval:o};switch(e.frequency){case"DAILY":return 1===o?r.L("L{Daily}"):r.L("L{Every {0} days}",f);case"WEEKLY":return a&&a.length?f.days=r.getDaysLegend(a):c&&(f.days=Un.getDayName(c.getDay())),r.L(1===o?"L{Weekly on {1}}":"L{Every {0} weeks on {1}}",f);case"MONTHLY":return a&&a.length&&u&&u.length?f.days=r.getDaysLegend(a,u):s&&s.length?(s.sort((function(e,t){return e-t})),f.days=r.arrayToText(s)):c&&(f.days=c.getDate()),r.L(1===o?"L{Monthly on {1}}":"L{Every {0} months on {1}}",f);case"YEARLY":return a&&a.length&&u&&u.length?f.days=r.getDaysLegend(a,u):f.days=c.getDate(),l&&l.length?(l.sort((function(e,t){return e-t})),n=l.length>2?function(e){return Un.getMonthShortName(e-1)}:function(e){return Un.getMonthName(e-1)},f.months=r.arrayToText(l,n)):f.months=Un.getMonthName(c.getMonth()),r.L(1===o?"L{Yearly on {1} of {2}}":"L{Every {0} years on {1} of {2}}",f)}}},{key:"getDaysLegend",value:function(e,t){var n,r=this,i={position:""};if(t&&t.length&&(i.position=r.arrayToText(t,(function(e){return r.L("L{position".concat(e,"}"))}))),e.length)switch(e.sort((function(e,t){return QC.decodeDay(e)[0]-QC.decodeDay(t)[0]})),e.join(",")){case r.allDaysValue:i.days=r.L("L{day}");break;case r.workingDaysValue:i.days=r.L("L{weekday}");break;case r.nonWorkingDaysValue:i.days=r.L("L{weekend day}");break;default:n=e.length>2?function(e){return Un.getDayShortName(QC.decodeDay(e)[0])}:function(e){return Un.getDayName(QC.decodeDay(e)[0])},i.days=r.arrayToText(e,n)}return r.L("L{daysFormat}",i)}},{key:"arrayToText",value:function(e,t){return t&&(e=e.map(t)),e.join(", ").replace(/,(?=[^,]*$)/,this.L("L{ and }"))}}]),n}(en());function Ix(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Ax._$name="RecurrenceLegend";var Px=function(e){return function(e){Ye()(r,e);var t,n=Ix(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"afterConstruct",value:(t=Pt()(At.a.mark((function e(){var t,n,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:tt()(Ze()(r.prototype),"afterConstruct",this).call(this),n=(t=this).client||t.grid,i=n.project,n.projectSubscribers.push(t),i&&(t.attachToProject(i),t.attachToResourceStore(i.resourceStore),t.attachToEventStore(i.eventStore),t.attachToAssignmentStore(i.assignmentStore),t.attachToDependencyStore(i.dependencyStore),t.attachToCalendarManagerStore(i.calendarManagerStore));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"attachToProject",value:function(e){this.detachListeners("project"),this._project=e}},{key:"attachToEventStore",value:function(e){this.detachListeners("eventStore")}},{key:"attachToResourceStore",value:function(e){this.detachListeners("resourceStore")}},{key:"attachToAssignmentStore",value:function(e){this.detachListeners("assignmentStore")}},{key:"attachToDependencyStore",value:function(e){this.detachListeners("dependencyStore")}},{key:"attachToCalendarManagerStore",value:function(e){this.detachListeners("calendarManagerStore")}},{key:"project",get:function(){return this._project}},{key:"calendarManagerStore",get:function(){return this.project.calendarManagerStore}},{key:"assignmentStore",get:function(){return this.project.assignmentStore}},{key:"resourceStore",get:function(){return this.project.resourceStore}},{key:"eventStore",get:function(){return this.project.eventStore}},{key:"dependencyStore",get:function(){return this.project.dependencyStore}}],[{key:"$name",get:function(){return"AttachToProjectMixin"}}]),r}(e)};function Fx(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Lx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lx(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Lx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var jx=function(e){return function(e){Ye()(n,e);var t=Bx(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"startConfigure",value:function(e){this.getConfig("project"),tt()(Ze()(n.prototype),"startConfigure",this).call(this,e)}},{key:"changeProject",value:function(e,t){var n=this,r=n.constructor,i=r.projectStoreNames,o=r.projectDataNames;if(n.projectCallbacks=new Set,e){if(n.buildingProjectConfig=!0,!e.isModel){if(n.isConfiguring){n._project=e;var a=n.crudManager;if(a){var s,l=a.isCrudManager,u=Fx(i);try{for(u.s();!(s=u.n()).done;){var c=s.value;a[c]&&(n[c]=a[c],l||delete a[c])}}catch(e){u.e(e)}finally{u.f()}}n.getConfig("projectStores");var f,d=Fx(o);try{for(d.s();!(f=d.n()).done;){var h=f.value;n.getConfig(h)}}catch(e){d.e(e)}finally{d.f()}}var v=e.eventStore;v&&!v.isEventStoreMixin&&v.autoLoad&&!v.count&&(v.autoLoad=!1,n.delayAutoLoad=!0),e=n._sharedProject||new n.projectModelClass(e),delete n._project}n.buildingProjectConfig=!1}return e}},{key:"updateProject",value:function(e,t){var n=this,r=n.projectListeners,i=n.crudManager;if(n.detachListeners("projectConsumer"),delete n._crudManager,e){r.thisObj=n,e.on(r),e.isCrudManager?n.crudManager=e:i&&(i.project=e,n.crudManager=i),n.projectSubscribers.forEach((function(t){return t.attachToProject(e)}));var o,a=Fx(n.constructor.projectStoreNames);try{for(a.s();!(o=a.n()).done;){var s=o.value;n[s]=e[s]}}catch(e){a.e(e)}finally{a.f()}n.delayAutoLoad&&(e.eventStore.autoLoad=!0,e.eventStore.load())}n.trigger("projectChange",{project:e})}},{key:"changeCrudManager",value:function(e){if(!this.buildingProjectConfig)return tt()(Ze()(n.prototype),"changeCrudManager",this).call(this,e);this._crudManager=e.isCrudManager?e:Object.assign({},e)}},{key:"onProjectDataReady",value:function(){this.projectCallbacks.size&&(this.projectCallbacks.forEach((function(e){return e()})),this.projectCallbacks.clear())}},{key:"whenProjectReady",value:function(e){this.isEngineReady?e():this.projectCallbacks.add(e)}},{key:"isEngineReady",get:function(){var e,t;return Boolean(null===(e=(t=this.project).isEngineReady)||void 0===e?void 0:e.call(t))}},{key:"doDestroy",value:function(){tt()(Ze()(n.prototype),"doDestroy",this).call(this),this.destroyStores&&!this.project.isDestroyed&&this.project.destroy()}},{key:"projectStores",get:function(){var e=this;return this.constructor.projectStoreNames.map((function(t){return e[t]}))}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"ProjectConsumer"}},{key:"declarable",get:function(){return["projectStores"]}},{key:"configurable",get:function(){return{projectModelClass:yx,project:{},destroyStores:null,projectSubscribers:[]}}},{key:"projectStoreNames",get:function(){return Object.keys(this.projectStores)}},{key:"projectDataNames",get:function(){var e=this;return this.projectStoreNames.reduce((function(t,n){var r=e.projectStores[n].dataName;return r&&t.push(r),t}),[])}},{key:"setupProjectStores",value:function(e,t){var n=this,r=e.projectStores;if(r){var i={name:"projectConsumer",dataReady:"onProjectDataReady"},o={projectListeners:i},a=function(e){var a=r[e].dataName;o[e]=null,a&&Object.defineProperty(t.class.prototype,a,{get:function(){var t;return null===(t=this.project[e])||void 0===t?void 0:t.records},set:function(t){var n=this.project;this.buildingProjectConfig?n["".concat(a,"Data")]=t:n[e].data=t}}),n.createStoreDescriptor(t,e,r[e],i)};for(var s in r)a(s);this.setupConfigs(t,o)}}},{key:"createStoreDescriptor",value:function(e,t,n,r){var i=n.listeners,o=e.class.prototype,a=te.capitalize(t);r["".concat(t,"Change")]=function(e){var n=e.store;this[t]=n},o["change".concat(a)]=function(e,n){var r,o=this,s=o.project,l=null===(r=e)||void 0===r?void 0:r.project;return o.buildingProjectConfig?(l&&l.isProjectModel&&(o._sharedProject=l),void(s[t]=e)):(o.initializingProject||s[t]!==e&&(s["set".concat(a)](e),e=s[t]),e!==n&&(i&&(i.thisObj=o,i.name="".concat(t,"Listeners"),o.detachListeners(i.name),e.on(i)),o.projectSubscribers.forEach((function(t){var n;null===(n=t["attachTo".concat(a)])||void 0===n||n.call(t,e)}))),e)}}}]),n}(e||$e)};function _x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var Hx=function(e){Ye()(n,e);var t=_x(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"generateContent",value:function(e){var t=this,n=e.date,r=t.template(e),i=t.div;return i.innerHTML=r,t.updateDateIndicator(i,n),i.innerHTML}},{key:"updateDateIndicator",value:function(e,t){var n=null==e?void 0:e.querySelector(".b-sch-hour-indicator"),r=null==e?void 0:e.querySelector(".b-sch-minute-indicator");t&&n&&r&&("hour"===this.mode?(n.style.transform="rotate(".concat(t.getHours()%12*30,"deg)"),r.style.transform="rotate(".concat(6*t.getMinutes(),"deg)")):(n.style.transform="none",r.style.transform="none"))}},{key:"mode",get:function(){if(this._mode)return this._mode;var e=Un.compareUnits(this.scheduler.timeAxisViewModel.timeResolution.unit,"day")<0,t=Un.formatContainsHourInfo(this.scheduler.displayDateFormat);return e&&t?"hour":"day"},set:function(e){this._mode=e}},{key:"template",get:function(){return this._template},set:function(e){this._template=e}}],[{key:"defaultConfig",get:function(){return{minuteHeight:8,minuteTop:2,hourHeight:8,hourTop:2,handLeft:10,div:document.createElement("div"),scheduler:null,template:function(e){return'<div class="b-sch-clockwrap b-sch-clock-'.concat(e.mode||this.mode," ").concat(e.cls||"",'">\n                    <div class="b-sch-clock">\n                        <div class="b-sch-hour-indicator">').concat(Un.format(e.date,"MMM"),'</div>\n                        <div class="b-sch-minute-indicator">').concat(Un.format(e.date,"D"),'</div>\n                        <div class="b-sch-clock-dot"></div>\n                    </div>\n                    <span class="b-sch-clock-text">').concat(te.encodeHtml(e.text),"</span>\n                </div>")}}}}]),n}($e);function Nx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nx(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Hx._$name="ClockTemplate";var Wx=function(e){Ye()(r,e);var t,n=Vx(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"onPaint",value:function(e){var t,n=e.firstPaint,r=this,i=r.client,o=r.constrainDragToTimeline,a=r.constrainDragToResource,s=r.constrainDragToTimeSlot,l=r.dragHelperConfig,u=i.timeAxisViewModel,c=i.isHorizontal,f=c?a:s,d=c?s:a,h=[];null===(t=r.drag)||void 0===t||t.destroy(),d||h.push({element:i.timeAxisSubGrid.scrollable.element,direction:"horizontal"}),f||h.push({element:i.scrollable.element,direction:"vertical"}),r.drag=Xf.new({name:r.constructor.name,mode:"translateXY",lockX:d,lockY:f,minX:!0,maxX:!0,constrain:!1,cloneTarget:!o,dragWithin:o?null:document.body,hideOriginalElement:!0,outerElement:i.timeAxisSubGridElement,targetSelector:i.eventSelector,scrollManager:o?i.scrollManager:null,transitionDuration:i.transitionDuration,snapCoordinates:function(e){var t=e.element,n=e.newX,a=e.newY;if(o&&!r.constrainDragToTimeSlot&&(r.showExactDropPosition||u.snap)){var s=r.dragData,l=u.getDateFromPosition(r.getCoordinate(s.draggedEntities[0],t,[n,a]),"round"),f=l&&u.getPositionFromDate(l);l&&l>=i.startDate&&null!=f&&(c?n=f:a=f)}return{x:n,y:a}},listeners:{beforedragstart:"onBeforeDragStart",dragstart:"onDragStart",drag:"onDrag",drop:"onDrop",abort:"onDragAbort",reset:"onDragReset",thisObj:r},monitoringConfig:{scrollables:h}},l,{isElementDraggable:function(e,t){return(!l||!l.isElementDraggable||l.isElementDraggable(e,t))&&r.isElementDraggable(e,t)}}),n&&(i.rowManager.on({changeTotalHeight:"updateYConstraint",thisObj:r}),r.dragTipTemplate&&z.a.deprecate("Scheduler","5.0.0","Deprecated in favor of `tooltipTemplate`, will be removed in 5.0")),r.showTooltip&&(r.clockTemplate=new Hx({scheduler:i}))}},{key:"doDestroy",value:function(){var e,t,n;null===(e=this.drag)||void 0===e||e.destroy(),null===(t=this.clockTemplate)||void 0===t||t.destroy(),null===(n=this.tip)||void 0===n||n.destroy(),tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"onBeforeDragStart",value:function(e){var t=e.context,n=e.event,r=this,i=r.client,o=i.scheduledEventName,a=r.getMinimalDragData(t,n),s=null==a?void 0:a["".concat(o,"Record")];if(r.disabled||!s||!1===s.isDraggable)return!1;t.pointerStartDate=i.getDateFromXY([t.startClientX,t.startPageY],null,!1);var l=!1!==i.trigger("before".concat(o,"Drag"),zx(zx({},a),{},{event:n,context:zx(zx({},t),a)}));return l&&r.updateYConstraint(s),l}},{key:"constrainDragToTimeSlot",get:function(){return this._constrainDragToTimeSlot},set:function(e){var t=this.client.isHorizontal?"lockX":"lockY";this._constrainDragToTimeSlot=e,this.drag&&(this.drag[t]=e)}},{key:"constrainDragToResource",get:function(){return this._constrainDragToResource},set:function(e){var t=this.client.isHorizontal?"lockY":"lockX";this._constrainDragToResource=e,this.drag&&(this.drag[t]=e)}},{key:"onDragStart",value:function(e){var t=e.context,n=this,r=n.client;n.currentOverClient=r,n.onMouseOverNewTimeline(r,!0);var i=n.dragData=n.getDragData(t);if(t.element.retainElement=!0,n.showTooltip){var o=i.context.dragProxy?i.context.dragProxy.firstChild:t.element;n.tip?n.tip.showBy(o):(n.tip=new kh({id:"".concat(r.id,"-event-drag-tip"),align:"b-t",autoShow:!0,updateContentOnMouseMove:!0,clippedBy:n.constrainDragToTimeline?[r.timeAxisSubGridElement,r.bodyContainer]:null,forElement:o,getHtml:n.getTipHtml.bind(n),style:"pointer-events:none",cls:n.tooltipCls}),n.tip.on("innerhtmlupdate",n.updateDateIndicator,n))}n.triggerDragStart(i);var a=r.features,s=a.eventMenu,l=a.taskMenu,u=a.eventContextMenu,c=a.taskContextMenu,f=s||l||u||c;null==f||f.hideContextMenu(!1)}},{key:"updateDateIndicator",value:function(){var e=this.dragData,t=e.startDate,n=e.endDate,r=this.tip,i=r.element.querySelector(".b-sch-tooltip-enddate");this.clockTemplate.updateDateIndicator(r.element,t),i&&this.clockTemplate.updateDateIndicator(i,n)}},{key:"onDrag",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.dragData,a=o.startDate;if(i.constrainDragToTimeline)t=i.client;else{var s=r.target;if(/^touch/.test(r.type)){var l=Cr.from(o.context.element,null,!0).center;s=mi.elementFromPoint(l.x,l.y)}t=uc.fromElement(s,"timelinebase")}var u=i.client.features.dependencies;if(t){t!==i.currentOverClient&&i.onMouseOverNewTimeline(t),i.updateDragContext(n,r),i.triggerEventDrag(o,a);var c=i.checkDragValidity(o,r);c&&"boolean"!=typeof c&&(n.message=c.message||"",c=c.valid),n.valid=!1!==c,i.showTooltip&&i.tip.realign(),u&&u.updateDependenciesForTimeSpan(o.draggedEntities[0],o.context.element.querySelector(t.eventInnerSelector),o.newResource)}else u&&u.updateDependenciesForTimeSpan(o.draggedEntities[0],o.context.element)}},{key:"onMouseOverNewTimeline",value:function(e,t){var n=this,r=n.drag,i=r.lockX,o=r.lockY,a=[];n.currentOverClient.element.classList.remove("b-dragging-"+n.currentOverClient.scheduledEventName),e.element.classList.add("b-dragging-"+e.scheduledEventName),t||n.currentOverClient.scrollManager.stopMonitoring(),i||a.push({element:e.timeAxisSubGrid.scrollable.element,direction:"horizontal"}),o||a.push({element:e.scrollable.element,direction:"vertical"}),e.scrollManager.startMonitoring({scrollables:a}),n.currentOverClient=e}},{key:"onDrop",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.currentOverClient,a=i.dragData,s=!1;i.updateDragContext(n,r),null===(t=i.tip)||void 0===t||t.hide(),n.valid&&a.startDate&&a.endDate&&(a.finalize=Pt()(At.a.mark((function e(){var t=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.finalize.apply(i,t);case 2:n.finalize.apply(n,t);case 3:case"end":return e.stop()}}),e)}))),o.trigger("before".concat(o.capitalizedEventName,"DropFinalize"),{context:a,event:r}),n.async=a.async,!n.async&&i.isValidDrop(a)&&(s=a.startDate-a.origStart!=0||a.newResource!==a.resourceRecord)),n.async||i.finalize(a.valid&&n.valid&&s)}},{key:"onDragAbort",value:function(e){var t,n=e.context,r=this;r.client.currentOrientation.onDragAbort({context:n,dragData:r.dragData}),r.resumeElementRedrawing(r.dragData.record),null===(t=r.tip)||void 0===t||t.hide(),r.triggerDragAbort(r.dragData)}},{key:"onDragReset",value:function(e){var t,n=e.source,r=this,i=r.currentOverClient;if(null==i||i.scrollManager.stopMonitoring(),n.context&&n.context.started){var o=r.dragData.eventBarEls;o[0].classList.remove("b-drag-main"),o.forEach((function(e){return e.classList.remove("b-dragging")}))}null==i||i.element.classList.remove("b-dragging-"+r.currentOverClient.scheduledEventName),!1===(null===(t=r.dragData)||void 0===t?void 0:t.context.valid)&&null!=i&&i.features.dependencies&&(null==i||i.features.dependencies.scheduleDraw(!0)),r.dragData=null}},{key:"onInternalInvalidDrop",value:function(){var e;null===(e=this.tip)||void 0===e||e.hide(),this.triggerAfterDrop(this.dragData,!1),this.drag.abort()}},{key:"finalize",value:(t=Pt()(At.a.mark((function e(t){var n,r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).dragData,i=r.context,r.draggedEntities.forEach((function(e,t){n.resumeElementRedrawing(e),r.eventBarEls[t].classList.remove(n.drag.draggingCls),r.eventBarEls[t].retainElement=!1})),!t){e.next=11;break}if(o=n.updateRecords(r),!he.isPromise(o)){e.next=8;break}return i.async=!0,e.next=8,o;case 8:r.valid?(n.drag.reset(),n.triggerAfterDrop(r,!0)):n.onInternalInvalidDrop(),e.next=12;break;case 11:n.onInternalInvalidDrop();case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"updateDragContext",value:function(e,t){var n=this,r=n.drag,i=n.dragData,o=n.currentOverClient,a=o.isHorizontal,s=o.features.stickyEvents,l=i.draggedEntities[0],u=l.isAssignment?l.event:l,c=n.constrainDragToTimeSlot||(a?r.lockX:r.lockY);if(i.browserEvent=t,c)i.timeDiff=0;else{if(o.timeAxis.isContinuous){var f=i.dateConstraints,d=o.timeAxisSubGrid.scrollable,h=d.viewport,v=o.isHorizontal?e.pageX-h.x+d.x:e.pageY-h.y+d.y,p=o.timeAxisViewModel.getDateFromPosition(v,null,!0),g=i.timeDiff=p-e.pointerStartDate;i.startDate=n.adjustStartDate(i.origStart,g),f&&(i.startDate=Un.constrain(i.startDate,f.start,new Date(f.end-u.durationMS))),i.endDate=new Date(i.startDate-0+i.duration)}else{var y=n.resolveStartEndDates(e.element);i.valid=Boolean(y.startDate&&y.endDate),i.valid&&(i.startDate=y.startDate,i.endDate=y.endDate)}i.valid&&(i.timeDiff=i.startDate-i.origStart)}if(Object.assign(i,n.getProductDragContext(i)),i.valid)if(i.endDate<=o.timeAxis.startDate||i.startDate>=o.timeAxis.endDate)i.context.valid=!1,i.context.message=n.L("L{EventDrag.noDropOutsideTimeline}");else{var m=!t||n.checkDragValidity(i,t);m&&"boolean"!=typeof m?(i.context.valid=!1!==m.valid,i.context.message=m.message):(i.context.valid=!1!==m,i.context.message="")}else i.context.valid=!1;i.context.valid&&s&&i.eventBarEls.forEach((function(e,t){return s.onEventDrag(e)}))}},{key:"suspendElementRedrawing",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getRecordElement(e);n&&(n.retainElement=t),e.instanceMeta(this.client).retainElement=t}},{key:"resumeElementRedrawing",value:function(e){this.suspendElementRedrawing(e,!1)}},{key:"getDragData",value:function(e){var t=this,n=t.client,r=t.drag,i=t.setupProductDragData(e),o=i.record,a=i.dateConstraints,s=i.eventBarEls,l=i.draggedEntities,u=r.startEvent,c=o.isAssignment?o.event:o,f=c.startDate,d=c.endDate,h=n.timeAxis,v=f<h.startDate,p=d>h.endDate,g=t.getCoordinate(c,e.element,[e.elementStartX,e.elementStartY]),y=t.getCoordinate(c,e.element,[e.startClientX,e.startClientY]);l.forEach((function(e){return t.suspendElementRedrawing(e)})),o.isAssignment?n.selectAssignment(o,u.ctrlKey):n.selectEvent(o,u.ctrlKey);var m={context:e,dateConstraints:a,eventBarEls:s,record:o,draggedEntities:l,sourceDate:v?f:n.getDateFromCoordinate(g),screenSourceDate:n.getDateFromCoordinate(y,null,!1),startDate:f,endDate:d,timeDiff:0,origStart:f,origEnd:d,startsOutsideView:v,endsOutsideView:p,duration:d-f,browserEvent:u};if(s.forEach((function(e){e.classList.add(r.draggingCls),e.classList.remove("b-sch-event-hover"),e.classList.remove("b-active")})),s.length>1)if(t.constrainDragToTimeline?e.relatedElements=s.slice(1):e.relatedElements=s.slice(1).map((function(e){var t=mi.getOffsetX(e,r.dragWithin),n=mi.getOffsetY(e,r.dragWithin),i=e.offsetWidth,o=e.offsetHeight,a=r.createProxy(e);return mi.setTranslateXY(a,t,n),a.style.width="".concat(i,"px"),a.style.height="".concat(o,"px"),r.dragWithin.appendChild(a),e.classList.add("b-drag-original"),r.hideOriginalElement&&e.classList.add("b-hidden"),a})),e.relatedElStartPos=[],e.relatedElDragFromPos=[],t.unifiedDrag){t.client.isAnimating=!0,s.forEach((function(e){e.classList.add("b-drag-animation")})),Tu.onTransitionEnd({element:s[1],property:"transform",handler:function(){t.client.isAnimating=!1,s.forEach((function(e){e.classList.remove("b-drag-animation")}))},thisObj:t.client,once:!0}),s[0].classList.add("b-drag-main");var b=mi.getTranslateXY(e.element),k=N()(b,2),w=k[0],C=k[1];e.relatedElements.forEach((function(t,n){e.relatedElStartPos[n]=mi.getTranslateXY(t),w+=10,C+=10,mi.setTranslateXY(t,w,C),e.relatedElDragFromPos[n]=[w,C]}))}else e.relatedElements.forEach((function(t,n){e.relatedElStartPos[n]=e.relatedElDragFromPos[n]=mi.getTranslateXY(t)}));return m}},{key:"setupConstraints",value:function(e,t,n,r){var i=this,o=!i.showExactDropPosition&&n>1?n:0;r?i.setXConstraint(e.left,e.right-t.width,o):i.setXConstraint(!0,!0,o),i.setYConstraint(e.top,e.bottom-t.height,0)}},{key:"updateYConstraint",value:function(e){var t=this,n=t.client,r=t.drag.context,i=n.timeAxisViewModel.snapPixelAmount;if(r&&!t.drag.lockY){var o;if(!t.constrainDragToTimeline)return void t.setYConstraint(null,null,i);o=n.getScheduleRegion(null,e),t.setYConstraint(o.top,o.bottom-r.element.offsetHeight,i)}else t.setYConstraint(null,null,i)}},{key:"setXConstraint",value:function(e,t,n){var r=this.drag;r.leftConstraint=e,r.rightConstraint=t,r.minX=e,r.maxX=t}},{key:"setYConstraint",value:function(e,t,n){var r=this.drag;r.topConstraint=e,r.bottomConstraint=t,r.minY=e,r.maxY=t}},{key:"adjustStartDate",value:function(e,t){return this.client.timeAxis.roundDate(new Date(e-0+t),!!this.client.snapRelativeToEventStartDate&&e)}},{key:"resolveStartEndDates",value:function(e){var t=this.currentOverClient,n=t.timeAxis,r=Cr.from(e,t.timeAxisSubGridElement),i=this.dragData,o=t.getStartEndDatesFromRectangle(r,"round",i.duration,!n.isContinuous),a=o.start,s=o.end;if(a&&s)if(a=this.adjustStartDate(a,0),i.startsOutsideView)i.endsOutsideView||(a=s&&Un.add(s,-i.duration,"ms"));else{if(!t.timeAxis.dateInAxis(a,!1)){var l=t.timeAxis.getTickFromDate(a);l>=0&&(a=t.timeAxis.getDateFromTick(l))}s=a&&Un.add(a,i.duration,"ms")}return{startDate:a,endDate:s}}},{key:"getTipHtml",value:function(){var e,t=this,n=t.dragData,r=t.client,i=n.startDate,o=n.endDate,a=n.draggedEntities,s=r.getFormattedDate(i),l=r.getFormattedEndDate(o,i),u=n.context,c=u.valid,f=u.message,d=a[0],h=d.isTask?d:d.event;return(t.tooltipTemplate||t.dragTipTemplate)((e={valid:c,startDate:i,endDate:o,startText:s,endText:l,dragData:n,message:f||""},Qe()(e,r.scheduledEventName+"Record",h),Qe()(e,"startClockHtml",t.clockTemplate.template({date:i,text:s,cls:"b-sch-tooltip-startdate"})),Qe()(e,"endClockHtml",h.isMilestone?"":t.clockTemplate.template({date:o,text:l,cls:"b-sch-tooltip-enddate"})),e))}},{key:"getElementFromContext",value:function(e){return e.grabbed||e.dragProxy||e.element}},{key:"getRelatedRecords",value:function(e){return[]}},{key:"getMinimalDragData",value:function(e,t){return{}}},{key:"isValidDrop",value:function(e){throw new Error("Implement in subclass")}},{key:"checkDragValidity",value:function(e){throw new Error("Implement in subclass")}},{key:"updateRecords",value:function(e){throw new Error("Implement in subclass")}},{key:"isElementDraggable",value:function(e,t){throw new Error("Implement in subclass")}},{key:"getCoordinate",value:function(e,t,n){throw new Error("Implement in subclass")}},{key:"setupProductDragData",value:function(e){throw new Error("Implement in subclass")}},{key:"getProductDragContext",value:function(e){throw new Error("Implement in subclass")}},{key:"getRecordElement",value:function(e){throw new Error("Implement in subclass")}}],[{key:"defaultConfig",get:function(){return{tooltipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")},constrainDragToResource:!0,showTooltip:!0,showExactDropPosition:!1,constrainDragToTimeline:!0,store:null,dragHelperConfig:null,tooltipCls:null}}},{key:"pluginConfig",get:function(){return{chain:["onPaint"]}}}]),r}(_i);function $x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ux(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$x(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Wx._$name="DragBase";var Yx={top:"b-t",right:"b100-t100",bottom:"t-b",left:"b100-t100"},qx=function(e){Ye()(o,e);var t,n,r,i=Gx(o);function o(){return B()(this,o),i.apply(this,arguments)}return _()(o,[{key:"render",value:function(){var e=this,t=e.client;e.dragSelector=e.dragItemSelector=t.eventSelector,e.dragRootElement=e.dropRootElement=t.timeAxisSubGridElement,e.handleSelector||pe.a.isHoverableDevice||(e.handleSize=e.touchHandleSize),e.handleVisibilityThreshold=e.handleVisibilityThreshold||2*e.handleSize,e.dragLock=t.isVertical?"y":"x"}},{key:"onEventDataGenerated",value:function(e){var t,n=e.eventRecord,r=e.wrapperCls,i=e.cls;this.dragging&&n===(null===(t=this.dragging.context)||void 0===t?void 0:t.eventRecord)&&(r["b-active"]=1,r[this.draggingItemCls]=1,r["b-over-resize-handle"]=1,i["b-resize-handle"]=1,i[this.resizingItemInnerCls]=1)}},{key:"onDragPointerMove",value:function(e){var t,n=this.client,r=this.dragging,i=n.visibleDateRange,a=n.isHorizontal,s=e["page".concat(a?"X":"Y")]+((null===(t=r.context)||void 0===t?void 0:t.offset)||0),l=n.timeAxisSubGridElement.getBoundingClientRect(),u=a?[l.left,l.right]:[l.top,l.bottom],c=N()(u,2),f=c[0],d=c[1];r.date=s<f?i.startDate:s>d?i.endDate:n.getDateFromCoordinate(s,null,!1),tt()(Ze()(o.prototype),"onDragPointerMove",this).call(this,e)}},{key:"beforeDrag",value:function(e){var t=this.client;return!this.disabled&&!t.readOnly&&!1!==tt()(Ze()(o.prototype),"beforeDrag",this).call(this,e)&&(e.mousedownDate=e.date=t.getDateFromCoordinate(e.event["page".concat(t.isHorizontal?"X":"Y")],null,!1),this.triggerBeforeResize(e))}},{key:"dragStart",value:function(e){var t,n,r=this,i=r.client,o=r.tip,a=i.scheduledEventName,s=i.resolveEventRecord(e.itemElement),l=s.isBatchUpdating,u=l?s.get("startDate"):s.startDate,c=l?s.get("endDate"):s.endDate,f="x"===r.dragLock,d=r.isOverEndHandle(e.startEvent,e.itemElement),h=d?"endDate":"startDate",v=d?"startDate":"endDate",p=d?"setEndDate":"setStartDate",g=d?"setStartDate":"setEndDate",y=e.itemElement,m=y.getBoundingClientRect(),b=f?e.startEvent.clientX:e.startEvent.clientY,k=d?f?m.right:m.bottom:f?m.left:m.top,w=i.resolveTimeSpanRecord(y),C=e.context={eventRecord:s,timespanRecord:w,element:y,taskRecord:s,owner:r,valid:!0,oldValue:d?c:u,startDate:u,endDate:c,offset:k-b,edge:f?d?"right":"left":d?"bottom":"top",finalize:r.finalize,event:e.event,draggingEnd:d,toSet:h,otherEnd:v,setMethod:p,setOtherMethod:g};s.meta.isResizing=!0,i.element.classList.add(r.dragActiveCls),i.listenToBatchedUpdates||i.beginListeningForBatchedUpdates(),l||s.beginBatch(),r.setupProductResizeContext(C,e.startEvent),r.triggerEventResizeStart("".concat(a,"ResizeStart"),Ux((t={},Qe()(t,"".concat(a,"Record"),s),Qe()(t,"event",e.startEvent),t),r.getResizeStartParams(C))),C.resizedRecord=(null===(n=i.resolveAssignmentRecord)||void 0===n?void 0:n.call(i,C.element))||s,o&&(o.show(),o.align=Yx[e.context.edge],o.showBy(r.getTooltipTarget(e)))}},{key:"triggerBeforeResize",value:function(e){var t,n=this.client,r=n.scheduledEventName,i=n.resolveTimeSpanRecord(e.itemElement);return n.trigger("before".concat(n.capitalizedEventName,"Resize"),Ux((t={},Qe()(t,r+"Record",i),Qe()(t,"event",e.event),t),this.getBeforeResizeParams({event:e.startEvent,element:e.itemElement})))}},{key:"triggerEventResizeStart",value:function(e,t){this.client.trigger(e,t)}},{key:"dragEnter",value:function(e){return e.context.owner===this}},{key:"moveDrag",value:function(e){var t=this.client,n=this.tip,r=t.isHorizontal?"X":"Y",i=t.scheduledEventName,a=t.features.dependencies,s=t.visibleDateRange,l=t.enableEventAnimations,u=t.timeAxis,c=e.event,f=e.context,d=f.eventRecord,h=f.offset,v=d.isOccurrence,p=d.get("startDate"),g=d.get("endDate"),y="x"===this.dragLock,m=c["client".concat(r)]+h,b=t.timeAxisSubGridElement.getBoundingClientRect(),k=y?[b.left,b.right]:[b.top,b.bottom],w=N()(k,2),C=w[0],R=w[1];f.event=c,c.isScroll&&(e.date=t.getDateFromCoordinate(c["page".concat(r)]+h,null,!1));var S,x,E,D=f.toSet,T=f.otherEnd,O=f.draggingEnd;if(S=m<C?e.date=s.startDate:m>R?e.date=s.endDate:e.date,"endDate"===D?S<p&&(x=-1):S>g&&(x=1),x&&this.onDragEndSwitch&&(this.onDragEndSwitch(f,S,x),T=f.otherEnd,O=f.draggingEnd,D=f.toSet),t.snapRelativeToEventStartDate&&(S=u.roundDate(S,f.oldValue)),f.snappedDate=Un.round(S,u.resolution),Un.diff(O?f[T]:S,O?S:f[T],t.timeAxis.resolutionUnit)<t.timeAxis.resolutionIncrement)if(this.allowResizeToZero)f.snappedDate=S=f[T];else{var M="startDate"===T?1:-1;f.snappedDate=S=Un.add(d.get(T),t.timeAxis.resolutionIncrement*M,t.timeAxis.resolutionUnit),E=!0}if(f.dateConstraints&&(S=Un.constrain(S,f.dateConstraints.start,f.dateConstraints.end),f.snappedDate=Un.constrain(f.snappedDate,f.dateConstraints.start,f.dateConstraints.end)),!f.date||S-f.date||E){if(f.date=S,f[D]=this.showExactResizePosition||t.timeAxisViewModel.snap?f.snappedDate:S,!(f[D]-f["startDate"===D?"endDate":"startDate"]||this.allowResizeToZero))return void(f.valid=!1);if(d.get(D)-f[D]&&(f.valid=this.checkValidity(f,c),f.message="",f.valid&&"boolean"!=typeof f.valid&&(f.message=f.valid.message,f.valid=f.valid.valid),f.valid=!1!==f.valid,f.valid)){var A,I=(A={},Qe()(A,"".concat(i,"Record"),d),Qe()(A,"startDate",p),Qe()(A,"endDate",g),Qe()(A,"element",e.itemElement),Qe()(A,"context",f),A);I[D]=f[D],t.trigger("".concat(i,"PartialResize"),I),v&&d.stores.push(t.eventStore),t.enableEventAnimations=!1,d.set(D,f[D]),t.enableEventAnimations=l,v&&(d.stores.length=0),a&&!a.isDisabled&&a.updateDependenciesForTimeSpan(d,e.itemElement)}}n&&(n.align=Yx[e.context.edge],n.alignTo(this.getTooltipTarget(e))),tt()(Ze()(o.prototype),"moveDrag",this).call(this,e)}},{key:"dragEnd",value:function(e){var t=e.context;t&&(t.event=e.event),e.aborted?null==t||t.finalize(!1):this.isEventDragCreate||e.started||Tu.getPagePoint(e.event).equals(Tu.getPagePoint(e.startEvent))||(this.dragStart(e),this.cleanup(e.context,!1))}},{key:"dragDrop",value:(r=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.context,r=t.event,n[n.toSet]=n.snappedDate,i=this.client,o=n.startDate,a=n.endDate,this.tip.hide(),n.valid=o&&a&&(this.allowResizeToZero||a-o>0)&&n[n.toSet]-n.oldValue&&!1!==n.valid,n.valid&&(i.trigger("before".concat(i.capitalizedEventName,"ResizeFinalize"),{context:n,event:r}),s=!0),n.async){e.next=9;break}return e.next=9,n.finalize(s);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"finalize",value:(n=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s,l,u,c;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.owner,i=(r=this).eventRecord,o=r.oldValue,a=r.toSet,s=n.client,l=s.snapRelativeToEventStartDate,u=s.timeAxis,c=!1,!t){e.next=9;break}return l&&(r[a]=r.snappedDate=u.roundDate(r.date,o)),e.next=6,n.internalUpdateRecord(r,i);case 6:c=e.sent,e.next=10;break;case 9:i.cancelBatch();case 10:n.cleanup(r,c);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"cleanup",value:function(e,t){var n,r=this,i=r.client,o=e.element,a=e.eventRecord,s=i.features.dependencies,l=i.scheduledEventName;a.meta.isResizing=!1,i.endListeningForBatchedUpdates(),null===(n=r.tip)||void 0===n||n.hide(),r.unHighlightHandle(o),i.element.classList.remove(r.dragActiveCls),s&&(s.scheduleDraw(!0),t&&s.showTerminals(a,o)),i.trigger("".concat(l,"ResizeEnd"),Ux(Qe()({changed:t},"".concat(l,"Record"),a),r.getResizeEndParams(e)))}},{key:"internalUpdateRecord",value:(t=Pt()(At.a.mark((function e(t,n){var r,i,o,a,s,l;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.client,i=n.generation,!n.isOccurrence){e.next=7;break}r.endListeningForBatchedUpdates(),n[n.batching>1?"endBatch":"cancelBatch"](),n.set(KC.prototype.inSetNormalize.call(n,{startDate:t.startDate,endDate:t.endDate})),e.next=25;break;case 7:if(o=Qe()({},t.toSet,t[t.toSet]),!n.isEntity){e.next=22;break}return a=t.startDate,s=t.endDate,l=t.draggingEnd,t.duration=o.duration=Un.diff(a,s,n.durationUnit),t.duration=o.duration=n.run("calculateProjectedDuration",a,s),o[t.toSet]=n.run("calculateProjectedXDateWithDuration",l?a:s,l,t.duration),o[t.otherEnd]=t[t.otherEnd],n.set(o),r.endListeningForBatchedUpdates(),n.cancelBatch(),e.next=19,Promise.all([n[t.setOtherMethod](o[t.otherEnd],!1),n[t.setMethod](o[t.toSet],!1),n.setDuration(t.duration)]);case 19:n.endBatch(),e.next=25;break;case 22:r.endListeningForBatchedUpdates(),n.cancelBatch(),n[t.setMethod](o[t.toSet],!1);case 25:return e.abrupt("return",n.generation!==i);case 26:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"onDragItemMouseMove",value:function(e){"touch"===e.pointerType||this.handleSelector||this.checkResizeHandles(e)}},{key:"checkResizeHandles",value:function(e){var t=this,n=t.overItem;if(n&&(!t.allowResize||t.allowResize(n,e))){("x"===t.dragLock?t.isOverLeftHandle(e,n)||t.isOverRightHandle(e,n):t.isOverTopHandle(e,n)||t.isOverBottomHandle(e,n))?t.highlightHandle():t.unHighlightHandle()}}},{key:"onDragItemMouseLeave",value:function(e,t){this.unHighlightHandle(t)}},{key:"highlightHandle",value:function(){var e=this;e.overItem.querySelector(e.client.eventInnerSelector).classList.add("b-resize-handle"),e.overItem.classList.add("b-over-resize-handle")}},{key:"unHighlightHandle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.overItem;if(e){var t=e.querySelector(this.client.eventInnerSelector);t.classList.remove("b-resize-handle"),t.classList.remove(this.resizingItemInnerCls),e.classList.remove("b-over-resize-handle"),e.classList.remove(this.draggingItemCls)}}},{key:"isOverAnyHandle",value:function(e,t){return this.isOverStartHandle(e,t)||this.isOverEndHandle(e,t)}},{key:"isOverStartHandle",value:function(e,t){return"x"===this.dragLock?this.isOverLeftHandle(e,t):this.isOverTopHandle(e,t)}},{key:"isOverEndHandle",value:function(e,t){return"x"===this.dragLock?this.isOverRightHandle(e,t):this.isOverBottomHandle(e,t)}},{key:"getDynamicHandleSize",value:function(e,t){var n=e?2:1,r=this.handleSize;return this.dynamicHandleSize&&r*n>t-this.reservedSpace?Math.max(Math.floor((t-this.reservedSpace)/n),0):r}},{key:"isOverLeftHandle",value:function(e,t){var n=this,r=t.offsetWidth,i=n.client.resolveTimeSpanRecord(t),o=null==i?void 0:i.isResizable;if(!n.disabled&&n.leftHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)&&(!0===o||"start"===o)){var a=Cr.from(t);return a.width=n.getDynamicHandleSize(n.rightHandle,r),a.width>0&&a.contains(Tu.getPagePoint(e))}return!1}},{key:"isOverRightHandle",value:function(e,t){var n=this,r=t.offsetWidth,i=n.client.resolveTimeSpanRecord(t),o=null==i?void 0:i.isResizable;if(!n.disabled&&n.rightHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)&&(!0===o||"end"===o)){var a=Cr.from(t);return a.x=Math.floor(a.right-n.getDynamicHandleSize(n.leftHandle,r)),a.width>0&&a.contains(Tu.getPagePoint(e))}return!1}},{key:"isOverTopHandle",value:function(e,t){var n=this,r=t.offsetHeight,i=n.client.resolveTimeSpanRecord(t),o=null==i?void 0:i.isResizable;if(!n.disabled&&n.topHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)&&(!0===o||"start"===o)){var a=Cr.from(t);return a.height=n.getDynamicHandleSize(n.bottomHandle,r),a.height>0&&a.contains(Tu.getPagePoint(e))}return!1}},{key:"isOverBottomHandle",value:function(e,t){var n=this,r=t.offsetHeight,i=n.client.resolveTimeSpanRecord(t),o=null==i?void 0:i.isResizable;if(!n.disabled&&n.bottomHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)&&(!0===o||"end"===o)){var a=Cr.from(t);return a.y=Math.floor(a.bottom-n.getDynamicHandleSize(n.bottomHandle,r)),a.height>0&&a.contains(Tu.getPagePoint(e))}return!1}},{key:"setupDragContext",value:function(e){var t=this;if(t.overItem&&t.isOverAnyHandle(e,t.overItem)&&t.isElementResizable(t.overItem,e)){var n=tt()(Ze()(o.prototype),"setupDragContext",this).call(this,e);return n.scrollManager=t.client.scrollManager,n}}},{key:"changeTip",value:function(e,t){var n=this;if(e)e.isTooltip?e.owner=n:e=kh.reconfigure(t,kh.mergeConfigs({id:"".concat(n.client.id,"-event-resize-tip")},e,{getHtml:n.getTipHtml.bind(n),owner:n.client},n.tip),{owner:n,defaults:{type:"tooltip"}}),e.on({innerhtmlupdate:"updateDateIndicator",thisObj:n}),n.clockTemplate=new Hx({scheduler:n.client});else if(t){var r;t.destroy(),null===(r=n.clockTemplate)||void 0===r||r.destroy()}return e}},{key:"isElementResizable",value:function(e,t){var n=this,r=n.client,i=r.resolveTimeSpanRecord(e);if(r.readOnly)return!1;var o=i&&i.isResizable,a=(e=mi.up(t.target,r.eventSelector))?e.firstElementChild:e,s=t.target.closest('[class$="-handle"]');if(!o||s&&s!==a)return!1;var l=e.classList.contains("b-sch-event-startsoutside"),u=e.classList.contains("b-sch-event-endsoutside");if(!0===o){if(l&&u)return!1;if(l)o="end";else{if(!u)return n.isOverStartHandle(t,e)||n.isOverEndHandle(t,e);o="start"}}return!(l&&"start"===o||u&&"end"===o)&&!!(n.isOverStartHandle(t,e)&&"start"===o||n.isOverEndHandle(t,e)&&"end"===o)}},{key:"updateDateIndicator",value:function(){var e=this.clockTemplate,t=this.dragging.context,n=t.eventRecord,r=t.draggingEnd,i=t.snappedDate,o=r?n.get("startDate"):i,a=r?i:n.get("endDate"),s=this.tip.element;e.updateDateIndicator(s.querySelector(".b-sch-tooltip-startdate"),o),e.updateDateIndicator(s.querySelector(".b-sch-tooltip-enddate"),a)}},{key:"getTooltipTarget",value:function(e){var t=this,n=Cr.from(e.itemElement,null,!0);return"x"===t.dragLock?("right"===e.context.edge&&(n.x=n.right-1),n.width=t.tip.anchorSize[0]/2):("bottom"===e.context.edge&&(n.y=n.bottom-1),n.height=t.tip.anchorSize[1]/2),{target:n}}},{key:"basicValidityCheck",value:function(e,t){return e.startDate&&(e.endDate>e.startDate||this.allowResizeToZero)&&this.validatorFn.call(this.validatorFnThisObj||this,e,t)}},{key:"getTipHtml",value:function(e){var t=e.tip,n=this,r=n.dragging.context,i=r.startDate,o=r.endDate,a=r.toSet,s=r.snappedDate,l=r.valid,u=r.message,c=void 0===u?"":u,f=r.timespanRecord;if(!i||!o)return t.html;var d=Qe()({record:f,valid:l,message:c,startDate:i,endDate:o},a,s);return d.startText=n.client.getFormattedDate(d.startDate),d.endText=n.client.getFormattedDate(d.endDate),d.startClockHtml=n.clockTemplate.template({date:d.startDate,text:d.startText,cls:"b-sch-tooltip-startdate"}),d.endClockHtml=n.clockTemplate.template({date:d.endDate,text:d.endText,cls:"b-sch-tooltip-enddate"}),n.tooltipTemplate(d)}},{key:"getBeforeResizeParams",value:function(e){var t=this.client;return{resourceRecord:t.resolveResourceRecord(t.isVertical?e.event:e.element)}}},{key:"getResizeStartParams",value:function(e){return{resourceRecord:e.resourceRecord}}},{key:"getResizeEndParams",value:function(e){return{resourceRecord:e.resourceRecord,event:e.event}}},{key:"setupProductResizeContext",value:function(e,t){var n,r,i=this.client,o=e.element,a=i.resolveEventRecord(o),s=null===(n=i.resolveResourceRecord)||void 0===n?void 0:n.call(i,o),l=null===(r=i.resolveAssignmentRecord)||void 0===r?void 0:r.call(i,o);Object.assign(e,{eventRecord:a,taskRecord:a,resourceRecord:s,assignmentRecord:l,dateConstraints:i.getDateConstraints(s,a)})}},{key:"checkValidity",value:function(e,t){return(this.client.allowOverlap||this.client.isDateRangeAvailable(e.startDate,e.endDate,e.eventRecord,e.resourceRecord))&&this.basicValidityCheck(e,t)}}],[{key:"$name",get:function(){return"EventResize"}},{key:"configurable",get:function(){return{draggingItemCls:"b-sch-event-wrap-resizing",resizingItemInnerCls:"b-sch-event-resizing",leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSize:10,dynamicHandleSize:!0,allowResizeToZero:null,reservedSpace:5,touchHandleSize:30,dragThreshold:0,dragTouchStartDelay:0,draggingClsSelector:".b-timeline-base",showExactResizePosition:!1,validatorFn:function(){return!0},validatorFnThisObj:null,tip:{$config:["lazy","nullify"],value:{autoShow:!1,axisLock:!0,trackMouse:!1,updateContentOnMouseMove:!0,hideDelay:0}},tooltipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")},dragActiveCls:"b-resizing-event"}}},{key:"pluginConfig",get:function(){return{chain:["render","onEventDataGenerated"]}}}]),o}(_i.mixin(Gd,qd));function Kx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}qx._$name="EventResize",ty.registerFeature(qx,!0,"Scheduler"),ty.registerFeature(qx,!1,"ResourceHistogram");var Xx=function(e){var t,n;return(null===(t=this.source)||void 0===t||null===(n=t.client.features.taskEdit)||void 0===n||!n._canceling)&&Tu.getDistanceBetween(this.startEvent,e)},Zx=function(e){Ye()(o,e);var t,n,r,i=Kx(o);function o(){return B()(this,o),i.apply(this,arguments)}return _()(o,[{key:"changeValidatorFn",value:function(e){this.createValidatorFn=e}},{key:"render",value:function(){var e=this,t=e.client;e.dragRootElement=e.dropRootElement=t.timeAxisSubGridElement,e.dragLock=t.isVertical?"y":"x"}},{key:"onDragEndSwitch",value:function(e){var t=this.client,n=t.enableEventAnimations,r=t.timeAxis,i=e.eventRecord,o=e.draggingEnd,a="x"===this.dragLock,s=this.dragging.mousedownDate;t.enableEventAnimations=!1,o?(i.set("endDate",e.endDate=Un.ceil(s,r.resolution),!0),e.toSet="startDate",e.otherEnd="endDate",e.setMethod="setStartDate",e.edge=a?"left":"top"):(i.set("startDate",e.startDate=Un.floor(s,r.resolution),!0),e.toSet="endDate",e.otherEnd="startDate",e.setMethod="setEndDate",e.edge=a?"right":"bottom"),e.draggingEnd=this.draggingEnd=!o,t.enableEventAnimations=n}},{key:"beforeDrag",value:function(e){var t=tt()(Ze()(o.prototype),"beforeDrag",this).call(this,e);return(!1===t||!(this.preventMultiple&&!this.isRowEmpty(e.rowRecord)||this.disabled))&&t}},{key:"startDrag",value:function(e){var t=tt()(Ze()(o.prototype),"startDrag",this).call(this,e);return!1!==t&&(this.client.trigger("dragCreateStart",{proxyElement:e.element}),e.context.offset=0,e.context.oldValue=e.mousedownDate),t}},{key:"isOverEndHandle",value:function(){return this.draggingEnd}},{key:"setupDragContext",value:function(e){var t,n,r=this.client;if(null!==(t=(n=e.target).closest)&&void 0!==t&&t.call(n,".".concat(r.timeAxisColumn.cellCls))){var i=r.resolveResourceRecord(e);if(i&&!i.isSpecialRow){var o=Gd().prototype.setupDragContext.call(this,e),a=[];return r.isVertical?a.push({element:r.scrollable.element,direction:"vertical"}):a.push({element:r.timeAxisSubGrid.scrollable.element,direction:"horizontal"}),o.scrollManager=r.scrollManager,o.monitoringConfig={scrollables:a},o.resourceRecord=o.rowRecord=i,o.getDistance=Xx,o}}}},{key:"dragDrop",value:(r=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s,l;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.context,i=t.event,r[r.toSet]=r.snappedDate,o=this.client,a=r.startDate,s=r.endDate,null===(n=this.tip)||void 0===n||n.hide(),r.valid=a&&s&&s-a>0&&r[r.toSet]-r.oldValue&&!1!==r.valid,r.valid&&(o.trigger("beforeDragCreateFinalize",{context:r,event:i,proxyElement:r.element}),l=!0),r.async){e.next=9;break}return e.next=9,r.finalize(l);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updateDragTolerance",value:function(e){this.dragThreshold=e}},{key:"changeTip",value:function(e,t){return tt()(Ze()(o.prototype),"changeTip",this).call(this,!e||e.isTooltip?e:Qn.assign({id:"".concat(this.client.id,"-drag-create-tip")},e),t)}},{key:"finalize",value:(n=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.owner,i=(r=this).eventRecord,o=function(){n.client.trigger("afterDragCreate",{proxyElement:r.element}),n.cleanup(r)},!t){e.next=7;break}return e.next=4,n.finalizeDragCreate(r);case 4:o(),e.next=10;break;case 7:null===(a=(s=n.store).unassignEventFromResource)||void 0===a||a.call(s,i,r.resourceRecord),n.store.remove(i),o();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"finalizeDragCreate",value:(t=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalUpdateRecord(t,t.eventRecord);case 2:this.client.trigger("dragCreateEnd",{eventRecord:t.eventRecord,newEventRecord:t.eventRecord,resourceRecord:t.resourceRecord,event:t.event,eventElement:t.element,proxyElement:t.element});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"cleanup",value:function(e){var t,n=this.client;e.eventRecord.meta.isResizing=!1,n.endListeningForBatchedUpdates(),null===(t=this.tip)||void 0===t||t.hide(),n.element.classList.remove(this.dragActiveCls)}},{key:"onElementContextMenu",value:function(){if(this.proxy)return!1}},{key:"prepareCreateContextForFinalization",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.assign({},e,{async:r,event:t,finalize:n})}},{key:"triggerBeforeResize",value:function(){}},{key:"triggerEventResizeStart",value:function(){}},{key:"checkValidity",value:function(e,t){throw new Error("Implement in subclass")}},{key:"triggerDragCreateEnd",value:function(e,t){throw new Error("Implement in subclass")}},{key:"handleBeforeDragCreate",value:function(e,t){throw new Error("Implement in subclass")}},{key:"isRowEmpty",value:function(e){throw new Error("Implement in subclass")}}],[{key:"configurable",get:function(){return{showTooltip:!0,dragTolerance:2,preventMultiple:!1,validatorFnThisObj:null,proxyCls:"b-sch-dragcreator-proxy",tipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")},dragActiveCls:"b-dragcreating"}}},{key:"pluginConfig",get:function(){return{chain:["render"],before:["onElementContextMenu"]}}}]),o}(qx);function Jx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jx(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jx(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eE(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return tE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tE(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function tE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Zx._$name="DragCreateBase";var rE=Un,iE=function(e){if(1===e.length)return e[0].value;if(2===e.length){var t=e[0]instanceof $v?e:e.reverse(),n=N()(t,2),r=n[0],i=n[1],o=rE.parse(r.value);return o&&o.setHours(i.value.getHours(),i.value.getMinutes(),i.value.getSeconds(),i.value.getMilliseconds()),o?Un.clone(o):null}return null},oE=function(e,t,n){if(e&&t&&n.endDateField&&n.endTimeField){var r=rE.add((i=n.startDateField.value,o=n.startTimeField.value,(a=new Date(i.getTime())).setHours(o.getHours(),o.getMinutes()),a),n.eventRecord.durationMS,"milliseconds");n.endDateField.value=r,n.endTimeField.value=rE.clone(r)}var i,o,a},aE=function(e){Ye()(o,e);var t,n,r,i=nE(o);function o(){return B()(this,o),i.apply(this,arguments)}return _()(o,[{key:"construct",value:function(e,t){var n,r=this;e.eventEdit=r,tt()(Ze()(o.prototype),"construct",this).call(this,e,Qn.assign({weekStartDay:e.weekStartDay},t)),r.clientListenersDetacher=e.on((n={},Qe()(n,r.triggerEvent,"onActivateEditor"),Qe()(n,"dragCreatEend","onDragCreateEnd"),Qe()(n,"eventAutoCreated","onEventAutoCreated"),Qe()(n,"thisObj",r),n))}},{key:"doDestroy",value:function(){var e;this.clientListenersDetacher(),null===(e=this.editor)||void 0===e||e.destroy(),tt()(Ze()(o.prototype),"doDestroy",this).call(this)}},{key:"changeEditorConfig",value:function(e){var t=this.items;return this.extraItems?(e=he.clone(e),e=this.insertExtraWidgetsIntoDefaultWidgets(e)):t&&((e=he.clone(e)).items=De.merge(t,e.items)),e}},{key:"insertExtraWidgetsIntoDefaultWidgets",value:function(e){z.a.deprecate("Scheduler","5.0.0","extraItems replaced by items in EditFeature.");var t=this.extraItems,n=e.items,r=Array.isArray(t)?t:t&&Object.values(t);if(!t||!Object.keys(r).length)return e;if(Object.values(r).some((function(e){return"index"in e}))){var i=Array.isArray(t)?t:t&&Qn.transformNamedObjectToArray(t);z.a.deprecate("Scheduler","5.0.0","index in extraItems replaced by weight to sort editor items");var o,a=Qn.transformNamedObjectToArray(n),s=a[a.length-1],l=a.findIndex((function(e){return"extraItems"===e.type}));l>-1&&(a.splice(l,1),o=a.splice(l));var u=i.filter((function(e){return e.index>=0})),c=i.filter((function(e){return!(e.index>=0)}));c.forEach((function(e,t){return e.weight=s.weight+100*t})),a=a.concat(c),u.sort((function(e,t){return e.index-t.index})),u.forEach((function(e){var t=a[Math.min(e.index,a.length)-1];e.weight=t?t.weight+1:-100,a.splice(e.index,0,e)})),o&&o.length&&(a=a.concat(o)),e.items=Qn.transformArrayToNamedObject(a)}else{var f,d=900,h=eE(Array.isArray(t)?t:Object.values(t));try{for(h.s();!(f=h.n()).done;){var v=f.value;v.ref||(v.ref=v.id),v.weight=d+=100}}catch(e){h.e(e)}finally{h.f()}e.items=Qx(Qx({},n),Array.isArray(t)?Qn.transformArrayToNamedObject(t):t)}return e}},{key:"onDatesChange",value:function(e){var t,n,r=this,i=e.source,o=e.value;switch(i.ref){case"startDateField":r.startTimeField&&oE(o,r.startTimeField.value,r);break;case"startTimeField":r.startDateField&&oE(r.startDateField.value,o,r)}(r.startDateField&&r.endDateField&&(r.endDateField.min=r.startDateField.value),r.endTimeField)&&(rE.isEqual(rE.clearTime(null===(t=r.startDateField)||void 0===t?void 0:t.value),rE.clearTime(null===(n=r.endDateField)||void 0===n?void 0:n.value))?r.endTimeField.min=r.startTimeField.value:r.endTimeField.min=null)}},{key:"save",value:(r=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Implement in subclass");case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"isValid",get:function(){return Object.values(this.editor.widgetMap).every((function(e){return!(e.name&&!e.hidden)||!1!==e.isValid}))}},{key:"values",get:function(){var e=this,t=e.editor,n=[],r=[],i={};return t.eachWidget((function(o){var a,s=o.name;if(s&&!o.hidden&&!o.up((function(t){return t===e.recurrenceEditor})))switch(s){case"startDate":n.push(o);break;case"endDate":r.push(o);break;case"resource":i[s]=o.record;break;case"recurrenceRule":i[s]="none"===(null===(a=t.widgetMap.recurrenceCombo)||void 0===a?void 0:a.value)?"":o.value;break;default:i[s]=o.value}}),!0),i.allDay&&!e.eventRecord.allDay&&(n.push(e.startTimeField),r.push(e.endTimeField)),n.length&&(i.startDate=iE(n)),r.length&&(i.endDate=iE(r)),"startDate"in i&&"endDate"in i&&(i.duration=rE.diff(i.startDate,i.endDate,e.editor.record.durationUnit,!0)),i}},{key:"onBeforeSave",value:function(e){}},{key:"onAfterSave",value:function(e){}},{key:"updateRecord",value:function(e){var t=this.values;return this.assignmentStore&&delete t.resource,e.set(t)}},{key:"onBeforeEditorShow",value:function(){var e=this.editingContext,t=e.eventRecord,n=e.editor,r=n.widgetMap.nameField;r&&t.isCreating&&(n._isSettingValues=!0,r.value="",n._isSettingValues=!1,r._configuredPlaceholder=r.placeholder,r.placeholder=t.name)}},{key:"resetEditingContext",value:function(){var e=this,t=e.eventRecord,n=e.client,r=n.eventStore,i=e.editor.widgetMap.nameField;if(t.isCreating){var o;if(n.isTimelineBase)null===(o=e.editingContext.eventElement)||void 0===o||o.closest("[data-event-id]").classList.add("b-released");r.remove(t),t.isCreating=!1}i&&(i.placeholder=i._configuredPlaceholder),e.targetEventElement=null,e.client.element.classList.remove("b-eventeditor-editing")}},{key:"onPopupKeyDown",value:function(e){var t=e.event,n=this;!n.readOnly&&"Enter"===t.key&&n.saveAndCloseOnEnter&&"input"===t.target.tagName.toLowerCase()&&(t.preventDefault(),"startDate"===t.target.name&&oE(n.startDateField.value,n.startTimeField.value,n),n.onSaveClick())}},{key:"onSaveClick",value:(n=Pt()(At.a.mark((function e(){var t;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.editor.focus(),e.next=3,this.save();case 3:return(t=e.sent)&&this.editor.close(),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onDeleteClick",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deleteEvent();case 2:e.sent&&(this.editor.autoClose&&!this.editor.containsFocus||this.editor.close());case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onCancelClick",value:function(){this.editor.close()}}],[{key:"configurable",get:function(){return{autoClose:!0,saveAndCloseOnEnter:!0,triggerEvent:null,showDeleteButton:!0,showNameField:!0,startTimeConfig:null,startDateConfig:null,endTimeConfig:null,endDateConfig:null,dateFormat:"L",timeFormat:"LT",editorConfig:null,extraItems:null,items:null,weekStartDay:null}}}]),o}(_i);function sE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}aE._$name="EditBase";var lE=function(e){Ye()(n,e);var t=sE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"noFeatureElementsInAxis",value:function(){var e=this.scheduler.timeAxis;return this.store&&!this.store.storage.values.some((function(t){return e.isTimeSpanInAxis(t)}))}},{key:"construct",value:function(e,t){this.scheduler=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDisable",value:function(e){this.client.isPainted&&this.client.refresh(),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"getEventsToRender",value:function(e,t){throw new Error("Implement in subclass")}},{key:"onEventDataGenerated",value:function(e){var t=this,n=e.eventRecord,r=e.iconCls;t.shouldInclude(n)&&(t.scheduler.isVertical?e.width=t.scheduler.resourceColumnWidth:e.top=0,e.fillSize=!0,e.wrapperCls[t.rangeCls]=1,e.wrapperCls["b-sch-color-".concat(n.timeRangeColor)]=n.timeRangeColor,e.children.push(n.name),r&&e.children.unshift({tag:"i",className:r}),e.eventId=t.generateElementId(n))}},{key:"generateElementId",value:function(e){return"".concat(this.idPrefix,"-").concat(e.id)}},{key:"shouldInclude",value:function(e){throw new Error("Implement in subclass")}},{key:"onStoreChange",value:function(e){this.scheduler.onInternalEventStoreChange(e)}}],[{key:"pluginConfig",get:function(){return{chain:["getEventsToRender","onEventDataGenerated","noFeatureElementsInAxis"]}}}]),n}(_i.mixin(Px));function uE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}lE.featureClass="",lE._$name="ResourceTimeRangesBase";var cE=function(e){Ye()(n,e);var t=uE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeMenu",value:function(e,t){return e&&(e=he.assign({},{clippedBy:[this.client.timeAxisSubGridElement,this.client.bodyContainer]},e)),tt()(Ze()(n.prototype),"changeMenu",this).call(this,e,t)}}]),n}(Bf);function fE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}cE._$name="TimeSpanMenuBase";function dE(e,t){for(var n in e){var r=e[n];if(r){n in t&&(r=e[n]="object"===I()(r)?Qn.merge(Qn.clone(t[n]),r):t[n]);var i=r.menu;i&&dE("items"in i?i.items:i,t)}}}var hE=function(e){Ye()(n,e);var t=fE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),z.a.deprecate("Scheduler","5.0.0","`TimeSpanRecordContextMenuBase` feature is deprecated, in favor of `TimeSpanMenuBase` feature. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information.")}},{key:"doDestroy",value:function(){this.menu&&this.menu.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onEventSpaceKey",value:function(e){var t=Cr.from(e.target).center,n=new MouseEvent("contextmenu",Object.assign({clientX:t.x,clientY:t.y},e));Object.defineProperty(n,"target",{get:function(){return e.target}}),this.showEventContextMenu(n)}},{key:"showEventContextMenu",value:function(e){var t=this,n=t.client,r=e.target,i=mi.up(r,n.eventSelector),o=i||r;if(o){var a=t.resolveRecord(o);a&&(e.preventDefault(),t.showContextMenuFor(a,{targetElement:o,eventElement:i,event:e}))}}},{key:"resolveRecord",value:function(){}},{key:"showContextMenuFor",value:function(e,t){}},{key:"beforeContextMenuShow",value:function(){}},{key:"showContextMenu",value:function(e){if(!this.disabled){var t=this,n=e.event,r=e.menuType.toLowerCase(),i=te.uncapitalize(r),o="get".concat(te.capitalize(r),"MenuItems"),a=t.client,s=t.processItems,l=t.defaultItems,u=t.namedItems,c=n?[n.clientX+1,n.clientY+1]:Cr.from(e.targetElement).center,f=e.items=Qn.isEmpty(t.items)?Qn.clone(l):Qn.merge(Qn.clone(l),t.items);e.namedItems=u,e.selection=a.selectedRecords,dE(f,u),a[o]&&a[o](e,f),s&&!1===s(e)||Qn.isEmpty(e.items)||!1!==t.beforeContextMenuShow(e)&&!1!==a.trigger("".concat(i,"ContextMenuBeforeShow"),e)&&(t.menu=vd.showContextMenu(c,{owner:a,scrollAction:"hide",clippedBy:[a.timeAxisSubGridElement,a.bodyContainer],constrainTo:window,items:f,onDestroy:function(){t.menu=null},onBeforeItem:function(t){Object.assign(t,e)},onItem:function(e){return a.trigger("".concat(i,"ContextMenuItem"),e)},listeners:{show:function(t){var n=t.source;e.menu=n,a.trigger("".concat(i,"ContextMenuShow"),e)}}}))}}},{key:"hideContextMenu",value:function(e){var t;null===(t=this.menu)||void 0===t||t.hide(e)}},{key:"defaultItems",get:function(){var e=Qn.clone(this._defaultItems);if(this.client.readOnly)for(var t in e)e[t]=!1;return e},set:function(e){this._defaultItems=e}},{key:"triggerEvent",get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent},set:function(e){this._triggerEvent=e}}],[{key:"defaultConfig",get:function(){return{defaultItems:null,items:null,processItems:null,triggerEvent:null}}},{key:"pluginConfig",get:function(){return{assign:["showEventContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onEventSpaceKey"]}}}]),n}(_i);function vE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vE(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}hE._$name="TimeSpanRecordContextMenuBase";var yE=function(e){Ye()(n,e);var t=gE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;t=r.processConfig(t),tt()(Ze()(n.prototype),"construct",this).call(this,e,t),r.forSelector||(r.forSelector="".concat(e.eventInnerSelector,":not(.b-dragproxy)")),r.clockTemplate=new Hx({scheduler:e}),e.on(Qe()({},"before".concat(e.scheduledEventName,"drag"),(function(){var e;return null===(e=r.tooltip)||void 0===e?void 0:e.hide()})))}},{key:"processConfig",value:function(e){return"function"==typeof e?{template:e}:e}},{key:"setConfig",value:function(e){tt()(Ze()(n.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){var e,t;null===(e=this.clockTemplate)||void 0===e||e.destroy(),null===(t=this.tooltip)||void 0===t||t.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.tooltip&&(this.tooltip.disabled=e),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"onPaint",value:function(e){if(e.firstPaint){var t,n=this,r=n.client,i=[".b-dragselecting",".b-eventeditor-editing",".b-taskeditor-editing",".b-resizing-event",".b-dragcreating",".b-dragging-".concat(r.scheduledEventName),".b-creating-dependency",".b-dragproxy"].map((function(e){return":not(".concat(e,")")})).join("");null===(t=n.tooltip)||void 0===t||t.destroy(),n.tooltip=new kh(pE(pE({axisLock:"flexible",id:n.tipId||"".concat(n.client.id,"-event-tip"),cls:n.tipCls,forSelector:".b-timelinebase".concat(i," .b-grid-body-container:not(.b-scrolling) ").concat(n.forSelector),scrollAction:"realign",clippedBy:[r.timeAxisSubGridElement,r.bodyContainer],forElement:r.timeAxisSubGridElement,showOnHover:!0,anchorToTarget:!0,allowOver:Boolean(n.config.items||n.config.tools),getHtml:n.getTipHtml.bind(n),disabled:n.disabled},n.config),{},{listeners:n.configuredListeners})),n.tooltip.on({innerhtmlupdate:"updateDateIndicator",overtarget:"onOverNewTarget",show:"onTipShow",hide:"onTipHide",thisObj:n})}}},{key:"processConfiguredListeners",value:function(){}},{key:"addListener",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];null===(e=this.tooltip)||void 0===e||e.addListener.apply(e,n)}},{key:"removeListener",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];null===(e=this.tooltip)||void 0===e||e.removeListener.apply(e,n)}},{key:"updateDateIndicator",value:function(){var e=this,t=e.tooltip,n=t.element.querySelector(".b-sch-tooltip-enddate");e.record&&(e.clockTemplate.updateDateIndicator(t.element,e.record.startDate),n&&e.clockTemplate.updateDateIndicator(n,e.record.endDate))}},{key:"resolveTimeSpanRecord",value:function(e){return this.client.resolveTimeSpanRecord(e)}},{key:"getTipHtml",value:function(e){var t=e.tip,n=e.activeTarget,r=this,i=r.client,o=r.recordType||"".concat(i.scheduledEventName,"Record"),a=r.resolveTimeSpanRecord(n);if((null==a?void 0:a.startDate)instanceof Date){var s,l=a.startDate,u=a.endDate,c=i.getFormattedDate(l),f=i.getDisplayEndDate(u,l),d=i.getFormattedDate(f);return t.eventRecord=a,r.template((s={tip:t},Qe()(s,"".concat(o),a),Qe()(s,"startDate",l),Qe()(s,"endDate",u),Qe()(s,"startText",c),Qe()(s,"endText",d),Qe()(s,"startClockHtml",r.clockTemplate.template({date:l,text:c,cls:"b-sch-tooltip-startdate"})),Qe()(s,"endClockHtml",a.isMilestone?"":r.clockTemplate.template({date:f,text:d,cls:"b-sch-tooltip-enddate"})),s))}return t.hide(),""}},{key:"record",get:function(){return this.tooltip.eventRecord}},{key:"onTipShow",value:function(){var e=this;e.monitorRecordUpdate&&!e.updateListener&&(e.updateListener=e.client.eventStore.on({update:e.onRecordUpdate,thisObj:e}))}},{key:"onTipHide",value:function(){var e;this.tooltip.eventRecord=null,null===(e=this.updateListener)||void 0===e||e.call(this),this.updateListener=null}},{key:"onOverNewTarget",value:function(e){var t=e.newTarget;this.tooltip.eventRecord=this.resolveTimeSpanRecord(t)}},{key:"onRecordUpdate",value:function(e){e.record===this.record&&(this.tooltip.alignTo(),this.tooltip.updateContent())}}],[{key:"defaultConfig",get:function(){return{autoUpdate:!1,hoverDelay:250,hideDelay:100,template:null,cls:null,align:{align:"b-t"},clockTemplate:null,monitorRecordUpdate:null,testConfig:{hoverDelay:0}}}},{key:"pluginConfig",get:function(){return{chain:["onPaint"]}}}]),n}(_i);function mE(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bE(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function bE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}yE._$name="TooltipBase";var wE=function(e){Ye()(n,e);var t=kE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;tt()(Ze()(n.prototype),"construct",this).call(this,e,t),e.isVertical&&e.on({renderRows:r.onUIReady,thisObj:r,once:!0}),r.cls=r.cls||"b-timerange-".concat(r.constructor.$$name),r.baseSelector=".".concat(r.baseCls,".").concat(r.cls),r.enableResizing&&(r.showHeaderElements=!0)}},{key:"doDestroy",value:function(){var e,t,r,i,o,a=this;null===(e=a.storeDetacher)||void 0===e||e.call(a),a.detachListeners("timeAxisViewModel"),a.detachListeners("timeAxis"),null===(t=a.clockTemplate)||void 0===t||t.destroy(),null===(r=a.tip)||void 0===r||r.destroy(),null===(i=a.drag)||void 0===i||i.destroy(),null===(o=a.resize)||void 0===o||o.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.client.isPainted&&this.renderRanges(),tt()(Ze()(n.prototype),"doDisable",this).call(this,e)}},{key:"onPaint",value:function(e){e.firstPaint&&this.client.isHorizontal&&this.onUIReady()}},{key:"onUIReady",value:function(){var e=this,t=e.client;e.client.on({timeAxisViewModelChange:e.setupTimeAxisViewModelListeners,thisObj:e}),e.setupTimeAxisViewModelListeners(),e.enableResizing&&!t.hideHeaders&&(e.drag=new Xf({name:"rangeDrag",mode:t.isVertical?"translateY":"translateX",constrain:!0,outerElement:e.headerContainerElement,targetSelector:"".concat(e.baseSelector),isElementDraggable:function(n,r){return!t.readOnly&&e.isElementDraggable(n,r)},transitionDuration:t.transitionDuration,listeners:{dragstart:"onDragStart",drag:"onDrag",drop:"onDrop",abort:"onInvalidDrop",thisObj:e}}),e.resize=new ad({direction:t.mode,targetSelector:"".concat(e.baseSelector,".b-sch-range"),outerElement:e.headerContainerElement,isElementResizable:function(e){return!e.closest(".b-dragging")},listeners:{resizestart:"onResizeStart",resizing:"onResizeDrag",resize:"onResize",cancel:"onInvalidResize",thisObj:e}})),e.renderRanges()}},{key:"setupTimeAxisViewModelListeners",value:function(){var e=this;e.detachListeners("timeAxisViewModel"),e.detachListeners("timeAxis"),e.client.timeAxisViewModel.on({name:"timeAxisViewModel",update:"onTimeAxisViewModelUpdate",thisObj:e}),e.client.timeAxis.on({name:"timeAxis",includeChange:"renderRanges",thisObj:e})}},{key:"onTimeAxisViewModelUpdate",value:function(){this.renderRanges()}},{key:"renderRanges",value:function(){var e=this,t=e.client.foregroundCanvas;if(t){var n=e.headerContainerElement;if(mi.removeEachSelector(t,e.baseSelector),n&&mi.removeEachSelector(n,e.baseSelector),!e.disabled){var r,i=mE(e.timeRanges);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.renderRange(o,!0)}}catch(e){i.e(e)}finally{i.f()}}}}},{key:"timeRanges",get:function(){return this.store.records}},{key:"shouldRenderRange",value:function(e){var t=this.client.timeAxis;return e.duration&&t.timeSpanInAxis(e.startDate,e.endDate)||e.startDate&&t.dateInAxis(e.startDate)}},{key:"renderRange",value:function(e,t){var n=this,r=n.client;if(n.shouldRenderRange(e)){var i,o,a=r.getCoordinateFromDate(Un.max(e.startDate,r.timeAxis.startDate),{respectExclusion:!0}),s=e.duration&&r.getCoordinateFromDate(Un.min(e.endDate,r.timeAxis.endDate),{respectExclusion:!0,isEnd:!0}),l=s-a,u=e.name||e.iconCls?"<label>".concat(e.iconCls?'<i class="'.concat(e.iconCls,'"></i>'):""," ").concat(e.name||"&nbsp;","</label>"):"",c={className:(i={},Qe()(i,n.baseCls,1),Qe()(i,n.cls,n.cls),Qe()(i,n.rangeCls,s),Qe()(i,n.lineCls,!s),Qe()(i,e.cls,e.cls),Qe()(i,"b-narrow-range",s&&l<n.narrowThreshold),i),dataset:{id:e.id},style:r.isVertical?"transform: translateY(".concat(a,"px); ").concat(s?"height:".concat(l,"px"):"",";"):"transform: translateX(".concat(a,"px); ").concat(s?"width:".concat(l,"px"):"",";"),retainElement:!0},f=mi.createElement(Object.assign({},c,{parent:t&&r.foregroundCanvas,style:c.style+(e.style||""),html:n.showHeaderElements&&!n.showLabelInBody?"":u}));n.showHeaderElements&&(o=mi.createElement(Object.assign({parent:t&&n.headerContainerElement,html:n.showLabelInBody?"":u},c)));var d={bodyElement:f,headerElement:o};return t&&n.rotateLabel(e,d),d}}},{key:"rotateLabel",value:function(e,t){var n=t.bodyElement;if(e.iconCls||e.name){var r=n.firstChild;if(r){r.classList.remove("b-vertical");var i=this.client.isVertical?r.offsetHeight<n.offsetHeight:r.offsetWidth>n.offsetWidth;r.classList[i?"add":"remove"]("b-vertical")}}}},{key:"getElementsByRecord",value:function(e){var t,n,r=this,i="object"!==I()(e)?e:e.id,o=null===(t=r.client.foregroundCanvas)||void 0===t?void 0:t.querySelector("".concat(r.baseSelector,'[data-id="').concat(i,'"]')),a=null===(n=r.headerContainerElement)||void 0===n?void 0:n.querySelector("".concat(r.baseSelector,'[data-id="').concat(i,'"]'));return o?{bodyElement:o,headerElement:a}:null}},{key:"getBodyElementByRecord",value:function(e){var t="string"==typeof e?e:e.id;return this.client.foregroundCanvas.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]'))}},{key:"getRecordByElement",value:function(e){return this.store.getById(e.dataset.id)}},{key:"headerContainerElement",get:function(){var e=this.client,t=e.isVertical,n=e.timeView,r=e.timeAxisColumn,i=null;return t&&n.element?i=n.element.parentElement:t||(i=r.element),i}},{key:"showHeaderElements",get:function(){return!this.client.hideHeaders&&this._showHeaderElements},set:function(e){this._showHeaderElements=e,this.client.isPainted&&(e?this.client.element.classList.add("b-sch-timeranges-with-headerelements"):this.client.element.classList.remove("b-sch-timeranges-with-headerelements"),this.renderRanges())}},{key:"populateHeaderMenu",value:function(e){var t=e.column;e.items;"timeAxis"===t.type&&this.populateTimeAxisHeaderMenu.apply(this,arguments)}},{key:"populateTimeAxisHeaderMenu",value:function(e){e.column,e.items}},{key:"store",get:function(){return this._store},set:function(e){var t=this;t._store=ts.getStore(e,ts);var n=!1;t.storeDetacher&&(t.storeDetacher(),n=!0),t.storeDetacher=t._store.on({change:t.onStoreChanged,refresh:t.onStoreChanged,thisObj:t}),n&&this.renderRanges()}},{key:"onStoreChanged",value:function(e){var t=this;if(!(t.disabled||!t.client.isVisible||t.isConfiguring||"refresh"===e.type&&"batch"!==e.action))if("update"===e.action){var n=e.record,r=e.changes.hasOwnProperty("id")?e.changes.id.oldValue:n.id,i=t.getElementsByRecord(r),o=t.renderRange(n,!i);if(i&&!o&&(i.bodyElement.remove(),i.headerElement&&i.headerElement.remove()),!i||!o)return;t.client.runWithTransition((function(){mi.sync(o.bodyElement,i.bodyElement),t.showHeaderElements&&mi.sync(o.headerElement,i.headerElement),t.rotateLabel(n,i)}))}else t.renderRanges()}},{key:"showTip",value:function(e){var t=this;t.showTooltip&&(t.clockTemplate=new Hx({scheduler:t.client}),t.tip=new kh(Qn.assign({id:"".concat(t.client.id,"-time-range-tip"),cls:"b-interaction-tooltip",align:"b-t",autoShow:!0,updateContentOnMouseMove:!0,forElement:e.element,getHtml:function(){return t.getTipHtml(e.record,e.element)}},t.showTooltip)))}},{key:"isElementDraggable",value:function(e){return(e=e.closest(this.baseSelector+":not(.b-resizing)"))&&!e.classList.contains("b-over-resize-handle")}},{key:"onDragStart",value:function(e){var t=e.context,n=this,r=n.getRecordByElement(t.element.closest(n.baseSelector)),i=n.getBodyElementByRecord(r),o=n.client.timeAxisViewModel,a=n.drag;Object.assign(t,{record:r,rangeBodyEl:i,originRangeX:mi.getTranslateX(i),originRangeY:mi.getTranslateY(i)}),n.client.isVertical?(a.minY=0,a.maxY=o.totalSize-t.rangeBodyEl.offsetHeight,a.minX=0,a.maxX=Number.MAX_SAFE_INTEGER):(a.minX=0,a.maxX=o.totalSize-t.rangeBodyEl.offsetWidth,a.minY=0,a.maxY=Number.MAX_SAFE_INTEGER),n.client.element.classList.add("b-dragging-timerange"),n.showTip(t)}},{key:"onDrag",value:function(e){var t=e.context;this.client.isVertical?mi.setTranslateY(t.rangeBodyEl,mi.getTranslateY(t.element)):mi.setTranslateX(t.rangeBodyEl,mi.getTranslateX(t.element))}},{key:"onDrop",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this,r=t.record,i=t.rangeBodyEl.getBoundingClientRect(),o=n.client.getDateFromCoordinate(n.client.isVertical?i.top:i.left,"round",!1);r.startDate-o!=0?r.setStartDate(o):n.onInvalidDrop(),n.tip&&(n.tip.destroy(),n.tip=null),n.client.element.classList.remove("b-dragging-timerange")}},{key:"onInvalidDrop",value:function(){var e=this;e.drag.reset(),e.renderRanges(),e.client.element.classList.remove("b-dragging-timerange"),e.tip&&(e.tip.destroy(),e.tip=null)}},{key:"onResizeStart",value:function(e){var t=e.context,n=this,r=n.getRecordByElement(t.element.closest(n.baseSelector)),i=n.getBodyElementByRecord(r);Object.assign(t,{record:r,rangeBodyEl:i}),n.showTip(t)}},{key:"onResizeDrag",value:function(e){var t=e.context;this.client.isVertical?("top"===t.edge&&mi.setTranslateY(t.rangeBodyEl,t.newY),t.rangeBodyEl.style.height=t.newHeight+"px"):("left"===t.edge&&mi.setTranslateX(t.rangeBodyEl,t.newX),t.rangeBodyEl.style.width=t.newWidth+"px")}},{key:"onResize",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this,r=n.client,i=t.record,o=t.element.getBoundingClientRect(),a=r.isVertical?o.top:o.left,s=r.isVertical?o.bottom:o.right,l=r.getDateFromCoordinate(a,"round",!1),u="left"===t.edge||"top"===t.edge,c=r.getDateFromCoordinate(s,"round",!1);(u&&i.startDate-l!=0||c&&i.endDate-c!=0)&&c>l?u?i.setStartDate(l,!1):i.setEndDate(c,!1):n.onInvalidResize(),n.tip&&(n.tip.destroy(),n.tip=null)}},{key:"onInvalidResize",value:function(){var e=this;e.resize.reset(),e.renderRanges(),e.tip&&(e.tip.destroy(),e.tip=null)}},{key:"getTipHtml",value:function(e,t){var n=this,r=n.client,i=t.getBoundingClientRect(),o=r.isVertical?i.top:i.left,a=r.isVertical?i.bottom:i.right,s=r.getDateFromCoordinate(o,"round",!1),l=e.endDate&&r.getDateFromCoordinate(a,"round",!1),u=r.getFormattedDate(s),c=l&&r.getFormattedEndDate(l,s);return n.dragTipTemplate({name:e.name||"",startDate:s,endDate:l,startText:u,endText:c,startClockHtml:n.clockTemplate.template({date:s,text:u,cls:"b-sch-tooltip-startdate"}),endClockHtml:c&&n.clockTemplate.template({date:l,text:c,cls:"b-sch-tooltip-enddate"})})}}],[{key:"defaultConfig",get:function(){return{rangeCls:"b-sch-range",lineCls:"b-sch-line",store:{modelClass:KC},enableResizing:!1,showTooltip:!0,showHeaderElements:!0,dragTipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    <div class="b-sch-tip-name">').concat(e.name||"","</div>\n                    ").concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml||"","\n                </div>\n            ")},baseCls:"b-sch-timerange",cls:"",narrowThreshold:80}}},{key:"pluginConfig",get:function(){return{chain:["onPaint","populateHeaderMenu","populateTimeAxisHeaderMenu"]}}}]),n}(_i.mixin(el));function CE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}wE._$name="AbstractTimeRanges";var RE=Object.freeze({}),SE=function(e){Ye()(n,e);var t=CE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){e.useBackgroundCanvas=!0,tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDisable",value:function(e){tt()(Ze()(n.prototype),"doDisable",this).call(this,e),this.isConfiguring||this.refresh()}},{key:"render",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this,t=e.client,n=t.timeAxis,r=t.timeAxisViewModel,i=t.isHorizontal,o=r.columnConfig,a=t.visibleDateRange||RE,s=a.startDate,l=a.endDate;if(n.startDate&&s){var u=r.columnLinesFor,c=Math.max(u-1,0),f=s.getTime(),d=l.getTime(),h=[],v=new Set,p=i?"X":"Y";if(e.element||(e.element=mi.createElement({parent:t.backgroundCanvas,className:"b-column-lines-canvas"})),!e.disabled){var g=function(e,t){var n=e.start.getTime();n>f&&n<d&&!v.has(n)&&(v.add(n),h.push({className:t?"b-column-line-major":"b-column-line",style:{transform:"translate".concat(p,"(").concat(e.coord,"px)")},dataset:{line:t?"major-".concat(e.index):"line-".concat(e.index)}}))};if(u!==c)for(var y=1;y<=o[c].length-1;y++)g(o[c][y],!0);for(var m=1;m<=o[u].length-1;m++)g(o[u][m],!1);if(!i&&t.columnLines)for(var b=t.resourceColumns,k=b.columnWidth,w=b.firstResource,C=b.lastResource,R=w;R<C+1;R++)h.push({className:"b-column-line b-resource-column-line",style:{transform:"translateX(".concat((R+1)*k-1,"px)")},dataset:{line:"resource-".concat(R)}})}du.sync({targetElement:e.element,onlyChildren:!0,domConfig:{children:h,syncOptions:{releaseThreshold:4}},syncIdField:"line"})}}},{key:"onVisibleDateRangeChange",value:function(){this.refresh()}},{key:"onVisibleResourceRangeChange",value:function(e){e.firstResource,e.lastResource;this.refresh()}},{key:"updateCanvasSize",value:function(){this.refresh()}}],[{key:"$name",get:function(){return"ColumnLines"}},{key:"delayable",get:function(){return{refresh:{type:"raf",cancelOutstanding:!0}}}},{key:"pluginConfig",get:function(){return{after:["render","updateCanvasSize","onVisibleDateRangeChange","onVisibleResourceRangeChange"]}}}]),n}(el(_i));SE._$name="ColumnLines",ty.registerFeature(SE,!0,["Scheduler","Gantt"]);n(251);function xE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function EE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var DE=function(e){return function(e){Ye()(i,e);var t,n,r=EE(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"construct",value:function(e,t){tt()(Ze()(i.prototype),"construct",this).call(this,e,t);var n=this;n.view=e,n.eventName=e.scheduledEventName,e.on("readOnly",(function(){return n.updateCreateListeners()})),n.updateCreateListeners()}},{key:"doDestroy",value:function(){var e,t,n=this;n.detachListeners("view"),n.creationData=null,null===(e=n.mouseUpMoveDetacher)||void 0===e||e.call(n),null===(t=n.creationTooltip)||void 0===t||t.destroy(),tt()(Ze()(i.prototype),"doDestroy",this).call(this)}},{key:"updateCreateListeners",value:function(){var e,t=this;t.view&&(t.detachListeners("view"),t.isCreateAllowed&&t.view.on((e={name:"view"},Qe()(e,"".concat(t.eventName,"mouseenter"),"onTimeSpanMouseEnter"),Qe()(e,"".concat(t.eventName,"mouseleave"),"onTimeSpanMouseLeave"),Qe()(e,"thisObj",t),e)))}},{key:"allowCreate",get:function(){return this._allowCreate},set:function(e){this._allowCreate=e,this.updateCreateListeners()}},{key:"isCreateAllowed",get:function(){return this.allowCreate&&!this.view.readOnly&&!this.disabled}},{key:"onTimeSpanMouseEnter",value:function(e){var t=e.event,n=e.source,r=e["".concat(this.eventName,"Record")],i=e["".concat(this.eventName,"Element")];r.isCreating||(this.showTerminals(r,mi.down(i,n.eventInnerSelector)),this.creationData&&t.target.closest(this.client.eventSelector)&&(this.creationData.timeSpanElement=i,this.onOverTargetEventBar(t)))}},{key:"onTimeSpanMouseLeave",value:function(e){var t,n=this,r=e["".concat(n.eventName,"Element")],i=e.event.relatedTarget,o=null===(t=n.creationData)||void 0===t?void 0:t.timeSpanElement;n.creationData&&o&&mi.isDescendant(r,i)||n.hideTerminals(r),n.creationData&&!n.creationData.finalizing&&(n.creationData.timeSpanElement=null,n.onOverNewTargetWhileCreating())}},{key:"onTerminalMouseOver",value:function(e){this.creationData&&this.onOverTargetEventBar(e)}},{key:"onTerminalMouseOut",value:function(e){var t=this,n=mi.up(e.target,t.view.eventSelector);!n||t.showingTerminalsFor&&mi.isDescendant(n,t.showingTerminalsFor)||t.creationData&&n===t.creationData.timeSpanElement||(t.hideTerminals(n),t.view.unhover(e)),t.creationData&&t.onOverNewTargetWhileCreating(e.relatedTarget,t.creationData.target)}},{key:"onTerminalMouseDown",value:function(e){var t=this;if(0===e.button&&!t.creationData){var n,r=t.view,i=r.timeAxisSubGridElement,o=e.target,a=o.closest(r.eventSelector),s=Cr.from(r.element,document.body);e.preventDefault(),e.stopPropagation(),t.creationData={source:r.resolveTimeSpanRecord(a),fromSide:o.dataset.side,startPoint:Cr.from(o,i).center,startX:e.pageX-s.x+r.scrollLeft,startY:e.pageY-s.y+r.scrollTop,valid:!1,sourceResource:null===(n=r.resolveResourceRecord)||void 0===n?void 0:n.call(r,a)},t.mouseUpMoveDetacher=Tu.on({mouseup:{element:r.rootElement,handler:"onMouseUp"},mousemove:{element:i,handler:"onMouseMove"},thisObj:t}),t.documentMouseUpDetacher=Tu.on({mouseup:{element:document,handler:"onDocumentMouseUp"},keydown:{element:document,handler:function(e){"Escape"===e.key&&t.abort()}},thisObj:t})}}},{key:"onMouseMove",value:function(e){var t=this,n=t.view,r=t.creationData,i=Cr.from(n.element,document.body),o=e.pageX-i.x+n.scrollLeft-r.startX,a=e.pageY-i.y+n.scrollTop-r.startY,s=Math.round(Math.sqrt(o*o+a*a))-3,l=Math.atan2(a,o),u=t.connector;if(!u){if(!1===t.onRequestDragCreate())return;u=t.connector}u.style.width="".concat(s,"px"),u.style.transform="rotate(".concat(l,"rad)"),t.lastMouseMoveEvent=e}},{key:"onRequestDragCreate",value:function(){var e=this,t=e.view,n=e.creationData;if(!1===t.trigger("beforeDependencyCreateDrag",{data:n,source:n.source}))return e.abort(),!1;t.element.classList.add("b-creating-dependency"),e.connector=e.createConnector(n.startPoint.x,n.startPoint.y),t.trigger("dependencyCreateDragStart",{data:n,source:n.source}),e.showCreationTooltip&&(e.creationTooltip=e.creationTooltip||e.createDragTooltip(),e.creationTooltip.disabled=!1,e.creationTooltip.show()),t.scrollManager.startMonitoring({scrollables:[{element:t.timeAxisSubGrid.scrollable.element,direction:"horizontal"},{element:t.scrollable.element,direction:"vertical"}],callback:function(){return e.lastMouseMoveEvent&&e.onMouseMove(e.lastMouseMoveEvent)}})}},{key:"onOverTargetEventBar",value:function(e){var t=e.target,n=this,r=n.view,i=n.creationData,o=n.allowDropOnEventBar,a=r.resolveTimeSpanRecord(t);he.isPromise(i.valid)||!o&&!t.classList.contains(n.terminalCls)||a!==i.source&&n.onOverNewTargetWhileCreating(t,a)}},{key:"onOverNewTargetWhileCreating",value:(n=Pt()(At.a.mark((function e(t,n){var r,i,o,a,s,l,u,c,f,d,h,v;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(r=this).view,o=r.creationData,a=r.connector,s=r.allowDropOnEventBar,!he.isPromise(o.valid)){e.next=3;break}return e.abrupt("return");case 3:if(a.classList.remove("b-valid","b-invalid"),o.timeSpanElement&&mi.removeClsGlobally(o.timeSpanElement,"b-sch-terminal-active"),n&&n!==o.source&&(s||t.classList.contains(r.terminalCls))){e.next=11;break}o.target=o.toSide=null,o.valid=!1,a.classList.add("b-invalid"),e.next=41;break;case 11:u=t.dataset.side,o.target=n,s&&!t.classList.contains(r.terminalCls)&&(u=r.getTargetSideFromType(r.dependencyStore.modelClass.fieldMap.type.defaultValue||QR.Type.EndToStart)),i.resolveResourceRecord&&(o.targetResource=i.resolveResourceRecord(t)),o.toSide=u,f=o.fromSide,d=function(e){r.isDestroyed||(o.valid=e,t.classList.add(e?"b-valid":"b-invalid"),a.classList.add(e?"b-valid":"b-invalid"),i.trigger("dependencyValidationComplete",{data:o,source:o.source,target:o.target,dependencyType:c}))},e.t0=!0,e.next=e.t0===("left"===f&&"left"===u)?20:e.t0===("left"===f&&"right"===u)?22:e.t0===("right"===f&&"left"===u)?24:e.t0===("right"===f&&"right"===u)?26:28;break;case 20:return c=QR.Type.StartToStart,e.abrupt("break",28);case 22:return c=QR.Type.StartToEnd,e.abrupt("break",28);case 24:return c=QR.Type.EndToStart,e.abrupt("break",28);case 26:return c=QR.Type.EndToEnd,e.abrupt("break",28);case 28:if(i.trigger("dependencyValidationStart",{data:o,source:o.source,target:o.target,dependencyType:c}),o.valid=r.dependencyStore.isValidDependency(o.source,o.target,c),!he.isPromise(o.valid)){e.next=37;break}return e.next=33,o.valid;case 33:h=e.sent,d(h),e.next=38;break;case 37:d(o.valid);case 38:v=o.valid?"b-valid":"b-invalid",a.classList.add(v),null===(l=o.timeSpanElement)||void 0===l||l.querySelector(".b-sch-terminal[data-side=".concat(u,"]")).classList.add("b-sch-terminal-active",v);case 41:r.updateTooltip();case 42:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"onMouseUp",value:(t=Pt()(At.a.mark((function e(t){var n,r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=(r=this).creationData).finalizing=!0,null===(n=r.mouseUpMoveDetacher)||void 0===n||n.call(r),!i.valid){e.next=30;break}return e.next=6,r.view.trigger("beforeDependencyCreateFinalize",i);case 6:if(!1!==e.sent){e.next=11;break}i.valid=!1,e.next=16;break;case 11:if(!he.isPromise(i.valid)){e.next=16;break}return e.next=14,i.valid;case 14:o=e.sent,i.valid=o;case 16:if(!i.valid){e.next=27;break}if(a=r.createDependency(i),!he.isPromise(a)){e.next=22;break}return e.next=21,a;case 21:a=e.sent;case 22:i.dependency=a,r.view.trigger("dependencyCreateDrop",{data:i,source:i.source,target:i.target,dependency:a}),this.doAfterDependencyDrop(i),e.next=28;break;case 27:r.doAfterDependencyDrop(i);case 28:e.next=32;break;case 30:i.valid=!1,r.doAfterDependencyDrop(i);case 32:this.abort();case 33:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"doAfterDependencyDrop",value:function(e){this.view.trigger("afterDependencyCreateDrop",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xE(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({data:e},e))}},{key:"onDocumentMouseUp",value:function(e){var t=e.target;this.view.timeAxisSubGridElement.contains(t)||this.abort()}},{key:"abort",value:function(){var e,t,n=this,r=n.view,i=n.creationData;if(i){var o=i.source,a=i.sourceResource,s=i.target,l=i.targetResource;if(o){var u=r.getElementFromEventRecord(o,a);u&&n.hideTerminals(u)}if(s){var c=r.getElementFromEventRecord(s,l);c&&n.hideTerminals(c)}}n.creationTooltip&&(n.creationTooltip.disabled=!0),n.creationData=n.lastMouseMoveEvent=null,null===(e=n.mouseUpMoveDetacher)||void 0===e||e.call(n),null===(t=n.documentMouseUpDetacher)||void 0===t||t.call(n),n.removeConnector()}},{key:"createConnector",value:function(e,t){var n=this,r=n.view;return n.connector=mi.createElement({parent:r.timeAxisSubGridElement,className:"".concat(n.baseCls,"-connector"),style:"left:".concat(e,"px;top:").concat(t,"px")}),r.element.classList.add("b-creating-dependency"),n.connector}},{key:"createDragTooltip",value:function(){var e=this,t=e.view,n=e.creationTooltip=kh.new({id:"".concat(t.id,"-dependency-drag-tip"),cls:"b-sch-dependency-creation-tooltip",loadingMsg:"",anchorToTarget:!1,forElement:t.timeAxisSubGridElement,trackMouse:!0,constrainTo:null,header:{dock:"right"},listeners:{beforeShow:function(){e.updateTooltip()}}},e.creationTooltip);return n.show(),n}},{key:"removeConnector",value:function(e){var t=this,n=t.connector,r=t.view;n&&(n.classList.add("b-removing"),n.style.width="0",t.setTimeout((function(){n.remove(),t.connector=null,e&&e.call(t)}),200)),r.element.classList.remove("b-creating-dependency"),t.creationTooltip&&t.creationTooltip.hide(),r.scrollManager.stopMonitoring()}},{key:"showTerminals",value:function(e,t){var n=this;if(n.isCreateAllowed){var r=n.terminalCls,i="".concat(r,"s-visible");(t=mi.down(t,n.view.eventInnerSelector)).classList.contains(i)||this.view.element.classList.contains("b-resizing-event")||n.view.readOnly||(n.terminalSides.forEach((function(e){var i=mi.createElement({parent:t,className:"".concat(r," ").concat(r,"-").concat(e),dataset:{side:e,feature:!0}});i.detacher=Tu.on({element:i,mouseover:"onTerminalMouseOver",mouseout:"onTerminalMouseOut",mousedown:{handler:"onTerminalMouseDown",capture:!0},thisObj:n})})),t.classList.add(i),e.cls.add(i),n.showingTerminalsFor=t)}}},{key:"hideTerminals",value:function(e){var t=this,n=t.client.getTimeSpanMouseEventParams(e),r=null==n?void 0:n["".concat(t.eventName,"Record")],i="".concat(t.terminalCls,"s-visible");mi.forEachSelector(e,".".concat(t.terminalCls),(function(e){e.detacher&&e.detacher(),e.remove()})),mi.down(e,t.view.eventInnerSelector).classList.remove(i),r.cls.remove(i),t.showingTerminalsFor=null}},{key:"createDependency",value:function(e){var t=e.source,n=e.target,r=e.fromSide,i=e.toSide,o=("left"===r?0:2)+("right"===i?1:0);return this.dependencyStore.add({from:t.id,to:n.id,type:o,fromSide:r,toSide:i})[0]}},{key:"getTargetSideFromType",value:function(e){return e===QR.Type.StartToStart||e===QR.Type.EndToStart?"left":"right"}},{key:"updateTooltip",value:function(){var e,t,n,r,i=this,o=i.creationData,a=o.valid,s=this.creationTooltip,l=s.element.classList;if(Object.assign(o,{fromText:o.source.name,toText:null!==(e=null===(t=o.target)||void 0===t?void 0:t.name)&&void 0!==e?e:"",fromSide:o.fromSide,toSide:o.toSide||""}),he.isPromise(a))return l.remove("b-invalid"),l.add("b-checking"),new Promise((function(e){return a.then((function(t){o.valid=t,s.isDestroyed||e(i.updateTooltip())}))}));!0===a?(l.remove("b-invalid"),l.remove("b-checking"),n="valid",r=i.L("L{Dependencies.valid}")):(l.remove("b-checking"),l.add("b-invalid"),n="invalid",r=i.L("L{Dependencies.invalid}")),s.title='<i class="b-icon b-icon-'.concat(n,'"></i>').concat(r),s.html='<table class="b-sch-dependency-creation-tooltip">\n                        <tr><td>'.concat(i.L("L{Dependencies.from}"),": </td><td>").concat(o.fromText,'</td><td><div class="b-sch-box b-').concat(o.fromSide,'"></div></td></tr>\n                        <tr><td>').concat(i.L("L{Dependencies.to}"),": </td><td>").concat(o.toText,'</td><td><div class="b-sch-box b-').concat(o.toSide,'"></div></td></tr>\n                    </table>')}}],[{key:"$name",get:function(){return"DependencyCreation"}},{key:"defaultConfig",get:function(){return{allowDropOnEventBar:!0,showCreationTooltip:!0,creationTooltip:null,terminalCls:"b-sch-terminal",terminalSides:["left","top","right","bottom"],allowCreate:!0}}}]),i}(e||$e)};function TE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var OE,ME=function(e){Ye()(n,e);var t=TE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"findPath",value:function(e,t){var n,r,i,o,a,s,l,u,c,f,d,h,v,p,g,y,m,b,k,w,C,R,S,x,E,D,T,O,M,A,I,P=this;for(t&&!Array.isArray(t)&&(t=[t]),I=0;e&&!A;)for(r=(n=Object.assign(P.config,e)).startBox,i=n.endBox,o=n.startShift,a=n.endShift,s=n.startSide,l=n.endSide,u=n.startArrowSize,c=n.endArrowSize,f=n.startArrowMargin,d=n.endArrowMargin,h=n.horizontalMargin,v=n.verticalMargin,p=n.hasOwnProperty("startHorizontalMargin")?n.startHorizontalMargin:h,g=n.hasOwnProperty("startVerticalMargin")?n.startVerticalMargin:v,y=n.hasOwnProperty("endHorizontalMargin")?n.endHorizontalMargin:h,m=n.hasOwnProperty("endVerticalMargin")?n.endVerticalMargin:v,b=n.hasOwnProperty("otherHorizontalMargin")?n.otherHorizontalMargin:h,k=n.hasOwnProperty("otherVerticalMargin")?n.otherVerticalMargin:v,w=n.otherBoxes,s=P.normalizeSide(s),l=P.normalizeSide(l),C=P.getConnectionCoordinatesFromBoxSideShift(r,s,o),R=P.getConnectionCoordinatesFromBoxSideShift(i,l,a),T=P.calcGridBaseBoxFromBoxAndDrawParams(r,s,u,f,p,g),O=P.calcGridBaseBoxFromBoxAndDrawParams(i,l,c,d,y,m),w=w&&w.map((function(e){return P.calcGridBaseBoxFromBoxAndDrawParams(e,!1,0,0,b,k)})),S=P.getConnectionCoordinatesFromBoxSideShift(T,s,o),x=P.getConnectionCoordinatesFromBoxSideShift(O,l,a),M=P.buildPathGrid(T,O,S,x,s,l,w),E=P.convertDecartPointToGridPoint(M,S),D=P.convertDecartPointToGridPoint(M,x),A=P.findPathOnGrid(M,E,D,s,l),e=!1;!A&&!e&&t&&I<t.length;I++)e=t[I](n);return A&&(A=P.prependPathWithArrowStaffSegment(A,C,u,s),A=P.appendPathWithArrowStaffSegment(A,R,c,l),A=P.optimizePath(A)),A}},{key:"getConnectionCoordinatesFromBoxSideShift",value:function(e,t,n){var r;switch(t){case"left":r={x:e.start,y:(e.top+e.bottom)/2+n};break;case"right":r={x:e.end,y:(e.top+e.bottom)/2+n};break;case"top":r={x:(e.start+e.end)/2+n,y:e.top};break;case"bottom":r={x:(e.start+e.end)/2+n,y:e.bottom}}return r}},{key:"calcGridBaseBoxFromBoxAndDrawParams",value:function(e,t,n,r,i,o){var a;switch(t){case"left":a={start:e.start-Math.max(n+r,i),end:e.end+i,top:e.top-o,bottom:e.bottom+o};break;case"right":a={start:e.start-i,end:e.end+Math.max(n+r,i),top:e.top-o,bottom:e.bottom+o};break;case"top":a={start:e.start-i,end:e.end+i,top:e.top-Math.max(n+r,o),bottom:e.bottom+o};break;case"bottom":a={start:e.start-i,end:e.end+i,top:e.top-o,bottom:e.bottom+Math.max(n+r,o)};break;default:a={start:e.start-i,end:e.end+i,top:e.top-o,bottom:e.bottom+o}}return a}},{key:"buildPathGrid",value:function(e,t,n,r,i,o,a){var s,l,u,c,f,d,h,v,p,g,y,m,b,k={},w=[];for(s=[e.start,"left"===i||"right"===i?(e.start+e.end)/2:n.x,e.end,t.start,"left"===o||"right"===o?(t.start+t.end)/2:r.x,t.end],l=[e.top,"top"===i||"bottom"===i?(e.top+e.bottom)/2:n.y,e.bottom,t.top,"top"===o||"bottom"===o?(t.top+t.bottom)/2:r.y,t.bottom],a&&a.forEach((function(e){s.push(e.start,(e.start+e.end)/2,e.end),l.push(e.top,(e.top+e.bottom)/2,e.bottom)})),s=F()(new Set(s.sort((function(e,t){return e-t})))),d=0,v=(l=F()(new Set(l.sort((function(e,t){return e-t}))))).length;d<v;++d)for(k[d]=k[d]||{},u=l[d],f=0,h=s.length;f<h;++f){if(m=((c=s[f])<=e.start||c>=e.end||u<=e.top||u>=e.bottom)&&(c<=t.start||c>=t.end||u<=t.top||u>=t.bottom),a)for(p=0,g=a.length;m&&p<g;++p)m=c<=(y=a[p]).start||c>=y.end||u<=y.top||u>=y.bottom||c===n.x&&u===n.y||c===r.x&&u===r.y;b={distance:Math.pow(2,53)-1,permitted:m,x:c,y:u,ix:f,iy:d},k[d][f]=b,w.push(b)}return{width:s.length,height:l.length,xs:s,ys:l,points:k,linearPoints:w}}},{key:"convertDecartPointToGridPoint",value:function(e,t){var n=e.xs.indexOf(t.x),r=e.ys.indexOf(t.y);return e.points[r][n]}},{key:"findPathOnGrid",value:function(e,t,n,r,i){var o=!1;return t.permitted&&n.permitted&&(e=this.waveForward(e,t,0),o=this.collectPath(e,n,i)),o}},{key:"getGridPointNeighbors",value:function(e,t,n){var r,i=t.ix,o=t.iy,a=[];return o<e.height-1&&(r=e.points[o+1][i],(!n||n(r))&&a.push(r)),o>0&&(r=e.points[o-1][i],(!n||n(r))&&a.push(r)),i<e.width-1&&(r=e.points[o][i+1],(!n||n(r))&&a.push(r)),i>0&&(r=e.points[o][i-1],(!n||n(r))&&a.push(r)),a}},{key:"waveForward",value:function(e,t,n){var r=this;return $a.preWalkUnordered([t,n],(function(t){var n=N()(t,2),i=n[0],o=n[1];return r.getGridPointNeighbors(e,i,(function(e){return e.permitted&&e.distance>o+1})).map((function(e){return[e,o+1]}))}),(function(e){var t=N()(e,2),n=t[0],r=t[1];return n.distance=r})),e}},{key:"collectPath",value:function(e,t,n){for(var r,i,o,a,s=!0,l=[];s&&t.distance;)if(s=(r=this.getGridPointNeighbors(e,t,(function(e){return e.permitted&&e.distance==t.distance-1}))).length>0){switch(i=(r=r.sort((function(e,r){var i,o;i=e.ix-t.ix,o=e.iy-t.iy;var a=("left"===n||"right"===n)&&0===o||("top"===n||"bottom"===n)&&0===i?-1:1;i=r.ix-t.ix,o=r.iy-t.iy;var s=("left"===n||"right"===n)&&0===o||("top"===n||"bottom"===n)&&0===i?-1:1;return a>s?1:a<s?-1:a===s?e.y>r.y?-1:1:void 0})))[0],l.push({x1:i.x,y1:i.y,x2:t.x,y2:t.y}),o=i.ix-t.ix,a=i.iy-t.iy,!0){case!a&&o>0:n="left";break;case!a&&o<0:n="right";break;case!o&&a>0:n="top";break;case!o&&a<0:n="bottom"}t=i}return s&&l.reverse()||!1}},{key:"prependPathWithArrowStaffSegment",value:function(e,t,n,r){var i,o;if(e.length>0){switch(i={x2:(o=e[0]).x1,y2:o.y1},r){case"left":i.x1=t.x-n,i.y1=o.y1;break;case"right":i.x1=t.x+n,i.y1=o.y1;break;case"top":i.x1=o.x1,i.y1=t.y-n;break;case"bottom":i.x1=o.x1,i.y1=t.y+n}e.unshift(i)}return e}},{key:"appendPathWithArrowStaffSegment",value:function(e,t,n,r){var i,o;if(e.length>0){switch(i={x1:(o=e[e.length-1]).x2,y1:o.y2},r){case"left":i.x2=t.x-n,i.y2=o.y2;break;case"right":i.x2=t.x+n,i.y2=o.y2;break;case"top":i.x2=o.x2,i.y2=t.y-n;break;case"bottom":i.x2=o.x2,i.y2=t.y+n}e.push(i)}return e}},{key:"optimizePath",value:function(e){var t,n,r=[];if(e.length>0)for(t=e.shift(),r.push(t);e.length>0;)n=e.shift(),t.x1==n.x1&&t.y1==n.y1&&t.x2==n.x2&&t.y2==n.y2?t=n:t.y1-t.y2==0&&n.y1-n.y2==0?t.x2=n.x2:t.x1-t.x2==0&&n.x1-n.x2==0?t.y2=n.y2:(r.push(n),t=n);return r}},{key:"normalizeSide",value:function(e){return n.sideToSide[e]||e}}],[{key:"defaultConfig",get:function(){return{startSide:"right",startArrowSize:0,startArrowMargin:12,startShift:0,endSide:"left",endArrowSize:0,endArrowMargin:12,endShift:0,verticalMargin:2,horizontalMargin:5,otherBoxes:null}}},{key:"sideToSide",get:function(){return{l:"left",r:"right",t:"top",b:"bottom"}}}]),n}($e);function AE(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return IE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IE(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function IE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function PE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ME._$name="RectangularPathFinder";var FE={add:1,dataset:1,remove:1,removeAll:1},LE=["left","left","right","right"],BE=["left","right","left","right"],jE=function(e){Ye()(r,e);var t,n=PE(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"construct",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;if(e.isVertical)throw new Error("Dependencies feature is not supported in vertical mode");n.doScheduleDraw=n.createOnFrame("draw",[],n,!0),tt()(Ze()(r.prototype),"construct",this).call(this,e,t),n.pathFinder=new ME(n.pathFinderConfig),delete n.pathFinderConfig,n.lineDefAdjusters=n.createLineDefAdjusters(),e.rowManager.on({refresh:"onRefresh",thisObj:n})}},{key:"doDestroy",value:function(){var e;null===(e=this.tooltip)||void 0===e||e.destroy(),tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this,n=t.project;t.updateCreateListeners(),(n||e)&&(t.attachToResourceStore(e?null:n.resourceStore),t.attachToEventStore(e?null:n.eventStore),t.attachToAssignmentStore(e?null:n.assignmentStore),t.attachToDependencyStore(e?null:n.dependencyStore)),t.client.isPainted&&t.draw(),tt()(Ze()(r.prototype),"doDisable",this).call(this,e)}},{key:"findDependencyIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return e.findIndex((function(e){return e.dependency===t&&(e.assignmentData===n||e.assignmentData&&n&&e.assignmentData.from===n.from&&e.assignmentData.to===n.to)}))}},{key:"includesDependency",value:function(){return this.findDependencyIndex.apply(this,arguments)>=0}},{key:"attachToResourceStore",value:function(e){tt()(Ze()(r.prototype),"attachToResourceStore",this).call(this,e),e&&!this.disabled&&e.on({name:"resourceStore",changePreCommit:"onResourceStoreChange",refreshPreCommit:"onResourceStoreRefresh",thisObj:this})}},{key:"attachToDependencyStore",value:function(e){var t=this;tt()(Ze()(r.prototype),"attachToDependencyStore",this).call(this,e),t.resetGridCache(),t.resetBoundsCache(),e&&!t.disabled&&(e.metaMapId=t.client.id,e.on({name:"dependencyStore",changePreCommit:"onDependencyChange",idChange:"onDependencyIdChange",thisObj:t}))}},{key:"attachToAssignmentStore",value:function(e){tt()(Ze()(r.prototype),"attachToAssignmentStore",this).call(this,e),e&&!this.disabled&&e.on({name:"assignmentStore",changePreCommit:"onAssignmentChange",refreshPreCommit:"onAssignmentRefresh",thisObj:this})}},{key:"attachToEventStore",value:function(e){tt()(Ze()(r.prototype),"attachToEventStore",this).call(this,e),e&&!this.disabled&&e.on({name:"eventStore",changePreCommit:"onEventChange",batchedUpdate:"onEventBatchedUpdate",thisObj:this})}},{key:"createMarkers",value:function(){var e=this,t=e.client.svgCanvas,n=e.endMarker=e.initMarkerElement("arrowEnd","8","M0,0 L0,6 L9,3 z");if(pe.a.isEdge||pe.a.isIE11){var r=e.startMarker=e.initMarkerElement("arrowStart","1","M0,3 L9,6 L9,0 z");t.appendChild(r)}else n.setAttribute("orient","auto-start-reverse");t.appendChild(n)}},{key:"initMarkerElement",value:function(e,t,n){return mi.createElement({id:e,tag:"marker",className:"b-sch-dependency-arrow",ns:"http://www.w3.org/2000/svg",markerHeight:11,markerWidth:11,refX:t,refY:3,viewBox:"0 0 9 6",orient:"auto",markerUnits:"userSpaceOnUse",children:[{tag:"path",ns:"http://www.w3.org/2000/svg",d:n}]})}},{key:"createLineDefAdjusters",value:function(){var e=this.client;return[function(t){var n=!1;return(t.startArrowMargin>e.barMargin||t.endArrowMargin>e.barMargin)&&(t.startArrowMargin=t.endArrowMargin=e.barMargin,n=!0),n?t:n},function(e){var t=!1;return(e.startArrowMargin>0||e.endArrowMargin>0)&&(e.startArrowMargin=e.endArrowMargin=0,t=!0),t?e:t}]}},{key:"getElementForDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getElementsForDependency(e,t)[0]}},{key:"getElementsForDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n='[depId="'.concat(e.id,'"]');return t&&(n+='[fromId="'.concat(t.from.id,'"][toId="').concat(t.to.id,'"]')),Array.from(this.client.svgCanvas.querySelectorAll(n))}},{key:"resolveDependencyRecord",value:function(e){var t="string"==typeof e?e:e.getAttribute("depId");return t?this.dependencyStore.getById(t):null}},{key:"onRefresh",value:function(){this.client.isEngineReady&&this.onProjectRefresh()}},{key:"onProjectRefresh",value:function(){var e=this;if(!e.client.refreshSuspended)if(e.refreshAllWhenReady)e.resetGridCache(),e.scheduleDraw(!0),e.refreshAllWhenReady=!1;else if(e.toDrawOnProjectRefresh){var t=e._dependencyGridCache;t&&e.toDrawOnProjectRefresh.forEach((function(t){e.addToGridCache(t)})),t||e._thisIsAUsedExpression(e.dependencyGridCache),e.toDrawOnProjectRefresh.clear(),e.scheduleDraw()}}},{key:"onToggleNode",value:function(){this.resetGridCache(),this.scheduleDraw(!0)}},{key:"onViewportResize",value:function(){this.scheduleDraw(!0)}},{key:"onTranslateRow",value:function(e){var t=e.row;t.lastTop>=0&&t.top!==t.lastTop&&this.scheduleDraw(!0)}},{key:"onChangeTotalHeight",value:function(){this.client.isEngineReady&&this.scheduleDraw(!0)}},{key:"onHorizontalScroll",value:function(e){var t=e.subGrid;this.isDrawn&&t===this.client.timeAxisSubGrid&&this.scheduleDraw(!1)}},{key:"onVerticalScroll",value:function(){this.isDrawn&&this.scheduleDraw(!1)}},{key:"onRowsRefresh",value:function(){this.scheduleDraw(!0)}},{key:"onResourceStoreChange",value:function(e){var t=e.action;this.client.project.propagatingLoadChanges||FE[t]&&(this.refreshAllWhenReady=!0)}},{key:"onResourceStoreRefresh",value:function(e){var t=e.action;if(!this.client.project.propagatingLoadChanges)switch(t){case"sort":case"filter":case"batch":this.resetGridCache(),this.scheduleDraw(!0)}}},{key:"onDependencyChange",value:(t=Pt()(At.a.mark((function e(t){var n,r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.action,r=t.record,i=t.records,(a=(o=this).client).isPainted&&!a.suspendRendering&&!this.client.project.propagatingLoadChanges){e.next=4;break}return e.abrupt("return");case 4:e.t0=n,e.next="dataset"===e.t0?7:"add"===e.t0?10:"update"===e.t0?12:"remove"===e.t0?19:"removeall"===e.t0||"filter"===e.t0?22:24;break;case 7:return o.dependencyGridCache={},o.toDrawOnProjectRefresh=new Set(i),e.abrupt("return");case 10:return i.forEach((function(e){return o.toDrawOnProjectRefresh.add(e)})),e.abrupt("return");case 12:if(o.drawnDependencies.some((function(e){return e.dependency===r}))){e.next=17;break}o.addToGridCache(r),o.scheduleDraw(),e.next=18;break;case 17:return e.abrupt("return",o.scheduleRefreshDependency(r));case 18:return e.abrupt("break",24);case 19:return i.forEach((function(e){o.releaseDependency(e,!0),o.removeFromCache(e),o.dependenciesToRefresh.delete(e)})),a.trigger("dependenciesDrawn"),e.abrupt("return");case 22:return o.resetGridCache(),e.abrupt("break",24);case 24:o.scheduleDraw(!0);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onDependencyIdChange",value:function(e){var t=e.record,n=e.oldValue;this.removeFromCache(t,null,n),this.addToGridCache(t)}},{key:"onEventBatchedUpdate",value:function(e){this.client.listenToBatchedUpdates&&(e.fromBatched=!0,this.onEventChange.apply(this,arguments))}},{key:"onEventChange",value:function(e){var t=e.action,n=e.record,r=e.changes,i=e.fromBatched,o=this;if(!o.client.project.propagatingLoadChanges)switch(t){case"filter":o.scheduleDraw(!0);break;case"update":if(!i&&1===Object.keys(r).length&&(r.startDate||r.endDate||r.duration))return;if(n.isEvent){var a=[n];n.resources.forEach((function(e){return a.push.apply(a,F()(e.events))})),new Set(a).forEach((function(e){return o.drawForTimeSpan(e,!0)}))}else o.drawForTimeSpan(n,!0);break;case"removeall":o.resetGridCache(),o.scheduleDraw(!0)}}},{key:"onAssignmentRefresh",value:function(e){var t=e.action;this.client.project.propagatingLoadChanges||"dataset"===t&&(this.resetGridCache(),this.scheduleDraw(!0))}},{key:"onAssignmentChange",value:function(e){var t=e.action,n=e.record,r=e.records,i=e.changes,o=this;if(!o.client.project.propagatingLoadChanges&&(n&&(r=[n]),"filter"===t&&(o.resetGridCache(),o.scheduleDraw(!0)),"add"===t||"remove"===t||"update"===t)){if("update"===t&&2===Object.keys(i).length&&i.event&&i.resource&&!i.event.isModel&&!i.resource.isModel)return;r.forEach((function(e){var r=o.client,i=r.assignmentStore,a=r.eventStore.getById(e.eventId);a&&a.dependencies.forEach((function(r){if("add"===t)o.toDrawOnProjectRefresh.add(r);else if("remove"===t){(r.fromEvent===a?r.toEvent.assignments.map((function(t){return{from:e,to:t}})):r.fromEvent.assignments.map((function(t){return{from:t,to:e}}))).forEach((function(e){o.releaseDependency(r,e),o.removeFromCache(r,e)}))}else"update"===t&&o.getDependencyAssignmentsAsFromToArray({dependency:r,assignmentStore:i}).filter((function(e){return e.from===n||e.to===n})).forEach((function(e){o.scheduleRefreshDependency(r,e)}))}))}))}}},{key:"getDependencyAssignmentsAsFromToArray",value:function(e){var t=e.dependency,n=e.assignmentStore,r=t.fromEvent,i=t.toEvent,o=[];if(r&&i){var a=this.getEventAssignments(r,n),s=this.getEventAssignments(i,n);a.forEach((function(e){s.forEach((function(t){o.push({from:e,to:t})}))}))}return o}},{key:"getEventAssignments",value:function(e,t){if(e.isRemoved){var n,r=t.removed.values.filter((function(t){return t.event===e})),i=AE(t.assignmentsForRemoval);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.event===e&&r.push(o)}}catch(e){i.e(e)}finally{i.f()}return r}return e.assignments}},{key:"onElementClick",value:function(e){if(e.target.matches("."+this.baseCls)){var t=ls.get(e.target).dependency,n="click"===e.type?"Click":"DblClick";this.client.trigger("dependency".concat(n),{dependency:t,event:e})}}},{key:"onElementDblClick",value:function(e){return this.onElementClick(e)}},{key:"onElementMouseOver",value:function(e){var t=this;if(e.target.matches("."+t.baseCls)){var n=ls.get(e.target).dependency;t.client.trigger("dependencyMouseOver",{dependency:n,event:e}),t.overCls&&t.highlight(n,t.overCls)}}},{key:"onElementMouseOut",value:function(e){var t=this;if(e.target.matches("."+t.baseCls)){var n=ls.get(e.target).dependency;t.client.trigger("dependencyMouseOut",{dependency:n,event:e}),t.overCls&&!n.isRemoved&&t.unhighlight(n)}}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.overCls,n=this.getElementsForDependency(e);n.forEach((function(e){e.classList.add(t)})),e.highlight(t)}},{key:"unhighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.overCls,n=this.getElementsForDependency(e);n.forEach((function(e){e.classList.remove(t)})),e.unhighlight(t)}},{key:"highlightEventDependencies",value:function(e){var t=this;e.dependencies.forEach((function(e){return t.highlight(e)}))}},{key:"unhighlightEventDependencies",value:function(e){var t=this;e.dependencies.forEach((function(e){return t.unhighlight(e)}))}},{key:"isDependencyVisible",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this,o=i.client,a=o.assignmentStore,s=o.resourceStore,l=o.eventStore,u=e.fromEvent,c=e.toEvent;if(!u||!c)return!1;if(r){var f=r.from,d=r.to;if(t=f.resource,n=d.resource,!1===f.drawDependencies||!1===d.drawDependencies||l.isFiltered&&(!l.includes(u)||!l.includes(c))||a.isFiltered&&(!a.includes(f)||!a.includes(d)))return!1}else t=u.resource,n=c.resource;return!(!s.isAvailable(t)||!s.isAvailable(n))&&(u.isModel&&!t.instanceMeta(s).hidden&&!n.instanceMeta(s).hidden)}},{key:"getBox",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.getTimeSpanRecordFromDependency(e,t);return n=r?r[t?"from":"to"].resource:o.resource,this.client.getResourceEventBox(o,n,!0,i)}},{key:"getRowRecordFromDependency",value:function(e,t,n){return n?n[t?"from":"to"].resource:this.getTimeSpanRecordFromDependency(e,t).resource}},{key:"getTimeSpanRecordFromDependency",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e["".concat(t?"from":"to","Event")]}},{key:"getMetaId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?"".concat(this.client.id,"-ass").concat(e.from.id,"-ass").concat(e.to.id):this.client.id}},{key:"getDependencyBounds",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.client,o=e.getDateRange();if(!i.rowManager.rowCount||!r.isDependencyVisible(e,t))return null;if(!(o&&i.timeAxis.count&&Un.intersectSpans(o.start,o.end,i.startDate,i.endDate)))return null;var a=r.getMetaId(t),s=e.instanceMeta(a),l=r.getBox(e,!0,t,n),u=r.getBox(e,!1,t,n);if(!l||!u)return null;if(r._resetBoundsCache||!s.bounds||!s.bounds.layout){var c=r.getTimeSpanRecordFromDependency(e,!0),f=r.getTimeSpanRecordFromDependency(e,!1),d=Cr.union(l,u);i.isGantt||[[c,l,t.from],[f,u,t.to]].map((function(e){var t=N()(e,3),n=t[0],r=t[1],o=t[2];if("default"===i.milestoneLayoutMode&&n.isMilestone){if(!i.milestoneWidth){var a=i.getElementFromAssignmentRecord(o);a&&(i.milestoneWidth=a.offsetWidth)}var s=i.milestoneWidth||r.height;r.left-=s/2,r.right+=s/2}})),s.bounds={bounds:d,startRectangle:l,endRectangle:u,layout:l.layout||u.layout}}return e.instanceMeta(a).bounds}},{key:"dependencyGridCache",get:function(){var e=this;return e._dependencyGridCache||(e._dependencyGridCache={},e.dependencyStore.forEach((function(t){return e.addToGridCache(t)}))),e._dependencyGridCache},set:function(e){this._dependencyGridCache=e}},{key:"dependencyStore",get:function(){return this.project.dependencyStore}},{key:"getIteratableDependencyAssignments",value:function(e){return this.assignmentStore?this.getDependencyAssignmentsAsFromToArray({dependency:e,assignmentStore:this.assignmentStore}):[null]}},{key:"addToGridCache",value:function(e){var t=this,n=t.client,r=n.store,i=t.dependencyGridCache,o=t.cacheGridSize,a=t.getIteratableDependencyAssignments(e),s=n.startDate.getTime(),l=n.endDate.getTime(),u=Un.asMilliseconds(n.timeAxis.unit)*o.ticks;a.forEach((function(n){var a=t.getMetaId(n),c=e.instanceMeta(a).gridCache=[],f=r.indexOf(t.getRowRecordFromDependency(e,!0,n)),d=r.indexOf(t.getRowRecordFromDependency(e,!1,n)),h=e.getDateRange(),v=null==h?void 0:h.start.getTime(),p=null==h?void 0:h.end.getTime();if(-1!==f&&-1!==d&&h&&p>s&&v<l){var g,y,m,b,k,w=Math.min(f,d),C=Math.max(f,d),R=Math.floor(w/o.index),S=Math.floor(C/o.index),x=Math.floor(Math.max(v-s,0)/u),E=Math.floor(Math.max(p-s,0)/u),D="".concat(e.id,".-.").concat(a);for(b=x;b<=E;b++)for(g=i[b]||(i[b]={}),k=R;k<=S;k++)(m=(y=g[k]||(g[k]=[])).cached||(y.cached={}))[D]||(m[D]=!0,y.push({dependency:e,assignmentData:n,metaId:a})),c.push([b,k])}}))}},{key:"removeFromCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.id,r=this,i=r._dependencyGridCache;(t?[t]:this.getIteratableDependencyAssignments(e)).forEach((function(t){var o,a=r.getMetaId(t),s=e.instanceMeta(a),l="".concat(n,".-.").concat(a);i&&(null===(o=s.gridCache)||void 0===o||o.forEach((function(n){var o,a=N()(n,2),s=a[0],u=a[1];if(null!==(o=i[s])&&void 0!==o&&o.hasOwnProperty(u)){var c=r._dependencyGridCache[s][u];if(null!=c&&c.cached[l]){var f=r.findDependencyIndex(c,e,t);delete c.cached[l],f>-1&&c.splice(f,1)}}}))),s.bounds=null,s.gridCache=null}))}},{key:"resetBoundsCache",value:function(){this._resetBoundsCache=!0}},{key:"resetGridCache",value:function(){this.dependencyGridCache=null}},{key:"generateBoundaryBoxes",value:function(e,t){var n=[];return"bottom"===t?n.push({start:e.left,end:e.left+e.width/2,top:e.rowTop,bottom:e.rowBottom},{start:e.left+e.width/2,end:e.right,top:e.rowTop,bottom:e.rowBottom}):n.push({start:e.left-this.pathFinder.startArrowMargin,end:e.right+this.pathFinder.startArrowMargin,top:e.rowTop,bottom:e.rowBottom}),n}},{key:"getDependencyStartSide",value:function(e){var t=this,n=t.getTimeSpanRecordFromDependency(e,!0),r=e.type,i=e.fromSide;if(!i)switch(!0){case r===rS.Type.StartToEnd:case r===rS.Type.StartToStart:i=t.getConnectorStartSide(n);break;case r===rS.Type.EndToStart:case r===rS.Type.EndToEnd:i=t.getConnectorEndSide(n);break;default:throw new Error("Invalid dependency type: "+r)}return i}},{key:"getDependencyEndSide",value:function(e){var t=this,n=t.getTimeSpanRecordFromDependency(e,!1),r=e.type,i=e.toSide;if(!i)switch(!0){case r===rS.Type.StartToEnd:i=t.getConnectorEndSide(n);break;case r===rS.Type.StartToStart:case r===rS.Type.EndToStart:i=t.getConnectorStartSide(n);break;case r===rS.Type.EndToEnd:i=t.getConnectorEndSide(n);break;default:throw new Error("Invalid dependency type: "+r)}return i}},{key:"prepareLineDef",value:function(e,t){var n=this,r=n.getDependencyStartSide(e),i=n.getDependencyEndSide(e),o=t.startRectangle,a=t.endRectangle,s=null!=o.rowTop&&o.rowTop!==a.rowTop,l=[];s&&l.push.apply(l,F()(n.generateBoundaryBoxes(o,r)));var u=n.pathFinder,c=u.startArrowMargin,f=u.verticalMargin;return e.bidirectional||(/(top|bottom)/.test(r)&&(c=n.client.barMargin/2),f=n.client.barMargin/2),{startBox:{start:o.x,end:o.right,top:o.y,bottom:o.bottom},endBox:{start:a.x,end:a.right,top:a.y,bottom:a.bottom},otherBoxes:l,startArrowMargin:c,verticalMargin:f,otherVerticalMargin:0,otherHorizontalMargin:0,startSide:r,endSide:i}}},{key:"drawLine",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.client,s=this.getMetaId(i),l=t.instanceMeta(s).lineElement;(l&&o||(l=document.createElementNS("http://www.w3.org/2000/svg","polyline"),o&&(t.instanceMeta(s).lineElement=l),l.setAttribute("depId",t.id),i&&(l.setAttribute("fromId",i.from.id),l.setAttribute("toId",i.to.id)),e.appendChild(l)),l.classList.length&&l.classList.remove.apply(l.classList,l.getAttribute("class").split(" ")),l.classList.add(this.baseCls),t.cls&&l.classList.add(t.cls),t.bidirectional&&l.classList.add("b-sch-bidirectional-line"),t.highlighted)&&(r=l.classList).add.apply(r,F()(t.highlighted.split(" ")));if(pe.a.isIE11){var u=t.getDateRange(!0),c=a.startDate;u.start<c&&l.classList.add("b-no-start-marker"),u.end<c&&l.classList.add("b-no-end-marker")}return l.setAttribute("points",n?n.map((function(e,t){return t!==n.length-1?"".concat(e.x1,",").concat(e.y1):"".concat(e.x1,",").concat(e.y1," ").concat(e.x2,",").concat(e.y2)})).join(" "):""),ls.set(l,{dependency:t}),l}},{key:"refreshDependency",value:function(e){var t=this,n=t.getIteratableDependencyAssignments(e);t.releaseDependency(e,null!==n[0]),t.removeFromCache(e),t.addToGridCache(e),n.forEach((function(n){return t.drawDependency(e,null,n)}))}},{key:"refreshDependencyAssignment",value:function(e,t){var n=this;n.releaseDependency(e,t),n.removeFromCache(e,t),n.addToGridCache(e),n.drawDependency(e,null,t)}},{key:"scheduleRefreshDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=n.dependenciesToRefresh;if(!n.drawnDependencies.find((function(t){return t.dependency===e})))return n.removeFromCache(e),void n.addToGridCache(e);t?r.has(e)?!0!==r.get(e)&&r.get(e).add(t):r.set(e,new Set([t])):r.set(e,!0),1===r.size&&n.requestAnimationFrame((function(){return n.refreshDependencyOnFrame()}))}},{key:"getSortedDependenciesToRefresh",value:function(){return this.dependenciesToRefresh}},{key:"refreshDependencyOnFrame",value:function(){var e=this,t=e.getSortedDependenciesToRefresh();e.client.isPainted&&(t.forEach((function(t,n){if(!0===t){var r=e.getIteratableDependencyAssignments(n);e.releaseDependency(n,null!==r[0]),e.removeFromCache(n)}else t.forEach((function(t){e.releaseDependency(n,t),e.removeFromCache(n,t)}))})),t.forEach((function(t,n){e.addToGridCache(n)})),t.forEach((function(t,n){!0===t&&(t=e.getIteratableDependencyAssignments(n)),t.forEach((function(t){e.drawDependency(n,null,t)}))})),e.dependenciesToRefresh.clear(),e.client.trigger("dependenciesDrawn",{partial:!0}))}},{key:"drawDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.client.svgCanvas,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=this,a=o.drawnDependencies,s=o.oldDrawnDependencies,l=t||o.getDependencyBounds(e,n);if(!o.disabled&&l){var u=o.prepareLineDef(e,l),c=o.pathFinder.findPath(u,o.lineDefAdjusters);o.drawLine(r,e,c,n,i),i&&!this.includesDependency(a,e,n)&&a.push({dependency:e,assignmentData:n})}var f=this.findDependencyIndex(s,e,n);f>=0&&s.splice(f,1)}},{key:"drawForTimeSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;n.client.isAnimating?n.client.on({transitionend:function(){!e.isRemoved&&n.drawForTimeSpan(e,!0)},once:!0}):n.dependencyStore.getTimeSpanDependencies(e).forEach((function(e){t?n.scheduleRefreshDependency(e):n.refreshDependency(e)}))}},{key:"drawForEvent",value:function(e){this.drawForTimeSpan(e)}},{key:"updateDependenciesForTimeSpan",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this,a=e.isAssignment?e.event:e,s=o.dependencyStore.getTimeSpanDependencies(a),l=o.getMetaId(),u=o.client,c=Cr.from(t,u.timeAxisSubGridElement),f=i&&u.getRowFor(i);s.forEach((function(t){r.getIteratableDependencyAssignments(t).forEach((function(r){var i,s,u=c.clone();f&&(u.rowTop=f.top,u.rowBottom=f.bottom),r&&r.from!==e&&r.to!==e||o.isDependencyVisible(t,r)&&(o.getTimeSpanRecordFromDependency(t,!0)===a?(i=u,s=(n=t.instanceMeta(l).bounds)?n.endRectangle:o.getBox(t,!1,r)):(i=(n=t.instanceMeta(l).bounds)?n.startRectangle:o.getBox(t,!0,r),s=u),i&&s&&o.drawDependency(t,{startRectangle:i,endRectangle:s},r))}))}))}},{key:"scheduleDraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.disabled||(e&&t.resetBoundsCache(),t.client.isAnimating?t.clientTransitionRemover||(t.clientTransitionRemover=t.client.on({transitionend:function(){t.clientTransitionRemover(),t.clientTransitionRemover=null,t.draw()},once:!0})):t.doScheduleDraw())}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.client;if((t.oldDrawnDependencies||t.dependencyStore.count)&&n.isPainted)if(n.isAnimating)n.on({transitionend:function(){t.scheduleDraw(!0)},once:!0});else{var r=n.timeAxisSubGrid.viewRectangle;if(e&&t.resetBoundsCache(),r.width&&r.height){t.oldDrawnDependencies=t.drawnDependencies,t.drawnDependencies=[],r.inflate(t.bufferSize);var i=n.startDate,o=n.visibleDateRange;if(!t.disabled&&!n.suspendRendering&&n.store.count&&n.rowManager.rowCount&&i&&o.startDate&&o.endDate){if(!n.project.isInitialCommitPerformed)return t.drawnDependencies=t.oldDrawnDependencies,void(t.refreshAllWhenReady=!0);var a,s,l,u={},c=t.dependencyGridCache,f=t.cacheGridSize,d=Un.asMilliseconds(n.timeAxis.unit)*f.ticks,h=o.startDate.getTime()-i.getTime(),v=o.endDate.getTime()-i.getTime(),p=Math.floor(h/d),g=Math.floor(v/d),y=Math.floor(n.rowManager.topRow.dataIndex/f.index),m=Math.floor(n.rowManager.bottomRow.dataIndex/f.index),b=[];for(a=p;a<=g;a++)for(s=y;s<=m;s++){var k=c[a],w=null==k?void 0:k[s];for(l=0;w&&l<w.length;l++){var C=w[l],R=C.dependency,S=C.assignmentData,x=C.metaId,E=R.id+"-"+x;if(!u[E]){var D=t.getDependencyBounds(R,S);(null!=D&&D.bounds.intersect(r,!0,!0)||n.ignoreViewBox)&&b.push([R,D,S]),u[E]=!0}}}b.forEach((function(e){var n=N()(e,3),r=n[0],i=n[1],o=n[2];t.drawDependency(r,i,o)}))}t._resetBoundsCache=!1,t.oldDrawnDependencies.forEach((function(e){return t.releaseDependency(e.dependency,e.assignmentData)})),n.trigger("dependenciesDrawn"),t.isDrawn=!0}}}},{key:"releaseDependency",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!0===n){var r=Object.keys(e.meta.map||{}).filter((function(e){return e.startsWith(t.client.id)}));r.forEach((function(t){var n=e.meta.map[t];n.lineElement&&(n.lineElement.remove(),n.lineElement=null)}))}else{var i=this.getMetaId(n),o=e.instanceMeta(i).lineElement;o&&(e.instanceMeta(i).lineElement=null,o.remove())}}},{key:"render",value:function(){var e=this,t=e.client;e.showTooltip&&(e.tooltip=e.createTooltip()),t.timeAxis.on({endreconfigure:"resetGridCache",thisObj:e}),t.rowManager.on({refresh:"onRowsRefresh",changetotalheight:"onChangeTotalHeight",thisObj:e}),t.on({horizontalscroll:"onHorizontalScroll",svgcanvascreated:"createMarkers",togglenode:"onToggleNode",scroll:"onVerticalScroll",timelineviewportresize:"onViewportResize",thisObj:e}),e.highlightDependenciesOnEventHover&&(t.on(t.scheduledEventName+"MouseEnter",(function(t){return e.highlightEventDependencies(t.eventRecord||t.taskRecord)})),t.on(t.scheduledEventName+"MouseLeave",(function(t){return e.unhighlightEventDependencies(t.eventRecord||t.taskRecord)})))}},{key:"renderContents",value:function(){this.draw()}},{key:"getConnectorStartSide",value:function(e){return this.client.currentOrientation.getConnectorStartSide(e)}},{key:"getConnectorEndSide",value:function(e){return this.client.currentOrientation.getConnectorEndSide(e)}},{key:"createTooltip",value:function(){var e=this,t=e.client;return kh.new({align:"b-t",id:"".concat(t.id,"-dependency-tip"),forSelector:".b-timelinebase:not(.b-eventeditor-editing):not(.b-resizing-event):not(.b-dragcreating):not(.b-dragging-event):not(.b-creating-dependency) .".concat(e.baseCls),clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],forElement:t.timeAxisSubGridElement,showOnHover:!0,hoverDelay:0,hideDelay:0,anchorToTarget:!1,textContent:!1,trackMouse:!1,getHtml:e.getHoverTipHtml.bind(e)},e.tooltip||{})}},{key:"getHoverTipHtml",value:function(e){var t=e.activeTarget,n=this,r=n.resolveDependencyRecord(t),i=r.fromEvent,o=r.toEvent;return ud.tpl(OE||(OE=sv()(['\n             <table class="b-sch-dependency-tooltip">\n                <tr>\n                    <td>',": </td>\n                    <td>",'</td>\n                    <td>\n                        <div class="b-sch-box b-','"></div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>',": </td>\n                    <td>",'</td>\n                    <td><div class="b-sch-box b-','"></div></td>\n                </tr>\n            </table>\n        '])),n.L("L{from}"),te.encodeHtml(i.name),LE[r.type],n.L("L{to}"),te.encodeHtml(o.name),BE[r.type])}}],[{key:"$name",get:function(){return"Dependencies"}},{key:"defaultConfig",get:function(){return{pathFinderConfig:null,overCls:"b-sch-dependency-over",baseCls:"b-sch-dependency",highlightDependenciesOnEventHover:!1,showTooltip:!0,tooltip:null,bufferSize:50,cacheGridSize:{ticks:25,index:25}}}},{key:"properties",get:function(){return{toDrawOnProjectRefresh:new Set,dependenciesToRefresh:new Map,drawnDependencies:[],drawnLines:[]}}},{key:"pluginConfig",get:function(){return{chain:["render","renderContents","onElementClick","onElementDblClick","onElementMouseOver","onElementMouseOut","onProjectRefresh"],assign:["getElementForDependency","getElementsForDependency","resolveDependencyRecord"]}}},{key:"getLocalizedDependencyType",value:function(e){return e?this.L("L{DependencyType.".concat(e,"}")):""}}]),r}(_i.mixin(DE,Px,el));function _E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}jE._$name="Dependencies",ty.registerFeature(jE,!1,["Scheduler","ResourceHistogram"]),ty.registerFeature(jE,!0,"SchedulerPro"),document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))&&function(e){if("Element"in e){var t="classList",n=e.Element.prototype,r=Object,i=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},a=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},s=function(e,t){if(""===t)throw new a("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(t))throw new a("INVALID_CHARACTER_ERR","The token must not contain space characters.");return o.call(e,t)},l=function(e){for(var t=i.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],r=0,o=n.length;r<o;r++)this.push(n[r]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},u=l.prototype=[],c=function(){return new l(this)};if(a.prototype=Error.prototype,u.item=function(e){return this[e]||null},u.contains=function(e){return~s(this,e+"")},u.add=function(){var e,t=arguments,n=0,r=t.length,i=!1;do{e=t[n]+"",~s(this,e)||(this.push(e),i=!0)}while(++n<r);i&&this._updateClassName()},u.remove=function(){var e,t,n=arguments,r=0,i=n.length,o=!1;do{for(e=n[r]+"",t=s(this,e);~t;)this.splice(t,1),o=!0,t=s(this,e)}while(++r<i);o&&this._updateClassName()},u.toggle=function(e,t){var n=this.contains(e),r=n?!0!==t&&"remove":!1!==t&&"add";return r&&this[r](e),!0===t||!1===t?t:!n},u.replace=function(e,t){var n=s(e+"");~n&&(this.splice(n,1,t),this._updateClassName())},u.toString=function(){return this.join(" ")},r.defineProperty){var f={get:c,enumerable:!0,configurable:!0};try{r.defineProperty(n,t,f)}catch(e){void 0!==e.number&&-2146823252!==e.number||(f.enumerable=!1,r.defineProperty(n,t,f))}}else r.prototype.__defineGetter__&&n.__defineGetter__(t,c)}}(window),function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){for(var n=0,r=arguments.length;n<r;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(e,t){var n=this.toString().split(" "),r=n.indexOf(e+"");~r&&(n=n.slice(r),this.remove.apply(this,n),this.add(t),this.add.apply(this,n.slice(1)))}),e=null}();var HE=function(e){Ye()(n,e);var t=_E(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"processWidgetConfig",value:function(e){var t=this.dependencyEditFeature;return!("lagField"===e.ref&&!t.showLagField)&&(!("deleteButton"===e.ref&&!t.showDeleteButton)&&(Object.assign(e,{}),tt()(Ze()(n.prototype),"processWidgetConfig",this).call(this,e)))}},{key:"afterShow",value:function(){var e,t=this.widgetMap.deleteButton;t&&(t.hidden=!this.record.isPartOfStore());for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=tt()(Ze()(n.prototype),"afterShow",this)).call.apply(e,[this].concat(i))}},{key:"onInternalKeyDown",value:function(e){this.trigger("keyDown",{event:e}),tt()(Ze()(n.prototype),"onInternalKeyDown",this).call(this,e)}}],[{key:"$name",get:function(){return"DependencyEditor"}},{key:"defaultConfig",get:function(){return{items:[],draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible"}}}]),n}(xf);function NE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}HE._$name="DependencyEditor";var zE=function(e){Ye()(i,e);var t,n,r=NE(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"construct",value:function(e,t){var n,r=this;if(e.dependencyEdit=r,tt()(Ze()(i.prototype),"construct",this).call(this,e,t),!e.features.dependencies)throw new Error("Dependencies feature required when using DependencyEdit");r.clientListenersDetacher=e.on((n={},Qe()(n,r.triggerEvent,r.onActivateEditor),Qe()(n,"thisObj",r),n))}},{key:"doDestroy",value:function(){var e;this.clientListenersDetacher(),null===(e=this.editor)||void 0===e||e.destroy(),tt()(Ze()(i.prototype),"doDestroy",this).call(this)}},{key:"editorConfig",get:function(){return this._editorConfig},set:function(e){var t=this.getDefaultConfiguration().editorConfig;(e=Qn.assign({},t,e)).items=e.items||[],this._editorConfig=e}},{key:"isValid",get:function(){return Object.values(this.editor.widgetMap).every((function(e){return!(e.name&&!e.hidden)||!1!==e.isValid}))}},{key:"values",get:function(){var e={};return this.editor.eachWidget((function(t){t.name&&!t.hidden&&(e[t.name]=t.value)}),!0),e}},{key:"onBeforeSave",value:function(e){}},{key:"onAfterSave",value:function(e){}},{key:"updateRecord",value:function(e){var t=this.values;t.lag&&(t.lagUnit=t.lag.unit,t.lag=t.lag.magnitude),"type"in t&&(null!=e.fromSide&&(t.fromSide=null),null!=e.toSide&&(t.toSide=null)),Qn.cleanupProperties(t,!0),e.set(t)}},{key:"onPopupKeyDown",value:function(e){var t=e.event;"Enter"===t.key&&this.saveAndCloseOnEnter&&"input"===t.target.tagName.toLowerCase()&&(t.preventDefault(),this.onSaveClick())}},{key:"onSaveClick",value:function(){this.save()&&this.editor.hide()}},{key:"onDeleteClick",value:function(){this.deleteDependency(),this.editor.hide()}},{key:"onCancelClick",value:function(){this.editor.hide()}},{key:"internalShowEditor",value:function(e){var t=this,n=t.client,r=t.lastPointerDownCoordinate;if(!1!==n.trigger("beforeDependencyEdit",{dependencyEdit:t,dependencyRecord:e})){var i=t.getEditor(e);if(t.loadRecord(e),n.trigger("beforeDependencyEditShow",{dependencyEdit:t,dependencyRecord:e,editor:i}),!r){var o=Cr.from(t.client.element).center;r=[o.x-i.width/2,o.y-i.height/2]}i.showByPoint(r)}}},{key:"editDependency",value:function(e){this.client.readOnly||this.internalShowEditor(e)}},{key:"getEditor",value:function(){var e,t,n,r=this,i=r.editor;return i||(0===(i=r.editor=HE.new({dependencyEditFeature:r,autoShow:!1,anchor:!0,scrollAction:"realign",clippedBy:[r.client.timeAxisSubGridElement,r.client.bodyContainer],constrainTo:window,autoClose:r.autoClose,cls:r.cls,rootElement:r.client.rootElement,listeners:{keydown:r.onPopupKeyDown,thisObj:r}},r.editorConfig)).items.length&&console.warn("Editor configured without any `items`"),i.eachWidget((function(e){var t=e.ref||e.id;t&&!r[t]&&(r[t]=e)})),null===(e=r.saveButton)||void 0===e||e.on("click",r.onSaveClick,r),null===(t=r.deleteButton)||void 0===t||t.on("click",r.onDeleteClick,r),null===(n=r.cancelButton)||void 0===n||n.on("click",r.onCancelClick,r),r.editor)}},{key:"loadRecord",value:function(e){var t=this;t.fromNameField.value=e.fromEvent.name,t.toNameField.value=e.toEvent.name,t.lagField&&(t.lagField.unit=e.lagUnit),t.editor.record=t.dependencyRecord=e}},{key:"save",value:(n=Pt()(At.a.mark((function e(){var t,n,r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).client,(r=t.dependencyRecord)&&t.isValid){e.next=3;break}return e.abrupt("return");case 3:if(i=t.dependencyStore,o=t.values,!1===n.trigger("beforeDependencySave",{dependencyRecord:r,values:o})){e.next=15;break}if(t.onBeforeSave(r),t.updateRecord(r),!i||r.stores.length){e.next=11;break}if(!1!==n.trigger("beforeDependencyAdd",{dependencyRecord:r,dependencyEdit:t})){e.next=10;break}return e.abrupt("return");case 10:i.add(r);case 11:return e.next=13,null===(a=n.project)||void 0===a?void 0:a.commitAsync();case 13:n.trigger("afterDependencySave",{dependencyRecord:r}),t.onAfterSave(r);case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"deleteDependency",value:(t=Pt()(At.a.mark((function e(){var t,n,r,i;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.client,n=this.editor,r=this.dependencyRecord,!1===t.trigger("beforeDependencyDelete",{dependencyRecord:r})){e.next=7;break}return n.containsFocus&&n.revertFocus(),t.dependencyStore.remove(r),e.next=6,null===(i=t.project)||void 0===i?void 0:i.commitAsync();case 6:return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"dependencyStore",get:function(){return this.client.dependencyStore}},{key:"onActivateEditor",value:function(e){var t=e.dependency,n=e.event;this.disabled||(this.lastPointerDownCoordinate=[n.clientX,n.clientY],this.editDependency(t))}}],[{key:"$name",get:function(){return"DependencyEdit"}},{key:"defaultConfig",get:function(){var e=this;return{autoClose:!0,saveAndCloseOnEnter:!0,showDeleteButton:!0,triggerEvent:"dependencydblclick",showLagField:!1,dependencyRecord:null,editorConfig:{title:"L{Edit dependency}",localeClass:this,closable:!0,defaults:{localeClass:this},items:{fromNameField:{type:"display",label:"L{From}",editable:!1},toNameField:{type:"display",label:"L{To}"},typeField:{type:"combo",label:"L{Type}",name:"type",editable:!1,valueField:"id",displayField:"name",items:Object.keys(rS.Type).map((function(t){return{id:rS.Type[t],name:e.L(t)}}))},lagField:{type:"duration",label:"L{Lag}",name:"lag",allowNegative:!0}},bbar:{defaults:{localeClass:this},items:{foo:{type:"widget",cls:"b-label-filler"},saveButton:{color:"b-green",text:"L{Save}"},deleteButton:{color:"b-gray",text:"L{Delete}"},cancelButton:{color:"b-gray",text:"L{Object.Cancel}"}}}}}}}]),i}(_i);function VE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}zE._$name="DependencyEdit",ty.registerFeature(zE,!1);var WE=function(e){Ye()(n,e);var t=VE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onElementKeyDown",value:function(e){!e.handled&&e.target.matches(this.client.eventSelector)&&" "===e.key&&this.internalShowContextMenu(this.createContextMenuEventForElement(e.target))}},{key:"getDataFromEvent",value:function(e){var t=tt()(Ze()(n.prototype),"getDataFromEvent",this).call(this,e),r=t.targetElement,i=this.client,o=i.resolveEventRecord(r),a=o&&(i.resolveResourceRecord(r)||i.resourceStore.last),s=o&&i.resolveAssignmentRecord(r);return Object.assign(t,{eventElement:r,eventRecord:o,resourceRecord:a,assignmentRecord:s})}},{key:"getTargetElementFromEvent",value:function(e){var t=e.target;return mi.up(t,this.client.eventSelector)||t}},{key:"shouldShowMenu",value:function(e){return e.eventRecord}},{key:"showContextMenuFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.targetElement,r=t.event;this.disabled||(n||(n=this.getElementFromRecord(e)))&&(r=r||this.createContextMenuEventForElement(n),this.internalShowContextMenu(r))}},{key:"getElementFromRecord",value:function(e){return this.client.getElementsFromEventRecord(e)[0]}},{key:"populateEventMenu",value:function(e){var t=e.items,n=this.client;t.deleteEvent={hidden:n.readOnly},t.unassignEvent={hidden:n.readOnly||n.eventStore.usesSingleAssignment}}},{key:"changeItems",value:function(e){var t=this.client;return he.merge({deleteEvent:{text:"L{SchedulerBase.Delete event}",icon:"b-icon b-icon-trash",weight:200,onItem:function(e){var n,r=e.menu,i=e.eventRecord,o=null===(n=r.focusInEvent)||void 0===n?void 0:n.relatedTarget;o&&(o.focus(),t.navigator.activeItem=o),t.removeEvents(t.isEventSelected(i)?t.selectedEvents:[i])}},unassignEvent:{text:"L{SchedulerBase.Unassign event}",icon:"b-icon b-icon-unassign",weight:300,name:"unassignEvent",onItem:function(e){var n,r=e.menu,i=e.eventRecord,o=e.resourceRecord,a=null===(n=r.focusInEvent)||void 0===n?void 0:n.relatedTarget;a&&(a.focus(),t.navigator.activeItem=a),i.unassign(o)}}},e)}},{key:"changeMenu",value:function(e,t){return e&&(e.clippedBy=void 0),tt()(Ze()(n.prototype),"changeMenu",this).call(this,e,t)}}],[{key:"$name",get:function(){return"EventMenu"}},{key:"configurable",get:function(){return{processItems:null,type:"event"}}},{key:"pluginConfig",get:function(){var e=tt()(Ze()(n),"pluginConfig",this);return e.chain.push("populateEventMenu"),e}}]),n}(cE);function $E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}WE.featureClass="",WE._$name="EventMenu",ty.registerFeature(WE,!0,"Scheduler"),ty.registerFeature(WE,!1,"ResourceHistogram");var UE=function(e){Ye()(n,e);var t=$E(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),this.scheduler=e,z.a.deprecate("Scheduler","5.0.0","`EventContextMenu` feature is deprecated, in favor of `EventMenu` feature. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."),e.features.eventMenu&&(e.features.eventMenu.disabled=!0)}}],[{key:"$name",get:function(){return"EventContextMenu"}}]),n}(WE);function GE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}UE.featureClass="",UE._$name="EventContextMenu",ty.registerFeature(UE),ty.registerFeature(UE,!1,"ResourceHistogram");var YE=function(e){Ye()(n,e);var t=GE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){e.useBackgroundCanvas=!0,e.on("scheduleclick",this.onSchedulerClick,this),this.scheduler=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"render",value:function(){var e=this.scheduler;this.element=mi.createElement({parent:e.backgroundCanvas,className:"b-schedule-selected-tick",style:"".concat(e.isVertical?"height":"width",":").concat(e.tickSize,"px;")})}},{key:"onSchedulerClick",value:function(e){var t,n=this.scheduler,r=this.element,i=e.tickStartDate,o=e.tickEndDate,a=e.resourceRecord,s=n.currentOrientation.getTimeSpanRenderData({startDate:i,endDate:o,startDateMS:i.getTime(),endDateMS:o.getTime()},a);if(n.isVertical)t=s.top,r.style.width=s.width+"px";else{var l=n.getRowFor(a);t=l.top,r.style.height=l.height+"px"}mi.setTranslateXY(r,s.left,t)}}],[{key:"$name",get:function(){return"ScheduleContext"}},{key:"pluginConfig",get:function(){return{after:["render"]}}}]),n}(_i);function qE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}YE.featureClass="b-scheduler-context",YE._$name="ScheduleContext",ty.registerFeature(YE,!1,["Scheduler"]);var KE=function(e){Ye()(n,e);var t=qE(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),e.features.scheduleContext&&(e.features.scheduleContext.disabled=!1),e.on("scheduleclick",this.onSchedulerClick,this),this.scheduler=e}},{key:"onEventDataGenerated",value:function(e){var t=e.eventRecord;e.cls["b-cut-item"]=t.meta.isCut}},{key:"onSchedulerClick",value:function(e){this._cellClickedContext=e}},{key:"onElementKeyDown",value:function(e){if(e.ctrlKey)switch(e.key.toLowerCase()){case"c":this.onCtrlCKey();break;case"x":this.onCtrlXKey();break;case"v":this.onCtrlVKey()}}},{key:"copyEvents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.scheduler;r.readOnly||(n._isCut=t,n.recordsFromClipboard=e||r.selectedEvents,r.eventStore.forEach((function(e){e.meta.isCut=n._isCut&&n.recordsFromClipboard.includes(e)})),r.refreshWithTransition())}},{key:"onCtrlCKey",value:function(){this.copyEvents()}},{key:"onCtrlXKey",value:function(){this.copyEvents(null,!0)}},{key:"onCtrlVKey",value:function(){var e=this._cellClickedContext||{},t=e.date,n=e.resourceRecord;this.pasteEvents(t,n)}},{key:"pasteEvents",value:function(e,t){var n=this,r=n.recordsFromClipboard;r.length&&(r.forEach((function(r){var i={};t&&(i.resourceId=t.id),e&&Object.assign(i,{startDate:e,endDate:Un.add(e,r.duration,r.durationUnit)}),n._isCut?(r.set(i),r.meta.isCut=!1):(i.name="".concat(r.name," - copy"),n.scheduler.eventStore.add(r.copy(i)))})),n._isCut&&(n._isCut=!1,n.recordsFromClipboard=[]))}},{key:"populateEventMenu",value:function(e){var t=e.eventRecord,n=e.items,r=this;r.scheduler.readOnly||(n.copyEvent={text:"L{copyEvent}",localeClass:r,icon:"b-icon b-icon-copy",weight:110,onItem:function(){return r.copyEvents([t],!1)}},n.cutEvent={text:"L{cutEvent}",localeClass:r,icon:"b-icon b-icon-cut",weight:120,onItem:function(){return r.copyEvents([t],!0)}})}},{key:"populateScheduleMenu",value:function(e){var t=e.items,n=this,r=n.scheduler;!r.readOnly&&n.recordsFromClipboard.length&&(t.pasteEvent={text:"L{pasteEvent}",localeClass:n,icon:"b-icon b-icon-paste",disabled:0===r.resourceStore.count,weight:110,onItem:function(e){var t=e.date,i=e.resourceRecord;return n.pasteEvents(t,i,r.getRowFor(i))}})}}],[{key:"$name",get:function(){return"EventCopyPaste"}},{key:"pluginConfig",get:function(){return{assign:["copyEvents","pasteEvents"],chain:["onElementKeyDown","populateEventMenu","populateScheduleMenu","onEventDataGenerated"]}}},{key:"properties",get:function(){return{recordsFromClipboard:[]}}}]),n}(_i);function XE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ZE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?XE(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function JE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}KE.featureClass="b-event-copypaste",KE._$name="EventCopyPaste",ty.registerFeature(KE,!0,"Scheduler");var QE=function(e){Ye()(i,e);var t,n,r=JE(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"scheduler",get:function(){return this.client}},{key:"isElementDraggable",value:function(e,t){var n=this.scheduler,r=mi.up(e,n.eventSelector),i=n.features.eventResize;if(!r||this.disabled)return!1;if(e.matches('[class$="-handle"]'))return!1;var o=n.resolveEventRecord(r),a=null==o?void 0:o.resizable;return!(a&&i&&!i.disabled&&!o.isMilestone&&((!0===a||"start"===a)&&i.isOverStartHandle(t,r)||(!0===a||"end"===a)&&i.isOverEndHandle(t,r)))&&!n.readOnly}},{key:"getTriggerParams",value:function(e){var t=e.assignmentRecords,n=e.eventRecords;return{context:e,draggedRecords:n,eventRecords:n,resourceRecord:e.resourceRecord,assignmentRecords:t,event:e.browserEvent}}},{key:"triggerEventDrag",value:function(e,t){e.startDate-t==0&&e.newResource===e.resourceRecord||this.scheduler.trigger("eventDrag",Object.assign(this.getTriggerParams(e),{startDate:e.startDate,endDate:e.endDate,newResource:e.newResource}))}},{key:"triggerDragStart",value:function(e){this.drag.startEvent.ignoreNavigation=!0,this.scheduler.trigger("eventDragStart",this.getTriggerParams(e))}},{key:"triggerDragAbort",value:function(e){this.scheduler.trigger("eventDragAbort",this.getTriggerParams(e))}},{key:"triggerAfterDrop",value:function(e,t){this.currentOverClient.trigger("afterEventDrop",Object.assign(this.getTriggerParams(e),{valid:t}))}},{key:"onDragAbort",value:function(){var e=this,t=this.client,n=t.assignmentStore,r=t.eventStore,o=this.dragData.initialAssignmentsState.find((function(t,i){var o,a=t.resource,s=t.assignment;return!n.includes(s)||!r.includes(s.event)||a.id!==(null===(o=e.dragData.assignmentRecords[i])||void 0===o?void 0:o.resourceId)}));o&&this.client.refresh(),tt()(Ze()(i.prototype),"onDragAbort",this).apply(this,arguments)}},{key:"isValidDrop",value:function(e){var t=e.newResource,n=e.resourceRecord,r=e.draggedEntities[0];return!(!t||t.isSpecialRow)&&(n===t||!r.event.resources.includes(t))}},{key:"checkDragValidity",value:function(e,t){var n=this,r=n.currentOverClient,i=n.dragData.context.valid;return i&&(i=r.allowOverlap||r.isDateRangeAvailable(e.startDate,e.endDate,e.draggedEntities[0],e.newResource)?n.validatorFn.call(n.validatorFnThisObj||n,e,t):{valid:!1,message:n.L("L{eventOverlapsExisting}")}),i}},{key:"updateRecords",value:(n=Pt()(At.a.mark((function e(t){var n,r,i,o,a;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=this).scheduler,i=n.currentOverClient,o=!1,r.eventStore.suspendAutoCommit(),i.eventStore.suspendAutoCommit(),e.next=5,n.updateAssignments(r,i,t,o);case 5:return a=e.sent,r.eventStore.resumeAutoCommit(),i.eventStore.resumeAutoCommit(),i.trigger("eventDrop",Object.assign(n.getTriggerParams(t),{isCopy:o,event:t.browserEvent,targetEventRecord:t.targetEventRecord,targetResourceRecord:t.newResource})),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateAssignments",value:(t=Pt()(At.a.mark((function e(t,n,r,i){var o,a,s,l,u,c,f,d,h,v,p,g,y,m,b,k,w,C,R,S,x,E,D,T,O,M,A,I,P,F,L,B,j,_=this;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this,a=t!==n,s="vertical"===n.mode,l=t.assignmentStore,u=t.eventStore,c=t.resourceStore,f=n.assignmentStore,d=n.eventStore,h=n.resourceStore,v=r.eventRecords,p=r.assignmentRecords,g=r.timeDiff,y=r.initialAssignmentsState,m=r.resourceRecord,b=r.newResource,k=o.unifiedDrag,w=o.adjustStartDate(p[0].event.startDate,g),C=[],R=[],S=[],x=[],E=[],D=new Set,T=new Set,t.suspendRefresh(),n.suspendRefresh(),O=!1,M=!1,A=a?h.indexOf(b)-c.indexOf(m):o.constrainDragToResource?0:c.indexOf(m)-c.indexOf(b),s&&v.forEach((function(e,n){var i=r.eventBarEls[n];delete e.instanceMeta(t).hasTemporaryDragElement,i.dataset.transient&&i.remove()})),I=r.eventBarEls.slice(),P=function(e){var t=p[e],n=t.event;if(!(t.isOccurrenceAssignment||l.includes(t)&&u.includes(n)))return I[e].remove(),I.splice(e,1),p.splice(e,1),e--,F=e,"continue";var r=y[e],s=n,h=r.startDate,v=r.resource,m=_.constrainDragToTimeSlot?h:k?w:o.adjustStartDate(h,g);if(D.add(v),i)t=t.copy(null),S.push(t);else if(l!==f){var P=s.assignments.length>1,L=t.copy();if(x.push(t),P||R.push(s),!d.getById(s.id)){var B=Object.assign({},s.data,{id:s.id,calendar:null});n=B,C.push(B)}d.usesSingleAssignment||S.push(L),t=L}var j,H=b;if(!k)if(a){if(e>0){var N=v.resourceStore.indexOf(v);H=H.resourceStore.getAt(N+A)||H}}else if(0!==A){var z=Math.max(Math.min(c.indexOf(v)-A,c.count-1),0);H=c.getAt(z)}else H=v;D.add(H),t.resource!==H&&(t.resource=H,n.isEvent&&T.add(n),O=!0,n.isOccurrence&&n.set("newResource",H),a&&d.usesSingleAssignment&&(n.resourceId=H.id)),E.find((function(e){return e.draggedEvent===n}))||Un.isEqual(n.startDate,m)||(n.startDate=m,E.push({draggedEvent:n,originalStartDate:h}),n.isEvent&&T.add(n),M=!0,null===(j=n.resources)||void 0===j||j.forEach((function(e){return D.add(e)}))),F=e},F=0;case 9:if(!(F<p.length)){e.next=16;break}if("continue"!==P(F)){e.next=13;break}return e.abrupt("continue",13);case 13:F++,e.next=9;break;case 16:if(l.remove(x),u.remove(R),f.add(S),L=d.add(C),!o.constrainDragToTimeline)for(B=function(e){var i=p[e].event,o=(null==L?void 0:L.find((function(e){return e.id===i.id})))||i,a=r.eventBarEls[e],s=0===e?r.context.element:r.context.relatedElements[e-1],l=n.isInTimeAxis(o);if(du.removeChild(t.foregroundCanvas,a),o.resource&&n.rowManager.getRowFor(o.resource)&&l){var u=Cr.from(s,n.foregroundCanvas,!0);mi.setTranslateXY(s,u.x,u.y),s.classList.remove("b-sch-event-hover"),s.classList.remove("b-active"),s.classList.remove("b-drag-proxy"),s.classList.remove("b-dragging"),s.retainElement=!1,du.addChild(n.foregroundCanvas,s,o.assignments[0].id)}},j=0;j<p.length;j++)B(j);if(null==L||L.forEach((function(e){return T.add(e)})),(x.length||R.length||S.length||C.length)&&(O=!0),!O&&!M){e.next=28;break}return d.usesSingleAssignment&&T.forEach((function(e){return e.beginBatch()})),e.next=27,Promise.all([n.project!==t.project?n.project.commitAsync():null,t.project.commitAsync()]);case 27:d.usesSingleAssignment&&T.forEach((function(e){return e.endBatch(!1,!0)}));case 28:O||(O=E.some((function(e){var t=e.draggedEvent,n=e.originalStartDate;return!Un.isEqual(t.startDate,n)}))),n.resumeRefresh(),t.resumeRefresh(),p.length>0&&(O?(n.refreshWithTransition(),a&&t.refreshWithTransition()):r.valid=!1);case 32:case"end":return e.stop()}}),e,this)}))),function(e,n,r,i){return t.apply(this,arguments)})},{key:"getProductDragContext",value:function(e){var t,n=this.scheduler.resolveEventRecord(e.browserEvent.target);t=this.constrainDragToResource?e.resourceRecord:this.constrainDragToTimeline?this.resolveResource()||e.newResource||e.resourceRecord:this.resolveResource();var r=e.assignmentRecords,i=e.eventRecords;return{valid:Boolean(t),draggedRecords:i,eventRecords:i,assignmentRecords:r,newResource:t,targetEventRecord:n}}},{key:"getMinimalDragData",value:function(e){var t=this,n=t.scheduler,r=t.getElementFromContext(e),i=n.resolveEventRecord(r),o=n.resolveResourceRecord(r),a=n.resolveAssignmentRecord(r),s=a?[a]:[];return n.multiEventSelect&&a&&(n.isAssignmentSelected(s[0])||t.drag.startEvent.ctrlKey)&&s.push.apply(s,t.getRelatedRecords(a)),{eventRecord:i,resourceRecord:o,assignmentRecord:a,eventRecords:F()(new Set(s.map((function(e){return e.event})))),assignmentRecords:s}}},{key:"setupProductDragData",value:function(e){var t=this,n=t.scheduler,r=t.getElementFromContext(e),i=t.getMinimalDragData(e),o=i.eventRecord,a=i.resourceRecord,s=i.assignmentRecord,l=i.assignmentRecords,u=Cr.from(r),c=[];if(t.constrainDragToResource&&!a)throw new Error("Resource could not be resolved for event: "+o.id);var f=n.getDateConstraints(t.constrainDragToResource?a:null,o);return t.constrainDragToTimeline&&t.setupConstraints(n.getScheduleRegion(t.constrainDragToResource?a:null,o),u,n.timeAxisViewModel.snapPixelAmount,Boolean(f)),l.forEach((function(e){var t=n.getElementFromAssignmentRecord(e);t||(t=(t=n.currentOrientation.addTemporaryDragElement(e.event,e.resource)).innerElement),c.push(t)})),c.forEach((function(e,t){return c[t]=e.parentNode})),{record:s,draggedEntities:l,dateConstraints:f,eventBarEls:c}}},{key:"getDragData",value:function(e){var t=this.getMinimalDragData(e)||{};return ZE(ZE(ZE({},tt()(Ze()(i.prototype),"getDragData",this).call(this,e)),t),{},{initialAssignmentsState:t.assignmentRecords.map((function(e){return{startDate:e.event.startDate,resource:e.resource,assignment:e}}))})}},{key:"getRelatedRecords",value:function(e){return this.scheduler.selectedAssignments.filter((function(t){return t!==e&&t.event.isDraggable}))}},{key:"getCoordinate",value:function(e,t,n){var r=this.currentOverClient;if(r.isHorizontal){var i=n[0];if("default"!==r.milestoneLayoutMode&&e.isMilestone)switch(r.milestoneAlign){case"center":i+=t.offsetWidth/2;break;case"end":i+=t.offsetWidth}return i}var o=n[1];if("default"!==r.milestoneLayoutMode&&e.isMilestone)switch(r.milestoneAlign){case"center":o+=t.offsetHeight/2;break;case"end":o+=t.offsetHeight}return o}},{key:"resolveResource",value:function(){var e,t=this.dragData.dragProxy||this.dragData.context.element,n=this.currentOverClient,r=n.isHorizontal,i=this.dragData.context,o=Cr.from(t,null,!0),a=n.isVertical||this.unifiedDrag?i.clientY:o.center.y,s=Cr.from(t,n.timeAxisSubGridElement,!0).center,l=s.x,u=s.y;if(r){var c=n.rowManager.getRowAt(a);e=c&&n.resourceStore.getAt(c.dataIndex)}else e=n.resolveResourceRecord(n.timeAxisSubGridElement.querySelector(".b-sch-timeaxis-cell"),[l,u]);return e}},{key:"adjustStartDate",value:function(e,t){var n=this.currentOverClient;return n.timeAxis.roundDate(new Date(e-0+t),!!n.snapRelativeToEventStartDate&&e)}},{key:"getRecordElement",value:function(e){return this.scheduler.getElementFromAssignmentRecord(e,!0)}}],[{key:"$name",get:function(){return"EventDrag"}},{key:"defaultConfig",get:function(){return{constrainDragToResource:!1,constrainDragToTimeSlot:!1,validatorFn:function(){},validatorFnThisObj:null,unifiedDrag:null}}}]),i}(Wx);function eD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}QE._$name="EventDrag",ty.registerFeature(QE,!0,"Scheduler"),ty.registerFeature(QE,!1,"ResourceHistogram");var tD=function(e){Ye()(n,e);var t=eD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.scheduler=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"store",get:function(){return this.scheduler.eventStore}},{key:"handleBeforeDragCreate",value:function(e,t,n){var r=this.scheduler.trigger("beforeDragCreate",{resourceRecord:e.resourceRecord,date:e.mousedownDate,event:n});return this.dateConstraints=this.scheduler.getDateConstraints(e.resourceRecord,t),r}},{key:"dragStart",value:function(e){var t,r=this,i=r.client,o=i.isHorizontal?"X":"Y",a=i.timeAxis,s=i.eventStore,l=i.enableEventAnimations,u=i.features,c=e.event,f=e.mousedownDate,d=e.date,h=e.resourceRecord,v=r.draggingEnd=c["page".concat(o)]>e.startEvent["page".concat(o)],p=s.createRecord({name:s.modelClass.fieldMap.name.defaultValue||r.L("L{Object.newEvent}"),startDate:Un.floor(v?f:d,a.resolution),endDate:Un.ceil(v?d:f,a.resolution)}),g=Boolean(u.eventEdit&&!u.eventEdit.disabled||u.taskEdit&&!u.taskEdit.disabled||u.simpleEventEdit&&!u.simpleEventEdit.disabled),y=[h];return p.set("duration",Un.diff(p.startDate,p.endDate,p.durationUnit,!0)),p.isCreating=g,!1!==r.handleBeforeDragCreate(e,p,e.event)&&(h&&s.assignEventToResource(p,h),!1!==i.trigger("beforeEventAdd",{eventRecord:p,resourceRecords:y})&&(null===(t=i.onEventCreated)||void 0===t||t.call(i,p),i.enableEventAnimations=!1,s.add(p),i.project.commitAsync().then((function(){return i.enableEventAnimations=l})),i.isCreating=!0,i.refreshRows(),i.isCreating=!1,e.itemElement=e.element=i.getEventElement(p),tt()(Ze()(n.prototype),"dragStart",this).call(this,e)))}},{key:"checkValidity",value:function(e,t){var n=this,r=n.client;return e.resourceRecord=n.dragging.resourceRecord,(r.allowOverlap||r.isDateRangeAvailable(e.startDate,e.endDate,e.eventRecord,e.resourceRecord))&&n.createValidatorFn.call(n.validatorFnThisObj||n,e,t)}},{key:"isRowEmpty",value:function(e){var t=this.store.getEventsForResource(e);return!t||!t.length}},{key:"triggerBeforeFinalize",value:function(e){this.client.trigger("beforeDragCreateFinalize",e)}}],[{key:"$name",get:function(){return"EventDragCreate"}},{key:"configurable",get:function(){return{validatorFn:function(){return!0}}}}]),n}(Zx);function nD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}tD._$name="EventDragCreate",ty.registerFeature(tD,!0,"Scheduler"),ty.registerFeature(tD,!1,"ResourceHistogram");var rD=function(e){Ye()(n,e);var t=nD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.timeline=e,this.onDocumentMouseUp=this.onDocumentMouseUp.bind(this),e.multiEventSelect=!0;this.targetSelector=[".b-timeline-subgrid .b-grid-cell",".b-timeline-subgrid"].join(","),tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;e.touches||0!==e.button||t.disabled||e.target.matches(t.targetSelector)&&(t.startX=e.clientX,t.startY=e.clientY,t.element=mi.createElement({tag:"div",className:"b-dragselect-rect"},!0)[0],n.floatRoot.appendChild(t.element),n.element.classList.add("b-dragselecting"),t.eventRectangles=Array.from(n.element.querySelectorAll(n.eventSelector)).map((function(e){return{rectangle:Cr.from(e,!0),record:n.resolveEventRecord(e)}})),n.clearEventSelection(),t.subGridElementRect=Cr.from(n.timeAxisSubGrid.element,!0),n.navigator.disabled=!0,document.addEventListener("mouseup",t.onDocumentMouseUp))}},{key:"onElementMouseMove",value:function(e){var t=this;if("number"==typeof t.startX){var n=Math.max(e.clientX,t.subGridElementRect.left),r=Math.max(e.clientY,t.subGridElementRect.top),i=Math.min(t.startX,n),o=Math.min(t.startY,r),a=Math.abs(t.startX-n),s=Math.abs(t.startY-r),l=new Cr(i,o,a,s).constrainTo(t.subGridElementRect);mi.setTranslateXY(t.element,l.left,l.top),t.element.style.width=l.width+"px",t.element.style.height=l.height+"px",t.rectangle=l,t.updateSelection()}}},{key:"onDocumentMouseUp",value:function(e){var t,n=this,r=n.client,i=r.selectedAssignments,o=r.navigator;null===(t=n.element)||void 0===t||t.remove(),r.element.classList.remove("b-dragselecting"),n.startX=n.startY=null,o.skipNextClick=r.timeAxisSubGridElement.contains(e.target),o.disabled=!1,i.length&&(o.skipScrollIntoView=!0,r.activeAssignment=i[i.length-1],o.activeItem.focus(),o.skipScrollIntoView=!1),document.removeEventListener("mouseup",n.onDocumentMouseUp)}},{key:"updateSelection",value:function(){for(var e=this,t=e.eventRectangles,n=e.rectangle,r=0,i=t.length;r<i;r++){var o=t[r],a=n.intersect(o.rectangle,!0);a&&!o.selected?(o.selected=!0,e.client.selectEvent(o.record,!0)):!a&&o.selected&&(o.selected=!1,e.client.deselectEvent(o.record))}}}],[{key:"$name",get:function(){return"EventDragSelect"}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove"]}}}]),n}(el(_i));function iD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}rD._$name="EventDragSelect",ty.registerFeature(rD,!1,"Scheduler");var oD=function(e){Ye()(n,e);var t=iD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateLocalization",value:function(){tt()(Ze()(n.prototype),"updateLocalization",this).apply(this,arguments),this.initialTitle=this.title||""}},{key:"chainResourceStore",value:function(){return this.eventEditFeature.resourceStore.makeChained((function(e){return!e.isSpecialRow}),null,{excludeCollapsedRecords:!1})}},{key:"processWidgetConfig",value:function(e){var t,r=this.eventEditFeature;if(null!==(t=e.type)&&void 0!==t&&t.includes("date")&&null==e.weekStartDay&&(e.weekStartDay=this.weekStartDay),"extraItems"===e.type)return!1;var i={};if("resourceField"===e.ref){if(!r.showResourceField)return!1;e.store=this.chainResourceStore(),e.multiSelect=!r.eventStore.usesSingleAssignment,r.resourceFieldConfig&&(i=r.resourceFieldConfig)}return!("nameField"===e.ref&&!r.showNameField)&&(!("deleteButton"===e.ref&&!r.showDeleteButton)&&("startDate"!==e.name&&"endDate"!==e.name||"date"!==e.type||(i.format=r.dateFormat),"startDate"!==e.name&&"endDate"!==e.name||"time"!==e.type||(i.format=r.timeFormat),r.startDateConfig&&"startDate"===e.name&&"date"===e.type&&(i=r.startDateConfig),r.startTimeConfig&&"startDate"===e.name&&"time"===e.type&&(i=r.startTimeConfig),r.endDateConfig&&"endDate"===e.name&&"date"===e.type&&(i=r.endDateConfig),r.endTimeConfig&&"endDate"===e.name&&"time"===e.type&&(i=r.endTimeConfig),Object.assign(e,i),tt()(Ze()(n.prototype),"processWidgetConfig",this).call(this,e)))}},{key:"show",value:function(){var e,t=this.widgetMap.resourceField;t&&(t.store=this.chainResourceStore());for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=tt()(Ze()(n.prototype),"show",this)).call.apply(e,[this].concat(i))}},{key:"onBeforeShow",value:function(){var e,t=this,r=t.record,i=t.titleRenderer,o=t.widgetMap.deleteButton;o&&(o.hidden=t.readOnly||r.isCreating),t.title=i?t.callback(i,t,[r]):t.initialTitle;for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];tt()(Ze()(n.prototype),"onBeforeShow",this)&&(e=tt()(Ze()(n.prototype),"onBeforeShow",this)).call.apply(e,[this].concat(s))}},{key:"onInternalKeyDown",value:function(e){this.trigger("keyDown",{event:e}),tt()(Ze()(n.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"updateReadOnly",value:function(e){var t=this.widgetMap,r=t.deleteButton,i=t.saveButton,o=t.cancelButton;tt()(Ze()(n.prototype),"updateReadOnly",this).call(this,e),r&&(r.hidden=e),i&&(i.hidden=e),o&&(o.hidden=e)}}],[{key:"type",get:function(){return"eventeditor"}},{key:"$name",get:function(){return"EventEditor"}},{key:"configurable",get:function(){return{items:[],draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible",scrollable:{overflowY:!0},readOnly:null,titleRenderer:null}}}]),n}(xf);function aD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}oD.initClass(),oD._$name="EventEditor";var sD=function(e){Ye()(n,e);var t=aD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeMultipleButton",get:function(){return this.widgetMap.changeMultipleButton}},{key:"changeSingleButton",get:function(){return this.widgetMap.changeSingleButton}},{key:"cancelButton",get:function(){return this.widgetMap.cancelButton}},{key:"onChangeMultipleButtonClick",value:function(){this.processMultipleRecords(),this.hide()}},{key:"onChangeSingleButtonClick",value:function(){this.processSingleRecord(),this.hide()}},{key:"onCancelButtonClick",value:function(){this.cancelFn&&this.cancelFn.call(this.thisObj),this.hide()}},{key:"onRecurrenceClose",value:function(){this.cancelFn&&this.cancelFn.call(this.thisObj),this.hide()}},{key:"confirm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return["actionType","eventRecord","title","html","changerFn","cancelFn","thisObj"].forEach((function(n){n in e&&(t[n]=e[n])})),t.updatePopupContent(),tt()(Ze()(n.prototype),"show",this).call(this,e)}},{key:"updatePopupContent",value:function(){var e=this,t=e.widgetMap,n=t.changeMultipleButton,r=t.changeSingleButton,i=t.cancelButton,o=e.eventRecord,a=e.actionType,s=void 0===a?"update":a,l=o&&o.isRecurring;l?(n.text=e.L("L{Object.Yes}"),e.html=e.L("".concat(s,"-all-message"))):(n.text=e.L("".concat(s,"-further-btn-text")),e.html=e.L("".concat(s,"-further-message"))),r.text=e.L("".concat(s,"-only-this-btn-text")),i.text=e.L("L{Object.Cancel}"),l?r.hide():r.show(),e.width=e.L("L{width}"),e.title=e.L("".concat(s,"-title"))}},{key:"processMultipleRecords",value:function(){var e=this.eventRecord,t=this.changerFn,n=this.thisObj;e.beginBatch(),this.callback(t,n,[e]),e.endBatch()}},{key:"processSingleRecord",value:function(){var e=this.eventRecord,t=this.changerFn,n=this.thisObj;e.beginBatch(),e.recurrence=null,this.callback(t,n,[e]),e.recurrenceRule=null,e.endBatch()}},{key:"updateLocalization",value:function(){this.updatePopupContent(),tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"RecurrenceConfirmationPopup"}},{key:"type",get:function(){return"recurrenceconfirmation"}},{key:"defaultConfig",get:function(){return{localizableProperties:[],align:"b-t",autoShow:!1,autoClose:!1,closeAction:"onRecurrenceClose",modal:!0,centered:!0,scrollAction:"realign",constrainTo:window,draggable:!0,closable:!0,floating:!0,eventRecord:null,cls:"b-sch-recurrenceconfirmation",bbar:{defaults:{localeClass:this},items:{changeMultipleButton:{weight:100,color:"b-green",text:"L{Object.Yes}",onClick:"up.onChangeMultipleButtonClick"},changeSingleButton:{weight:200,color:"b-gray",text:"L{update-only-this-btn-text}",onClick:"up.onChangeSingleButtonClick"},cancelButton:{weight:300,color:"b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelButtonClick"}}}}}}]),n}(xf);function lD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}sD.initClass(),sD._$name="RecurrenceConfirmationPopup";var uD=function(e){Ye()(n,e);var t=lD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildLocalizedItems",value:function(){return[{value:"DAILY",text:this.L("L{Daily}")},{value:"WEEKLY",text:this.L("L{Weekly}")},{value:"MONTHLY",text:this.L("L{Monthly}")},{value:"YEARLY",text:this.L("L{Yearly}")}]}}],[{key:"$name",get:function(){return"RecurrenceFrequencyCombo"}},{key:"type",get:function(){return"recurrencefrequencycombo"}},{key:"defaultConfig",get:function(){return{editable:!1,displayField:"text",valueField:"value"}}}]),n}(Am(Sv));function cD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}uD.initClass(),uD._$name="RecurrenceFrequencyCombo";var fD=function(e){Ye()(n,e);var t=cD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildLocalizedItems",value:function(){var e=this;return[{value:"none",text:e.L("L{None}")}].concat(F()(tt()(Ze()(n.prototype),"buildLocalizedItems",this).call(this)),[{value:e.customValue,text:e.L("L{Custom}"),cls:e.splitCls}])}},{key:"value",get:function(){return tt()(Ze()(n.prototype),"value",this)},set:function(e){e=e||"none",gh()(Ze()(n.prototype),"value",e,this,!0)}},{key:"recurrence",set:function(e){var t=this;t.value=e?t.isCustomRecurrence(e)?t.customValue:e.frequency:null}},{key:"isCustomRecurrence",value:function(e){var t=e.interval,n=e.days,r=e.monthDays,i=e.months;return Boolean(t>1||n&&n.length||r&&r.length||i&&i.length)}}],[{key:"$name",get:function(){return"RecurrenceCombo"}},{key:"type",get:function(){return"recurrencecombo"}},{key:"defaultConfig",get:function(){return{customValue:"custom",placeholder:"None",splitCls:"b-recurrencecombo-split",items:!0,highlightExternalChange:!1}}}]),n}(uD);function dD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fD.initClass(),fD._$name="RecurrenceCombo";var hD=function(e){Ye()(n,e);var t=dD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"recurrence",get:function(){return this._recurrence},set:function(e){this._recurrence=e,this.updateLegend()}},{key:"eventStartDate",get:function(){return this._eventStartDate},set:function(e){this._eventStartDate=e,this.updateLegend()}},{key:"updateLegend",value:function(){var e=this,t=e.recurrence;e.text=t?Ax.getLegend(t,e.eventStartDate):""}},{key:"onLocaleChange",value:function(){this.updateLegend()}},{key:"updateLocalization",value:function(){this.onLocaleChange(),tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"RecurrenceLegendButton"}},{key:"type",get:function(){return"recurrencelegendbutton"}},{key:"defaultConfig",get:function(){return{localizableProperties:[],recurrence:null}}}]),n}(nf);function vD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}hD.initClass(),hD._$name="RecurrenceLegendButton";var pD=function(e){Ye()(n,e);var t=vD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildLocalizedItems",value:function(){var e=this;return e._weekDays=null,e.weekDays.concat([{value:e.allDaysValue,text:e.L("L{day}"),cls:e.splitCls},{value:e.workingDaysValue,text:e.L("L{weekday}")},{value:e.nonWorkingDaysValue,text:e.L("L{weekend day}")}])}},{key:"weekDays",get:function(){var e=this;if(!e._weekDays){var t=Un.weekStartDay,n=Un.getDayNames().map((function(e,t){return{text:e,value:QC.encodeDay(t)}}));e._weekDays=n.slice(t).concat(n.slice(0,t))}return e._weekDays}},{key:"value",get:function(){var e=tt()(Ze()(n.prototype),"value",this);return e&&Array.isArray(e)&&(e=e.join(",")),e},set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),e&&this.store.findRecord("value",e)||(e=this.defaultValue),gh()(Ze()(n.prototype),"value",e,this,!0)}}],[{key:"$name",get:function(){return"RecurrenceDaysCombo"}},{key:"type",get:function(){return"recurrencedayscombo"}},{key:"defaultConfig",get:function(){var e=["SU","MO","TU","WE","TH","FR","SA"],t=e.join(",");return{allDaysValue:t,editable:!1,defaultValue:t,workingDaysValue:e.filter((function(e,t){return!Un.nonWorkingDays[t]})).join(","),nonWorkingDaysValue:e.filter((function(e,t){return Un.nonWorkingDays[t]})).join(","),splitCls:"b-recurrencedays-split",displayField:"text",valueField:"value"}}}]),n}(Am(Sv));function gD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}pD.initClass(),pD._$name="RecurrenceDaysCombo";var yD=function(e){Ye()(n,e);var t=gD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=7,e.items=t.buildItems(),tt()(Ze()(n.prototype),"construct",this).call(this,e)}},{key:"updateItemText",value:function(e){var t=QC.decodeDay(e.value)[0];e.text=Un.getDayName(t).substring(0,3)}},{key:"buildItems",value:function(){var e=this;if(!e.__items){var t=Un.weekStartDay,n=Un.getDayNames().map((function(e,t){return{text:e.substring(0,3),value:QC.encodeDay(t)}}));e.__items=n.slice(t).concat(n.slice(0,t))}return e.__items}},{key:"value",get:function(){var e=tt()(Ze()(n.prototype),"value",this);return e&&Array.isArray(e)&&(e=e.join(",")),e},set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),gh()(Ze()(n.prototype),"value",e,this,!0)}},{key:"onLocaleChange",value:function(){this.items.forEach(this.updateItemText,this)}},{key:"updateLocalization",value:function(){this.onLocaleChange(),tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}},{key:"widgetClassList",get:function(){var e=tt()(Ze()(n.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceDaysButtonGroup"}},{key:"type",get:function(){return"recurrencedaysbuttongroup"}},{key:"defaultConfig",get:function(){return{defaults:{cls:"b-raised",toggleable:!0}}}}]),n}(Iv);function mD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}yD.initClass(),yD._$name="RecurrenceDaysButtonGroup";var bD=function(e){Ye()(n,e);var t=mD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"minValue",get:function(){return 1}},{key:"maxValue",get:function(){return 31}},{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=7,e.items=t.buildItems(),tt()(Ze()(n.prototype),"construct",this).call(this,e)}},{key:"buildItems",value:function(){for(var e=[],t=this.minValue;t<=this.maxValue;t++)e.push({text:t+"",value:t});return e}},{key:"widgetClassList",get:function(){var e=tt()(Ze()(n.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceMonthDaysButtonGroup"}},{key:"type",get:function(){return"recurrencemonthdaysbuttongroup"}},{key:"defaultConfig",get:function(){return{defaults:{toggleable:!0,cls:"b-raised"}}}}]),n}(Iv);function kD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bD.initClass(),bD._$name="RecurrenceMonthDaysButtonGroup";var wD=function(e){Ye()(n,e);var t=kD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=4,e.items=t.buildItems(),tt()(Ze()(n.prototype),"construct",this).call(this,e)}},{key:"buildItems",value:function(){return Un.getMonthNames().map((function(e,t){return{text:e.substring(0,3),value:t+1}}))}},{key:"updateItemText",value:function(e){e.text=Un.getMonthName(e.value-1).substring(0,3)}},{key:"onLocaleChange",value:function(){this.items.forEach(this.updateItemText,this)}},{key:"updateLocalization",value:function(){this.onLocaleChange(),tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}},{key:"widgetClassList",get:function(){var e=tt()(Ze()(n.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceMonthsButtonGroup"}},{key:"type",get:function(){return"recurrencemonthsbuttongroup"}},{key:"defaultConfig",get:function(){return{defaults:{toggleable:!0,cls:"b-raised"}}}}]),n}(Iv);function CD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}wD.initClass(),wD._$name="RecurrenceMonthsButtonGroup";var RD=function(e){Ye()(n,e);var t=CD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildLocalizedItems",value:function(){return[{value:"never",text:this.L("L{Never}")},{value:"count",text:this.L("L{After}")},{value:"date",text:this.L("L{On date}")}]}},{key:"value",get:function(){return tt()(Ze()(n.prototype),"value",this)},set:function(e){e=e||"never",gh()(Ze()(n.prototype),"value",e,this,!0)}},{key:"recurrence",get:function(){return this._recurrence},set:function(e){var t=null;e.endDate?t="date":e.count&&(t="count"),this._recurrence=e,this.value=t}}],[{key:"$name",get:function(){return"RecurrenceStopConditionCombo"}},{key:"type",get:function(){return"recurrencestopconditioncombo"}},{key:"defaultConfig",get:function(){return{editable:!1,placeholder:"Never",displayField:"text",valueField:"value"}}}]),n}(Am(Sv));function SD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}RD.initClass(),RD._$name="RecurrenceStopConditionCombo";var xD=function(e){Ye()(n,e);var t=SD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildLocalizedItems",value:function(){var e=this;return e.buildDayNumbers().concat([{value:"-1",text:e.L("L{position-1}"),cls:e.splitCls}])}},{key:"buildDayNumbers",value:function(){var e=this;return it.populate(e.maxPosition,(function(t){return{value:t,text:e.L("position".concat(t+1))}}))}},{key:"value",get:function(){var e=tt()(Ze()(n.prototype),"value",this);return e?"".concat(e).split(",").map((function(e){return parseInt(e,10)})):[]},set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),e&&this.store.findRecord("value",e)||(e=this.defaultValue),gh()(Ze()(n.prototype),"value",e,this,!0)}}],[{key:"$name",get:function(){return"RecurrencePositionsCombo"}},{key:"type",get:function(){return"recurrencepositionscombo"}},{key:"defaultConfig",get:function(){return{editable:!1,splitCls:"b-sch-recurrencepositions-split",displayField:"text",valueField:"value",defaultValue:1,maxPosition:5}}}]),n}(Am(Sv));function ED(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}xD.initClass(),xD._$name="RecurrencePositionsCombo";var DD=function(e){Ye()(n,e);var t=ED(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateReadOnly",value:function(e){tt()(Ze()(n.prototype),"updateReadOnly",this).call(this,e),this.bbar.hidden=e}},{key:"updateRecord",value:function(e){tt()(Ze()(n.prototype),"updateRecord",this).call(this,e);var t=this,r=e.timeSpan,i=r&&r.startDate,o=t.widgetMap,a=o.daysButtonField,s=o.monthDaysButtonField,l=o.monthsButtonField,u=o.monthDaysRadioField,c=o.positionAndDayRadioField,f=o.stopRecurrenceField;i&&(e.days&&e.days.length||(a.value=[QC.encodeDay(i.getDay())]),e.monthDays&&e.monthDays.length||(s.value=i.getDate()),e.months&&e.months.length||(l.value=i.getMonth()+1)),e.days&&e.positions?(c.check(),t.isPainted||u.uncheck()):(u.check(),t.isPainted||c.uncheck()),f.recurrence=e}},{key:"onSaveClick",value:function(){var e=this;e.saveHandler?e.saveHandler.call(e.thisObj||e,e,e.record):(e.syncEventRecord(),e.close())}},{key:"onCancelClick",value:function(){var e=this;e.cancelHandler?e.cancelHandler.call(e.thisObj||e,e,e.record):e.close()}},{key:"syncEventRecord",value:function(e){var t=this.getValues((function(t){return t.name in e&&!t.disabled}));e.set(t)}},{key:"toggleStopFields",value:function(){var e=this.widgetMap,t=e.countField,n=e.endDateField;switch(this.widgetMap.stopRecurrenceField.value){case"count":t.show(),t.enable(),n.hide(),n.disable();break;case"date":t.hide(),t.disable(),n.show(),n.enable();break;default:t.hide(),n.hide(),t.disable(),n.disable()}}},{key:"onMonthDaysRadioFieldChange",value:function(e){var t=e.checked,n=this.widgetMap.monthDaysButtonField;n.disabled=!t||!this.isWidgetAvailableForFrequency(n)}},{key:"onPositionAndDayRadioFieldChange",value:function(e){var t=e.checked,n=this.widgetMap,r=n.daysCombo,i=n.positionsCombo;r.disabled=i.disabled=!t||!this.isWidgetAvailableForFrequency(r)}},{key:"onStopRecurrenceFieldChange",value:function(){this.toggleStopFields()}},{key:"isWidgetAvailableForFrequency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.widgetMap.frequencyField.value;return!e.forFrequency||e.forFrequency.indexOf(t)>-1}},{key:"onFrequencyFieldChange",value:function(e){var t=e.value,n=e.valid,r=this,i=r.queryAll((function(e){return"forFrequency"in e}));if(n&&t){for(var o=0;o<i.length;o++){var a=i[o];r.isWidgetAvailableForFrequency(a,t)?(a.show(),a.enable()):(a.hide(),a.disable())}r.widgetMap.intervalField.hint=r.L("".concat(t,"intervalUnit")),r.toggleFieldsState()}}},{key:"toggleFieldsState",value:function(){var e=this,t=this.widgetMap;e.onMonthDaysRadioFieldChange({checked:t.monthDaysRadioField.checked}),e.onPositionAndDayRadioFieldChange({checked:t.positionAndDayRadioField.checked}),e.onStopRecurrenceFieldChange()}},{key:"updateLocalization",value:function(){var e=this.widgetMap,t=e.countField,r=e.intervalField,i=e.frequencyField;t.hint=this.L("L{time(s)}"),i.value&&(r.hint=this.L("".concat(i.value,"intervalUnit"))),tt()(Ze()(n.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"RecurrenceEditor"}},{key:"type",get:function(){return"recurrenceeditor"}},{key:"configurable",get:function(){return{draggable:!0,closable:!0,floating:!0,cls:"b-recurrenceeditor",title:"L{Repeat event}",autoClose:!0,width:470,defaults:{localeClass:this},items:{frequencyField:{type:"recurrencefrequencycombo",name:"frequency",label:"L{Frequency}",weight:10,onChange:"up.onFrequencyFieldChange"},intervalField:{type:"numberfield",weight:15,name:"interval",label:"L{Every}",min:1,required:!0},daysButtonField:{type:"recurrencedaysbuttongroup",weight:20,name:"days",forFrequency:"WEEKLY"},monthDaysRadioField:{type:"checkbox",weight:30,toggleGroup:"radio",forFrequency:"MONTHLY",label:"L{Each}",checked:!0,onChange:"up.onMonthDaysRadioFieldChange"},monthDaysButtonField:{type:"recurrencemonthdaysbuttongroup",weight:40,name:"monthDays",forFrequency:"MONTHLY"},monthsButtonField:{type:"recurrencemonthsbuttongroup",weight:50,name:"months",forFrequency:"YEARLY"},positionAndDayRadioField:{type:"checkbox",weight:60,toggleGroup:"radio",forFrequency:"MONTHLY|YEARLY",label:"L{On the}",onChange:"up.onPositionAndDayRadioFieldChange"},positionsCombo:{type:"recurrencepositionscombo",weight:80,name:"positions",forFrequency:"MONTHLY|YEARLY"},daysCombo:{type:"recurrencedayscombo",weight:90,name:"days",forFrequency:"MONTHLY|YEARLY",flex:1},stopRecurrenceField:{type:"recurrencestopconditioncombo",weight:100,label:"L{End repeat}",onChange:"up.onStopRecurrenceFieldChange"},countField:{type:"numberfield",weight:110,name:"count",min:2,required:!0,disabled:!0,label:" "},endDateField:{type:"datefield",weight:120,name:"endDate",hidden:!0,disabled:!0,label:" ",required:!0}},bbar:{defaults:{localeClass:this},items:{foo:{type:"widget",cls:"b-label-filler",weight:100},saveButton:{color:"b-green",text:"L{Save}",onClick:"up.onSaveClick",weight:200},cancelButton:{color:"b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelClick",weight:300}}}}}}]),n}(xf);function TD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function OD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TD(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TD(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function MD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}DD.initClass(),DD._$name="RecurrenceEditor";var AD=function(e){return function(e){Ye()(n,e);var t=MD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeEditorConfig",value:function(e){return e.items=OD(OD({},e.items),this.recurringEventsItems),e=tt()(Ze()(n.prototype),"changeEditorConfig",this).call(this,e)}},{key:"construct",value:function(e,t){var r=this;tt()(Ze()(n.prototype),"construct",this).call(this,e,t),r.scheduler.on({beforeEventDelete:r.onRecurrableEventBeforeDelete,beforeEventSave:r.onRecurrableEventBeforeSave,thisObj:r})}},{key:"doDestroy",value:function(){this._recurrenceConfirmation&&this.recurrenceConfirmation.destroy(),this._recurrenceEditor&&this.recurrenceEditor.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"onEditorConstructed",value:function(e){var t=this;e.on({hide:t.onRecurringEventEditorHide,thisObj:t}),t.editRecurrenceButton&&(t.editRecurrenceButton.menu=t.recurrenceEditor),t.recurrenceCombo&&t.recurrenceCombo.on({change:t.onRecurrenceComboChange,thisObj:t})}},{key:"internalShowEditor",value:function(){this.toggleRecurringFieldsVisibility(this.client.enableRecurringEvents&&!1!==this.showRecurringUI)}},{key:"toggleRecurringFieldsVisibility",value:function(){var e,t,n,r,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=i?"show":"hide";null===(e=this.editRecurrenceButton)||void 0===e||null===(t=e[o])||void 0===t||t.call(e),null===(n=this.recurrenceCombo)||void 0===n||null===(r=n[o])||void 0===r||r.call(n)}},{key:"onRecurringEventEditorHide",value:function(){var e,t;null!==(e=this.recurrenceEditor)&&void 0!==e&&e.isVisible&&this.recurrenceEditor.hide(),null!==(t=this.recurrenceConfirmation)&&void 0!==t&&t.isVisible&&this.recurrenceConfirmation.hide()}},{key:"makeRecurrence",value:function(e){var t=this.eventRecord,n=t.copy(),r=t.recurrence;return(r=!e&&r?r.copy():new t.recurrenceModel(e?{rule:e}:{})).timeSpan=n,n.setStartDate(this.values.startDate),r.suspendTimeSpanNotifying(),r}},{key:"onRecurrableEventBeforeSave",value:function(e){var t=e.eventRecord,n=e.context;t.supportsRecurring&&(t.isRecurring||t.isOccurrence)&&(this.recurrenceConfirmation.confirm({actionType:"update",eventRecord:t,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),n.async=!0)}},{key:"showDisplayConfirmationOnEventDelete",value:function(e){return this.isEditing&&this.eventRecord===e&&e.supportsRecurring&&(e.isRecurring||e.isOccurrence)}},{key:"onRecurrableEventBeforeDelete",value:function(e){var t=e.eventRecords,n=e.context,r=t[0];if(this.showDisplayConfirmationOnEventDelete(r))return this.recurrenceConfirmation.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"recurrenceConfirmation",get:function(){var e=this,t=e._recurrenceConfirmation;return t&&t.$$name||(t=uc.create(Object.assign({type:"recurrenceconfirmation",owner:e.getEditor()},t)),e._recurrenceConfirmation=t),t},set:function(e){this._recurrenceConfirmation=e}},{key:"recurrenceEditor",get:function(){var e=this,t=e._recurrenceEditor;return t&&t.$$name||(t=uc.create(Object.assign({type:"recurrenceeditor",autoShow:!1,clippedBy:[e.scheduler.timeAxisSubGridElement,e.scheduler.bodyContainer],centered:!0,modal:!0,constrainTo:window,anchor:!1,rootElement:e.rootElement,saveHandler:e.recurrenceEditorSaveHandler,onBeforeShow:e.onBeforeShowRecurrenceEditor.bind(e),thisObj:e},t)),e._recurrenceEditor=t,t.readOnly=e._readOnly),t},set:function(e){this._recurrenceEditor=e}},{key:"onBeforeShowRecurrenceEditor",value:function(){var e=this,t=e.recurrenceEditor,n=e.eventRecord;t&&n&&n.supportsRecurring&&(e.recurrence||(e.recurrence=e.makeRecurrence()),e.recurrence.timeSpan.setStartDate(e.values.startDate),t.record=e.recurrence,t.centered=!0)}},{key:"loadRecurrenceData",value:function(e){this.recurrence=e,this.updateRecurrenceFields(e)}},{key:"updateRecurrenceFields",value:function(e){var t=this,n=t.editRecurrenceButton;t.recurrenceCombo&&(t.recurrenceCombo.recurrence=e),n&&(n.recurrence=e,n.value=e?e.rule:null,e&&t.client.enableRecurringEvents&&!1!==t.showRecurringUI?n.show():n.hide())}},{key:"onRecurrenceComboChange",value:function(e){var t=e.source,n=e.value,r=e.userAction,i=this,o=i.recurrenceEditor;n==t.customValue?r&&(i.recurrenceCombo.recurrence=i.makeRecurrence(),o.centered?o.show():o.show((i.editRecurrenceButton||t).element)):i.loadRecurrenceData(n?i.makeRecurrence("FREQ=".concat(n)):null)}},{key:"recurrenceEditorSaveHandler",value:function(e,t){e.syncEventRecord(t),this.updateRecurrenceFields(t),e.close()}},{key:"onDatesChange",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];if((e=tt()(Ze()(n.prototype),"onDatesChange",this)).call.apply(e,[this].concat(r)),!this.loadingRecord&&this.editRecurrenceButton){var o=this.values.startDate;o&&(this.editRecurrenceButton.eventStartDate=o)}}},{key:"internalLoadRecord",value:function(e,t){e&&e.supportsRecurring&&this.loadRecurrenceData(e.recurrence?this.makeRecurrence():null)}}],[{key:"$name",get:function(){return"RecurringEventEdit"}},{key:"configurable",get:function(){return{recurringEventsItems:{recurrenceCombo:{type:"recurrencecombo",label:"L{EventEdit.Repeat}",ref:"recurrenceCombo",weight:700},editRecurrenceButton:{type:"recurrencelegendbutton",ref:"editRecurrenceButton",name:"recurrenceRule",color:"b-gray",flex:"1",weight:800}},showRecurringUI:null}}}]),n}(e||$e)};function ID(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var PD=function(e){Ye()(n,e);var t=ID(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"changeShowEventColor",value:function(e){return Boolean(e)}},{key:"updateShowEventColor",value:function(e){var t=this._picker,n=e?"add":"remove";this.element.classList[n]("b-show-event-color"),null==t||t.element.classList[n]("b-show-event-color")}},{key:"changePicker",value:function(e,t){var r;return null===(r=e=tt()(Ze()(n.prototype),"changePicker",this).call(this,e,t))||void 0===r||r.element.classList[this.showEventColor?"add":"remove"]("b-show-event-color"),e}},{key:"innerElements",get:function(){return[{class:"b-icon b-resource-icon b-icon-square b-hide-display",reference:"resourceIcon"},this.inputElement]}},{key:"syncInputFieldValue",value:function(){var e,t,r=this,i=r.resourceIcon,o=r.lastResourceIconCls,a=i.classList,s=null!==(e=null===(t=r.selected)||void 0===t?void 0:t.eventColor)&&void 0!==e?e:"";tt()(Ze()(n.prototype),"syncInputFieldValue",this).call(this),i.style.color="",o&&a.remove(o),r.lastResourceIconCls=null,s?(mi.isNamedColor(s)?(r.lastResourceIconCls="b-sch-foreground-".concat(s),a.add(r.lastResourceIconCls)):i.style.color=s,a.remove("b-hide-display")):a.add("b-hide-display")}}],[{key:"$name",get:function(){return"ResourceCombo"}},{key:"type",get:function(){return"resourcecombo"}},{key:"configurable",get:function(){return{showEventColor:!1,picker:{cls:"b-resourcecombo-picker",itemIconTpl:function(e,t){var n=e.eventColor,r=!mi.isNamedColor(n),i=n?r?' style="color:'.concat(n,'"'):"":' style="display:none"',o=!n||r?"":" b-sch-foreground-".concat(n);return'<div class="b-icon b-icon-square'.concat(o,'"').concat(i,"></div>")}}}}}]),n}(Sv);function FD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function LD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?FD(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FD(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function BD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}PD.initClass(),PD._$name="ResourceCombo";var jD=function(e){Ye()(r,e);var t,n=BD(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"construct",value:function(e,t){this.scheduler=e,this.readOnly=e.readOnly,tt()(Ze()(r.prototype),"construct",this).call(this,e,t),e.on({projectChange:"onChangeProject",readOnly:"onClientReadOnlyToggle",thisObj:this})}},{key:"readOnly",get:function(){return this.editor?this.editor.readOnly:this._readOnly}},{key:"updateReadOnly",value:function(e){this.editor&&(this.editor.readOnly=e)}},{key:"onClientReadOnlyToggle",value:function(e){var t=e.readOnly;this.readOnly=t}},{key:"getEditor",value:function(){var e,t,n,r,i,o=this,a=o.editor;return a||((a=o.editor=uc.create(o.getEditorConfig())).readOnly=o._readOnly,0===a.items.length&&console.warn("Event Editor configured without any `items`"),a.on({beforehide:"resetEditingContext",beforeshow:"onBeforeEditorShow",keydown:"onPopupKeyDown",thisObj:o}),o.scheduler.relayEvents(a,["beforeSetRecord"],"eventEdit"),Object.values(a.widgetMap).forEach((function(e){var t=e.ref||e.id;if(t&&!o[t])switch(o[t]=e,e.name){case"startDate":case"endDate":e.on("change",o.onDatesChange,o)}})),null===(e=o.onEditorConstructed)||void 0===e||e.call(o,a),null===(t=o.eventTypeField)||void 0===t||t.on("change",o.onEventTypeChange,o),null===(n=o.saveButton)||void 0===n||n.on("click",o.onSaveClick,o),null===(r=o.deleteButton)||void 0===r||r.on("click",o.onDeleteClick,o),null===(i=o.cancelButton)||void 0===i||i.on("click",o.onCancelClick,o),o.editor)}},{key:"getEditorConfig",value:function(){var e=this,t=e.autoClose,n=e.cls,r=e.scheduler;return Qn.assign({owner:r,eventEditFeature:e,weekStartDay:e.weekStartDay,align:"b-t",id:"".concat(r.id,"-event-editor"),autoShow:!1,anchor:!0,scrollAction:"realign",clippedBy:[r.timeAxisSubGridElement,r.bodyContainer],constrainTo:window,autoClose:t,cls:n},e.editorConfig)}},{key:"internalShowEditor",value:function(e,t){var n,i,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this,l=s.scheduler,u=(null===(n=a)||void 0===n||null===(i=n.target)||void 0===i?void 0:i.nodeType)===Element.ELEMENT_NODE?a.target:mi.down(l.getElementFromEventRecord(e,t),l.eventInnerSelector),c=e.isPartOfStore(l.eventStore);if((a=null!==(o=a)&&void 0!==o?o:{target:u,anchor:!0}).target||!c||e.isCreating){if(!1===l.trigger("beforeEventEdit",{eventEdit:s,eventRecord:e,resourceRecord:t,eventElement:u}))return l.element.classList.remove("b-eventeditor-editing"),!1;s.resourceRecord=t;var f=s.getEditor(e);s.editingContext={eventRecord:e,resourceRecord:t,eventElement:u,editor:f,isPartOfStore:c},tt()(Ze()(r.prototype),"internalShowEditor",this)&&tt()(Ze()(r.prototype),"internalShowEditor",this).call(this,e,t,a),s.typeField&&s.toggleEventType(e.get(s.typeField)),s.loadRecord(e,t),f.centered||!f.anchor?f.show():u?(s.targetEventElement=u,f.showBy(a)):(f.show(),f.updateCentered(!0));var d=l.timeAxisViewModel.timeResolution;if("hour"===d.unit||"minute"===d.unit){var h="".concat(d.increment).concat(d.unit);s.startTimeField&&(s.startTimeField.step=h),s.endTimeField&&(s.endTimeField.step=h)}s.detachListeners("changesWhileEditing"),l.eventStore.on({change:s.onChangeWhileEditing,refresh:s.onChangeWhileEditing,thisObj:s,name:"changesWhileEditing"})}}},{key:"onChangeWhileEditing",value:function(){var e=this;e.isEditing&&e.editingContext.isPartOfStore&&!e.eventRecord.isPartOfStore(e.scheduler.eventStore)&&e.onCancelClick()}},{key:"onBeforeEditorShow",value:function(){tt()(Ze()(r.prototype),"onBeforeEditorShow",this).apply(this,arguments),this.scheduler.trigger("beforeEventEditShow",LD({eventEdit:this},this.editingContext))}},{key:"updateTargetEventElement",value:function(e,t){e&&e.classList.add("b-editing"),t&&t.classList.remove("b-editing")}},{key:"editEvent",value:function(e,t){var n=this;if(n.isEditing&&n.resetEditingContext(),!n.disabled)return n.scheduler.element.classList.add("b-eventeditor-editing"),n.doEditEvent.apply(n,arguments)}},{key:"isEditing",get:function(){var e;return Boolean(null===(e=this.editor)||void 0===e?void 0:e.isVisible)}},{key:"doEditEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this,i=r.scheduler,o=e.isCreating;t||(t=e.resource||r.resourceStore.getById(e.resourceId)),o&&KC.prototype.normalize.call(e),n||o?r.internalShowEditor(e,t,n?{target:n}:null):i.scrollResourceEventIntoView(t,e,null,{animate:!0,edgeOffset:0,extendTimeAxis:!1}).then((function(){return r.internalShowEditor(e,t)}),(function(){return i.element.classList.remove("b-eventeditor-editing")}))}},{key:"loadRecord",value:function(e,t){this.loadingRecord=!0,this.internalLoadRecord(e,t),this.loadingRecord=!1}},{key:"eventRecord",get:function(){return this.editor.record}},{key:"internalLoadRecord",value:function(e,t){var n=this,i=n.client.eventStore,o=n.editor;if(n.resourceRecord=t,o.record=e,n.resourceField){var a=i.getResourcesForEvent(e);o._isSettingValues=!0,!i.storage.includes(e,!0)&&t?n.resourceField.value=t[n.resourceField.valueField]:n.assignmentStore&&(n.resourceField.value=a.map((function(e){return e[n.resourceField.valueField]}))),o._isSettingValues=!1}tt()(Ze()(r.prototype),"internalLoadRecord",this).call(this,e,t)}},{key:"toggleEventType",value:function(e){this.editor.element.dataset.eventType=e||"",this.editor.eachWidget((function(t){var n;(null===(n=t.dataset)||void 0===n?void 0:n.eventType)&&(t.hidden=t.dataset.eventType!==e)}))}},{key:"finalizeEventSave",value:(t=Pt()(At.a.mark((function e(t,n,r,i){var o,a,s,l,u;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(o=this).scheduler,s=o.eventStore,l=o.assignmentStore,u=!1,l.suspendAutoCommit(),a.suspendRefresh(),o.onBeforeSave(t),t.beginBatch(),o.updateRecord(t),t.endBatch(),t.isOccurrence?n&&t.set("resourceRecords",n):o.resourceField&&s.assignEventToResource(t,n,!0),t.isCreating=!1,u){e.next=13;break}return e.next=13,a.project.commitAsync();case 13:l.resumeAutoCommit(),a.resumeRefresh(!0),u||(a.trigger("afterEventSave",{eventRecord:t}),o.onAfterSave(t)),r(!u&&t);case 17:case"end":return e.stop()}}),e,this)}))),function(e,n,r,i){return t.apply(this,arguments)})},{key:"save",value:function(){var e=this;return new Promise((function(t,n){var r,i=e,o=i.scheduler,a=i.eventRecord;if(a&&i.isValid){var s=i.eventStore,l=i.values,u=(null===(r=i.resourceField)||void 0===r?void 0:r.records)||(i.resourceRecord?[i.resourceRecord]:[]),c=u[0];if(!i.scheduler.allowOverlap&&s)if(u.some((function(e){return!s.isDateRangeAvailable(l.startDate,l.endDate,a,e)})))return void t(!1);var f={finalize:function(e){try{!1!==e?i.finalizeEventSave(a,u,t,n):t(!1)}catch(e){n(e)}}};!1!==o.trigger("beforeEventSave",{eventRecord:a,resourceRecords:u,resourceRecord:c,values:l,context:f})?f.async||f.finalize():t(!1)}else t(!1)}))}},{key:"deleteEvent",value:function(){var e=this;return this.detachListeners("changesWhileEditing"),new Promise((function(t,n){var r=e,i=r.eventRecord,o=r.editor;r.scheduler.removeEvents([i],(function(e){e&&o.containsFocus&&o.revertFocus(),t(e)}))}))}},{key:"onChangeProject",value:function(){this.resourceField&&(this.resourceField.store={})}},{key:"eventStore",get:function(){return this.scheduler.project.eventStore}},{key:"resourceStore",get:function(){return this.scheduler.project.resourceStore}},{key:"assignmentStore",get:function(){return this.scheduler.project.assignmentStore}},{key:"onActivateEditor",value:function(e){var t=e.eventRecord,n=e.resourceRecord,r=e.eventElement;this.editEvent(t,n,r)}},{key:"onDragCreateEnd",value:function(e){var t=e.eventRecord,n=e.resourceRecord,r=e.proxyElement;this.disabled||this.editEvent(t,n,r)}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord,r=e.target.closest(this.client.eventInnerSelector);t?this.editEvent(n,t.resource,r):n&&this.editEvent(n,n.resource,r)}},{key:"onEventTypeChange",value:function(e){var t=e.value;this.toggleEventType(t)}},{key:"populateEventMenu",value:function(e){var t=this,n=e.eventRecord,r=e.resourceRecord,i=e.items;this.scheduler.readOnly||(i.editEvent={text:"L{EventEdit.Edit event}",localeClass:this,icon:"b-icon b-icon-edit",weight:100,onItem:function(){t.editEvent(n,r)}})}},{key:"resetEditingContext",value:function(){this.detachListeners("changesWhileEditing"),tt()(Ze()(r.prototype),"resetEditingContext",this).call(this),this.resourceRecord=this.editingContext=this.editor._record=null}}],[{key:"$name",get:function(){return"EventEdit"}},{key:"configurable",get:function(){return{triggerEvent:"eventdblclick",showResourceField:!0,resourceFieldConfig:null,typeField:"eventType",eventRecord:null,readOnly:null,editorConfig:{type:"eventeditor",title:"L{EventEdit.Edit event}",closable:!0,localeClass:this,defaults:{localeClass:this},items:{nameField:{type:"text",label:"L{Name}",clearable:!0,name:"name",weight:100,required:!0},resourceField:{type:"resourcecombo",label:"L{Resource}",name:"resource",editable:!0,valueField:"id",displayField:"name",highlightExternalChange:!1,destroyStore:!0,weight:200},startDateField:{type:"date",cls:"b-inline",clearable:!1,required:!0,label:"L{Start}",name:"startDate",flex:"1 0 60%",weight:300},startTimeField:{type:"time",clearable:!1,required:!0,name:"startDate",cls:"b-match-label",flex:"1 0 40%",weight:400},endDateField:{type:"date",cls:"b-inline",clearable:!1,required:!0,label:"L{End}",name:"endDate",flex:"1 0 60%",weight:500},endTimeField:{type:"time",clearable:!1,required:!0,name:"endDate",cls:"b-match-label",flex:"1 0 40%",weight:600}},bbar:{hideWhenEmpty:!0,defaults:{localeClass:this},items:{saveButton:{color:"b-green",text:"L{Save}",weight:100},deleteButton:{color:"b-gray",text:"L{Delete}",weight:200},cancelButton:{color:"b-gray",text:"L{Object.Cancel}",weight:300}}}},targetEventElement:null}}},{key:"pluginConfig",get:function(){return{chain:["populateEventMenu","onEventEnterKey","editEvent"]}}}]),r}(aE.mixin(AD,el));function _D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}jD._$name="EventEdit",ty.registerFeature(jD,!0,"Scheduler"),ty.registerFeature(jD,!1,["SchedulerPro","ResourceHistogram"]),jD.initClass();var HD,ND=function(e){Ye()(n,e);var t=_D(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),this.scheduler=e}},{key:"populateHeaderMenu",value:function(e){var t=e.column;e.items;"timeAxis"===t.type&&this.populateTimeAxisHeaderMenu.apply(this,arguments)}},{key:"populateTimeAxisHeaderMenu",value:function(e){e.column;var t=e.items,n=this;t.eventsFilter={text:"L{filterEvents}",icon:"b-fw-icon b-icon-filter",disabled:n.disabled,localeClass:this,weight:100,menu:{type:"popup",localeClass:this,items:{nameFilter:{weight:110,type:"textfield",cls:"b-eventfilter b-last-row",clearable:!0,keyStrokeChangeDelay:300,label:"L{byName}",localeClass:this,width:200,listeners:{change:n.onEventFilterChange,thisObj:n}}},onBeforeShow:function(e){var t=e.source,r=N()(t.items,1)[0],i=n.scheduler.eventStore.filters.getBy("property","name");r.value=i&&i.value||""}}}}},{key:"onEventFilterChange",value:function(e){var t=e.value;""!==t?this.scheduler.eventStore.filter("name",t):this.scheduler.eventStore.removeFilter("name")}}],[{key:"$name",get:function(){return"EventFilter"}},{key:"pluginConfig",get:function(){return{chain:["populateHeaderMenu","populateTimeAxisHeaderMenu"]}}}]),n}(_i);function zD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ND.featureClass="b-event-filter",ND._$name="EventFilter",ty.registerFeature(ND,!0,["Scheduler","Gantt"]),ty.registerFeature(ND,!1,"ResourceHistogram");var VD=function(e){Ye()(n,e);var t=zD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;tt()(Ze()(n.prototype),"construct",this).call(this,e,t),"string"==typeof r.align&&(r.align={align:r.align})}},{key:"onPaint",value:function(e){var t=e.firstPaint;if(tt()(Ze()(n.prototype),"onPaint",this).apply(this,arguments),t){var r=this,i=r.client.features.dependencies;if(i){var o=r.align.offset;r.tooltip.on("beforeshow",(function(e){var t=e.source;i.disabled?t.align.offset=o:t.align.offset=[0,10]}))}}}}],[{key:"$name",get:function(){return"EventTooltip"}},{key:"defaultConfig",get:function(){return{template:function(e){return"\n                ".concat(e.eventRecord.name?te.xss(HD||(HD=sv()(['<div class="b-sch-event-title">',"</div>"])),e.eventRecord.name):"","\n                ").concat(e.startClockHtml,"\n                ").concat(e.endClockHtml)},cls:"b-sch-event-tooltip",monitorRecordUpdate:!0}}}]),n}(yE);function WD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}VD._$name="EventTooltip",ty.registerFeature(VD,!0,"Scheduler"),ty.registerFeature(VD,!1,"ResourceHistogram");var $D=function(e){Ye()(n,e);var t=WD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;t.unitToPixelsCache={},tt()(Ze()(n.prototype),"construct",this).call(this,e);var r=t.timeAxis.viewPreset||t.viewPreset;if(r)if(r instanceof Rx)t.consumeViewPreset(r);else{var i=Dx.getPreset(r);i&&t.consumeViewPreset(i)}t.timeAxis.on("reconfigure",t.onTimeAxisReconfigure,t),t.configured=!0}},{key:"doDestroy",value:function(){this.timeAxis.un("reconfigure",this.onTimeAxisReconfigure,this),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"columnConfig",get:function(){return this._columnConfig},set:function(e){this._columnConfig=e}},{key:"headers",get:function(){return this._headers},set:function(e){if(e&&e.length&&e[e.length-1].cellGenerator)throw new Error("`cellGenerator` cannot be used for the bottom level of your headers. Use TimeAxis#generateTicks() instead.");this._headers=e}},{key:"isTimeAxisViewModel",get:function(){return!0}},{key:"isHorizontal",get:function(){return"vertical"!==this.mode}},{key:"isVertical",get:function(){return"vertical"===this.mode}},{key:"forceFit",get:function(){return this._forceFit},set:function(e){e!==this._forceFit&&(this._forceFit=e,this.update())}},{key:"reconfigure",value:function(e){this.headers=null,this.setConfig(e),this.trigger("reconfigure")}},{key:"onTimeAxisReconfigure",value:function(e){var t=e.source,n=e.suppressRefresh;this.viewPreset!==t.viewPreset&&this.consumeViewPreset(t.viewPreset),n||this.update()}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=r.headers;if(r.isConfiguring||r._availableSpace===e)n&&r.trigger("update");else{if(r._availableSpace=Math.max(e||r.availableSpace||0,0),"number"!=typeof r.availableSpace)throw new Error("Invalid available space provided to TimeAxisModel");r.columnConfig=[];var a=r._tickSize=r.calculateTickSize(r.originalTickSize);if("number"!=typeof a||a<=0)throw new Error("Invalid timeAxis tick size");r.unitToPixelsCache={},r._totalSize=null;for(var s=0,l=o.length;s<l;s++){var u=o[s];if(u.cellGenerator){var c=u.cellGenerator.call(r,i.startDate,i.endDate);r.columnConfig[s]=r.createHeaderRow(s,u,c)}else r.columnConfig[s]=r.createHeaderRow(s,u)}t||r.trigger("update")}}},{key:"getDistanceBetweenDates",value:function(e,t){return this.getPositionFromDate(t)-this.getPositionFromDate(e)}},{key:"getDistanceForDuration",value:function(e){return this.getSingleUnitInPixels("millisecond")*e}},{key:"getPositionFromDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getScaledTick(e,t);return-1===n?-1:this.tickSize*(n-this.timeAxis.visibleTickStart)}},{key:"getScaledTick",value:function(e,t){var n=t.respectExclusion,r=t.snapToNextIncluded,i=t.isEnd,o=t.min,a=t.max,s=this.timeAxis,l=s.include,u=s.unit,c=s.getTickFromDate(e);if(-1!==c&&n&&l){var f=!1;if(l.hour&&Un.compareUnits(u,"hour")>0&&"day"!==u){var d=l.hour,h=d.from,v=d.to,p=d.lengthFactor,g=d.center,y=e.getHours(),m=Math.min(Math.max(y,h),v);if(!r&&m!==y)return-1;var b=g-(g-(m+e.getMinutes()/60))*p;e=Un.add(e,b-y,"h"),f=!0}if(l.day&&Un.compareUnits(u,"day")>0){var k=l.day,w=k.from,C=k.to,R=k.lengthFactor,S=k.center,x=e.getDay();i&&0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()&&--x<0&&(x=6);var E=0;if(x<w||x>=C){if(!r)return-1;if(E=i?(C-x-8)%7:(w-x+7)%7,e=Un.add(e,E,"d"),e=Un.startOf(e,"d",!1),a&&e.getTime()>=a||o&&e.getTime()<=o)return-1}var D=s.weekStartDay,T=0===e.getDay()?0:S,O=e.getDay()+e.getHours()/24,M=T-(T-O)*R;e=Un.add(e,M-O+D,"d"),f=!0}f&&(e=Un.constrain(e,s.startDate,s.endDate),c=s.getTickFromDate(e))}return c}},{key:"getDateFromPosition",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this,o=i.timeAxis,a=i.getScaledPosition(e)/i.tickSize+o.visibleTickStart;return a<0||a>o.count?r?(n=a<0?Un.add(o.startDate,a,o.unit):Un.add(o.endDate,a-o.count,o.unit),t&&(n=o[t+"Date"](n)),n):null:o.getDateFromTick(a,t)}},{key:"getScaledPosition",value:function(e){var t=this.timeAxis,n=t.include,r=t.unit,i=t.weekStartDay;if(n){var o=this.getSingleUnitInPixels("day");if(n.day&&Un.compareUnits(r,"day")>0){var a=n.day,s=a.from,l=e%(7*o);e=l/a.lengthFactor+(s-i)*o+(e-l)}if(n.hour&&Un.compareUnits(r,"hour")>0&&"day"!==r){var u=n.hour,c=u.from,f=e%o;e=f/u.lengthFactorExcl+c*this.getSingleUnitInPixels("hour")+(e-f)}}return e}},{key:"getSingleUnitInPixels",value:function(e){var t=this;return t.unitToPixelsCache[e]||(t.unitToPixelsCache[e]=Un.getUnitToBaseUnitRatio(t.timeAxis.unit,e,!0)*t.tickSize/t.timeAxis.increment)}},{key:"snapPixelAmount",get:function(){if(this.snap){var e=this.timeAxis.resolution;return(e.increment||1)*this.getSingleUnitInPixels(e.unit)}return 1}},{key:"tickSize",get:function(){return this._tickSize},set:function(e){this.setTickSize(e,!1)}},{key:"setTickSize",value:function(e,t){this._tickSize=this.originalTickSize=e,this.update(void 0,t)}},{key:"timeResolution",get:function(){return this.timeAxis.resolution}},{key:"calculateTickSize",value:function(e){var t=this,n=t.forceFit,r=t.timeAxis,i=t.suppressFit,o=r.unit,a=0,s=1;if(t.snap){var l=r.resolution;s=Un.getUnitToBaseUnitRatio(o,l.unit)*l.increment}if(i)a=e;else{var u=t.availableSpace/r.visibleTickTimeSpan;a=n||e<u?u:e,s>0&&(!n||s<1)&&(a=Math.max(1,s*a)/s)}return a}},{key:"totalSize",get:function(){return this._totalSize||(this._totalSize=Math.round(this.tickSize*this.timeAxis.visibleTickTimeSpan))}},{key:"availableSpace",get:function(){return this._availableSpace},set:function(e){var t=this;if(t._availableSpace=Math.max(0,e),t._availableSpace>0){var n=t.calculateTickSize(t.originalTickSize);n>0&&n!==t.tickSize&&t.update()}}},{key:"getDates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.columnLinesFor,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=[],o=t?r.lowestHeader:e,a=r.majorHeaderLevel,s=r.headers&&r.headers[e].unit,l=null!=a&&r.headers&&r.headers[a].unit,u=null!=a&&Un.doesUnitsAlign(l,s),c=!(!r.headers||!r.headers[o].cellGenerator);if(c)for(var f=r.columnConfig[o],d=1,h=f.length;d<h;d++)i.push({date:f[d].startDate});else r.forEachInterval(o,(function(t,o){i.push({date:n?o:t,isMajor:a!==e&&u&&r.isMajorTick(n?o:t)})}));return i}},{key:"fitToAvailableSpace",value:function(e){var t=Math.floor(this.availableSpace/this.timeAxis.visibleTickTimeSpan);this.setTickSize(t,e)}},{key:"snap",get:function(){return this._snap},set:function(e){e!==this._snap&&(this._snap=e,this.configured&&this.update())}},{key:"createHeaderRow",value:function(e,t,n){var r=this,i=[],o=t.align,a=Un.clearTime(new Date),s=t.headerCellCls||"",l=r.timeAxis,u=r.headers.length-1,c=function(n,c,d,h,v){var p=Un.format(n,t.dateFormat),g=d>0&&!h,y={align:o,start:n,end:c,value:v?v.header:p,headerCellCls:s,width:u===e&&r.owner&&(l.fullTicks||g)?r.owner.tickSize:r.getDistanceBetweenDates(n,c),index:d};0!==y.width&&(y.coord=f-1,f+=y.width,r.headersDatesCache[e][n.getTime()]=1,t.renderer&&(p=t.renderer.call(t.thisObj||r,n,c,y,d),y.value=null==p?"":p),"day"!==t.unit||t.increment&&1!==t.increment||(y.headerCellCls+=" b-sch-dayheadercell-"+n.getDay(),Un.clearTime(n,!0)-a==0&&(y.headerCellCls+=" b-sch-dayheadercell-today")),i.push(y))},f=0;return r.headersDatesCache[e]={},n?n.forEach((function(e,t){return c(e.start,e.end,t,t===n.length-1,e)})):r.forEachInterval(e,c),i}},{key:"mainHeader",get:function(){return"mainHeaderLevel"in this?this.headers[this.mainHeaderLevel]:this.bottomHeader}},{key:"bottomHeader",get:function(){return this.headers[this.headers.length-1]}},{key:"lowestHeader",get:function(){return this.headers.length-1}},{key:"majorHeaderLevel",get:function(){var e=this.headers;return e?Math.max(e.length-2,0):null}},{key:"isMajorTick",value:function(e){var t=this.majorHeaderLevel;return null!=t&&this.headersDatesCache[t]&&this.headersDatesCache[t][e.getTime()]||!1}},{key:"forEachInterval",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,r=this.headers,i=this.timeAxis;if(r)if(e===r.length-1)i.forEach((function(e,r){return t.call(n,e.startDate,e.endDate,r,r===i.count-1)}));else{var o=r[e];i.forEachAuxInterval(o.unit,o.increment,t,n)}}},{key:"forEachMainInterval",value:function(e,t){this.forEachInterval(this.mainHeaderLevel,e,t)}},{key:"consumeViewPreset",value:function(e){var t=this;t.headers=null,t._thisIsAUsedExpression(t.tickSize),t.viewPreset=e,Object.assign(t,{headers:e.headers,columnLinesFor:e.columnLinesFor,mainHeaderLevel:e.mainHeaderLevel,_tickSize:t.isHorizontal?e.tickWidth:e.tickHeight}),t.originalTickSize=t.tickSize}}],[{key:"defaultConfig",get:function(){return{timeAxis:null,availableSpace:null,tickSize:100,snap:!1,forceFit:!1,headers:null,mode:"horizontal",suppressFit:!1,columnConfig:[],viewPreset:null,columnLinesFor:null,originalTickSize:null,headersDatesCache:[]}}}]),n}(Ot());function UD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}$D._$name="TimeAxisViewModel";var GD=new Date,YD=function(e){return function(e){Ye()(n,e);var t=UD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getDateFromCoordinate",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n||(e=this.currentOrientation.translateToScheduleCoordinate(e)),this.timeAxisViewModel.getDateFromPosition(e,t,r)}},{key:"getDateFromXY",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.currentOrientation.getDateFromXY(e,t,n,r)}},{key:"getDateFromDomEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getDateFromXY([e.pageX,e.pageY],t,!1,n)}},{key:"getStartEndDatesFromRectangle",value:function(e,t,n){var r,i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this,s=a.isHorizontal,l=s?a.timeAxisSubGrid.width:a.timeAxisSubGrid.height,u=s?e.x:e.top,c=s?e.right:e.bottom;return u>=0&&c<l?(r=a.getDateFromCoordinate(u,t,!0),i=a.getDateFromCoordinate(c,t,!0)):u<0?r=(i=a.getDateFromCoordinate(c,t,!0,o))&&Un.add(i,-n,"ms"):i=(r=a.getDateFromCoordinate(u,t,!0,o))&&Un.add(r,n,"ms"),{start:r,end:i}}},{key:"displayDateFormat",get:function(){return this._displayDateFormat},set:function(e){this._displayDateFormat=e,this.trigger("displayDateFormatChange",{format:e})}},{key:"getFormattedDate",value:function(e){return Un.format(e,this.displayDateFormat)}},{key:"getDisplayEndDate",value:function(e,t){return 0!==e.getHours()||0!==e.getMinutes()||t&&e.getYear()===t.getYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()||Un.formatContainsHourInfo(this.displayDateFormat)||(e=Un.add(e,-1,"day")),e}},{key:"getFormattedEndDate",value:function(e,t){return this.getFormattedDate(this.getDisplayEndDate(e,t))}},{key:"getCoordinateFromDate",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this,i=r.timeAxisViewModel,o=r.timeAxis,a=o.isContinuous,s=o.startMS,l=o.endMS,u=o.startDate,c=o.endDate,f=o.unit,d=e.valueOf();if(!0===n?n={local:!0}:n?"local"in n||(n.local=!0):n={local:!1},e instanceof Date||(GD.setTime(e),e=GD),a&&e.getTimezoneOffset()===u.getTimezoneOffset()&&u.getTimezoneOffset()===c.getTimezoneOffset()&&-1!==Un.getUnitToBaseUnitRatio(f,"day")){if(d<s||d>l)return-1;t=(d-s)/(l-s)*i.totalSize}else t=i.getPositionFromDate(e,n);return n.local||(t=r.currentOrientation.translateToPageCoordinate(t)),t}},{key:"getTimeSpanDistance",value:function(e,t){return this.timeAxisViewModel.getDistanceBetweenDates(e,t)}},{key:"viewportCenterDate",get:function(){var e=this,t=e.isHorizontal,n=e.timeAxis,r=(t?e.timeAxisSubGrid:e).scrollable,i=r.x+r.clientWidth/2,o=r.y+r.clientHeight/2;if(n.isContinuous){var a=t?i/r.scrollWidth:o/r.scrollHeight,s=n.startMS+(n.endMS-n.startMS)*a;return new Date(s)}var l=t?[i,0]:[0,o];return e.getDateFromXY(l,null,!0)}},{key:"viewportCenterDateCached",get:function(){return this.cachedCenterDate||(this.cachedCenterDate=this.viewportCenterDate)}},{key:"timeResolution",get:function(){return this.timeAxis.resolution},set:function(e){this.timeAxis.resolution="number"==typeof e?{increment:e,unit:this.timeAxis.resolution.unit}:e}},{key:"snap",get:function(){return this.isConfiguring?this._snap:this.timeAxisViewModel.snap},set:function(e){this.isConfiguring?this._snap=e:this.timeAxisViewModel.snap=e}},{key:"onSchedulerHorizontalScroll",value:function(e){e.subGrid,e.scrollLeft;this.scrollingToCenter||(this.cachedCenterDate=null)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineDateMapper"}}]),n}(e||$e)};function qD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var KD={mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut"},XD=function(e){return function(e){Ye()(n,e);var t=qD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"initDomEvents",value:function(){var e=this;e.scheduledBarEvents.element=e.schedulerEvents.element=e.timeAxisSubGridElement,e.scheduledBarEvents.thisObj=e.schedulerEvents.thisObj=e,Tu.on(e.scheduledBarEvents),Tu.on(e.schedulerEvents)}},{key:"getTimeSpanMouseEventParams",value:function(e,t){throw new Error("Implement in subclass")}},{key:"getScheduleMouseEventParams",value:function(e,t){throw new Error("Implement in subclass")}},{key:"handleScheduledBarEvent",value:function(e){var t=this,n=mi.up(e.target,t.eventInnerSelector);if(n){var r=KD[e.type]||te.capitalize(e.type);t.trigger(t.scheduledEventName+r,t.getTimeSpanMouseEventParams(n,e))}}},{key:"handleScheduleEvent",value:function(e){var t=this,n=!mi.up(e.target,t.eventSelector)&&mi.up(e.target,"."+t.timeCellCls),r=KD[e.type]||te.capitalize(e.type);if(n){var i=t.getDateFromDomEvent(e,"floor");if(!i)return;var o=ls.get(n),a=o.row.dataIndex,s=t.timeAxis.getTickFromDate(i),l=t.timeAxis.getAt(Math.floor(s));l&&t.trigger("schedule"+r,Object.assign({date:i,tickStartDate:l.startDate,tickEndDate:l.endDate,tickParentIndex:l.parentIndex,row:o.row,index:a,event:e},t.getScheduleMouseEventParams(o,e)))}}},{key:"onElementMouseButtonEvent",value:function(e){var t=mi.up(e.target,".b-sch-header-timeaxis-cell");if(t){var n=t.dataset.tickIndex,r=t.parentElement.dataset.headerPosition,i=this.timeAxisViewModel.columnConfig[r][n],o=this.features.contextMenu;if(!o||e.type!==o.triggerEvent)(this.isVertical?this.verticalTimeAxisColumn:this.timeAxisColumn).trigger("timeAxisHeader"+te.capitalize(e.type),{startDate:i.start,endDate:i.end,event:e})}}},{key:"onElementClick",value:function(e){this.onElementMouseButtonEvent(e),tt()(Ze()(n.prototype),"onElementClick",this).call(this,e)}},{key:"onElementDblClick",value:function(e){this.onElementMouseButtonEvent(e),tt()(Ze()(n.prototype),"onElementDblClick",this).call(this,e)}},{key:"onElementContextMenu",value:function(e){this.onElementMouseButtonEvent(e),tt()(Ze()(n.prototype),"onElementContextMenu",this).call(this,e)}},{key:"onElementMouseOver",value:function(e){tt()(Ze()(n.prototype),"onElementMouseOver",this).call(this,e);var t=this,r=e.target;if(r.closest(t.eventInnerSelector)){var i=r.closest(t.eventSelector);if(i.classList.add(t.overScheduledEventClass),i!==t.hoveredEventNode&&!t.preventOverCls){t.hoveredEventNode=i;var o=t.getTimeSpanMouseEventParams(i,e);o&&t.trigger(t.scheduledEventName+"MouseEnter",o)}}else t.hoveredEventNode=null}},{key:"onElementMouseOut",value:function(e){tt()(Ze()(n.prototype),"onElementMouseOut",this).call(this,e);var t=this;if(e.target.closest(t.eventInnerSelector)&&t.resolveTimeSpanRecord(e.target)&&t.hoveredEventNode){if(e.relatedTarget&&mi.isDescendant(e.target.closest(t.eventInnerSelector),e.relatedTarget))return;t.unhover(e)}}},{key:"unhover",value:function(e){var t=this,n=t.hoveredEventNode;n&&(n.classList.remove(t.overScheduledEventClass),t.trigger(t.scheduledEventName+"MouseLeave",t.getTimeSpanMouseEventParams(n,e)),t.hoveredEventNode=null)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineDomEvents"}},{key:"configurable",get:function(){return{scheduledBarEvents:{mousedown:"handleScheduledBarEvent",mouseup:"handleScheduledBarEvent",click:"handleScheduledBarEvent",dblclick:"handleScheduledBarEvent",contextmenu:"handleScheduledBarEvent",mouseover:"handleScheduledBarEvent",mouseout:"handleScheduledBarEvent"},schedulerEvents:{click:"handleScheduleEvent",dblclick:"handleScheduleEvent",contextmenu:"handleScheduleEvent",mousemove:"handleScheduleEvent"}}}}]),n}(e||$e)};function ZD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var JD=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t-e},QD=function(e){return function(e){Ye()(n,e);var t=ZD(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"presets",get:function(){return this._presets},set:function(e){!0===e&&(e=Dx.allRecords),this._presets=new xx({owner:this,data:e})}},{key:"normalizePreset",value:function(e){var t=e,n=this.presets;if(!(e instanceof Rx)){if("object"===I()(e)){if(e.base){var r=n.getById(e.base)||Dx.getById(e.base);if(!r)throw new Error("ViewPreset base '".concat(e.base,"' does not exist"));e=Qn.merge(Qn.clone(r.data),Dx.createRecord(e).data)}e.id?e=n.createRecord(e):(e=n.createRecord(Qn.assign({},e))).id=e.generateId(n)}else e="number"==typeof e?n.getAt(e):n.getById(e)||Dx.getById(e);if(!e){var i=n.map((function(e){return e.id}));throw new Error("Invalid ViewPreset: ".concat(t,". Valid strings are ").concat(i.join(", ")))}}return n.add(e)[0]}},{key:"changeViewPreset",value:function(e,t){var n=this;if(!(e instanceof Rx)&&e.name&&!e.base)throw new Error("ViewPreset name config replaced by base config. See https://www.bryntum.com/docs/scheduler/#guides/upgrades/3.0.0.md");e=n.normalizePreset(e);var r=n.lastViewPresetOptions||{},i=e.options||(e.options={}),o=i.event={startDate:i.startDate,endDate:i.endDate,from:t,to:e,preset:e},a=!n._viewPreset||!n._viewPreset.equals(e),s=JD(i.startDate,r.startDate)||JD(i.endDate,r.endDate)||JD(i.centerDate,r.centerDate)||i.startDate&&JD(i.startDate,n.startDate)||i.endDate&&JD(i.endDate,n.endDate);if((a||s)&&(a||(n._viewPreset=null),n.isConfiguring||!1!==n.trigger("beforePresetChange",o)))return e}},{key:"updateViewPreset",value:function(e){var t=this,n=e.options,r=n.event,i=n.startDate,o=n.endDate,a=t.isHorizontal,s=t._timeAxis,l=n.centerDate;if(t._viewPresetChanging=!0,t.displayDateFormat=t.config.displayDateFormat||e.displayDateFormat,s&&!t.isConfiguring){if(t.lastViewPresetOptions=n,s.isConfigured){t.suspendRefresh();var u={weekStartDay:t.weekStartDay,startTime:t.startTime,endTime:t.endTime};i?(u.startDate=i,u.endDate=o,!l&&o&&(l=new Date((i.getTime()+o.getTime())/2))):(u.startDate=s.startDate,u.endDate=o||s.endDate,l||(l=t.viewportCenterDate)),s.isConfigured=!1,s.viewPreset=e,s.reconfigure(u,!0),t.timeAxisViewModel.reconfigure({viewPreset:t.viewPreset,headers:e.headers,columnLinesFor:null!=e.columnLinesFor?e.columnLinesFor:e.headers.length-1,tickSize:a?e.tickWidth:e.tickHeight||e.tickWidth||60}),t.resumeRefresh()}if(t.refresh(),!n.notScroll&&t.isPainted)if(l){t.cachedCenterDate=l,r.centerDate=l;var c=t.isHorizontal?t.timeAxisSubGrid.width:t.scrollable.clientHeight,f=Math.max(t.getCoordinateFromDate(l,!0)-c/2,0);t.viewPresetActiveScroll=t.isHorizontal?{left:f}:{top:f},t.scrollingToCenter=!0,t.isHorizontal?t.scrollHorizontallyTo(f,!1):t.scrollVerticallyTo(f,!1),t.setTimeout((function(){t.scrollingToCenter=!1}),100)}else t.isHorizontal?t.scrollHorizontallyTo(0,!1):t.scrollVerticallyTo(0,!1)}t.dataset.presetId=e.id,t.trigger("presetChange",r),t._viewPresetChanging=!1}},{key:"doDestroy",value:function(){this._presets.owner===this&&this._presets.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineViewPresets"}},{key:"configurable",get:function(){return{viewPreset:"weekAndDayLetter"}}},{key:"defaultConfig",get:function(){return{displayDateFormat:null,presets:!0}}}]),n}(e||$e)};function eT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var tT=function(e){return function(e){Ye()(n,e);var t=eT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;tt()(Ze()(n.prototype),"construct",this).call(this,e),t.zoomOnMouseWheel&&Tu.on({element:t.timeAxisSubGridElement,wheel:"onWheel",throttled:{buffer:100,alt:function(e){e.ctrlKey&&e.preventDefault()}},thisObj:t,capture:!0,passive:!1}),t.zoomOnTimeAxisDoubleClick&&t.on("timeaxisheaderdblclick",(function(e){var n=e.startDate,r=e.endDate;t.zoomToSpan({startDate:n,endDate:r})}))}},{key:"maxZoomLevel",get:function(){return this._maxZoomLevel||this.presets.count-1},set:function(e){if("number"!=typeof e&&(e=this.presets.count-1),e<0||e>=this.presets.count)throw new Error("Invalid range for `maxZoomLevel`");this._maxZoomLevel=e}},{key:"minZoomLevel",get:function(){return this._minZoomLevel||0},set:function(e){if("number"!=typeof e&&(e=0),e<0||e>=this.presets.count)throw new Error("Invalid range for `minZoomLevel`");this._minZoomLevel=e}},{key:"zoomLevel",get:function(){return this.presets.indexOf(this.viewPreset)},set:function(e){this.zoomToLevel(e)}},{key:"getMilliSecondsPerPixelForZoomLevel",value:function(e,t){var n=e.bottomHeader,r=this.isHorizontal?e.tickWidth:e.tickHeight;return Math.round((Un.add(new Date(1,0,1),n.increment||1,n.unit)-new Date(1,0,1))/(t?r:e.actualWidth||r))}},{key:"zoomTo",value:function(e){var t=this;"object"===I()(e)?e.preset?t.zoomToLevel(e.preset,e):null!=e.level?t.zoomToLevel(e.level,e):t.zoomToSpan(e):t.zoomToLevel(e)}},{key:"zoomToLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"number"==typeof e&&(e=Math.min(Math.max(e,this.minZoomLevel),this.maxZoomLevel));var n=this,r=n.isVertical?"tickHeight":"tickWidth",i=n.normalizePreset(e),o=i[r],a=t.startDate?new Date(t.startDate):null,s=t.endDate?new Date(t.endDate):null,l=a&&s?{startDate:a,endDate:s}:null,u=t.centerDate||(l?new Date((a.getTime()+s.getTime())/2):n.viewportCenterDateCached),c=n.isVertical?n.scrollable.clientHeight:n.timeAxisSubGrid.width;return 0===c?null:(l||(l=n.calculateOptimalDateRange(u,c,i)),"width"in t&&i.setData(r,t.width),n.isZooming=!0,i.options={startDate:l.startDate||n.startDate,endDate:l.endDate||n.endDate,centerDate:u},n.viewPreset=i,i.actualWidth=n.timeAxisViewModel.tickSize,n.isZooming=!1,i.setData(r,o),n.zoomLevel)}},{key:"zoomToFit",value:function(e){var t=this.eventStore.getTotalTimeSpan();(e=Object.assign({leftMargin:0,rightMargin:0},e,t)).startDate&&e.endDate&&this.zoomToSpan(e)}},{key:"zoomToSpan",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((e.leftMargin||e.rightMargin)&&(e.adjustStart=0,e.adjustEnd=0),e.leftMargin||(e.leftMargin=0),e.rightMargin||(e.rightMargin=0),!e.startDate||!e.endDate)throw new Error("zoomToSpan: must provide startDate + endDate dates");var t=this,n=e.adjustStart>=0||e.adjustEnd>=0,r=e.startDate,i=e.endDate;if(n&&(r=Un.add(r,-e.adjustStart,t.timeAxis.mainUnit),i=Un.add(i,e.adjustEnd,t.timeAxis.mainUnit)),r<=i){var o,a,s=t.timeAxisViewModel.availableSpace,l=t.presets.allRecords,u=i-r||1,c=t.zoomLevel;-1===c&&(c=0);for(var f,d=t.getMilliSecondsPerPixelForZoomLevel(l[c],!0),h=c+(o=u/d+e.leftMargin+e.rightMargin>s?-1:1),v=null;h>=0&&h<=l.length-1;){f=l[h];var p=u/(d=t.getMilliSecondsPerPixelForZoomLevel(f,!0))+e.leftMargin+e.rightMargin;if(-1===o){if(p<=s){v=h;break}}else{if(!(p<=s))break;c!==h-o&&(v=h)}h+=o}var g=(f=l[v=null!=v?v:h-o]).bottomHeader.unit;(e.leftMargin||e.rightMargin)&&(r=new Date(r.getTime()-d*e.leftMargin),i=new Date(i.getTime()+d*e.rightMargin));var y=Un.getDurationInUnit(r,i,g,!0)/f.bottomHeader.increment;if(0===y)return null;var m=Math.floor(s/y),b=e.centerDate||new Date((r.getTime()+i.getTime())/2);return a=n?{startDate:r,endDate:i}:t.calculateOptimalDateRange(b,s,f),t.zoomToLevel(v,Object.assign(a,{width:m,centerDate:b}))}return null}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.zoomLevel;return t>=this.maxZoomLevel?null:this.zoomToLevel(t+e)}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.zoomLevel;return t<=this.minZoomLevel?null:this.zoomToLevel(t-e)}},{key:"zoomInFull",value:function(){return this.zoomToLevel(this.maxZoomLevel)}},{key:"zoomOutFull",value:function(){return this.zoomToLevel(this.minZoomLevel)}},{key:"calculateOptimalDateRange",value:function(e,t,n,r){if(r)return r;var i=this,o=i.timeAxis,a=n.bottomHeader,s=i.isHorizontal?n.tickWidth:n.tickHeight;if(i.zoomKeepsOriginalTimespan)return{startDate:o.startDate,endDate:o.endDate};var l=a.unit,u=Math.ceil(t/s*a.increment*i.visibleZoomFactor/2),c=Un.add(e,-u,l),f=Un.add(e,u,l);return{startDate:o.floorDate(c,!1,l,a.increment),endDate:o.ceilDate(f,!1,l,a.increment)}}},{key:"onWheel",value:function(e){var t=this;e.ctrlKey&&(e.preventDefault(),t.preventScrollZoom||(e.deltaY>0?t.zoomOut():e.deltaY<0&&t.zoomIn(),t.preventScrollZoom=!0,t.setTimeout((function(){return t.preventScrollZoom=!1}),30)))}},{key:"setTimeSpan",value:function(e,t){this.timeAxis.setTimeSpan(e,t)}},{key:"shift",value:function(e,t){this.timeAxis.shift(e,t)}},{key:"shiftNext",value:function(e){this.timeAxis.shiftNext(e)}},{key:"shiftPrevious",value:function(e){this.timeAxis.shiftPrevious(e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineZoomable"}},{key:"defaultConfig",get:function(){return{zoomOnMouseWheel:!0,zoomOnTimeAxisDoubleClick:!0,preventScrollZoom:null,minZoomLevel:null,maxZoomLevel:null,visibleZoomFactor:5,zoomKeepsOriginalTimespan:null}}}]),n}(e||$e)};function nT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var rT=function(e){return function(e){Ye()(n,e);var t=nT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e),this.on({beforeeventdropfinalize:"onRecurrableBeforeEventDropFinalize",beforeeventresizefinalize:"onRecurrableBeforeEventResizeFinalize",beforeEventDelete:"onRecurrableEventBeforeDelete",beforeAssignmentDelete:"onRecurrableAssignmentBeforeDelete",thisObj:this})}},{key:"changeRecurrenceConfirmationPopup",value:function(e,t){var n=this.constructor.reconfigure(t,e,"recurrenceconfirmation");return n.owner=this,n}},{key:"findRecurringEventToConfirmDelete",value:function(e){var t=this.features.eventEdit;return e.find((function(e){return e.supportsRecurring&&(e.isRecurring||e.isOccurrence)&&(!t||!t.isEditing||t.eventRecord!==e)}))}},{key:"onRecurrableEventBeforeDelete",value:function(e){var t=e.eventRecords,n=e.context,r=this.findRecurringEventToConfirmDelete(t);if(this.enableRecurringEvents&&r)return this.recurrenceConfirmationPopup.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"onRecurrableAssignmentBeforeDelete",value:function(e){var t=e.assignmentRecords,n=e.context,r=t.map((function(e){return e.event})),i=this.findRecurringEventToConfirmDelete(r);if(this.enableRecurringEvents&&i)return this.recurrenceConfirmationPopup.confirm({actionType:"delete",eventRecord:i,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"onRecurrableBeforeEventDropFinalize",value:function(e){var t=e.context;if(this.enableRecurringEvents){var n=t.eventRecords.filter((function(e){return e.supportsRecurring&&(e.isRecurring||e.isOccurrence)}));n.length&&(t.async=!0,this.recurrenceConfirmationPopup.confirm({actionType:"update",eventRecord:n[0],changerFn:function(){t.finalize(!0)},cancelFn:function(){t.finalize(!1)}}))}}},{key:"onRecurrableBeforeEventResizeFinalize",value:function(e){var t=e.context;if(this.enableRecurringEvents){var n=t.eventRecord;n.supportsRecurring&&(n.isRecurring||n.isOccurrence)&&(t.async=!0,this.recurrenceConfirmationPopup.confirm({actionType:"update",eventRecord:n,changerFn:function(){t.finalize(!0)},cancelFn:function(){t.finalize(!1)}}))}}},{key:"getOccurrencesFor",value:function(e){return this.eventStore.getOccurrencesForTimeSpan(e,this.timeAxis.startDate,this.timeAxis.endDate)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"RecurringEvents"}},{key:"configurable",get:function(){return{enableRecurringEvents:!1,recurrenceConfirmationPopup:{$config:["lazy"],value:{type:"recurrenceconfirmation"}}}}}]),n}(e||$e)};function iT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var oT=function(e){return function(e){Ye()(n,e);var t=iT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"barMargin",get:function(){return this._barMargin},set:function(e){var t=this;Qn.assertNumber(e,"barMargin"),t.isHorizontal&&t.rowHeight&&(e=Math.min(Math.ceil(t.rowHeight/2),e)),t._barMargin!==e&&(t._barMargin=e,t.rendered&&(t.currentOrientation.onBeforeRowHeightChange(),t.refreshWithTransition()))}},{key:"resourceMargin",get:function(){return null==this._resourceMargin?this.barMargin:this._resourceMargin},set:function(e){var t=this;Qn.assertNumber(e,"resourceMargin"),t.isHorizontal&&t.rowHeight&&(e=Math.min(Math.ceil(t.rowHeight/2),e)),t._resourceMargin!==e&&(t._resourceMargin=e,t.rendered&&(t.currentOrientation.onBeforeRowHeightChange(),t.refreshWithTransition()))}},{key:"tickSize",get:function(){return this.timeAxisViewModel.tickSize},set:function(e){Qn.assertNumber(e,"tickSize"),this.timeAxisViewModel.tickSize=e}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineEventRendering"}},{key:"defaultConfig",get:function(){return{barMargin:10,resourceMargin:null,managedEventSizing:!0,generatedIdCls:"b-sch-dirty-new",dirtyCls:"b-sch-dirty",committingCls:"b-sch-committing",endsOutsideViewCls:"b-sch-event-endsoutside",startsOutsideViewCls:"b-sch-event-startsoutside",fixedEventCls:"b-sch-event-fixed",eventStyle:"plain",eventColor:"green",tickSize:null}}},{key:"eventColors",get:function(){return["red","pink","purple","violet","indigo","blue","cyan","teal","green","lime","yellow","orange","deep-orange","gray"]}},{key:"eventStyles",get:function(){return["plain","border","hollow","colored","line","dashed","minimal","rounded"]}}]),n}(e||$e)};function aT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var sT={maintainVisibleStart:!0},lT={block:"nearest"},uT=function(e){return function(e){Ye()(r,e);var t,n=aT(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"initScroll",value:function(){var e=this,t=e.isHorizontal;tt()(Ze()(r.prototype),"initScroll",this).call(this);var n=(t?e.timeAxisSubGrid:e).scrollable;if(e.timelineScroller=new cT({widget:e,scrollable:n,isHorizontal:t}),n.on({scroll:"onTimelineScroll",thisObj:e}),e.infiniteScroll){var i=e.calculateInfiniteScrollingDateRange(e.viewportCenterDate),o=i.start,a=i.end;e.setTimeSpan(o,a,sT)}}},{key:"doDestroy",value:function(){var e;null===(e=this.timelineScroller)||void 0===e||e.destroy(),tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"onTimelineScroll",value:function(e){var t=e.source;this.infiniteScroll&&this.checkTimeAxisScroll(t[this.isHorizontal?"x":"y"])}},{key:"checkTimeAxisScroll",value:function(e){var t=this,n=t.timelineScroller,r=n.clientSize*t.bufferCoef*t.bufferThreshold;(n.maxPosition-e<r||e<r)&&t.shiftToDate(t.getDateFromCoordinate(e,null,!0))}},{key:"calculateInfiniteScrollingDateRange",value:function(e,t,n,r,i){var o=this.timeAxis,a=this.timeAxisViewModel,s=a.availableSpace;if(r=r||a.tickSize,n=n||o.increment||1,t=t||o.unit,i){var l=Math.ceil(s*(1+this.bufferCoef)/(2*r))*n;return{start:o.floorDate(Un.add(e,-l,t),!1,t,n),end:o.ceilDate(Un.add(e,l,t),!1,t,n)}}var u=Math.ceil(s*this.bufferCoef/r);return{start:o.floorDate(Un.add(e,-u*n,t),!1,t,n),end:o.ceilDate(Un.add(e,Math.ceil((s/r+u)*n),t),!1,t,n)}}},{key:"shiftToDate",value:function(e,t){var n=this.calculateInfiniteScrollingDateRange(e,null,null,null,t);this.setTimeSpan(n.start,n.end,sT)}},{key:"updateInfiniteScroll",value:function(e){!this.isConfiguring&&e&&this.checkTimeAxisScroll(this.timelineScroller.position)}},{key:"scrollToDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=n.timeAxis,i=n.visibleDateRange,o=n.infiniteScroll,a=r.unit,s=r.increment,l=t.edgeOffset||0,u=Un.ceil(i.endDate,s+" "+a)-Un.floor(i.startDate,s+" "+a),c=e>n.viewportCenterDate?1:-1,f=(o?u*n.bufferCoef*n.bufferThreshold:"center"===t.block?u/2:l?n.getMilliSecondsPerPixelForZoomLevel(n.viewPreset)*l:0)*c,d=new Date(e.getTime()+f),h=d>r.endDate?1:d<r.startDate?-1:0;h&&n.infiniteScroll&&n.shiftToDate(new Date(e-f),null,!0);var v=n.timelineScroller.viewport,p=n.getCoordinateFromDate(e,!0),g=n.isHorizontal?new Cr(n.getCoordinateFromDate(e,!1),v.y,n.timeAxisViewModel.tickSize,v.height):new Cr(v.x,n.getCoordinateFromDate(e,!1),v.width,n.timeAxisViewModel.tickSize);return n.scrollToCoordinate(p,g,e,t)}},{key:"scrollToNow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.scrollToDate(new Date,e)}},{key:"scrollToCoordinate",value:(t=Pt()(At.a.mark((function e(t,n,r){var i,o,a,s,l,u,c,f,d=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.length>3&&void 0!==d[3]?d[3]:{},o=this,!(t<0)){e.next=8;break}if(a=o.endDate-o.startDate,s=o.timeAxis,l=s.unit,u=s.increment,c=Un.floor(new Date(r.getTime()-a/2),u+" "+l),f=Un.add(c,a),c-o.startDate==0||f-o.endDate==0){e.next=7;break}return o.setTimeSpan(c,f),e.abrupt("return",o.scrollToDate(r,i));case 7:return e.abrupt("return");case 8:return e.next=10,o.timelineScroller.scrollIntoView(n,i);case 10:return e.abrupt("return",!o.isDestroyed&&o.nextAnimationFrame());case 11:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"scrollLeft",get:function(){return this.timeAxisSubGrid.scrollable.x},set:function(e){this.timeAxisSubGrid.scrollable.x=e}},{key:"scrollTop",get:function(){return this.scrollable.y},set:function(e){this.scrollable.y=e}},{key:"scrollHorizontallyTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.timeAxisSubGrid.scrollable.scrollTo(e,null,t)}},{key:"scrollVerticallyTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.scrollable.scrollTo(null,e,t)}},{key:"scrollTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.timeAxisSubGrid.scrollable.scrollTo(e,null,t)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineScroll"}},{key:"configurable",get:function(){return{bufferCoef:5,bufferThreshold:.2,infiniteScroll:!1}}}]),r}(e||$e)},cT=function(e){Ye()(n,e);var t=aT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateOverflowX",value:function(){}},{key:"updateOverflowY",value:function(){}},{key:"syncPartners",value:function(e){this.scrollable.syncPartners(e)}},{key:"updatePosition",value:function(e){this.scrollable[this.isHorizontal?"x":"y"]=e}},{key:"viewport",get:function(){return this.scrollable.viewport}},{key:"position",get:function(){return this.scrollable.element[this.isHorizontal?"scrollLeft":"scrollTop"]}},{key:"clientSize",get:function(){return this.scrollable["client".concat(this.isHorizontal?"Width":"Height")]}},{key:"scrollSize",get:function(){return this.scrollable["scroll".concat(this.isHorizontal?"Width":"Height")]}},{key:"maxPosition",get:function(){return this.scrollable["max".concat(this.isHorizontal?"X":"Y")]}},{key:"scrollTo",value:function(e,t){return this.isHorizontal?this.scrollable.scrollTo(e,null,t):this.scrollable.scrollTo(null,e,t)}},{key:"scrollBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lT;return this.isHorizontal?this.scrollable.scrollBy(e||t,0,n):this.scrollable.scrollBy(0,t||e,n)}},{key:"scrollIntoView",value:function(){var e;return(e=this.scrollable).scrollIntoView.apply(e,arguments)}},{key:"changeX",value:function(e){this.position=e}},{key:"changeY",value:function(e){this.position=e}},{key:"x",get:function(){return this.position},set:function(e){this.scrollable[this.isHorizontal?"x":"y"]=e}},{key:"y",get:function(){return this.position},set:function(e){this.scroller[this.isHorizontal?"x":"y"]=e}},{key:"clientWidth",get:function(){return this.clientSize}},{key:"clientHeight",get:function(){return this.clientSize}},{key:"scrollWidth",get:function(){return this.scrollSize}},{key:"scrollHeight",get:function(){return this.scrollSize}},{key:"maxX",get:function(){return this.maxPosition}},{key:"maxY",get:function(){return this.maxPosition}}],[{key:"configurable",get:function(){return{position:null,x:null,y:null}}}]),n}(ju);function fT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var dT=function(e){Ye()(n,e);var t=fT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"refreshContent",value:function(){this.headersElement&&0===this.headersElement.childNodes.length&&tt()(Ze()(n.prototype),"refreshContent",this).call(this)}}],[{key:"$name",get:function(){return"SchedulerHeader"}}]),n}(Tb);function hT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}dT._$name="Header";var vT=function(e){Ye()(n,e);var t=hT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"startConfigure",value:function(e){var t=e.grid;t.timeAxisSubGrid=this,tt()(Ze()(n.prototype),"startConfigure",this).call(this,e),t.isHorizontal&&(e.header={cls:{"b-sticky-headers":t.stickyHeaders}},delete e.headerClass),"flex"in e||"width"in e||(e.flex=1)}},{key:"changeScrollable",value:function(){var e=this,t=tt()(Ze()(n.prototype),"changeScrollable",this).apply(this,arguments);return t&&Object.defineProperty(t,"scrollWidth",{get:function(){return this.element?this.element.scrollWidth:0},set:function(){e.grid.updateCanvasSize()}}),t}},{key:"onInternalResize",value:function(e,t,r,i,o){var a=this;if(this.isPainted&&t!==i){var s=this.grid,l=s._bodyRectangle.height;mi.scrollBarWidth&&t<i&&(this.monitorResize=!1),s.onSchedulerViewportResize(t,l,i,l),this.monitorResize||this.requestAnimationFrame((function(){return a.monitorResize=!0}))}tt()(Ze()(n.prototype),"onInternalResize",this).apply(this,arguments)}}],[{key:"$name",get:function(){return"TimeAxisSubGrid"}},{key:"type",get:function(){return"timeaxissubgrid"}},{key:"configurable",get:function(){return{sealedColumns:!0,headerClass:dT}}}]),n}(ok);function pT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}vT.initClass(),vT._$name="TimeAxisSubGrid";var gT=["viewPreset","eventBarTextField","eventRenderer","eventRendererThisObj","eventBodyTemplate"],yT={fn:"exitTransition",delay:0,cancelOutstanding:!0},mT={},bT=function(e){Ye()(i,e);var t,n,r=pT(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;tt()(Ze()(i.prototype),"construct",this).call(this,e),t.$firstVerticalOverflow=!0,t.initDomEvents(),t.currentOrientation.init(),t.rowManager.on("refresh",(function(){t.forceLayout=!1}))}},{key:"createSubGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=n.stickyHeaders;return e===(n.schedulerRegion||"normal")?t.type="timeaxissubgrid":"locked"===e&&r&&n.isVertical&&(t.scrollable={overflowX:"visible",overflowY:"visible"},n.bodyContainer.classList.add("b-sticky-headers")),tt()(Ze()(i.prototype),"createSubGrid",this).call(this,e,t)}},{key:"doDestroy",value:function(){var e=this,t=e.partneredWith,n=e.currentOrientation;null==n||n.destroy(),t?(t.forEach((function(t){e.removePartner(t)})),t.destroy()):(e.timeAxisViewModel.destroy(),e.timeAxis.destroy()),tt()(Ze()(i.prototype),"doDestroy",this).call(this)}},{key:"startConfigure",value:function(e){tt()(Ze()(i.prototype),"startConfigure",this).call(this,e),bu.addResizeListener(this.bodyContainer,this.onBodyResize.bind(this)),this.getConfig("partner")}},{key:"changeStartDate",value:function(e){return"string"==typeof e&&(e=Un.parse(e)),e}},{key:"refreshVirtualScrollbars",value:function(){if(tt()(Ze()(i.prototype),"refreshVirtualScrollbars",this).call(this),!this.hasVerticalOverflow){var e=this.scrollable;this.partners.some((function(e){return e.hasVerticalOverflow}))?e.overflowY="scroll":e.overflowY=!0}}},{key:"onPaint",value:function(e){var t=e.firstPaint;if(t){var n=this,r=n.isHorizontal?n.timeAxisSubGrid.scrollable:n.scrollable,o=r[n.isHorizontal?"clientWidth":"clientHeight"];n.timeAxisViewModel.update(o,!1,!0)}tt()(Ze()(i.prototype),"onPaint",this).apply(this,arguments)}},{key:"changeSubGridConfigs",value:function(e){this.isVertical&&e.locked&&(this.verticalTimeAxisColumn.width=e.locked.width),tt()(Ze()(i.prototype),"changeSubGridConfigs",this).call(this,e)}},{key:"onSchedulerHorizontalScroll",value:function(e,t){this.currentOrientation.updateFromHorizontalScroll(t),tt()(Ze()(i.prototype),"onSchedulerHorizontalScroll",this).call(this,e,t)}},{key:"initScroll",value:function(){var e=this,t=0;tt()(Ze()(i.prototype),"initScroll",this).call(this),pe.a.isMobileSafari&&(e.scrollable.element.style.transform="translate3d(0, 0, 0)"),pe.a.isFirefox&&e.timeAxisSubGridElement.addEventListener("wheel",(function(t){var n=t.ctrlKey,r=t.deltaY,i=t.deltaX,o=Math.abs(r)>Math.abs(i);n||!o||e.scrollEndDetacher||(e.timeAxisSubGridElement.style.pointerEvents="none",e.scrollEndDetacher=e.scrollable.on({scrollEnd:function(){e.scrollEndDetacher=null,e.timeAxisSubGridElement.style.pointerEvents=""},once:!0}))})),e.on("horizontalscroll",(function(n){var r=n.subGrid,i=n.scrollLeft;!e.isPainted||r!==e.timeAxisSubGrid||e.isDestroying||e.refreshSuspended||e.onSchedulerHorizontalScroll(r,i),t++})),"horizontal"===e.testPerformance&&e.setTimeout((function(){var n=performance.now(),r=5,i=1,o=e.setInterval((function(){if(r+=5,e.scrollLeft+=(10+Math.floor(r))*i,1===i&&e.scrollLeft>5500&&(i=-1,r=5),-1===i&&e.scrollLeft<=0){var a=1e3/((performance.now()-n)/t);a=Math.round(10*a)/10,clearInterval(o),console.log(e.eventPositionMode,e.eventScrollMode,a+"fps")}}),0)}),500)}},{key:"preserveViewCenter",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=this,a=o.viewportCenterDate,s=e.apply(t,r),l=o.timelineScroller,u=l.clientSize,c=Math.max(Math.floor(o.getCoordinateFromDate(a,!0)-u/2),0);return o.scrollingToCenter=!0,l.scrollTo(c,!1).then((function(){return o.scrollingToCenter=!1})),s}},{key:"setTimeSpan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mT,r=n.preventThrow,i=void 0!==r&&r,o=n.maintainVisibleStart,a=void 0!==o&&o,s=this,l=s.timeAxis,u=l.getAdjustedDates(e,t),c=u.startDate,f=u.endDate,d=l.startDate-c!=0,h=l.endDate-f!=0;if(d||h){if(a){var v=s.timeAxisViewModel,p=v.totalSize,g=v.tickSize,y=s.timelineScroller,m=y.position,b=v.getDateFromPosition(m);b>=c&&b<f&&v.on({update:function(){var e=v.tickSize!==g;s.updateCanvasSize(),!d||h||e?y.position=d||e?v.getPositionFromDate(b):m:y.position+=v.totalSize-p,y.syncPartners(!0)},prio:1e4,once:!0})}return l.reconfigure({startDate:c,endDate:f},!1,i)}}},{key:"hasVisibleEvents",get:function(){var e=this;return!this.noFeatureElementsInAxis()||this.eventStore.storage.values.some((function(t){return e.timeAxis.isTimeSpanInAxis(t)}))}},{key:"noFeatureElementsInAxis",value:function(){}},{key:"capitalizedEventName",get:function(){return this._capitalizedEventName||(this._capitalizedEventName=te.capitalize(this.scheduledEventName)),this._capitalizedEventName}},{key:"partner",get:function(){return this._partner},set:function(e){this._partner=e,this.addPartner(e)}},{key:"addPartner",value:function(e){var t=this;if(!t.isPartneredWith(e)){(t.partneredWith||(t.partneredWith=new na)).add(e),(e.partneredWith||(e.partneredWith=new na)).add(t),t.getConfig("viewPreset"),e.on({presetchange:"onPartnerPresetChange",thisObj:t});var n=t.partnerSharedConfigs.reduce((function(t,n){return t[n]=e[n],t}),{});t.setConfig(n),t.on({presetchange:"onPartnerPresetChange",thisObj:e}),t.isPainted?t.scrollable.addPartner(e.scrollable,"x"):t.initScroll=at.createSequence(t.initScroll,(function(){t.scrollable.addPartner(e.scrollable,"x")}),t)}}},{key:"removePartner",value:function(e){var t=this,n=t.partneredWith;t.isPartneredWith(e)&&(n.remove(e),t.scrollable.removePartner(e.scrollable),t.un({presetchange:"onPartnerPresetChange",thisObj:e}),e.removePartner(t))}},{key:"isPartneredWith",value:function(e){var t;return Boolean(null===(t=this.partneredWith)||void 0===t?void 0:t.includes(e))}},{key:"onPartnerPresetChange",value:function(e){var t=e.preset,n=e.startDate,r=e.endDate,i=e.centerDate;this._viewPresetChanging||this.viewPreset===t||(t.options={startDate:n,endDate:r,centerDate:i},this.viewPreset=t)}},{key:"partners",get:function(){var e=this.partner?[this.partner]:[];return this.partneredWith&&e.push.apply(e,this.partneredWith.all),e}},{key:"timeAxisColumn",get:function(){return this.columns&&this._timeAxisColumn}},{key:"columns",get:function(){return tt()(Ze()(i.prototype),"columns",this)},set:function(e){var t,n,r,o,a=this;if(e){var s=Array.isArray(e),l=e;s||(l=e.data),t=l&&l.length,l.some((function(e,r){return"timeAxis"===e.type&&(t=r,n=Qn.assign(e,a.timeAxisColumn),!0)})),a.isVertical?(a._horizontalColumns=e,l=[Qn.assign({type:"verticalTimeAxis",locked:!0},a.verticalTimeAxisColumn),l[t]],t=1):l=l.slice(),n=l[t]=Object.assign({type:"timeAxis",locked:!1,cellCls:a.timeCellCls,mode:a.mode},n),gT.forEach((function(e){null!=(o=a[e])&&(n[e]=o)})),s?e=l:e.data=l}gh()(Ze()(i.prototype),"columns",e,this,!0),e&&(r=a._timeAxisColumn=a.columns.getAt(t),a.isVertical&&(a.verticalTimeAxisColumn=a.columns.getAt(t-1),a.verticalTimeAxisColumn.relayAll(a)),r.relayAll(a))}},{key:"timeView",get:function(){var e=this;return e.columns&&e.isVertical?e.verticalTimeAxisColumn&&e.verticalTimeAxisColumn.view:e.timeAxisColumn&&e.timeAxisColumn.timeAxisView}},{key:"eventCls",get:function(){return this._eventCls},set:function(e){var t=this;t._eventCls=e,t.eventSelector||(t.eventSelector=".".concat(e,"-wrap"),t.unreleasedEventSelector="".concat(t.eventSelector)),t.eventInnerSelector||(t.eventInnerSelector="."+e)}},{key:"timeAxisViewModel",get:function(){return this._timeAxisViewModel||(this.timeAxisViewModel=null),this._timeAxisViewModel},set:function(e){var t=this,n=t._timeAxisViewModel,r={name:"timeAxisViewModel",update:"onTimeAxisViewModelUpdate",prio:100,thisObj:t};t.partner&&!e||n&&n===e||((null==n?void 0:n.owner)===t&&n.destroy(),t.detachListeners("timeAxisViewModel"),e&&e.isTimeAxisViewModel?e.on(r):(e=Object.assign({mode:t._mode,snap:t.snap,forceFit:t.forceFit,timeAxis:t.timeAxis,suppressFit:t.suppressFit,listeners:r,owner:t},e),e=new $D(e)),!t.isConfiguring&&t.timeAxisColumn&&(t.timeAxisColumn.timeAxisViewModel=e),t._timeAxisViewModel=e,t.relayEvents(e,["update"],"timeAxisViewModel"),n&&e&&t.trigger("timeAxisViewModelChange",{timeAxisViewModel:e}))}},{key:"suppressFit",get:function(){var e,t;return null!==(e=null===(t=this._timeAxisViewModel)||void 0===t?void 0:t.suppressFit)&&void 0!==e?e:this._suppressFit},set:function(e){this._timeAxisViewModel?this.timeAxisViewModel.suppressFit=e:this._suppressFit=e}},{key:"timeAxis",get:function(){return this._timeAxis||(this.timeAxis=null),this._timeAxis},set:function(e){var t=this,n=t._timeAxis,r={name:"timeAxis",reconfigure:function(e){var n=e.config;t.trigger("timeAxisChange",{config:n})},thisObj:t};t.partner&&!e||n&&n===e||(n&&n.owner===t&&n.destroy(),t.detachListeners("timeAxis"),e&&e.isTimeAxis||(e=Qn.assign({owner:t,viewPreset:t.viewPreset,autoAdjust:t.autoAdjustTimeAxis,mode:"plain",weekStartDay:t.weekStartDay},e),t.startDate&&(e.startDate=t.startDate),t.endDate&&(e.endDate=t.endDate),t.workingTime&&t.applyWorkingTime(e),e=new Ox(e)),e.on(r),t._timeAxis=e)}},{key:"workingTime",get:function(){return this._workingTime},set:function(e){this._workingTime=e,this.isConfiguring||this.applyWorkingTime(this.timeAxis)}},{key:"applyWorkingTime",value:function(e){var t,n=this,r=n._workingTime;if(r){var i=null;r.fromHour>=0&&r.fromHour<24&&r.toHour>r.fromHour&&r.toHour<=24&&r.toHour-r.fromHour<24&&(i={from:r.fromHour,to:r.toHour});var o=null;r.fromDay>=0&&r.fromDay<7&&r.toDay>r.fromDay&&r.toDay<=7&&r.toDay-r.fromDay<7&&(o={from:r.fromDay,to:r.toDay}),e.include=i||o?{hour:i,day:o}:null}else e.include=null;n.isPainted&&(n.timeAxisColumn.refreshHeader(),null===(t=n.features.columnLines)||void 0===t||t.refresh(),n.refreshWithTransition())}},{key:"updateStartDate",value:function(e){this.setStartDate(e)}},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n._timeAxis,i=r||mT,o=i.startDate,a=i.endDate,s=i.mainUnit;if("string"==typeof e&&(e=Un.parse(e)),r&&a){if(e){var l=a;if(t&&o){var u=Un.diff(o,a,s,!0);l=Un.add(e,u,s)}n.setTimeSpan(e,l)}}else n._tempStartDate=e}},{key:"startDate",get:function(){var e=this;return e._timeAxis?e._timeAxis.startDate:e._tempStartDate||new Date}},{key:"changeEndDate",value:function(e){"string"==typeof e&&(e=Un.parse(e)),this.setEndDate(e)}},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n._timeAxis,i=r||mT,o=i.startDate,a=i.endDate,s=i.mainUnit;if("string"==typeof e&&(e=Un.parse(e)),r&&o){if(e){var l=o;if(t&&a){var u=Un.diff(o,a,s,!0);l=Un.add(e,-u,s)}n.setTimeSpan(l,e)}}else n._tempEndDate=e}},{key:"endDate",get:function(){var e=this;return e._timeAxis?e._timeAxis.endDate:e._tempEndDate||Un.add(e.startDate,e.viewPreset.defaultSpan,e.viewPreset.mainHeader.unit)}},{key:"features",get:function(){return tt()(Ze()(i.prototype),"features",this)},set:function(e){"regionResize"in(e=!0===e?{}:e)||(e.regionResize=!0),gh()(Ze()(i.prototype),"features",e,this,!0)}},{key:"eventStyle",get:function(){return this._eventStyle},set:function(e){var t=this;t._eventStyle=e,t.isPainted&&t.refreshWithTransition()}},{key:"eventColor",get:function(){return this._eventColor},set:function(e){var t=this;t._eventColor=e,t.isPainted&&t.refreshWithTransition()}},{key:"onLocaleChange",value:function(){tt()(Ze()(i.prototype),"onLocaleChange",this).call(this);var e=this.timeAxis.autoAdjust;this.timeAxis.reconfigure({autoAdjust:!1}),this.timeAxis.autoAdjust=e}},{key:"onBodyResize",value:function(e,t,n){var r=n.width,i=n.height;this.isVertical&&t&&r!==t.width&&delete this.timeAxisSubGrid._width;var o=this.timeAxisSubGrid.element.offsetWidth;this._bodyRectangle&&t&&i!==t.height&&this.onSchedulerViewportResize(o,i,o,t.height)}},{key:"onSchedulerViewportResize",value:function(e,t,n,r){if(this.isPainted){var i=this,o=i.isHorizontal,a=i.timeAxisViewModel,s=i.rowManager,l=i.partneredWith,u=i.timeAxisSubGrid;i.currentOrientation.onViewportResize(e,t,n,r),o&&u.height>=s.totalHeight&&u.height-s.totalHeight<=mi.scrollBarWidth&&!u.overflowingVertically?a.availableSpace=e-mi.scrollBarWidth:a.availableSpace=o?e:Math.floor(t),l&&!i.isSyncingFromPartner&&l.forEach((function(e){e.isSyncingFromPartner||(e.isSyncingFromPartner=!0,i.eachSubGrid((function(t){var n=e.subGrids[t.region];n.width!==t.width&&(t.collapsed?n.collapse():(n.collapsed&&n.expand(),t.flex?t.flex!==n.flex&&(n.flex=t.flex):n.width=t.width))})),e.isSyncingFromPartner=!1)})),i.trigger("timelineViewportResize",{width:e,height:t,oldWidth:n,oldHeight:r})}}},{key:"onTimeAxisViewModelUpdate",value:function(){this.updateCanvasSize(),this.currentOrientation.onTimeAxisViewModelUpdate()}},{key:"currentOrientation",get:function(){throw new Error("Implement in subclass")}},{key:"isHorizontal",get:function(){return!0}},{key:"backgroundCanvas",get:function(){return this._backgroundCanvas}},{key:"foregroundCanvas",get:function(){return this._foregroundCanvas}},{key:"svgCanvas",get:function(){var e=this;if(!e._svgCanvas){var t=e._svgCanvas=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("id",Wo.generateId("svg")),t.retainElement=!0,e.foregroundCanvas.appendChild(t),e.trigger("svgCanvasCreated")}return e._svgCanvas}},{key:"timeAxisSubGridElement",get:function(){return this.getConfig("regions"),this.timeAxisColumn&&this.timeAxisColumn.subGridElement}},{key:"updateCanvasSize",value:function(){var e=this,t=e.timeAxisViewModel.totalSize,n=e.isHorizontal?t:e.timeAxisColumn.width,r=!1;return e.isVertical&&(e.isPainted&&e.refreshTotalHeight(t,!0),e.suppressFit&&mi.setLength(e.foregroundCanvas,"height",t),r=!0),n!==e.$canvasWidth&&(e.backgroundCanvas&&mi.setLength(e.backgroundCanvas,"width",n),mi.setLength(e.foregroundCanvas,"width",n),e.$canvasWidth=n,r=!0),r}},{key:"getHeaderDomConfigs",value:function(e){}},{key:"getForegroundDomConfigs",value:function(e){}},{key:"onStoreDataChange",value:(n=Pt()(At.a.mark((function e(t){var n=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("dataset"!==t.action||!this.project.isRepopulatingStores){e.next=4;break}return e.next=4,this.project.await("refresh",!1);case 4:tt()(Ze()(i.prototype),"onStoreDataChange",this).apply(this,n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"refresh",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this;t.isPainted&&!t.refreshSuspended&&(t.hasVisibleEvents?t.isEngineReady?t.refreshRows(!1,e):(t.refreshAfterProjectRefresh=!0,t.currentOrientation.refreshAllWhenReady=!0):t.rowManager.trigger("refresh"))}},{key:"render",value:function(){var e=this,t=e.timeAxisSubGridElement;e.useBackgroundCanvas&&(e._backgroundCanvas=mi.createElement({className:"b-sch-background-canvas",parent:t,nextSibling:t.firstElementChild}));var n=e._foregroundCanvas=mi.createElement({className:"b-sch-foreground-canvas",style:"font-size:".concat(e.rowHeight-2*e.resourceMargin,"px"),parent:t});e.timeAxisSubGrid.insertRowsBefore=n,e.isVertical&&e.suppressFit&&e.updateCanvasSize(),tt()(Ze()(i.prototype),"render",this).apply(this,arguments),e.visibleDate&&(e.visibleDate instanceof Date&&(e.visibleDate={date:e.visibleDate}),e.scrollToDate(e.visibleDate.date,e.visibleDate))}},{key:"refreshRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;n.isConfiguring||(n.currentOrientation.refreshRows(t),tt()(Ze()(i.prototype),"refreshRows",this).call(this,e))}},{key:"getDateConstraints",value:function(){}},{key:"runWithTransition",value:function(e,t){var n=this;n.isVisible&&(null!=t&&!0!==t||(t=n.transitionDuration),t&&n.enableEventAnimations&&(n.hasTimeout("exitTransition")||(n.isAnimating=!0),yT.delay=t,n.setTimeout(yT))),e()}},{key:"exitTransition",value:function(){this.isAnimating=!1,this.trigger("transitionend")}},{key:"waitForAnimations",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEngineReady){e.next=3;break}return e.next=3,this.project.await("dataReady",!1);case 3:return e.next=5,tt()(Ze()(i.prototype),"waitForAnimations",this).call(this);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"refreshWithTransition",value:function(e,t){var n=this;this.runWithTransition((function(){return n.refresh(e)}),t)}},{key:"getVisibleDateRange",value:function(){return z.a.deprecate("scheduler","5.0.0","Deprecated in favor of `get visibleDateRange`"),this.visibleDateRange}},{key:"visibleDateRange",get:function(){return this.currentOrientation.visibleDateRange}},{key:"formatDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationDisplayPrecision,n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"beginListeningForBatchedUpdates",value:function(){this.listenToBatchedUpdates=(this.listenToBatchedUpdates||0)+1}},{key:"endListeningForBatchedUpdates",value:function(){this.listenToBatchedUpdates&&(this.listenToBatchedUpdates-=1)}}],[{key:"$name",get:function(){return"TimelineBase"}},{key:"type",get:function(){return"timelinebase"}},{key:"configurable",get:function(){return{partnerSharedConfigs:{value:["timeAxisViewModel","timeAxis","viewPreset"],$config:{merge:"distinct"}},startDate:{$config:{equal:"date"},value:null},endDate:{$config:{equal:"date"},value:null},stickyHeaders:!0}}},{key:"defaultConfig",get:function(){return{workingTime:null,timeAxis:null,timeAxisViewModel:null,autoAdjustTimeAxis:!0,visibleDate:null,snap:!1,snapRelativeToEventStartDate:!1,forceFit:!1,suppressFit:!1,eventCls:null,getDateConstraints:null,timeCellCls:null,timeCellSelector:null,scheduledEventName:null,createEventOnDblClick:!0,overScheduledEventClass:null,preventOverCls:!1,hoveredEventNode:null,useBackgroundCanvas:!1,enableEventAnimations:!pe.a.isIE11,disableGridRowModelWarning:!0,animateRemovingRows:!1,partner:null,schedulerRegion:"normal",transitionDuration:200,animationTimeout:null,defaultRegion:"locked",durationDisplayPrecision:1,asyncEventSuffix:"PreCommit",viewportResizeTimeout:250}}}]),i}(bk.mixin(YD,XD,oT,uT,QD,tT,rT));bT.initClass(),z.a.setVersion("scheduler","4.2.1"),bT._$name="TimelineBase";var kT=Ut.mergeLocales(fk,{Object:{newEvent:"New event"},ResourceInfoColumn:{eventCountText:function(e){return e+" event"+(1!==e?"s":"")}},Dependencies:{from:"From",to:"To",valid:"Valid",invalid:"Invalid"},DependencyType:{SS:"SS",SF:"SF",FS:"FS",FF:"FF",StartToStart:"Start-to-Start",StartToEnd:"Start-to-End",EndToStart:"End-to-Start",EndToEnd:"End-to-End",short:["SS","SF","FS","FF"],long:["Start-to-Start","Start-to-End","End-to-Start","End-to-End"]},DependencyEdit:{From:"From",To:"To",Type:"Type",Lag:"Lag","Edit dependency":"Edit dependency",Save:"Save",Delete:"Delete",Cancel:"Cancel",StartToStart:"Start to Start",StartToEnd:"Start to End",EndToStart:"End to Start",EndToEnd:"End to End"},EventEdit:{Name:"Name",Resource:"Resource",Start:"Start",End:"End",Save:"Save",Delete:"Delete",Cancel:"Cancel","Edit event":"Edit event",Repeat:"Repeat"},EventDrag:{eventOverlapsExisting:"Event overlaps existing event for this resource",noDropOutsideTimeline:"Event may not be dropped completely outside the timeline"},SchedulerBase:{"Add event":"Add event","Delete event":"Delete event","Unassign event":"Unassign event"},HeaderContextMenu:{pickZoomLevel:"Zoom",activeDateRange:"Date range",startText:"Start date",endText:"End date",todayText:"Today"},TimeAxisHeaderMenu:{pickZoomLevel:"Zoom",activeDateRange:"Date range",startText:"Start date",endText:"End date",todayText:"Today"},EventCopyPaste:{copyEvent:"Copy event",cutEvent:"Cut event",pasteEvent:"Paste event"},EventFilter:{filterEvents:"Filter tasks",byName:"By name"},TimeRanges:{showCurrentTimeLine:"Show current timeline"},PresetManager:{secondAndMinute:{displayDateFormat:"ll LTS"},minuteAndHour:{topDateFormat:"ddd MM/DD, hA",displayDateFormat:"ll LST"},hourAndDay:{topDateFormat:"ddd MM/DD",middleDateFormat:"LST",displayDateFormat:"ll LST"},weekAndDay:{displayDateFormat:"ll LST"},dayAndWeek:{displayDateFormat:"ll LST"}},RecurrenceConfirmationPopup:{"delete-title":"You are deleting an event","delete-all-message":"Do you want to delete all occurrences of this event?","delete-further-message":"Do you want to delete this and all future occurrences of this event, or only the selected occurrence?","delete-further-btn-text":"Delete All Future Events","delete-only-this-btn-text":"Delete Only This Event","update-title":"You are changing a repeating event","update-all-message":"Do you want to change all occurrences of this event?","update-further-message":"Do you want to change only this occurrence of the event, or this and all future occurrences?","update-further-btn-text":"All Future Events","update-only-this-btn-text":"Only This Event",Yes:"Yes",Cancel:"Cancel",width:600},RecurrenceLegend:{" and ":" and ",Daily:"Daily","Weekly on {1}":function(e){var t=e.days;return"Weekly on ".concat(t)},"Monthly on {1}":function(e){var t=e.days;return"Monthly on ".concat(t)},"Yearly on {1} of {2}":function(e){var t=e.days,n=e.months;return"Yearly on ".concat(t," of ").concat(n)},"Every {0} days":function(e){var t=e.interval;return"Every ".concat(t," days")},"Every {0} weeks on {1}":function(e){var t=e.interval,n=e.days;return"Every ".concat(t," weeks on ").concat(n)},"Every {0} months on {1}":function(e){var t=e.interval,n=e.days;return"Every ".concat(t," months on ").concat(n)},"Every {0} years on {1} of {2}":function(e){var t=e.interval,n=e.days,r=e.months;return"Every ".concat(t," years on ").concat(n," of ").concat(r)},position1:"the first",position2:"the second",position3:"the third",position4:"the fourth",position5:"the fifth","position-1":"the last",day:"day",weekday:"weekday","weekend day":"weekend day",daysFormat:function(e){var t=e.position,n=e.days;return"".concat(t," ").concat(n)}},RecurrenceEditor:{"Repeat event":"Repeat event",Cancel:"Cancel",Save:"Save",Frequency:"Frequency",Every:"Every",DAILYintervalUnit:"day(s)",WEEKLYintervalUnit:"week(s)",MONTHLYintervalUnit:"month(s)",YEARLYintervalUnit:"year(s)",Each:"Each","On the":"On the","End repeat":"End repeat","time(s)":"time(s)"},RecurrenceDaysCombo:{day:"day",weekday:"weekday","weekend day":"weekend day"},RecurrencePositionsCombo:{position1:"first",position2:"second",position3:"third",position4:"fourth",position5:"fifth","position-1":"last"},RecurrenceStopConditionCombo:{Never:"Never",After:"After","On date":"On date"},RecurrenceFrequencyCombo:{Daily:"Daily",Weekly:"Weekly",Monthly:"Monthly",Yearly:"Yearly"},RecurrenceCombo:{None:"None",Custom:"Custom..."},Summary:{"Summary for":function(e){return"Summary for ".concat(e)}},ScheduleRangeCombo:{completeview:"Complete schedule",currentview:"Visible schedule",daterange:"Date range",completedata:"Complete schedule (for all events)"},SchedulerExportDialog:{"Schedule range":"Schedule range","Export from":"From","Export to":"To"},ExcelExporter:{"No resource assigned":"No resource assigned"},CrudManagerView:{serverResponseLabel:"Server response:"}});function wT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}Yt.registerLocale("En",{desc:"English",locale:kT});var CT=function(e){return function(e){Ye()(n,e);var t=wT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getElementFromAssignmentRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.currentOrientation.getElementFromAssignmentRecord(e,t)}},{key:"getElementFromEventRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.currentOrientation.getElementFromEventRecord(e,t,n)}},{key:"getElementsFromEventRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.currentOrientation.getElementsFromEventRecord(e,t,n)}},{key:"resolveResourceRecord",value:function(e,t){return this.currentOrientation.resolveRowRecord(e,t)}},{key:"resolveEventRecord",value:function(e){if(e=mi.up(e,this.eventSelector)){if(e.dataset.eventId)return this.eventStore.getById(e.dataset.eventId);if(e.dataset.assignmentId)return this.assignmentStore.getById(e.dataset.assignmentId).event}return null}},{key:"resolveTimeSpanRecord",value:function(e){return this.resolveEventRecord(e)}},{key:"resolveAssignmentRecord",value:function(e){var t=mi.up(e,this.eventSelector),n=t&&this.assignmentStore.getById(t.dataset.assignmentId),r=t&&this.eventStore.getById(t.dataset.eventId);return this.assignmentStore.getOccurrence(n,r)}},{key:"isRowVisible",value:function(e){return this.store.indexOf(e)>=0}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerDom"}}]),n}(e||$e)};function RT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var ST=function(e){return function(e){Ye()(n,e);var t=RT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getTimeSpanMouseEventParams",value:function(e,t){var n=this.resolveEventRecord(e);return n&&{eventRecord:n,resourceRecord:this.resolveResourceRecord(e),assignmentRecord:this.resolveAssignmentRecord(e),eventElement:e,event:t}}},{key:"getScheduleMouseEventParams",value:function(e,t){return{resourceRecord:this.isVertical?this.resolveResourceRecord(t):this.store.getById(e.id)}}},{key:"onElementKeyDown",value:function(e){tt()(Ze()(n.prototype),"onElementKeyDown",this).call(this,e);var t=this;t.selectedEvents.length&&t.trigger(t.scheduledEventName+"KeyDown",{eventRecords:t.selectedEvents,assignmentRecords:t.selectedAssignments,event:e,eventRecord:t.selectedEvents,assignmentRecord:t.selectedAssignments})}},{key:"onElementKeyUp",value:function(e){tt()(Ze()(n.prototype),"onElementKeyUp",this).call(this,e);var t=this;t.selectedEvents.length&&t.trigger(t.scheduledEventName+"KeyUp",{eventRecords:t.selectedEvents,assignmentRecords:t.selectedAssignments,event:e,eventRecord:t.selectedEvents,assignmentRecord:t.selectedAssignments})}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerDomEvents"}}]),n}(e||$e)};function xT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var ET=function(e){Ye()(n,e);var t=xT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"clearCache",value:function(e){e?delete this.nbrOfBandsByResource[e.id]:this.nbrOfBandsByResource={}}},{key:"getNumberOfBands",value:function(e,t){var n=this.nbrOfBandsByResource;if(n.hasOwnProperty(e.id))return n[e.id];var r=("function"==typeof t?t():t).map((function(e){return{start:e.startDate,end:e.endDate,event:e}}));return this.applyLayout(r,e)}},{key:"applyLayout",value:function(e,t){var n=e.slice(),r=this.layoutEventsInBands(n);return this.nbrOfBandsByResource[t.id]=r}}],[{key:"defaultConfig",get:function(){return{nbrOfBandsByResource:{},bandIndexToPxConvertFn:null,bandIndexToPxConvertThisObj:null}}}]),n}($e);function DT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}ET._$name="HorizontalLayout";var TT=function(e){Ye()(n,e);var t=DT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"layoutEventsInBands",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;do{for(var r=0,i=e[0];i;)t||(i.top=this.bandIndexToPxConvertFn.call(this.bandIndexToPxConvertThisObj||this,n,i.eventRecord,i.resourceRecord)),e.splice(r,1),i=e[r=this.findClosestSuccessor(i,e)];n++}while(e.length>0);return n}},{key:"findClosestSuccessor",value:function(e,t){for(var n,r,i,o=e.endMS,a=e.eventRecord&&0===e.eventRecord.duration,s=1/0,l=0,u=t.length;l<u;l++)(r=(i=t[l]).startMS-o)>=0&&r<s&&(r>0||i.endMS-i.startMS>0||!a)&&(n=l,s=r);return n}}]),n}(ET);function OT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}TT._$name="HorizontalLayoutStack";var MT=function(e){return function(e){Ye()(n,e);var t=OT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"applyLayout",value:function(e,t){for(var n,r,i,o,a=this,s=a.coordProp,l=a.sizeProp,u=0,c=e.length;u<c;u++){if(r=e[u],n=a.findStartSlot(e,r),(i=a.getCluster(e,u)).length>1){for(r[s]=n.start,r[l]=n.end-n.start,o=1;o<i.length-1&&i[o+1].start-r.start==0;)o++;var f=a.findStartSlot(e,i[o]);f&&f.start<.8&&(i.length=o)}var d=i.length,h=(n.end-n.start)/d;for(o=0;o<d;o++)t(i[o],o,n,h);u+=d-1}}},{key:"findStartSlot",value:function(e,t){var n,r=this.sizeProp,i=this.coordProp,o=this.getPriorOverlappingEvents(e,t);if(0===o.length)return{start:0,end:1};for(n=0;n<o.length;n++){if(0===n&&o[0][i]>0)return{start:0,end:o[0][i]};if(o[n][i]+o[n][r]<(n<o.length-1?o[n+1][i]:1))return{start:o[n][i]+o[n][r],end:n<o.length-1?o[n+1][i]:1}}return!1}},{key:"getPriorOverlappingEvents",value:function(e,t){for(var n=t.start,r=t.end,i=[],o=0,a=e.indexOf(t);o<a;o++)Un.intersectSpans(n,r,e[o].start,e[o].end)&&i.push(e[o]);return i.sort(this.sortOverlappers.bind(this)),i}},{key:"sortOverlappers",value:function(e,t){return e[this.coordProp]<t[this.coordProp]?-1:1}},{key:"getCluster",value:function(e,t){var n=e[t];if(t>=e.length-1)return[n];for(var r=[n],i=e.length,o=n.start,a=n.end,s=t+1;s<i&&Un.intersectSpans(o,a,e[s].start,e[s].end);)r.push(e[s]),o=Un.max(o,e[s].start),a=Un.min(e[s].end,a),s++;return r}}],[{key:"$name",get:function(){return"PackMixin"}},{key:"defaultConfig",get:function(){return{coordProp:"top",sizeProp:"height"}}}]),n}(e||$e)};function AT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var IT=function(e){Ye()(n,e);var t=AT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"applyLayout",value:function(e){var t=this;tt()(Ze()(n.prototype),"applyLayout",this).call(this,e,(function(e,t,n,r){e.height=r,e.top=n.start+t*r})),e.forEach((function(e){Object.assign(e,t.bandIndexToPxConvertFn.call(t.bandIndexToPxConvertThisObj||t,e.top,e.height,e.eventRecord,e.resourceRecord))}))}}]),n}(ET.mixin(MT));function PT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}IT._$name="HorizontalLayoutPack";var FT=function(e){return function(e){Ye()(n,e);var t=PT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"eventPrefix",get:function(){return this._eventPrefix},set:function(e){this._eventPrefix=e||this.id+"-"}},{key:"updateEventLayout",value:function(e,t){var n=this;t&&n.element.classList.remove("b-eventlayout-".concat(t)),n.element.classList.add("b-eventlayout-".concat(e)),n.isConfiguring||n.refreshWithTransition()}},{key:"getEventLayoutHandler",value:function(e){var t=this,n=t.timeAxisViewModel,r=t.horizontal;if(!t.isHorizontal)return null;switch(t.layouts||(t.layouts={}),e){case"stack":return t.layouts.horizontalStack||(t.layouts.horizontalStack=new t.horizontalLayoutStackClass({scheduler:t,timeAxisViewModel:n,bandIndexToPxConvertFn:r.layoutEventVerticallyStack,bandIndexToPxConvertThisObj:r})),t.layouts.horizontalStack;case"pack":return t.layouts.horizontalPack||(t.layouts.horizontalPack=new t.horizontalLayoutPackClass({scheduler:t,timeAxisViewModel:n,bandIndexToPxConvertFn:r.layoutEventVerticallyPack,bandIndexToPxConvertThisObj:r})),t.layouts.horizontalPack;default:return null}}},{key:"fillTicks",get:function(){return this._fillTicks},set:function(e){e!==this._fillTicks&&(this._fillTicks=e,this.isConfiguring||this.refreshWithTransition())}},{key:"useInitialAnimation",get:function(){return this._useInitialAnimation},set:function(e){var t=this;t._useInitialAnimation&&t.element.classList.remove("b-initial-".concat(t._useInitialAnimation)),t._useInitialAnimation=!0===e?"fade-in":e,e&&(t.element.classList.add("b-initial-".concat(t._useInitialAnimation)),pe.a.isFirefox&&t.element.classList.add("b-prevent-event-transitions"))}},{key:"horizontalEventSorterFn",get:function(){return this._horizontalEventSorterFn},set:function(e){this._horizontalEventSorterFn=e,this.rendered&&this.refreshWithTransition()}},{key:"resourceColumns",get:function(){var e;return(null===(e=this.timeAxisColumn)||void 0===e?void 0:e.resourceColumns)||this._resourceColumns},set:function(e){this._resourceColumns=e}},{key:"resourceColumnWidth",get:function(){return this.resourceColumns?this.resourceColumns.columnWidth:null}},{key:"getEventsToRender",value:function(e,t){return t}},{key:"repaintEventsForResource",value:function(e){this.currentOrientation.repaintEventsForResource(e)}},{key:"repaintEvent",value:function(e){var t=this;this.eventStore.getResourcesForEvent(e).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"getResourceMargin",value:function(e){var t;return null!==(t=null==e?void 0:e.resourceMargin)&&void 0!==t?t:this.resourceMargin}},{key:"getBarMargin",value:function(e){var t;return null!==(t=null==e?void 0:e.barMargin)&&void 0!==t?t:this.barMargin}},{key:"getResourceHeight",value:function(e){var t,n,r=this.getRowById(e);return null!==(t=null!==(n=null==r?void 0:r.maxRequestedHeight)&&void 0!==n?n:e.rowHeight)&&void 0!==t?t:this.rowHeight}},{key:"getResourceLayoutSettings",value:function(e){return{resourceMargin:this.getResourceMargin(e),barMargin:this.getBarMargin(e),rowHeight:this.getResourceHeight(e)}}},{key:"generateRenderData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{viewport:!0},r=this,i=r.currentOrientation.getTimeSpanRenderData(e,t,n),o=e.isEvent,a=e.isMilestone,s=o&&e.assignments.find((function(e){return e.resourceId===t.id})),l={className:"b-sch-event-content",dataset:{taskBarFeature:"content"}};if(i){var u,c,f=e.isResizable;i.startsOutsideView&&(!0===f?f="end":"start"===f&&(f=!1)),i.endsOutsideView&&(!0===f?f="start":"end"===f&&(f=!1));var d=e.isResourceTimeRange?new xr:e.cls.clone(),h=e.isResourceTimeRange?e.cls.clone():new xr,v=Boolean(e.hasPersistableChanges||s&&s.hasPersistableChanges);if(Qn.assign(d,(u={},Qe()(u,t.cls,t.cls),Qe()(u,r.generatedIdCls,e.hasGeneratedId),Qe()(u,r.dirtyCls,v),Qe()(u,r.committingCls,e.isCommitting),Qe()(u,r.endsOutsideViewCls,i.endsOutsideView),Qe()(u,r.startsOutsideViewCls,i.startsOutsideView),Qe()(u,"b-clipped-start",i.clippedStart),Qe()(u,"b-clipped-end",i.clippedEnd),u)),h["".concat(r.eventCls,"-parent")]=t.isParent,i.wrapperStyle="",o){var p,g,y=s&&r.isAssignmentSelected(s);Qn.assign(d,(p={},Qe()(p,r.eventCls,1),Qe()(p,"b-milestone",a),Qe()(p,"b-sch-event-narrow",i.width<10),Qe()(p,r.fixedEventCls,!1===e.isDraggable),Qe()(p,"b-sch-event-resizable-".concat(f),Boolean(r.features.eventResize)),Qe()(p,r.eventSelectedCls,y),Qe()(p,r.eventAssignHighlightCls,r.isEventSelected(e)&&!y),Qe()(p,"b-recurring",e.isRecurring),Qe()(p,"b-occurrence",e.isOccurrence),p)),i.eventId=e.id;var m=e.eventStyle||t.eventStyle||r.eventStyle,b=e.eventColor||t.eventColor||r.eventColor,k=r.isFirstRender&&r.useInitialAnimation;if(Qn.assign(h,(g={},Qe()(g,"".concat(r.eventCls,"-wrap"),1),Qe()(g,"b-milestone-wrap",a),g)),k){var w=i.row?i.row.index:i.top/r.tickSize;i.wrapperStyle="animation-delay: ".concat(w/20,"s;"),r.initialAnimationDetacher||(r.initialAnimationDetacher=Tu.on({element:r.foregroundCanvas,delegate:r.eventSelector,animationend:"stopInitialAnimation",expires:{alt:"stopInitialAnimation",delay:r.initialAnimationDuration},thisObj:r}))}i.eventColor=b,i.eventStyle=m,i.assignmentRecord=i.assignment=s}if(i.wrapperCls=h,i.cls=d,i.iconCls=new xr(e.get(r.eventBarIconClsField)||e.iconCls),e.isResourceTimeRange?(i.style="",i.wrapperStyle+=e.style||""):i.style=e.style||"",i.resource=i.resourceRecord=t,i.resourceId=i.rowId,o){var C,R=null,S=null;if(r.eventRenderer){var x=r.eventRenderer.call(r.eventRendererThisObj||r,{eventRecord:e,resourceRecord:t,assignmentRecord:i.assignmentRecord,tplData:i,renderData:i});"string"==typeof i.cls&&(i.cls=new xr(i.cls)),"string"==typeof i.wrapperCls&&(i.wrapperCls=new xr(i.wrapperCls)),"string"==typeof i.iconCls&&(i.iconCls=new xr(i.iconCls)),C=r.eventBodyTemplate?r.eventBodyTemplate(x):x}else r.eventBodyTemplate?C=r.eventBodyTemplate(e):r.eventBarTextField&&(C=te.encodeHtml(e[r.eventBarTextField]||""));if(!r.eventBodyTemplate||Array.isArray(C)){var E,D;if(l.children=[],a&&"default"===r.milestoneLayoutMode&&null!=C&&""!==C&&l.children.unshift(S={tag:"label",children:[]}),null!==(E=i.iconCls)&&void 0!==E&&E.length&&l.children.unshift({tag:"i",className:i.iconCls}),Array.isArray(C))(D=(S||l).children).push.apply(D,F()(C));else te.isHtml(C)?l.children.length?R={tag:"span",html:C}:(l.children=null,l.html=C):"string"==typeof C||"object"===I()(C)?R=C:null!=C&&(R=String(C));null!=R&&((S||l).children.push(R),i.cls.add("b-has-content")),(null!=l.html||l.children.length)&&i.children.push(l)}else l.html=C,i.children.push(l);var T=i.eventStyle,O=i.eventColor;if(i.wrapperCls["b-sch-style-".concat(T)]=T,mi.isNamedColor(O))i.wrapperCls["b-sch-color-".concat(O)]=O;else if(O){var M=T?"color":"background-color";i.style="".concat(M,":").concat(O,";")+i.style,i.wrapperCls["b-sch-custom-color"]=1}i.style&&a&&l&&(l.style=i.style,delete i.style)}i.cls["b-sch-event-withicon"]=null===(c=i.iconCls)||void 0===c?void 0:c.length,i.eventContent=l,i.wrapperChildren=[],r.onEventDataGenerated(i)}return i}},{key:"onEventDataGenerated",value:function(e){}},{key:"restartInitialAnimation",value:function(e){var t,n=this;null===(t=n.initialAnimationDetacher)||void 0===t||t.call(n),n.initialAnimationDetacher=null,n.useInitialAnimation=e,n.isFirstRender=!0,n.refresh()}},{key:"stopInitialAnimation",value:function(){var e=this;e.initialAnimationDetacher(),e.isFirstRender=!1,e.useInitialAnimation=!1,pe.a.isFirefox&&e.setTimeout((function(){return e.element.classList.remove("b-prevent-event-transitions")}),100)}},{key:"getMilestoneLabelWidth",value:function(e){var t=this,n=t.milestoneLayoutMode;if("measure"===n){var r=t.milestoneMeasureElement||(t.milestoneMeasureElement=mi.createElement({className:"b-sch-event-wrap b-milestone-wrap b-measure",children:[{className:"b-sch-event b-milestone",children:[{className:"b-sch-event-content"}]}],parent:t.foregroundCanvas}));return r.retainElement=!0,r.firstElementChild.firstElementChild.innerHTML=e.name,r.offsetWidth}return"estimate"===n?Math.max(e.name.length*t.milestoneCharWidth,t.milestoneMinWidth):"data"===n?Math.max(e.milestoneWidth,t.milestoneMinWidth):0}},{key:"milestoneLayoutMode",get:function(){return this._milestoneLayoutMode},set:function(e){this._milestoneLayoutMode=e,this.element.classList["default"!==e?"add":"remove"]("b-sch-layout-milestones"),this.isConfiguring||this.refreshWithTransition()}},{key:"updateMilestoneTextPosition",value:function(e){this.element.classList.toggle("b-sch-layout-milestone-text-position-inside","inside"===e)}},{key:"milestoneAlign",get:function(){return this._milestoneAlign},set:function(e){this._milestoneAlign=e,this.isConfiguring||this.refreshWithTransition()}},{key:"milestoneCharWidth",get:function(){return this._milestoneCharWidth},set:function(e){this._milestoneCharWidth=e,this.isConfiguring||this.refreshWithTransition()}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerEventRendering"}},{key:"configurable",get:function(){return{milestoneTextPosition:"outside",eventLayout:"stack"}}},{key:"defaultConfig",get:function(){return{eventRenderer:null,milestoneAlign:"center",milestoneCharWidth:10,milestoneLayoutMode:"default",milestoneMinWidth:40,eventRendererThisObj:null,horizontalLayoutPackClass:IT,horizontalLayoutStackClass:TT,horizontalEventSorterFn:null,eventBarTextField:"name",eventBodyTemplate:null,eventPositionMode:"translate",eventScrollMode:"move",fillTicks:!1,useInitialAnimation:!0,resourceColumns:null,resourceImagePath:null,defaultResourceImageName:null,resourceImageExtension:".jpg",resourceMargin:null,isFirstRender:!0,initialAnimationDuration:2e3}}}]),n}(e||$e)};function LT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var BT=function(e){return function(e){Ye()(n,e);var t=LT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"updateProject",value:function(e,t){tt()(Ze()(n.prototype),"updateProject",this).call(this,e,t),this.detachListeners("schedulerStores"),e.on({name:"schedulerStores",refresh:"onProjectRefresh",thisObj:this})}},{key:"onProjectRefresh",value:function(e){var t=this;e.isInitialCommit&&t.isVertical&&(t.refreshAfterProjectRefresh=!1,t.refreshWithTransition()),t.navigateToAfterRefresh&&(t.navigateTo(t.navigateToAfterRefresh),t.navigateToAfterRefresh=null),t.refreshAfterProjectRefresh&&(t.refreshWithTransition(),t.refreshAfterProjectRefresh=!1)}},{key:"changeCrudManager",value:function(e){var t=this;e&&!e.isCrudManager&&(e=t.crudManagerClass.new({scheduler:t},e)),t._crudManager=e,t.bindCrudManager(e)}},{key:"store",get:function(){return!this._store&&this.isVertical&&(this._store=new ts({data:[{id:"verticalTimeAxisRow",cls:"b-verticaltimeaxis-row"}]})),tt()(Ze()(n.prototype),"store",this)},set:function(e){gh()(Ze()(n.prototype),"store",e,this,!0)}},{key:"refreshFromRowOnStoreAdd",value:function(e,t){var r=this,i=t.isExpand,o=arguments;this.runWithTransition((function(){var t;r.currentOrientation.suspended=!i,(t=tt()(Ze()(n.prototype),"refreshFromRowOnStoreAdd",r)).call.apply(t,[r,e].concat(F()(o))),r.currentOrientation.suspended=!1}),!i)}},{key:"onStoreAdd",value:function(e){tt()(Ze()(n.prototype),"onStoreAdd",this).call(this,e),this.calculateRowHeights(e.records)}},{key:"onStoreUpdateRecord",value:function(e){e.source,e.record;var t=e.changes,r=0;"assigned"in t&&r++,"calendar"in t&&r++,r!==Object.keys(t).length&&tt()(Ze()(n.prototype),"onStoreUpdateRecord",this).apply(this,arguments)}},{key:"updateResourceStore",value:function(e){e&&this.isHorizontal&&(e.metaMapId=this.id,this.store=e)}},{key:"onEventIdChange",value:function(e){this.currentOrientation.onEventStoreIdChange&&this.currentOrientation.onEventStoreIdChange(e)}},{key:"onEventStoreBatchedUpdate",value:function(e){if(this.listenToBatchedUpdates)return this.onInternalEventStoreChange(e)}},{key:"onInternalEventStoreChange",value:function(e){!this._mode||e.isAssign||this.assignmentStore.isRemovingAssignment||this.currentOrientation.onEventStoreChange(e)}},{key:"onEventCommit",value:function(e){var t=this,n=e.changes,r=[].concat(F()(n.added),F()(n.modified)).map((function(e){return t.eventStore.getResourcesForEvent(e)}));r=Array.prototype.concat.apply([],r),new Set(r).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"onEventCommitStart",value:function(e){var t=e.changes,n=this.currentOrientation,r=this.committingCls;[].concat(F()(t.added),F()(t.modified)).forEach((function(e){return e.assignments.forEach((function(e){return n.toggleCls(e,r,!0)}))}))}},{key:"onEventException",value:function(e){var t=this;if("commit"===e.action){var n=this.eventStore.changes;[].concat(F()(n.added),F()(n.modified),F()(n.removed)).forEach((function(e){return t.repaintEvent(e)}))}}},{key:"onAssignmentCommit",value:function(e){var t=e.changes;this.repaintEventsForAssignmentChanges(t)}},{key:"onAssignmentCommitStart",value:function(e){var t=e.changes,n=this.currentOrientation,r=this.committingCls;[].concat(F()(t.added),F()(t.modified)).forEach((function(e){n.toggleCls(e,r,!0)}))}},{key:"onAssignmentException",value:function(e){"commit"===e.action&&this.repaintEventsForAssignmentChanges(this.assignmentStore.changes)}},{key:"repaintEventsForAssignmentChanges",value:function(e){var t=this,n=[].concat(F()(e.added),F()(e.modified),F()(e.removed)).map((function(e){return e.getResource()}));new Set(n).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"onEventClearChanges",value:function(){this.refresh()}},{key:"onAssignmentBeforeRemove",value:function(e){e.source;var t=e.records;if(!e.removingAll){var n,r=this;if(!r.isConfiguring&&r.activeAssignment&&t.includes(r.activeAssignment)){if("key"===Fi.lastInteractionType)for(var i=0,o=t.length;i<o&&(!n||t.includes(n));i++){var a=t[i];a.resource&&a.resource.isModel&&(n=r.getNext(a)||r.getPrevious(a))}n?(r.navigateTo(n),r.navigateToAfterRefresh=n):mi.focusWithoutScrolling(r.focusElement)}}}},{key:"applyStartEndParameters",value:function(e){var t=e.source,n=e.params,r=this,i=t.modelClass.fieldMap.startDate;r.passStartEndParameters&&(n[r.startParamName]=i.print(r.startDate),n[r.endParamName]=i.print(r.endDate))}},{key:"getResourcesEventsPerTick",value:function(e,t){var n=this,r=this.timeAxis,i=this.resourceStore,o=[];return(e=e||i.records).forEach((function(e){e.events.forEach((function(i){if(r.isTimeSpanInAxis(i)&&(!t||t.call(n,{resource:e,event:i}))){var a=Math.floor(r.getTickFromDate(i.startDate)),s=Math.ceil(r.getTickFromDate(i.endDate));do{o[a]?o[a].push(i):o[a]=[i],a=r.getNext(a).id}while(a<s)}}))})),o}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerStores"}},{key:"projectStores",get:function(){return{resourceStore:{dataName:"resources"},eventStore:{dataName:"events",listeners:{batchedUpdate:"onEventStoreBatchedUpdate",changePreCommit:"onInternalEventStoreChange",clearChanges:"onEventClearChanges",commitStart:"onEventCommitStart",commit:"onEventCommit",exception:"onEventException",idchange:"onEventIdChange",beforeLoad:"applyStartEndParameters"}},assignmentStore:{dataName:"assignments",listeners:{changePreCommit:"onAssignmentChange",commitStart:"onAssignmentCommitStart",commit:"onAssignmentCommit",exception:"onAssignmentException",beforeRemove:{fn:"onAssignmentBeforeRemove",prio:-1e3}}},dependencyStore:{dataName:"dependencies"},calendarManagerStore:{},timeRangeStore:{},resourceTimeRangeStore:{}}}},{key:"configurable",get:function(){return{timeRanges:null,resourceTimeRanges:null,store:null,startParamName:"startDate",endParamName:"endDate",passStartEndParameters:!1,removeUnassignedEvent:!0,crudManagerClass:null,crudManager:null}}}]),n}(jx(e||$e))};function jT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var _T=Promise.resolve(),HT={block:"nearest",edgeOffset:20},NT={highlight:!1,focus:!1},zT=function(e){return function(e){Ye()(n,e);var t=jT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"scrollEventIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HT,n=this,r=e.resources||[e];if(r.length>1)throw new Error("scrollEventIntoView() is not applicable for events with multiple assignments, please use scrollResourceEventIntoView() instead.");return r.length?n.scrollResourceEventIntoView(r[0],e,null,t):(console.warn("You have asked to scroll to an event which is not assigned to a resource"),_T)}},{key:"scrollAssignmentIntoView",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.scrollResourceEventIntoView.apply(this,[e.resource,e.event].concat(n))}},{key:"scrollResourceEventIntoView",value:function(e,t,n){var r,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:HT,a=this,s=t.startDate,l=t.endDate,u=t.isScheduled&&s<a.timeAxis.startDate|(l>a.timeAxis.endDate)<<1;if(null==o.edgeOffset&&(o.edgeOffset=20),u&&!1!==o.extendTimeAxis){var c=a.timeAxis.endDate-a.timeAxis.startDate;3===u?a.setTimeSpan(new Date(s.valueOf()-c/2),new Date(l.getTime()+c/2)):1&u?a.setTimeSpan(new Date(s),new Date(s.valueOf()+c)):a.setTimeSpan(new Date(l.valueOf()-c),new Date(l))}if(null===(r=a.expandTo)||void 0===r||r.call(a,e),i=a.getElementFromEventRecord(t,e)){mi.isFocusable(i)||(i=i.parentNode);var f=a.timeAxisSubGrid.scrollable;return a.timeAxisSubGrid.forceScrollUpdate=!0,f.scrollIntoView(i,o)}return u&&!1===o.extendTimeAxis?(console.warn("You have asked to scroll to an event which is outside the current view and extending timeaxis is disabled"),_T):t.isOccurrence||a.eventStore.isAvailable(t)?t.isScheduled?a.scrollUnrenderedEventIntoView(e,t,o):a.scrollResourceIntoView(e,o):(console.warn("You have asked to scroll to an event which is not available"),_T)}},{key:"scrollUnrenderedEventIntoView",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:HT;return new Promise((function(i){var o=n,a=Object.assign({edgeOffset:20},r,NT),s=o.timeAxisSubGrid.scrollable,l=o.getResourceEventBox(t,e),u=s.viewport;if(u){l.x=Math.ceil(l.x),l.y=Math.ceil(l.y);var c=l.translate(u.x-s.x,u.y-s.y),f=s.getDeltaTo(c,a)[o.isHorizontal?"xDelta":"yDelta"],d=function(){var e=Pt()(At.a.mark((function e(n){var o,a,l,u;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.eventRecord,a=n.element,l=n.targetElement,o!==t){e.next=12;break}return u=a||l,h(),e.next=6,v;case 6:if(!(f>0)){e.next=9;break}return e.next=9,s.scrollIntoView(u,{edgeOffset:r.edgeOffset});case 9:r.highlight&&mi.highlight(u),r.focus&&u.focus(),i();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=o.on({renderEvent:d}),v=s.scrollIntoView(c,a)}else i()}))}},{key:"scrollResourceIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HT;return this.isVertical?this.currentOrientation.scrollResourceIntoView(e,t):this.scrollRowIntoView(e,t)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerScroll"}}]),n}(e||$e)};function VT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var WT=function(e){return function(e){Ye()(n,e);var t=VT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getScheduleRegion",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.currentOrientation.getScheduleRegion(e,t,n)}},{key:"getResourceRegion",value:function(e,t,n){return this.currentOrientation.getRowRegion(e,t,n)}},{key:"getAssignmentEventBox",value:function(e,t){return this.getResourceEventBox(e.event,e.resource,t)}},{key:"getResourceEventBox",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.currentOrientation.getResourceEventBox(e,t,n,r)}},{key:"getItemBox",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.resources.map((function(r){return t.getResourceEventBox(e,r,n)}))}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerRegions"}}]),n}(e||$e)};function $T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var UT=["eventLayout","barMargin","mode","eventColor","eventStyle","tickSize","fillTicks"],GT=function(e){return function(e){Ye()(n,e);var t=$T(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getState",value:function(){var e=this,t=Qn.copyProperties(tt()(Ze()(n.prototype),"getState",this).call(this),e,UT);return t.zoomLevel=e.zoomLevel,t.zoomLevelOptions={startDate:e.startDate,endDate:e.endDate,viewportCenterDate:e.viewportCenterDate,width:e.tickSize},t}},{key:"applyState",value:function(e){this.suspendRefresh(),e.zoomLevel&&this.zoomToLevel(e.zoomLevel,e.zoomLevelOptions),Qn.copyProperties(this,e,UT),tt()(Ze()(n.prototype),"applyState",this).call(this,e),this.resumeRefresh(!0)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerState"}}]),n}(e||$e)};function YT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var qT=function(e){return function(e){Ye()(n,e);var t=YT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"afterConstruct",value:function(){tt()(Ze()(n.prototype),"afterConstruct",this).call(this),this.navigator.on({navigate:"onEventNavigate",thisObj:this})}},{key:"selectedCollection",get:function(){return this._selectedCollection},set:function(e){e instanceof na||(e=new na(e)),this._selectedCollection=e,e.on({change:"onSelectedCollectionChange",thisObj:this})}},{key:"getEventsFromAssignments",value:function(e){return it.unique(e.map((function(e){return e.event})))}},{key:"selectedEvents",get:function(){return this.getEventsFromAssignments(this.selectedCollection.values)},set:function(e){var t=[];e&&!Array.isArray(e)&&(e=[e]),e&&e.forEach((function(e){t.push.apply(t,F()(e.assignments))})),this.selectedCollection.splice(0,this.selectedCollection.count,t)}},{key:"selectedAssignments",get:function(){return this.selectedCollection.values},set:function(e){this.selectedCollection.splice(0,this.selectedCollection.count,e||[])}},{key:"isEventSelected",value:function(e){return this.selectedEvents.includes(e)}},{key:"isAssignmentSelected",value:function(e){return this.selectedCollection.includes(e)}},{key:"select",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.isAssignment?this.selectAssignment(e,t):this.selectEvent(e,t)}},{key:"selectEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isEventSelected(e)||(t?this.selectedCollection.add(e.assignments):this.selectedEvents=e)}},{key:"selectAssignment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isAssignmentSelected(e)||(t?this.selectedCollection.add(e):this.selectedAssignments=e)}},{key:"deselect",value:function(e){e.isAssignment?this.deselectAssignment(e):this.deselectEvent(e)}},{key:"deselectEvent",value:function(e){var t;this.isEventSelected(e)&&(t=this.selectedCollection).remove.apply(t,F()(e.assignments))}},{key:"deselectAssignment",value:function(e){this.isAssignmentSelected(e)&&this.selectedCollection.remove(e)}},{key:"selectEvents",value:function(e){this.selectedCollection.add(e.reduce((function(e,t){return e.push.apply(e,F()(t.assignments)),e}),[]))}},{key:"deselectEvents",value:function(e){this.selectedCollection.remove(e.reduce((function(e,t){return e.push.apply(e,F()(t.assignments)),e}),[]))}},{key:"selectAssignments",value:function(e){this.selectedCollection.add(e)}},{key:"deselectAssignments",value:function(e){this.selectedCollection.remove(e)}},{key:"clearEventSelection",value:function(){this.selectedAssignments=[]}},{key:"onSelectedCollectionChange",value:function(e){var t=e.added,n=e.removed,r=this,i=r.selectedAssignments,o=t||[],a=n||[];function s(e,t){var n=e.event;if(n){var i=r.getElementFromAssignmentRecord(e);r.currentOrientation.toggleCls(e,r.eventSelectedCls,t),r.getElementsFromEventRecord(n).forEach((function(e){if(e!==i){var n=r.resolveAssignmentRecord(e);r.currentOrientation.toggleCls(n,r.eventAssignHighlightCls,t),t&&(e.style.animation="none",e.offsetHeight,e.style.animation=""),e.classList[t?"add":"remove"](r.eventAssignHighlightCls)}}))}}if(a.forEach((function(e){return s(e,!1)})),o.forEach((function(e){return s(e,!0)})),(r.highlightSuccessors||r.highlightPredecessors)&&r.highlightLinkedEvents(r.selectedEvents),r.$selectedAssignments=i.map((function(e){return{eventId:e.eventId,resourceId:e.resourceId}})),!r.silent){var l=i.length>0?o.length>0&&a.length>0?"update":o.length>0?"select":"deselect":"clear";r.trigger("assignmentSelectionChange",{action:l,selection:i,selected:o,deselected:a}),r.trigger("eventSelectionChange",{action:l,selection:r.selectedEvents,selected:r.getEventsFromAssignments(o),deselected:r.getEventsFromAssignments(a)})}}},{key:"onAssignmentChange",value:function(e){var t=e.action,n=e.records,r=this;if(r.silent=!r.triggerSelectionChangeOnRemove,"remove"===t)r.deselectAssignments(n);else if("removeall"!==t||r.eventStore.isSettingData){if("dataset"===t&&r.$selectedAssignments)if(r.maintainSelectionOnDatasetChange){var i=r.$selectedAssignments.map((function(e){return n.find((function(t){return t.eventId===e.eventId&&t.resourceId===e.resourceId}))}));r.selectedAssignments=it.clean(i)}else r.clearEventSelection()}else r.clearEventSelection();r.silent=!1}},{key:"onInternalEventStoreChange",value:function(e){var t=e.action,r=e.records;"dataset"!==t||r.length||this.clearEventSelection(),tt()(Ze()(n.prototype),"onInternalEventStoreChange",this).apply(this,arguments)}},{key:"onAssignmentSelectionClick",value:function(e,t){var n=this;n.isAssignmentSelected(t)?e.ctrlKey&&n.deselectAssignment(t,n.multiEventSelect):n.selectAssignment(t,e.ctrlKey&&n.multiEventSelect)}},{key:"onEventNavigate",value:function(e){var t=e.event,n=e.item;if(!this.eventSelectionDisabled){var r=n&&(n.nodeType===Element.ELEMENT_NODE?this.resolveAssignmentRecord(n):n);r?(this.clearFocus(!0),this.onAssignmentSelectionClick(t,r)):this.clearEventSelection()}}},{key:"changeHighlightSuccessors",value:function(e){return this.changeLinkedEvents(e)}},{key:"changeHighlightPredecessors",value:function(e){return this.changeLinkedEvents(e)}},{key:"changeLinkedEvents",value:function(e){var t=this;return e?(t.highlighted=t.highlighted||new Set,t.highlightLinkedEvents(t.selectedEvents)):t.highlighted&&t.highlightLinkedEvents(),e}},{key:"highlightLinkedEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this,n=t.highlighted,r=t.features.dependencies;n.forEach((function(i){e.includes(i)||(i.$highlight=!1,n.delete(i),t.eventStore.includes(i)&&i.dependencies.forEach((function(e){return r.unhighlight(e,"b-highlight")})))})),t.eventStore.beginBatch(),e.forEach((function(e){for(var i=[e];i.length;){var o=i.pop();n.add(o),t.highlightSuccessors&&o.outgoingDeps.forEach((function(e){r.highlight(e,"b-highlight"),!n.has(e.toEvent)&&i.push(e.toEvent)})),t.highlightPredecessors&&o.incomingDeps.forEach((function(e){r.highlight(e,"b-highlight"),!n.has(e.fromEvent)&&i.push(e.fromEvent)}))}n.forEach((function(e){return e.$highlight=!0}))})),t.eventStore.endBatch(),e.length>0?t.element.classList.add("b-highlighting"):t.element.classList.remove("b-highlighting")}},{key:"onEventDataGenerated",value:function(e){(this.highlightSuccessors||this.highlightPredecessors)&&(e.cls["b-highlight"]=e.eventRecord.$highlight),tt()(Ze()(n.prototype),"onEventDataGenerated",this).call(this,e)}},{key:"updateProject",value:function(e,t){this.clearEventSelection(),tt()(Ze()(n.prototype),"updateProject",this).call(this,e,t)}},{key:"doDestroy",value:function(){var e;null===(e=this._selectedCollection)||void 0===e||e.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"EventSelection"}},{key:"configurable",get:function(){return{highlightPredecessors:!1,highlightSuccessors:!1}}},{key:"defaultConfig",get:function(){return{multiEventSelect:!1,eventSelectionDisabled:!1,eventSelectedCls:"b-sch-event-selected",triggerSelectionChangeOnRemove:!1,maintainSelectionOnDatasetChange:!0,eventAssignHighlightCls:"b-sch-event-assign-selected",selectedCollection:{}}}}]),n}(e||$e)};function KT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var XT=function(e){return e.preventDefault()},ZT=function(e){return function(e){Ye()(r,e);var t,n=KT(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"construct",value:function(e){var t=this;t.isInTimeAxis=t.isInTimeAxis.bind(t),t.onDeleteKey=t.throttle(t.onDeleteKey,t.onDeleteKeyBuffer,t),tt()(Ze()(r.prototype),"construct",this).call(this,e)}},{key:"changeNavigator",value:function(e){var t=this;return t.getConfig("subGridConfigs"),new fv(t.constructor.mergeConfigs({ownerCmp:t,target:t.timeAxisSubGridElement,processEvent:t.processEvent,itemSelector:".".concat(t.eventCls,"-wrap"),focusCls:t.focusCls,navigatePrevious:t.throttle(t.navigatePrevious,{delay:t.navigatePreviousBuffer,throttled:XT}),navigateNext:t.throttle(t.navigateNext,{delay:t.navigateNextBuffer,throttled:XT})},e))}},{key:"doDestroy",value:function(){this.navigator.destroy(),tt()(Ze()(r.prototype),"doDestroy",this).call(this)}},{key:"isInTimeAxis",value:function(e){return!e.instanceMeta(this).excluded&&this.timeAxis.isTimeSpanInAxis(e)}},{key:"accessibleFocusCell",value:function(e,t){if((e=this.normalizeCellContext(e)).columnId!==this.timeAxisColumn.id)return tt()(Ze()(r.prototype),"focusCell",this).call(this,e,t)}},{key:"normalizeTarget",value:function(e){return e.assignmentRecord}},{key:"getPrevious",value:function(e,t){var n=this,r=n.resourceStore,i=n.currentOrientation.eventSorter,o=n.timeAxis,a=o.startDate,s=o.endDate,l=e.event,u=n.eventStore.getEvents({resourceRecord:e.resource,startDate:a,endDate:s}).filter(this.isInTimeAxis).sort(i),c=e.resource,f=u[u.indexOf(l)-1];if(!f)for(var d=r.indexOf(c)-1;(!f||t&&f===l)&&d>=0;d--){c=r.getAt(d);var h=n.eventStore.getEvents({resourceRecord:c,startDate:a,endDate:s}).filter(n.isInTimeAxis).sort(i);f=h.length&&h[h.length-1]}return n.assignmentStore.getAssignmentForEventAndResource(f,c)}},{key:"navigatePrevious",value:function(e){var t=this,n=t.getPrevious(t.normalizeTarget(e));if(e.preventDefault(),n)return e.ctrlKey||t.clearEventSelection(),t.navigateTo(n,e)}},{key:"getNext",value:function(e,t){var n=this,r=n.resourceStore,i=n.currentOrientation.eventSorter,o=n.timeAxis,a=o.startDate,s=o.endDate,l=e.event,u=n.eventStore.getEvents({resourceRecord:e.resource,startDate:a,endDate:s}).filter(this.isInTimeAxis).sort(i),c=e.resource,f=u[u.indexOf(l)+1];if(!f)for(var d=r.indexOf(c)+1;(!f||t&&f===l)&&d<r.count;d++){c=r.getAt(d),f=n.eventStore.getEvents({resourceRecord:c,startDate:a,endDate:s}).filter(n.isInTimeAxis).sort(i)[0]}return n.assignmentStore.getAssignmentForEventAndResource(f,c)}},{key:"navigateNext",value:function(e){var t=this,n=t.getNext(t.normalizeTarget(e));if(e.preventDefault(),n)return e.ctrlKey||t.clearEventSelection(),t.navigateTo(n,e)}},{key:"navigateTo",value:(t=Pt()(At.a.mark((function e(t){var n,r,i=arguments;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},r=this,!t){e.next=7;break}return r.navigator.disabled=!0,e.next=6,r.scrollAssignmentIntoView(t,null,{animate:100});case 6:r.isDestroyed||(r.navigator.disabled=!1,r.activeAssignment=t,r.navigator.trigger("navigate",{event:n,item:mi.up(r.getElementFromAssignmentRecord(t),r.navigator.itemSelector)}));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"activeAssignment",get:function(){var e=this.navigator.activeItem;if(e)return this.resolveAssignmentRecord(e)},set:function(e){var t=this.getElementFromAssignmentRecord(e);this.navigator.activeItem=t.parentNode}},{key:"previousActiveEvent",get:function(){var e=this.navigator.previousActiveItem;if(e)return this.resolveEventRecord(e)}},{key:"processEvent",value:function(e){var t=this,n=mi.up(e.target,t.eventSelector);return!t.navigator.disabled&&n&&(e.assignmentRecord=t.resolveAssignmentRecord(n),e.eventRecord=t.resolveEventRecord(n),e.resourceRecord=t.resolveResourceRecord(n)),e}},{key:"onDeleteKey",value:function(e){var t=this;if(!t.readOnly&&t.enableDeleteKey){var n=t.eventStore.usesSingleAssignment?t.selectedEvents:t.selectedAssignments;t.removeEvents(n)}}},{key:"removeEvents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;if(!n.readOnly&&e.length){var r={finalize:function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t&&t(r),!1!==r)if(e.some((function(e){var t;return e.isOccurrence||(null===(t=e.event)||void 0===t?void 0:t.isOccurrence)})))e.forEach((function(e){return e.isOccurrenceAssignment?e.event.remove():e.remove()}));else{var i=e[0].isAssignment?n.assignmentStore:n.eventStore;i.remove(e)}}};if(!1!==(e[0].isAssignment?n.trigger("beforeAssignmentDelete",{assignmentRecords:e,context:r}):n.trigger("beforeEventDelete",{eventRecords:e,context:r})))return r.finalize(),!0}return!1}},{key:"onEventSpaceKey",value:function(e){}},{key:"onEventEnterKey",value:function(e){}},{key:"isActionableLocation",get:function(){if(!this.navigator.activeItem)return tt()(Ze()(r.prototype),"isActionableLocation",this)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"EventNavigation"}},{key:"configurable",get:function(){return{navigator:{allowCtrlKey:!0,scrollSilently:!0,keys:{Space:"onEventSpaceKey",Enter:"onEventEnterKey",Delete:"onDeleteKey",Backspace:"onDeleteKey"}}}}},{key:"defaultConfig",get:function(){return{focusCls:"b-active",enableDeleteKey:!0,onDeleteKeyBuffer:500,navigatePreviousBuffer:200,navigateNextBuffer:200,testConfig:{onDeleteKeyBuffer:1}}}}]),r}(el(e||$e))};function JT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var QT=function(e){return function(e){Ye()(n,e);var t=JT(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"getElementFromAssignmentRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.scheduler.isPainted&&e){var n,r,i=null===(n=this.scheduler.foregroundCanvas.syncIdMap)||void 0===n?void 0:n[e.id];return t?i:null==i||null===(r=i.syncIdMap)||void 0===r?void 0:r.event}return null}},{key:"getElementFromEventRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.resource,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.assignmentStore.getAssignmentForEventAndResource(e,t);return this.getElementFromAssignmentRecord(r,n)}},{key:"getElementsFromEventRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return t?[r.getElementFromEventRecord(e,t,n)]:e.resources.reduce((function(t,i){var o=r.getElementFromEventRecord(e,i,n);return o&&t.push(o),t}),[])}}]),n}(e||$e)};function eO(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return tO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tO(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function tO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nO(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function iO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var oO={releaseElement:1,reuseElement:1},aO={newElement:1,reuseOwnElement:1,reuseElement:1},sO=9999999,lO=function(e,t){return e.startDateMS-t.startDateMS},uO={startDate:1,endDate:1,duration:1};function cO(e,t,n,r,i){if(e.fillTicks){var o=t.getTickFromDate(n);if(o>=0){i&&o===Math.round(o)&&o>0&&o--;var a=Math.floor(o);return t.getAt(a)[i?"endDate":"startDate"].getTime()}}return r}var fO=function(e){Ye()(n,e);var t=iO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;t.client=t.scheduler=e,t.eventSorter=t.eventSorter.bind(e),e.rowManager.on({name:"rowManager",renderDone:"onRenderDone",removeRows:"onRemoveRows",translateRow:"onTranslateRow",beforeRowHeight:"onBeforeRowHeightChange",thisObj:t}),t.toDrawOnProjectRefresh=new Set,t.toDrawOnDataReady=new Set,tt()(Ze()(n.prototype),"construct",this).call(this,{})}},{key:"init",value:function(){}},{key:"updateVerticalBufferSize",value:function(){var e=this.scheduler.rowManager;this.scheduler.isPainted&&e.renderRows(e.rows)}},{key:"visibleDateRange",get:function(){return this._visibleDateRange}},{key:"getDateFromXY",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[0];return n||(i=this.translateToScheduleCoordinate(i)),this.scheduler.timeAxisViewModel.getDateFromPosition(i,t,r)}},{key:"translateToScheduleCoordinate",value:function(e){return e-this.scheduler.timeAxisSubGridElement.getBoundingClientRect().left+this.scheduler.scrollLeft}},{key:"translateToPageCoordinate",value:function(e){var t=this.scheduler.timeAxisSubGridElement;return e+t.getBoundingClientRect().left-t.scrollLeft}},{key:"getScheduleRegion",value:function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this,o=i.scheduler,a=o.timeAxisSubGridElement,s=o.timeAxis,l=o.getResourceMargin(e);if(e){var u=t&&i.getElementsFromEventRecord(t,e)[0];if(n=Cr.from(o.getRowById(e.id).getElement("locked")),u){var c=Cr.from(u,a);n.y=c.y,n.bottom=c.bottom}else n.y=n.y+l,n.bottom=n.bottom-l}else(n=Cr.from(a).moveTo(null,0)).width=a.scrollWidth,n.y=n.y+l,n.bottom=n.bottom-l;var f=s.startDate,d=s.endDate,h=o.getDateConstraints(e,t)||{start:f,end:d},v=o.getCoordinateFromDate(Un.max(f,h.start)),p=o.getCoordinateFromDate(Un.min(d,h.end));return r||(v=i.translateToPageCoordinate(v),p=i.translateToPageCoordinate(p)),n.left=Math.min(v,p),n.right=Math.max(v,p),n}},{key:"getRowRegion",value:function(e,t,n){var r=this.scheduler,i=r.timeAxis,o=r.getRowById(e.id);if(!o)return null;var a=i.startDate,s=i.endDate,l=t?Un.max(a,t):a,u=n?Un.min(s,n):s,c=r.getCoordinateFromDate(l),f=r.getCoordinateFromDate(u,!0,!0),d=o.top,h=Math.min(c,f),v=d+o.offsetHeight;return new Cr(h,d,Math.max(c,f)-h,v-d)}},{key:"getResourceEventBox",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.resourceMap.get(t.id),o=null,a=!1;if(i&&(o=i.eventsData.find((function(t){return t.eventRecord===e}))),o||(o=this.getTimeSpanRenderData(e,t,{viewport:!0,timeAxis:n}),a=!0),o){var s=this.scheduler.getRecordCoords(t,!0,r),l=o.top+s.top,u=new Cr(o.left,l,o.width,o.height);return a&&(u.layout=!1),u.rowTop=s.top,u.rowBottom=s.bottom,u}return null}},{key:"resolveRowRecord",value:function(e){var t=this.scheduler,n=e.nodeType?e:e.target,r=n.nodeType===Element.TEXT_NODE?n.parentElement:n,i=mi.up(r,t.eventSelector);return i?this.resourceStore.getById(i.dataset.resourceId):t.getRecordFromElement(r)}},{key:"attachToProject",value:function(e){tt()(Ze()(n.prototype),"attachToProject",this).call(this,e),this.refreshAllWhenReady=!0,this.scheduler.isConfiguring||this.clearAll({clearDom:!0}),null==e||e.on({name:"project",refresh:"onProjectRefresh",dataReady:"onProjectDataReady",thisObj:this})}},{key:"onProjectDataReady",value:function(){var e=this.scheduler,t=this.toDrawOnDataReady;e.refreshSuspended||(t.size&&(this.clearResources(t),this.refreshResources(t)),t.clear())}},{key:"onProjectRefresh",value:function(){var e=this,t=e.scheduler,n=e.toDrawOnProjectRefresh;if(!t.refreshSuspended){if(e.refreshAllWhenReady){t.calculateAllRowHeights(!0);var r=t.rowManager;r.topRow?(e.clearAll(),r.topRow.dataIndex>=t.store.count?t.renderRows(!1):t.refreshWithTransition(!1,!e.isFirstRefresh),e.isFirstRefresh=!1):r.reinitialize(),e.refreshAllWhenReady=!1}else n.size&&e.refreshResources(n);n.clear()}}},{key:"attachToAssignmentStore",value:function(e){this.refreshAllWhenReady=!0,tt()(Ze()(n.prototype),"attachToAssignmentStore",this).call(this,e),e&&e.on({name:"assignmentStore",changePreCommit:"onAssignmentStoreChange",refreshPreCommit:"onAssignmentStoreRefresh",thisObj:this})}},{key:"onAssignmentStoreChange",value:function(e){var t=e.action,n=e.records,r=e.replaced,i=e.record,o=e.changes,a=this,s=new Set((n||(i?[i]:[])).map((function(e){return e.resourceId})));if(!a.resourceStore.isRemoving&&!a.resourceStore.isChangingId){switch(t){case"dataset":return void(a.eventStore.usesSingleAssignment||(s.size?a.refreshResourcesWhenReady(s):(a.clearAll(),a.scheduler.refreshWithTransition())));case"add":case"remove":case"updateMultiple":return void a.refreshResourcesWhenReady(s);case"removeall":return void(a.refreshAllWhenReady=!0);case"replace":return r.forEach((function(e){var t=N()(e,2),n=t[0],r=t[1];s.add(n.resourceId),s.add(r.resourceId)})),void a.refreshResourcesWhenReady(s);case"filter":return a.clearAll(),a.scheduler.calculateAllRowHeights(!0),void a.scheduler.refreshWithTransition();case"update":("eventId"in o||"resourceId"in o||"id"in o)&&("resourceId"in o&&s.add(o.resourceId.oldValue),a.refreshResources(s,!0))}}}},{key:"onAssignmentStoreRefresh",value:function(e){e.action,e.records}},{key:"attachToEventStore",value:function(e){this.refreshAllWhenReady=!0,tt()(Ze()(n.prototype),"attachToEventStore",this).call(this,e),e&&e.on({name:"eventStore",refreshPreCommit:"onEventStoreRefresh",thisObj:this})}},{key:"onEventStoreRefresh",value:function(e){"batch"===e.action&&this.scheduler.isEngineReady&&(this.clearAll(),this.scheduler.refreshWithTransition())}},{key:"onEventStoreChange",value:function(e){var t=e.action,n=e.records,r=e.record,i=e.replaced,o=e.changes,a=this,s=n||(r?[r]:[]),l=s[0]&&s[0].isResourceTimeRange,u=new Set;if(s.forEach((function(e){var t;null===(t=e.resources)||void 0===t||t.forEach((function(e){return u.add(e.id)}))})),l)a.refreshResources(u);else{switch(t){case"batch":case"sort":case"group":case"move":case"remove":return;case"clearchanges":case"dataset":return a.clearAll(),void(a.refreshAllWhenReady=!0);case"add":case"updateMultiple":break;case"replace":i.forEach((function(e){N()(e,2)[1].resources.map((function(e){return u.add(e.id)}))}));break;case"removeall":case"filter":return a.scheduler.isEngineReady?(a.clearAll(),a.scheduler.calculateAllRowHeights(!0),void a.scheduler.refreshWithTransition()):void(a.refreshAllWhenReady=!0);case"update":var c,f=r.$entity?!Object.keys(o).some((function(e){return!r.$entity.getField(e)})):!Object.keys(o).some((function(e){return!uO[e]})),d=0;if("startDate"in o&&d++,"endDate"in o&&d++,"duration"in o&&d++,"resourceId"in o&&u.add(o.resourceId.oldValue),!f||d&&(!("duration"in o)||1!==d)||"percentDone"in o)null!==(c=a.project)&&void 0!==c&&c.propagatingLoadChanges?u.forEach((function(e){return a.toDrawOnDataReady.add(e)})):a.refreshResources(u);return}a.refreshResourcesWhenReady(u)}}},{key:"attachToResourceStore",value:function(e){this.refreshAllWhenReady=!0,tt()(Ze()(n.prototype),"attachToResourceStore",this).call(this,e),e&&(this.clearAll({clearLayoutCache:!0}),e.on({name:"resourceStore",changePreCommit:"onResourceStoreChange",thisObj:this}))}},{key:"onResourceStoreChange",value:function(e){var t=e.action,n=e.isExpand,r=e.record,i=e.records,o=e.changes,a=this,s=r?[r.id]:null==i?void 0:i.map((function(e){return e.id}));switch(t){case"add":return void(n||a.refreshResourcesWhenReady(s));case"update":return void(a.project.isBatchingChanges||o.isLeaf||a.refreshResources(s));case"filter":return;case"removeall":return void a.clearAll({clearLayoutCache:!0})}a.clearResources(s)}},{key:"onTranslateRow",value:function(e){var t=e.row;null!=t.id&&this.refreshEventsForResource(t,!1)}},{key:"calculateRowHeight",value:function(e){var t=this.scheduler,n=t.getResourceHeight(e),r=e.eventLayout||t.eventLayout;if("stack"===r&&t.isEngineReady&&!e.isSpecialRow&&e.assigned.size>1){var i=t.assignmentStore,o=t.eventStore,a=t.timeAxis,s=t.getResourceLayoutSettings(e),l=s.barMargin,u=s.resourceMargin,c=n-2*u,f=(o.isFiltered||i.isFiltered)&&function(t){return t.assignments.some((function(t){return t.resource===e&&i.includes(t)}))},d=o.getEvents({resourceRecord:e,includeOccurrences:t.enableRecurringEvents,startDate:a.startDate,endDate:a.endDate,filter:f}).sort(lO).map((function(t){var n=t.isBatchUpdating?t.get("startDate"):t.startDate,r=t.isBatchUpdating?t.get("endDate"):t.endDate||n;return{eventRecord:t,resourceRecord:e,startMS:n.getTime(),endMS:r.getTime()}})),h=t.getEventLayoutHandler(r).layoutEventsInBands(d,!0);return h*c+(h-1)*l+2*u}return n}},{key:"doUpdateTimeView",value:function(){this.updateFromHorizontalScroll(this.scheduler.timeAxisSubGrid.scrollable.x)}},{key:"onTimeAxisViewModelUpdate",value:function(){var e=this;e.clearAll(),e.scheduler.refreshSuspended&&(e.detachListeners("renderingSuspend"),e.scheduler.on({name:"renderingSuspend",resumeRefresh:function(){e.scheduler.isEngineReady&&e.doUpdateTimeView()},thisObj:e,once:!0})),e.doUpdateTimeView()}},{key:"getConnectorStartSide",value:function(e){return"left"}},{key:"getConnectorEndSide",value:function(e){return"right"}},{key:"refreshRows",value:function(e){e&&this.clearAll()}},{key:"onLocaleChange",value:function(){this.clearAll()}},{key:"onViewportResize",value:function(){}},{key:"onDragAbort",value:function(e){var t=e.context,n=e.dragData;this.resourceStore.indexOf(n.record.resource)<this.scheduler.topRow.dataIndex&&t.element.remove()}},{key:"toggleCls",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.getElementFromAssignmentRecord(e,r),o=this.resourceMap.get(e.isModel?e.get("resourceId"):e.resourceId),a=null==o?void 0:o.eventsData.find((function(t){return t.eventId===e.eventId}));a&&(a[r?"wrapperCls":"cls"][t]=n),i&&(i.classList[n?"add":"remove"](t),i.lastDomConfig.className[t]=n)}},{key:"onRemoveRows",value:function(e){var t=this;e.rows.forEach((function(e){return t.rowMap.delete(e)})),this.onRenderDone()}},{key:"updateFromHorizontalScroll",value:function(e){var t=this,n=t.scheduler,r=t.scrollBuffer,i=n.timeAxisSubGrid,o=n.timeAxis,a=i.width,s=i.scrollable.maxX<=Math.round(e)+5,l=n.getDateFromCoordinate(Math.max(0,e-r)),u=s?o.endDate:n.getDateFromCoordinate(e+a+r)||o.endDate;if(l){t._visibleDateRange={startDate:l,endDate:u,startMS:l.getTime(),endMS:u.getTime()},t.viewportCoords={left:e-r,right:e+a+r};var c=n.timeView.range={startDate:l,endDate:u};if(n.onVisibleDateRangeChange(c),n.trigger("visibleRangeChange",c),!n.refreshSuspended&&n.rowManager.rows.length){if(null===n.rowManager.rows[0].id)return;n.rowManager.rows.forEach((function(e){return t.refreshEventsForResource(e,!1)})),t.onRenderDone()}}}},{key:"repaintEventsForResource",value:function(e){this.refreshResources([e.id])}},{key:"onBeforeRowHeightChange",value:function(){this.clearAll()}},{key:"refreshResourcesWhenReady",value:function(e){var t=this;this.clearResources(e),e.forEach((function(e){return t.toDrawOnProjectRefresh.add(e)}))}},{key:"refreshResources",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this,i=r.scheduler,o=[],a=[];r.clearResources(e),i.refreshSuspended||(e.forEach((function(e){var t=i.getRowById(e);t?o.push(t):a.push(t)})),i.runWithTransition((function(){i.calculateRowHeights(a.map((function(e){return t.resourceStore.getById(e)})),!0),i.rowManager.renderRows(o)}),n))}},{key:"layoutEventVerticallyStack",value:function(e,t,n){var r=this.scheduler.getResourceLayoutSettings(n),i=r.barMargin,o=r.resourceMargin,a=r.rowHeight;return 0===e?o:o+e*(a-2*o)+e*i}},{key:"layoutEventVerticallyPack",value:function(e,t,n,r){var i=this.scheduler.getResourceLayoutSettings(r),o=i.barMargin,a=i.resourceMargin,s=1/t,l=e*s,u=(i.rowHeight-2*a-(s-1)*o)*t;return{top:a+l*u+l*o,height:u}}},{key:"addTemporaryDragElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.resource,n=this.scheduler,r=n.generateRenderData(e,t,{timeAxis:!0,viewport:!0});r.absoluteTop=r.row?r.top+r.row.top:n.getResourceEventBox(e,t,!0).top;var i=this.renderEvent(r),o=i.dataset;delete i.tabIndex,delete o.eventId,delete o.resourceId,delete o.assignmentId,delete o.syncId,o.transient=!0,i.parent=this.scheduler.foregroundCanvas,i.retainElement=!0;var a=mi.createElement(i);return a.innerElement=a.firstChild,e.instanceMeta(n).hasTemporaryDragElement=!0,a}},{key:"eventSorter",value:function(e,t){if(this.horizontalEventSorterFn)return this.horizontalEventSorterFn(e.eventRecord||e,t.eventRecord||t);var n=e.isModel?e.startDateMS:e.dataStartMS||e.startMS,r=e.isModel?e.endDateMS:e.dataEndMS||e.endMS,i=t.isModel?t.startDateMS:t.dataStartMS||t.startMS,o=t.isModel?t.endDateMS:t.dataEndMS||t.endMS,a=e.isModel?e.name:e.eventRecord.name,s=t.isModel?t.name:t.eventRecord.name;return n-i||o-r||(a<s?-1:a==s?0:1)}},{key:"calculateMS",value:function(e){var t=this.scheduler,n=t.timeAxis,r=t.timeAxisViewModel,i=e.isBatchUpdating?e.get("startDate"):e.startDate,o=e.isBatchUpdating?e.get("endDate"):e.endDate,a=cO(t,n,i,null==i?void 0:i.getTime(),!1),s=cO(t,n,o,null==o?void 0:o.getTime(),!0),l=s-a;if("default"!==t.milestoneLayoutMode&&0===l){var u=r.getSingleUnitInPixels("minute");switch(l=60*(t.getMilestoneLabelWidth(e)*(1/u))*1e3,t.milestoneAlign){case"start":case"left":s=a+l;break;case"end":case"right":a=(s=a)-l;break;default:a=(s=a+l/2)-l}}return{startMS:a,endMS:s,durationMS:l}}},{key:"getTimeSpanRenderData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.scheduler,o=i.timeAxis,a=i.timeAxisViewModel,s=!0===n||n.timeAxis,l=!0===n||n.viewport;if(s||o.isTimeSpanInAxis(e)){var u=i.getRowById(t);if(u||l){var c,f=a.getSingleUnitInPixels("minute"),d=e.isBatchUpdating?e.get("startDate"):e.startDate,h=e.isBatchUpdating?e.get("endDate"):e.endDate||d,v=o.startMS,p=o.endMS,g=r.calculateMS(e),y=g.startMS,m=g.endMS,b=g.durationMS,k=y<v|(y>p)<<1,w=m>p|(m<=v)<<1,C=b/6e4,R=w?f*C:null,S=i.getCoordinateFromDate(m,{local:!0,respectExclusion:!0,isEnd:!0}),x=!1,E=!1;if(k?c=(y-v)/6e4*f:x=-1===(c=i.getCoordinateFromDate(y,{local:!0,respectExclusion:!0,isEnd:!1,snapToNextIncluded:-1!==S})),w?S=c+R:E=-1===S,E&&!x&&(S=i.getCoordinateFromDate(m,{local:!0,respectExclusion:!0,isEnd:!0,snapToNextIncluded:!0})),R>sO&&(1===k?1===w?(c=-100,S=i.timeAxisColumn.width+100):c=S-sO:1===w&&(S=c+sO)),x&&E&&(c=i.getCoordinateFromDate(y,{local:!0,respectExclusion:!0,isEnd:!1,snapToNextIncluded:!0,max:m}))===(S=i.getCoordinateFromDate(m,{local:!0,respectExclusion:!0,isEnd:!0,snapToNextIncluded:!0,min:y})))return e.instanceMeta(i).excluded=!0,null;var D=i.getResourceLayoutSettings(t),T=D.resourceMargin,O=D.rowHeight,M={eventRecord:e,taskRecord:e,left:Math.min(c,S),width:Math.abs(S-c)||(e.isMilestone?0:1),start:d,end:h,rowId:t.id,children:[],startMS:y,endMS:m,startsOutsideView:k,endsOutsideView:w,clippedStart:x,clippedEnd:E,row:u};return i.fillTicks&&(M.dataStartMS=M.start.getTime(),M.dataEndMS=M.end.getTime()),M.top=Math.max(0,T),i.managedEventSizing&&(M.height=Math.max(O-2*T,1)),M}}}},{key:"layoutResourceEvents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.scheduler,i=r.eventStore,o=r.assignmentStore,a=r.timeAxis,s=i.getEvents({includeOccurrences:r.enableRecurringEvents,resourceRecord:e,startDate:a.startDate,endDate:a.endDate,filter:(o.isFiltered||i.isFiltered)&&function(t){return t.assignments.some((function(t){return t.resource===e&&o.includes(t)}))}}),l=r.getEventsToRender(e,s)||[],u=l.reduce((function(n,i){if(t||a.isTimeSpanInAxis(i)){var o=r.generateRenderData(i,e,!1);o&&n.push(o)}return n}),[]);u.sort(n.eventSorter);var c=r.getResourceHeight(e),f=u.filter((function(e){return e.eventRecord.isEvent})),d=e.eventLayout||r.eventLayout,h=r.getEventLayoutHandler(d);if("stack"===d){var v=r.getResourceLayoutSettings(e),p=v.barMargin,g=v.resourceMargin,y=h.applyLayout(f,e),m=c-2*g;c=y*m+(y-1)*p+2*g}else"pack"===d&&h.applyLayout(f,e);return{rowHeight:c,eventsData:u}}},{key:"renderEvent",value:function(e,t){var n=this.scheduler,r=e.resourceRecord,i=e.assignmentRecord,o=e.eventRecord,a=i?this.assignmentStore.getOccurrence(i,o).id:e.eventId,s={className:e.wrapperCls,tabIndex:"0",children:[{className:e.cls,style:e.style||"",children:e.children,dataset:{taskFeature:"event"},syncOptions:{syncIdField:"taskBarFeature"}}].concat(F()(e.wrapperChildren)),style:{transform:"translate(".concat(e.left,"px, ").concat(e.absoluteTop,"px)"),height:e.fillSize?t:e.height,width:e.width>0?e.width:null,style:e.wrapperStyle,fontSize:e.height+"px"},dataset:{resourceId:r.id,eventId:e.eventId,syncId:a},elementData:e,retainElement:(null==i?void 0:i.instanceMeta(n).retainElement)||o.instanceMeta(n).retainElement,syncOptions:{syncIdField:"taskFeature",releaseThreshold:0}};return e.zIndex&&(s.zIndex=e.zIndex),i&&(s.dataset.assignmentId=i.id),e.elementConfig=s,n.trigger("beforeRenderEvent",{renderData:e,domConfig:s}),s}},{key:"refreshEventsForResource",value:function(e){var t,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.isModel?(t=this.scheduler.rowManager.getRowFor(e),n=e):(t=e,n=this.resourceStore.getById(e.id)),r&&this.clearResources([e]),t&&(this.renderer({row:t,record:n}),r&&this.onRenderDone())}},{key:"renderer",value:function(e){var t,n,r=e.row,i=e.record,o=e.size,a=void 0===o?{}:o;if(i.isSpecialRow)this.rowMap.delete(r);else{var s,l,u=this,c=u.bufferSize,f=u.scheduler,d=(null===(t=f.features.labels)||void 0===t?void 0:t.left)||(null===(n=f.features.labels)||void 0===n?void 0:n.right),h=u.viewportCoords,v=h.left,p=h.right,g=[],y=u.resourceMap.get(i.id);if(!y||y.invalid){if(u.suspended)return;y=u.layoutResourceEvents(i,!1),u.resourceMap.set(i.id,y)}a.height=y.rowHeight,y.eventsData.forEach((function(e){s=v,l=p,(d||0===e.width)&&(s-=c,l+=c),e.left+e.width>=s&&e.left<=l&&(e.absoluteTop=e.top+r.top,g.push(u.renderEvent(e,y.rowHeight)))})),u.rowMap.set(r,g)}}},{key:"onRenderDone",value:function(){var e,t=this.scheduler,n=this.rowMap,r=this.verticalBufferSize,i=[],o=null!==(e=t._scrollTop)&&void 0!==e?e:0,a=o-r,s=o+t._bodyRectangle.height+r;n.forEach((function(e,t){if(r<0||t.bottom>a&&t.top<s)i.push.apply(i,e);else for(var n=0;n<e.length;n++)e[n]=rO({},e[n])})),du.sync({domConfig:{onlyChildren:!0,children:i},targetElement:t.foregroundCanvas,syncIdField:"syncId",callback:function(e){var n,r=e.action,i=e.domConfig,o=e.lastDomConfig,a=e.targetElement;if("none"!==r&&null!=i&&null!==(n=i.className)&&void 0!==n&&n["".concat(t.eventCls,"-wrap")]){var s=aO[r];if(oO[r]&&null!=o&&o.elementData){var l=o.elementData,u=l.eventRecord,c=l.resourceRecord,f=l.assignmentRecord,d={renderData:o.elementData,element:a,eventRecord:u,resourceRecord:c,assignmentRecord:f};a===mi.getActiveElement(a)&&t.focusElement.focus(),t.trigger("releaseEvent",d)}if(s){var h=i.elementData,v=h.eventRecord,p=h.resourceRecord,g=h.assignmentRecord,y={renderData:i.elementData,tplData:i.elementData,element:a,isReusingElement:"reuseElement"===r,isRepaint:"reuseOwnElement"===r,eventRecord:v,resourceRecord:p,assignmentRecord:g};t.trigger("renderEvent",y)}}}})}},{key:"clearResources",value:function(e){var t=this;e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=[e]),e.map(Lo.asId).forEach((function(e){var n=t.resourceMap.get(e);n&&(n.invalid=!0);var r=t.scheduler.getRowById(e);r&&t.rowMap.delete(r)}))}},{key:"clearAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.clearDom,n=void 0!==t&&t,r=e.clearLayoutCache,i=void 0!==r&&r,o=this.scheduler.layouts;if(i&&o)for(var a in o)o[a].clearCache();if(n){var s=this.scheduler.foregroundCanvas;s.syncIdMap=s.lastDomConfig=null;var l,u=eO(s.children);try{for(u.s();!(l=u.n()).done;){var c=l.value;c.lastDomConfig=c.elementData=null}}catch(e){u.e(e)}finally{u.f()}}this.resourceMap.clear(),this.rowMap.clear()}}],[{key:"configurable",get:function(){return{scrollBuffer:0,bufferSize:150,verticalBufferSize:150}}},{key:"properties",get:function(){return{resourceMap:new Map,rowMap:new Map,eventConfigs:[],isFirstRefresh:!0}}}]),n}($e.mixin(QT,Px));function dO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}fO._$name="HorizontalRendering";var hO=function(e){Ye()(n,e);var t=dO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"applyLayout",value:function(e,t,r,i,o,a){tt()(Ze()(n.prototype),"applyLayout",this).call(this,e,(function(e,n,o,s){if("none"===a)e.width=t-2*r,e.left+=r;else{e.widthFactor=s;var l=e.leftFactor=o.start+n*s,u=Math.round(1/s),c=l/s,f=t-2*r-i*(u-1);"mixed"===a&&2===u?(e.left+=l*t/5+i,e.width=t-l*t/5-2*i,e.zIndex=5+c):(e.width=s*f,e.left+=l*f+r+i*c)}}))}}],[{key:"defaultConfig",get:function(){return{coordProp:"leftFactor",sizeProp:"widthFactor"}}}]),n}(MT());function vO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}hO._$name="VerticalLayout";var pO={releaseElement:1,reuseElement:1},gO={newElement:1,reuseOwnElement:1,reuseElement:1},yO={startDate:1,endDate:1,duration:1},mO=Object.freeze({}),bO=function(e){Ye()(n,e);var t=vO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){this.client=this.scheduler=e,this.verticalLayout=new hO({scheduler:e}),tt()(Ze()(n.prototype),"construct",this).call(this,{})}},{key:"init",value:function(){var e=this,t=e.scheduler;e.resourceColumns.resourceStore=e.resourceStore,e.resourceColumns.on({name:"resourceColumns",columnWidthChange:"onResourceColumnWidthChange",thisObj:e}),e.initialized=!0,t.isPainted&&e.renderer(),e.resourceColumns.availableWidth=t.timeAxisSubGridElement.offsetWidth}},{key:"resolveRowRecord",value:function(e,t){var n=this.scheduler,r=e.nodeType?null:e,i=r?r.target:e,o=r?[r.offsetX,r.offsetY]:t,a=i.nodeType===Element.TEXT_NODE?i.parentElement:i,s=mi.up(a,n.eventSelector);if(s)return n.resourceStore.getById(s.dataset.resourceId);if(!mi.up(i,".b-sch-timeaxis-cell"))return null;if(!o)throw new Error("Vertical mode needs coordinates to resolve this element. Can also be called with a browser\n                event instead of element to extract element and coordinates from");var l=Math.floor(o[0]/this.resourceColumns.columnWidth);return n.resourceStore.getAt(l)}},{key:"toggleCls",value:function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=null===(n=this.eventMap.get(e.eventId))||void 0===n?void 0:n[e.resourceId];if(o){o.renderData[i?"wrapperCls":"cls"][t]=r;var a=this.getElementFromAssignmentRecord(e,i);a&&a.classList[r?"add":"remove"](t)}}},{key:"getDateFromXY",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[1];return n||(i=this.translateToScheduleCoordinate(i)),this.scheduler.timeAxisViewModel.getDateFromPosition(i,t,r)}},{key:"translateToScheduleCoordinate",value:function(e){return e-this.scheduler._bodyRectangle.y+this.scheduler.scrollTop}},{key:"translateToPageCoordinate",value:function(e){return e+this.scheduler._bodyRectangle.y-this.scheduler.scrollTop}},{key:"getResourceEventBox",value:function(e,t){var n,r,i,o=e.id,a=t.id,s=((null===(n=this.eventMap.get(o))||void 0===n?void 0:n[a])||mO).renderData;s||(this.layoutResource(this.scheduler.resourceStore.getById(a)),s=null===(r=this.eventMap.get(o))||void 0===r||null===(i=r[a])||void 0===i?void 0:i.renderData);return s?new Cr(s.left,s.top,s.width,s.bottom-s.top):null}},{key:"getScheduleRegion",value:function(e,t,n){var r=this,i=r.scheduler,o=Cr.from(i.timeAxisSubGridElement);e&&(o.left=r.resourceStore.indexOf(e)*i.resourceColumnWidth,o.right=o.left+i.resourceColumnWidth);var a=i.timeAxis.startDate,s=i.timeAxis.endDate,l=i.getDateConstraints(e,t)||{start:a,end:s},u=i.getCoordinateFromDate(Un.max(a,l.start)),c=i.getCoordinateFromDate(Un.min(s,l.end));return n?(o.top=u,o.bottom=c):(o.top=r.translateToPageCoordinate(u),o.bottom=r.translateToPageCoordinate(c)),o}},{key:"getRowRegion",value:function(e,t,n){var r=this.scheduler,i=this.resourceStore.indexOf(e)*r.resourceColumnWidth,o=r.timeAxis.startDate,a=r.timeAxis.endDate,s=t?Un.max(o,t):o,l=n?Un.min(a,n):a,u=r.getCoordinateFromDate(s),c=r.getCoordinateFromDate(l,!0,!0),f=Math.min(u,c),d=Math.abs(u-c);return new Cr(i,f,r.resourceColumnWidth,d)}},{key:"visibleDateRange",get:function(){var e=this.scheduler,t=e.scrollable.y,n=e.scrollable.clientHeight;return{startDate:e.getDateFromCoordinate(t),endDate:e.getDateFromCoordinate(t+n)||e.timeAxis.endDate}}},{key:"onResourceColumnWidthChange",value:function(e){var t=e.width,n=e.oldWidth,r=this,i=r.scheduler;r.resourceColumns.width=i.timeAxisColumn.width=r.resourceStore.count*t,r.clearAll(),r.refresh(Math.abs(t-n)>30)}},{key:"attachToProject",value:function(e){tt()(Ze()(n.prototype),"attachToProject",this).call(this,e),e&&e.on({name:"project",refresh:"onProjectRefresh",thisObj:this})}},{key:"onProjectRefresh",value:function(){var e=this,t=e.scheduler,n=e.toDrawOnProjectRefresh;t.rendered&&!t.refreshSuspended&&(e.refreshAllWhenReady?(e.clearAll(),e.refresh(),e.refreshAllWhenReady=!1):n.size&&e.refresh(),n.clear())}},{key:"attachToEventStore",value:function(e){tt()(Ze()(n.prototype),"attachToEventStore",this).call(this,e),this.refreshAllWhenReady=!0,e&&e.on({name:"eventStore",refreshPreCommit:"onEventStoreRefresh",thisObj:this})}},{key:"onEventStoreRefresh",value:function(e){"batch"===e.action&&(this.refreshAllWhenReady=!0)}},{key:"onEventStoreChange",value:function(e){var t=e.action,n=e.records,r=e.record,i=e.replaced,o=e.changes,a=(e.isAssign,this),s=n||(r?[r]:[]),l=new Set;switch(s.forEach((function(e){e.resources.forEach((function(e){return l.add(e.id)}))})),t){case"sort":case"group":case"move":case"remove":return;case"dataset":return void a.refreshAllResourcesWhenReady();case"add":case"updateMultiple":break;case"replace":i.forEach((function(e){N()(e,2)[1].resources.map((function(e){return l.add(e.id)}))})),a.clearResources(l);break;case"removeall":case"filter":return a.clearAll(),void a.refresh();case"update":var u=0;return"startDate"in o&&u++,"endDate"in o&&u++,"duration"in o&&u++,void((r.$entity?!Object.keys(o).some((function(e){return!r.$entity.getField(e)})):!Object.keys(o).some((function(e){return!yO[e]})))&&!u||(a.clearResources(l),a.refresh()))}a.refreshResourcesWhenReady(l)}},{key:"attachToResourceStore",value:function(e){var t=this;tt()(Ze()(n.prototype),"attachToResourceStore",this).call(this,e),t.refreshAllWhenReady=!0,t.resourceColumns&&(t.resourceColumns.resourceStore=e),e.on({name:"resourceStore",changePreCommit:"onResourceStoreChange",refreshPreCommit:"onResourceStoreRefresh",load:function(){return t.scheduler.unmaskBody()},thisObj:t,prio:1}),t.initialized&&(t.firstResource=t.lastResource=null,t.clearAll(),t.renderer())}},{key:"onResourceStoreChange",value:function(e){var t=e.source,n=e.action,r=e.records,i=e.record,o=e.replaced,a=e.changes,s=this,l=r||(o?o.map((function(e){return e[1]})):i?[i]:[]),u=new Set(l.map((function(e){return e.id})));if(s.firstResource=s.lastResource=null,s.scheduler.isEngineReady){switch(n){case"update":null!=a&&a.id?s.clearResources([a.id.oldValue,a.id.value]):s.clearResources([i.id]);break;case"filter":s.clearAll()}s.refresh(!0)}else{switch(n){case"dataset":case"remove":case"removeall":return void s.refreshAllResourcesWhenReady();case"replace":case"add":for(var c=l.reduce((function(e,n){return Math.min(e,t.indexOf(n))}),t.count);c<t.count;c++)u.add(t.getAt(c).id)}s.refreshResourcesWhenReady(u)}}},{key:"onResourceStoreRefresh",value:function(e){var t=e.action,n=this;if("group"===t)throw new Error("Grouping of resources not supported in vertical mode");"sort"===t&&(n.firstResource=n.lastResource=null,n.clearAll(),n.refresh())}},{key:"attachToAssignmentStore",value:function(e){tt()(Ze()(n.prototype),"attachToAssignmentStore",this).call(this,e),this.refreshAllWhenReady=!0,e&&e.on({name:"assignmentStore",changePreCommit:"onAssignmentStoreChange",refreshPreCommit:"onAssignmentStoreRefresh",thisObj:this})}},{key:"onAssignmentStoreChange",value:function(e){var t=e.action,n=e.records,r=e.replaced,i=e.record,o=e.changes,a=this,s=new Set((n||(i?[i]:[])).map((function(e){return e.resourceId})));if(a.scheduler.isEngineReady){switch(t){case"filter":a.clearAll();break;case"update":if("resourceId"in o&&s.add(o.resourceId.oldValue),!Object.keys(o).filter((function(e){return"resource"!==e&&"event"!==e})).length)return;a.clearResources(s)}a.refresh(!0)}else{switch(o&&"resourceId"in o&&s.add(o.resourceId.oldValue),t){case"removeall":return void a.refreshAllResourcesWhenReady();case"replace":r.forEach((function(e){var t=N()(e,2),n=t[0],r=t[1];s.add(n.resourceId),s.add(r.resourceId)}))}a.refreshResourcesWhenReady(s)}}},{key:"onAssignmentStoreRefresh",value:function(e){var t=e.action,n=e.records;"batch"===t&&(this.clearResources(n.map((function(e){return e.resourceId}))),this.renderer())}},{key:"refreshRows",value:function(e){e&&(this.clearAll(),this.scheduler.refreshFromRerender=!1)}},{key:"repaintEventsForResource",value:function(e){this.renderResource(e)}},{key:"updateFromHorizontalScroll",value:function(e){e!==this.prevScrollLeft&&(this.renderer(),this.prevScrollLeft=e)}},{key:"updateFromVerticalScroll",value:function(){this.renderer()}},{key:"scrollResourceIntoView",value:function(e,t){var n=this.scheduler,r=n.resourceStore.indexOf(e)*n.resourceColumnWidth;return n.scrollHorizontallyTo(r,t)}},{key:"onViewportResize",value:function(e){this.resourceColumns.availableWidth=e,this.renderer()}},{key:"resourceColumns",get:function(){return this.scheduler.timeAxisColumn.resourceColumns}},{key:"onLocaleChange",value:function(){this.clearAll()}},{key:"onDragAbort",value:function(){}},{key:"onBeforeRowHeightChange",value:function(){}},{key:"onTimeAxisViewModelUpdate",value:function(){}},{key:"updateElementId",value:function(){}},{key:"releaseTimeSpanDiv",value:function(){}},{key:"refreshResourcesWhenReady",value:function(e){var t=this;this.clearResources(e),e.forEach((function(e){return t.toDrawOnProjectRefresh.add(e)}))}},{key:"refreshAllResourcesWhenReady",value:function(){this.clearAll(),this.refreshAllWhenReady=!0}},{key:"resourceRange",get:function(){return this.getResourceRange(!0)}},{key:"visibleResources",get:function(){var e=this.getResourceRange(),t=e.first,n=e.last;return{first:this.resourceStore.getAt(t),last:this.resourceStore.getAt(n)}}},{key:"getResourceRange",value:function(e){var t=this.scheduler,n=this.resourceStore,r=this.resourceBufferSize;return e||(r=0),n&&n.count?{first:Math.max(Math.floor(t.scrollLeft/t.resourceColumnWidth)-r,0),last:Math.min(Math.floor((t.scrollLeft+t.timeAxisSubGrid.width)/t.resourceColumnWidth)+r,n.count-1)}:{first:-1,last:-1}}},{key:"dateRange",get:function(){var e=this.scheduler,t=e.getDateFromCoordinate(Math.min(e.scrollTop+e.bodyHeight+e.tickSize-1,(e.virtualScrollHeight||e.scrollable.scrollHeight)-1));t||(t=e.timeAxis.last.endDate);var n=e.getDateFromCoordinate(Math.max(e.scrollTop-e.tickSize,0));return n||(n=e.timeAxis.first.startDate,t=e.getDateFromCoordinate(e.bodyHeight+e.tickSize-1)),{topDate:n,bottomDate:t}}},{key:"getTimeSpanRenderData",value:function(e,t){var n=this,r=n.scheduler,i=e.isBatchUpdating?e.get("startDate"):e.startDate,o=e.isBatchUpdating?e.get("endDate"):e.endDate,a=r.getResourceMargin(t),s=r.getCoordinateFromDate(i),l=n.resourceStore.indexOf(t)*r.resourceColumnWidth,u=r.resourceColumnWidth-2*a,c=i.getTime(),f=o.getTime(),d=r.getCoordinateFromDate(o),h=d-s;return-1===d&&(d=s+(h=Math.round((f-c)*r.timeAxisViewModel.getSingleUnitInPixels("millisecond")))),{eventRecord:e,resourceRecord:t,left:l,top:s,bottom:d,width:u,height:h,startDate:i,endDate:o,startDateMS:c,endDateMS:f,children:[],start:i,end:o,startMs:c,endMs:f}}},{key:"eventSorter",value:function(e,t){var n=e.dataStartMs||e.startDateMS,r=e.dataEndMs||e.endDateMS,i=t.dataStartMs||t.startDateMS,o=t.dataEndMs||t.endDateMS,a=e.isModel?e.name:e.eventRecord.name,s=t.isModel?t.name:t.eventRecord.name;return n-i||o-r||(a<s?-1:a==s?0:1)}},{key:"layoutResource",value:function(e){var t=this,n=t.scheduler,r=e.id,i=n.assignmentStore,o=n.eventStore,a=t.resourceMap.set(r,{}).get(r),s=n.resourceStore.indexOf(e),l=n.getResourceLayoutSettings(e),u=l.barMargin,c=l.resourceMargin,f=e.assignments.reduce((function(e,t){return i.isAvailable(t)&&o.isAvailable(t.event)&&e.push(t.event),e}),[]),d=(f=n.getEventsToRender(e,f)).reduce((function(i,o){var l=n.generateRenderData(o,e),u={renderData:l};return Qn.getMapPath(t.eventMap,l.eventId,{})[r]=u,a[l.eventId]=u,l.fillSize?(l.left=s*n.resourceColumnWidth,l.width=n.resourceColumnWidth):i.push(l),i}),[]);return d.sort(t.eventSorter),t.verticalLayout.applyLayout(d,n.resourceColumnWidth,c,u,s,e.eventLayout||n.eventLayout),a}},{key:"addTemporaryDragElement",value:function(e){var t=this.scheduler,n=t.generateRenderData(e,e.resource,{timeAxis:!0,viewport:!0});n.top=n.row?n.top+n.row.top:t.getResourceEventBox(e,e.resource,!0).top;var r=this.renderEvent({renderData:n}),i=r.dataset;delete r.tabIndex,delete i.eventId,delete i.resourceId,delete i.assignmentId,delete i.syncId,i.transient=!0,r.parent=this.scheduler.foregroundCanvas,r.retainElement=!0;var o=mi.createElement(r);return o.innerElement=o.firstChild,e.instanceMeta(t).hasTemporaryDragElement=!0,o}},{key:"renderEvent",value:function(e){var t=e.renderData,n=t.resourceRecord,r=t.assignmentRecord,i={className:t.wrapperCls,tabIndex:"0",children:[{className:t.cls,style:(t.internalStyle||"")+(t.style||""),children:t.children,dataset:{taskFeature:"event"},syncOptions:{syncIdField:"taskBarFeature"}}].concat(F()(t.wrapperChildren)),style:{transform:"translate(".concat(t.left,"px, ").concat(t.top,"px)"),height:t.height,width:t.width,style:t.wrapperStyle||""},dataset:{resourceId:n.id,eventId:t.eventId,syncId:r?r.id:t.eventId},elementData:e,retainElement:(r||t.eventRecord).instanceMeta(this.scheduler).retainElement,syncOptions:{syncIdField:"taskFeature",releaseThreshold:0}};return t.zIndex&&(i.zIndex=t.zIndex),r&&(i.dataset.assignmentId=r.id),this.scheduler.trigger("beforeRenderEvent",{renderData:t,domConfig:i}),e.elementConfig=i,i}},{key:"renderResource",value:function(e){var t=this,n=t.topDateMS,r=t.bottomDateMS,i=[],o=t.resourceMap.get(e.id);for(var a in o||(o=t.layoutResource(e)),o){var s=o[a],l=s.renderData,u=l.endDateMS,c=l.startDateMS,f=l.eventRecord;u>=n&&c<=r&&!f.instanceMeta(t.scheduler).hasTemporaryDragElement&&i.push(t.renderEvent(s))}return i}},{key:"isEventElement",value:function(e){var t=e&&e.className;return t&&t[this.scheduler.eventCls+"-wrap"]}},{key:"renderer",value:function(){var e=this,t=e.scheduler,n=t.resourceStore,r=e.resourceRange,i=r.first,o=r.last,a=e.dateRange,s=a.topDate,l=a.bottomDate,u=[],c=[];if(e.initialized&&(t.isEngineReady||t.isCreating)){if(!Un.isEqual(s,e.topDate)||!Un.isEqual(l,e.bottomDate)){e.topDate=s,e.bottomDate=l,e.topDateMS=s.getTime(),e.bottomDateMS=l.getTime();var f=e.timeView.range={startDate:s,endDate:l};t.onVisibleDateRangeChange(f),t.trigger("visibleRangeChange",f)}if(-1!==i&&-1!==o)for(var d=i;d<=o;d++)u.push.apply(u,e.renderResource(n.getAt(d)));if(t.getForegroundDomConfigs(c),u.push.apply(u,c),du.sync({domConfig:{onlyChildren:!0,children:u},targetElement:t.foregroundCanvas,syncIdField:"syncId",callback:function(n){var r=n.action,i=n.domConfig,o=n.lastDomConfig,a=n.targetElement;if(e.isEventElement(i)){var s=gO[r];if(pO[r]&&e.isEventElement(o)&&!o.isReleased){var l=o.elementData.renderData,u={renderData:l,assignmentRecord:l.assignmentRecord,eventRecord:l.eventRecord,resourceRecord:l.resourceRecord,element:a};a===mi.getActiveElement(a)&&t.focusElement.focus(),t.trigger("releaseEvent",u)}if(s){var c=i.elementData.renderData,f={renderData:c,tplData:c,assignmentRecord:c.assignmentRecord,eventRecord:c.eventRecord,resourceRecord:c.resourceRecord,element:a,isReusingElement:"reuseElement"===r,isRepaint:"reuseOwnElement"===r};f.reusingElement="reuseElement"===r,t.trigger("renderEvent",f)}}}}),e.firstResource!==i||e.lastResource!==o){var h=e.resourceColumns.visibleResources={firstResource:i,lastResource:o};e.firstResource=i,e.lastResource=o,t.onVisibleResourceRangeChange(h),t.trigger("resourceRangeChange",h)}}}},{key:"refresh",value:function(e){var t=this;this.scheduler.runWithTransition((function(){return t.renderer()}),e)}},{key:"refreshResources",value:function(e){this.clearResources(e),this.refresh()}},{key:"timeView",get:function(){return this.scheduler.timeView}},{key:"clearResources",value:function(e){var t=this.resourceMap,n=this.eventMap;e.forEach((function(e){t.has(e)&&(Object.values(t.get(e)).forEach((function(t){var r=t.renderData.eventId;delete n.get(r)[e]})),t.delete(e))}))}},{key:"clearAll",value:function(){this.resourceMap.clear(),this.eventMap.clear()}}],[{key:"properties",get:function(){return{eventMap:new Map,resourceMap:new Map,releasedElements:{},toDrawOnProjectRefresh:new Set,resourceBufferSize:1}}}]),n}($e.mixin(el,QT,Px));function kO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kO(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function CO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bO._$name="VerticalRendering";function RO(e,t){return e===t.length-1}function SO(e,t){return t===e.cells[e.cells.length-1]}var xO=function(e){Ye()(n,e);var t=CO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"range",set:function(e){var t=e.startDate,n=e.endDate;(this.startDate-t||this.endDate-n)&&(this.startDate=t,this.endDate=n,this.refresh(!0))}},{key:"buildCells",value:function(){var e,t=this,n=t.sizeProperty,r=t.client||{},i=r.stickyHeaders,o=r.isVertical,a=[],s=t.levels.length,l=t.levels.map((function(e,r){var a,l,u=i&&(o||r<s-1);return{className:(a={"b-sch-header-row":1},Qe()(a,"b-sch-header-row-".concat(e.position),1),Qe()(a,"b-sch-header-row-main",r===t.model.viewPreset.mainHeaderLevel),Qe()(a,"b-lowest",RO(r,t.levels)),Qe()(a,"b-sticky-header",u),a),syncOptions:{releaseThreshold:5,syncIdField:"tickIndex"},dataset:{headerFeature:"headerRow".concat(r),headerPosition:e.position},children:null===(l=e.cells)||void 0===l?void 0:l.filter((function(e){return e.start<t.endDate&&e.end>t.startDate})).map((function(r){var i,o;return{className:(i={"b-sch-header-timeaxis-cell":1},Qe()(i,r.headerCellCls,r.headerCellCls),Qe()(i,"b-align-".concat(r.align),r.align),Qe()(i,"b-last",SO(e,r)),i),dataset:wO({tickIndex:r.index},window.DEBUG&&{date:r.start.getTime()}),style:(o={},Qe()(o,t.positionProperty,r.coord),Qe()(o,n,r.width),Qe()(o,"min-".concat(n),r.width),o),children:[{tag:"span",className:{"b-sch-header-text":1,"b-sticky-header":u},html:r.value}]}}))}}));return null===(e=t.client)||void 0===e||e.getHeaderDomConfigs(a),l.push.apply(l,a),{className:t.widgetClassList,syncOptions:{releaseThreshold:0},children:l}}},{key:"render",value:function(e){tt()(Ze()(n.prototype),"render",this).call(this,e),this.refresh(!0)}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.levels.length,t=this,n=t.model.columnConfig,r=t.levels,i=r.length;if(e){r.length=0,n.forEach((function(e,t){return r[t]={position:t,cells:e}})),t.size=r[0].cells.reduce((function(e,t){return e+t.width}),0);var o=t.element.parentElement;o&&(r.length!==i||e)&&(o.classList.remove("b-sch-timeaxiscolumn-levels-".concat(i)),o.classList.add("b-sch-timeaxiscolumn-levels-".concat(r.length)))}t.startDate&&t.endDate&&(du.sync({domConfig:t.buildCells(),targetElement:t.element,syncIdField:"headerFeature"}),t.trigger("refresh"))}},{key:"widgetClass",get:function(){return"b-timeaxis"}}],[{key:"$name",get:function(){return"TimeAxisBase"}},{key:"configurable",get:function(){return{compactCellWidthThreshold:15,model:null,cls:null,sizeProperty:null,positionProperty:null}}},{key:"properties",get:function(){return{startDate:null,endDate:null,levels:[],size:null}}}]),n}(uc);function EO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}xO._$name="TimeAxisBase";var DO=function(e){Ye()(n,e);var t=EO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"width",get:function(){return this.size}},{key:"onModelUpdate",value:function(){this.model.availableSpace!==this.width&&this.refresh(!0)}},{key:"updateModel",value:function(e){this.detachListeners("tavm"),null==e||e.on({name:"tavm",update:"onModelUpdate",thisObj:this})}}],[{key:"$name",get:function(){return"HorizontalTimeAxis"}},{key:"type",get:function(){return"horizontaltimeaxis"}},{key:"configurable",get:function(){return{model:null,sizeProperty:"width",positionProperty:"left"}}}]),n}(xO);function TO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}DO._$name="HorizontalTimeAxis";var OO=function(e){Ye()(n,e);var t=TO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){tt()(Ze()(n.prototype),"construct",this).call(this,e);var t=this;null!=t.imagePath&&t.element.classList.add("b-has-images"),Tu.on({element:t.element,delegate:".b-resourceheader-cell",capture:!0,click:"onResourceMouseEvent",dblclick:"onResourceMouseEvent",contextmenu:"onResourceMouseEvent",thisObj:t})}},{key:"changeShowAvatars",value:function(e){var t;return null===(t=this.avatarRendering)||void 0===t||t.destroy(),e&&(this.avatarRendering=new fg({element:this.element})),e}},{key:"updateShowAvatars",value:function(){this.isConfiguring||this.refresh()}},{key:"resourceStore",get:function(){return this._resourceStore},set:function(e){var t,n=this;e!==n._resourceStore&&(null===(t=n.resourceStoreDetacher)||void 0===t||t.call(n),n._resourceStore=e,n.resourceStoreDetacher=e.on({changePreCommit:"onResourceStoreDataChange",thisObj:n}),e.count&&n.onResourceStoreDataChange({}))}},{key:"onResourceStoreDataChange",value:function(e){var t=e.action,n=this,r=n.resourceStore.count*n.columnWidth;r!==n.width&&(n.element.style.width=r+"px",n.column.set("width",r,n.column.grid.isConfiguring)),"removeall"===t&&(n.element.innerHTML=""),"remove"!==t&&"add"!==t&&"filter"!==t||n.refreshWidths()}},{key:"columnWidth",get:function(){return this._columnWidth},set:function(e){var t=this;if(e!==t._columnWidth){var n=t._columnWidth;t._columnWidth=e,t.refreshingWidths||(t._originalColumnWidth=e,t.refreshWidths()),t.isConfiguring||(t.refresh(),t.trigger("columnWidthChange",{width:t._columnWidth,oldWidth:n}))}}},{key:"fillWidth",get:function(){return this._fillWidth},set:function(e){this._fillWidth=e,this.refreshWidths()}},{key:"fitWidth",get:function(){return this._fitWidth},set:function(e){this._fitWidth=e,this.refreshWidths()}},{key:"getImageURL",value:function(e){return te.joinPaths([this.imagePath||"",e||""])}},{key:"imagePath",get:function(){return this._imagePath},set:function(e){this._imagePath=e,this.refresh()}},{key:"availableWidth",get:function(){return this._availableWidth},set:function(e){this._availableWidth=e,this.refreshWidths()}},{key:"refreshWidths",value:function(){var e=this,t=e.availableWidth,n=e._originalColumnWidth,r=e.resourceStore&&e.resourceStore.count;if(t&&r){e.refreshingWidths=!0;var i=e.fitWidth||e.fillWidth&&n*r<t?Math.floor(t/r):n,o=e.column.grid.enableEventAnimations&&Math.abs(e._columnWidth-i)>30;mi.addTemporaryClass(e.element,"b-animating",o?300:0,e),e.columnWidth=i,e.refreshingWidths=!1}}},{key:"visibleResources",set:function(e){var t=e.firstResource,n=e.lastResource;this.firstResource=t,this.lastResource=n,this.refresh()}},{key:"refresh",value:function(){var e=this,t=e.firstResource,n=e.lastResource,r=[];if(!e.column.grid.isConfiguring&&t>-1&n>-1&&n<e.resourceStore.count)for(var i=t;i<=n;i++){var o=e.resourceStore.getAt(i),a={className:new xr({"b-resourceheader-cell":1}),dataset:{resourceId:o.id},style:{left:i*e.columnWidth,width:e.columnWidth},children:[]};if(e.headerRenderer){var s=e.headerRenderer({elementConfig:a,resourceRecord:o});null!=s&&(a.html=s)}else{var l=void 0;if(o.imageUrl)l=o.imageUrl;else if(null!=e.imagePath&&!1!==o.image){var u=o.image||o.name&&o.name.toLowerCase()+e.imageExtension;l=e.getImageURL(u)}a.children.push(e.showAvatars&&e.avatarRendering.getResourceAvatar({initials:o.initials,color:o.eventColor,iconCls:o.iconCls,defaultImageUrl:e.defaultImageName&&e.getImageURL(e.defaultImageName),imageUrl:l}),{tag:"span",className:"b-resource-name",html:te.encodeHtml(o.name)})}r.push(a)}du.sync({domConfig:{onlyChildren:!0,children:r},targetElement:e.element,syncIdField:"resourceId"})}},{key:"onResourceMouseEvent",value:function(e){var t=e.target.closest(".b-resourceheader-cell"),n=this.resourceStore.getById(t.dataset.resourceId);this.trigger("resourceHeader"+te.capitalize(e.type),{resourceRecord:n,event:e})}}],[{key:"$name",get:function(){return"ResourceHeader"}},{key:"type",get:function(){return"resourceheader"}},{key:"defaultConfig",get:function(){return{resourceStore:null,columnWidth:150,headerRenderer:null,fillWidth:!0,fitWidth:!1,imagePath:null,imageExtension:null,defaultImageName:null}}},{key:"configurable",get:function(){return{showAvatars:{value:!0,$config:"nullify"}}}},{key:"properties",get:function(){return{firstResource:-1,lastResource:-1}}}]),n}(uc);function MO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}OO._$name="ResourceHeader";var AO=function(e){Ye()(n,e);var t=MO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e){var t=this;t.externalRenderer=e.renderer,tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),t.thisObj=t,t.timeAxisViewModel=t.grid.timeAxisViewModel,t.mode=t.mode,t.grid.on({paint:"onTimelinePaint",thisObj:t,once:!0})}},{key:"doDestroy",value:function(){var e,t;null===(e=this.resourceColumns)||void 0===e||e.destroy(),null===(t=this.timeAxisView)||void 0===t||t.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"mode",get:function(){return this.get("mode")},set:function(e){var t=this,n=t.grid;t.set("mode",e),"horizontal"===e?t.timeAxisView=new DO({model:t.timeAxisViewModel,compactCellWidthThreshold:t.compactCellWidthThreshold,owner:t.grid,client:t.grid}):"vertical"===e&&(t.resourceColumns=OO.new({column:t,resourceStore:n.resourceStore,imagePath:n.resourceImagePath,imageExtension:n.resourceImageExtension,defaultImageName:n.defaultResourceImageName},n.resourceColumns||{}),t.relayEvents(t.resourceColumns,["resourceheaderclick","resourceheaderdblclick","resourceheadercontextmenu"]))}},{key:"onViewModelUpdate",value:function(e){var t=e.source,n=this;"horizontal"===n.mode?(n.refreshHeader(!0),n.width=t.totalSize,n.grid.refresh(),n.subGrid.refreshFakeScroll()):"vertical"===n.mode&&n.grid.refreshRows()}},{key:"onTimelinePaint",value:function(e){var t,n=e.firstPaint,r=this;r.subGrid.insertRowsBefore&&(n&&(r.subGridElement.classList.add("b-timeline-subgrid"),"vertical"===r.mode&&(r.refreshHeader(),null===(t=r.grid)||void 0===t||t.onHeightChange())))}},{key:"refreshHeader",value:function(e){var t=this,n=t.element;n&&("horizontal"===t.mode?(!e&&t.timeAxisViewModel.update(void 0,void 0,!0),t.timeAxisView.rendered?t.timeAxisView.refresh(!0):(n.innerHTML="",t.timeAxisView.render(n))):"vertical"===t.mode&&(t.resourceColumns.currentElement||(n.innerHTML="",t.resourceColumns.render(n))))}},{key:"renderer",value:function(e){var t;if(this.grid.project.isInitialCommitPerformed)return this.grid.currentOrientation.renderer(e),null===(t=this.externalRenderer)||void 0===t?void 0:t.call(this,e)}},{key:"timeAxisViewModel",get:function(){return this._timeAxisViewModel},set:function(e){this.detachListeners("tavm"),null==e||e.on({name:"tavm",update:"onViewModelUpdate",prio:-1e4,thisObj:this}),this._timeAxisViewModel=e,this.timeAxisView&&(this.timeAxisView.model=e)}}],[{key:"fields",get:function(){return["mode"]}},{key:"defaults",get:function(){return{draggable:!1,groupable:!1,hideable:!1,showColumnPicker:!1,filterable:!1,sortable:!1,resizable:!1,searchable:!1,editor:!1,enableCellContextMenu:!1,tooltipRenderer:!1,cls:"b-sch-timeaxiscolumn",needWidth:!0,mode:null,region:"normal",exportable:!1,htmlEncode:!1}}},{key:"type",get:function(){return"timeAxis"}},{key:"autoExposeFields",get:function(){return!0}}]),n}(Ot(vg));function IO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function PO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?IO(Object(n),!0).forEach((function(t){Qe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function FO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(AO),AO._$name="TimeAxisColumn";var LO=function(e){Ye()(n,e);var t=FO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildHorizontalCells",value:function(){var e=this,t=e.client,n=null==t?void 0:t.stickyHeaders,r=[],i=e.levels.reduce((function(t,r,i){var o;r.cells&&t.push.apply(t,F()(null===(o=r.cells)||void 0===o?void 0:o.filter((function(t){return t.start<e.endDate&&t.end>e.startDate})).map((function(t,r,o){var a;return{className:(a={"b-sch-header-timeaxis-cell":1},Qe()(a,t.headerCellCls,t.headerCellCls),Qe()(a,"b-align-".concat(t.align),t.align),Qe()(a,"b-last",r===o.length-1),Qe()(a,"b-lowest",i===e.levels.length-1),a),dataset:PO({tickIndex:t.index,cellId:"".concat(i,"-").concat(t.index),headerPosition:i},window.DEBUG&&{date:t.start.getTime()}),style:{top:t.coord,height:t.width,minHeight:t.width},children:[{className:{"b-sch-header-text":1,"b-sticky-header":n},html:t.value}]}}))));return t}),[]);return null==t||t.getHeaderDomConfigs(r),i.push.apply(i,r),{className:e.widgetClassList,dataset:{headerFeature:"headerRow0",headerPosition:0},syncOptions:{releaseThreshold:5,syncIdField:"cellId"},children:i}}},{key:"height",get:function(){return this.size}}],[{key:"$name",get:function(){return"VerticalTimeAxis"}},{key:"configurable",get:function(){return{cls:"b-verticaltimeaxis",sizeProperty:"height",positionProperty:"top",wrapText:!0}}}]),n}(xO);function BO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}LO._$name="VerticalTimeAxis";var jO=function(e){Ye()(n,e);var t=BO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"isFocusable",get:function(){return!1}},{key:"construct",value:function(e){var t=this;tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),t.timeAxisViewModel=t.grid.timeAxisViewModel,t.view=new LO({model:t.timeAxisViewModel,client:t.grid})}},{key:"renderer",value:function(e){var t=e.cellElement,n=e.size;this.view.render(t),n.height=this.view.height}}],[{key:"type",get:function(){return"verticalTimeAxis"}},{key:"defaults",get:function(){return{draggable:!1,groupable:!1,hideable:!1,showColumnPicker:!1,filterable:!1,sortable:!1,searchable:!1,editor:!1,enableCellContextMenu:!1,tooltipRenderer:!1,cellCls:"b-verticaltimeaxiscolumn",flex:1}}}]),n}(vg);function _O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(jO),jO._$name="VerticalTimeAxisColumn";var HO=function(e){Ye()(i,e);var t,n,r=_O(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"afterConstruct",value:function(){tt()(Ze()(i.prototype),"afterConstruct",this).call(this),this.createEventOnDblClick&&this.on("scheduledblclick",this.onSchedulerDblClick)}},{key:"store",get:function(){return tt()(Ze()(i.prototype),"store",this)},set:function(e){gh()(Ze()(i.prototype),"store",e,this,!0)}},{key:"visibleResources",get:function(){var e=this;return e.isVertical?e.currentOrientation.visibleResources:{first:e.store.getById(e.firstVisibleRow.id),last:e.store.getById(e.lastVisibleRow.id)}}},{key:"onLocaleChange",value:function(){this.currentOrientation.onLocaleChange(),tt()(Ze()(i.prototype),"onLocaleChange",this).call(this)}},{key:"onSchedulerDblClick",value:function(e){var t=e.date,n=e.resourceRecord,r=e.row;this.readOnly||n.isSpecialRow||this.internalAddEvent(t,n,r)}},{key:"onColumnsChanged",value:function(e){e.action;var t=e.changes,n=e.record;n===this.timeAxisColumn&&"width"in t&&this.updateCanvasSize(),tt()(Ze()(i.prototype),"onColumnsChanged",this).apply(this,arguments)}},{key:"onVerticalScroll",value:function(e){var t=e.scrollTop;this.currentOrientation.updateFromVerticalScroll(t)}},{key:"onEventCreated",value:function(e){}},{key:"isHorizontal",get:function(){return"horizontal"===this.mode}},{key:"isVertical",get:function(){return"vertical"===this.mode}},{key:"mode",get:function(){return this._mode},set:function(e){var t=this;t._mode=e,t[e]||(t.element.classList.add("b-sch-".concat(e)),"horizontal"===e?(t.horizontal=new fO(t),t.isPainted&&t.horizontal.init(),t.un("scroll",t.onVerticalScroll,t)):"vertical"===e&&(t.vertical=new bO(t),t.rendered&&t.vertical.init(),t.on("scroll",t.onVerticalScroll,t)))}},{key:"currentOrientation",get:function(){return this[this.mode]}},{key:"onElementKeyDown",value:function(e){tt()(Ze()(i.prototype),"onElementKeyDown",this).call(this,e)}},{key:"onElementKeyUp",value:function(e){tt()(Ze()(i.prototype),"onElementKeyUp",this).call(this,e)}},{key:"onElementMouseOver",value:function(e){tt()(Ze()(i.prototype),"onElementMouseOver",this).call(this,e)}},{key:"onElementMouseOut",value:function(e){tt()(Ze()(i.prototype),"onElementMouseOut",this).call(this,e)}},{key:"populateEventMenu",value:function(){}},{key:"populateScheduleMenu",value:function(){}},{key:"onVisibleDateRangeChange",value:function(){}},{key:"onVisibleResourceRangeChange",value:function(){}},{key:"editEvent",value:function(e,t,n){var r=this,i=r.eventStore,o=r.assignmentStore,a=r.features,s=a.eventEdit,l=a.taskEdit,u=a.simpleEventEdit;if(!Boolean(s&&!s.disabled||l&&!l.disabled||u&&!u.disabled))return!1;if(e.eventStore!==i){var c=r.enableEventAnimations,f=[];e.isCreating=!0;var d=null;if(t&&(f.push(t),d=o.assignEventToResource(e,t)),!1===r.trigger("beforeEventAdd",{eventRecord:e,resourceRecords:f,resources:f}))return d&&o.remove(d),!1;r.enableEventAnimations=!1,i.add(e),r.project.commitAsync().then((function(){return r.enableEventAnimations=c})),r.refreshRows()}}},{key:"internalAddEvent",value:(n=Pt()(At.a.mark((function e(t,n,r){var i,o,a,s,l,u,c,f,d;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(i=this).enableEventAnimations,a=i.features,s=i.eventStore,l=i.assignmentStore,u=[n],c=s.createRecord({startDate:t,endDate:Un.add(t,1,i.timeAxis.unit),name:i.L("L{Object.newEvent}")}),f=Boolean(a.eventEdit&&!a.eventEdit.disabled||a.taskEdit&&!a.taskEdit.disabled||a.simpleEventEdit&&!a.simpleEventEdit.disabled),c.isCreating=f,i.onEventCreated(c),d=null,l&&(d=l.assignEventToResource(c,n)),!1!==i.trigger("beforeEventAdd",{eventRecord:c,resourceRecords:u,resources:u})){e.next=8;break}return d&&l.remove(d),e.abrupt("return");case 8:i.enableEventAnimations=!1,s.add(c),i.project.commitAsync().then((function(){return i.enableEventAnimations=o})),i.refreshRows(),f&&i.editEvent(c,n,i.getEventElement(c));case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"isDateRangeAvailable",value:function(e,t,n,r){return this.eventStore.isDateRangeAvailable(e,t,n,r)}},{key:"resumeRefresh",value:(t=Pt()(At.a.mark((function e(t){var n;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(tt()(Ze()(i.prototype),"resumeRefresh",this).call(this,!1),(n=this).refreshSuspended||!t){e.next=7;break}if(n.isEngineReady){e.next=6;break}return n.currentOrientation.refreshAllWhenReady=!0,e.abrupt("return",n.project.commitAsync());case 6:n.isDestroyed||n.refreshWithTransition();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"toggleEmptyText",value:function(){var e,t=this;t.bodyContainer&&mi.toggleClasses(t.bodyContainer,"b-grid-empty",!(t.rowManager.rowCount||null!==(e=t.crudManager)&&void 0!==e&&e.isLoading))}},{key:"getRowHeight",value:function(e){if(this.currentOrientation.calculateRowHeight){var t=this.currentOrientation.calculateRowHeight(e);return this.rowManager.storeKnownHeight(e.id,t),t}}},{key:"calculateRowHeights",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach((function(e){return e&&t.getRowHeight(e)})),n||this.rowManager.estimateTotalHeight(!0)}},{key:"calculateAllRowHeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.store,n=this.rowManager,r=Math.min(t.count,this.preCalculateHeightLimit);if(r){n.clearKnownHeights();for(var i=0;i<r;i++)this.getRowHeight(t.getAt(i));e||n.estimateTotalHeight(!0)}}},{key:"description",get:function(){return this.callback(this.descriptionRenderer,this,[this])}},{key:"stepUnit",get:function(){return"week"}},{key:"getEventRecord",value:function(e){return e=mi.getEventElement(e),this.resolveEventRecord(e)}},{key:"getEventElement",value:function(e){return this.getElementFromEventRecord(e)}},{key:"updateDate",value:function(e){var t=Un.startOf(e,this.stepUnit);this.setTimeSpan(t,Un.add(t,1,this.stepUnit))}},{key:"previous",value:function(){this.date=Un.add(this.startDate,-1,this.stepUnit)}},{key:"next",value:function(){this.date=this.endDate}}],[{key:"$name",get:function(){return"SchedulerBase"}},{key:"type",get:function(){return"schedulerbase"}},{key:"configurable",get:function(){return{date:{value:null,$config:{equal:"date"}},descriptionRenderer:{value:null,$config:null,default:function(e){return"".concat(Un.getLocalizedNameOfUnit("Week")," ").concat(Un.getWeekDescription(e.startDate,e.endDate))}},verticalTimeAxisColumn:{}}}},{key:"defaultConfig",get:function(){return{mode:"horizontal",eventCls:"b-sch-event",timeCellCls:"b-sch-timeaxis-cell",timeCellSelector:".b-sch-timeaxis-cell",scheduledEventName:"event",overScheduledEventClass:"b-sch-event-hover",allowOverlap:!0,rowHeight:60,preCalculateHeightLimit:1e4,crudManagerClass:bx,testConfig:{loadMaskError:{autoClose:10,showDelay:0}}}}},{key:"deprecatedEvents",get:function(){return{eventContextMenuBeforeShow:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`eventContextMenuBeforeShow` event is deprecated, in favor of `eventMenuBeforeShow` event. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."},eventContextMenuShow:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`eventContextMenuShow` event is deprecated, in favor of `eventMenuShow` event. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."},eventContextMenuItem:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`eventContextMenuItem` event is deprecated, in favor of `eventMenuItem` event. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."},scheduleContextMenuBeforeShow:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`scheduleContextMenuBeforeShow` event is deprecated, in favor of `scheduleMenuBeforeShow` event. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."},scheduleContextMenuShow:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`scheduleContextMenuShow` event is deprecated, in favor of `scheduleMenuShow` event. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."},scheduleContextMenuItem:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`scheduleContextMenuItem` event is deprecated, in favor of `scheduleMenuItem` event. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."}}}}]),i}(bT.mixin(zk,CT,ST,BT,zT,GT,FT,WT,qT,ZT));function NO(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return zO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zO(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function zO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function VO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}HO.initClass(),HO._$name="SchedulerBase";var WO={add:1,remove:1,update:1,removeAll:1,filter:1},$O=function(e){Ye()(n,e);var t=VO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;if(e.isVertical)throw new Error("GroupSummary feature is not supported in vertical mode");r.scheduler=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t),!r.summaries&&r.renderer&&(r.summaries=[{renderer:r.renderer}]),r.isScheduler=e instanceof HO,r.isScheduler&&(e.eventStore.on({changePreCommit:r.onEventStoreChange,thisObj:r}),e.on({timeAxisViewModelUpdate:r.onTimeAxisChange,thisObj:r}),e.project.on({dataReady:r.onProjectDataReady,thisObj:r}))}},{key:"doDestroy",value:function(){var e;null===(e=this._tip)||void 0===e||e.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"onTimeAxisChange",value:function(){this.scheduler.rowManager.forEach((function(e){e.isGroupFooter&&e.render()}))}},{key:"onEventStoreChange",value:function(e){var t=e.action,n=e.record,r=e.records,i=e.changes;if(WO[t]){var o,a=this.scheduler.rowManager,s=n?[n]:r,l=new Set;if(s.forEach((function(e){return e.resources.forEach((function(e){return l.add(e)}))})),null!=(null==i||null===(o=i.resourceId)||void 0===o?void 0:o.oldValue)){var u=this.scheduler.resourceStore.getById(i.resourceId.oldValue);u&&l.add(u)}var c,f=NO(l);try{for(f.s();!(c=f.n()).done;){for(var d=c.value,h=a.getRowFor(d);h&&!h.isGroupFooter;)h=a.getRow(h.index+1);h&&this.footersToUpdate.add(h)}}catch(e){f.e(e)}finally{f.f()}}}},{key:"onProjectDataReady",value:function(){var e=this.footersToUpdate;if(e.size){var t,n=NO(e);try{for(n.s();!(t=n.n()).done;){var r,i=t.value;null===(r=i.render)||void 0===r||r.call(i)}}catch(e){n.e(e)}finally{n.f()}e.clear()}}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,r=e.record;if(t.isGroupFooter&&!r.meta.hasOwnProperty("groupFooterFor")){var i=t.elements.normal.querySelector(".b-sch-timeaxis-cell");i&&(i.innerHTML="")}tt()(Ze()(n.prototype),"onBeforeRenderRow",this).apply(this,arguments)}},{key:"generateHtml",value:function(e,t,r,i,o,a){if("timeAxis"===e.type){var s=this,l=s.scheduler,u=l.eventStore,c=l.timeAxisViewModel.columnConfig,f="";if(l.isEngineReady){var d=l.getResourcesEventsPerTick(t,(function(e){var n=e.event;return n.resources.some((function(e){return t.includes(e)}))&&(!u.isFiltered||u.records.includes(n))}));l.timeAxis.forEach((function(e,n){var r=d[n]||[],h=s.summaries.map((function(n){var s=n.renderer({startDate:e.startDate,endDate:e.endDate,resourceStore:l.resourceStore,events:r,resources:t,eventStore:u,groupRecord:i,groupField:o,groupValue:a});return'<div class="b-timeaxis-summary-value">'.concat(s,"</div>")})).join("");f+='<div class="b-timeaxis-tick" style="width: '.concat(c[c.length-1][n].width,'px">').concat(h,"</div>")}))}return'<div class="b-timeaxis-group-summary">'.concat(f,"</div>")}return tt()(Ze()(n.prototype),"generateHtml",this).call(this,e,t,r,i,o,a)}},{key:"updateSummaryHtml",value:function(e,t,r){var i=tt()(Ze()(n.prototype),"updateSummaryHtml",this).call(this,e,t,r);if("timeAxis"===t.type){var o={count:0,height:0};return this.summaries.forEach((function(e){e.height?o.height+=e.height:o.count++})),o}return i}},{key:"getTipHtml",value:function(e){var t=e.activeTarget,n=this,r=Array.from(t.parentElement.children).indexOf(t),i=n.scheduler.timeAxis.getAt(r),o="<header>".concat(n.L("L{Summary.Summary for}",n.scheduler.getFormattedDate(i.startDate)),"</header>"),a=!1;return mi.forEachSelector(t,".b-timeaxis-summary-value",(function(e,t){var r=n._labels[t],i=e.innerText.trim();o+="<label>".concat(r||"",'</label><div class="b-timeaxis-summary-value">').concat(i,"</div>"),e.innerHTML&&(a=!0)})),a?o:null}},{key:"render",value:function(){var e,t=this,n=t.scheduler;t.isScheduler&&(null!==(e=t.summaries)&&void 0!==e&&e.some((function(e){return e.label}))&&t.showTooltip&&!t._tip&&(t._labels=t.summaries.map((function(e){return e.label||""})),t._tip=new kh({id:"".concat(n.id,"-groupsummary-tip"),cls:"b-timeaxis-summary-tip",hoverDelay:0,hideDelay:0,forElement:n.timeAxisSubGridElement,anchorToTarget:!0,forSelector:".b-timeaxis-group-summary .b-timeaxis-tick",clippedBy:[n.timeAxisSubGridElement,n.bodyContainer],getHtml:t.getTipHtml.bind(t)})))}},{key:"removeSummaryElements",value:function(e){var t=e.querySelector(".b-timeaxis-group-summary");null==t||t.remove(),tt()(Ze()(n.prototype),"removeSummaryElements",this).call(this)}},{key:"hasSummary",value:function(e){return tt()(Ze()(n.prototype),"hasSummary",this).call(this,e)||e.isTimeAxisColumn}}],[{key:"$name",get:function(){return"GroupSummary"}},{key:"defaultConfig",get:function(){return{showTooltip:!0,summaries:null,renderer:null}}},{key:"properties",get:function(){return{footersToUpdate:new Set}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),n}(Yy);function UO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}$O._$name="GroupSummary",ty.registerFeature($O,!1,"Scheduler");var GO={maintainVisibleStart:!0},YO=function(e){Ye()(n,e);var t=UO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),this.scheduler=e,z.a.deprecate("Scheduler","5.0.0","`HeaderContextMenu` feature is deprecated, in favor of `TimeAxisHeaderMenu` feature. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."),e.features.timeAxisHeaderMenu&&(e.features.timeAxisHeaderMenu.disabled=!0),e.features.headerMenu&&(e.features.headerMenu._showForTimeAxis=!0)}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=e.menu,i=this;if("timeAxis"===t.type){r&&(r.scrollAction="realign"),Qn.merge(n,i.defaultItems);var o=Qn.transformNamedObjectToArray(n);i.extraItems&&o.push.apply(o,F()(i.extraItems)),i.processItems&&i.processItems({items:o});var a=Qn.transformArrayToNamedObject(o);Qn.removeAllProperties(n),Qn.merge(n,a)}}},{key:"defaultItems",get:function(){var e=this,t=e.scheduler,n=t.timeAxis,r={magnitude:n.shiftIncrement,unit:n.shiftUnit},i={};return i.pickZoomLevel={text:"L{pickZoomLevel}",localeClass:this,icon:"b-fw-icon b-icon-search-plus",disabled:!t.presets.count||e.disabled,menu:{type:"popup",items:[{type:"slider",minWidth:130,showValue:!1}],onBeforeShow:function(n){var r=n.source,i=N()(r.items,1)[0];i.min=t.minZoomLevel,i.max=t.maxZoomLevel,i.value=t.zoomLevel,e.zoomDetatcher=i.on("input","onZoomSliderChange",e)},onHide:function(){e.zoomDetatcher&&(e.zoomDetatcher(),e.zoomDetatcher=null)}}},e.startDateField=new $v({label:e.L("L{startText}"),labelWidth:"6em",required:!0,step:r,listeners:{change:e.onRangeDateFieldChange,thisObj:e}}),e.endDateField=new $v({label:e.L("L{endText}"),labelWidth:"6em",required:!0,step:r,listeners:{change:e.onRangeDateFieldChange,thisObj:e}}),i.activeDateRange={text:"L{activeDateRange}",localeClass:this,icon:"b-fw-icon b-icon-calendar",disabled:e.disabled,menu:{type:"popup",width:"20em",items:[e.startDateField,e.endDateField,{type:"button",cls:"b-left-nav-btn",icon:"b-icon b-icon-prev",color:"b-blue b-raised",flex:1,margin:0,listeners:{click:e.onLeftShiftBtnClick,thisObj:e}},{type:"button",cls:"b-today-nav-btn",color:"b-blue b-raised",text:"L{todayText}",localeClass:this,flex:4,margin:"0 8",listeners:{click:e.onTodayBtnClick,thisObj:e}},{type:"button",cls:"b-right-nav-btn",icon:"b-icon b-icon-next",color:"b-blue b-raised",flex:1,listeners:{click:e.onRightShiftBtnClick,thisObj:e}}],onBeforeShow:function(){return e.initDates()}}},i}},{key:"onZoomSliderChange",value:function(e){var t=e.value;this.scheduler.zoomLevel=t}},{key:"initDates",value:function(){var e=this;e.startDateField.suspendEvents(),e.endDateField.suspendEvents(),e.startDateField.value=e.startDateFieldInitialValue=e.scheduler.startDate,e.endDateField.value=e.endDateFieldInitialValue=e.scheduler.endDate,e.startDateField.resumeEvents(),e.endDateField.resumeEvents()}},{key:"onRangeDateFieldChange",value:function(e){var t=this,n=e.source===t.startDateField,r=t.client,i=r.timeAxis,o=t.startDateFieldInitialValue&&!n?t.startDateFieldInitialValue:t.startDateField.value,a=t.endDateFieldInitialValue&&n?t.endDateFieldInitialValue:t.endDateField.value;n?t.startDateFieldInitialValue=null:t.endDateFieldInitialValue=null,a-o?a<o&&(a=Un.add(o,i.shiftIncrement,i.shiftUnit)):a=Un.add(a,i.shiftIncrement,i.shiftUnit),r.setTimeSpan(o,a,GO),t.initDates()}},{key:"onLeftShiftBtnClick",value:function(){this.scheduler.timeAxis.shiftPrevious(),this.initDates()}},{key:"onTodayBtnClick",value:function(){var e=Un.clearTime(new Date);this.scheduler.setTimeSpan(e,Un.add(e,1,"day")),this.initDates()}},{key:"onRightShiftBtnClick",value:function(){this.scheduler.timeAxis.shiftNext(),this.initDates()}}],[{key:"$name",get:function(){return"HeaderContextMenu"}},{key:"defaultConfig",get:function(){return{extraItems:null,processItems:null}}},{key:"pluginConfig",get:function(){return{chain:["populateHeaderMenu"]}}}]),n}(_i);function qO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}YO.featureClass="",YO._$name="HeaderContextMenu",ty.registerFeature(YO);var KO=function(e){Ye()(n,e);var t=qO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;if(!e.touches&&0===e.button&&!t.disabled&&e.target.closest(".b-sch-header-timeaxis-cell")){var r=n.subGrids.normal.header.headersElement;t.startX=e.clientX,t.element=mi.createElement({parent:r,tag:"div",className:"b-headerzoom-rect"}),t.headerElementRect=Cr.from(r)}}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||pe.a.isSafari||pe.a.isIE11&&!e.isTrusted){if("number"==typeof t.startX){var n=Math.max(e.clientX,t.headerElementRect.left),r=Math.min(t.startX,n),i=Math.abs(t.startX-n),o=new Cr(r-t.headerElementRect.x+t.client.scrollLeft,0,i,t.headerElementRect.height);mi.setTranslateX(t.element,o.left),t.element.style.width=o.width+"px"}}else t.onElementMouseUp(e)}},{key:"onElementMouseUp",value:function(e){var t=this;if("number"==typeof t.startX){var n=t.client,r=Cr.from(t.element),i=n.getDateFromCoordinate(r.left,"round",!1),o=n.getDateFromCoordinate(r.right,"round",!1);t.element&&t.element.remove(),t.startX=null,t.client.zoomToSpan({startDate:i,endDate:o})}}}],[{key:"$name",get:function(){return"HeaderZoom"}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),n}(_i);KO._$name="HeaderZoom",ty.registerFeature(KO,!1,"Scheduler");n(263);function XO(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ZO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZO(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ZO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function JO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var QO=["top","left","right","bottom"],eM={top:"b-b",right:"l-l",bottom:"t-t",left:"r-r"},tM={top:1,bottom:1},nM={estimate:1,measure:1},rM={left:1,right:1},iM=function(e){Ye()(n,e);var t=JO(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;if(e.isVertical)throw new Error("Labels feature is not supported in vertical mode");r.scheduler=e,tt()(Ze()(n.prototype),"construct",this).call(this,e,t),(r.top||r.bottom||r.left||r.right)&&r.updateHostClasslist()}},{key:"updateHostClasslist",value:function(){var e=this.top,t=this.bottom,n=this.scheduler.element.classList;n.remove("b-labels-topbottom"),n.remove("b-labels-top"),n.remove("b-labels-bottom"),(e||t)&&(n.add("b-labels-topbottom"),e&&n.add("b-labels-top"),t&&n.add("b-labels-bottom"))}},{key:"onLabelDblClick",value:function(e){var t=this,n=e.target;if(n&&!t.scheduler.readOnly){var r=n.dataset.side,i=t[r],o=i.editor,a=i.field;if(o){var s=this.scheduler.resolveEventRecord(e.target);return o instanceof sp||(i.editor=new sp({appendTo:t.scheduler.element,blurAction:t.blurAction,inputField:o,scrollAction:"realign"})),i.editor.startEdit({target:n,align:eM[r],matchSize:!1,record:s,field:a}),e.stopImmediatePropagation(),!1}}}},{key:"changeTop",value:function(e){return this.processLabelSpec(e,"top")}},{key:"updateTop",value:function(){this.updateHostClasslist()}},{key:"changeRight",value:function(e){return this.processLabelSpec(e,"right")}},{key:"updateRight",value:function(){this.updateHostClasslist()}},{key:"changeBottom",value:function(e){return this.processLabelSpec(e,"bottom")}},{key:"updateBottom",value:function(){this.updateHostClasslist()}},{key:"changeLeft",value:function(e){return this.processLabelSpec(e,"left")}},{key:"updateLeft",value:function(){this.updateHostClasslist()}},{key:"processLabelSpec",value:function(e,t){if("function"==typeof e)e={renderer:e};else if("string"==typeof e)e={field:e};else{if(!e)return null;e=Object.setPrototypeOf({},e)}var n=this.scheduler,r=n.eventStore,i=n.resourceStore,o=n.taskStore,a=(n.id,e),s=a.field,l=a.editor;if(tM[t]&&(n.milestoneWidth=null),e.recordType=r&&!o?"event":"task",s){var u;r&&!o&&((u=r.modelClass.fieldMap[s])?(e.fieldDef=u,e.recordType="event",!0):Reflect.has(r.modelClass.prototype,s)&&(e.recordType="event",!0)),!u&&o&&((u=o.modelClass.fieldMap[s])?(e.fieldDef=u,e.recordType="task",!0):Reflect.has(i.modelClass.prototype,s)&&(e.recordType="task",!0)),!u&&i&&((u=i.modelClass.fieldMap[s])?(e.fieldDef=u,e.recordType="resource",!0):Reflect.has(i.modelClass.prototype,s)&&(e.recordType="resource",!0)),l&&("boolean"==typeof l?n.editor={type:"textfield"}:"string"==typeof l&&(n.editor={type:l}),Tu.on({element:n.timeAxisSubGrid.element,delegate:".b-sch-label",dblclick:"onLabelDblClick",thisObj:this}))}return e}},{key:"doDisable",value:function(e){tt()(Ze()(n.prototype),"doDisable",this).call(this,e),this.client.isPainted&&this.client.refresh()}},{key:"generateLabelConfigs",value:function(e){var t,n=this,r=[],i=XO(QO);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(n[o]){var a,s,l=n[o],u=l.field,c=l.fieldDef,f=l.recordType,d=l.renderer,h=l.thisObj,v={tag:"label",className:(a={},Qe()(a,n.labelCls,1),Qe()(a,"".concat(n.labelCls,"-").concat(o),1),a),dataset:{side:o,taskFeature:"label-".concat(o)}},p=void 0,g="".concat(f,"Record"),y=e[g];if(d)p=d.call(h||n.thisObj||n,(s={},Qe()(s,g,y),Qe()(s,"resourceRecord",e.resourceRecord),Qe()(s,"assignmentRecord",e.assignmentRecord),Qe()(s,"domConfig",v),s));else p=y[u],p="date"!==(null==c?void 0:c.type)||d?te.encodeHtml(p):Un.format(p,n.client.displayDateFormat);v.html=p||" ",r.push(v)}}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"measureLabels",value:function(e,t){var n,r=this,i=r.client.timeAxisViewModel.getSingleUnitInPixels("millisecond"),o=XO(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(rM[a.dataset.side]){var s=a.html,l=0;if("estimate"===r.labelLayoutMode)s.includes("<")&&(s=mi.stripTags(s)),l=s.length*r.labelCharWidth+18;else{var u=r.labelMeasureElement||(r.labelMeasureElement=mi.createElement({className:"b-sch-event-wrap b-measure-label",parent:r.client.foregroundCanvas}));u.retainElement=!0,du.sync({targetElement:u,childrenOnly:!0,domConfig:{children:[a]}}),l=u.firstElementChild.offsetWidth}var c=l/i;switch(a.dataset.side){case"left":t.startMS-=c;break;case"right":t.endMS+=c}}}}catch(e){o.e(e)}finally{o.f()}}},{key:"onEventDataGenerated",value:function(e){if(!this.disabled){var t,n=this.generateLabelConfigs(e);nM[this.labelLayoutMode]&&this.measureLabels(n,e),(t=e.wrapperChildren).push.apply(t,F()(n))}}},{key:"updateLabelLayoutMode",value:function(){this.isConfiguring||this.client.refreshWithTransition()}},{key:"updateLabelCharWidth",value:function(){this.isConfiguring||this.client.refreshWithTransition()}}],[{key:"$name",get:function(){return"Labels"}},{key:"configurable",get:function(){return{labelCls:"b-sch-label",top:null,right:null,bottom:null,left:null,thisObj:null,blurAction:"cancel",labelLayoutMode:"default",labelCharWidth:7}}},{key:"pluginConfig",get:function(){return{chain:["onEventDataGenerated"]}}}]),n}(_i);function oM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}iM.featureClass="b-sch-labels",iM._$name="Labels",ty.registerFeature(iM,!1,"Scheduler");var aM=function(e){Ye()(n,e);var t=oM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"doDestroy",value:function(){this.attachToCalendar(null),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"attachToProject",value:function(e){var t=this;tt()(Ze()(n.prototype),"attachToProject",this).call(this,e),this.attachToCalendar(e.effectiveCalendar),e.on({name:"project",calendarChange:function(){return t.attachToCalendar(t.project.effectiveCalendar)},thisObj:this})}},{key:"onTimeAxisViewModelUpdate",value:function(){return this._timeAxisUnitDurationMs=null,tt()(Ze()(n.prototype),"onTimeAxisViewModelUpdate",this).call(this)}},{key:"updateLocalization",value:function(){var e;if(null===(e=tt()(Ze()(n.prototype),"updateLocalization",this))||void 0===e||e.call(this),this.autoGeneratedWeekends&&this.calendar){var t=this.defaultNonWorkingIntervals,r=Boolean(t.length);this.calendar.clearIntervals(r),r&&this.calendar.addIntervals(t)}}},{key:"attachToCalendar",value:function(e){var t=this,n=t.project,r=t.client;if(t.detachListeners("calendar"),t.autoGeneratedWeekends=!1,e){if(!r.isSchedulerPro&&!r.isGantt&&e===n.defaultCalendar&&!n.defaultCalendar.intervalStore.count){var i=t.defaultNonWorkingIntervals;i.length&&(e.addIntervals(i),t.autoGeneratedWeekends=!0)}e.intervalStore.on({name:"calendar",change:function(){return t.setTimeout("renderRanges",1)}})}r.isEngineReady?t.renderRanges():n.isDestroyed||(t.detachListeners("initialProjectListener"),n.on({name:"initialProjectListener",refresh:t.renderRanges,thisObj:t,once:!0}))}},{key:"defaultNonWorkingIntervals",get:function(){var e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return Un.nonWorkingDaysAsArray.map((function(t){return{recurrentStartDate:"on ".concat(e[t]," at 0:00"),recurrentEndDate:"on ".concat(e[(t+1)%7]," at 0:00"),isWorking:!1}}))}},{key:"calendar",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.effectiveCalendar}},{key:"timeAxisUnitDurationMs",get:function(){return this._timeAxisUnitDurationMs||(this._timeAxisUnitDurationMs=Un.as("ms",1,this.client.timeAxis.unit)),this._timeAxisUnitDurationMs}},{key:"shouldRenderRange",value:function(e){return tt()(Ze()(n.prototype),"shouldRenderRange",this).call(this,e)&&e.durationMS>=this.timeAxisUnitDurationMs}},{key:"renderRanges",value:function(){var e=this,t=e.store,r=e.calendar,i=e.client,o=i.timeAxis,a=i.foregroundCanvas;if(r&&a&&t&&!t.isDestroyed){if(!e.disabled){var s=!e.maxTimeAxisUnit||Un.compareUnits(o.unit,e.maxTimeAxisUnit)<=0;if(t.removeAll(!0),r&&e.highlightWeekends&&s&&o.count){var l,u=r.getNonWorkingTimeRanges(o.startDate,o.endDate).map((function(e,t){return{name:e.name,cls:"b-nonworkingtime",startDate:e.startDate,endDate:e.endDate}})),c=[];u.forEach((function(e){l&&e.startDate<=l.endDate&&e.name===l.name?l.endDate=e.endDate:(c.push(e),e.id="nonworking-".concat(c.length),l=e)})),t.add(c,!0)}}tt()(Ze()(n.prototype),"renderRanges",this).call(this)}}}],[{key:"$name",get:function(){return"NonWorkingTime"}},{key:"defaultConfig",get:function(){return{highlightWeekends:!0,showHeaderElements:!0,showLabelInBody:!0,cls:"b-sch-nonworkingtime",maxTimeAxisUnit:"week",autoGeneratedWeekends:!1}}},{key:"pluginConfig",get:function(){return{chain:["onPaint","attachToProject","updateLocalization"]}}}]),n}(wE.mixin(Px));function sM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}aM._$name="NonWorkingTime",ty.registerFeature(aM,!1,"Scheduler"),ty.registerFeature(aM,!0,["SchedulerPro","Gantt","ResourceHistogram"]);var lM=function(e){Ye()(n,e);var t=sM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){this.timeline=e;this.targetSelector=[".b-grid-cell",".b-timeline-subgrid"].join(","),tt()(Ze()(n.prototype),"construct",this).call(this,e,t)}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.timeline,r=Object.values(n.features).find((function(e){return e instanceof Wx})),i=n.readOnly||!r||r.disabled;e.touches||0!==e.button||t.disabled||(e.target.matches(t.targetSelector)||i&&e.target.closest(n.eventSelector))&&(t.mouseX=e.clientX,t.mouseY=e.clientY)}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||pe.a.isSafari||pe.a.isIE11&&!e.isTrusted){if("number"==typeof t.mouseX){var n=t.timeline.subGrids.normal.scrollable,r=t.timeline.scrollable,i=e.clientX,o=e.clientY;e.preventDefault(),t.vertical&&r.scrollBy(0,t.mouseY-o),n.scrollBy(t.mouseX-i),t.mouseX=i,t.mouseY=o}}else t.onElementMouseUp()}},{key:"onElementMouseUp",value:function(e){this.mouseX=this.mouseY=null}}],[{key:"$name",get:function(){return"Pan"}},{key:"defaultConfig",get:function(){return{vertical:!0}}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),n}(_i);function uM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}lM._$name="Pan",ty.registerFeature(lM,!1,["Scheduler","Gantt"]);var cM=function(e){Ye()(n,e);var t=uM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"attachToProject",value:function(e){var t=this,r=t.scheduler;if(tt()(Ze()(n.prototype),"attachToProject",this).call(this,e),!e.resourceTimeRangeStore){e.resourceTimeRangeStore=t._store||r.resourceTimeRangeStore||new bS({owner:t});var i=r.crudManager;i&&!i.resourceTimeRangeStore&&(i.resourceTimeRangeStore=e.resourceTimeRangeStore)}var o=e.resourceTimeRangeStore;t.exposedOnScheduler||(r.resourceTimeRanges&&(o.add(r.resourceTimeRanges),delete r.resourceTimeRanges),Object.defineProperty(r,"resourceTimeRanges",{get:function(){return o.records},set:function(e){return o.data=e}}),t.exposedOnScheduler=!0),o.resourceStore||(o.resourceStore=e.resourceStore),t.detachListeners("store"),o.on({name:"store",change:t.onStoreChange,thisObj:t})}},{key:"store",get:function(){return this.project.resourceTimeRangeStore},set:function(e){this._store=e}},{key:"getEventsToRender",value:function(e,t){var n=e.timeRanges;if(null!=n&&n.length&&!this.disabled){var r=this.client,i=r.startDate,o=r.endDate;n.forEach((function(e){e.isRecurring?t.push.apply(t,F()(e.getOccurrencesForDateRange(i,o))):t.push(e)}))}return t}},{key:"shouldInclude",value:function(e){return e.isResourceTimeRange&&!e.isNonWorking}},{key:"doDestroy",value:function(){var e;(null===(e=this.store)||void 0===e?void 0:e.owner)===this&&this.store.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}}],[{key:"$name",get:function(){return"ResourceTimeRanges"}},{key:"defaultConfig",get:function(){return{idPrefix:"resourcetimerange",rangeCls:"b-sch-resourcetimerange",store:!1,resourceTimeRanges:null}}}]),n}(lE);function fM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}cM.featureClass="",cM._$name="ResourceTimeRanges",ty.registerFeature(cM,!1,"Scheduler");var dM=function(e){Ye()(n,e);var t=fM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"shouldShowMenu",value:function(e){var t=this.client,n=e.column,r=e.targetElement,i=e.resourceRecord;return(n?n===t.timeAxisColumn:t.timeAxisSubGrid.element===r)&&!(i&&i.isSpecialRow)}},{key:"getDataFromEvent",value:function(e){if(mi.isDOMEvent(e)){var t=this.client,r=t.getCellDataFromEvent(e),i=t.getDateFromDomEvent(e,"floor"),o=t.resolveResourceRecord(e)||t.isVertical&&t.resourceStore.last;return Qn.assign(tt()(Ze()(n.prototype),"getDataFromEvent",this).call(this,e),r,{date:i,resourceRecord:o})}return e}},{key:"populateScheduleMenu",value:function(e){var t=e.items,n=e.resourceRecord,r=this.client;!r.readOnly&&r.eventStore&&(t.addEvent={text:"L{SchedulerBase.Add event}",icon:"b-icon b-icon-add",disabled:!n||n.readOnly,weight:100,onItem:function(e){var t=e.date,n=e.resourceRecord;r.internalAddEvent(t,n,r.getRowFor(n))}})}}],[{key:"$name",get:function(){return"ScheduleMenu"}},{key:"defaultConfig",get:function(){return{type:"schedule",items:null,processItems:null}}},{key:"pluginConfig",get:function(){var e=tt()(Ze()(n),"pluginConfig",this);return e.chain.push("populateScheduleMenu"),e}}]),n}(cE);function hM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}dM.featureClass="",dM._$name="ScheduleMenu",ty.registerFeature(dM,!0,"Scheduler");var vM=function(e){Ye()(n,e);var t=hM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),this.scheduler=e,z.a.deprecate("Scheduler","5.0.0","`ScheduleContextMenu` feature is deprecated, in favor of `ScheduleMenu` feature. Please see https://bryntum.com/docs/scheduler/#Scheduler/guides/upgrades/3.1.0.md for more information."),e.features.scheduleMenu&&(e.features.scheduleMenu.disabled=!0)}}],[{key:"$name",get:function(){return"ScheduleContextMenu"}}]),n}(dM);function pM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}vM.featureClass="",vM._$name="ScheduleContextMenu",ty.registerFeature(vM);var gM=function(e){Ye()(n,e);var t=pM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onPaint",value:function(e){if(e.firstPaint){var t,n=this,r=n.client,i=n.hoverTip=new kh({id:"".concat(r.id,"-schedule-tip"),cls:"b-sch-scheduletip",allowOver:!0,hoverDelay:0,hideDelay:100,showOnHover:!0,forElement:r.timeAxisSubGridElement,anchorToTarget:!1,trackMouse:!0,updateContentOnMouseMove:!0,monitorResize:!1,textContent:!1,forSelector:".b-schedulerbase:not(.b-dragging-event):not(.b-dragcreating) .b-grid-body-container:not(.b-scrolling) .b-timeline-subgrid:not(.b-scrolling) > :not(.b-sch-foreground-canvas):not(.b-group-footer):not(.b-group-row) *",constrainTo:null,getHtml:n.getHoverTipHtml.bind(n),onDocumentMouseDown:function(e){i.forElement.contains(e.event.target)&&(t=Tu.on({element:r.timeAxisSubGridElement,mousemove:function(e){return i.internalOnPointerOver(e)},capture:!0}));var n=i.hideAnimation;i.hideAnimation=!1,i.constructor.prototype.onDocumentMouseDown.call(i,e),i.hideAnimation=n},listeners:{pointerover:function(e){var r=e.event,i="buttons"in r?r.buttons>0:r.which>0;return!i&&t&&t(),!n.disabled&&!i}}});(r.isHorizontal?r.timeAxisSubGrid.scrollable:r.scrollable).on({scroll:n.updateTip,thisObj:n}),r.on({timeAxisViewModelUpdate:n.updateTip,thisObj:n}),n.clockTemplate=new Hx({scheduler:r})}}},{key:"updateTip",value:function(){this.hoverTip.isVisible&&this.hoverTip.updateContent()}},{key:"doDestroy",value:function(){this.destroyProperties("clockTemplate","hoverTip"),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"getHoverTipHtml",value:function(e){var t=e.tip,n=e.event,r=this,i=r.client,o=n&&i.getDateFromDomEvent(n,"floor",!0),a=r.lastHtml;if(o){var s=i.resolveResourceRecord(n);!s||o-r.lastTime==0&&s.id===r.lastResourceId||(r.lastResourceId=s.id,a=r.lastHtml=r.generateTipContent({date:o,event:n,resourceRecord:s}))}else t.hide(),r.lastTime=null,r.lastResourceId=null;return a}},{key:"generateTipContent",value:function(e){var t=e.date,n=e.event,r=e.resourceRecord,i=this,o=i.clockTemplate.generateContent({date:t,text:i.client.getFormattedDate(t)}),a=i.messageTemplate({message:i.getText(t,n,r)||""});return i.lastTime=t,o+a}},{key:"getText",value:function(e,t,n){}}],[{key:"$name",get:function(){return"ScheduleTooltip"}},{key:"defaultConfig",get:function(){return{messageTemplate:function(e){return'<div class="b-sch-hovertip-msg">'.concat(e.message,"</div>")}}}},{key:"pluginConfig",get:function(){return{chain:["onPaint"]}}}]),n}(_i);function yM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}gM.featureClass="b-scheduletip",gM._$name="ScheduleTooltip",ty.registerFeature(gM,!0,"Scheduler");var mM=function(e){Ye()(n,e);var t=yM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r,i=this;i.scheduler=e,e.eventEdit=i,tt()(Ze()(n.prototype),"construct",this).call(this,e,t),i.clientListenersDetacher=e.on((r={},Qe()(r,i.triggerEvent,(function(e){var t=e.eventRecord,n=e.eventElement;return i.editEvent(t,t.resource,n)})),Qe()(r,"dragcreateend",i.onDragCreateEnd),Qe()(r,"thisObj",i),r))}},{key:"doDestroy",value:function(){var e;this.clientListenersDetacher(),null===(e=this.editor)||void 0===e||e.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}},{key:"eventStore",get:function(){return this.scheduler.eventStore}},{key:"editEvent",value:function(e,t,n){var r=this,i=r.scheduler;i.readOnly||r.disabled||(n=mi.down(n,i.eventInnerSelector)||n,e=e.isAssignment?e.event:e,r.resource=t,r.event=e,r.element=n,i.element.classList.add("b-eventeditor-editing"),r.editor||(r.editor=sp.new({owner:i.timeAxisSubGrid,appendTo:i.timeAxisSubGridElement,scrollAction:"realign",cls:"b-simpleeventeditor",listeners:{complete:"onEditorComplete",cancel:"onEditorCancel",thisObj:r}},r.editorConfig),r.relayEvents(r.editor,["beforestart","start","beforecomplete","complete","beforecancel","cancel"])),e.isCreating&&(e.name=""),r.editor.startEdit({target:n,record:e,field:r.field}),r.scheduler.navigator.disabled=!0)}},{key:"onEditorComplete",value:function(){this.event.isCreating=!1,this.reset()}},{key:"onEditorCancel",value:function(){this.event.isCreating&&this.event.remove(),this.reset()}},{key:"reset",value:function(){this.scheduler.element.classList.remove("b-eventeditor-editing"),this.scheduler.navigator.disabled=!1,this.event=null,this.resource=null}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord,r=t?this.scheduler.getElementFromAssignmentRecord(t):this.scheduler.getElementFromEventRecord(n),i=(t||n).resource;this.editEvent(n,i,r)}},{key:"onDragCreateEnd",value:function(e){var t=e.eventRecord,n=e.resourceRecord,r=e.proxyElement;this.element=r,this.editEvent(t,n,r)}}],[{key:"$name",get:function(){return"SimpleEventEdit"}},{key:"defaultConfig",get:function(){return{triggerEvent:"eventdblclick",eventRecord:null,field:"name",editorConfig:null}}},{key:"pluginConfig",get:function(){return{chain:["onEventEnterKey","editEvent"]}}}]),n}(_i);function bM(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return kM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kM(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function kM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}mM._$name="SimpleEventEdit",ty.registerFeature(mM,!1,"Scheduler");var CM={width:0,height:0},RM=function(e){Ye()(n,e);var t=wM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){tt()(Ze()(n.prototype),"construct",this).call(this,e,t),this.toUpdate=new Set,e.on({horizontalScroll:"onSchedulerScroll",scroll:"onSchedulerScroll",thisObj:this,prio:1e4})}},{key:"onEventDataGenerated",value:function(e){this.syncEventContentPosition(e),this.updateStyles()}},{key:"onSchedulerScroll",value:function(e){var t=e.subGrid,n=this.client,r=n.isHorizontal?"horizontalSyncAllEventsContentPosition":"verticalSyncAllEventsContentPosition";n.isHorizontal&&t&&!t.isTimeAxisSubGrid||this[r](n)}},{key:"updateStyles",value:function(){var e,t=bM(this.toUpdate);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=n.contentEl,i=n.style;mi.applyStyle(r,i)}}catch(e){t.e(e)}finally{t.f()}this.toUpdate.clear()}},{key:"horizontalSyncAllEventsContentPosition",value:function(e){var t=e.rowManager.rows,n=e.currentOrientation.resourceMap;if(n.size)for(var r=0,i=t.length;r<i;r++){var o,a=null===(o=n.get(t[r].id))||void 0===o?void 0:o.eventsData;if(null!=a&&a.length)for(var s=0,l=a.length;s<l;s++){var u,c=a[s],f=[c];if(c.eventRecord.isResourceTimeRange)f.push(null===(u=c.elementConfig)||void 0===u?void 0:u.children[0]);this.syncEventContentPosition.apply(this,f)}}this.updateStyles()}},{key:"verticalSyncAllEventsContentPosition",value:function(e){var t,n=bM(e.currentOrientation.resourceMap.values());try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0,o=Object.values(r);i<o.length;i++){var a=o[i],s=a.renderData,l=a.elementConfig,u=[s];l&&s.eventRecord.isResourceTimeRange&&u.push(l.children[0]),this.syncEventContentPosition.apply(this,u)}}catch(e){n.e(e)}finally{n.f()}this.updateStyles()}},{key:"onEventDrag",value:function(e){var t=this.client,n=t.isHorizontal,r="offset".concat(n?"Width":"Height"),i=n?t.timeAxisSubGrid.scrollable.x:t.scrollable.y,o=e.querySelector(".b-sch-event-content"),a=mi[n?"getTranslateX":"getTranslateY"](e),s=a+e[r]-1,l=n?"X":"Y",u=e[r],c=null==o?void 0:o[r];if(!e.classList.contains("b-milestone-wrap")&&c&&a<i&&s>=i){var f=this.getEventContentMargins(o)[n?"width":"height"],d="center"===(o&&mi.getStyleValue(o.parentNode,"justifyContent"))?(u-c)/2:0,h=u-c-f,v=Math.min(i-a,h-2)-d;mi.applyStyle(o,{transform:v>0?"translate".concat(l,"(").concat(v,"px)"):""})}}},{key:"syncEventContentPosition",value:function(e){var t,n,r,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.eventContent;if(!(!1===e.eventRecord.stickyContents||null!==(t=e.elementConfig)&&void 0!==t&&null!==(n=t._element)&&void 0!==n&&n.lastDomConfig.isReleased)){var s=this.client,l=s.isHorizontal,u=e.elementConfig,c=l?s.timeAxisSubGrid.scrollable.x:s.scrollable.y,f=null==u||null===(r=u.children[0])||void 0===r?void 0:r.children[0],d=("b-sch-event-content"===(null==f?void 0:f.className)&&f._element?f._element:a._element)||(null===(i=s.getEventElement(e.eventRecord))||void 0===i?void 0:i.querySelector(".b-sch-event-content")),h=null==d?void 0:d.offsetWidth,v=(null==d?void 0:d.parentNode)&&mi.getStyleValue(d.parentNode,"justifyContent"),p="center"===v?(e.width-h)/2:0,g=l?e.left+p:e.top,y=g+(l?e.width:e.height)-1,m=l?"X":"Y";if((null==u?void 0:u.dataset.syncId)==(null==u||null===(o=u._element)||void 0===o?void 0:o.dataset.syncId)&&(null==d||!d.parentElement.parentElement.classList.contains("b-dragging"))){var b="string"==typeof a.style?a.style=mi.parseStyle(a.style):a.style||(a.style={});if(!e.eventRecord.isMilestone&&(!d||h)&&g<c&&y>=c){var k=this.getEventContentMargins(d),w=d?(l?e.width-h-k.width:e.height-d.offsetHeight-k.height)-p:Number.MAX_SAFE_INTEGER,C=Math.min(c-g,w-2);b.transform=C>0?"translate".concat(m,"(").concat(C,"px)"):""}else b.transform="";d&&this.toUpdate.add({contentEl:d,style:b})}}}},{key:"getEventContentMargins",value:function(e){return null!=e&&e.classList.contains("b-sch-event-content")?mi.getEdgeSize(e,"margin"):CM}}],[{key:"$name",get:function(){return"StickyEvents"}},{key:"type",get:function(){return"stickyEvents"}},{key:"pluginConfig",get:function(){return{chain:["onEventDataGenerated"]}}}]),n}(_i);function SM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}RM._$name="StickyEvents",ty.registerFeature(RM,!0,"Scheduler"),ty.registerFeature(RM,!1,"ResourceHistogram");var xM=function(e){Ye()(n,e);var t=SM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;r.scheduler=e,e.isVertical&&(e.timeAxisSubGrid.resizable=!1,t.hideFooters=!0,e.add(e.createSubGrid("right")),r.summaryColumn=e.columns.add(Qn.assign({filterable:null,region:"right",cellCls:"b-grid-footer b-sch-summarybar",align:"center",sortable:!1,groupable:!1,htmlEncode:!1,enableHeaderContextMenu:!1,hidden:r.disabled},r.verticalSummaryColumnConfig))[0]),tt()(Ze()(n.prototype),"construct",this).call(this,e,t),r.summaries||(r.summaries=[{renderer:r.renderer}]),e instanceof HO&&(r.updateEventStore(e.eventStore),r.updateResourceStore(e.resourceStore),r.updateProject(e.project),e.on({timeAxisViewModelUpdate:r.renderRows,thisObj:r}))}},{key:"updateProject",value:function(e){this.detachListeners("summaryProject"),e.on({name:"summaryProject",dataReady:"updateScheduleSummaries",thisObj:this})}},{key:"updateEventStore",value:function(e){this.detachListeners("summaryEventStore"),e.on({name:"summaryEventStore",filter:"updateScheduleSummaries",thisObj:this})}},{key:"updateResourceStore",value:function(e){this.detachListeners("summaryResourceStore"),e.on({name:"summaryResourceStore",filter:"updateScheduleSummaries",thisObj:this})}},{key:"renderRows",value:function(){this.scheduler.isHorizontal&&this.scheduler.timeAxisSubGrid.footer.element.querySelector(".b-grid-footer").classList.add("b-sch-summarybar"),tt()(Ze()(n.prototype),"renderRows",this).call(this),this.disabled||this.render()}},{key:"updateScheduleSummaries",value:function(){var e=this,t=e.scheduler,n=t.eventStore,r=t.timeAxis,i=e.summaryBarElement,o=e.selectedOnly&&t.selectedRecords.length?t.selectedRecords:t.resourceStore.records;if(i&&t.isEngineReady){var a=t.getResourcesEventsPerTick(o,(function(e){var t=e.event;return!n.isFiltered||n.records.includes(t)}));Array.from(i.children).forEach((function(i,o){var s=r.getAt(o),l=a[o]||[],u="",c="<header>".concat(e.L("L{Summary for}",t.getFormattedDate(s.startDate)),"</header>");e.summaries.forEach((function(r){var o=r.renderer({startDate:s.startDate,endDate:s.endDate,resourceStore:t.resourceStore,eventStore:n,events:l,element:i}),a='<div class="b-timeaxis-summary-value">'.concat(o,"</div>");(e.summaries.length>1||""!==o)&&(u+=a),c+="<label>".concat(r.label||"","</label>")+a})),i.innerHTML=u,i._tipHtml=c}))}}},{key:"summaryBarElement",get:function(){return this.scheduler.element.querySelector(".b-sch-summarybar")}},{key:"render",value:function(){var e=this,t=e.scheduler,n=t.isHorizontal?"width":"height",r=t.timeAxisViewModel.columnConfig,i=e.summaryBarElement;i&&(!e._tip&&e.showTooltip&&e.summaries.some((function(e){return e.label}))&&(e._tip=new kh({id:"".concat(t.id,"-summary-tip"),cls:"b-timeaxis-summary-tip",hoverDelay:0,hideDelay:100,forElement:i,anchorToTarget:!0,trackMouse:!1,forSelector:".b-timeaxis-tick",getHtml:function(e){return e.activeTarget._tipHtml}})),i.innerHTML=r[r.length-1].map((function(e){return'<div class="b-timeaxis-tick" style="'.concat(n,": ").concat(e.width,'px"></div>')})).join(""),e.updateScheduleSummaries())}},{key:"refresh",value:function(){tt()(Ze()(n.prototype),"refresh",this).call(this),this.updateScheduleSummaries()}},{key:"doDisable",value:function(e){var t,r=this.scheduler.isConfiguring;tt()(Ze()(n.prototype),"doDisable",this).call(this,e),null===(t=this.summaryColumn)||void 0===t||t.toggle(!e),r||e||this.render()}},{key:"doDestroy",value:function(){var e;null===(e=this._tip)||void 0===e||e.destroy(),tt()(Ze()(n.prototype),"doDestroy",this).call(this)}}],[{key:"$name",get:function(){return"Summary"}},{key:"configurable",get:function(){return{showTooltip:!0,summaries:null,renderer:null,verticalSummaryColumnConfig:null}}},{key:"pluginConfig",get:function(){return{chain:["renderRows","bindStore","updateEventStore","updateResourceStore","updateProject"]}}}]),n}(wm);function EM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}xM._$name="Summary",ty.registerFeature(xM,!1,"Scheduler");var DM={maintainVisibleStart:!0},TM=function(e){Ye()(n,e);var t=EM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){tt()(Ze()(n.prototype),"construct",this).apply(this,arguments),this.triggerEvent.includes("click")&&this.client.zoomOnTimeAxisDoubleClick&&(this.client.zoomOnTimeAxisDoubleClick=!1)}},{key:"shouldShowMenu",value:function(e){var t=e.column;return t&&!1!==t.enableHeaderContextMenu&&t===this.client.timeAxisColumn}},{key:"showContextMenu",value:function(e){tt()(Ze()(n.prototype),"showContextMenu",this).apply(this,arguments),this.menu&&(this.menu.scrollAction="realign")}},{key:"populateTimeAxisHeaderMenu",value:function(e){var t=e.items,n=this,r=n.client,i={magnitude:r.timeAxis.shiftIncrement,unit:r.timeAxis.shiftUnit};Object.assign(t,{zoomLevel:{text:"L{pickZoomLevel}",localeClass:n,icon:"b-fw-icon b-icon-search-plus",disabled:!r.presets.count||n.disabled,weight:200,menu:{type:"popup",items:{zoomSlider:{weight:210,type:"slider",minWidth:130,showValue:!1}},onBeforeShow:function(e){var t=e.source,i=N()(t.items,1)[0];i.min=r.minZoomLevel,i.max=r.maxZoomLevel,i.value=r.zoomLevel,n.zoomDetatcher=i.on("input","onZoomSliderChange",n)},onHide:function(){n.zoomDetatcher&&(n.zoomDetatcher(),n.zoomDetatcher=null)}}},dateRange:{text:"L{activeDateRange}",localeClass:n,icon:"b-fw-icon b-icon-calendar",weight:300,menu:{type:"popup",width:"20em",defaults:{localeClass:n},items:{startDateField:{type:"datefield",label:"L{startText}",weight:310,labelWidth:"6em",required:!0,step:i,listeners:{change:n.onRangeDateFieldChange,thisObj:n}},endDateField:{type:"datefield",label:"L{endText}",weight:320,labelWidth:"6em",required:!0,step:i,listeners:{change:n.onRangeDateFieldChange,thisObj:n}},leftShiftBtn:{type:"button",weight:330,cls:"b-left-nav-btn",icon:"b-icon b-icon-prev",color:"b-blue b-raised",flex:1,margin:0,listeners:{click:n.onLeftShiftBtnClick,thisObj:n}},todayBtn:{type:"button",weight:340,cls:"b-today-nav-btn",color:"b-blue b-raised",text:"L{todayText}",flex:4,margin:"0 8",listeners:{click:n.onTodayBtnClick,thisObj:n}},rightShiftBtn:{type:"button",weight:350,cls:"b-right-nav-btn",icon:"b-icon b-icon-next",color:"b-blue b-raised",flex:1,listeners:{click:n.onRightShiftBtnClick,thisObj:n}}},listeners:{paint:n.initDateRangeFields,thisObj:n}}}})}},{key:"onZoomSliderChange",value:function(e){var t=e.value,n=this;n.menu.scrollAction="realign",n.client.zoomLevel=t,n.menu.setTimeout({fn:function(){return n.menu.scrollAction="hide"},delay:100,cancelOutstanding:!0})}},{key:"initDateRangeFields",value:function(e){var t=e.source;if(e.firstPaint){var n=t.widgetMap;this.startDateField=n.startDateField,this.endDateField=n.endDateField}this.initDates()}},{key:"initDates",value:function(){var e=this;e.startDateField.suspendEvents(),e.endDateField.suspendEvents(),e.startDateField.value=e.startDateFieldInitialValue=e.client.startDate,e.endDateField.value=e.endDateFieldInitialValue=e.client.endDate,e.startDateField.resumeEvents(),e.endDateField.resumeEvents()}},{key:"onRangeDateFieldChange",value:function(e){var t=this,n=e.source===t.startDateField,r=t.client,i=r.timeAxis,o=t.startDateFieldInitialValue&&!n?t.startDateFieldInitialValue:t.startDateField.value,a=t.endDateFieldInitialValue&&n?t.endDateFieldInitialValue:t.endDateField.value;n?t.startDateFieldInitialValue=null:t.endDateFieldInitialValue=null,a-o?a<o&&(a=Un.add(o,i.shiftIncrement,i.shiftUnit)):a=Un.add(a,i.shiftIncrement,i.shiftUnit),r.setTimeSpan(o,a,DM),t.initDates()}},{key:"onLeftShiftBtnClick",value:function(){this.client.timeAxis.shiftPrevious(),this.initDates()}},{key:"onTodayBtnClick",value:function(){var e=Un.clearTime(new Date);this.client.setTimeSpan(e,Un.add(e,1,"day")),this.initDates()}},{key:"onRightShiftBtnClick",value:function(){this.client.timeAxis.shiftNext(),this.initDates()}}],[{key:"$name",get:function(){return"TimeAxisHeaderMenu"}},{key:"defaultConfig",get:function(){return{processItems:null,items:null,type:"timeAxisHeader"}}},{key:"pluginConfig",get:function(){var e=tt()(Ze()(n),"pluginConfig",this);return e.chain.push("populateTimeAxisHeaderMenu"),e}}]),n}(Ky);function OM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}TM._$name="TimeAxisHeaderMenu",ty.registerFeature(TM,!0,["Scheduler","Gantt"]),ty.registerFeature(TM,!1,"ResourceHistogram");var MM=function(e){Ye()(n,e);var t=OM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(e,t){var r=this;tt()(Ze()(n.prototype),"construct",this).call(this,e,t),e._timeRangesExposed||(Object.defineProperty(e,"timeRanges",{get:function(){return r.timeRanges},set:function(e){return r.store.data=e}}),e._timeRangesExposed=!0),r.getConfig("timeRanges")}},{key:"startConfigure",value:function(e){var t=this.client;if(t.project&&!this.initialConfig.store){var n=t.project.timeRangeStore;if(n){var r=Qn.getPath(e,"store.data");r&&(n.data=r),e.store=n}}}},{key:"timeRanges",get:function(){var e=this.store,t=e.records;if(e.recurringEvents){var n=[],r=this.client.timeAxis,i=r.startDate,o=r.endDate;return t.forEach((function(e){e.isRecurring?n.push.apply(n,e.getOccurrencesForDateRange(i,o)):n.push(e)})),n}return t},set:function(e){var t=this.getConfig("store");t?t.data=e:this._timeRanges=e}},{key:"initCurrentTimeLine",value:function(){var e=this;if(!e.currentTimeLine&&e.showCurrentTimeLine){var t="object"===I()(e.showCurrentTimeLine)?e.showCurrentTimeLine:{};e.currentTimeLine=e.store.modelClass.new({id:"currentTime",cls:"b-sch-current-time"},t),e.updateCurrentTimeLine=e.updateCurrentTimeLine.bind(e),e.currentTimeInterval=e.setInterval(e.updateCurrentTimeLine,e.currentTimeLineUpdateInterval),e.updateCurrentTimeLine(),e.client.isPainted&&e.renderRanges()}}},{key:"updateCurrentTimeLine",value:function(){var e=this,t=e.currentTimeLine;t.startDate=new Date,t.originalData.name||(e.currentTimeLine.name=Un.format(e.currentTimeLine.startDate,e.currentDateFormat)),e.onStoreChanged({action:"update",record:e.currentTimeLine,changes:{}})}},{key:"hideCurrentTimeLine",value:function(){var e=this;e.currentTimeLine&&(e.clearInterval(e.currentTimeInterval),e.currentTimeLine=null,e.client.isPainted&&e.renderRanges())}},{key:"renderRanges",value:function(){var e=this;tt()(Ze()(n.prototype),"renderRanges",this).call(this),e.showCurrentTimeLine&&!e.disabled&&e.renderRange(e.currentTimeLine,!0)}},{key:"showCurrentTimeLine",get:function(){return this._showCurrentTimeLine},set:function(e){this._showCurrentTimeLine=e,e?this.initCurrentTimeLine():this.hideCurrentTimeLine()}},{key:"populateHeaderMenu",value:function(e){var t=e.column;e.items;"timeAxis"===t.type&&this.populateTimeAxisHeaderMenu.apply(this,arguments)}},{key:"populateTimeAxisHeaderMenu",value:function(e){e.column;var t=e.items,n=this;t.currentTimeLine={weight:400,text:n.L("L{showCurrentTimeLine}"),checked:n.showCurrentTimeLine,onToggle:function(e){var t=e.checked;n.showCurrentTimeLine=t}}}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this.client.isPainted&&this.renderRanges()}},{key:"store",get:function(){return this._store},set:function(e){var t=this,r=t.client;e.storeId||(e.storeId="timeRanges"),gh()(Ze()(n.prototype),"store",e,this,!0),r.timeRanges&&!r._timeRangesExposed&&(t._store.add(r.timeRanges),delete r.timeRanges),t.timeRanges&&(t._store.add(t.timeRanges),delete t.timeRanges)}}],[{key:"$name",get:function(){return"TimeRanges"}},{key:"defaultConfig",get:function(){return{store:{modelClass:KC,storeId:"timeRanges"},currentTimeLineUpdateInterval:1e4,currentDateFormat:"HH:mm",timeRanges:null,showCurrentTimeLine:!1}}}]),n}(wE);MM._$name="TimeRanges",ty.registerFeature(MM,!1,["Scheduler","Gantt"]);var AM={completeview:"completeview",currentview:"currentview",daterange:"daterange"};function IM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var PM=Promise.resolve(),FM=function(e){return function(e){Ye()(l,e);var t,n,r,i,o,a,s=IM(l);function l(){return B()(this,l),s.apply(this,arguments)}return _()(l,[{key:"scrollRowIntoView",value:(a=Pt()(At.a.mark((function e(t,n){var r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rowManager,i=t.scrollable,o=i.y,!(n<t.store.count)){e.next=5;break}if(i.scrollTo(null,r.calculateTop(n)),i.y===o){e.next=5;break}return e.abrupt("return",new Promise((function(e){var i=t.on({scroll:function(t){null!=t.scrollTop&&r.getRow(n)&&(i(),e())}})})));case 5:return e.abrupt("return",PM);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"scrollToDate",value:(o=Pt()(At.a.mark((function e(t,n){var r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,i=[],o=t.timeAxisSubGrid.scrollable.on({scrollStart:function(e){null!=e.x&&(r=!0)}}),i.push(t.scrollToDate(n,{block:"start"})),o(),r&&i.push(t.timeAxisSubGrid.header.scrollable.await("scrollEnd",{checkLog:!1})),e.next=8,Promise.all(i);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"prepareComponent",value:(i=Pt()(At.a.mark((function e(t){var n,r,i,o,a,s,u,c,f,d,h,v,p,g,y;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this,r=t.client,i=r.currentOrientation,o=r.timeAxisSubGrid.width>0,e.t0=t.scheduleRange,e.next=e.t0===AM.completeview?4:e.t0===AM.currentview?7:11;break;case 4:return t.rangeStart=r.startDate,t.rangeEnd=r.endDate,e.abrupt("break",11);case 7:return a=r.visibleDateRange,s=a.startDate,u=a.endDate,t.rangeStart=s,t.rangeEnd=u,e.abrupt("break",11);case 11:return e.next=13,r.waitForAnimations();case 13:return o&&(r.setTimeSpan(t.rangeStart,t.rangeEnd),r.svgCanvas),n._oldEnableEventAnimations=r.enableEventAnimations,r.enableEventAnimations=!1,i.isHorizontalRendering&&(n._oldScrollBuffer=i.scrollBuffer,n._oldVerticalBuffer=i.verticalBufferSize,i.scrollBuffer=100,i.verticalBufferSize=-1),r.ignoreViewBox=!0,e.next=20,tt()(Ze()(l.prototype),"prepareComponent",this).call(this,t);case 20:if(c=n.exportMeta,f=n.element,d=f.querySelector(".b-sch-foreground-canvas"),h=f.querySelector(".b-horizontaltimeaxis"),c.includeTimeline=o,o&&t.scheduleRange!==AM.completeview&&(c.totalWidth-=c.subGrids.normal.width,c.totalWidth+=c.subGrids.normal.width=r.timeAxisViewModel.getDistanceBetweenDates(t.rangeStart,t.rangeEnd),v=Math.ceil(c.totalWidth/c.pageWidth),p=v*c.verticalPages,c.horizontalPages=v,c.totalPages=p,c.subGrids.normal.scrollLeft=r.getCoordinateFromDate(t.rangeStart)),c.timeAxisHeaders=[],c.timeAxisPlaceholders=[],c.headersColleted=!1,mi.forEachSelector(h,".b-sch-header-row",(function(e){c.timeAxisPlaceholders.push(n.createPlaceholder(e)),c.timeAxisHeaders.push(new Map)})),c.subGrids.normal.eventsPlaceholder=n.createPlaceholder(d,!1),mi.removeEachSelector(d,".b-sch-event-wrap,.b-sch-resourcetimerange"),mi.removeEachSelector(n.element,".b-released"),c.eventsBoxes=new Map,c.client=r,r.features.columnLines&&!r.features.columnLines.disabled&&(g=f.querySelector(".b-column-lines-canvas"),c.columnLinesPlaceholder=n.createPlaceholder(g),c.columnLines={lines:new Map,majorLines:new Map}),r.features.dependencies&&!r.features.dependencies.disabled&&(y=f.querySelector('[id="'.concat(r.svgCanvas.getAttribute("id"),'"]')),(c.dependenciesPlaceholder=y)&&mi.removeEachSelector(y,".b-sch-dependency")),!o||Un.betweenLesser(t.rangeStart,r.startDate,r.endDate)){e.next=37;break}return e.next=37,n.scrollToDate(r,t.rangeStart);case 37:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"restoreState",value:(r=Pt()(At.a.mark((function e(t){var n,r,i,o;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!1,r=t.client,i=[],o=r.timeAxisSubGrid.scrollable.on({scrollStart:function(e){var t=e.x;this.element.scrollLeft!==t&&(n=!0)}}),i.push(tt()(Ze()(l.prototype),"restoreState",this).call(this,t)),o(),n&&i.push(r.timeAxisSubGrid.header.scrollable.await("scrollEnd",{checkLog:!1})),e.next=8,Promise.all(i);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"restoreComponent",value:(n=Pt()(At.a.mark((function e(t){var n,r;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=n.currentOrientation,n.ignoreViewBox=!1,n.enableEventAnimations=this._oldEnableEventAnimations,r.isHorizontalRendering&&(r.scrollBuffer=this._oldScrollBuffer,r.verticalBufferSize=this._oldVerticalBuffer),e.next=6,tt()(Ze()(l.prototype),"restoreComponent",this).call(this,t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onRowsCollected",value:(t=Pt()(At.a.mark((function e(t,n){var r,i,o,a,s,u,c,f;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,e.next=3,tt()(Ze()(l.prototype),"onRowsCollected",this).call(this,t);case 3:if(!r.exportMeta.includeTimeline){e.next=30;break}if(i=n.client,o=i.timeView,a=r.getCurrentPageDateRange(n),s=a.pageRangeStart,u=a.pageRangeEnd,!s){e.next=28;break}return c=!1,e.next=9,r.scrollToDate(i,s);case 9:if(c){e.next=28;break}if(r.collectLines(n),r.collectHeaders(n),r.collectEvents(t,n),!Un.timeSpanContains(o.startDate,o.endDate,s,u)){e.next=17;break}c=!0,e.next=26;break;case 17:if(!(o.endDate.getTime()>=u.getTime())){e.next=21;break}c=!0,e.next=26;break;case 21:return f=o.endDate,e.next=24,r.scrollToDate(i,o.endDate);case 24:if(f.getTime()!==o.endDate.getTime()){e.next=26;break}throw new Error("Could not scroll to date");case 26:e.next=9;break;case 28:return e.next=30,r.scrollToDate(i,n.rangeStart);case 30:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getCurrentPageDateRange",value:function(e){var t,n,r=e.rangeStart,i=e.rangeEnd,o=e.client,a=this.exportMeta,s=a.horizontalPages,l=a.horizontalPosition,u=a.pageWidth,c=a.subGrids;if(s>1){var f=l*u,d=(l+1)*u,h=c.locked.width+c.locked.splitterWidth;d<=h?n=t=null:(t=o.getDateFromCoordinate(Math.max(f-h,0)),n=o.getDateFromCoordinate(1.2*(d-h))||i)}else t=r,n=i;return{pageRangeStart:t,pageRangeEnd:n}}},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta,n=t.subGrids.normal,r=n.id,i=n.headerId,o=n.footerId,a=n.scrollLeft,s=e.querySelector('[id="'.concat(r,'"]'));return[".b-sch-background-canvas",".b-sch-foreground-canvas"].forEach((function(e){var n=s.querySelector(e);n&&(t.lastExportedRowBottom?n.style.height="".concat(t.lastExportedRowBottom,"px"):n.style.height="",a&&(n.style.marginLeft="-".concat(a,"px")))})),a&&[i,o].forEach((function(t){var n=e.querySelector('[id="'.concat(t,'"] .b-widget-scroller'));n&&(n.style.marginLeft="-".concat(a,"px"))})),tt()(Ze()(l.prototype),"prepareExportElement",this).call(this)}},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(n){var r=N()(n,2),i=r[0],o=[r[1].outerHTML,e.top,e.offsetHeight];"normal"===i&&o.push(new Map),t[i].rows.push(o)}))}},{key:"collectHeaders",value:function(e){var t=e.client,n=this.exportMeta;if(!n.headersCollected){var r=t.timeView.element,i=n.timeAxisHeaders;mi.forEachSelector(r,".b-sch-header-row",(function(e,r,o){var a=i[r];mi.forEachSelector(e,".b-sch-header-timeaxis-cell",(function(e){a.has(e.dataset.tickIndex)||a.set(e.dataset.tickIndex,e.outerHTML)})),r===o.length-1&&a.has(String(t.timeAxis.count-1))&&(n.headersCollected=!0)}))}}},{key:"collectLines",value:function(e){var t=e.client,n=this.exportMeta,r=n.columnLines;if(!n.headersCollected&&r){var i=t.backgroundCanvas;mi.forEachSelector(i,".b-column-line, .b-column-line-major",(function(e){if(e.classList.contains("b-column-line")){var t=Number(e.dataset.line.replace(/line-/,""));r.lines.set(t,e.outerHTML)}else{var n=Number(e.dataset.line.replace(/major-/,""));r.majorLines.set(n,e.outerHTML)}}))}}},{key:"collectEvents",value:function(e,t){var n=e.length,r=t.client,i=this.exportMeta.subGrids.normal.rows;e.forEach((function(e,t){var o,a,s=i[i.length-n+t],l=r.store.getAt(e.dataIndex),u=s[3];null===(o=l.events)||void 0===o||o.forEach((function(e){if(e.isScheduled){var t=r.getElementFromEventRecord(e,l);t&&(t=t.parentElement)&&!u.has(e.id)&&u.set(e.id,[t.outerHTML,Cr.from(t,t.offsetParent)])}})),null===(a=l.timeRanges)||void 0===a||a.forEach((function(e){var t,n=(null===(t=r.features.resourceTimeRanges)||void 0===t?void 0:t.generateElementId(e))||"",i=r.foregroundCanvas.syncIdMap[n];i&&!u.has(n)&&u.set(n,[i.outerHTML,Cr.from(i,i.offsetParent)])}))}))}},{key:"buildPageHtml",value:function(){var e=this,t=e.exportMeta,n=t.subGrids,r=t.timeAxisHeaders,i=t.timeAxisPlaceholders,o=t.columnLines,a=t.columnLinesPlaceholder,s=e.prepareExportElement();if(Object.values(n).forEach((function(t){var n=t.placeHolder,r=t.eventsPlaceholder,i=t.rows,o=n.outerHTML,a=e.positionRows(i),l=a.resources,u=a.events;s=s.replace(o,l.join("")),r&&(s=s.replace(r.outerHTML,u.join("")))})),r.forEach((function(e,t){s=s.replace(i[t].outerHTML,Array.from(e.values()).join(""))})),o){var l=Array.from(o.lines.values()).concat(Array.from(o.majorLines.values()));s=s.replace(a.outerHTML,l.join(""))}return s=e.buildDependenciesHtml(s)}},{key:"getDependenciesOuterHTML",value:function(){var e,t=this.exportMeta.dependenciesPlaceholder;if(pe.a.isIE11){var n=document.createElement("div"),r=t.cloneNode(!0);n.appendChild(r),e=n.innerHTML}else e=t.outerHTML;return e}},{key:"renderDependencies",value:function(){var e=this.exportMeta,t=e.client,n=e.dependenciesPlaceholder,r=e.eventsBoxes,i=t.dependencies,o=t.features.dependencies,a=Array.from(r.keys());i.filter((function(e){return a.includes(String(e.from))||a.includes(String(e.to))})).forEach((function(e){var t=r.get(String(e.from)),i=r.get(String(e.to)),a=o.getIteratableDependencyAssignments(e),s=e.fromEvent,l=e.toEvent;a.forEach((function(r){var a,u;if(!t&&s){var c=o.getBox(e,!0,r);c&&(t=c instanceof Cr?c:new Cr(c.start,c.top,c.end-c.start,c.bottom-c.top))}if(!i&&l){var f=o.getBox(e,!1,r);f&&(i=f instanceof Cr?f:new Cr(f.start,f.top,f.end-f.start,f.bottom-f.top))}var d={startRectangle:null===(a=t)||void 0===a?void 0:a.clone(),endRectangle:null===(u=i)||void 0===u?void 0:u.clone()};t&&i&&o.drawDependency(e,d,r,n,!1)}))}));var s=this.getDependenciesOuterHTML();return mi.removeEachSelector(n,".b-sch-dependency"),s}},{key:"buildDependenciesHtml",value:function(e){var t=this.exportMeta,n=t.dependenciesPlaceholder,r=t.includeTimeline;if(n&&r){var i=this.getDependenciesOuterHTML();e=e.replace(i,this.renderDependencies())}return e}}]),l}(e)};function LM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var BM=function(e){Ye()(r,e);var t,n=LM(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"stateNextPage",value:(t=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt()(Ze()(r.prototype),"stateNextPage",this).call(this,t);case 2:this.exportMeta.eventsBoxes.clear();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=this,n=[],r=[];return e.forEach((function(e){var i=N()(e,4),o=i[0],a=(i[1],i[2],i[3]);n.push(o),a&&Array.from(a.entries()).forEach((function(e){var n=N()(e,2),i=n[0],o=N()(n[1],2),a=o[0],s=o[1];r.push(a),t.exportMeta.eventsBoxes.set(String(i),s)}))})),{resources:n,events:r}}}],[{key:"$name",get:function(){return"MultiPageExporter"}}]),r}(FM(qm));function jM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}BM._$name="MultiPageExporter";var _M=function(e){Ye()(i,e);var t,n,r=jM(i);function i(){return B()(this,i),r.apply(this,arguments)}return _()(i,[{key:"stateNextPage",value:(n=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt()(Ze()(i.prototype),"stateNextPage",this).call(this,t);case 2:this.exportMeta.eventsBoxes.clear();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"prepareComponent",value:(t=Pt()(At.a.mark((function e(t){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt()(Ze()(i.prototype),"prepareComponent",this).call(this,t);case 2:t.scheduleRange!==AM.completeview&&this.estimateTotalPages(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=this,n=[],r=[];return e.forEach((function(e){var i=N()(e,4),o=i[0],a=(i[1],i[2],i[3]);n.push(o),a&&Array.from(a.entries()).forEach((function(e){var n=N()(e,2),i=n[0],o=N()(n[1],2),a=o[0],s=o[1];r.push(a),t.exportMeta.eventsBoxes.set(String(i),s)}))})),{resources:n,events:r}}}],[{key:"$name",get:function(){return"MultiPageVerticalExporter"}}]),i}(FM(Xm));function HM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}_M._$name="MultiPageVerticalExporter";var NM=function(e){Ye()(n,e);var t=HM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"buildLocalizedItems",value:function(){var e=this;return Object.entries(AM).map((function(t){var n=N()(t,2),r=n[0],i=n[1];return{id:r,text:e.L(i)}}))}}],[{key:"$name",get:function(){return"ScheduleRangeCombo"}},{key:"type",get:function(){return"schedulerangecombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),n}(Pm);function zM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}NM.initClass(),NM._$name="ScheduleRangeCombo";var VM=function(e){Ye()(n,e);var t=zM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onLocaleChange",value:function(){var e=this.L("labelWidth");this.width=this.L("L{width}"),this.items.forEach((function(t){t instanceof tv?t.labelWidth=e:"rangeFieldsContainer"===t.ref&&(t.items[0].width=e)}))}},{key:"fieldProperties",get:function(){return["scheduleRange"].concat(F()(tt()(Ze()(n.prototype),"fieldProperties",this)))}},{key:"buildDialogItems",value:function(e){var t=this,r=e.client,i=t.getDefaultFieldValues(e).scheduleRange,o=tt()(Ze()(n.prototype),"buildDialogItems",this).call(this,e),a=t.L("labelWidth");t.columnsStore=r.columns.chain((function(e){return e.isLeaf&&e.exportable}));var s=o.find((function(e){return"columnsField"===e.ref}));return s.store=t.columnsStore,s.value=t.columnsStore.allRecords,o.splice(1,0,{labelWidth:a,type:"schedulerangecombo",ref:"scheduleRangeField",label:"L{Schedule range}",localeClass:t,value:i,onChange:function(e){var t=e.value!==AM.daterange,n=this.owner.widgetMap;n.rangeStartField.hidden=n.rangeEndField.hidden=t}},{type:"container",ref:"rangeFieldsContainer",flex:"1 0 100%",defaults:{localeClass:t},items:[{type:"widget",width:a},{type:"datefield",ref:"rangeStartField",label:"L{Export from}",labelWidth:"3em",hidden:!0,flex:"1 0 25%",localeClass:t,value:r.startDate,max:Un.max(r.startDate,Un.add(r.endDate,-1,"d")),onChange:function(e){var t=e.value;this.owner.widgetMap.rangeEndField.min=Un.add(t,1,"d")}},{type:"widget",width:"0.5em"},{type:"datefield",ref:"rangeEndField",label:"L{Export to}",labelWidth:"1em",hidden:!0,flex:"1 0 25%",localeClass:t,value:r.endDate,min:Un.min(r.endDate,Un.add(r.startDate,1,"d")),onChange:function(e){var t=e.value;this.owner.widgetMap.rangeStartField.max=Un.add(t,-1,"d")}}]}),o}}],[{key:"$name",get:function(){return"SchedulerExportDialog"}},{key:"type",get:function(){return"schedulerexportdialog"}},{key:"defaultConfig",get:function(){return{scheduleRange:"completeview"}}}]),n}(Hm);function WM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}VM._$name="SchedulerExportDialog";var $M=function(e){Ye()(n,e);var t=WM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"collectDependencies",value:function(){}},{key:"positionRows",value:function(e){var t=this,n=[],r=[],i=/translate\((\d+.?\d*)px, (\d+.?\d*)px\)/,o=0;return e.forEach((function(e){var a=N()(e,4),s=a[0],l=a[1],u=a[2],c=a[3];n.push(s.replace(i,"translate($1px, ".concat(o,"px)")));var f=o-l;c&&Array.from(c.entries()).forEach((function(e){var n=N()(e,2),o=n[0],a=N()(n[1],2),s=a[0],l=a[1];l.translate(0,f),t.exportMeta.eventsBoxes.set(String(o),l),r.push(s.replace(i,"translate($1px, ".concat(l.y,"px)")))})),o+=u})),{resources:n,events:r}}}],[{key:"$name",get:function(){return"SinglePageExporter"}}]),n}(FM(Jm));function UM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}$M._$name="SinglePageExporter";var GM=function(e){Ye()(n,e);var t=UM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"defaultExportDialogConfig",get:function(){return Qn.copyProperties(tt()(Ze()(n.prototype),"defaultExportDialogConfig",this),this,["scheduleRange"])}},{key:"showExportDialog",value:function(){var e=this;return e.exportDialog||(e.exportDialog=VM.new({rootElement:e.rootElement,listeners:{export:e.onExportDialogExport,thisObj:e}},e.defaultExportDialogConfig)),e.exportDialog.show()}},{key:"buildExportConfig",value:function(e){e=tt()(Ze()(n.prototype),"buildExportConfig",this).call(this,e);var t=this.scheduleRange,r=this.rangeStart,i=this.rangeEnd;return e.columns&&!e.columns.find((function(e){return"timeAxis"===e.type}))&&e.columns.push(e.client.timeAxisColumn.id),Qn.assign({scheduleRange:t,rangeStart:r,rangeEnd:i},e)}}],[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exporters:[$M,BM,_M],scheduleRange:"completeview",rangeStart:null,rangeEnd:null}}}]),n}(eb);function YM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}GM._$name="PdfExport",ty.registerFeature(GM,!1,"Scheduler");var qM=function(e){Ye()(n,e);var t=YM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this,t].concat(i)),this.eventSortFn||(this.eventSortFn=function(e,t){return e.internalId-t.internalId})}},{key:"normalizeColumns",value:function(e){tt()(Ze()(n.prototype),"normalizeColumns",this).call(this,e),e.eventColumns=e.eventColumns.map((function(e){return"string"==typeof e?{field:e}:e}))}},{key:"generateExportData",value:function(e){var t=this,n=this.target instanceof HO,r=t.generateColumns(e),i=n?t.generateEventColumns(e):[];return{columns:r.concat(i),rows:t.generateRows(e)}}},{key:"generateEventColumns",value:function(e){var t=this;return e.eventColumns.map((function(n){return t.processEventColumn(n,e)}))}},{key:"processEventColumn",value:function(e,t){var n=e.width,r=e.minWidth,i=t.defaultColumnWidth;return{field:e.field,value:e.text,width:Math.max(n||i,r||i),eventColumn:!0,type:this.getColumnType(e,this.target.eventStore)}}},{key:"generateRows",value:function(e){var t,r=this,i=r.target;if(i instanceof HO){if(t=[],i.resourceStore.map((function(n){var i=n.events||[];i.sort(r.eventSortFn),i.length||i.push(""),i.forEach((function(i){return t.push(r.getRowData(e,n,i))}))})),e.includeUnassigned&&e.eventColumns.length){var o=i.eventStore.query((function(e){return!e.resources.length}));if(o.length){var a=new Array(e.columns.length).fill("");a.push(r.L("L{ExcelExporter.No resource assigned}")),t.push(a),o.forEach((function(n){return t.push(r.getRowData(e,null,n))}))}}t=t.filter((function(e){return e.length}))}else t=tt()(Ze()(n.prototype),"generateRows",this).call(this,e);return t}},{key:"getRowData",value:function(e,t,n){var r=e.columns,i=e.eventColumns,o=[],a=this.processRecord(t,r,e);if(a&&o.push.apply(o,F()(a)),!t||!t.isSpecialRow){var s=this.processRecord(n,i,e);s&&o.push.apply(o,F()(s))}return o}}],[{key:"defaultConfig",get:function(){return{includeUnassigned:!0,eventColumns:[{text:"Task",field:"name"},{text:"Starts",field:"startDate",width:140},{text:"Ends",field:"endDate",width:140}],eventSortFn:null}}}]),n}(en(nb));function KM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}qM._$name="ScheduleTableExporter";var XM=function(e){Ye()(n,e);var t=KM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"ExcelExporter"}},{key:"defaultConfig",get:function(){return{exporterClass:qM,exporterConfig:null}}}]),n}(ob);function ZM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}XM._$name="ExcelExporter",ty.registerFeature(XM,!1,"Scheduler");var JM=function(e){Ye()(n,e);var t=ZM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"onCellClick",value:function(e){var t=e.record;e.event.preventDefault(),t.eventLayout="none"!==t.eventLayout?"none":"stack"}}],[{key:"$name",get:function(){return"ResourceCollapseColumn"}},{key:"type",get:function(){return"resourceCollapse"}},{key:"defaults",get:function(){return{width:"3em",align:"center",sortable:!1,groupable:!1,editor:!1,minWidth:0,cellCls:"b-resourcecollapse-cell",renderer:function(e){return{tag:"i",class:{"b-icon":1,"b-icon-expand-resource":1,"b-flip":"none"!==e.record.eventLayout}}}}}}]),n}(vg);function QM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(JM),JM._$name="ResourceCollapseColumn";var eA=function(e){Ye()(n,e);var t=QM(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"construct",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=tt()(Ze()(n.prototype),"construct",this)).call.apply(e,[this].concat(r)),this.avatarRendering=new fg({element:this.grid.element})}},{key:"doDestroy",value:function(){tt()(Ze()(n.prototype),"doDestroy",this).call(this),this.avatarRendering.destroy()}},{key:"getImageURL",value:function(e){return te.joinPaths([this.grid.resourceImagePath||"",e||""])}},{key:"template",value:function(e,t){var n,r=this,i=r.showImage,o=r.showRole,a=r.showMeta,s=r.showEventCount,l=r.grid,u=l.timeAxis,c=l.resourceImageExtension,f=void 0===c?"":c,d=l.defaultResourceImageName,h="string"==typeof o?o:"role",v=s&&e.eventStore.getEvents({includeOccurrences:l.enableRecurringEvents,resourceRecord:e,startDate:u.startDate,endDate:u.endDate}).length;if(i&&!1!==e.image)if(e.imageUrl)n=e.imageUrl;else{var p="string"==typeof i?i:e.image||t&&r.useNameAsImageName&&t.toLowerCase()+f||d||"";n=p&&r.getImageURL(p),p.includes(".")||r.validNames&&!r.validNames.includes(p)||(n+=f)}return t=te.encodeHtml(t),{class:"b-resource-info",children:[i&&r.avatarRendering.getResourceAvatar({initials:e.initials,color:e.eventColor,iconCls:e.iconCls,imageUrl:n,defaultImageUrl:d&&this.getImageURL(d)}),o||s||a?{tag:"dl",children:[{tag:"dt",html:t},o?{tag:"dd",class:"b-resource-role",html:te.encodeHtml(e[h])}:null,s?{tag:"dd",class:"b-resource-events",html:r.L("L{eventCountText}",v)}:null,a?{tag:"dd",class:"b-resource-meta",html:r.showMeta(e)}:null]}:t]}}},{key:"defaultRenderer",value:function(e){var t,n=e.grid,r=e.record,i=e.cellElement,o=e.value,a=e.isExport;return r.isSpecialRow?t="":a?t=o:(this.autoScaleThreshold&&n.rowHeight<this.autoScaleThreshold?i.style.fontSize=n.rowHeight/40+"em":i.style.fontSize="",t=this.template(r,o)),t}}],[{key:"$name",get:function(){return"ResourceInfoColumn"}},{key:"type",get:function(){return"resourceInfo"}},{key:"fields",get:function(){return["showEventCount","showRole","showMeta","showImage","validNames","autoScaleThreshold","useNameAsImageName"]}},{key:"defaults",get:function(){return{showImage:!0,showEventCount:!0,showMeta:null,showRole:!1,validNames:["amit","angelo","arcady","arnold","celia","chang","dan","dave","emilia","george","gloria","henrik","hitomi","jong","kate","lee","linda","lisa","lola","macy","madison","malik","mark","maxim","mike","rob","steve"],autoScaleThreshold:40,field:"name",htmlEncode:!1,width:140,cellCls:"b-resourceinfo-cell",useNameAsImageName:!0,editor:!z.a.isTestEnv&&"text"}}}]),n}(vg);function tA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}bg.registerColumnType(eA),eA._$name="ResourceInfoColumn";var nA=function(e){Ye()(n,e);var t=tA(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,null,[{key:"$name",get:function(){return"Scheduler"}},{key:"type",get:function(){return"scheduler"}}]),n}(HO);function rA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}nA.initClass(),nA._$name="Scheduler";var iA=function(e){Ye()(n,e);var t=rA(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"itemIconTpl",value:function(e,t){var n=e.eventColor,r=mi.isNamedColor(n)?" b-sch-foreground-".concat(n):"",i=!r&&n?' style="color:'.concat(n,'"'):"";return this.multiSelect?'<div class="b-selected-icon b-icon'.concat(r,'"').concat(i,"></div>"):""}},{key:"updateEventStore",value:function(e){var t,n=e.resourceStore,r=this.initialConfig.store instanceof ts?this.initialConfig.store.initialConfig:null===(t=this.store)||void 0===t?void 0:t.config;this.store=n.makeChained(null,null,r),n.count?this.initFilter():n.project.on({name:"project",refresh:"initFilter",thisObj:this})}},{key:"initFilter",value:function(){var e=this.eventStore;e.count&&e.resourceStore.count&&(this.selected.add(this.store.getRange()),this.detachListeners("project"))}},{key:"onSelectionChange",value:function(e){var t=e.source,r=this,i=t.count===r.eventStore.resourceStore.count;tt()(Ze()(n.prototype),"onSelectionChange",this).apply(this,arguments),r.resourceFilter?(r.resourceFilter.disabled=i,r.applyFilter()):r.resourceFilter=r.eventStore.addFilter({id:"".concat(r.id,"-filter-instance"),filterBy:function(e){return!e.resource||r.selected.includes(e.resources)},disabled:i},!0)}},{key:"applyFilter",value:function(){this.eventStore.filter()}}],[{key:"$name",get:function(){return"ResourceFilter"}},{key:"type",get:function(){return"resourcefilter"}},{key:"delayable",get:function(){return{applyFilter:"raf"}}},{key:"configurable",get:function(){return{eventStore:null,multiSelect:!0,toggleAllIfCtrlPressed:!0,itemTpl:function(e){return te.encodeHtml(e.name||"")}}}}]),n}(yv);function oA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}iA.initClass(),iA._$name="ResourceFilter";var aA=function(e){return e.isProjectConsumer},sA=function(e){Ye()(r,e);var t,n=oA(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"construct",value:function(){tt()(Ze()(r.prototype),"construct",this).apply(this,arguments),this.stm||(this.scheduler=this.up(aA))}},{key:"changeScheduler",value:function(e){return e.isProjectConsumer?e:r.getById(e)}},{key:"updateScheduler",value:function(e){var t=e.crudManager;t?t.on({load:"onCrudManagerLoad",thisObj:this}):this.onCrudManagerLoad(),this.stm=e.project.stm}},{key:"onCrudManagerLoad",value:(t=Pt()(At.a.mark((function e(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scheduler.project.commitAsync();case 2:this.isDestroyed||(this.stm.enable(),this.fillUndoRedoCombo());case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"$name",get:function(){return"UndoRedo"}},{key:"type",get:function(){return"undoredo"}},{key:"configurable",get:function(){return{scheduler:null,project:null}}}]),r}(Tv);sA.initClass(),sA._$name="UndoRedo";function lA(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return uA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uA(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function uA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var fA=function(e){Ye()(r,e);var t,n=cA(r);function r(){return B()(this,r),n.apply(this,arguments)}return _()(r,[{key:"connectedCallback",value:function(){this.setup()}},{key:"setup",value:(t=Pt()(At.a.mark((function e(){var t,n,r,i,o,a,s,l,u,c,f,d,h,v,p,g,y,m,b;return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this).shadowRoot){e.next=3;break}return e.abrupt("return");case 3:return i=t.tagName.substring("BRYNTUM-".length).toLowerCase(),o=(!pe.a.isChrome||!document.fonts.check('normal 14px "Font Awesome 5 Free"'))&&t.getAttribute("fa-path"),a=document.getElementById("bryntum-theme"),s=t.getAttribute("theme")||"stockholm",l=t.getAttribute("stylesheet")||(null==a?void 0:a.href)||"".concat(i,".").concat(s,".css"),u=t.attachShadow({mode:"open"}),c=t.linkTag=mi.createElement({tag:"link",rel:"stylesheet",href:l,parent:u}),f=[new Promise((function(e){n=e}))],d={appendTo:u,features:{}},t.convertDatasetToConfigs(t.dataset,d),c.onload=function(){return n()},o&&(r=new FontFace(pe.a.isFirefox?"FontAwesome5Free":"Font Awesome 5 Free",'url("'.concat(o,'/fa-solid-900.woff2")')),f.push(r.load())),e.next=9,Promise.all(f);case 9:r&&document.fonts.add(r),h=lA(t.children);try{for(h.s();!(v=h.n()).done;)p=v.value,"FEATURE"===(g=p.tagName)?(y=p.dataset.name,delete(m=Object.assign({},p.dataset)).name,Object.keys(m).length?d.features[y]=m:d.features[y]="false"!==p.textContent):"TBAR"===g||"BBAR"===g?d[g.toLowerCase()]=Array.from(p.children).map((function(e){return t.convertDatasetToConfigs(e.dataset)})):"INLINESTYLE"===g&&((b=document.createElement("style")).innerHTML=p.innerHTML,u.appendChild(b))}catch(e){h.e(e)}finally{h.f()}t.widget=t.createInstance(d);case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"convertDatasetToConfigs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var n in e){var r=e[n];switch(r){case"true":case"false":case"null":r=JSON.parse(r)}t[n]=r}return t}},{key:"destroy",value:function(){var e,t,n,r=this;if(r.widget){var i=r.shadowRoot,o=i.bryntum,a=r.widget.constructor,s=i.querySelector(".b-float-root");null==o||null===(e=o.tooltip)||void 0===e||null===(t=e.get(kh))||void 0===t||t.destroy(),null==o||null===(n=o.errorTooltip)||void 0===n||n.destroy(),r.widget.destroy(),null==s||s.remove(),a.removeFloatRoot(s),r.linkTag.remove(),r.widget=null}}}]),r}(window.customElements?HTMLElement:Object);fA._$name="WidgetTag";function dA(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return hA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hA(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}var pA=function(e){Ye()(n,e);var t=vA(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"createInstance",value:function(e){var t,n=[],r=[],i=[],o=[],a=[],s=dA(this.children);try{for(s.s();!(t=s.n()).done;){var l=t.value;if("COLUMN"===l.tagName){var u=parseInt(l.dataset.width),c=parseInt(l.dataset.flex),f={field:l.dataset.field,text:l.innerHTML,type:l.dataset.type};u?f.width=u:f.flex=c||1,n.push(f)}else if("DATA"===l.tagName){var d,h=dA(l.children);try{for(h.s();!(d=h.n()).done;){var v,p=d.value,g=dA(p.children);try{for(g.s();!(v=g.n()).done;){var y=v.value,m=p.tagName,b={};Object.assign(b,y.dataset),"EVENTS"===m?i.push(b):"RESOURCES"===m?r.push(b):"DEPENDENCIES"===m?a.push(b):"ASSIGNMENTS"===m&&o.push(b)}}catch(e){g.e(e)}finally{g.f()}}}catch(e){h.e(e)}finally{h.f()}}else"PROJECT"===l.tagName&&(e.project=new this.projectModelClass({autoLoad:!0,transport:{load:{url:l.dataset.loadUrl}}}))}}catch(e){s.e(e)}finally{s.f()}return i.length&&(e.events=i),r.length&&(e.resources=r),a.length&&(e.dependencies=a),new this.widgetClass(Object.assign(e,{columns:n}))}}]),n}(fA);function gA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze()(e);if(t){var i=Ze()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ke()(this,n)}}pA._$name="TimelineBaseTag";var yA=function(e){Ye()(n,e);var t=gA(n);function n(){return B()(this,n),t.apply(this,arguments)}return _()(n,[{key:"connectedCallback",value:function(){this.widgetClass=nA,this.projectModelClass=yx,tt()(Ze()(n.prototype),"connectedCallback",this).call(this)}}]),n}(pA);try{window.customElements&&window.customElements.define("bryntum-scheduler",yA)}catch(e){}yA._$name="SchedulerTag"}])}));
//# sourceMappingURL=scheduler.umd.min.js.map