<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="s_hpa901rkr_sdServiceImpl">
	
	 <update id="s_hpa901rkr_sdServiceImpl.createTable" parameterType="Map">
       --s_hpa901rkr_sdServiceImpl.createTable
       IF EXISTS (SELECT * FROM SYSOBJECTS WHERE ID = OBJECT_ID('HAT200PH_MASTER')) DROP TABLE HAT200PH_MASTER

       IF EXISTS (SELECT * FROM SYSOBJECTS WHERE ID = OBJECT_ID('HPA900PH_MASTER')) DROP TABLE HPA900PH_MASTER

       IF EXISTS (SELECT * FROM SYSOBJECTS WHERE ID = OBJECT_ID('HBO800PH_MASTER')) DROP TABLE HBO800PH_MASTER

         
       --s_hpa901rkr_sdServiceImpl [fnHpa900PB] Create HAT200PH_MASTER
       CREATE TABLE HAT200PH_MASTER
       (                                                    
           SEQ              NUMERIC(3)      NOT NULL,       
           SUB_CODE         NVARCHAR(50)    NULL,           
           CODE_NAME        NVARCHAR(50)    NULL            
                                                            
           CONSTRAINT Hat200PH_MASTER_IDX00 PRIMARY KEY CLUSTERED  
           (                                                
                   SEQ                                      
           )                                                
       )                                                    
    
       --s_hpa901rkr_sdServiceImpl [fnHpa900PB] Create HPA900PH_MASTER
       CREATE TABLE HPA900PH_MASTER
       (                                                    
           SEQ              NUMERIC(3)      NOT NULL,       
           SUB_CODE         NVARCHAR(50)    NULL,           
           CODE_NAME        NVARCHAR(50)    NULL            
                                                            
           CONSTRAINT Hpa900PH_MASTER_IDX00 PRIMARY KEY CLUSTERED  
           (                                                
                   SEQ                                      
           )                                                
       )                                                    
    
     --s_hpa901rkr_sdServiceImpl [fnHpa900PB] Create HBO800PH_MASTER
       CREATE TABLE HBO800PH_MASTER
       (                                                    
           W_SEQ            NUMERIC(3)      NOT NULL,       
           WAGES_CODE       NVARCHAR(50)    NULL,           
           WAGES_NAME       NVARCHAR(50)    NULL,           
           WAGES_SEQ        NUMERIC(2)      NULL            
                                                            
           CONSTRAINT HBO800PH_MASTER_IDX00 PRIMARY KEY CLUSTERED  
           (                                                
                   W_SEQ                                    
           )                                                
       )                                                    

    </update>
    
    
    <select id="s_hpa901rkr_sdServiceImpl.selectWages1" parameterType="Map" resultType="rMap">
        --s_hpa901rkr_sdServiceImpl.selectWages1
        SELECT ROW_NUMBER() OVER(ORDER BY SUB_CODE ASC) AS SEQ 
             , SUB_CODE                
             , CODE_NAME               
          FROM BSA100T                 
         WHERE COMP_CODE = #{S_COMP_CODE}
           AND MAIN_CODE = 'H033'      
           AND USE_YN    = 'Y'         
           AND SUB_CODE != '$'         
         ORDER BY REF_CODE2, SUB_CODE  
                    
    </select>
    
    <update id="s_hpa901rkr_sdServiceImpl.insertWages1" parameterType="Map">
        --hpa900rkrServiceImpl.insertWages1 - [HAT200PH_MASTER]
        INSERT INTO HAT200PH_MASTER
                  ( SEQ                                 
                  , SUB_CODE                            
                  , CODE_NAME )                         
        VALUES    ( #{SEQ}                      
                  , #{SUB_CODE}
                  , #{CODE_NAME} )  
                    
    </update>
    
    <select id="s_hpa901rkr_sdServiceImpl.selectWages2" parameterType="Map" resultType="rMap">
        --s_hpa901rkr_sdServiceImpl.selectWages2
        SELECT ROW_NUMBER() OVER(ORDER BY SUB_CODE ASC) AS SEQ
             , B.SUB_CODE AS SUB_CODE                            
             , B.CODE_NAME                                       
          FROM             BSA100T B
                INNER JOIN HPA400T A ON B.COMP_CODE = A.COMP_CODE
                                    AND B.SUB_CODE  = A.DED_CODE  
         WHERE B.COMP_CODE      = #{S_COMP_CODE}
           AND A.PAY_YYYYMM &gt;= #{DATE_FR}
           AND A.PAY_YYYYMM &lt;= #{DATE_TO}
           AND A.SUPP_TYPE      = '1'
           AND B.MAIN_CODE      = N'H034'                              
           AND B.SUB_CODE      != N'$'
           AND B.USE_YN         = 'Y'                                 
         GROUP BY B.SUB_CODE, B.CODE_NAME, REF_CODE2             
         ORDER BY REF_CODE2, SUB_CODE                            
                    
    </select>
    
    <update id="s_hpa901rkr_sdServiceImpl.insertWages2" parameterType="Map">
        --s_hpa901rkr_sdServiceImpl.insertWages2 - [HPA900PH_MASTER]
        INSERT INTO HPA900PH_MASTER
                  ( SEQ                                 
                  , SUB_CODE                            
                  , CODE_NAME)                          
        VALUES    ( #{SEQ}                       
                  , #{SUB_CODE}    
                  , #{CODE_NAME} )  
                    
    </update>
    
    
    <select id="s_hpa901rkr_sdServiceImpl.selectWages3" parameterType="Map" resultType="rMap">
        --s_hpa901rkr_sdServiceImpl.selectWages3
        SELECT ROW_NUMBER() OVER(ORDER BY B.WAGES_CODE ASC) AS W_SEQ
             , B.WAGES_CODE                                                                
             , B.WAGES_NAME                                                                
             , B.WAGES_SEQ                                                                 
          FROM            HBS300T B 
               INNER JOIN HPA300T A ON B.COMP_CODE = A.COMP_CODE
                                   AND B.WAGES_CODE = A.WAGES_CODE                         
         WHERE B.COMP_CODE      = #{S_COMP_CODE}
           AND A.PAY_YYYYMM &gt;= #{DATE_FR}                  
           AND A.PAY_YYYYMM &lt;= #{DATE_TO}
           AND A.SUPP_TYPE      = '1'                                     
           AND B.CODE_TYPE      = '1'
           AND B.USE_YN         = 'Y'                 
         GROUP BY B.WAGES_CODE,  B.WAGES_NAME,  B.WAGES_SEQ                                
         ORDER BY B.WAGES_SEQ,   B.WAGES_CODE                                              
                    
    </select>
    
    
    <update id="s_hpa901rkr_sdServiceImpl.insertWages3" parameterType="Map">
        --s_hpa901rkr_sdServiceImpl.insertWages3 - [HBO800PH_MASTER]
        INSERT INTO HBO800PH_MASTER
                  ( W_SEQ                                 
                  , WAGES_CODE                            
                  , WAGES_NAME                            
                  , WAGES_SEQ)                            
         VALUES   ( #{W_SEQ}                      
                  , #{WAGES_CODE}
                  , #{WAGES_NAME}
                  , #{WAGES_SEQ} )    
                    
    </update>
    
	<select id="s_hpa901rkr_sdServiceImpl.getSubList" parameterType="Map" resultType="rMap">
		--s_hpa901rkr_sdServiceImpl [fnHpa901QRpt1] strGubun P                                                        
		SELECT MAX(CASE WHEN B.W_SEQ = 1  THEN B.WAGES_NAME   ELSE '' END) AS '1'         
		     , MAX(CASE WHEN B.W_SEQ = 2  THEN B.WAGES_NAME   ELSE '' END) AS '2'         
		     , MAX(CASE WHEN B.W_SEQ = 3  THEN B.WAGES_NAME   ELSE '' END) AS '3'         
		     , MAX(CASE WHEN B.W_SEQ = 4  THEN B.WAGES_NAME   ELSE '' END) AS '4'         
		     , MAX(CASE WHEN B.W_SEQ = 5  THEN B.WAGES_NAME   ELSE '' END) AS '5'         
		     , MAX(CASE WHEN B.W_SEQ = 6  THEN B.WAGES_NAME   ELSE '' END) AS '6'         
		     , MAX(CASE WHEN B.W_SEQ = 7  THEN B.WAGES_NAME   ELSE '' END) AS '7'         
		     , MAX(CASE WHEN B.W_SEQ = 8  THEN B.WAGES_NAME   ELSE '' END) AS '8'         
		     , MAX(CASE WHEN B.W_SEQ = 9  THEN B.WAGES_NAME   ELSE '' END) AS '9'         
		     , MAX(CASE WHEN B.W_SEQ = 10 THEN B.WAGES_NAME   ELSE '' END) AS '10'        
		     , MAX(CASE WHEN B.W_SEQ = 11 THEN B.WAGES_NAME   ELSE '' END) AS '11'        
		     , MAX(CASE WHEN B.W_SEQ = 12 THEN B.WAGES_NAME   ELSE '' END) AS '12'        
		     , MAX(CASE WHEN B.W_SEQ = 13 THEN B.WAGES_NAME   ELSE '' END) AS '13'        
		     , MAX(CASE WHEN B.W_SEQ = 14 THEN B.WAGES_NAME   ELSE '' END) AS '14'        
		     , MAX(CASE WHEN B.W_SEQ = 15 THEN B.WAGES_NAME   ELSE '' END) AS '15'        
		     , MAX(CASE WHEN B.W_SEQ = 16 THEN B.WAGES_NAME   ELSE '' END) AS '16'        
		     , MAX(CASE WHEN B.W_SEQ = 17 THEN B.WAGES_NAME   ELSE '' END) AS '16_1'        
		     , MAX(CASE WHEN B.W_SEQ = 18 THEN B.WAGES_NAME   ELSE '' END) AS '16_2'        
		     , MAX(CASE WHEN B.W_SEQ = 19 THEN B.WAGES_NAME   ELSE '' END) AS '16_3'        
		     , MAX(CASE WHEN B.W_SEQ = 20 THEN B.WAGES_NAME   ELSE '' END) AS '16_4'        
		     , MAX(CASE WHEN B.W_SEQ = 21 THEN B.WAGES_NAME   ELSE '' END) AS '16_5'        
		     , MAX(CASE WHEN B.W_SEQ = 22 THEN B.WAGES_NAME   ELSE '' END) AS '16_6'        
		     , MAX(CASE WHEN B.W_SEQ = 23 THEN B.WAGES_NAME   ELSE '' END) AS '16_7'        
		     , MAX(CASE WHEN B.W_SEQ = 24 THEN B.WAGES_NAME   ELSE '' END) AS '16_8'        
		     , MAX(CASE WHEN B.W_SEQ = 25 THEN B.WAGES_NAME   ELSE '' END) AS '16_9'        
		     , MAX(CASE WHEN B.W_SEQ = 26 THEN B.WAGES_NAME   ELSE '' END) AS '16_10'        
		     , MAX(CASE WHEN B.W_SEQ = 27 THEN B.WAGES_NAME   ELSE '' END) AS '16_11'        
		     , MAX(CASE WHEN B.W_SEQ = 28 THEN B.WAGES_NAME   ELSE '' END) AS '16_12'        
		     , MAX(CASE WHEN B.W_SEQ = 29 THEN B.WAGES_NAME   ELSE '' END) AS '16_13'        
		     , MAX(CASE WHEN B.W_SEQ &gt;= 30                                                 
		                     THEN 'z' + uniLITE.fnGetTxt('H0042')                         
		                     ELSE (CASE WHEN B.W_SEQ = 30 THEN B.WAGES_NAME ELSE '' END)  
		            END) AS '16_14'                                                          
		     , MAX(CASE WHEN A.SEQ = 1    THEN A.CODE_NAME    ELSE '' END) AS '17'        
		     , MAX(CASE WHEN A.SEQ = 2    THEN A.CODE_NAME    ELSE '' END) AS '18'        
		     , MAX(CASE WHEN A.SEQ = 3    THEN A.CODE_NAME    ELSE '' END) AS '19'        
		     , MAX(CASE WHEN A.SEQ = 4    THEN A.CODE_NAME    ELSE '' END) AS '20'        
		     , MAX(CASE WHEN A.SEQ = 5    THEN A.CODE_NAME    ELSE '' END) AS '21'        
		     , MAX(CASE WHEN A.SEQ = 6    THEN A.CODE_NAME    ELSE '' END) AS '22'        
		     , MAX(CASE WHEN A.SEQ = 7    THEN A.CODE_NAME    ELSE '' END) AS '23'        
		     , MAX(CASE WHEN A.SEQ = 8    THEN A.CODE_NAME    ELSE '' END) AS '24'        
		     , MAX(CASE WHEN A.SEQ = 9    THEN A.CODE_NAME    ELSE '' END) AS '25'        
		     , MAX(CASE WHEN A.SEQ = 10   THEN A.CODE_NAME    ELSE '' END) AS '26'        
		     , MAX(CASE WHEN A.SEQ = 11   THEN A.CODE_NAME    ELSE '' END) AS '26_1'      
		     , MAX(CASE WHEN A.SEQ = 12   THEN A.CODE_NAME    ELSE '' END) AS '26_2'      
		     , MAX(CASE WHEN A.SEQ = 13   THEN A.CODE_NAME    ELSE '' END) AS '26_3'      
		     , MAX(CASE WHEN A.SEQ = 14   THEN A.CODE_NAME    ELSE '' END) AS '26_4'      
		     , MAX(CASE WHEN A.SEQ = 15   THEN A.CODE_NAME    ELSE '' END) AS '26_5'      
		     , MAX(CASE WHEN A.SEQ &gt;= 16  THEN A.CODE_NAME    ELSE '' END) AS '27'
		     , MAX(CASE WHEN C.SEQ = 1    THEN C.CODE_NAME    ELSE '' END) AS '28'        
		     , MAX(CASE WHEN C.SEQ = 2    THEN C.CODE_NAME    ELSE '' END) AS '29'        
		     , MAX(CASE WHEN C.SEQ = 3    THEN C.CODE_NAME    ELSE '' END) AS '30'        
		     , MAX(CASE WHEN C.SEQ = 4    THEN C.CODE_NAME    ELSE '' END) AS '31'        
		     , MAX(CASE WHEN C.SEQ = 5    THEN C.CODE_NAME    ELSE '' END) AS '32'        
		     , MAX(CASE WHEN C.SEQ = 6    THEN C.CODE_NAME    ELSE '' END) AS '33'        
		     , MAX(CASE WHEN C.SEQ = 7    THEN C.CODE_NAME    ELSE '' END) AS '34'        
		     , MAX(CASE WHEN C.SEQ = 8    THEN C.CODE_NAME    ELSE '' END) AS '35'        
		     , MAX(CASE WHEN C.SEQ = 9    THEN C.CODE_NAME    ELSE '' END) AS '36'        
		     , MAX(CASE WHEN C.SEQ = 10   THEN C.CODE_NAME    ELSE '' END) AS '37'        
		     , MAX(CASE WHEN C.SEQ = 11   THEN C.CODE_NAME    ELSE '' END) AS '38'        
		     , MAX(CASE WHEN C.SEQ = 12   THEN C.CODE_NAME    ELSE '' END) AS '39'        
		     , MAX(CASE WHEN C.SEQ = 13   THEN C.CODE_NAME    ELSE '' END) AS '40'        
		     , MAX(CASE WHEN C.SEQ = 14   THEN C.CODE_NAME    ELSE '' END) AS '41'        
		     , MAX(CASE WHEN C.SEQ = 15   THEN C.CODE_NAME    ELSE '' END) AS '42'        
		  FROM HPA900PH_${S_COMP_CODE} A, HBO800PH_${S_COMP_CODE} B, HAT200PH_${S_COMP_CODE} C                                         

	</select>
	
	
	<select id="s_hpa901rkr_sdServiceImpl.selectList1" parameterType="Map" resultType="rMap">
		<choose>
			<when test="STRTYPE != 2">
			--s_hpa901rkr_sdServiceImpl [selectList1]
			SELECT M1.PAY_YYYYMM 
			     , M1.SUPP_TYPE
			     , M1.POST_CODE
			     , M0.PAY_GRADE_01 AS  PAY_GRADE1
			     , M1.DIV_CODE
 			     , M9.COST_POOL_CODE AS DEPT_CODE
			     , M9.COST_POOL_NAME AS DEPT_NAME
			     , '' AS TREE_CODE
			     , M1.PAY_CODE 
			     , M1.PAY_PROV_FLAG
			     , M1.PERSON_NUMB
			     , M0.NAME
			     , unilite.fnCipherDecrypt(M0.REPRE_NUM, 'RR') REPRE_NUM
			     , M0.JOIN_DATE
			     , M0.RETR_DATE
			     , (CASE WHEN M0.PAY_CODE != '3' 
			                  THEN ISNULL(M4.WORK_DAY,0) 
			                  ELSE ISNULL(M4.WORK_TIME, 0) 
			         END) AS WORK_DAY
			     , ISNULL(M4.TOT_DAY,0) AS TOT_DAY
			     , M4.WORK_DAY AS R_WORK_DAY
			     , M4.WORK_TIME
			     , (SELECT EXTEND_WORK_YN
			          FROM HBS400T
			         WHERE COMP_CODE = #{S_COMP_CODE}) AS EXTEND_WORK_YN
			     , CASE (SELECT EXTEND_WORK_YN
			               FROM HBS400T
			              WHERE COMP_CODE = #{S_COMP_CODE}) WHEN 'Y' THEN M4.EXTEND_WORK_TIME 
			                                                      ELSE 0 
			                                                      END EXTEND_WORK_TIME
			     , (SELECT DIV_NAME
			          FROM BOR120T WITH(NOLOCK)
			         WHERE COMP_CODE = #{S_COMP_CODE}
			           AND DIV_CODE  = M1.DIV_CODE) AS DIV_NAME
			    
			     , CASE WHEN ISNULL(B4.REF_CODE1, '') = 'Y'
			                 THEN CASE WHEN ISNULL(B4.REF_CODE2, '') = '1' THEN ISNULL(B3.CODE_NAME, '')
			                           WHEN ISNULL(B4.REF_CODE2, '') = '2'
			                                THEN CASE WHEN ISNULL(B3.CODE_NAME, '') = ISNULL(B5.CODE_NAME, '') THEN ISNULL(B3.CODE_NAME, '')
			                                          ELSE ISNULL(B3.CODE_NAME, '') + ' ' + ISNULL(B5.CODE_NAME, '')
			                                     END
			                           ELSE B3.CODE_NAME
			                      END
			            ELSE B3.CODE_NAME
			       END                                                  AS POST_NM
			     , '' AS GRADE
			     , M0.PAY_GRADE_02 AS PAY_GRADE2
			     , (SELECT CODE_NAME 
			          FROM BSA100T 
			         WHERE COMP_CODE = #{S_COMP_CODE}
			           AND MAIN_CODE = 'H011' 
			           AND SUB_CODE  = M1.PAY_GUBUN) AS PAY_GUBUN
			     , M0.SPOUSE
			     , M0.SUPP_AGED_NUM
			     , M0.CHILD_20_NUM
			     , M0.DEFORM_NUM
			     , M0.AGED_NUM
			     , ISNULL(M1.SUPP_TOTAL_I,0) AS SUPP_TOTAL_I 
			     , ISNULL(M1.DED_TOTAL_I,0) AS DED_TOTAL_I
			     , ISNULL(M1.REAL_AMOUNT_I,0) AS REAL_AMOUNT_I 
			     , unilite.fnCipherDecrypt(M0.BANK_ACCOUNT1, 'RB') BANK_ACCOUNT1 
			     , ISNULL(M2.S1,0) AS S1         , ISNULL(M2.S2,0) AS S2         , ISNULL(M2.S3,0) AS S3
			     , ISNULL(M2.S4,0) AS S4         , ISNULL(M2.S5,0) AS S5         , ISNULL(M2.S6,0) AS S6
			     , ISNULL(M2.S7,0) AS S7         , ISNULL(M2.S8,0) AS S8         , ISNULL(M2.S9,0) AS S9
			     , ISNULL(M2.S10,0) AS S10       , ISNULL(M2.S11,0) AS S11       , ISNULL(M2.S12,0) AS S12
			     , ISNULL(M2.S13,0) AS S13       , ISNULL(M2.S14,0) AS S14       , ISNULL(M2.S15,0) AS S15
			     , ISNULL(M2.S16,0) AS S16
			     , ISNULL(M2.S16_1,0) AS S16_1
			     , ISNULL(M2.S16_2,0) AS S16_2
			     , ISNULL(M2.S16_3,0) AS S16_3
			     , ISNULL(M2.S16_4,0) AS S16_4
			     , ISNULL(M2.S16_5,0) AS S16_5
			     , ISNULL(M2.S16_6,0) AS S16_6
			     , ISNULL(M2.S16_7,0) AS S16_7
			     , ISNULL(M2.S16_8,0) AS S16_8
			     , ISNULL(M2.S16_9,0) AS S16_9
			     , ISNULL(M2.S16_10,0) AS S16_10
			     , ISNULL(M2.S16_11,0) AS S16_11
			     , ISNULL(M2.S16_12,0) AS S16_12
			     , ISNULL(M2.S16_13,0) AS S16_13
			     , ISNULL(M2.S16_14,0) AS S16_14
			     , ISNULL(M3.G17,0) AS G17       , ISNULL(M3.G18,0) AS G18
			     , ISNULL(M3.G19,0) AS G19       , ISNULL(M3.G20,0) AS G20       , ISNULL(M3.G21,0) AS G21
			     , ISNULL(M3.G22,0) AS G22       , ISNULL(M3.G23,0) AS G23       , ISNULL(M3.G24,0) AS G24
			     , ISNULL(M3.G25,0) AS G25       , ISNULL(M3.G26,0) AS G26       , ISNULL(M3.G26_1,0) AS G26_1
			     , ISNULL(M3.G26_2,0) AS G26_2   , ISNULL(M3.G26_3,0) AS G26_3   , ISNULL(M3.G26_4,0) AS G26_4
			     , ISNULL(M3.G26_5,0) AS G26_5   , ISNULL(M3.G27,0) AS G27       , ISNULL(M5.H10,0) AS H10
			     , ISNULL(M5.H11,0) AS H11       , ISNULL(M5.H12,0) AS H12       , ISNULL(M5.H13,0) AS H13
			     , ISNULL(M5.H14,0) AS H14       , ISNULL(M5.H15,0) AS H15       , ISNULL(M5.H16,0) AS H16
			     , ISNULL(M5.H17,0) AS H17       , ISNULL(M5.H18,0) AS H18       , ISNULL(M5.H19,0) AS H19 
			     , ISNULL(M5.H20,0) AS H20       , ISNULL(M5.H21,0) AS H21       , ISNULL(M5.H22,0) AS H22
			     , ISNULL(M5.H23,0) AS H23       , ISNULL(M5.H24,0) AS H24
			     , HM2.HH1      , HM2.HH2        , HM2.HH3
			     , HM2.HH4      , HM2.HH5        , HM2.HH6
			     , HM2.HH7      , HM2.HH8        , HM2.HH9
			     , HM2.HH10     , HM2.HH11       , HM2.HH12
			     , HM2.HH13     , HM2.HH14       , HM2.HH15
			     , HM2.HH16     
			     , HM2.HH16_1     
			     , HM2.HH16_2     
			     , HM2.HH16_3     
			     , HM2.HH16_4     
			     , HM2.HH16_5     
			     , HM2.HH16_6     
			     , HM2.HH16_7     
			     , HM2.HH16_8     
			     , HM2.HH16_9     
			     , HM2.HH16_10     
			     , HM2.HH16_11     
			     , HM2.HH16_12     
			     , HM2.HH16_13     
			     , HM2.HH16_14     
			                    , HM3.HH17       , HM3.HH18
			     , HM3.HH19     , HM3.HH20       , HM3.HH21
			     , HM3.HH22     , HM3.HH23       , HM3.HH24
			     , HM3.HH25     , HM3.HH26       , HM3.HH26_1
			     , HM3.HH26_2   , HM3.HH26_3     , HM3.HH26_4
			     , HM3.HH26_5   , HM3.HH27       , HM4.HH28
			     , HM4.HH29     , HM4.HH30       , HM4.HH31
			     , HM4.HH32     , HM4.HH33       , HM4.HH34
			     , HM4.HH35     , HM4.HH36       , HM4.HH37
			     , HM4.HH38     , HM4.HH39       , HM4.HH40
			     , HM4.HH41     , HM4.HH42        
			     , ISNULL(D.LIMIT_PAY_SUPP_I, 0) AS NON_TAX_TOT     
			     , ISNULL(M4.SAT_DAY  , 0) AS SAT_DAY
			     , ISNULL(M4.SUN_DAY  , 0) AS SUN_DAY
			     , ISNULL(M4.WEEK_GIVE, 0) AS WEEK_GIVE
			     , ISNULL(M1.REMARK, '')   AS REMARK
			  FROM            HUM100T M0 WITH (NOLOCK)
			       INNER JOIN HPA600T M1 WITH (NOLOCK) ON M1.COMP_CODE   = M0.COMP_CODE
			                                          AND M1.PERSON_NUMB = M0.PERSON_NUMB
			                                          
			       LEFT JOIN CBM600T M9 WITH (NOLOCK) ON M9.COMP_CODE      = M0.COMP_CODE
			                                         AND M9.COST_POOL_CODE = M0.COST_KIND
			                                          
			       LEFT  JOIN (SELECT A.COMP_CODE
			                        , A.PAY_YYYYMM
			                        , A.SUPP_TYPE
			                        , A.PERSON_NUMB
			                        , SUM(ISNULL(A.LIMIT_PAY_SUPP_I, 0)) AS LIMIT_PAY_SUPP_I
			                     FROM            HPA800T A WITH (NOLOCK)
			                    GROUP BY A.COMP_CODE, A.PAY_YYYYMM, A.SUPP_TYPE, A.PERSON_NUMB
			                  )       D                ON D.COMP_CODE    = M1.COMP_CODE
			                                          AND D.PAY_YYYYMM   = M1.PAY_YYYYMM
			                                          AND D.SUPP_TYPE    = M1.SUPP_TYPE
			                                          AND D.PERSON_NUMB  = M1.PERSON_NUMB
			       LEFT  JOIN BSA100T B1 WITH (NOLOCK) ON B1.COMP_CODE   = M0.COMP_CODE
			                                          AND B1.MAIN_CODE   = 'H024'
			                                          AND B1.SUB_CODE    = M0.EMPLOY_TYPE
			       LEFT  JOIN BSA100T B2 WITH (NOLOCK) ON B2.COMP_CODE   = M0.COMP_CODE
			                                          AND B2.MAIN_CODE   = 'H181'
			                                          AND B2.SUB_CODE    = ISNULL(B1.REF_CODE1, '')
			       LEFT  JOIN BSA100T B3 WITH (NOLOCK) ON B3.COMP_CODE   = M1.COMP_CODE
			                                          AND B3.MAIN_CODE   = 'H005'
			                                          AND B3.SUB_CODE    = M1.POST_CODE
			       LEFT  JOIN BSA100T B4 WITH (NOLOCK) ON B4.COMP_CODE   = M0.COMP_CODE
			                                          AND B4.MAIN_CODE   = 'H175'
			                                          AND B4.SUB_CODE    = '11'           -- (공공)인사카드 임면사항 직급
			       LEFT  JOIN BSA100T B5 WITH (NOLOCK) ON B5.COMP_CODE   = M1.COMP_CODE
			                                          AND B5.MAIN_CODE   = 'H006'
			                                          AND B5.SUB_CODE    = M1.ABIL_CODE
			       LEFT  JOIN HAT300T M4 WITH (NOLOCK) ON M4.COMP_CODE   = M1.COMP_CODE
			                                          AND M4.PERSON_NUMB = M1.PERSON_NUMB
			                                          AND M4.DUTY_YYYYMM = M1.PAY_YYYYMM
			       INNER JOIN (SELECT T1.PERSON_NUMB
			                        , MAX(CASE WHEN T4.C1!= ''  THEN T4.C1   ELSE '' END) AS 'HH1'
			                        , MAX(CASE WHEN T4.C2!= ''  THEN T4.C2   ELSE '' END) AS 'HH2'
			                        , MAX(CASE WHEN T4.C3!= ''  THEN T4.C3   ELSE '' END) AS 'HH3'
			                        , MAX(CASE WHEN T4.C4!= ''  THEN T4.C4   ELSE '' END) AS 'HH4'
			                        , MAX(CASE WHEN T4.C5!= ''  THEN T4.C5   ELSE '' END) AS 'HH5'
			                        , MAX(CASE WHEN T4.C6!= ''  THEN T4.C6   ELSE '' END) AS 'HH6'
			                        , MAX(CASE WHEN T4.C7!= ''  THEN T4.C7   ELSE '' END) AS 'HH7'
			                        , MAX(CASE WHEN T4.C8!= ''  THEN T4.C8   ELSE '' END) AS 'HH8'
			                        , MAX(CASE WHEN T4.C9!= ''  THEN T4.C9   ELSE '' END) AS 'HH9'
			                        , MAX(CASE WHEN T4.C10!= '' THEN T4.C10  ELSE '' END) AS 'HH10'
			                        , MAX(CASE WHEN T4.C11!= '' THEN T4.C11  ELSE '' END) AS 'HH11'
			                        , MAX(CASE WHEN T4.C12!= '' THEN T4.C12  ELSE '' END) AS 'HH12'
			                        , MAX(CASE WHEN T4.C13!= '' THEN T4.C13  ELSE '' END) AS 'HH13'
			                        , MAX(CASE WHEN T4.C14!= '' THEN T4.C14  ELSE '' END) AS 'HH14'
			                        , MAX(CASE WHEN T4.C15!= '' THEN T4.C15  ELSE '' END) AS 'HH15'
			                        , MAX(CASE WHEN T4.C16!= '' THEN T4.C16  ELSE '' END) AS 'HH16'
			                        , MAX(CASE WHEN T4.C17!= '' THEN T4.C17  ELSE '' END) AS 'HH16_1'
			                        , MAX(CASE WHEN T4.C18!= '' THEN T4.C18  ELSE '' END) AS 'HH16_2'
			                        , MAX(CASE WHEN T4.C19!= '' THEN T4.C19  ELSE '' END) AS 'HH16_3'
			                        , MAX(CASE WHEN T4.C20!= '' THEN T4.C20  ELSE '' END) AS 'HH16_4'
			                        , MAX(CASE WHEN T4.C21!= '' THEN T4.C21  ELSE '' END) AS 'HH16_5'
			                        , MAX(CASE WHEN T4.C22!= '' THEN T4.C22  ELSE '' END) AS 'HH16_6'
			                        , MAX(CASE WHEN T4.C23!= '' THEN T4.C23  ELSE '' END) AS 'HH16_7'
			                        , MAX(CASE WHEN T4.C24!= '' THEN T4.C24  ELSE '' END) AS 'HH16_8'
			                        , MAX(CASE WHEN T4.C25!= '' THEN T4.C25  ELSE '' END) AS 'HH16_9'
			                        , MAX(CASE WHEN T4.C26!= '' THEN T4.C26  ELSE '' END) AS 'HH16_10'
			                        , MAX(CASE WHEN T4.C27!= '' THEN T4.C27  ELSE '' END) AS 'HH16_11'
			                        , MAX(CASE WHEN T4.C28!= '' THEN T4.C28  ELSE '' END) AS 'HH16_12'
			                        , MAX(CASE WHEN T4.C29!= '' THEN T4.C29  ELSE '' END) AS 'HH16_13'
			                        , MAX(CASE WHEN T4.C30!= '' THEN T4.C30  ELSE '' END) AS 'HH16_14'
			                        , T1.COMP_CODE
			                     FROM (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
			                                , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
			                                , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
			                                , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
			                                , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
			                                , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
			                                , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
			                                , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
			                                , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
			                                , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
			                                , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
			                                , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
			                                , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
			                                , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
			                                , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
			                                , MAX(CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) AS 'C16'
			                                , MAX(CASE WHEN W_SEQ = 17 THEN WAGES_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN W_SEQ = 18 THEN WAGES_CODE ELSE '' END) AS 'C18'
			                                , MAX(CASE WHEN W_SEQ = 19 THEN WAGES_CODE ELSE '' END) AS 'C19'
			                                , MAX(CASE WHEN W_SEQ = 20 THEN WAGES_CODE ELSE '' END) AS 'C20'
			                                , MAX(CASE WHEN W_SEQ = 21 THEN WAGES_CODE ELSE '' END) AS 'C21'
			                                , MAX(CASE WHEN W_SEQ = 22 THEN WAGES_CODE ELSE '' END) AS 'C22'
			                                , MAX(CASE WHEN W_SEQ = 23 THEN WAGES_CODE ELSE '' END) AS 'C23'
			                                , MAX(CASE WHEN W_SEQ = 24 THEN WAGES_CODE ELSE '' END) AS 'C24'
			                                , MAX(CASE WHEN W_SEQ = 25 THEN WAGES_CODE ELSE '' END) AS 'C25'
			                                , MAX(CASE WHEN W_SEQ = 26 THEN WAGES_CODE ELSE '' END) AS 'C26'
			                                , MAX(CASE WHEN W_SEQ = 27 THEN WAGES_CODE ELSE '' END) AS 'C27'
			                                , MAX(CASE WHEN W_SEQ = 28 THEN WAGES_CODE ELSE '' END) AS 'C28'
			                                , MAX(CASE WHEN W_SEQ = 29 THEN WAGES_CODE ELSE '' END) AS 'C29'
			                                            , MAX(CASE WHEN W_SEQ &gt;= 30 
			                                                THEN 'zzz'
			                                                ELSE (CASE WHEN W_SEQ = 30 THEN WAGES_CODE ELSE '' END) 
			                                       END) AS 'C30'
			                             FROM HBO800PH_${S_COMP_CODE}) T4
			                        , HPA600T T1 WITH (NOLOCK)
			                    WHERE T1.COMP_CODE      = #{S_COMP_CODE}
			                      AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
			                      AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
			                      AND T1.SUPP_TYPE      = '1'
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM2 ON HM2.COMP_CODE   = M1.COMP_CODE
			                                                              AND HM2.PERSON_NUMB = M1.PERSON_NUMB
			       INNER JOIN (SELECT T1.PERSON_NUMB
			                        , MAX(CASE WHEN T4.C17!= ''    THEN T4.C17   ELSE '' END) AS 'HH17'
			                        , MAX(CASE WHEN T4.C18!= ''    THEN T4.C18   ELSE '' END) AS 'HH18'
			                        , MAX(CASE WHEN T4.C19!= ''    THEN T4.C19   ELSE '' END) AS 'HH19'
			                        , MAX(CASE WHEN T4.C20!= ''    THEN T4.C20   ELSE '' END) AS 'HH20'
			                        , MAX(CASE WHEN T4.C21!= ''    THEN T4.C21   ELSE '' END) AS 'HH21'
			                        , MAX(CASE WHEN T4.C22!= ''    THEN T4.C22   ELSE '' END) AS 'HH22'
			                        , MAX(CASE WHEN T4.C23!= ''    THEN T4.C23   ELSE '' END) AS 'HH23'
			                        , MAX(CASE WHEN T4.C24!= ''    THEN T4.C24   ELSE '' END) AS 'HH24'
			                        , MAX(CASE WHEN T4.C25!= ''    THEN T4.C25   ELSE '' END) AS 'HH25'
			                        , MAX(CASE WHEN T4.C26!= ''    THEN T4.C26   ELSE '' END) AS 'HH26' 
			                        , MAX(CASE WHEN T4.C26_1!= ''  THEN T4.C26_1 ELSE '' END) AS 'HH26_1'
			                        , MAX(CASE WHEN T4.C26_2!= ''  THEN T4.C26_2 ELSE '' END) AS 'HH26_2'
			                        , MAX(CASE WHEN T4.C26_3!= ''  THEN T4.C26_3 ELSE '' END) AS 'HH26_3'
			                        , MAX(CASE WHEN T4.C26_4!= ''  THEN T4.C26_4 ELSE '' END) AS 'HH26_4'
			                        , MAX(CASE WHEN T4.C26_5!= ''  THEN T4.C26_5 ELSE '' END) AS 'HH26_5'
			                        , MAX(CASE WHEN T4.C27!= ''    THEN T4.C27   ELSE '' END) AS 'HH27'
			                        , T1.COMP_CODE
			                     FROM (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
			                                , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
			                                , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
			                                , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
			                                , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C22' 
			                                , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C23' 
			                                , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C24' 
			                                , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C25' 
			                                , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C26' 
			                                , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C26_1' 
			                                , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'C26_2' 
			                                , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'C26_3' 
			                                , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'C26_4' 
			                                , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'C26_5' 
			                                , MAX(CASE WHEN A.SEQ &gt;= 16 
			                                                THEN 'zz' 
			                                                ELSE (CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) 
			                                       END) AS 'C27'
			                             FROM HPA900PH_${S_COMP_CODE} A ) T4
			                        , HPA600T T1 WITH (NOLOCK)
			                    WHERE T1.COMP_CODE        = #{S_COMP_CODE}
			                      	AND T1.PAY_YYYYMM &gt;= #{DATE_FR} 
				                    AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
				                    AND T1.SUPP_TYPE      = '1'  
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM3 ON HM3.COMP_CODE   = M1.COMP_CODE
			                                                              AND HM3.PERSON_NUMB = M1.PERSON_NUMB
			       LEFT  JOIN (SELECT T1.PERSON_NUMB
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C1  THEN T1.AMOUNT_I ELSE 0 END) AS 'S1'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C2  THEN T1.AMOUNT_I ELSE 0 END) AS 'S2'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C3  THEN T1.AMOUNT_I ELSE 0 END) AS 'S3'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C4  THEN T1.AMOUNT_I ELSE 0 END) AS 'S4'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C5  THEN T1.AMOUNT_I ELSE 0 END) AS 'S5'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C6  THEN T1.AMOUNT_I ELSE 0 END) AS 'S6'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C7  THEN T1.AMOUNT_I ELSE 0 END) AS 'S7'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C8  THEN T1.AMOUNT_I ELSE 0 END) AS 'S8'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C9  THEN T1.AMOUNT_I ELSE 0 END) AS 'S9'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C10 THEN T1.AMOUNT_I ELSE 0 END) AS 'S10'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C11 THEN T1.AMOUNT_I ELSE 0 END) AS 'S11'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C12 THEN T1.AMOUNT_I ELSE 0 END) AS 'S12'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C13 THEN T1.AMOUNT_I ELSE 0 END) AS 'S13'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C14 THEN T1.AMOUNT_I ELSE 0 END) AS 'S14'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C15 THEN T1.AMOUNT_I ELSE 0 END) AS 'S15'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C16 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C17 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_1'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C18 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_2'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C19 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_3'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C20 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_4'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C21 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_5'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C22 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_6'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C23 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_7'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C24 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_8'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C25 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_9'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C26 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_10'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C27 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_11'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C28 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_12'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C29 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_13'
			                        , MAX(CASE WHEN T4.C30 = 'zzz' 
			                                        THEN ISNULL(T5.ETC_AMT,0)
			                                        ELSE (CASE WHEN T1.WAGES_CODE = T4.C30 THEN T1.AMOUNT_I ELSE 0 END) 
			                               END) AS 'S16_14'
			                        , T1.COMP_CODE
			                        , T1.PAY_YYYYMM
			                     FROM HPA300T T1 WITH (NOLOCK)
			                          LEFT JOIN (SELECT PERSON_NUMB
			                                          , SUM(AMOUNT_I) AS ETC_AMT 
			                                          , COMP_CODE 
			                                          , PAY_YYYYMM
			                                       FROM HPA300T WITH (NOLOCK)
			                                      WHERE COMP_CODE      = #{S_COMP_CODE}
			                                        AND PAY_YYYYMM &gt;= #{DATE_FR}
			                                        AND PAY_YYYYMM &lt;= #{DATE_TO} 
			                                        AND SUPP_TYPE      = '1'
			                                        AND WAGES_CODE IN (SELECT WAGES_CODE 
			                                                             FROM HBO800PH_${S_COMP_CODE}
			                                                            WHERE W_SEQ &gt;= 30 )
			                                                            GROUP BY PERSON_NUMB, COMP_CODE, PAY_YYYYMM) T5 ON T5.COMP_CODE   = T1.COMP_CODE
			                                                                                                           AND T5.PERSON_NUMB = T1.PERSON_NUMB
			                                                                                                           AND T5.PAY_YYYYMM = T1.PAY_YYYYMM
			                        , (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
			                                , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
			                                , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
			                                , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
			                                , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
			                                , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
			                                , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
			                                , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
			                                , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
			                                , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
			                                , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
			                                , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
			                                , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
			                                , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
			                                , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
			                                , MAX(CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) AS 'C16'
			                                , MAX(CASE WHEN W_SEQ = 17 THEN WAGES_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN W_SEQ = 18 THEN WAGES_CODE ELSE '' END) AS 'C18'
			                                , MAX(CASE WHEN W_SEQ = 19 THEN WAGES_CODE ELSE '' END) AS 'C19'
			                                , MAX(CASE WHEN W_SEQ = 20 THEN WAGES_CODE ELSE '' END) AS 'C20'
			                                , MAX(CASE WHEN W_SEQ = 21 THEN WAGES_CODE ELSE '' END) AS 'C21'
			                                , MAX(CASE WHEN W_SEQ = 22 THEN WAGES_CODE ELSE '' END) AS 'C22'
			                                , MAX(CASE WHEN W_SEQ = 23 THEN WAGES_CODE ELSE '' END) AS 'C23'
			                                , MAX(CASE WHEN W_SEQ = 24 THEN WAGES_CODE ELSE '' END) AS 'C24'
			                                , MAX(CASE WHEN W_SEQ = 25 THEN WAGES_CODE ELSE '' END) AS 'C25'
			                                , MAX(CASE WHEN W_SEQ = 26 THEN WAGES_CODE ELSE '' END) AS 'C26'
			                                , MAX(CASE WHEN W_SEQ = 27 THEN WAGES_CODE ELSE '' END) AS 'C27'
			                                , MAX(CASE WHEN W_SEQ = 28 THEN WAGES_CODE ELSE '' END) AS 'C28'
			                                , MAX(CASE WHEN W_SEQ = 29 THEN WAGES_CODE ELSE '' END) AS 'C29'
			                                , MAX(CASE WHEN W_SEQ &gt;= 30 THEN 'zzz' 
			                                                                ELSE '' 
			                                       END) AS 'C30'
			                             FROM HBO800PH_${S_COMP_CODE} ) T4
			                    WHERE T1.COMP_CODE       = #{S_COMP_CODE}
			                      AND T1.PAY_YYYYMM  &gt;= #{DATE_FR} 
			                      AND T1.PAY_YYYYMM  &lt;= #{DATE_TO} 
			                      AND T1.SUPP_TYPE       = '1'
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M2 ON M2.COMP_CODE   = M1.COMP_CODE
			                                                                            AND M2.PERSON_NUMB = M1.PERSON_NUMB 
			                                                                            AND M2.PAY_YYYYMM  = M1.PAY_YYYYMM 
			       LEFT  JOIN (SELECT T1.PERSON_NUMB
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C17   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G17'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C18   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G18'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C19   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G19'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C20   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G20'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C21   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G21'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C22   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G22'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C23   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G23'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C24   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G24'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C25   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G25'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_1 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_1'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_2 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_2'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_3 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_3'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_4 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_4'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_5 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_5'
			                        , MAX(CASE WHEN T4.C27 = 'zz' 
			                                        THEN ISNULL(T5.ETC_AMT,0)
			                                        ELSE (CASE WHEN T1.DED_CODE = T4.C27 THEN T1.DED_AMOUNT_I ELSE 0 END) 
			                               END) AS 'G27'
			                        , T1.COMP_CODE
			                        , T1.PAY_YYYYMM
			                     FROM HPA400T T1 WITH (NOLOCK)
			                          LEFT JOIN (SELECT PERSON_NUMB
			                                          , SUM(DED_AMOUNT_I) AS ETC_AMT 
			                                          , COMP_CODE
			                                          , PAY_YYYYMM
			                                       FROM HPA400T WITH (NOLOCK)
			                                      WHERE COMP_CODE      = #{S_COMP_CODE}
			                                        AND PAY_YYYYMM &gt;= #{DATE_FR}
				                                    AND PAY_YYYYMM &lt;= #{DATE_TO} 
				                                    AND SUPP_TYPE      = '1'
			                                        AND DED_CODE IN (SELECT SUB_CODE 
			                                                           FROM HPA900PH_${S_COMP_CODE}
			                                                          WHERE SEQ &gt;= 16 )
			                                                          GROUP BY PERSON_NUMB, COMP_CODE, PAY_YYYYMM) T5 ON T5.COMP_CODE   = T1.COMP_CODE
			                                                                                                         AND T5.PERSON_NUMB = T1.PERSON_NUMB
			                                                                                                         AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
			                        , (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'C17' 
			                                , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
			                                , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
			                                , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
			                                , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
			                                , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C22' 
			                                , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C23' 
			                                , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C24' 
			                                , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C25' 
			                                , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C26' 
			                                , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C26_1' 
			                                , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'C26_2' 
			                                , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'C26_3' 
			                                , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'C26_4' 
			                                , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'C26_5' 
			                                , MAX(CASE WHEN A.SEQ &gt;= 16 THEN 'zz' 
			                                                           ELSE (CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) 
			                                       END) AS 'C27'
			                             FROM HPA900PH_${S_COMP_CODE} A ) T4
			                    WHERE T1.COMP_CODE        = #{S_COMP_CODE}
			                        AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
				                    AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
				                    AND T1.SUPP_TYPE      = '1'
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M3 ON M3.COMP_CODE   = M1.COMP_CODE
			                                                                            AND M3.PERSON_NUMB = M1.PERSON_NUMB
			                                                                            AND M3.PAY_YYYYMM  = M1.PAY_YYYYMM
			       LEFT  JOIN (SELECT A.PERSON_NUMB
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '1'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H10'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '2'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H11'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '3'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H12'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '4'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H13'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '5'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H14'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '6'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H15'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '7'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H16'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '8'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H17'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '9'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H18'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '10'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H19'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '11'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H20'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '12'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H21'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '13'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H22'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '14'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H23'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '15'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H24'
			                        , A.COMP_CODE
			                        , A.DUTY_YYYYMM
			                     FROM HAT200T A, HAT200PH_${S_COMP_CODE} B
			                    WHERE A.COMP_CODE       = #{S_COMP_CODE}
			                      AND A.DUTY_CODE       = B.SUB_CODE
			                      AND A.DUTY_YYYYMM &gt;= #{DATE_FR}
			                      AND A.DUTY_YYYYMM &lt;= #{DATE_TO}
			                    GROUP BY A.PERSON_NUMB, A.COMP_CODE, A.DUTY_YYYYMM) M5 ON M5.COMP_CODE   = M1.COMP_CODE
			                                                                          AND M5.PERSON_NUMB = M1.PERSON_NUMB
			                                                                          AND M5.DUTY_YYYYMM = M1.PAY_YYYYMM
			       LEFT  JOIN (SELECT A.COMP_CODE
			                        , A.PAY_YYYYMM
			                        , A.SUPP_TYPE
			                        , A.PERSON_NUMB
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('O01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 연장근로 비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION1_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('P01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 식대비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION2_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('M01', 'M02', 'M03')  -- 국외근로 비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION4_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('Q01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 자녀양육비비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION5_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('H06', 'H07', 'H08', 'H09', 'H10')  -- 연구활동비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION6_I
			                        , SUM(CASE WHEN A.NONTAX_CODE NOT IN ('O01', 'P01', 'M01', 'M02', 'M03', 'Q01', 'H06', 'H07', 'H08', 'H09', 'H10')  -- 기타비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION3_I
			                     FROM            HPA800T A WITH (NOLOCK)
			                    GROUP BY A.COMP_CODE, A.PAY_YYYYMM, A.SUPP_TYPE, A.PERSON_NUMB
			                  ) M6                      ON M6.COMP_CODE   = M1.COMP_CODE
			                                           AND M6.PAY_YYYYMM  = M1.PAY_YYYYMM
			                                           AND M6.SUPP_TYPE   = M1.SUPP_TYPE
			                                           AND M6.PERSON_NUMB = M1.PERSON_NUMB
			     , (SELECT MAX(CASE WHEN SEQ = 1  THEN CODE_NAME ELSE '' END) AS HH28
			             , MAX(CASE WHEN SEQ = 2  THEN CODE_NAME ELSE '' END) AS HH29
			             , MAX(CASE WHEN SEQ = 3  THEN CODE_NAME ELSE '' END) AS HH30
			             , MAX(CASE WHEN SEQ = 4  THEN CODE_NAME ELSE '' END) AS HH31
			             , MAX(CASE WHEN SEQ = 5  THEN CODE_NAME ELSE '' END) AS HH32
			             , MAX(CASE WHEN SEQ = 6  THEN CODE_NAME ELSE '' END) AS HH33
			             , MAX(CASE WHEN SEQ = 7  THEN CODE_NAME ELSE '' END) AS HH34
			             , MAX(CASE WHEN SEQ = 8  THEN CODE_NAME ELSE '' END) AS HH35
			             , MAX(CASE WHEN SEQ = 9  THEN CODE_NAME ELSE '' END) AS HH36
			             , MAX(CASE WHEN SEQ = 10 THEN CODE_NAME ELSE '' END) AS HH37
			             , MAX(CASE WHEN SEQ = 11 THEN CODE_NAME ELSE '' END) AS HH38
			             , MAX(CASE WHEN SEQ = 12 THEN CODE_NAME ELSE '' END) AS HH39
			             , MAX(CASE WHEN SEQ = 13 THEN CODE_NAME ELSE '' END) AS HH40
			             , MAX(CASE WHEN SEQ = 14 THEN CODE_NAME ELSE '' END) AS HH41
			             , MAX(CASE WHEN SEQ = 15 THEN CODE_NAME ELSE '' END) AS HH42
			          FROM HAT200PH_${S_COMP_CODE} ) HM4
			 WHERE M1.COMP_CODE       = #{S_COMP_CODE}
			   AND M1.PAY_YYYYMM  &gt;= #{DATE_FR}
			   AND M1.PAY_YYYYMM  &lt;= #{DATE_TO}
			   AND M1.SUPP_TYPE       = '1'
			</when>
			
	   </choose>
		
	   <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
	         AND M1.DIV_CODE   = #{DIV_CODE}
		</if>
	   	<if test="@foren.Ognl@isNotEmpty(DEPT_FR)">
	         AND M1.DEPT_CODE &gt;= #{DEPT_FR}
	   	</if>   
		<if test="@foren.Ognl@isNotEmpty(DEPT_TO)">
		         AND M1.DEPT_CODE &lt;= #{DEPT_TO}
		</if>
	   
	  	<if test="@foren.Ognl@isNotEmpty(PAY_CODE)">
	         AND M1.PAY_CODE   = #{PAY_CODE}
	  	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PAY_DAY_FLAG)">
	         AND M1.PAY_PROV_FLAG = #{PAY_DAY_FLAG}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">
	         AND M1.PERSON_NUMB = #{PERSON_NUMB}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">
	         AND M1.PAY_GUBUN   = #{PAY_GUBUN}
	   	</if>
	   
	   	<if test="STRTYPE != 4 and STRTYPE != 5 and CONTAIN_ZERO != 'on' ">
	         AND M1.SUPP_TOTAL_I != 0 
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(SUPP_DATE)">
	         AND M1.SUPP_DATE   = #{SUPP_DATE}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(EMPLOY_TYPE)">
	         AND M0.EMPLOY_TYPE  = #{EMPLOY_TYPE}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PERSON_GROUP)">
	         AND B2.SUB_CODE  = #{PERSON_GROUP}
	   	</if>
	   
	    <if test="@foren.Ognl@isNotEmpty(COST_KIND)">
	         AND M1.COST_KIND  = #{COST_KIND}
	    </if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(AFFIL_CODE)">
	         AND M0.AFFIL_CODE  = #{AFFIL_CODE} 
	   	</if>
	   	
	   	<choose>
	   		<when test=" STRTYPE == 2 ">
	   			GROUP BY M1.DEPT_CODE,M1.PAY_YYYYMM
	   		</when>
		   	<otherwise>
		   		<choose>
	   				<when test=" STRTYPE == 3">
	       				ORDER BY M1.DIV_CODE, M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE,  M1.PERSON_NUMB
	   				</when>
	   				<otherwise>
	       				--ORDER BY M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE,  M1.PERSON_NUMB
	       				ORDER BY ROW_NUMBER() OVER ( ORDER BY M1.PAY_YYYYMM , M9.COST_POOL_CODE)
	   				</otherwise>
	   			</choose>
		   	</otherwise>
	   	</choose>
   	
	</select>
	
	
	<select id="s_hpa901rkr_sdServiceImpl.selectList2" parameterType="Map" resultType="rMap">
		<choose>
			<when test="STRTYPE != 2">
			--s_hpa901rkr_sdServiceImpl [selectList2] 
			SELECT M1.PAY_YYYYMM 
			     , M1.SUPP_TYPE
			     , M1.POST_CODE
			     , M0.PAY_GRADE_01 AS  PAY_GRADE1
			     , M1.DIV_CODE
 			     , M9.COST_POOL_CODE AS DEPT_CODE
			     , M9.COST_POOL_NAME AS DEPT_NAME
			     , '' AS TREE_CODE
			     , M1.PAY_CODE 
			     , M1.PAY_PROV_FLAG
			     , M1.PERSON_NUMB
			     , M0.NAME
			     , unilite.fnCipherDecrypt(M0.REPRE_NUM, 'RR') REPRE_NUM
			     , M0.JOIN_DATE
			     , M0.RETR_DATE
			     , (CASE WHEN M0.PAY_CODE != '3' 
			                  THEN ISNULL(M4.WORK_DAY,0) 
			                  ELSE ISNULL(M4.WORK_TIME, 0) 
			         END) AS WORK_DAY
			     , ISNULL(M4.TOT_DAY,0) AS TOT_DAY
			     , M4.WORK_DAY AS R_WORK_DAY
			     , M4.WORK_TIME
			     , (SELECT EXTEND_WORK_YN
			          FROM HBS400T
			         WHERE COMP_CODE = #{S_COMP_CODE}) AS EXTEND_WORK_YN
			     , CASE (SELECT EXTEND_WORK_YN
			               FROM HBS400T
			              WHERE COMP_CODE = #{S_COMP_CODE}) WHEN 'Y' THEN M4.EXTEND_WORK_TIME 
			                                                      ELSE 0 
			                                                      END EXTEND_WORK_TIME
			     , (SELECT DIV_NAME
			          FROM BOR120T WITH(NOLOCK)
			         WHERE COMP_CODE = #{S_COMP_CODE}
			           AND DIV_CODE  = M1.DIV_CODE) AS DIV_NAME
			    
			     , CASE WHEN ISNULL(B4.REF_CODE1, '') = 'Y'
			                 THEN CASE WHEN ISNULL(B4.REF_CODE2, '') = '1' THEN ISNULL(B3.CODE_NAME, '')
			                           WHEN ISNULL(B4.REF_CODE2, '') = '2'
			                                THEN CASE WHEN ISNULL(B3.CODE_NAME, '') = ISNULL(B5.CODE_NAME, '') THEN ISNULL(B3.CODE_NAME, '')
			                                          ELSE ISNULL(B3.CODE_NAME, '') + ' ' + ISNULL(B5.CODE_NAME, '')
			                                     END
			                           ELSE B3.CODE_NAME
			                      END
			            ELSE B3.CODE_NAME
			       END                                                  AS POST_NM
			     , '' AS GRADE
			     , M0.PAY_GRADE_02 AS PAY_GRADE2
			     , (SELECT CODE_NAME 
			          FROM BSA100T 
			         WHERE COMP_CODE = #{S_COMP_CODE}
			           AND MAIN_CODE = 'H011' 
			           AND SUB_CODE  = M1.PAY_GUBUN) AS PAY_GUBUN
			     , M0.SPOUSE
			     , M0.SUPP_AGED_NUM
			     , M0.CHILD_20_NUM
			     , M0.DEFORM_NUM
			     , M0.AGED_NUM
			     , ISNULL(M1.SUPP_TOTAL_I,0) AS SUPP_TOTAL_I 
			     , ISNULL(M1.DED_TOTAL_I,0) AS DED_TOTAL_I
			     , ISNULL(M1.REAL_AMOUNT_I,0) AS REAL_AMOUNT_I 
			     , unilite.fnCipherDecrypt(M0.BANK_ACCOUNT1, 'RB') BANK_ACCOUNT1 
			     , ISNULL(M2.S1,0) AS S1         , ISNULL(M2.S2,0) AS S2         , ISNULL(M2.S3,0) AS S3
			     , ISNULL(M2.S4,0) AS S4         , ISNULL(M2.S5,0) AS S5         , ISNULL(M2.S6,0) AS S6
			     , ISNULL(M2.S7,0) AS S7         , ISNULL(M2.S8,0) AS S8         , ISNULL(M2.S9,0) AS S9
			     , ISNULL(M2.S10,0) AS S10       , ISNULL(M2.S11,0) AS S11       , ISNULL(M2.S12,0) AS S12
			     , ISNULL(M2.S13,0) AS S13       , ISNULL(M2.S14,0) AS S14       , ISNULL(M2.S15,0) AS S15
			     , ISNULL(M2.S16,0) AS S16
			     , ISNULL(M2.S16_1,0) AS S16_1
			     , ISNULL(M2.S16_2,0) AS S16_2
			     , ISNULL(M2.S16_3,0) AS S16_3
			     , ISNULL(M2.S16_4,0) AS S16_4
			     , ISNULL(M2.S16_5,0) AS S16_5
			     , ISNULL(M2.S16_6,0) AS S16_6
			     , ISNULL(M2.S16_7,0) AS S16_7
			     , ISNULL(M2.S16_8,0) AS S16_8
			     , ISNULL(M2.S16_9,0) AS S16_9
			     , ISNULL(M2.S16_10,0) AS S16_10
			     , ISNULL(M2.S16_11,0) AS S16_11
			     , ISNULL(M2.S16_12,0) AS S16_12
			     , ISNULL(M2.S16_13,0) AS S16_13
			     , ISNULL(M2.S16_14,0) AS S16_14
			     , ISNULL(M3.G17,0) AS G17       , ISNULL(M3.G18,0) AS G18
			     , ISNULL(M3.G19,0) AS G19       , ISNULL(M3.G20,0) AS G20       , ISNULL(M3.G21,0) AS G21
			     , ISNULL(M3.G22,0) AS G22       , ISNULL(M3.G23,0) AS G23       , ISNULL(M3.G24,0) AS G24
			     , ISNULL(M3.G25,0) AS G25       , ISNULL(M3.G26,0) AS G26       , ISNULL(M3.G26_1,0) AS G26_1
			     , ISNULL(M3.G26_2,0) AS G26_2   , ISNULL(M3.G26_3,0) AS G26_3   , ISNULL(M3.G26_4,0) AS G26_4
			     , ISNULL(M3.G26_5,0) AS G26_5   , ISNULL(M3.G27,0) AS G27       , ISNULL(M5.H10,0) AS H10
			     , ISNULL(M5.H11,0) AS H11       , ISNULL(M5.H12,0) AS H12       , ISNULL(M5.H13,0) AS H13
			     , ISNULL(M5.H14,0) AS H14       , ISNULL(M5.H15,0) AS H15       , ISNULL(M5.H16,0) AS H16
			     , ISNULL(M5.H17,0) AS H17       , ISNULL(M5.H18,0) AS H18       , ISNULL(M5.H19,0) AS H19 
			     , ISNULL(M5.H20,0) AS H20       , ISNULL(M5.H21,0) AS H21       , ISNULL(M5.H22,0) AS H22
			     , ISNULL(M5.H23,0) AS H23       , ISNULL(M5.H24,0) AS H24
			     , HM2.HH1      , HM2.HH2        , HM2.HH3
			     , HM2.HH4      , HM2.HH5        , HM2.HH6
			     , HM2.HH7      , HM2.HH8        , HM2.HH9
			     , HM2.HH10     , HM2.HH11       , HM2.HH12
			     , HM2.HH13     , HM2.HH14       , HM2.HH15
			     , HM2.HH16     
			     , HM2.HH16_1     
			     , HM2.HH16_2     
			     , HM2.HH16_3     
			     , HM2.HH16_4     
			     , HM2.HH16_5     
			     , HM2.HH16_6     
			     , HM2.HH16_7     
			     , HM2.HH16_8     
			     , HM2.HH16_9     
			     , HM2.HH16_10     
			     , HM2.HH16_11     
			     , HM2.HH16_12     
			     , HM2.HH16_13     
			     , HM2.HH16_14     
			                    , HM3.HH17       , HM3.HH18
			     , HM3.HH19     , HM3.HH20       , HM3.HH21
			     , HM3.HH22     , HM3.HH23       , HM3.HH24
			     , HM3.HH25     , HM3.HH26       , HM3.HH26_1
			     , HM3.HH26_2   , HM3.HH26_3     , HM3.HH26_4
			     , HM3.HH26_5   , HM3.HH27       , HM4.HH28
			     , HM4.HH29     , HM4.HH30       , HM4.HH31
			     , HM4.HH32     , HM4.HH33       , HM4.HH34
			     , HM4.HH35     , HM4.HH36       , HM4.HH37
			     , HM4.HH38     , HM4.HH39       , HM4.HH40
			     , HM4.HH41     , HM4.HH42        
			     , ISNULL(D.LIMIT_PAY_SUPP_I, 0) AS NON_TAX_TOT     
			     , ISNULL(M4.SAT_DAY  , 0) AS SAT_DAY
			     , ISNULL(M4.SUN_DAY  , 0) AS SUN_DAY
			     , ISNULL(M4.WEEK_GIVE, 0) AS WEEK_GIVE
			     , ISNULL(M1.REMARK, '')   AS REMARK
			  FROM            HUM100T M0 WITH (NOLOCK)
			       INNER JOIN HPA600T M1 WITH (NOLOCK) ON M1.COMP_CODE   = M0.COMP_CODE
			                                          AND M1.PERSON_NUMB = M0.PERSON_NUMB
			                                          
			       LEFT JOIN CBM600T M9 WITH (NOLOCK) ON M9.COMP_CODE      = M0.COMP_CODE
			                                         AND M9.COST_POOL_CODE = M0.COST_KIND
			                                          
			       LEFT  JOIN (SELECT A.COMP_CODE
			                        , A.PAY_YYYYMM
			                        , A.SUPP_TYPE
			                        , A.PERSON_NUMB
			                        , SUM(ISNULL(A.LIMIT_PAY_SUPP_I, 0)) AS LIMIT_PAY_SUPP_I
			                     FROM            HPA800T A WITH (NOLOCK)
			                    GROUP BY A.COMP_CODE, A.PAY_YYYYMM, A.SUPP_TYPE, A.PERSON_NUMB
			                  )       D                ON D.COMP_CODE    = M1.COMP_CODE
			                                          AND D.PAY_YYYYMM   = M1.PAY_YYYYMM
			                                          AND D.SUPP_TYPE    = M1.SUPP_TYPE
			                                          AND D.PERSON_NUMB  = M1.PERSON_NUMB
			       LEFT  JOIN BSA100T B1 WITH (NOLOCK) ON B1.COMP_CODE   = M0.COMP_CODE
			                                          AND B1.MAIN_CODE   = 'H024'
			                                          AND B1.SUB_CODE    = M0.EMPLOY_TYPE
			       LEFT  JOIN BSA100T B2 WITH (NOLOCK) ON B2.COMP_CODE   = M0.COMP_CODE
			                                          AND B2.MAIN_CODE   = 'H181'
			                                          AND B2.SUB_CODE    = ISNULL(B1.REF_CODE1, '')
			       LEFT  JOIN BSA100T B3 WITH (NOLOCK) ON B3.COMP_CODE   = M1.COMP_CODE
			                                          AND B3.MAIN_CODE   = 'H005'
			                                          AND B3.SUB_CODE    = M1.POST_CODE
			       LEFT  JOIN BSA100T B4 WITH (NOLOCK) ON B4.COMP_CODE   = M0.COMP_CODE
			                                          AND B4.MAIN_CODE   = 'H175'
			                                          AND B4.SUB_CODE    = '11'           -- (공공)인사카드 임면사항 직급
			       LEFT  JOIN BSA100T B5 WITH (NOLOCK) ON B5.COMP_CODE   = M1.COMP_CODE
			                                          AND B5.MAIN_CODE   = 'H006'
			                                          AND B5.SUB_CODE    = M1.ABIL_CODE
			       LEFT  JOIN HAT300T M4 WITH (NOLOCK) ON M4.COMP_CODE   = M1.COMP_CODE
			                                          AND M4.PERSON_NUMB = M1.PERSON_NUMB
			                                          AND M4.DUTY_YYYYMM = M1.PAY_YYYYMM
			       INNER JOIN (SELECT T1.PERSON_NUMB
			                        , MAX(CASE WHEN T4.C1!= ''  THEN T4.C1   ELSE '' END) AS 'HH1'
			                        , MAX(CASE WHEN T4.C2!= ''  THEN T4.C2   ELSE '' END) AS 'HH2'
			                        , MAX(CASE WHEN T4.C3!= ''  THEN T4.C3   ELSE '' END) AS 'HH3'
			                        , MAX(CASE WHEN T4.C4!= ''  THEN T4.C4   ELSE '' END) AS 'HH4'
			                        , MAX(CASE WHEN T4.C5!= ''  THEN T4.C5   ELSE '' END) AS 'HH5'
			                        , MAX(CASE WHEN T4.C6!= ''  THEN T4.C6   ELSE '' END) AS 'HH6'
			                        , MAX(CASE WHEN T4.C7!= ''  THEN T4.C7   ELSE '' END) AS 'HH7'
			                        , MAX(CASE WHEN T4.C8!= ''  THEN T4.C8   ELSE '' END) AS 'HH8'
			                        , MAX(CASE WHEN T4.C9!= ''  THEN T4.C9   ELSE '' END) AS 'HH9'
			                        , MAX(CASE WHEN T4.C10!= '' THEN T4.C10  ELSE '' END) AS 'HH10'
			                        , MAX(CASE WHEN T4.C11!= '' THEN T4.C11  ELSE '' END) AS 'HH11'
			                        , MAX(CASE WHEN T4.C12!= '' THEN T4.C12  ELSE '' END) AS 'HH12'
			                        , MAX(CASE WHEN T4.C13!= '' THEN T4.C13  ELSE '' END) AS 'HH13'
			                        , MAX(CASE WHEN T4.C14!= '' THEN T4.C14  ELSE '' END) AS 'HH14'
			                        , MAX(CASE WHEN T4.C15!= '' THEN T4.C15  ELSE '' END) AS 'HH15'
			                        , MAX(CASE WHEN T4.C16!= '' THEN T4.C16  ELSE '' END) AS 'HH16'
			                        , MAX(CASE WHEN T4.C17!= '' THEN T4.C17  ELSE '' END) AS 'HH16_1'
			                        , MAX(CASE WHEN T4.C18!= '' THEN T4.C18  ELSE '' END) AS 'HH16_2'
			                        , MAX(CASE WHEN T4.C19!= '' THEN T4.C19  ELSE '' END) AS 'HH16_3'
			                        , MAX(CASE WHEN T4.C20!= '' THEN T4.C20  ELSE '' END) AS 'HH16_4'
			                        , MAX(CASE WHEN T4.C21!= '' THEN T4.C21  ELSE '' END) AS 'HH16_5'
			                        , MAX(CASE WHEN T4.C22!= '' THEN T4.C22  ELSE '' END) AS 'HH16_6'
			                        , MAX(CASE WHEN T4.C23!= '' THEN T4.C23  ELSE '' END) AS 'HH16_7'
			                        , MAX(CASE WHEN T4.C24!= '' THEN T4.C24  ELSE '' END) AS 'HH16_8'
			                        , MAX(CASE WHEN T4.C25!= '' THEN T4.C25  ELSE '' END) AS 'HH16_9'
			                        , MAX(CASE WHEN T4.C26!= '' THEN T4.C26  ELSE '' END) AS 'HH16_10'
			                        , MAX(CASE WHEN T4.C27!= '' THEN T4.C27  ELSE '' END) AS 'HH16_11'
			                        , MAX(CASE WHEN T4.C28!= '' THEN T4.C28  ELSE '' END) AS 'HH16_12'
			                        , MAX(CASE WHEN T4.C29!= '' THEN T4.C29  ELSE '' END) AS 'HH16_13'
			                        , MAX(CASE WHEN T4.C30!= '' THEN T4.C30  ELSE '' END) AS 'HH16_14'
			                        , T1.COMP_CODE
			                     FROM (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
			                                , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
			                                , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
			                                , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
			                                , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
			                                , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
			                                , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
			                                , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
			                                , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
			                                , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
			                                , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
			                                , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
			                                , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
			                                , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
			                                , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
			                                , MAX(CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) AS 'C16'
			                                , MAX(CASE WHEN W_SEQ = 17 THEN WAGES_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN W_SEQ = 18 THEN WAGES_CODE ELSE '' END) AS 'C18'
			                                , MAX(CASE WHEN W_SEQ = 19 THEN WAGES_CODE ELSE '' END) AS 'C19'
			                                , MAX(CASE WHEN W_SEQ = 20 THEN WAGES_CODE ELSE '' END) AS 'C20'
			                                , MAX(CASE WHEN W_SEQ = 21 THEN WAGES_CODE ELSE '' END) AS 'C21'
			                                , MAX(CASE WHEN W_SEQ = 22 THEN WAGES_CODE ELSE '' END) AS 'C22'
			                                , MAX(CASE WHEN W_SEQ = 23 THEN WAGES_CODE ELSE '' END) AS 'C23'
			                                , MAX(CASE WHEN W_SEQ = 24 THEN WAGES_CODE ELSE '' END) AS 'C24'
			                                , MAX(CASE WHEN W_SEQ = 25 THEN WAGES_CODE ELSE '' END) AS 'C25'
			                                , MAX(CASE WHEN W_SEQ = 26 THEN WAGES_CODE ELSE '' END) AS 'C26'
			                                , MAX(CASE WHEN W_SEQ = 27 THEN WAGES_CODE ELSE '' END) AS 'C27'
			                                , MAX(CASE WHEN W_SEQ = 28 THEN WAGES_CODE ELSE '' END) AS 'C28'
			                                , MAX(CASE WHEN W_SEQ = 29 THEN WAGES_CODE ELSE '' END) AS 'C29'
			                                            , MAX(CASE WHEN W_SEQ &gt;= 30 
			                                                THEN 'zzz'
			                                                ELSE (CASE WHEN W_SEQ = 30 THEN WAGES_CODE ELSE '' END) 
			                                       END) AS 'C30'
			                             FROM HBO800PH_${S_COMP_CODE}) T4
			                        , HPA600T T1 WITH (NOLOCK)
			                    WHERE T1.COMP_CODE      = #{S_COMP_CODE}
			                      AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
			                      AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
			                      AND T1.SUPP_TYPE      = #{SUPP_TYPE}
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM2 ON HM2.COMP_CODE   = M1.COMP_CODE
			                                                              AND HM2.PERSON_NUMB = M1.PERSON_NUMB
			       INNER JOIN (SELECT T1.PERSON_NUMB
			                        , MAX(CASE WHEN T4.C17!= ''    THEN T4.C17   ELSE '' END) AS 'HH17'
			                        , MAX(CASE WHEN T4.C18!= ''    THEN T4.C18   ELSE '' END) AS 'HH18'
			                        , MAX(CASE WHEN T4.C19!= ''    THEN T4.C19   ELSE '' END) AS 'HH19'
			                        , MAX(CASE WHEN T4.C20!= ''    THEN T4.C20   ELSE '' END) AS 'HH20'
			                        , MAX(CASE WHEN T4.C21!= ''    THEN T4.C21   ELSE '' END) AS 'HH21'
			                        , MAX(CASE WHEN T4.C22!= ''    THEN T4.C22   ELSE '' END) AS 'HH22'
			                        , MAX(CASE WHEN T4.C23!= ''    THEN T4.C23   ELSE '' END) AS 'HH23'
			                        , MAX(CASE WHEN T4.C24!= ''    THEN T4.C24   ELSE '' END) AS 'HH24'
			                        , MAX(CASE WHEN T4.C25!= ''    THEN T4.C25   ELSE '' END) AS 'HH25'
			                        , MAX(CASE WHEN T4.C26!= ''    THEN T4.C26   ELSE '' END) AS 'HH26' 
			                        , MAX(CASE WHEN T4.C26_1!= ''  THEN T4.C26_1 ELSE '' END) AS 'HH26_1'
			                        , MAX(CASE WHEN T4.C26_2!= ''  THEN T4.C26_2 ELSE '' END) AS 'HH26_2'
			                        , MAX(CASE WHEN T4.C26_3!= ''  THEN T4.C26_3 ELSE '' END) AS 'HH26_3'
			                        , MAX(CASE WHEN T4.C26_4!= ''  THEN T4.C26_4 ELSE '' END) AS 'HH26_4'
			                        , MAX(CASE WHEN T4.C26_5!= ''  THEN T4.C26_5 ELSE '' END) AS 'HH26_5'
			                        , MAX(CASE WHEN T4.C27!= ''    THEN T4.C27   ELSE '' END) AS 'HH27'
			                        , T1.COMP_CODE
			                     FROM (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
			                                , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
			                                , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
			                                , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
			                                , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C22' 
			                                , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C23' 
			                                , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C24' 
			                                , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C25' 
			                                , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C26' 
			                                , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C26_1' 
			                                , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'C26_2' 
			                                , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'C26_3' 
			                                , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'C26_4' 
			                                , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'C26_5' 
			                                , MAX(CASE WHEN A.SEQ &gt;= 16 
			                                                THEN 'zz' 
			                                                ELSE (CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) 
			                                       END) AS 'C27'
			                             FROM HPA900PH_${S_COMP_CODE} A ) T4
			                        , HPA600T T1 WITH (NOLOCK)
			                    WHERE T1.COMP_CODE        = #{S_COMP_CODE}
			                      	AND T1.PAY_YYYYMM &gt;= #{DATE_FR} 
				                    AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
				                    AND T1.SUPP_TYPE      = #{SUPP_TYPE}
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM3 ON HM3.COMP_CODE   = M1.COMP_CODE
			                                                              AND HM3.PERSON_NUMB = M1.PERSON_NUMB
			       LEFT  JOIN (SELECT T1.PERSON_NUMB
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C1  THEN T1.AMOUNT_I ELSE 0 END) AS 'S1'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C2  THEN T1.AMOUNT_I ELSE 0 END) AS 'S2'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C3  THEN T1.AMOUNT_I ELSE 0 END) AS 'S3'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C4  THEN T1.AMOUNT_I ELSE 0 END) AS 'S4'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C5  THEN T1.AMOUNT_I ELSE 0 END) AS 'S5'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C6  THEN T1.AMOUNT_I ELSE 0 END) AS 'S6'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C7  THEN T1.AMOUNT_I ELSE 0 END) AS 'S7'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C8  THEN T1.AMOUNT_I ELSE 0 END) AS 'S8'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C9  THEN T1.AMOUNT_I ELSE 0 END) AS 'S9'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C10 THEN T1.AMOUNT_I ELSE 0 END) AS 'S10'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C11 THEN T1.AMOUNT_I ELSE 0 END) AS 'S11'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C12 THEN T1.AMOUNT_I ELSE 0 END) AS 'S12'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C13 THEN T1.AMOUNT_I ELSE 0 END) AS 'S13'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C14 THEN T1.AMOUNT_I ELSE 0 END) AS 'S14'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C15 THEN T1.AMOUNT_I ELSE 0 END) AS 'S15'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C16 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C17 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_1'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C18 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_2'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C19 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_3'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C20 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_4'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C21 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_5'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C22 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_6'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C23 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_7'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C24 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_8'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C25 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_9'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C26 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_10'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C27 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_11'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C28 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_12'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C29 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_13'
			                        , MAX(CASE WHEN T4.C30 = 'zzz' 
			                                        THEN ISNULL(T5.ETC_AMT,0)
			                                        ELSE (CASE WHEN T1.WAGES_CODE = T4.C30 THEN T1.AMOUNT_I ELSE 0 END) 
			                               END) AS 'S16_14'
			                        , T1.COMP_CODE
			                        , T1.PAY_YYYYMM
			                     FROM HPA300T T1 WITH (NOLOCK)
			                          LEFT JOIN (SELECT PERSON_NUMB
			                                          , SUM(AMOUNT_I) AS ETC_AMT 
			                                          , COMP_CODE 
			                                          , PAY_YYYYMM
			                                       FROM HPA300T WITH (NOLOCK)
			                                      WHERE COMP_CODE      = #{S_COMP_CODE}
			                                        AND PAY_YYYYMM &gt;= #{DATE_FR}
			                                        AND PAY_YYYYMM &lt;= #{DATE_TO} 
			                                        AND SUPP_TYPE      = #{SUPP_TYPE}
			                                        AND WAGES_CODE IN (SELECT WAGES_CODE 
			                                                             FROM HBO800PH_${S_COMP_CODE}
			                                                            WHERE W_SEQ &gt;= 16 )
			                                                            GROUP BY PERSON_NUMB, COMP_CODE, PAY_YYYYMM) T5 ON T5.COMP_CODE   = T1.COMP_CODE
			                                                                                                           AND T5.PERSON_NUMB = T1.PERSON_NUMB
			                                                                                                           AND T5.PAY_YYYYMM = T1.PAY_YYYYMM
			                        , (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
			                                , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
			                                , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
			                                , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
			                                , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
			                                , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
			                                , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
			                                , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
			                                , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
			                                , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
			                                , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
			                                , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
			                                , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
			                                , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
			                                , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
			                                , MAX(CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) AS 'C16'
			                                , MAX(CASE WHEN W_SEQ = 17 THEN WAGES_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN W_SEQ = 18 THEN WAGES_CODE ELSE '' END) AS 'C18'
			                                , MAX(CASE WHEN W_SEQ = 19 THEN WAGES_CODE ELSE '' END) AS 'C19'
			                                , MAX(CASE WHEN W_SEQ = 20 THEN WAGES_CODE ELSE '' END) AS 'C20'
			                                , MAX(CASE WHEN W_SEQ = 21 THEN WAGES_CODE ELSE '' END) AS 'C21'
			                                , MAX(CASE WHEN W_SEQ = 22 THEN WAGES_CODE ELSE '' END) AS 'C22'
			                                , MAX(CASE WHEN W_SEQ = 23 THEN WAGES_CODE ELSE '' END) AS 'C23'
			                                , MAX(CASE WHEN W_SEQ = 24 THEN WAGES_CODE ELSE '' END) AS 'C24'
			                                , MAX(CASE WHEN W_SEQ = 25 THEN WAGES_CODE ELSE '' END) AS 'C25'
			                                , MAX(CASE WHEN W_SEQ = 26 THEN WAGES_CODE ELSE '' END) AS 'C26'
			                                , MAX(CASE WHEN W_SEQ = 27 THEN WAGES_CODE ELSE '' END) AS 'C27'
			                                , MAX(CASE WHEN W_SEQ = 28 THEN WAGES_CODE ELSE '' END) AS 'C28'
			                                , MAX(CASE WHEN W_SEQ = 29 THEN WAGES_CODE ELSE '' END) AS 'C29'
			                                , MAX(CASE WHEN W_SEQ &gt;= 30 THEN 'zzz' 
			                                                                ELSE '' 
			                                       END) AS 'C30'
			                             FROM HBO800PH_${S_COMP_CODE} ) T4
			                    WHERE T1.COMP_CODE       = #{S_COMP_CODE}
			                      AND T1.PAY_YYYYMM  &gt;= #{DATE_FR} 
			                      AND T1.PAY_YYYYMM  &lt;= #{DATE_TO} 
			                      AND T1.SUPP_TYPE       = #{SUPP_TYPE}
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M2 ON M2.COMP_CODE   = M1.COMP_CODE
			                                                                            AND M2.PERSON_NUMB = M1.PERSON_NUMB 
			                                                                            AND M2.PAY_YYYYMM  = M1.PAY_YYYYMM 
			       LEFT  JOIN (SELECT T1.PERSON_NUMB
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C17   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G17'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C18   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G18'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C19   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G19'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C20   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G20'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C21   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G21'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C22   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G22'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C23   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G23'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C24   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G24'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C25   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G25'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_1 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_1'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_2 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_2'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_3 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_3'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_4 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_4'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_5 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_5'
			                        , MAX(CASE WHEN T4.C27 = 'zz' 
			                                        THEN ISNULL(T5.ETC_AMT,0)
			                                        ELSE (CASE WHEN T1.DED_CODE = T4.C27 THEN T1.DED_AMOUNT_I ELSE 0 END) 
			                               END) AS 'G27'
			                        , T1.COMP_CODE
			                        , T1.PAY_YYYYMM
			                     FROM HPA400T T1 WITH (NOLOCK)
			                          LEFT JOIN (SELECT PERSON_NUMB
			                                          , SUM(DED_AMOUNT_I) AS ETC_AMT 
			                                          , COMP_CODE
			                                          , PAY_YYYYMM
			                                       FROM HPA400T WITH (NOLOCK)
			                                      WHERE COMP_CODE      = #{S_COMP_CODE}
			                                        AND PAY_YYYYMM &gt;= #{DATE_FR}
				                                    AND PAY_YYYYMM &lt;= #{DATE_TO} 
				                                    AND SUPP_TYPE      = #{SUPP_TYPE}
			                                        AND DED_CODE IN (SELECT SUB_CODE 
			                                                           FROM HPA900PH_${S_COMP_CODE}
			                                                          WHERE SEQ &gt;= 16 )
			                                                          GROUP BY PERSON_NUMB, COMP_CODE, PAY_YYYYMM) T5 ON T5.COMP_CODE   = T1.COMP_CODE
			                                                                                                         AND T5.PERSON_NUMB = T1.PERSON_NUMB
			                                                                                                         AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
			                        , (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'C17' 
			                                , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
			                                , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
			                                , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
			                                , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
			                                , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C22' 
			                                , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C23' 
			                                , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C24' 
			                                , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C25' 
			                                , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C26' 
			                                , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C26_1' 
			                                , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'C26_2' 
			                                , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'C26_3' 
			                                , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'C26_4' 
			                                , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'C26_5' 
			                                , MAX(CASE WHEN A.SEQ &gt;= 16 THEN 'zz' 
			                                                           ELSE (CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) 
			                                       END) AS 'C27'
			                             FROM HPA900PH_${S_COMP_CODE} A ) T4
			                    WHERE T1.COMP_CODE        = #{S_COMP_CODE}
			                        AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
				                    AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
				                    AND T1.SUPP_TYPE      = #{SUPP_TYPE}
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M3 ON M3.COMP_CODE   = M1.COMP_CODE
			                                                                            AND M3.PERSON_NUMB = M1.PERSON_NUMB
			                                                                            AND M3.PAY_YYYYMM  = M1.PAY_YYYYMM
			       LEFT  JOIN (SELECT A.PERSON_NUMB
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '1'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H10'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '2'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H11'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '3'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H12'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '4'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H13'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '5'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H14'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '6'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H15'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '7'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H16'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '8'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H17'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '9'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H18'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '10'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H19'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '11'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H20'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '12'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H21'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '13'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H22'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '14'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H23'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '15'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H24'
			                        , A.COMP_CODE
			                        , A.DUTY_YYYYMM
			                     FROM HAT200T A, HAT200PH_${S_COMP_CODE} B
			                    WHERE A.COMP_CODE       = #{S_COMP_CODE}
			                      AND A.DUTY_CODE       = B.SUB_CODE
			                      AND A.DUTY_YYYYMM &gt;= #{DATE_FR}
			                      AND A.DUTY_YYYYMM &lt;= #{DATE_TO}
			                    GROUP BY A.PERSON_NUMB, A.COMP_CODE, A.DUTY_YYYYMM) M5 ON M5.COMP_CODE   = M1.COMP_CODE
			                                                                          AND M5.PERSON_NUMB = M1.PERSON_NUMB
			                                                                          AND M5.DUTY_YYYYMM = M1.PAY_YYYYMM
			       LEFT  JOIN (SELECT A.COMP_CODE
			                        , A.PAY_YYYYMM
			                        , A.SUPP_TYPE
			                        , A.PERSON_NUMB
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('O01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 연장근로 비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION1_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('P01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 식대비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION2_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('M01', 'M02', 'M03')  -- 국외근로 비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION4_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('Q01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 자녀양육비비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION5_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('H06', 'H07', 'H08', 'H09', 'H10')  -- 연구활동비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION6_I
			                        , SUM(CASE WHEN A.NONTAX_CODE NOT IN ('O01', 'P01', 'M01', 'M02', 'M03', 'Q01', 'H06', 'H07', 'H08', 'H09', 'H10')  -- 기타비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION3_I
			                     FROM            HPA800T A WITH (NOLOCK)
			                    GROUP BY A.COMP_CODE, A.PAY_YYYYMM, A.SUPP_TYPE, A.PERSON_NUMB
			                  ) M6                      ON M6.COMP_CODE   = M1.COMP_CODE
			                                           AND M6.PAY_YYYYMM  = M1.PAY_YYYYMM
			                                           AND M6.SUPP_TYPE   = M1.SUPP_TYPE
			                                           AND M6.PERSON_NUMB = M1.PERSON_NUMB
			     , (SELECT MAX(CASE WHEN SEQ = 1  THEN CODE_NAME ELSE '' END) AS HH28
			             , MAX(CASE WHEN SEQ = 2  THEN CODE_NAME ELSE '' END) AS HH29
			             , MAX(CASE WHEN SEQ = 3  THEN CODE_NAME ELSE '' END) AS HH30
			             , MAX(CASE WHEN SEQ = 4  THEN CODE_NAME ELSE '' END) AS HH31
			             , MAX(CASE WHEN SEQ = 5  THEN CODE_NAME ELSE '' END) AS HH32
			             , MAX(CASE WHEN SEQ = 6  THEN CODE_NAME ELSE '' END) AS HH33
			             , MAX(CASE WHEN SEQ = 7  THEN CODE_NAME ELSE '' END) AS HH34
			             , MAX(CASE WHEN SEQ = 8  THEN CODE_NAME ELSE '' END) AS HH35
			             , MAX(CASE WHEN SEQ = 9  THEN CODE_NAME ELSE '' END) AS HH36
			             , MAX(CASE WHEN SEQ = 10 THEN CODE_NAME ELSE '' END) AS HH37
			             , MAX(CASE WHEN SEQ = 11 THEN CODE_NAME ELSE '' END) AS HH38
			             , MAX(CASE WHEN SEQ = 12 THEN CODE_NAME ELSE '' END) AS HH39
			             , MAX(CASE WHEN SEQ = 13 THEN CODE_NAME ELSE '' END) AS HH40
			             , MAX(CASE WHEN SEQ = 14 THEN CODE_NAME ELSE '' END) AS HH41
			             , MAX(CASE WHEN SEQ = 15 THEN CODE_NAME ELSE '' END) AS HH42
			          FROM HAT200PH_${S_COMP_CODE} ) HM4
			 WHERE M1.COMP_CODE       = #{S_COMP_CODE}
			   AND M1.PAY_YYYYMM  &gt;= #{DATE_FR}
			   AND M1.PAY_YYYYMM  &lt;= #{DATE_TO}
			   AND M1.SUPP_TYPE       = #{SUPP_TYPE}
			</when>
			
	   </choose>
		
	   <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
	         AND M1.DIV_CODE   = #{DIV_CODE}
		</if>
	   	<if test="@foren.Ognl@isNotEmpty(DEPT_FR)">
	         AND M1.DEPT_CODE &gt;= #{DEPT_FR}
	   	</if>   
		<if test="@foren.Ognl@isNotEmpty(DEPT_TO)">
		         AND M1.DEPT_CODE &lt;= #{DEPT_TO}
		</if>
	   
	  	<if test="@foren.Ognl@isNotEmpty(PAY_CODE)">
	         AND M1.PAY_CODE   = #{PAY_CODE}
	  	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PAY_DAY_FLAG)">
	         AND M1.PAY_PROV_FLAG = #{PAY_DAY_FLAG}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">
	         AND M1.PERSON_NUMB = #{PERSON_NUMB}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">
	         AND M1.PAY_GUBUN   = #{PAY_GUBUN}
	   	</if>
	   
	   	<if test="STRTYPE != 4 and STRTYPE != 5 and CONTAIN_ZERO != 'on' ">
	         AND M1.SUPP_TOTAL_I != 0 
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(SUPP_DATE)">
	         AND M1.SUPP_DATE   = #{SUPP_DATE}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(EMPLOY_TYPE)">
	         AND M0.EMPLOY_TYPE  = #{EMPLOY_TYPE}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PERSON_GROUP)">
	         AND B2.SUB_CODE  = #{PERSON_GROUP}
	   	</if>
	   
	    <if test="@foren.Ognl@isNotEmpty(COST_KIND)">
	         AND M1.COST_KIND  = #{COST_KIND}
	    </if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(AFFIL_CODE)">
	         AND M0.AFFIL_CODE  = #{AFFIL_CODE} 
	   	</if>
	   	
	   	<choose>
	   		<when test=" STRTYPE == 2 ">
	   			GROUP BY M1.DEPT_CODE,M1.PAY_YYYYMM
	   		</when>
		   	<otherwise>
		   		<choose>
	   				<when test=" STRTYPE == 3">
	       				ORDER BY M1.DIV_CODE, M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE,  M1.PERSON_NUMB
	   				</when>
	   				<otherwise>
	       				ORDER BY M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE,  M1.PERSON_NUMB
	   				</otherwise>
	   			</choose>
		   	</otherwise>
	   	</choose>
   	
	</select>
	
	
	<select id="s_hpa901rkr_sdServiceImpl.selectList4" parameterType="Map" resultType="rMap">
		<choose>
			<when test="STRTYPE != 2">
			--s_hpa901rkr_sdServiceImpl [selectList4]
			SELECT M1.PAY_YYYYMM 
			     , M1.SUPP_TYPE
			     , M1.POST_CODE
			     , M0.PAY_GRADE_01 AS  PAY_GRADE1
			     , M1.DIV_CODE
 			     , M9.COST_POOL_CODE AS DEPT_CODE
			     , M9.COST_POOL_NAME AS DEPT_NAME
			     , '' AS TREE_CODE
			     , M1.PAY_CODE 
			     , M1.PAY_PROV_FLAG
			     , M1.PERSON_NUMB
			     , M0.NAME
			     , unilite.fnCipherDecrypt(M0.REPRE_NUM, 'RR') REPRE_NUM
			     , M0.JOIN_DATE
			     , M0.RETR_DATE
			     , (CASE WHEN M0.PAY_CODE != '3' 
			                  THEN ISNULL(M4.WORK_DAY,0) 
			                  ELSE ISNULL(M4.WORK_TIME, 0) 
			         END) AS WORK_DAY
			     , ISNULL(M4.TOT_DAY,0) AS TOT_DAY
			     , M4.WORK_DAY AS R_WORK_DAY
			     , M4.WORK_TIME
			     , (SELECT EXTEND_WORK_YN
			          FROM HBS400T
			         WHERE COMP_CODE = #{S_COMP_CODE}) AS EXTEND_WORK_YN
			     , CASE (SELECT EXTEND_WORK_YN
			               FROM HBS400T
			              WHERE COMP_CODE = #{S_COMP_CODE}) WHEN 'Y' THEN M4.EXTEND_WORK_TIME 
			                                                      ELSE 0 
			                                                      END EXTEND_WORK_TIME
			     , (SELECT DIV_NAME
			          FROM BOR120T WITH(NOLOCK)
			         WHERE COMP_CODE = #{S_COMP_CODE}
			           AND DIV_CODE  = M1.DIV_CODE) AS DIV_NAME
			    
			     , CASE WHEN ISNULL(B4.REF_CODE1, '') = 'Y'
			                 THEN CASE WHEN ISNULL(B4.REF_CODE2, '') = '1' THEN ISNULL(B3.CODE_NAME, '')
			                           WHEN ISNULL(B4.REF_CODE2, '') = '2'
			                                THEN CASE WHEN ISNULL(B3.CODE_NAME, '') = ISNULL(B5.CODE_NAME, '') THEN ISNULL(B3.CODE_NAME, '')
			                                          ELSE ISNULL(B3.CODE_NAME, '') + ' ' + ISNULL(B5.CODE_NAME, '')
			                                     END
			                           ELSE B3.CODE_NAME
			                      END
			            ELSE B3.CODE_NAME
			       END                                                  AS POST_NM
			     , '' AS GRADE
			     , M0.PAY_GRADE_02 AS PAY_GRADE2
			     , (SELECT CODE_NAME 
			          FROM BSA100T 
			         WHERE COMP_CODE = #{S_COMP_CODE}
			           AND MAIN_CODE = 'H011' 
			           AND SUB_CODE  = M1.PAY_GUBUN) AS PAY_GUBUN
			     , M0.SPOUSE
			     , M0.SUPP_AGED_NUM
			     , M0.CHILD_20_NUM
			     , M0.DEFORM_NUM
			     , M0.AGED_NUM
			     , ISNULL(M1.SUPP_TOTAL_I,0)
			       - ISNULL(M2.S16_3,0) - ISNULL(M2.S16_4,0) - ISNULL(M2.S16_5,0) AS SUPP_TOTAL_I 
			     , ISNULL(M1.DED_TOTAL_I,0) AS DED_TOTAL_I
			     , ISNULL(M1.REAL_AMOUNT_I,0) 
			      - ISNULL(M2.S16_3,0) - ISNULL(M2.S16_4,0) - ISNULL(M2.S16_5,0)  AS REAL_AMOUNT_I 
			     , unilite.fnCipherDecrypt(M0.BANK_ACCOUNT1, 'RB') BANK_ACCOUNT1 
			     , ISNULL(M2.S1,0) AS S1         , ISNULL(M2.S2,0) AS S2         , ISNULL(M2.S3,0) AS S3
			     , ISNULL(M2.S4,0) AS S4         , ISNULL(M2.S5,0) AS S5         , ISNULL(M2.S6,0) AS S6
			     , ISNULL(M2.S7,0) AS S7         , ISNULL(M2.S8,0) AS S8         , ISNULL(M2.S9,0) AS S9
			     , ISNULL(M2.S10,0) AS S10       , ISNULL(M2.S11,0) AS S11       , ISNULL(M2.S12,0) AS S12
			     , ISNULL(M2.S13,0) AS S13       , ISNULL(M2.S14,0) AS S14       , ISNULL(M2.S15,0) AS S15
			     , ISNULL(M2.S16,0) AS S16
			     , ISNULL(M2.S16_1,0) AS S16_1
			     , ISNULL(M2.S16_2,0) AS S16_2
			     , ISNULL(M2.S16_3,0) AS S16_3
			     , ISNULL(M2.S16_4,0) AS S16_4
			     , ISNULL(M2.S16_5,0) AS S16_5
			     , ISNULL(M2.S16_6,0) AS S16_6
			     , ISNULL(M2.S16_7,0) AS S16_7
			     , ISNULL(M2.S16_8,0) AS S16_8
			     , ISNULL(M2.S16_9,0) AS S16_9
			     , ISNULL(M2.S16_10,0) AS S16_10
			     , ISNULL(M2.S16_11,0) AS S16_11
			     , ISNULL(M2.S16_12,0) AS S16_12
			     , ISNULL(M2.S16_13,0) AS S16_13
			     , ISNULL(M2.S16_14,0) AS S16_14
			     , ISNULL(M3.G17,0) AS G17       , ISNULL(M3.G18,0) AS G18
			     , ISNULL(M3.G19,0) AS G19       , ISNULL(M3.G20,0) AS G20       , ISNULL(M3.G21,0) AS G21
			     , ISNULL(M3.G22,0) AS G22       , ISNULL(M3.G23,0) AS G23       , ISNULL(M3.G24,0) AS G24
			     , ISNULL(M3.G25,0) AS G25       , ISNULL(M3.G26,0) AS G26       , ISNULL(M3.G26_1,0) AS G26_1
			     , ISNULL(M3.G26_2,0) AS G26_2   , ISNULL(M3.G26_3,0) AS G26_3   , ISNULL(M3.G26_4,0) AS G26_4
			     , ISNULL(M3.G26_5,0) AS G26_5   , ISNULL(M3.G27,0) AS G27       , ISNULL(M5.H10,0) AS H10
			     , ISNULL(M5.H11,0) AS H11       , ISNULL(M5.H12,0) AS H12       , ISNULL(M5.H13,0) AS H13
			     , ISNULL(M5.H14,0) AS H14       , ISNULL(M5.H15,0) AS H15       , ISNULL(M5.H16,0) AS H16
			     , ISNULL(M5.H17,0) AS H17       , ISNULL(M5.H18,0) AS H18       , ISNULL(M5.H19,0) AS H19 
			     , ISNULL(M5.H20,0) AS H20       , ISNULL(M5.H21,0) AS H21       , ISNULL(M5.H22,0) AS H22
			     , ISNULL(M5.H23,0) AS H23       , ISNULL(M5.H24,0) AS H24
			     , HM2.HH1      , HM2.HH2        , HM2.HH3
			     , HM2.HH4      , HM2.HH5        , HM2.HH6
			     , HM2.HH7      , HM2.HH8        , HM2.HH9
			     , HM2.HH10     , HM2.HH11       , HM2.HH12
			     , HM2.HH13     , HM2.HH14       , HM2.HH15
			     , HM2.HH16     
			     , HM2.HH16_1     
			     , HM2.HH16_2     
			     , HM2.HH16_3     
			     , HM2.HH16_4     
			     , HM2.HH16_5     
			     , HM2.HH16_6     
			     , HM2.HH16_7     
			     , HM2.HH16_8     
			     , HM2.HH16_9     
			     , HM2.HH16_10     
			     , HM2.HH16_11     
			     , HM2.HH16_12     
			     , HM2.HH16_13     
			     , HM2.HH16_14     
			                    , HM3.HH17       , HM3.HH18
			     , HM3.HH19     , HM3.HH20       , HM3.HH21
			     , HM3.HH22     , HM3.HH23       , HM3.HH24
			     , HM3.HH25     , HM3.HH26       , HM3.HH26_1
			     , HM3.HH26_2   , HM3.HH26_3     , HM3.HH26_4
			     , HM3.HH26_5   , HM3.HH27       , HM4.HH28
			     , HM4.HH29     , HM4.HH30       , HM4.HH31
			     , HM4.HH32     , HM4.HH33       , HM4.HH34
			     , HM4.HH35     , HM4.HH36       , HM4.HH37
			     , HM4.HH38     , HM4.HH39       , HM4.HH40
			     , HM4.HH41     , HM4.HH42        
			     , ISNULL(D.LIMIT_PAY_SUPP_I, 0) AS NON_TAX_TOT     
			     , ISNULL(M4.SAT_DAY  , 0) AS SAT_DAY
			     , ISNULL(M4.SUN_DAY  , 0) AS SUN_DAY
			     , ISNULL(M4.WEEK_GIVE, 0) AS WEEK_GIVE
			     , ISNULL(M1.REMARK, '')   AS REMARK
			  FROM            HUM100T M0 WITH (NOLOCK)
			       INNER JOIN HPA600T M1 WITH (NOLOCK) ON M1.COMP_CODE   = M0.COMP_CODE
			                                          AND M1.PERSON_NUMB = M0.PERSON_NUMB
			                                          
			       LEFT JOIN CBM600T M9 WITH (NOLOCK) ON M9.COMP_CODE      = M0.COMP_CODE
			                                         AND M9.COST_POOL_CODE = M0.COST_KIND
			                                          
			       LEFT  JOIN (SELECT A.COMP_CODE
			                        , A.PAY_YYYYMM
			                        , A.SUPP_TYPE
			                        , A.PERSON_NUMB
			                        , SUM(ISNULL(A.LIMIT_PAY_SUPP_I, 0)) AS LIMIT_PAY_SUPP_I
			                     FROM            HPA800T A WITH (NOLOCK)
			                    GROUP BY A.COMP_CODE, A.PAY_YYYYMM, A.SUPP_TYPE, A.PERSON_NUMB
			                  )       D                ON D.COMP_CODE    = M1.COMP_CODE
			                                          AND D.PAY_YYYYMM   = M1.PAY_YYYYMM
			                                          AND D.SUPP_TYPE    = M1.SUPP_TYPE
			                                          AND D.PERSON_NUMB  = M1.PERSON_NUMB
			       LEFT  JOIN BSA100T B1 WITH (NOLOCK) ON B1.COMP_CODE   = M0.COMP_CODE
			                                          AND B1.MAIN_CODE   = 'H024'
			                                          AND B1.SUB_CODE    = M0.EMPLOY_TYPE
			       LEFT  JOIN BSA100T B2 WITH (NOLOCK) ON B2.COMP_CODE   = M0.COMP_CODE
			                                          AND B2.MAIN_CODE   = 'H181'
			                                          AND B2.SUB_CODE    = ISNULL(B1.REF_CODE1, '')
			       LEFT  JOIN BSA100T B3 WITH (NOLOCK) ON B3.COMP_CODE   = M1.COMP_CODE
			                                          AND B3.MAIN_CODE   = 'H005'
			                                          AND B3.SUB_CODE    = M1.POST_CODE
			       LEFT  JOIN BSA100T B4 WITH (NOLOCK) ON B4.COMP_CODE   = M0.COMP_CODE
			                                          AND B4.MAIN_CODE   = 'H175'
			                                          AND B4.SUB_CODE    = '11'           -- (공공)인사카드 임면사항 직급
			       LEFT  JOIN BSA100T B5 WITH (NOLOCK) ON B5.COMP_CODE   = M1.COMP_CODE
			                                          AND B5.MAIN_CODE   = 'H006'
			                                          AND B5.SUB_CODE    = M1.ABIL_CODE
			       LEFT  JOIN HAT300T M4 WITH (NOLOCK) ON M4.COMP_CODE   = M1.COMP_CODE
			                                          AND M4.PERSON_NUMB = M1.PERSON_NUMB
			                                          AND M4.DUTY_YYYYMM = M1.PAY_YYYYMM
			       INNER JOIN (SELECT T1.PERSON_NUMB
			                        , MAX(CASE WHEN T4.C1!= ''  THEN T4.C1   ELSE '' END) AS 'HH1'
			                        , MAX(CASE WHEN T4.C2!= ''  THEN T4.C2   ELSE '' END) AS 'HH2'
			                        , MAX(CASE WHEN T4.C3!= ''  THEN T4.C3   ELSE '' END) AS 'HH3'
			                        , MAX(CASE WHEN T4.C4!= ''  THEN T4.C4   ELSE '' END) AS 'HH4'
			                        , MAX(CASE WHEN T4.C5!= ''  THEN T4.C5   ELSE '' END) AS 'HH5'
			                        , MAX(CASE WHEN T4.C6!= ''  THEN T4.C6   ELSE '' END) AS 'HH6'
			                        , MAX(CASE WHEN T4.C7!= ''  THEN T4.C7   ELSE '' END) AS 'HH7'
			                        , MAX(CASE WHEN T4.C8!= ''  THEN T4.C8   ELSE '' END) AS 'HH8'
			                        , MAX(CASE WHEN T4.C9!= ''  THEN T4.C9   ELSE '' END) AS 'HH9'
			                        , MAX(CASE WHEN T4.C10!= '' THEN T4.C10  ELSE '' END) AS 'HH10'
			                        , MAX(CASE WHEN T4.C11!= '' THEN T4.C11  ELSE '' END) AS 'HH11'
			                        , MAX(CASE WHEN T4.C12!= '' THEN T4.C12  ELSE '' END) AS 'HH12'
			                        , MAX(CASE WHEN T4.C13!= '' THEN T4.C13  ELSE '' END) AS 'HH13'
			                        , MAX(CASE WHEN T4.C14!= '' THEN T4.C14  ELSE '' END) AS 'HH14'
			                        , MAX(CASE WHEN T4.C15!= '' THEN T4.C15  ELSE '' END) AS 'HH15'
			                        , MAX(CASE WHEN T4.C16!= '' THEN T4.C16  ELSE '' END) AS 'HH16'
			                        , MAX(CASE WHEN T4.C17!= '' THEN T4.C17  ELSE '' END) AS 'HH16_1'
			                        , MAX(CASE WHEN T4.C18!= '' THEN T4.C18  ELSE '' END) AS 'HH16_2'
			                        , MAX(CASE WHEN T4.C19!= '' THEN T4.C19  ELSE '' END) AS 'HH16_3'
			                        , MAX(CASE WHEN T4.C20!= '' THEN T4.C20  ELSE '' END) AS 'HH16_4'
			                        , MAX(CASE WHEN T4.C21!= '' THEN T4.C21  ELSE '' END) AS 'HH16_5'
			                        , MAX(CASE WHEN T4.C22!= '' THEN T4.C22  ELSE '' END) AS 'HH16_6'
			                        , MAX(CASE WHEN T4.C23!= '' THEN T4.C23  ELSE '' END) AS 'HH16_7'
			                        , MAX(CASE WHEN T4.C24!= '' THEN T4.C24  ELSE '' END) AS 'HH16_8'
			                        , MAX(CASE WHEN T4.C25!= '' THEN T4.C25  ELSE '' END) AS 'HH16_9'
			                        , MAX(CASE WHEN T4.C26!= '' THEN T4.C26  ELSE '' END) AS 'HH16_10'
			                        , MAX(CASE WHEN T4.C27!= '' THEN T4.C27  ELSE '' END) AS 'HH16_11'
			                        , MAX(CASE WHEN T4.C28!= '' THEN T4.C28  ELSE '' END) AS 'HH16_12'
			                        , MAX(CASE WHEN T4.C29!= '' THEN T4.C29  ELSE '' END) AS 'HH16_13'
			                        , MAX(CASE WHEN T4.C30!= '' THEN T4.C30  ELSE '' END) AS 'HH16_14'
			                        , T1.COMP_CODE
			                     FROM (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
			                                , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
			                                , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
			                                , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
			                                , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
			                                , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
			                                , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
			                                , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
			                                , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
			                                , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
			                                , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
			                                , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
			                                , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
			                                , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
			                                , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
			                                , MAX(CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) AS 'C16'
			                                , MAX(CASE WHEN W_SEQ = 17 THEN WAGES_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN W_SEQ = 18 THEN WAGES_CODE ELSE '' END) AS 'C18'
			                                , MAX(CASE WHEN W_SEQ = 19 THEN WAGES_CODE ELSE '' END) AS 'C19'
			                                , MAX(CASE WHEN W_SEQ = 20 THEN WAGES_CODE ELSE '' END) AS 'C20'
			                                , MAX(CASE WHEN W_SEQ = 21 THEN WAGES_CODE ELSE '' END) AS 'C21'
			                                , MAX(CASE WHEN W_SEQ = 22 THEN WAGES_CODE ELSE '' END) AS 'C22'
			                                , MAX(CASE WHEN W_SEQ = 23 THEN WAGES_CODE ELSE '' END) AS 'C23'
			                                , MAX(CASE WHEN W_SEQ = 24 THEN WAGES_CODE ELSE '' END) AS 'C24'
			                                , MAX(CASE WHEN W_SEQ = 25 THEN WAGES_CODE ELSE '' END) AS 'C25'
			                                , MAX(CASE WHEN W_SEQ = 26 THEN WAGES_CODE ELSE '' END) AS 'C26'
			                                , MAX(CASE WHEN W_SEQ = 27 THEN WAGES_CODE ELSE '' END) AS 'C27'
			                                , MAX(CASE WHEN W_SEQ = 28 THEN WAGES_CODE ELSE '' END) AS 'C28'
			                                , MAX(CASE WHEN W_SEQ = 29 THEN WAGES_CODE ELSE '' END) AS 'C29'
			                                            , MAX(CASE WHEN W_SEQ &gt;= 30 
			                                                THEN 'zzz'
			                                                ELSE (CASE WHEN W_SEQ = 30 THEN WAGES_CODE ELSE '' END) 
			                                       END) AS 'C30'
			                             FROM HBO800PH_${S_COMP_CODE}) T4
			                        , HPA600T T1 WITH (NOLOCK)
			                    WHERE T1.COMP_CODE      = #{S_COMP_CODE}
			                      AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
			                      AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
			                      AND T1.SUPP_TYPE      = '1'
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM2 ON HM2.COMP_CODE   = M1.COMP_CODE
			                                                              AND HM2.PERSON_NUMB = M1.PERSON_NUMB
			       INNER JOIN (SELECT T1.PERSON_NUMB
			                        , MAX(CASE WHEN T4.C17!= ''    THEN T4.C17   ELSE '' END) AS 'HH17'
			                        , MAX(CASE WHEN T4.C18!= ''    THEN T4.C18   ELSE '' END) AS 'HH18'
			                        , MAX(CASE WHEN T4.C19!= ''    THEN T4.C19   ELSE '' END) AS 'HH19'
			                        , MAX(CASE WHEN T4.C20!= ''    THEN T4.C20   ELSE '' END) AS 'HH20'
			                        , MAX(CASE WHEN T4.C21!= ''    THEN T4.C21   ELSE '' END) AS 'HH21'
			                        , MAX(CASE WHEN T4.C22!= ''    THEN T4.C22   ELSE '' END) AS 'HH22'
			                        , MAX(CASE WHEN T4.C23!= ''    THEN T4.C23   ELSE '' END) AS 'HH23'
			                        , MAX(CASE WHEN T4.C24!= ''    THEN T4.C24   ELSE '' END) AS 'HH24'
			                        , MAX(CASE WHEN T4.C25!= ''    THEN T4.C25   ELSE '' END) AS 'HH25'
			                        , MAX(CASE WHEN T4.C26!= ''    THEN T4.C26   ELSE '' END) AS 'HH26' 
			                        , MAX(CASE WHEN T4.C26_1!= ''  THEN T4.C26_1 ELSE '' END) AS 'HH26_1'
			                        , MAX(CASE WHEN T4.C26_2!= ''  THEN T4.C26_2 ELSE '' END) AS 'HH26_2'
			                        , MAX(CASE WHEN T4.C26_3!= ''  THEN T4.C26_3 ELSE '' END) AS 'HH26_3'
			                        , MAX(CASE WHEN T4.C26_4!= ''  THEN T4.C26_4 ELSE '' END) AS 'HH26_4'
			                        , MAX(CASE WHEN T4.C26_5!= ''  THEN T4.C26_5 ELSE '' END) AS 'HH26_5'
			                        , MAX(CASE WHEN T4.C27!= ''    THEN T4.C27   ELSE '' END) AS 'HH27'
			                        , T1.COMP_CODE
			                     FROM (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
			                                , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
			                                , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
			                                , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
			                                , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C22' 
			                                , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C23' 
			                                , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C24' 
			                                , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C25' 
			                                , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C26' 
			                                , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C26_1' 
			                                , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'C26_2' 
			                                , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'C26_3' 
			                                , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'C26_4' 
			                                , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'C26_5' 
			                                , MAX(CASE WHEN A.SEQ &gt;= 16 
			                                                THEN 'zz' 
			                                                ELSE (CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) 
			                                       END) AS 'C27'
			                             FROM HPA900PH_${S_COMP_CODE} A ) T4
			                        , HPA600T T1 WITH (NOLOCK)
			                    WHERE T1.COMP_CODE        = #{S_COMP_CODE}
			                      	AND T1.PAY_YYYYMM &gt;= #{DATE_FR} 
				                    AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
				                    AND T1.SUPP_TYPE      = '1'  
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE) HM3 ON HM3.COMP_CODE   = M1.COMP_CODE
			                                                              AND HM3.PERSON_NUMB = M1.PERSON_NUMB
			       LEFT  JOIN (SELECT T1.PERSON_NUMB
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C1  THEN T1.AMOUNT_I ELSE 0 END) AS 'S1'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C2  THEN T1.AMOUNT_I ELSE 0 END) AS 'S2'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C3  THEN T1.AMOUNT_I ELSE 0 END) AS 'S3'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C4  THEN T1.AMOUNT_I ELSE 0 END) AS 'S4'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C5  THEN T1.AMOUNT_I ELSE 0 END) AS 'S5'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C6  THEN T1.AMOUNT_I ELSE 0 END) AS 'S6'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C7  THEN T1.AMOUNT_I ELSE 0 END) AS 'S7'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C8  THEN T1.AMOUNT_I ELSE 0 END) AS 'S8'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C9  THEN T1.AMOUNT_I ELSE 0 END) AS 'S9'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C10 THEN T1.AMOUNT_I ELSE 0 END) AS 'S10'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C11 THEN T1.AMOUNT_I ELSE 0 END) AS 'S11'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C12 THEN T1.AMOUNT_I ELSE 0 END) AS 'S12'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C13 THEN T1.AMOUNT_I ELSE 0 END) AS 'S13'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C14 THEN T1.AMOUNT_I ELSE 0 END) AS 'S14'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C15 THEN T1.AMOUNT_I ELSE 0 END) AS 'S15'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C16 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C17 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_1'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C18 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_2'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C19 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_3'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C20 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_4'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C21 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_5'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C22 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_6'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C23 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_7'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C24 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_8'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C25 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_9'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C26 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_10'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C27 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_11'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C28 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_12'
			                        , SUM(CASE WHEN T1.WAGES_CODE = T4.C29 THEN T1.AMOUNT_I ELSE 0 END) AS 'S16_13'
			                        , MAX(CASE WHEN T4.C30 = 'zzz' 
			                                        THEN ISNULL(T5.ETC_AMT,0)
			                                        ELSE (CASE WHEN T1.WAGES_CODE = T4.C30 THEN T1.AMOUNT_I ELSE 0 END) 
			                               END) AS 'S16_14'
			                        , T1.COMP_CODE
			                        , T1.PAY_YYYYMM
			                     FROM HPA300T T1 WITH (NOLOCK)
			                          LEFT JOIN (SELECT PERSON_NUMB
			                                          , SUM(AMOUNT_I) AS ETC_AMT 
			                                          , COMP_CODE 
			                                          , PAY_YYYYMM
			                                       FROM HPA300T WITH (NOLOCK)
			                                      WHERE COMP_CODE      = #{S_COMP_CODE}
			                                        AND PAY_YYYYMM &gt;= #{DATE_FR}
			                                        AND PAY_YYYYMM &lt;= #{DATE_TO} 
			                                        AND SUPP_TYPE      = '1'
			                                        AND WAGES_CODE IN (SELECT WAGES_CODE 
			                                                             FROM HBO800PH_${S_COMP_CODE}
			                                                            WHERE W_SEQ &gt;= 16 )
			                                                            GROUP BY PERSON_NUMB, COMP_CODE, PAY_YYYYMM) T5 ON T5.COMP_CODE   = T1.COMP_CODE
			                                                                                                           AND T5.PERSON_NUMB = T1.PERSON_NUMB
			                                                                                                           AND T5.PAY_YYYYMM = T1.PAY_YYYYMM
			                        , (SELECT MAX(CASE WHEN W_SEQ = 1  THEN WAGES_CODE ELSE '' END) AS 'C1'
			                                , MAX(CASE WHEN W_SEQ = 2  THEN WAGES_CODE ELSE '' END) AS 'C2'
			                                , MAX(CASE WHEN W_SEQ = 3  THEN WAGES_CODE ELSE '' END) AS 'C3'
			                                , MAX(CASE WHEN W_SEQ = 4  THEN WAGES_CODE ELSE '' END) AS 'C4'
			                                , MAX(CASE WHEN W_SEQ = 5  THEN WAGES_CODE ELSE '' END) AS 'C5'
			                                , MAX(CASE WHEN W_SEQ = 6  THEN WAGES_CODE ELSE '' END) AS 'C6'
			                                , MAX(CASE WHEN W_SEQ = 7  THEN WAGES_CODE ELSE '' END) AS 'C7'
			                                , MAX(CASE WHEN W_SEQ = 8  THEN WAGES_CODE ELSE '' END) AS 'C8'
			                                , MAX(CASE WHEN W_SEQ = 9  THEN WAGES_CODE ELSE '' END) AS 'C9'
			                                , MAX(CASE WHEN W_SEQ = 10 THEN WAGES_CODE ELSE '' END) AS 'C10'
			                                , MAX(CASE WHEN W_SEQ = 11 THEN WAGES_CODE ELSE '' END) AS 'C11'
			                                , MAX(CASE WHEN W_SEQ = 12 THEN WAGES_CODE ELSE '' END) AS 'C12'
			                                , MAX(CASE WHEN W_SEQ = 13 THEN WAGES_CODE ELSE '' END) AS 'C13'
			                                , MAX(CASE WHEN W_SEQ = 14 THEN WAGES_CODE ELSE '' END) AS 'C14'
			                                , MAX(CASE WHEN W_SEQ = 15 THEN WAGES_CODE ELSE '' END) AS 'C15'
			                                , MAX(CASE WHEN W_SEQ = 16 THEN WAGES_CODE ELSE '' END) AS 'C16'
			                                , MAX(CASE WHEN W_SEQ = 17 THEN WAGES_CODE ELSE '' END) AS 'C17'
			                                , MAX(CASE WHEN W_SEQ = 18 THEN WAGES_CODE ELSE '' END) AS 'C18'
			                                , MAX(CASE WHEN W_SEQ = 19 THEN WAGES_CODE ELSE '' END) AS 'C19'
			                                , MAX(CASE WHEN W_SEQ = 20 THEN WAGES_CODE ELSE '' END) AS 'C20'
			                                , MAX(CASE WHEN W_SEQ = 21 THEN WAGES_CODE ELSE '' END) AS 'C21'
			                                , MAX(CASE WHEN W_SEQ = 22 THEN WAGES_CODE ELSE '' END) AS 'C22'
			                                , MAX(CASE WHEN W_SEQ = 23 THEN WAGES_CODE ELSE '' END) AS 'C23'
			                                , MAX(CASE WHEN W_SEQ = 24 THEN WAGES_CODE ELSE '' END) AS 'C24'
			                                , MAX(CASE WHEN W_SEQ = 25 THEN WAGES_CODE ELSE '' END) AS 'C25'
			                                , MAX(CASE WHEN W_SEQ = 26 THEN WAGES_CODE ELSE '' END) AS 'C26'
			                                , MAX(CASE WHEN W_SEQ = 27 THEN WAGES_CODE ELSE '' END) AS 'C27'
			                                , MAX(CASE WHEN W_SEQ = 28 THEN WAGES_CODE ELSE '' END) AS 'C28'
			                                , MAX(CASE WHEN W_SEQ = 29 THEN WAGES_CODE ELSE '' END) AS 'C29'
			                                , MAX(CASE WHEN W_SEQ &gt;= 30 THEN 'zzz' 
			                                                                ELSE '' 
			                                       END) AS 'C30'
			                             FROM HBO800PH_${S_COMP_CODE} ) T4
			                    WHERE T1.COMP_CODE       = #{S_COMP_CODE}
			                      AND T1.PAY_YYYYMM  &gt;= #{DATE_FR} 
			                      AND T1.PAY_YYYYMM  &lt;= #{DATE_TO} 
			                      AND T1.SUPP_TYPE       = '1'
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M2 ON M2.COMP_CODE   = M1.COMP_CODE
			                                                                            AND M2.PERSON_NUMB = M1.PERSON_NUMB 
			                                                                            AND M2.PAY_YYYYMM  = M1.PAY_YYYYMM 
			       LEFT  JOIN (SELECT T1.PERSON_NUMB
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C17   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G17'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C18   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G18'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C19   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G19'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C20   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G20'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C21   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G21'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C22   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G22'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C23   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G23'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C24   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G24'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C25   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G25'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26   THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_1 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_1'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_2 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_2'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_3 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_3'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_4 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_4'
			                        , SUM(CASE WHEN T1.DED_CODE = T4.C26_5 THEN T1.DED_AMOUNT_I ELSE 0 END) AS 'G26_5'
			                        , MAX(CASE WHEN T4.C27 = 'zz' 
			                                        THEN ISNULL(T5.ETC_AMT,0)
			                                        ELSE (CASE WHEN T1.DED_CODE = T4.C27 THEN T1.DED_AMOUNT_I ELSE 0 END) 
			                               END) AS 'G27'
			                        , T1.COMP_CODE
			                        , T1.PAY_YYYYMM
			                     FROM HPA400T T1 WITH (NOLOCK)
			                          LEFT JOIN (SELECT PERSON_NUMB
			                                          , SUM(DED_AMOUNT_I) AS ETC_AMT 
			                                          , COMP_CODE
			                                          , PAY_YYYYMM
			                                       FROM HPA400T WITH (NOLOCK)
			                                      WHERE COMP_CODE      = #{S_COMP_CODE}
			                                        AND PAY_YYYYMM &gt;= #{DATE_FR}
				                                    AND PAY_YYYYMM &lt;= #{DATE_TO} 
				                                    AND SUPP_TYPE      = '1'
			                                        AND DED_CODE IN (SELECT SUB_CODE 
			                                                           FROM HPA900PH_${S_COMP_CODE}
			                                                          WHERE SEQ &gt;= 16 )
			                                                          GROUP BY PERSON_NUMB, COMP_CODE, PAY_YYYYMM) T5 ON T5.COMP_CODE   = T1.COMP_CODE
			                                                                                                         AND T5.PERSON_NUMB = T1.PERSON_NUMB
			                                                                                                         AND T5.PAY_YYYYMM  = T1.PAY_YYYYMM
			                        , (SELECT MAX(CASE WHEN A.SEQ = 1  THEN A.SUB_CODE ELSE '' END) AS 'C17' 
			                                , MAX(CASE WHEN A.SEQ = 2  THEN A.SUB_CODE ELSE '' END) AS 'C18' 
			                                , MAX(CASE WHEN A.SEQ = 3  THEN A.SUB_CODE ELSE '' END) AS 'C19' 
			                                , MAX(CASE WHEN A.SEQ = 4  THEN A.SUB_CODE ELSE '' END) AS 'C20' 
			                                , MAX(CASE WHEN A.SEQ = 5  THEN A.SUB_CODE ELSE '' END) AS 'C21' 
			                                , MAX(CASE WHEN A.SEQ = 6  THEN A.SUB_CODE ELSE '' END) AS 'C22' 
			                                , MAX(CASE WHEN A.SEQ = 7  THEN A.SUB_CODE ELSE '' END) AS 'C23' 
			                                , MAX(CASE WHEN A.SEQ = 8  THEN A.SUB_CODE ELSE '' END) AS 'C24' 
			                                , MAX(CASE WHEN A.SEQ = 9  THEN A.SUB_CODE ELSE '' END) AS 'C25' 
			                                , MAX(CASE WHEN A.SEQ = 10 THEN A.SUB_CODE ELSE '' END) AS 'C26' 
			                                , MAX(CASE WHEN A.SEQ = 11 THEN A.SUB_CODE ELSE '' END) AS 'C26_1' 
			                                , MAX(CASE WHEN A.SEQ = 12 THEN A.SUB_CODE ELSE '' END) AS 'C26_2' 
			                                , MAX(CASE WHEN A.SEQ = 13 THEN A.SUB_CODE ELSE '' END) AS 'C26_3' 
			                                , MAX(CASE WHEN A.SEQ = 14 THEN A.SUB_CODE ELSE '' END) AS 'C26_4' 
			                                , MAX(CASE WHEN A.SEQ = 15 THEN A.SUB_CODE ELSE '' END) AS 'C26_5' 
			                                , MAX(CASE WHEN A.SEQ &gt;= 16 THEN 'zz' 
			                                                           ELSE (CASE WHEN A.SEQ = 16 THEN A.SUB_CODE ELSE '' END) 
			                                       END) AS 'C27'
			                             FROM HPA900PH_${S_COMP_CODE} A ) T4
			                    WHERE T1.COMP_CODE        = #{S_COMP_CODE}
			                        AND T1.PAY_YYYYMM &gt;= #{DATE_FR}
				                    AND T1.PAY_YYYYMM &lt;= #{DATE_TO}
				                    AND T1.SUPP_TYPE      = '1'
			                    GROUP BY T1.PERSON_NUMB, T1.COMP_CODE, T1.PAY_YYYYMM) M3 ON M3.COMP_CODE   = M1.COMP_CODE
			                                                                            AND M3.PERSON_NUMB = M1.PERSON_NUMB
			                                                                            AND M3.PAY_YYYYMM  = M1.PAY_YYYYMM
			       LEFT  JOIN (SELECT A.PERSON_NUMB
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '1'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H10'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '2'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H11'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '3'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H12'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '4'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H13'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '5'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H14'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '6'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H15'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '7'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H16'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '8'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H17'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '9'   THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H18'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '10'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H19'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '11'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H20'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '12'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H21'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '13'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H22'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '14'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H23'
			                        , CONVERT(REAL,SUM(CASE WHEN B.SEQ = '15'  THEN  A.DUTY_NUM +  A.DUTY_TIME  ELSE 0 END)) AS 'H24'
			                        , A.COMP_CODE
			                        , A.DUTY_YYYYMM
			                     FROM HAT200T A, HAT200PH_${S_COMP_CODE} B
			                    WHERE A.COMP_CODE       = #{S_COMP_CODE}
			                      AND A.DUTY_CODE       = B.SUB_CODE
			                      AND A.DUTY_YYYYMM &gt;= #{DATE_FR}
			                      AND A.DUTY_YYYYMM &lt;= #{DATE_TO}
			                    GROUP BY A.PERSON_NUMB, A.COMP_CODE, A.DUTY_YYYYMM) M5 ON M5.COMP_CODE   = M1.COMP_CODE
			                                                                          AND M5.PERSON_NUMB = M1.PERSON_NUMB
			                                                                          AND M5.DUTY_YYYYMM = M1.PAY_YYYYMM
			       LEFT  JOIN (SELECT A.COMP_CODE
			                        , A.PAY_YYYYMM
			                        , A.SUPP_TYPE
			                        , A.PERSON_NUMB
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('O01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 연장근로 비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION1_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('P01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 식대비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION2_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('M01', 'M02', 'M03')  -- 국외근로 비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION4_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('Q01') THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)  -- 자녀양육비비과세
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION5_I
			                        , SUM(CASE WHEN A.NONTAX_CODE IN ('H06', 'H07', 'H08', 'H09', 'H10')  -- 연구활동비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION6_I
			                        , SUM(CASE WHEN A.NONTAX_CODE NOT IN ('O01', 'P01', 'M01', 'M02', 'M03', 'Q01', 'H06', 'H07', 'H08', 'H09', 'H10')  -- 기타비과세
			                                        THEN ISNULL(A.LIMIT_PAY_SUPP_I, 0)
			                                   ELSE 0
			                              END)               AS TAX_EXEMPTION3_I
			                     FROM            HPA800T A WITH (NOLOCK)
			                    GROUP BY A.COMP_CODE, A.PAY_YYYYMM, A.SUPP_TYPE, A.PERSON_NUMB
			                  ) M6                      ON M6.COMP_CODE   = M1.COMP_CODE
			                                           AND M6.PAY_YYYYMM  = M1.PAY_YYYYMM
			                                           AND M6.SUPP_TYPE   = M1.SUPP_TYPE
			                                           AND M6.PERSON_NUMB = M1.PERSON_NUMB
			     , (SELECT MAX(CASE WHEN SEQ = 1  THEN CODE_NAME ELSE '' END) AS HH28
			             , MAX(CASE WHEN SEQ = 2  THEN CODE_NAME ELSE '' END) AS HH29
			             , MAX(CASE WHEN SEQ = 3  THEN CODE_NAME ELSE '' END) AS HH30
			             , MAX(CASE WHEN SEQ = 4  THEN CODE_NAME ELSE '' END) AS HH31
			             , MAX(CASE WHEN SEQ = 5  THEN CODE_NAME ELSE '' END) AS HH32
			             , MAX(CASE WHEN SEQ = 6  THEN CODE_NAME ELSE '' END) AS HH33
			             , MAX(CASE WHEN SEQ = 7  THEN CODE_NAME ELSE '' END) AS HH34
			             , MAX(CASE WHEN SEQ = 8  THEN CODE_NAME ELSE '' END) AS HH35
			             , MAX(CASE WHEN SEQ = 9  THEN CODE_NAME ELSE '' END) AS HH36
			             , MAX(CASE WHEN SEQ = 10 THEN CODE_NAME ELSE '' END) AS HH37
			             , MAX(CASE WHEN SEQ = 11 THEN CODE_NAME ELSE '' END) AS HH38
			             , MAX(CASE WHEN SEQ = 12 THEN CODE_NAME ELSE '' END) AS HH39
			             , MAX(CASE WHEN SEQ = 13 THEN CODE_NAME ELSE '' END) AS HH40
			             , MAX(CASE WHEN SEQ = 14 THEN CODE_NAME ELSE '' END) AS HH41
			             , MAX(CASE WHEN SEQ = 15 THEN CODE_NAME ELSE '' END) AS HH42
			          FROM HAT200PH_${S_COMP_CODE} ) HM4
			 WHERE M1.COMP_CODE       = #{S_COMP_CODE}
			   AND M1.PAY_YYYYMM  &gt;= #{DATE_FR}
			   AND M1.PAY_YYYYMM  &lt;= #{DATE_TO}
			   AND M1.SUPP_TYPE       = '1'
			</when>
			
	   </choose>
		
	   <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
	         AND M1.DIV_CODE   = #{DIV_CODE}
		</if>
	   	<if test="@foren.Ognl@isNotEmpty(DEPT_FR)">
	         AND M1.DEPT_CODE &gt;= #{DEPT_FR}
	   	</if>   
		<if test="@foren.Ognl@isNotEmpty(DEPT_TO)">
		         AND M1.DEPT_CODE &lt;= #{DEPT_TO}
		</if>
	   
	  	<if test="@foren.Ognl@isNotEmpty(PAY_CODE)">
	         AND M1.PAY_CODE   = #{PAY_CODE}
	  	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PAY_DAY_FLAG)">
	         AND M1.PAY_PROV_FLAG = #{PAY_DAY_FLAG}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">
	         AND M1.PERSON_NUMB = #{PERSON_NUMB}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">
	         AND M1.PAY_GUBUN   = #{PAY_GUBUN}
	   	</if>
	   
	   	<if test="STRTYPE != 4 and STRTYPE != 5 and CONTAIN_ZERO != 'on' ">
	         AND M1.SUPP_TOTAL_I != 0 
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(SUPP_DATE)">
	         AND M1.SUPP_DATE   = #{SUPP_DATE}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(EMPLOY_TYPE)">
	         AND M0.EMPLOY_TYPE  = #{EMPLOY_TYPE}
	   	</if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(PERSON_GROUP)">
	         AND B2.SUB_CODE  = #{PERSON_GROUP}
	   	</if>
	   
	    <if test="@foren.Ognl@isNotEmpty(COST_KIND)">
	         AND M1.COST_KIND  = #{COST_KIND}
	    </if>
	   
	   	<if test="@foren.Ognl@isNotEmpty(AFFIL_CODE)">
	         AND M0.AFFIL_CODE  = #{AFFIL_CODE} 
	   	</if>
	   	
	   	<choose>
	   		<when test=" STRTYPE == 2 ">
	   			GROUP BY M1.DEPT_CODE,M1.PAY_YYYYMM
	   		</when>
		   	<otherwise>
		   		<choose>
	   				<when test=" STRTYPE == 3">
	       				ORDER BY M1.DIV_CODE, M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE,  M1.PERSON_NUMB
	   				</when>
	   				<otherwise>
	       				ORDER BY M1.PAY_YYYYMM, M1.DEPT_CODE, M1.POST_CODE, M0.JOIN_DATE,  M1.PERSON_NUMB
	   				</otherwise>
	   			</choose>
		   	</otherwise>
	   	</choose>
   	
	</select>
	
	
</mapper>