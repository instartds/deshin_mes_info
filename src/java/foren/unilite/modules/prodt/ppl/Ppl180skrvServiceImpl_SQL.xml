<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ppl180skrvServiceImpl">
   
	<select id="ppl180skrvServiceImpl.selectList" parameterType="Map" resultType="rMap">
   	 --ppl180skrv.Cppl180skrv [fnPpl180QStd] QUERY01
	 SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED 
	 SELECT
	        '사업장' DIV_CODE, 0 + 1 SORT_SEQ, '' GUBUN, 0 TOT_Q,  
	         CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) MON,     CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) TUE,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) WED, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) THU,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) FRI, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SAT,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SUN, '' WIN     
	        Union All 
	 SELECT
	        X.DIV_CODE, X.SORT_SEQ, X.GUBUN,
	        (SUM(X.MON) + SUM(X.TUE) + SUM(X.WED) + SUM(X.THU) + SUM(X.FRI) + SUM(X.SAT) + SUM(X.SUN)) TOT_Q,
	        CAST(FLOOR(SUM(X.MON)) AS VARCHAR) MON,  CAST(FLOOR(SUM(X.TUE)) AS VARCHAR) TUE, CAST(FLOOR(SUM(X.WED)) AS VARCHAR) WED,
	        CAST(FLOOR(SUM(X.THU)) AS VARCHAR) THU,  CAST(FLOOR(SUM(X.FRI)) AS VARCHAR) FRI,
	        CAST(FLOOR(SUM(X.SAT)) AS VARCHAR) SAT,  CAST(FLOOR(SUM(X.SUN)) AS VARCHAR) SUN, ''
	             FROM
	                 (SELECT 0 + 2 AS SORT_SEQ,
	                            A.DIV_CODE,
	                            A.WORK_SHOP_CODE,
	                            A.ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END MON,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END TUE,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END WED,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END THU,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END FRI,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SAT,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SUN
	                             FROM    PPL100T A, BPR100T B
	                            Where    A.COMP_CODE = #{S_COMP_CODE}
	                              and    A.ITEM_CODE = B.ITEM_CODE
	                              AND    A.DIV_CODE = #{DIV_CODE}
	                              AND    A.PRODT_PLAN_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'
	                              							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
								<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
									AND A.ITEM_CODE	  = #{ITEM_CODE}
								</if>
								<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
									AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
								</if>
								<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
									AND B.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
								</if>
	                   Union All
	                  SELECT  DISTINCT 0 + 2 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                                     0,0,0,0,0,0,0
	           Union All
	                 SELECT 0 + 3 AS SORT_SEQ,
	                          A.DIV_CODE,
	                           A.WORK_SHOP_CODE,
	                           C.STOCK_UNIT ITEM_CODE,
	                        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END TUE,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN A.WKORD_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END THU,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SAT,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SUN
	                     FROM  PMP100T A, BPR100T C
	                     Where  A.COMP_CODE = #{S_COMP_CODE}
	                    AND     A.ITEM_CODE = C.ITEM_CODE
	                    AND     A.LINE_END_YN = 'Y'
	                    AND     A.DIV_CODE = #{DIV_CODE}
	                    AND     A.PRODT_START_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND C.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 0 + 3 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                                     0,0,0,0,0,0,0
	         UNION ALL
	                   SELECT  0 + 4 AS SORT_SEQ,
	                          B.DIV_CODE,
	                           B.WORK_SHOP_CODE,
	                           '' ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END TUE,
	                         CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END THU,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END SAT,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 0, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                              THEN B.PRODT_Q  ELSE 0 END SUN
	                     FROM    BPR100T A, PMR110T B
	                     Where   B.COMP_CODE = #{S_COMP_CODE}
	                      AND    B.ITEM_CODE = A.ITEM_CODE
	                      AND    B.DIV_CODE = #{DIV_CODE}
	                    AND    B.PRODT_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    						AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 0 + 4 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                                     0,0,0,0,0,0,0
	 ) X
	 GROUP BY X.SORT_SEQ, X.DIV_CODE, X.GUBUN
	 Union All
	 SELECT
	        '사업장' DIV_CODE, 4 + 1 SORT_SEQ, '' GUBUN, 0 TOT_Q,  
	         CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) MON,     CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) TUE,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) WED, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) THU,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) FRI, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SAT,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SUN, '' WIN     
	        Union All 
	 SELECT
	        X.DIV_CODE, X.SORT_SEQ, X.GUBUN,
	        (SUM(X.MON) + SUM(X.TUE) + SUM(X.WED) + SUM(X.THU) + SUM(X.FRI) + SUM(X.SAT) + SUM(X.SUN)) TOT_Q,
	        CAST(FLOOR(SUM(X.MON)) AS VARCHAR) MON,  CAST(FLOOR(SUM(X.TUE)) AS VARCHAR) TUE, CAST(FLOOR(SUM(X.WED)) AS VARCHAR) WED,
	        CAST(FLOOR(SUM(X.THU)) AS VARCHAR) THU,  CAST(FLOOR(SUM(X.FRI)) AS VARCHAR) FRI,
	        CAST(FLOOR(SUM(X.SAT)) AS VARCHAR) SAT,  CAST(FLOOR(SUM(X.SUN)) AS VARCHAR) SUN, ''
	             FROM
	                 (SELECT 4 + 2 AS SORT_SEQ,
	                            A.DIV_CODE,
	                            A.WORK_SHOP_CODE,
	                            A.ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END MON,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END TUE,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END WED,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END THU,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END FRI,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SAT,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SUN
	                             FROM    PPL100T A, BPR100T B
	                            Where    A.COMP_CODE = #{S_COMP_CODE}
	                              and    A.ITEM_CODE = B.ITEM_CODE
	                              AND    A.DIV_CODE = #{DIV_CODE}
	                              AND    A.PRODT_PLAN_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                              							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                  SELECT  DISTINCT 4 + 2 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                                     0,0,0,0,0,0,0
	           Union All
	                 SELECT 4 + 3 AS SORT_SEQ,
	                          A.DIV_CODE,
	                           A.WORK_SHOP_CODE,
	                           C.STOCK_UNIT ITEM_CODE,
	                        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END TUE,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN A.WKORD_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END THU,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SAT,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SUN
	                     FROM  PMP100T A, BPR100T C
	                     Where  A.COMP_CODE = #{S_COMP_CODE}
	                    AND     A.ITEM_CODE = C.ITEM_CODE
	                    AND     A.LINE_END_YN = 'Y'
	                    AND     A.DIV_CODE = #{DIV_CODE}
	                    AND     A.PRODT_START_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND C.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 4 + 3 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                                     0,0,0,0,0,0,0
	         UNION ALL
	                   SELECT  4 + 4 AS SORT_SEQ,
	                          B.DIV_CODE,
	                           B.WORK_SHOP_CODE,
	                           '' ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END TUE,
	                         CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END THU,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END SAT,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 7, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                              THEN B.PRODT_Q  ELSE 0 END SUN
	                     FROM    BPR100T A, PMR110T B
	                     Where   B.COMP_CODE = #{S_COMP_CODE}
	                      AND    B.ITEM_CODE = A.ITEM_CODE
	                      AND    B.DIV_CODE = #{DIV_CODE}
	                    AND    B.PRODT_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    						AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 4 + 4 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                                     0,0,0,0,0,0,0
	 ) X
	 GROUP BY X.SORT_SEQ, X.DIV_CODE, X.GUBUN
	 Union All
	 SELECT
	        '사업장' DIV_CODE, 8 + 1 SORT_SEQ, '' GUBUN, 0 TOT_Q,  
	         CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) MON,     CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) TUE,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) WED, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) THU,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) FRI, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SAT,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SUN, '' WIN     
	        Union All 
	 SELECT
	        X.DIV_CODE, X.SORT_SEQ, X.GUBUN,
	        (SUM(X.MON) + SUM(X.TUE) + SUM(X.WED) + SUM(X.THU) + SUM(X.FRI) + SUM(X.SAT) + SUM(X.SUN)) TOT_Q,
	        CAST(FLOOR(SUM(X.MON)) AS VARCHAR) MON,  CAST(FLOOR(SUM(X.TUE)) AS VARCHAR) TUE, CAST(FLOOR(SUM(X.WED)) AS VARCHAR) WED,
	        CAST(FLOOR(SUM(X.THU)) AS VARCHAR) THU,  CAST(FLOOR(SUM(X.FRI)) AS VARCHAR) FRI,
	        CAST(FLOOR(SUM(X.SAT)) AS VARCHAR) SAT,  CAST(FLOOR(SUM(X.SUN)) AS VARCHAR) SUN, ''
	             FROM
	                 (SELECT 8 + 2 AS SORT_SEQ,
	                            A.DIV_CODE,
	                            A.WORK_SHOP_CODE,
	                            A.ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END MON,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END TUE,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END WED,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END THU,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END FRI,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SAT,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SUN
	                             FROM    PPL100T A, BPR100T B
	                            Where    A.COMP_CODE = #{S_COMP_CODE}
	                              and    A.ITEM_CODE = B.ITEM_CODE
	                              AND    A.DIV_CODE = #{DIV_CODE}
	                              AND    A.PRODT_PLAN_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                              							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                  SELECT  DISTINCT 8 + 2 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                                     0,0,0,0,0,0,0
	           Union All
	                 SELECT 8 + 3 AS SORT_SEQ,
	                          A.DIV_CODE,
	                           A.WORK_SHOP_CODE,
	                           C.STOCK_UNIT ITEM_CODE,
	                        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END TUE,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN A.WKORD_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END THU,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SAT,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SUN
	                     FROM  PMP100T A, BPR100T C
	                     Where  A.COMP_CODE = #{S_COMP_CODE}
	                    AND     A.ITEM_CODE = C.ITEM_CODE
	                    AND     A.LINE_END_YN = 'Y'
	                    AND     A.DIV_CODE = #{DIV_CODE}
	                    AND     A.PRODT_START_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND C.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 8 + 3 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                                     0,0,0,0,0,0,0
	         UNION ALL
	                   SELECT  8 + 4 AS SORT_SEQ,
	                          B.DIV_CODE,
	                           B.WORK_SHOP_CODE,
	                           '' ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END TUE,
	                         CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END THU,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END SAT,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 14, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                              THEN B.PRODT_Q  ELSE 0 END SUN
	                     FROM    BPR100T A, PMR110T B
	                     Where   B.COMP_CODE = #{S_COMP_CODE}
	                      AND    B.ITEM_CODE = A.ITEM_CODE
	                      AND    B.DIV_CODE = #{DIV_CODE}
	                    AND    B.PRODT_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    						AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 8 + 4 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                                     0,0,0,0,0,0,0
	 ) X
	 GROUP BY X.SORT_SEQ, X.DIV_CODE, X.GUBUN
	 Union All
	 SELECT
	        '사업장' DIV_CODE, 12 + 1 SORT_SEQ, '' GUBUN, 0 TOT_Q,  
	         CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) MON,     CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) TUE,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) WED, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) THU,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) FRI, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SAT,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SUN, '' WIN     
	        Union All 
	 SELECT
	        X.DIV_CODE, X.SORT_SEQ, X.GUBUN,
	        (SUM(X.MON) + SUM(X.TUE) + SUM(X.WED) + SUM(X.THU) + SUM(X.FRI) + SUM(X.SAT) + SUM(X.SUN)) TOT_Q,
	        CAST(FLOOR(SUM(X.MON)) AS VARCHAR) MON,  CAST(FLOOR(SUM(X.TUE)) AS VARCHAR) TUE, CAST(FLOOR(SUM(X.WED)) AS VARCHAR) WED,
	        CAST(FLOOR(SUM(X.THU)) AS VARCHAR) THU,  CAST(FLOOR(SUM(X.FRI)) AS VARCHAR) FRI,
	        CAST(FLOOR(SUM(X.SAT)) AS VARCHAR) SAT,  CAST(FLOOR(SUM(X.SUN)) AS VARCHAR) SUN, ''
	             FROM
	                 (SELECT 12 + 2 AS SORT_SEQ,
	                            A.DIV_CODE,
	                            A.WORK_SHOP_CODE,
	                            A.ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END MON,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END TUE,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END WED,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END THU,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END FRI,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SAT,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SUN
	                             FROM    PPL100T A, BPR100T B
	                            Where    A.COMP_CODE = #{S_COMP_CODE}
	                              and    A.ITEM_CODE = B.ITEM_CODE
	                              AND    A.DIV_CODE = #{DIV_CODE}
	                              AND    A.PRODT_PLAN_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                              							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                  SELECT  DISTINCT 12 + 2 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                                     0,0,0,0,0,0,0
	           Union All
	                 SELECT 12 + 3 AS SORT_SEQ,
	                          A.DIV_CODE,
	                           A.WORK_SHOP_CODE,
	                           C.STOCK_UNIT ITEM_CODE,
	                        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END TUE,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN A.WKORD_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END THU,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SAT,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SUN
	                     FROM  PMP100T A, BPR100T C
	                     Where  A.COMP_CODE = #{S_COMP_CODE}
	                    AND     A.ITEM_CODE = C.ITEM_CODE
	                    AND     A.LINE_END_YN = 'Y'
	                    AND     A.DIV_CODE = #{DIV_CODE}
	                    AND     A.PRODT_START_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'
	                    							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
	                    							   
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND C.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 12 + 3 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                                     0,0,0,0,0,0,0
	         UNION ALL
	                   SELECT  12 + 4 AS SORT_SEQ,
	                          B.DIV_CODE,
	                           B.WORK_SHOP_CODE,
	                           '' ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END TUE,
	                         CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END THU,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END SAT,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 21, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                              THEN B.PRODT_Q  ELSE 0 END SUN
	                     FROM    BPR100T A, PMR110T B
	                     Where   B.COMP_CODE = #{S_COMP_CODE}
	                      AND    B.ITEM_CODE = A.ITEM_CODE
	                      AND    B.DIV_CODE = #{DIV_CODE}
	                    AND    B.PRODT_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    						AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 12 + 4 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                                     0,0,0,0,0,0,0
	 ) X
	 GROUP BY X.SORT_SEQ, X.DIV_CODE, X.GUBUN
	 Union All
	 SELECT
	        '사업장' DIV_CODE, 16 + 1 SORT_SEQ, '' GUBUN, 0 TOT_Q,  
	         CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) MON,     CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) TUE,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) WED, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) THU,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) FRI, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SAT,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SUN, '' WIN     
	        Union All 
	 SELECT
	        X.DIV_CODE, X.SORT_SEQ, X.GUBUN,
	        (SUM(X.MON) + SUM(X.TUE) + SUM(X.WED) + SUM(X.THU) + SUM(X.FRI) + SUM(X.SAT) + SUM(X.SUN)) TOT_Q,
	        CAST(FLOOR(SUM(X.MON)) AS VARCHAR) MON,  CAST(FLOOR(SUM(X.TUE)) AS VARCHAR) TUE, CAST(FLOOR(SUM(X.WED)) AS VARCHAR) WED,
	        CAST(FLOOR(SUM(X.THU)) AS VARCHAR) THU,  CAST(FLOOR(SUM(X.FRI)) AS VARCHAR) FRI,
	        CAST(FLOOR(SUM(X.SAT)) AS VARCHAR) SAT,  CAST(FLOOR(SUM(X.SUN)) AS VARCHAR) SUN, ''
	             FROM
	                 (SELECT 16 + 2 AS SORT_SEQ,
	                            A.DIV_CODE,
	                            A.WORK_SHOP_CODE,
	                            A.ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END MON,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END TUE,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END WED,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END THU,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END FRI,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SAT,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SUN
	                             FROM    PPL100T A, BPR100T B
	                            Where    A.COMP_CODE = #{S_COMP_CODE}
	                              and    A.ITEM_CODE = B.ITEM_CODE
	                              AND    A.DIV_CODE = #{DIV_CODE}
	                              AND    A.PRODT_PLAN_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'
	                              							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                  SELECT  DISTINCT 16 + 2 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                                     0,0,0,0,0,0,0
	           Union All
	                 SELECT 16 + 3 AS SORT_SEQ,
	                          A.DIV_CODE,
	                           A.WORK_SHOP_CODE,
	                           C.STOCK_UNIT ITEM_CODE,
	                        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END TUE,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN A.WKORD_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END THU,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SAT,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SUN
	                     FROM  PMP100T A, BPR100T C
	                     Where  A.COMP_CODE = #{S_COMP_CODE}
	                    AND     A.ITEM_CODE = C.ITEM_CODE
	                    AND     A.LINE_END_YN = 'Y'
	                    AND     A.DIV_CODE = #{DIV_CODE}
	                    AND     A.PRODT_START_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND C.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 16 + 3 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                                     0,0,0,0,0,0,0
	         UNION ALL
	                   SELECT  16 + 4 AS SORT_SEQ,
	                          B.DIV_CODE,
	                           B.WORK_SHOP_CODE,
	                           '' ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END TUE,
	                         CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END THU,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END SAT,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 28, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                              THEN B.PRODT_Q  ELSE 0 END SUN
	                     FROM    BPR100T A, PMR110T B
	                     Where   B.COMP_CODE = #{S_COMP_CODE}
	                      AND    B.ITEM_CODE = A.ITEM_CODE
	                      AND    B.DIV_CODE = #{DIV_CODE}
	                    AND    B.PRODT_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    						AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 16 + 4 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                                     0,0,0,0,0,0,0
	 ) X
	 GROUP BY X.SORT_SEQ, X.DIV_CODE, X.GUBUN
	 Union All
	 SELECT
	        '사업장' DIV_CODE, 20 + 1 SORT_SEQ, '' GUBUN, 0 TOT_Q,  
	         CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) MON,     CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) TUE,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) WED, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) THU,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) FRI, CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SAT,
	        CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 111) SUN, '' WIN     
	        Union All 
	 SELECT
	        X.DIV_CODE, X.SORT_SEQ, X.GUBUN,
	        (SUM(X.MON) + SUM(X.TUE) + SUM(X.WED) + SUM(X.THU) + SUM(X.FRI) + SUM(X.SAT) + SUM(X.SUN)) TOT_Q,
	        CAST(FLOOR(SUM(X.MON)) AS VARCHAR) MON,  CAST(FLOOR(SUM(X.TUE)) AS VARCHAR) TUE, CAST(FLOOR(SUM(X.WED)) AS VARCHAR) WED,
	        CAST(FLOOR(SUM(X.THU)) AS VARCHAR) THU,  CAST(FLOOR(SUM(X.FRI)) AS VARCHAR) FRI,
	        CAST(FLOOR(SUM(X.SAT)) AS VARCHAR) SAT,  CAST(FLOOR(SUM(X.SUN)) AS VARCHAR) SUN, ''
	             FROM
	                 (SELECT 20 + 2 AS SORT_SEQ,
	                            A.DIV_CODE,
	                            A.WORK_SHOP_CODE,
	                            A.ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END MON,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END TUE,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END WED,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END THU,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END FRI,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SAT,
	                            CASE WHEN RIGHT(A.PRODT_PLAN_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                  THEN A.WK_PLAN_Q  ELSE 0 END SUN
	                             FROM    PPL100T A, BPR100T B
	                            Where    A.COMP_CODE = #{S_COMP_CODE}
	                              and    A.ITEM_CODE = B.ITEM_CODE
	                              AND    A.DIV_CODE = #{DIV_CODE}
	                              AND    A.PRODT_PLAN_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                              							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                  SELECT  DISTINCT 20 + 2 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '11') AS GUBUN,
	                                     0,0,0,0,0,0,0
	           Union All
	                 SELECT 20 + 3 AS SORT_SEQ,
	                          A.DIV_CODE,
	                           A.WORK_SHOP_CODE,
	                           C.STOCK_UNIT ITEM_CODE,
	                        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END TUE,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN A.WKORD_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END THU,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SAT,
	                           CASE WHEN RIGHT(A.PRODT_START_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN A.WKORD_Q  ELSE 0 END SUN
	                     FROM  PMP100T A, BPR100T C
	                     Where  A.COMP_CODE = #{S_COMP_CODE}
	                    AND     A.ITEM_CODE = C.ITEM_CODE
	                    AND     A.LINE_END_YN = 'Y'
	                    AND     A.DIV_CODE = #{DIV_CODE}
	                    AND     A.PRODT_START_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    							   AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND C.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 20 + 3 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '12') AS GUBUN,
	                                     0,0,0,0,0,0,0
	         UNION ALL
	                   SELECT  20 + 4 AS SORT_SEQ,
	                          B.DIV_CODE,
	                           B.WORK_SHOP_CODE,
	                           '' ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END MON,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 1) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END TUE,
	                         CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 2) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END WED,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 3) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                THEN B.PRODT_Q  ELSE 0 END THU,
	                           CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 4) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END FRI,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 5) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                                 THEN B.PRODT_Q  ELSE 0 END SAT,
	                          CASE WHEN RIGHT(B.PRODT_DATE, 2) = RIGHT(CONVERT(VARCHAR(10), DATEADD(dd, (6 * -1 + 6) + 35, CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01'), 11), 2)
	                                              THEN B.PRODT_Q  ELSE 0 END SUN
	                     FROM    BPR100T A, PMR110T B
	                     Where   B.COMP_CODE = #{S_COMP_CODE}
	                      AND    B.ITEM_CODE = A.ITEM_CODE
	                      AND    B.DIV_CODE = #{DIV_CODE}
	                    AND    B.PRODT_DATE BETWEEN CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '01' 
	                    						AND CASE WHEN #{FR_DATE} = '' THEN CONVERT(NVARCHAR(06), GETDATE(), 112) ELSE #{FR_DATE} END + '31'
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  = #{ITEM_CODE}
						</if>
						<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND B.ITEM_CODE	  LIKE #{ITEM_CODE} + '%'
						</if>
						<if test="@foren.Ognl@isEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)"> <!-- 20210824 수정: 품목코드 팝업창 정규화 -->
							AND A.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'
						</if>
	                   Union All
	                   SELECT  DISTINCT 20 + 4 AS SORT_SEQ, '01' AS DIV_CODE, '' AS WORK_SHOP_CODE, '' AS ITEM_CODE,
	                         (SELECT CODE_NAME FROM BSA100T WHERE COMP_CODE = #{S_COMP_CODE} AND MAIN_CODE = 'P105' AND SUB_CODE = '13') AS GUBUN,
	                                     0,0,0,0,0,0,0
	 ) X
	 GROUP BY X.SORT_SEQ, X.DIV_CODE, X.GUBUN
	</select>
</mapper>