<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pmr210skrvServiceImpl">
	<select id="pmr210skrvServiceImpl.selectList" parameterType="Map" resultType="rMap">
		/* pmr210skrv.Cpmr210skrv[fnPmr210QStd] Query01 */
		/*******************************************************************************************
		 월 생산 실적조회쿼리
		*******************************************************************************************/
		BEGIN
			SET NOCOUNT ON
			SET ARITHABORT ON
				
			DECLARE @RefItem		NVARCHAR(01)
				  , @DateFormat		NVARCHAR(10)

			

			/* 명칭 참조 유형 */
			SELECT TOP 1 @RefItem = REF_ITEM
			  FROM BSA300T WITH (NOLOCK)
			 WHERE COMP_CODE = #{S_COMP_CODE}
			   AND USER_ID = #{S_USER_ID}
				
			SET @RefItem = ISNULL(@RefItem, N'0')

			/* 날짜 포맷 유형 설정 */
			SELECT TOP 1 @DateFormat = CODE_NAME
			  FROM BSA100T WITH (NOLOCK)
			 WHERE COMP_CODE = #{S_COMP_CODE}
			   AND MAIN_CODE = N'B044'
			   AND REF_CODE1 = N'Y'

			SET @DateFormat = ISNULL(@DateFormat, 'YYYY.MM.DD')
		
			/*--------  조회 ------------------------------------------------------------------*/
			SELECT 
				   A1.WORK_SHOP_CODE
				 , C1.TREE_NAME											AS WORK_SHOP_NAME
				 , A1.ITEM_CODE
				 , CASE WHEN @RefItem = '1' THEN D1.ITEM_NAME1
							WHEN @RefItem = '2' THEN D1.ITEM_NAME2
							ELSE D1.ITEM_NAME
				   END													AS ITEM_NAME
				 , D1.ITEM_NAME1
				 , D1.SPEC
				 , D1.STOCK_UNIT
				 , ISNULL(B1.PRODT_Q, 0)								AS PRODT_Q
				 , ISNULL(B1.GOOD_Q, 0)									AS GOOD_Q
				 , ISNULL(B1.BAD_Q, 0)									AS BAD_Q
				 , ISNULL(B1.GOOD_Q, 0) / ISNULL(B1.PRODT_Q, 0) * 100   AS YIELD_RATE
				 , ISNULL(B1.IN_STOCK_Q, 0)								AS IN_STOCK_Q
				 , ISNULL(B1.MAN_HOUR, 0)							AS MAN_HOUR
				 , SUM(ISNULL(A1.DAY_01, 0)) AS DAY_01
				 , SUM(ISNULL(A1.DAY_02, 0)) AS DAY_02
				 , SUM(ISNULL(A1.DAY_03, 0)) AS DAY_03
				 , SUM(ISNULL(A1.DAY_04, 0)) AS DAY_04
				 , SUM(ISNULL(A1.DAY_05, 0)) AS DAY_05
				 , SUM(ISNULL(A1.DAY_06, 0)) AS DAY_06
				 , SUM(ISNULL(A1.DAY_07, 0)) AS DAY_07
				 , SUM(ISNULL(A1.DAY_08, 0)) AS DAY_08
				 , SUM(ISNULL(A1.DAY_09, 0)) AS DAY_09
				 , SUM(ISNULL(A1.DAY_10, 0)) AS DAY_10
				 , SUM(ISNULL(A1.DAY_11, 0)) AS DAY_11
				 , SUM(ISNULL(A1.DAY_12, 0)) AS DAY_12
				 , SUM(ISNULL(A1.DAY_13, 0)) AS DAY_13
				 , SUM(ISNULL(A1.DAY_14, 0)) AS DAY_14
				 , SUM(ISNULL(A1.DAY_15, 0)) AS DAY_15
				 , SUM(ISNULL(A1.DAY_16, 0)) AS DAY_16
				 , SUM(ISNULL(A1.DAY_17, 0)) AS DAY_17
				 , SUM(ISNULL(A1.DAY_18, 0)) AS DAY_18
				 , SUM(ISNULL(A1.DAY_19, 0)) AS DAY_19
				 , SUM(ISNULL(A1.DAY_20, 0)) AS DAY_20
				 , SUM(ISNULL(A1.DAY_21, 0)) AS DAY_21
				 , SUM(ISNULL(A1.DAY_22, 0)) AS DAY_22
				 , SUM(ISNULL(A1.DAY_23, 0)) AS DAY_23
				 , SUM(ISNULL(A1.DAY_24, 0)) AS DAY_24
				 , SUM(ISNULL(A1.DAY_25, 0)) AS DAY_25
				 , SUM(ISNULL(A1.DAY_26, 0)) AS DAY_26
				 , SUM(ISNULL(A1.DAY_27, 0)) AS DAY_27
				 , SUM(ISNULL(A1.DAY_28, 0)) AS DAY_28
				 , SUM(ISNULL(A1.DAY_29, 0)) AS DAY_29
				 , SUM(ISNULL(A1.DAY_30, 0)) AS DAY_30
				 , SUM(ISNULL(A1.DAY_31, 0)) AS DAY_31
			
			  FROM (
					SELECT
						   A.COMP_CODE
						 , A.DIV_CODE
						 , A.WORK_SHOP_CODE
						 , A.ITEM_CODE
					<if test="INCLUDED_YN == &quot;Y&quot;">
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '01' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_01
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '02' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_02
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '03' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_03
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '04' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_04
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '05' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_05
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '06' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_06
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '07' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_07
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '08' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_08
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '09' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_09
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '10' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_10
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '11' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_11
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '12' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_12
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '13' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_13
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '14' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_14
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '15' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_15
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '16' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_16
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '17' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_17
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '18' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_18
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '19' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_19
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '20' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_20
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '21' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_21
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '22' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_22
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '23' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_23
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '24' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_24
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '25' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_25
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '26' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_26
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '27' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_27
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '28' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_28
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '29' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_29
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '30' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_30
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '31' THEN SUM(ISNULL(A.PRODT_Q, 0))
								ELSE 0
							END AS DAY_31
					</if>
					<if test="INCLUDED_YN == &quot;N&quot;">
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '01' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_01
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '02' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_02
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '03' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_03
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '04' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_04
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '05' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_05
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '06' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_06
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '07' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_07
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '08' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_08
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '09' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_09
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '10' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_10
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '11' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_11
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '12' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_12
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '13' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_13
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '14' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_14
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '15' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_15
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '16' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_16
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '17' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_17
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '18' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_18
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '19' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_19
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '20' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_20
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '21' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_21
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '22' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_22
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '23' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_23
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '24' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_24
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '25' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_25
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '26' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_26
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '27' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_27
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '28' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_28
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '29' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_29
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '30' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_30
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '31' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
								ELSE 0
							END AS DAY_31
					</if>
					  FROM			PMR200T A WITH(NOLOCK)
					  LEFT OUTER JOIN BPR100T B WITH(NOLOCK) ON B.COMP_CODE = A.COMP_CODE
					  										AND B.ITEM_CODE = A.ITEM_CODE
					 WHERE A.COMP_CODE			= #{S_COMP_CODE}
					/*--------조회조건-----------*/
					<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
					   AND A.DIV_CODE			= #{DIV_CODE}							/*사업장*/
					</if>
					<if test="@foren.Ognl@isNotEmpty(PRODT_DATE)">
					   AND LEFT(A.PRODT_DATE, 6)= #{PRODT_DATE}							/*기준년월*/
					</if>
					<if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
					   AND A.WORK_SHOP_CODE		= #{WORK_SHOP_CODE}						/*작업장*/
					</if>
					
					<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
					   AND A.ITEM_CODE 		= #{ITEM_CODE}						/* 품목코드  */
					</if>
					<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
					   AND A.ITEM_CODE 		LIKE #{ITEM_CODE} + '%'				/* 품목코드  */
					</if>
					<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
					   AND B.ITEM_NAME 		LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
					</if>
					
					 GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, A.ITEM_CODE, A.PRODT_DATE
				) AS A1
			   INNER JOIN (  SELECT
							 		A.COMP_CODE
								 	, A.DIV_CODE
								 	, A.WORK_SHOP_CODE
								 	, A.ITEM_CODE
								 	, SUM(ISNULL(A.PRODT_Q, 0))			AS PRODT_Q
									, SUM(ISNULL(A.GOOD_Q, 0))			AS GOOD_Q
									, SUM(ISNULL(A.BAD_Q, 0))			AS BAD_Q
									, SUM(ISNULL(A.IN_STOCK_Q, 0))		AS IN_STOCK_Q
									, SUM(ISNULL(E.MAN_HOUR, 0))		AS MAN_HOUR
				            FROM	(	SELECT
										  A.COMP_CODE
										, A.DIV_CODE
										, A.WORK_SHOP_CODE
										, A.ITEM_CODE
										, A.WKORD_NUM
										, SUM(ISNULL(A.PRODT_Q, 0))					AS PRODT_Q
										, SUM(ISNULL(A.GOOD_PRODT_Q, 0))			AS GOOD_Q
										, SUM(ISNULL(A.BAD_PRODT_Q, 0))				AS BAD_Q
										, SUM(ISNULL(A.IN_STOCK_Q, 0))				AS IN_STOCK_Q 
										FROM PMR200T A WITH(NOLOCK)
										LEFT OUTER JOIN BPR100T B WITH(NOLOCK) ON B.COMP_CODE = A.COMP_CODE
																			  AND B.ITEM_CODE = A.ITEM_CODE
										WHERE A.COMP_CODE			= #{S_COMP_CODE}
										/*--------조회조건-----------*/
										<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
										   AND A.DIV_CODE			= #{DIV_CODE}							/*사업장*/
										</if>
										<if test="@foren.Ognl@isNotEmpty(PRODT_DATE)">
										   AND LEFT(A.PRODT_DATE, 6)= #{PRODT_DATE}							/*기준년월*/
										</if>
										<if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
										   AND A.WORK_SHOP_CODE		= #{WORK_SHOP_CODE}						/*작업장*/
										</if>
										
										<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
										   AND A.ITEM_CODE 		= #{ITEM_CODE}						/* 품목코드  */
										</if>
										<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
										   AND A.ITEM_CODE 		LIKE #{ITEM_CODE} + '%'				/* 품목코드  */
										</if>
										<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
										   AND B.ITEM_NAME 		LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
										</if>
										
										GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, A.ITEM_CODE, A.WKORD_NUM

							) A 

							INNER JOIN (SELECT
												  COMP_CODE
												, DIV_CODE
												, WKORD_NUM
												, SUM(ISNULL(MAN_HOUR, 0)) AS MAN_HOUR
											 FROM PMR100T WITH(NOLOCK)
											WHERE COMP_CODE = #{S_COMP_CODE}
											  AND DIV_CODE  = #{DIV_CODE}						/*사업장*/
											GROUP BY COMP_CODE, DIV_CODE, WKORD_NUM) AS E ON E.COMP_CODE  = A.COMP_CODE
																						 AND E.DIV_CODE   = A.DIV_CODE
																						 AND E.WKORD_NUM  = A.WKORD_NUM

							GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, A.ITEM_CODE
						) AS B1 ON B1.COMP_CODE		= A1.COMP_CODE
							   AND B1.DIV_CODE		= A1.DIV_CODE
							   AND B1.WORK_SHOP_CODE= A1.WORK_SHOP_CODE
							   AND B1.ITEM_CODE		= A1.ITEM_CODE
			   INNER JOIN BPR100T D1 WITH(NOLOCK) ON D1.COMP_CODE	= A1.COMP_CODE
												 AND D1.ITEM_CODE	= A1.ITEM_CODE
			   INNER JOIN BSA230T C1 WITH(NOLOCK) ON C1.COMP_CODE	= A1.COMP_CODE
												 AND C1.TYPE_LEVEL	= A1.DIV_CODE
												 AND C1.TREE_CODE	= A1.WORK_SHOP_CODE
			 GROUP BY A1.WORK_SHOP_CODE, A1.ITEM_CODE, C1.TREE_NAME, D1.SPEC, D1.STOCK_UNIT
					, B1.PRODT_Q, B1.GOOD_Q, B1.BAD_Q, B1.IN_STOCK_Q, B1.MAN_HOUR, D1.ITEM_NAME1, D1.ITEM_NAME2, D1.ITEM_NAME
			 ORDER BY A1.WORK_SHOP_CODE, A1.ITEM_CODE

			SET ARITHABORT OFF
			SET NOCOUNT OFF
		END	 
	</select>





	<select id="pmr210skrvServiceImpl.selectList2" parameterType="Map" resultType="rMap">
		/* 설비별 */
				BEGIN
			SET NOCOUNT ON
			SET ARITHABORT ON
				
			DECLARE @RefItem		NVARCHAR(01)
				  , @DateFormat		NVARCHAR(10)

			

			/* 명칭 참조 유형 */
			SELECT TOP 1 @RefItem = REF_ITEM
			  FROM BSA300T WITH (NOLOCK)
			 WHERE COMP_CODE = #{S_COMP_CODE}
			   AND USER_ID = #{S_USER_ID}
				
			SET @RefItem = ISNULL(@RefItem, N'0')

			/* 날짜 포맷 유형 설정 */
			SELECT TOP 1 @DateFormat = CODE_NAME
			  FROM BSA100T WITH (NOLOCK)
			 WHERE COMP_CODE = #{S_COMP_CODE}
			   AND MAIN_CODE = N'B044'
			   AND REF_CODE1 = N'Y'

			SET @DateFormat = ISNULL(@DateFormat, 'YYYY.MM.DD')
		
			/*--------  조회 ------------------------------------------------------------------*/
			SELECT 
				   A1.WORK_SHOP_CODE
				 , C1.TREE_NAME											AS WORK_SHOP_NAME
				 , A1.ITEM_CODE
				 , CASE WHEN @RefItem = '1' THEN D1.ITEM_NAME1
							WHEN @RefItem = '2' THEN D1.ITEM_NAME2
							ELSE D1.ITEM_NAME
				   END													AS ITEM_NAME
				 , D1.ITEM_NAME1
				 , D1.SPEC
				 , D1.STOCK_UNIT
				 , ISNULL(B1.PRODT_Q, 0)								AS PRODT_Q
				 , ISNULL(B1.GOOD_Q, 0)									AS GOOD_Q
				 , ISNULL(B1.BAD_Q, 0)									AS BAD_Q
				 , ISNULL(B1.GOOD_Q, 0) / ISNULL(B1.PRODT_Q, 0) * 100   AS YIELD_RATE
				 , ISNULL(B1.IN_STOCK_Q, 0)								AS IN_STOCK_Q
				 , ISNULL(B1.MAN_HOUR, 0)							AS MAN_HOUR
				 , SUM(ISNULL(A1.DAY_01, 0)) AS DAY_01
				 , SUM(ISNULL(A1.DAY_02, 0)) AS DAY_02
				 , SUM(ISNULL(A1.DAY_03, 0)) AS DAY_03
				 , SUM(ISNULL(A1.DAY_04, 0)) AS DAY_04
				 , SUM(ISNULL(A1.DAY_05, 0)) AS DAY_05
				 , SUM(ISNULL(A1.DAY_06, 0)) AS DAY_06
				 , SUM(ISNULL(A1.DAY_07, 0)) AS DAY_07
				 , SUM(ISNULL(A1.DAY_08, 0)) AS DAY_08
				 , SUM(ISNULL(A1.DAY_09, 0)) AS DAY_09
				 , SUM(ISNULL(A1.DAY_10, 0)) AS DAY_10
				 , SUM(ISNULL(A1.DAY_11, 0)) AS DAY_11
				 , SUM(ISNULL(A1.DAY_12, 0)) AS DAY_12
				 , SUM(ISNULL(A1.DAY_13, 0)) AS DAY_13
				 , SUM(ISNULL(A1.DAY_14, 0)) AS DAY_14
				 , SUM(ISNULL(A1.DAY_15, 0)) AS DAY_15
				 , SUM(ISNULL(A1.DAY_16, 0)) AS DAY_16
				 , SUM(ISNULL(A1.DAY_17, 0)) AS DAY_17
				 , SUM(ISNULL(A1.DAY_18, 0)) AS DAY_18
				 , SUM(ISNULL(A1.DAY_19, 0)) AS DAY_19
				 , SUM(ISNULL(A1.DAY_20, 0)) AS DAY_20
				 , SUM(ISNULL(A1.DAY_21, 0)) AS DAY_21
				 , SUM(ISNULL(A1.DAY_22, 0)) AS DAY_22
				 , SUM(ISNULL(A1.DAY_23, 0)) AS DAY_23
				 , SUM(ISNULL(A1.DAY_24, 0)) AS DAY_24
				 , SUM(ISNULL(A1.DAY_25, 0)) AS DAY_25
				 , SUM(ISNULL(A1.DAY_26, 0)) AS DAY_26
				 , SUM(ISNULL(A1.DAY_27, 0)) AS DAY_27
				 , SUM(ISNULL(A1.DAY_28, 0)) AS DAY_28
				 , SUM(ISNULL(A1.DAY_29, 0)) AS DAY_29
				 , SUM(ISNULL(A1.DAY_30, 0)) AS DAY_30
				 , SUM(ISNULL(A1.DAY_31, 0)) AS DAY_31
			
			, A1.EQUIP_CODE --설비
			, MAX(R2.EQU_NAME) AS EQUIP_NAME
			  FROM (
					SELECT 
						T.COMP_CODE
						 , T.DIV_CODE
						 , T.WORK_SHOP_CODE
						 , T.ITEM_CODE
						, B.EQUIP_CODE
						,SUM(T.DAY_01) AS DAY_01
						,SUM(T.DAY_02) AS DAY_02
						,SUM(T.DAY_03) AS DAY_03
						,SUM(T.DAY_04) AS DAY_04
						,SUM(T.DAY_05) AS DAY_05
						,SUM(T.DAY_06) AS DAY_06
						,SUM(T.DAY_07) AS DAY_07
						,SUM(T.DAY_08) AS DAY_08
						,SUM(T.DAY_09) AS DAY_09
						,SUM(T.DAY_10) AS DAY_10
						,SUM(T.DAY_11) AS DAY_11
						,SUM(T.DAY_12) AS DAY_12
						,SUM(T.DAY_13) AS DAY_13
						,SUM(T.DAY_14) AS DAY_14
						,SUM(T.DAY_15) AS DAY_15
						,SUM(T.DAY_16) AS DAY_16
						,SUM(T.DAY_17) AS DAY_17
						,SUM(T.DAY_18) AS DAY_18
						,SUM(T.DAY_19) AS DAY_19
						,SUM(T.DAY_20) AS DAY_20
						,SUM(T.DAY_21) AS DAY_21
						,SUM(T.DAY_22) AS DAY_22
						,SUM(T.DAY_23) AS DAY_23
						,SUM(T.DAY_24) AS DAY_24
						,SUM(T.DAY_25) AS DAY_25
						,SUM(T.DAY_26) AS DAY_26
						,SUM(T.DAY_27) AS DAY_27
						,SUM(T.DAY_28) AS DAY_28
						,SUM(T.DAY_29) AS DAY_29
						,SUM(T.DAY_30) AS DAY_30
						,SUM(T.DAY_31) AS DAY_31
						FROM (
							SELECT
							   A.COMP_CODE
							 , A.DIV_CODE
							 , A.WORK_SHOP_CODE
							 , A.ITEM_CODE
							 , A.PRODT_NUM
						<if test="INCLUDED_YN == &quot;Y&quot;">
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '01' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_01
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '02' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_02
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '03' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_03
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '04' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_04
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '05' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_05
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '06' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_06
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '07' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_07
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '08' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_08
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '09' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_09
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '10' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_10
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '11' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_11
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '12' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_12
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '13' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_13
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '14' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_14
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '15' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_15
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '16' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_16
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '17' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_17
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '18' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_18
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '19' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_19
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '20' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_20
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '21' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_21
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '22' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_22
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '23' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_23
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '24' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_24
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '25' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_25
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '26' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_26
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '27' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_27
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '28' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_28
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '29' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_29
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '30' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_30
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '31' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_31
						</if>
						<if test="INCLUDED_YN == &quot;N&quot;">
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '01' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_01
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '02' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_02
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '03' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_03
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '04' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_04
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '05' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_05
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '06' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_06
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '07' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_07
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '08' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_08
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '09' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_09
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '10' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_10
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '11' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_11
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '12' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_12
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '13' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_13
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '14' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_14
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '15' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_15
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '16' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_16
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '17' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_17
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '18' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_18
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '19' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_19
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '20' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_20
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '21' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_21
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '22' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_22
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '23' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_23
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '24' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_24
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '25' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_25
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '26' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_26
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '27' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_27
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '28' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_28
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '29' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_29
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '30' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_30
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '31' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_31
						</if>
					  			FROM			PMR200T A WITH(NOLOCK)
					  			LEFT OUTER JOIN BPR100T B WITH(NOLOCK) ON B.COMP_CODE = A.COMP_CODE
					  												  AND B.ITEM_CODE = A.ITEM_CODE
					 			WHERE A.COMP_CODE			= #{S_COMP_CODE}
								/*--------조회조건-----------*/
								<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
								   AND A.DIV_CODE			= #{DIV_CODE}							/*사업장*/
								</if>
								<if test="@foren.Ognl@isNotEmpty(PRODT_DATE)">
								   AND LEFT(A.PRODT_DATE, 6)= #{PRODT_DATE}							/*기준년월*/
								</if>
								<if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
								   AND A.WORK_SHOP_CODE		= #{WORK_SHOP_CODE}						/*작업장*/
								</if>
								
								<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
								   AND A.ITEM_CODE 		= #{ITEM_CODE}						/* 품목코드  */
								</if>
								<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
								   AND A.ITEM_CODE 		LIKE #{ITEM_CODE} + '%'				/* 품목코드  */
								</if>
								<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
								   AND B.ITEM_NAME 		LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
								</if>
						   
					 			GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, A.ITEM_CODE, A.PRODT_DATE
						 				, A.PRODT_NUM
				) T
				INNER JOIN PMR100T B WITH(NOLOCK) ON B.COMP_CODE = T.COMP_CODE
													AND B.DIV_CODE = T.DIV_CODE
													AND B.PRODT_NUM = T.PRODT_NUM
													
				GROUP BY T.COMP_CODE, T.DIV_CODE, T.WORK_SHOP_CODE, T.ITEM_CODE, B.EQUIP_CODE
				
			) AS A1
	   		INNER JOIN (  SELECT
					 		A.COMP_CODE
						 	, A.DIV_CODE
						 	, A.WORK_SHOP_CODE
						 	, A.ITEM_CODE
						 	, SUM(ISNULL(A.PRODT_Q, 0))			AS PRODT_Q
							, SUM(ISNULL(A.GOOD_Q, 0))			AS GOOD_Q
							, SUM(ISNULL(A.BAD_Q, 0))			AS BAD_Q
							, SUM(ISNULL(A.IN_STOCK_Q, 0))		AS IN_STOCK_Q
							, SUM(ISNULL(A.MAN_HOUR, 0))		AS MAN_HOUR
							, A.EQUIP_CODE
				            FROM(	
				            	SELECT
									  A.COMP_CODE
									, A.DIV_CODE
									, A.WORK_SHOP_CODE
									, A.ITEM_CODE
									
									, SUM(ISNULL(A.PRODT_Q, 0))					AS PRODT_Q
									, SUM(ISNULL(A.GOOD_PRODT_Q, 0))			AS GOOD_Q
									, SUM(ISNULL(A.BAD_PRODT_Q, 0))				AS BAD_Q
									, SUM(ISNULL(A.IN_STOCK_Q, 0))				AS IN_STOCK_Q
									, B.EQUIP_CODE
									, SUM(ISNULL(B.MAN_HOUR, 0)) AS MAN_HOUR 
									FROM PMR200T A WITH(NOLOCK)
									INNER JOIN PMR100T B WITH(NOLOCK) ON B.COMP_CODE = A.COMP_CODE
																		AND B.DIV_CODE = A.DIV_CODE
																		AND B.PRODT_NUM = A.PRODT_NUM
									LEFT OUTER JOIN BPR100T C WITH (NOLOCK) ON C.COMP_CODE = A.COMP_CODE
																		   AND C.ITEM_CODE = A.COMP_CODE
									WHERE A.COMP_CODE			= #{S_COMP_CODE}
									/*--------조회조건-----------*/
									<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
									   AND A.DIV_CODE			= #{DIV_CODE}							/*사업장*/
									</if>
									<if test="@foren.Ognl@isNotEmpty(PRODT_DATE)">
									   AND LEFT(A.PRODT_DATE, 6)= #{PRODT_DATE}							/*기준년월*/
									</if>
									<if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
									   AND A.WORK_SHOP_CODE		= #{WORK_SHOP_CODE}						/*작업장*/
									</if>
									
									<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
									   AND A.ITEM_CODE 		= #{ITEM_CODE}						/* 품목코드  */
									</if>
									<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
									   AND A.ITEM_CODE 		LIKE #{ITEM_CODE} + '%'				/* 품목코드  */
									</if>
									<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
									   AND C.ITEM_NAME 		LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
									</if>
									
									GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, B.EQUIP_CODE, A.ITEM_CODE
							) A 
							GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE,A.EQUIP_CODE, A.ITEM_CODE
						) AS B1 ON B1.COMP_CODE		= A1.COMP_CODE
							   AND B1.DIV_CODE		= A1.DIV_CODE
							   AND B1.WORK_SHOP_CODE= A1.WORK_SHOP_CODE
							   AND B1.ITEM_CODE		= A1.ITEM_CODE
							   AND ISNULL(B1.EQUIP_CODE,'')	= ISNULL(A1.EQUIP_CODE,'')
			   INNER JOIN BPR100T D1 WITH(NOLOCK) ON D1.COMP_CODE	= A1.COMP_CODE
												 AND D1.ITEM_CODE	= A1.ITEM_CODE
			   INNER JOIN BSA230T C1 WITH(NOLOCK) ON C1.COMP_CODE	= A1.COMP_CODE
												 AND C1.TYPE_LEVEL	= A1.DIV_CODE
												 AND C1.TREE_CODE	= A1.WORK_SHOP_CODE
										
			LEFT JOIN EQU200T R2 WITH(NOLOCK) ON R2.COMP_CODE = A1.COMP_CODE
											AND R2.DIV_CODE = A1.DIV_CODE
											AND R2.EQU_CODE = A1.EQUIP_CODE
											AND R2.EQU_CODE_TYPE = '2' 								 
												 
												 
			 GROUP BY A1.WORK_SHOP_CODE, C1.TREE_NAME, D1.SPEC, D1.STOCK_UNIT
					, B1.PRODT_Q, B1.GOOD_Q, B1.BAD_Q, B1.IN_STOCK_Q, B1.MAN_HOUR
					
					, A1.EQUIP_CODE
					, A1.ITEM_CODE, D1.ITEM_NAME1, D1.ITEM_NAME2, D1.ITEM_NAME
			 ORDER BY A1.WORK_SHOP_CODE, A1.ITEM_CODE

			SET ARITHABORT OFF
			SET NOCOUNT OFF
		END	 
		
	</select>



	<select id="pmr210skrvServiceImpl.selectList3" parameterType="Map" resultType="rMap">
		/* 금형별 */
								BEGIN
			SET NOCOUNT ON
			SET ARITHABORT ON
				
			DECLARE @RefItem		NVARCHAR(01)
				  , @DateFormat		NVARCHAR(10)

			

			/* 명칭 참조 유형 */
			SELECT TOP 1 @RefItem = REF_ITEM
			  FROM BSA300T WITH (NOLOCK)
			 WHERE COMP_CODE = #{S_COMP_CODE}
			   AND USER_ID = #{S_USER_ID}
				
			SET @RefItem = ISNULL(@RefItem, N'0')

			/* 날짜 포맷 유형 설정 */
			SELECT TOP 1 @DateFormat = CODE_NAME
			  FROM BSA100T WITH (NOLOCK)
			 WHERE COMP_CODE = #{S_COMP_CODE}
			   AND MAIN_CODE = N'B044'
			   AND REF_CODE1 = N'Y'

			SET @DateFormat = ISNULL(@DateFormat, 'YYYY.MM.DD')
		
			/*--------  조회 ------------------------------------------------------------------*/
			SELECT 
				   A1.WORK_SHOP_CODE
				 , C1.TREE_NAME											AS WORK_SHOP_NAME
				 , A1.ITEM_CODE
				 , CASE WHEN @RefItem = '1' THEN D1.ITEM_NAME1
							WHEN @RefItem = '2' THEN D1.ITEM_NAME2
							ELSE D1.ITEM_NAME
				   END													AS ITEM_NAME
				 , D1.ITEM_NAME1
				 , D1.SPEC
				 , D1.STOCK_UNIT
				 , ISNULL(B1.PRODT_Q, 0)								AS PRODT_Q
				 , ISNULL(B1.GOOD_Q, 0)									AS GOOD_Q
				 , ISNULL(B1.BAD_Q, 0)									AS BAD_Q
				 , ISNULL(B1.GOOD_Q, 0) / ISNULL(B1.PRODT_Q, 0) * 100   AS YIELD_RATE
				 , ISNULL(B1.IN_STOCK_Q, 0)								AS IN_STOCK_Q
				 , ISNULL(B1.MAN_HOUR, 0)							AS MAN_HOUR
				 , SUM(ISNULL(A1.DAY_01, 0)) AS DAY_01
				 , SUM(ISNULL(A1.DAY_02, 0)) AS DAY_02
				 , SUM(ISNULL(A1.DAY_03, 0)) AS DAY_03
				 , SUM(ISNULL(A1.DAY_04, 0)) AS DAY_04
				 , SUM(ISNULL(A1.DAY_05, 0)) AS DAY_05
				 , SUM(ISNULL(A1.DAY_06, 0)) AS DAY_06
				 , SUM(ISNULL(A1.DAY_07, 0)) AS DAY_07
				 , SUM(ISNULL(A1.DAY_08, 0)) AS DAY_08
				 , SUM(ISNULL(A1.DAY_09, 0)) AS DAY_09
				 , SUM(ISNULL(A1.DAY_10, 0)) AS DAY_10
				 , SUM(ISNULL(A1.DAY_11, 0)) AS DAY_11
				 , SUM(ISNULL(A1.DAY_12, 0)) AS DAY_12
				 , SUM(ISNULL(A1.DAY_13, 0)) AS DAY_13
				 , SUM(ISNULL(A1.DAY_14, 0)) AS DAY_14
				 , SUM(ISNULL(A1.DAY_15, 0)) AS DAY_15
				 , SUM(ISNULL(A1.DAY_16, 0)) AS DAY_16
				 , SUM(ISNULL(A1.DAY_17, 0)) AS DAY_17
				 , SUM(ISNULL(A1.DAY_18, 0)) AS DAY_18
				 , SUM(ISNULL(A1.DAY_19, 0)) AS DAY_19
				 , SUM(ISNULL(A1.DAY_20, 0)) AS DAY_20
				 , SUM(ISNULL(A1.DAY_21, 0)) AS DAY_21
				 , SUM(ISNULL(A1.DAY_22, 0)) AS DAY_22
				 , SUM(ISNULL(A1.DAY_23, 0)) AS DAY_23
				 , SUM(ISNULL(A1.DAY_24, 0)) AS DAY_24
				 , SUM(ISNULL(A1.DAY_25, 0)) AS DAY_25
				 , SUM(ISNULL(A1.DAY_26, 0)) AS DAY_26
				 , SUM(ISNULL(A1.DAY_27, 0)) AS DAY_27
				 , SUM(ISNULL(A1.DAY_28, 0)) AS DAY_28
				 , SUM(ISNULL(A1.DAY_29, 0)) AS DAY_29
				 , SUM(ISNULL(A1.DAY_30, 0)) AS DAY_30
				 , SUM(ISNULL(A1.DAY_31, 0)) AS DAY_31
			
			, A1.MOLD_CODE --설비
			, MAX(R2.EQU_NAME) AS MOLD_NAME
			  FROM (
					SELECT 
						T.COMP_CODE
						 , T.DIV_CODE
						 , T.WORK_SHOP_CODE
						 , T.ITEM_CODE
						, B.MOLD_CODE
						,SUM(T.DAY_01) AS DAY_01
						,SUM(T.DAY_02) AS DAY_02
						,SUM(T.DAY_03) AS DAY_03
						,SUM(T.DAY_04) AS DAY_04
						,SUM(T.DAY_05) AS DAY_05
						,SUM(T.DAY_06) AS DAY_06
						,SUM(T.DAY_07) AS DAY_07
						,SUM(T.DAY_08) AS DAY_08
						,SUM(T.DAY_09) AS DAY_09
						,SUM(T.DAY_10) AS DAY_10
						,SUM(T.DAY_11) AS DAY_11
						,SUM(T.DAY_12) AS DAY_12
						,SUM(T.DAY_13) AS DAY_13
						,SUM(T.DAY_14) AS DAY_14
						,SUM(T.DAY_15) AS DAY_15
						,SUM(T.DAY_16) AS DAY_16
						,SUM(T.DAY_17) AS DAY_17
						,SUM(T.DAY_18) AS DAY_18
						,SUM(T.DAY_19) AS DAY_19
						,SUM(T.DAY_20) AS DAY_20
						,SUM(T.DAY_21) AS DAY_21
						,SUM(T.DAY_22) AS DAY_22
						,SUM(T.DAY_23) AS DAY_23
						,SUM(T.DAY_24) AS DAY_24
						,SUM(T.DAY_25) AS DAY_25
						,SUM(T.DAY_26) AS DAY_26
						,SUM(T.DAY_27) AS DAY_27
						,SUM(T.DAY_28) AS DAY_28
						,SUM(T.DAY_29) AS DAY_29
						,SUM(T.DAY_30) AS DAY_30
						,SUM(T.DAY_31) AS DAY_31
						FROM (
							SELECT
							   A.COMP_CODE
							 , A.DIV_CODE
							 , A.WORK_SHOP_CODE
							 , A.ITEM_CODE
							 , A.PRODT_NUM
						<if test="INCLUDED_YN == &quot;Y&quot;">
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '01' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_01
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '02' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_02
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '03' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_03
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '04' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_04
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '05' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_05
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '06' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_06
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '07' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_07
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '08' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_08
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '09' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_09
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '10' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_10
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '11' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_11
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '12' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_12
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '13' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_13
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '14' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_14
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '15' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_15
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '16' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_16
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '17' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_17
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '18' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_18
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '19' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_19
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '20' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_20
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '21' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_21
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '22' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_22
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '23' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_23
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '24' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_24
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '25' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_25
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '26' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_26
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '27' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_27
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '28' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_28
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '29' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_29
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '30' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_30
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '31' THEN SUM(ISNULL(A.PRODT_Q, 0))
									ELSE 0
								END AS DAY_31
						</if>
						<if test="INCLUDED_YN == &quot;N&quot;">
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '01' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_01
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '02' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_02
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '03' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_03
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '04' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_04
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '05' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_05
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '06' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_06
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '07' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_07
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '08' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_08
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '09' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_09
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '10' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_10
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '11' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_11
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '12' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_12
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '13' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_13
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '14' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_14
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '15' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_15
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '16' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_16
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '17' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_17
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '18' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_18
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '19' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_19
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '20' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_20
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '21' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_21
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '22' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_22
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '23' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_23
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '24' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_24
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '25' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_25
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '26' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_26
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '27' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_27
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '28' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_28
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '29' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_29
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '30' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_30
							 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '31' THEN SUM(ISNULL(A.GOOD_PRODT_Q, 0))
									ELSE 0
								END AS DAY_31
						</if>
					  			FROM			PMR200T A WITH(NOLOCK)
					  			LEFT OUTER JOIN BPR100T B WITH(NOLOCK) ON B.COMP_CODE = A.COMP_CODE
					  												  AND B.ITEM_CODE = A.ITEM_CODE
					 			WHERE A.COMP_CODE			= #{S_COMP_CODE}
								/*--------조회조건-----------*/
								<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
								   AND A.DIV_CODE			= #{DIV_CODE}							/*사업장*/
								</if>
								<if test="@foren.Ognl@isNotEmpty(PRODT_DATE)">
								   AND LEFT(A.PRODT_DATE, 6)= #{PRODT_DATE}							/*기준년월*/
								</if>
								<if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
								   AND A.WORK_SHOP_CODE		= #{WORK_SHOP_CODE}						/*작업장*/
								</if>
								
								<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
								   AND A.ITEM_CODE 		= #{ITEM_CODE}						/* 품목코드  */
								</if>
								<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
								   AND A.ITEM_CODE 		LIKE #{ITEM_CODE} + '%'				/* 품목코드  */
								</if>
								<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
								   AND B.ITEM_NAME 		LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
								</if>
						   
					 			GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, A.ITEM_CODE, A.PRODT_DATE
						 				, A.PRODT_NUM
				) T
				INNER JOIN PMR100T B WITH(NOLOCK) ON B.COMP_CODE = T.COMP_CODE
													AND B.DIV_CODE = T.DIV_CODE
													AND B.PRODT_NUM = T.PRODT_NUM
													
				GROUP BY T.COMP_CODE, T.DIV_CODE, T.WORK_SHOP_CODE, T.ITEM_CODE, B.MOLD_CODE
				
			) AS A1
	   		INNER JOIN (  SELECT
					 		A.COMP_CODE
						 	, A.DIV_CODE
						 	, A.WORK_SHOP_CODE
						 	, A.ITEM_CODE
						 	, SUM(ISNULL(A.PRODT_Q, 0))			AS PRODT_Q
							, SUM(ISNULL(A.GOOD_Q, 0))			AS GOOD_Q
							, SUM(ISNULL(A.BAD_Q, 0))			AS BAD_Q
							, SUM(ISNULL(A.IN_STOCK_Q, 0))		AS IN_STOCK_Q
							, SUM(ISNULL(A.MAN_HOUR, 0))		AS MAN_HOUR
							, A.MOLD_CODE
				            FROM(	
				            	SELECT
									  A.COMP_CODE
									, A.DIV_CODE
									, A.WORK_SHOP_CODE
									, A.ITEM_CODE
									
									, SUM(ISNULL(A.PRODT_Q, 0))					AS PRODT_Q
									, SUM(ISNULL(A.GOOD_PRODT_Q, 0))			AS GOOD_Q
									, SUM(ISNULL(A.BAD_PRODT_Q, 0))				AS BAD_Q
									, SUM(ISNULL(A.IN_STOCK_Q, 0))				AS IN_STOCK_Q
									, B.MOLD_CODE
									, SUM(ISNULL(B.MAN_HOUR, 0)) AS MAN_HOUR 
									FROM PMR200T A WITH(NOLOCK)
									INNER JOIN PMR100T B WITH(NOLOCK) ON B.COMP_CODE = A.COMP_CODE
																		AND B.DIV_CODE = A.DIV_CODE
																		AND B.PRODT_NUM = A.PRODT_NUM
									LEFT OUTER JOIN BPR100T C WITH(NOLOCK) ON C.COMP_CODE = A.COMP_CODE
																		  AND C.ITEM_CODE = A.ITEM_CODE
									WHERE A.COMP_CODE			= #{S_COMP_CODE}
									/*--------조회조건-----------*/
									<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
									   AND A.DIV_CODE			= #{DIV_CODE}							/*사업장*/
									</if>
									<if test="@foren.Ognl@isNotEmpty(PRODT_DATE)">
									   AND LEFT(A.PRODT_DATE, 6)= #{PRODT_DATE}							/*기준년월*/
									</if>
									<if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
									   AND A.WORK_SHOP_CODE		= #{WORK_SHOP_CODE}						/*작업장*/
									</if>
									
									<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
									   AND A.ITEM_CODE 		= #{ITEM_CODE}						/* 품목코드  */
									</if>
									<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
									   AND A.ITEM_CODE 		LIKE #{ITEM_CODE} + '%'				/* 품목코드  */
									</if>
									<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
									   AND C.ITEM_NAME 		LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
									</if>

									GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, B.MOLD_CODE, A.ITEM_CODE
							) A 
							GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE,A.MOLD_CODE, A.ITEM_CODE
						) AS B1 ON B1.COMP_CODE		= A1.COMP_CODE
							   AND B1.DIV_CODE		= A1.DIV_CODE
							   AND B1.WORK_SHOP_CODE= A1.WORK_SHOP_CODE
							   AND B1.ITEM_CODE		= A1.ITEM_CODE
							   AND ISNULL(B1.MOLD_CODE,'')	= ISNULL(A1.MOLD_CODE,'')
			   INNER JOIN BPR100T D1 WITH(NOLOCK) ON D1.COMP_CODE	= A1.COMP_CODE
												 AND D1.ITEM_CODE	= A1.ITEM_CODE
			   INNER JOIN BSA230T C1 WITH(NOLOCK) ON C1.COMP_CODE	= A1.COMP_CODE
												 AND C1.TYPE_LEVEL	= A1.DIV_CODE
												 AND C1.TREE_CODE	= A1.WORK_SHOP_CODE
										
			LEFT JOIN EQU200T R2 WITH(NOLOCK) ON R2.COMP_CODE = A1.COMP_CODE
											AND R2.DIV_CODE = A1.DIV_CODE
											AND R2.EQU_CODE = A1.MOLD_CODE
											AND R2.EQU_CODE_TYPE = '1' 								 
												 
												 
			 GROUP BY A1.WORK_SHOP_CODE, C1.TREE_NAME, D1.SPEC, D1.STOCK_UNIT
					, B1.PRODT_Q, B1.GOOD_Q, B1.BAD_Q, B1.IN_STOCK_Q, B1.MAN_HOUR
					
					, A1.MOLD_CODE
					, A1.ITEM_CODE, D1.ITEM_NAME1, D1.ITEM_NAME2, D1.ITEM_NAME
			 ORDER BY A1.WORK_SHOP_CODE, A1.ITEM_CODE

			SET ARITHABORT OFF
			SET NOCOUNT OFF
		END	 
		
	</select>











	<select id="pmr210skrvServiceImpl.selectList_backup" parameterType="Map" resultType="rMap">
		/* pmr210skrv.Cpmr210skrv[fnPmr210QStd] Query01 */
		/*******************************************************************************************
		 월 생산 실적조회쿼리
		*******************************************************************************************/
		BEGIN
			SET NOCOUNT ON
			SET ARITHABORT ON
				
			DECLARE @CompCode		NVARCHAR(08)	/* 법인코드  */
				  , @UserId			NVARCHAR(100)	/* 사용자ID */
				  , @LangType		NVARCHAR(2)		/* 언어구분 */
				  , @RefItem		NVARCHAR(01)
				  , @DateFormat		NVARCHAR(10)
				
			SET @CompCode = #{S_COMP_CODE}
			SET @UserId   = #{S_USER_ID}
			SET @LangType = N'KR'
				
			/* 명칭 참조 유형 */
			SELECT TOP 1 @RefItem = REF_ITEM
				FROM BSA300T WITH (NOLOCK)
				WHERE COMP_CODE = @CompCode
					AND USER_ID = @UserId
				
			SET @RefItem = ISNULL(@RefItem, N'0')
				
			/* 날짜 포맷 유형 설정 */
			SELECT TOP 1 @DateFormat = CODE_NAME
				FROM BSA100T WITH (NOLOCK)
				WHERE COMP_CODE = @CompCode
				AND MAIN_CODE = N'B044'
				AND REF_CODE1 = N'Y'
				
			SET @DateFormat = ISNULL(@DateFormat, 'YYYY.MM.DD')
		
			/*--------  조회 ------------------------------------------------------------------*/
			SELECT 
				   A1.WORK_SHOP_CODE
				 , C1.TREE_NAME											   AS WORK_SHOP_NAME
				 , A1.ITEM_CODE
				 , CASE WHEN @RefItem = '1' THEN D1.ITEM_NAME1
							WHEN @RefItem = '2' THEN D1.ITEM_NAME2
							ELSE D1.ITEM_NAME
				   END											  AS ITEM_NAME
				 , D1.ITEM_NAME1
				 , D1.SPEC
				 , D1.STOCK_UNIT
				 , ISNULL(B1.PRODT_Q, 0)								   AS PRODT_Q
				 , ISNULL(B1.GOOD_Q, 0)									AS GOOD_Q
				 , ISNULL(B1.BAD_Q, 0)									 AS BAD_Q
				 , ISNULL(B1.IN_STOCK_Q, 0)								AS IN_STOCK_Q
				 , SUM(ISNULL(B1.MAN_HOUR, 0))							 AS MAN_HOUR
				 , SUM(ISNULL(A1.DAY_01, 0)) AS DAY_01
				 , SUM(ISNULL(A1.DAY_02, 0)) AS DAY_02
				 , SUM(ISNULL(A1.DAY_03, 0)) AS DAY_03
				 , SUM(ISNULL(A1.DAY_04, 0)) AS DAY_04
				 , SUM(ISNULL(A1.DAY_05, 0)) AS DAY_05
				 , SUM(ISNULL(A1.DAY_06, 0)) AS DAY_06
				 , SUM(ISNULL(A1.DAY_07, 0)) AS DAY_07
				 , SUM(ISNULL(A1.DAY_08, 0)) AS DAY_08
				 , SUM(ISNULL(A1.DAY_09, 0)) AS DAY_09
				 , SUM(ISNULL(A1.DAY_10, 0)) AS DAY_10
				 , SUM(ISNULL(A1.DAY_11, 0)) AS DAY_11
				 , SUM(ISNULL(A1.DAY_12, 0)) AS DAY_12
				 , SUM(ISNULL(A1.DAY_13, 0)) AS DAY_13
				 , SUM(ISNULL(A1.DAY_14, 0)) AS DAY_14
				 , SUM(ISNULL(A1.DAY_15, 0)) AS DAY_15
				 , SUM(ISNULL(A1.DAY_16, 0)) AS DAY_16
				 , SUM(ISNULL(A1.DAY_17, 0)) AS DAY_17
				 , SUM(ISNULL(A1.DAY_18, 0)) AS DAY_18
				 , SUM(ISNULL(A1.DAY_19, 0)) AS DAY_19
				 , SUM(ISNULL(A1.DAY_20, 0)) AS DAY_20
				 , SUM(ISNULL(A1.DAY_21, 0)) AS DAY_21
				 , SUM(ISNULL(A1.DAY_22, 0)) AS DAY_22
				 , SUM(ISNULL(A1.DAY_23, 0)) AS DAY_23
				 , SUM(ISNULL(A1.DAY_24, 0)) AS DAY_24
				 , SUM(ISNULL(A1.DAY_25, 0)) AS DAY_25
				 , SUM(ISNULL(A1.DAY_26, 0)) AS DAY_26
				 , SUM(ISNULL(A1.DAY_27, 0)) AS DAY_27
				 , SUM(ISNULL(A1.DAY_28, 0)) AS DAY_28
				 , SUM(ISNULL(A1.DAY_29, 0)) AS DAY_29
				 , SUM(ISNULL(A1.DAY_30, 0)) AS DAY_30
				 , SUM(ISNULL(A1.DAY_31, 0)) AS DAY_31
			
			  FROM (
					SELECT
						   A.COMP_CODE
						 , A.DIV_CODE
						 , A.WORK_SHOP_CODE
						 , A.ITEM_CODE
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '01' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_01
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '02' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_02
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '03' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_03
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '04' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_04
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '05' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_05
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '06' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_06
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '07' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_07
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '08' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_08
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '09' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_09
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '10' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_10
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '11' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_11
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '12' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_12
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '13' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_13
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '14' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_14
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '15' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_15
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '16' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_16
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '17' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_17
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '18' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_18
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '19' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_19
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '20' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_20
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '21' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_21
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '22' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_22
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '23' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_23
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '24' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_24
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '25' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_25
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '26' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_26
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '27' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_27
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '28' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_28
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '29' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_29
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '30' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_30
						 , CASE WHEN RIGHT(A.PRODT_DATE, 2) = '31' THEN SUM(ISNULL(A.PRODT_Q, 0)) - SUM(ISNULL(D.BAD_Q, 0))
								ELSE 0
							END AS DAY_31
					  FROM			PMR200T A WITH(NOLOCK)
						   LEFT  JOIN (SELECT
											  COMP_CODE
											, DIV_CODE
											, WKORD_NUM
											, ITEM_CODE
											, SUM(ISNULL(BAD_Q, 0)) AS BAD_Q
										 FROM PMR300T WITH(NOLOCK)
										WHERE COMP_CODE = @CompCode
										  AND DIV_CODE  = #{DIV_CODE}						/*사업장*/
										GROUP BY COMP_CODE, DIV_CODE, WKORD_NUM, ITEM_CODE) AS D ON D.COMP_CODE  = A.COMP_CODE
																								AND D.DIV_CODE   = A.DIV_CODE
																								AND D.WKORD_NUM  = A.WKORD_NUM
						LEFT OUTER JOIN BPR100T C WITH(NOLOCK) ON C.COMP_CODE = A.COMP_CODE
															  AND C.ITEM_CODE = A.ITEM_CODE
					 WHERE A.COMP_CODE		   = @CompCode
			
					/*--------조회조건-----------*/
					<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
					   AND A.DIV_CODE			= #{DIV_CODE}						/*사업장*/
					</if>
					<if test="@foren.Ognl@isNotEmpty(PRODT_DATE)">
					   AND LEFT(A.PRODT_DATE, 6) = #{PRODT_DATE}						/*기준년월*/
					</if>
					<if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
					   AND A.WORK_SHOP_CODE	  = #{WORK_SHOP_CODE}					/*작업장*/
					</if>
					
					<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
					   AND A.ITEM_CODE 		= #{ITEM_CODE}						/* 품목코드  */
					</if>
					<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
					   AND A.ITEM_CODE 		LIKE #{ITEM_CODE} + '%'				/* 품목코드  */
					</if>
					<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
					   AND C.ITEM_NAME 		LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
					</if>
					
					 GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, A.ITEM_CODE, A.PRODT_DATE
					) AS A1
						   INNER JOIN (
										SELECT
											   A.COMP_CODE
											 , A.DIV_CODE
											 , A.WORK_SHOP_CODE
											 , A.ITEM_CODE
											 , (ISNULL(A.PRODT_Q, 0))					  AS PRODT_Q
											 , (ISNULL(A.PRODT_Q, 0) - ISNULL(A.BAD_Q, 0)) AS GOOD_Q
											 , (ISNULL(A.BAD_Q, 0))						AS BAD_Q
											 , (ISNULL(A.IN_STOCK_Q, 0))				   AS IN_STOCK_Q
											 , (ISNULL(A.MAN_HOUR, 0))					 AS MAN_HOUR
										FROM
											(
											SELECT
												   A.COMP_CODE
												, A.DIV_CODE
												, A.WORK_SHOP_CODE
												, A.ITEM_CODE
												, SUM(ISNULL(A.PRODT_Q, 0))					  AS PRODT_Q
												, SUM(ISNULL(A.BAD_PRODT_Q, 0))				  AS BAD_Q
												, SUM(ISNULL(A.IN_STOCK_Q, 0))				   AS IN_STOCK_Q
												, SUM(ISNULL(E.MAN_HOUR, 0))				   AS MAN_HOUR
											FROM PMR200T A WITH(NOLOCK)
											INNER JOIN (SELECT
																  COMP_CODE
																, DIV_CODE
																, WKORD_NUM
																, SUM(ISNULL(MAN_HOUR, 0)) AS MAN_HOUR
															 FROM PMR100T WITH(NOLOCK)
															WHERE COMP_CODE = @CompCode
															  AND DIV_CODE  = #{DIV_CODE}						/*사업장*/
															GROUP BY COMP_CODE, DIV_CODE, WKORD_NUM) AS E ON E.COMP_CODE  = A.COMP_CODE
																										 AND E.DIV_CODE   = A.DIV_CODE
																										 AND E.WKORD_NUM  = A.WKORD_NUM
											LEFT OUTER JOIN BPR100T C WITH(NOLOCK) ON C.COMP_CODE = A.COMP_CODE
																				  AND C.ITEM_CODE = A.ITEM_CODE
											WHERE A.COMP_CODE		   = @CompCode
			
									/*--------조회조건-----------*/
											<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
											   AND A.DIV_CODE			= #{DIV_CODE}						/*사업장*/
											</if>
											<if test="@foren.Ognl@isNotEmpty(PRODT_DATE)">
											   AND LEFT(A.PRODT_DATE, 6) = #{PRODT_DATE}						/*기준년월*/
											</if>
											<if test="@foren.Ognl@isNotEmpty(WORK_SHOP_CODE)">
											   AND A.WORK_SHOP_CODE	  = #{WORK_SHOP_CODE}					/*작업장*/
											</if>
											
											<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
											   AND A.ITEM_CODE 		= #{ITEM_CODE}						/* 품목코드  */
											</if>
											<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
											   AND A.ITEM_CODE 		LIKE #{ITEM_CODE} + '%'				/* 품목코드  */
											</if>
											<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
											   AND C.ITEM_NAME 		LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
											</if>
											
											GROUP BY A.COMP_CODE, A.DIV_CODE, A.WORK_SHOP_CODE, A.ITEM_CODE
											) A
										) AS B1 ON B1.COMP_CODE	  = A1.COMP_CODE
											   AND B1.DIV_CODE	   = A1.DIV_CODE
											   AND B1.WORK_SHOP_CODE = A1.WORK_SHOP_CODE
											   AND B1.ITEM_CODE	  = A1.ITEM_CODE
						   INNER JOIN BPR100T D1 WITH(NOLOCK) ON D1.COMP_CODE  = A1.COMP_CODE
															 AND D1.ITEM_CODE  = A1.ITEM_CODE
						   INNER JOIN BSA230T C1 WITH(NOLOCK) ON C1.COMP_CODE  = A1.COMP_CODE
															 AND C1.TYPE_LEVEL = A1.DIV_CODE
															 AND C1.TREE_CODE  = A1.WORK_SHOP_CODE
			 GROUP BY A1.WORK_SHOP_CODE, A1.ITEM_CODE, C1.TREE_NAME, D1.SPEC,	   D1.STOCK_UNIT
					, B1.PRODT_Q,		B1.GOOD_Q,	B1.BAD_Q,	 B1.IN_STOCK_Q, B1.MAN_HOUR, D1.ITEM_NAME1, D1.ITEM_NAME2, D1.ITEM_NAME
			 ORDER BY A1.WORK_SHOP_CODE, A1.ITEM_CODE
		 
			SET ARITHABORT OFF
			SET NOCOUNT OFF
		END	 
	</select>
</mapper>