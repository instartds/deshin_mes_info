<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="hpa850skrServiceImpl">
	<select id="hpa850skrServiceImpl.selectList" parameterType="Map" resultType="rMap">
		<if test="rdoSelect == &quot;S&quot;">		
			<if test="@foren.Ognl@isNotEmpty(ALLOW_CD)">
			--hpa850skr.CHpa850SKr SetHpa850[fnHpa850nQ] S  
			--조회조건:지급
			DECLARE @YYYYMM NVARCHAR(10)
	
			SET @YYYYMM = #{CURR_DATE} 
			SET @YYYYMM = REPLACE(@YYYYMM, '.', '') + '01'
	
				SELECT DEPT_NAME    
					 , DEPT_CODE    
					 , POST_NAME    
					 , NAME         
					 , PERSON_NUMB  
					 , CODE_NAME    
					 , DED_CODE     
					 , BASE_MONTH AS MONTH_0   
					 , MONTH_1      
					 , MONTH_2      
					 , MONTH_3      
					 , MONTH_4      
					 , MONTH_5      
					 , MONTH_6      
					 , MONTH_7      
					 , MONTH_8      
					 , MONTH_9      
					 , MONTH_10     
					 , MONTH_11     
					FROM (SELECT HPA60.PERSON_NUMB                                  
							   , HUM.NAME                                           
							   , HPA60_MAX.SECT_CODE
							   , HPA60_MAX.DEPT_CODE AS DEPT_CODE
							   , HPA60_MAX.DEPT_NAME AS DEPT_NAME
							   , HBS30.WAGES_NAME AS CODE_NAME                      
							   , HPA60_MAX.POST_CODE                                      
							   , (SELECT CODE_NAME                                  
									FROM BSA100T                                    
								   WHERE COMP_CODE = HUM.COMP_CODE                  
									 AND MAIN_CODE = 'H005'                         
									 AND SUB_CODE  = HPA60_MAX.POST_CODE) AS POST_NAME
							   , HPA30.WAGES_CODE AS DED_CODE                       
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN LEFT(@YYYYMM,6)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS BASE_MONTH                            
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-1,@YYYYMM), 112)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_1                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-2,@YYYYMM), 112) 
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_2                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-3,@YYYYMM), 112) 
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_3                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-4,@YYYYMM), 112)   
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_4                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-5,@YYYYMM), 112)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_5                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-6,@YYYYMM), 112)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_6                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-7,@YYYYMM), 112)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_7                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-8,@YYYYMM), 112)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_8                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-9,@YYYYMM), 112)  
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_9                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-10,@YYYYMM), 112)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_10                              
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_11                              
							FROM HPA600T HPA60 WITH (NOLOCK)
											 INNER JOIN HPA300T HPA30 WITH (NOLOCK)
													 ON HPA30.COMP_CODE   = HPA60.COMP_CODE    
													AND HPA30.PERSON_NUMB = HPA60.PERSON_NUMB  
													AND HPA30.PAY_YYYYMM  = HPA60.PAY_YYYYMM   
													AND HPA30.SUPP_TYPE   = HPA60.SUPP_TYPE    
											 INNER JOIN HUM100T HUM WITH (NOLOCK)
													 ON HPA30.COMP_CODE   = HUM.COMP_CODE      
													AND HPA30.PERSON_NUMB = HUM.PERSON_NUMB    
											 INNER JOIN HBS300T HBS30 WITH (NOLOCK)
													 ON HPA30.COMP_CODE   = HBS30.COMP_CODE    
													AND HPA30.WAGES_CODE  = HBS30.WAGES_CODE   
											 LEFT  JOIN HPA600T HPA60_MAX WITH (NOLOCK)
													 ON HPA60_MAX.COMP_CODE   = HPA60.COMP_CODE
													AND HPA60_MAX.PERSON_NUMB = HPA60.PERSON_NUMB
													AND HPA60_MAX.PAY_YYYYMM  = LEFT(@YYYYMM,6)
													AND HPA60_MAX.SUPP_TYPE  = '1'
						   WHERE HPA60.COMP_CODE   = #{S_COMP_CODE}                      
							 AND uniLITE.fnCheckCompDivAuth(HPA60.COMP_CODE, HPA60.DIV_CODE, #{S_USER_ID}) = 'Y'
							 AND HBS30.CODE_TYPE   = '1'                                       
							 AND HPA30.PAY_YYYYMM &gt;= convert(NVARCHAR(6), DATEADD(m,-11,@yyyymm), 112)
							 AND HPA30.PAY_YYYYMM &lt;= LEFT(@YYYYMM,6)                
							 AND HPA30.SUPP_TYPE = '1' 
							<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
								AND HPA60_MAX.DIV_CODE = #{DIV_CODE} 
							</if>
							<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_FROM)">				  	
								AND HPA60_MAX.DEPT_CODE &gt;=  #{DEPT_CODE_FROM}
							</if>
							<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_TO)">
								AND HPA60_MAX.DEPT_CODE &lt;=  #{DEPT_CODE_TO}
							</if>
	
							<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">         
								AND HPA60.PERSON_NUMB = #{PERSON_NUMB} 
							</if>
							<if test="@foren.Ognl@isNotEmpty(NAME)">         
								AND HUM.NAME = #{NAME} 
							</if>
	   							AND HPA30.WAGES_CODE = #{ALLOW_CD}
	
							<if test="@foren.Ognl@isNotEmpty(PAY_PROV_FLAG)">         
								AND HPA60_MAX.PAY_PROV_FLAG = #{PAY_PROV_FLAG} 
							</if>
							<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">         
								AND HPA60_MAX.PAY_GUBUN = #{PAY_GUBUN} 
							</if>
							<if test="@foren.Ognl@isNotEmpty(rdoSelect2)">         
								AND HPA60_MAX.PAY_GUBUN2 = #{rdoSelect2} 
							</if>
	        
						   GROUP BY HUM.COMP_CODE, HPA60_MAX.DEPT_CODE, HPA60_MAX.DEPT_NAME, HPA60_MAX.POST_CODE, HUM.NAME, HPA60.PERSON_NUMB
								  , HPA60_MAX.SECT_CODE, HPA30.WAGES_CODE, HBS30.WAGES_NAME) A 
						   ORDER BY DEPT_CODE, POST_CODE, NAME, PERSON_NUMB, DED_CODE ASC 
			</if>
	
			<if test="@foren.Ognl@isEmpty(ALLOW_CD)">
			DECLARE @YYYYMM NVARCHAR(10)
	
			SET @YYYYMM = #{CURR_DATE} 
			SET @YYYYMM = REPLACE(@YYYYMM, '.', '') + '01'
	
			--hpa850skr.CHpa850SKr SetHpa850[fnHpa850nQ] S  
				SELECT DEPT_NAME    
					 , DEPT_CODE    
					 , POST_NAME    
					 , NAME         
					 , PERSON_NUMB  
					 , '합계' AS CODE_NAME     
					 , '100'  AS DED_CODE      
					 , BASE_MONTH AS MONTH_0
					 , MONTH_1      
					 , MONTH_2      
					 , MONTH_3      
					 , MONTH_4      
					 , MONTH_5      
					 , MONTH_6      
					 , MONTH_7      
					 , MONTH_8      
					 , MONTH_9      
					 , MONTH_10     
					 , MONTH_11     
					FROM (SELECT HPA60.PERSON_NUMB                                  
							   , HUM.NAME                                           
							   , HPA60_MAX.SECT_CODE
							   , HPA60_MAX.DEPT_CODE AS DEPT_CODE
							   , HPA60_MAX.DEPT_NAME AS DEPT_NAME
							   , HPA60_MAX.POST_CODE                                      
							   , (SELECT CODE_NAME                                  
									FROM BSA100T                                    
								   WHERE COMP_CODE = HUM.COMP_CODE                  
									 AND MAIN_CODE = 'H005'                         
									 AND SUB_CODE  = HPA60_MAX.POST_CODE) AS POST_NAME    
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN LEFT(@YYYYMM,6)
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS BASE_MONTH                            
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-1,@YYYYMM), 112)  
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_1                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-2,@YYYYMM), 112)   
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_2                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-3,@YYYYMM), 112)  
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_3                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-4,@YYYYMM), 112)   
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_4                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-5,@YYYYMM), 112)   
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_5                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-6,@YYYYMM), 112)  
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_6                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-7,@YYYYMM), 112) 
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_7                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-8,@YYYYMM), 112) 
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_8                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-9,@YYYYMM), 112) 
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_9                               
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-10,@YYYYMM), 112) 
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_10                              
							   , SUM(CASE HPA30.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112) 
																THEN AMOUNT_I       
																ELSE 0              
									  END) AS MONTH_11                              
							FROM HPA600T HPA60 WITH (NOLOCK)
											 INNER JOIN HPA300T HPA30 WITH (NOLOCK)
													 ON HPA30.COMP_CODE   = HPA60.COMP_CODE    
													AND HPA30.PERSON_NUMB = HPA60.PERSON_NUMB  
													AND HPA30.PAY_YYYYMM  = HPA60.PAY_YYYYMM   
													AND HPA30.SUPP_TYPE   = HPA60.SUPP_TYPE    
											 INNER JOIN HUM100T HUM WITH (NOLOCK)
													 ON HPA30.COMP_CODE   = HUM.COMP_CODE      
													AND HPA30.PERSON_NUMB = HUM.PERSON_NUMB    
											 INNER JOIN HBS300T HBS30 WITH (NOLOCK)
													 ON HPA30.COMP_CODE   = HBS30.COMP_CODE    
													AND HPA30.WAGES_CODE  = HBS30.WAGES_CODE   
											 LEFT  JOIN HPA600T HPA60_MAX WITH (NOLOCK)
													 ON HPA60_MAX.COMP_CODE   = HPA60.COMP_CODE
													AND HPA60_MAX.PERSON_NUMB = HPA60.PERSON_NUMB
													AND HPA60_MAX.PAY_YYYYMM  = LEFT(@YYYYMM,6)
													AND HPA60_MAX.SUPP_TYPE  = '1'
						   WHERE HPA60.COMP_CODE   = #{S_COMP_CODE}                    
							 AND uniLITE.fnCheckCompDivAuth(HPA60.COMP_CODE, HPA60.DIV_CODE, #{S_USER_ID}) = 'Y'
							 AND HBS30.CODE_TYPE   = '1'                                       
							 AND HPA30.PAY_YYYYMM &gt;= CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)                      
							 AND HPA30.PAY_YYYYMM &lt;= LEFT(@YYYYMM,6)                     
							 AND HPA30.SUPP_TYPE = '1' 
	          
							<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
								AND HPA60_MAX.DIV_CODE = #{DIV_CODE} 
							</if>
	         
							<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_FROM)">				  	
								AND HPA60_MAX.DEPT_CODE &gt;=  #{DEPT_CODE_FROM}
							</if>
							<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_TO)">
								AND HPA60_MAX.DEPT_CODE &lt;=  #{DEPT_CODE_TO}
							</if>
	        
							<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">         
								AND HPA60.PERSON_NUMB = #{PERSON_NUMB} 
							</if>
							<if test="@foren.Ognl@isNotEmpty(NAME)">         
								AND HUM.NAME = #{NAME} 
							</if>
	        
							<if test="@foren.Ognl@isNotEmpty(PAY_PROV_FLAG)">         
								AND HPA60_MAX.PAY_PROV_FLAG = #{PAY_PROV_FLAG} 
							</if>
							<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">         
								AND HPA60_MAX.PAY_GUBUN = #{PAY_GUBUN} 
							</if>
							<if test="@foren.Ognl@isNotEmpty(rdoSelect2)">         
								AND HPA60_MAX.PAY_GUBUN2 = #{rdoSelect2} 
							</if>
	        
						   GROUP BY HUM.COMP_CODE, HPA60_MAX.DEPT_CODE, HPA60_MAX.DEPT_NAME, HPA60_MAX.POST_CODE, HUM.NAME, HPA60.PERSON_NUMB
								  , HPA60_MAX.SECT_CODE) A 
						   ORDER BY DEPT_CODE, POST_CODE, NAME, PERSON_NUMB ASC 
			</if>
		</if>  
		  
		<if test="rdoSelect == &quot;G&quot;">		
			<if test="@foren.Ognl@isNotEmpty(ALLOW_CD)">
			DECLARE @YYYYMM NVARCHAR(10)
	
			SET @YYYYMM = #{CURR_DATE} 
			SET @YYYYMM = REPLACE(@YYYYMM, '.', '') + '01'
	
			--hpa850skr.CHpa850SKr SetHpa850[fnHpa850nQ] G 
				SELECT DEPT_NAME       
					 , DEPT_CODE       
					 , POST_NAME       
					 , NAME            
					 , PERSON_NUMB     
					 , CODE_NAME       
					 , DED_CODE        
					 , BASE_MONTH AS MONTH_0   
					 , MONTH_1         
					 , MONTH_2         
					 , MONTH_3         
					 , MONTH_4         
					 , MONTH_5         
					 , MONTH_6         
					 , MONTH_7         
					 , MONTH_8         
					 , MONTH_9         
					 , MONTH_10        
					 , MONTH_11        
				  FROM (SELECT HPA60.PERSON_NUMB                                    
							 , HUM.NAME                                             
							 , HPA60_MAX.SECT_CODE
							 , HPA60_MAX.DEPT_CODE AS DEPT_CODE
							 , HPA60_MAX.DEPT_NAME AS DEPT_NAME
							 , (SELECT CODE_NAME                                    
								  FROM BSA100T                                      
								 WHERE COMP_CODE = HAT20.COMP_CODE                  
								   AND MAIN_CODE = 'H033'                           
								   AND SUB_CODE  = HAT20.DUTY_CODE) AS CODE_NAME    
							 , HPA60_MAX.POST_CODE                                        
							 , (SELECT CODE_NAME                                    
								  FROM BSA100T                                      
								 WHERE COMP_CODE = HAT20.COMP_CODE                  
								   AND MAIN_CODE = 'H005'                           
								   AND SUB_CODE  = HPA60_MAX.POST_CODE) AS POST_NAME      
							 , HAT20.DUTY_CODE AS DED_CODE                          
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN LEFT(@YYYYMM,6) 
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									 END) AS BASE_MONTH                                                        
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-1,@YYYYMM), 112)                       
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_1                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-2,@YYYYMM), 112)                       
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_2                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-3,@YYYYMM), 112)                           
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_3                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-4,@YYYYMM), 112)                              
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_4                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-5,@YYYYMM), 112)                         
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_5                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-6,@YYYYMM), 112)                      
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_6                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-7,@YYYYMM), 112)                         
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_7                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-8,@YYYYMM), 112)                         
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_8                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-9,@YYYYMM), 112)                      
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_9                                                            
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-10,@YYYYMM), 112)                            
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_10                                                           
							 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)                         
															   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
																							   THEN DUTY_TIME  
																							   ELSE DUTY_NUM   
																	  END)                                     
															   ELSE 0                                          
									END) AS MONTH_11                                                           
						  FROM HPA600T HPA60 WITH (NOLOCK)
										   INNER JOIN HAT200T HAT20 WITH (NOLOCK)
												   ON HAT20.COMP_CODE   = HPA60.COMP_CODE     
												  AND HAT20.PERSON_NUMB = HPA60.PERSON_NUMB   
												  AND HAT20.DUTY_YYYYMM = HPA60.PAY_YYYYMM    
										   INNER JOIN HUM100T HUM WITH (NOLOCK)
												   ON HAT20.COMP_CODE   = HUM.COMP_CODE       
												  AND HAT20.PERSON_NUMB = HUM.PERSON_NUMB     
										   INNER JOIN HBS100T HBS10 WITH (NOLOCK)
												   ON HBS10.COMP_CODE   = HAT20.COMP_CODE     
												  AND HBS10.DUTY_CODE   = HAT20.DUTY_CODE     
												  AND HBS10.PAY_CODE    = HUM.PAY_CODE        
										   LEFT  JOIN HPA600T HPA60_MAX WITH (NOLOCK)
												   ON HPA60_MAX.COMP_CODE   = HPA60.COMP_CODE
												  AND HPA60_MAX.PERSON_NUMB = HPA60.PERSON_NUMB
												  AND HPA60_MAX.PAY_YYYYMM  = LEFT(@YYYYMM,6) 
												  AND HPA60_MAX.SUPP_TYPE  = '1'
						 WHERE HPA60.COMP_CODE    = #{S_COMP_CODE}           
						   AND uniLITE.fnCheckCompDivAuth(HPA60.COMP_CODE, HPA60.DIV_CODE, #{S_USER_ID}) = 'Y'
						   AND HAT20.DUTY_YYYYMM &gt;= CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)                        
						   AND HAT20.DUTY_YYYYMM &lt;= LEFT(@YYYYMM,6)                        
						   AND HPA60.SUPP_TYPE = '1' 
						<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
							AND HPA60_MAX.DIV_CODE = #{DIV_CODE} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_FROM)">				  	
							AND HPA60_MAX.DEPT_CODE &gt;=  #{DEPT_CODE_FROM}
						</if>
						<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_TO)">
							AND HPA60_MAX.DEPT_CODE &lt;=  #{DEPT_CODE_TO}
						</if>
	
						<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">         
							AND HPA60.PERSON_NUMB = #{PERSON_NUMB} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(NAME)">         
							AND HUM.NAME = #{NAME} 
						</if>
	   					  AND HAT20.DUTY_CODE = #{ALLOW_CD}
	        
						<if test="@foren.Ognl@isNotEmpty(PAY_PROV_FLAG)">         
							AND HPA60_MAX.PAY_PROV_FLAG = #{PAY_PROV_FLAG} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">         
							AND HPA60_MAX.PAY_GUBUN = #{PAY_GUBUN} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(rdoSelect2)">         
							AND HPA60_MAX.PAY_GUBUN2 = #{rdoSelect2} 
						</if>
	            
						 GROUP BY HAT20.COMP_CODE, HPA60_MAX.DEPT_CODE, HPA60_MAX.DEPT_NAME, HPA60_MAX.POST_CODE, HUM.NAME, HPA60.PERSON_NUMB, HPA60_MAX.SECT_CODE, HAT20.DUTY_CODE) A
						 ORDER BY DEPT_CODE, POST_CODE, NAME, PERSON_NUMB, DED_CODE ASC 
			</if>
	
			<if test="@foren.Ognl@isEmpty(ALLOW_CD)">
			DECLARE @YYYYMM NVARCHAR(10)
	
			SET @YYYYMM = #{CURR_DATE} 
			SET @YYYYMM = REPLACE(@YYYYMM, '.', '') + '01'
	
			 --hpa850skr.CHpa850SKr SetHpa850[fnHpa850nQ] G 
	 			SELECT DEPT_NAME       
	 				 , DEPT_CODE       
	 				 , POST_NAME       
	 				 , NAME            
	 				 , PERSON_NUMB     
	 				 , '합계' AS CODE_NAME     
	 				 , '100'  AS DED_CODE      
	 				 , BASE_MONTH AS MONTH_0   
	 				 , MONTH_1         
	 				 , MONTH_2         
	 				 , MONTH_3         
	 				 , MONTH_4         
	 				 , MONTH_5         
	 				 , MONTH_6         
	 				 , MONTH_7         
	 				 , MONTH_8         
	 				 , MONTH_9         
	 				 , MONTH_10        
	 				 , MONTH_11        
	 			  FROM (SELECT HPA60.PERSON_NUMB                                    
	 						 , HUM.NAME                                             
	 						 , HPA60_MAX.SECT_CODE
	 						 , HPA60_MAX.DEPT_CODE AS DEPT_CODE
	 						 , HPA60_MAX.DEPT_NAME AS DEPT_NAME
	 						 , HPA60_MAX.POST_CODE                                        
	 						 , (SELECT CODE_NAME                                    
	 							  FROM BSA100T                                      
	 							 WHERE COMP_CODE = HAT20.COMP_CODE                  
	 							   AND MAIN_CODE = 'H005'                           
	 							   AND SUB_CODE  = HPA60_MAX.POST_CODE) AS POST_NAME      
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN LEFT(@YYYYMM,6)   
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								 END) AS BASE_MONTH                                                        
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-1,@YYYYMM), 112) 
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_1                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-2,@YYYYMM), 112) 
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_2                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-3,@YYYYMM), 112) 
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_3                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-4,@YYYYMM), 112) 
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_4                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-5,@YYYYMM), 112) 
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_5                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-6,@YYYYMM), 112) 
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_6                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-7,@YYYYMM), 112) 
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_7                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-8,@YYYYMM), 112)    
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_8                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-9,@YYYYMM), 112) 
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_9                                                            
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-10,@YYYYMM), 112)       
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_10                                                           
	 						 , MAX(CASE HAT20.DUTY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)                              
	 														   THEN (CASE HBS10.COTR_TYPE WHEN '1'             
	 																						   THEN DUTY_TIME  
	 																						   ELSE DUTY_NUM   
	 																  END)                                     
	 														   ELSE 0                                          
	 								END) AS MONTH_11                                                           
	 					  FROM HPA600T HPA60 WITH (NOLOCK)
	 									   INNER JOIN HAT200T HAT20 WITH (NOLOCK)
	 											   ON HAT20.COMP_CODE   = HPA60.COMP_CODE     
	 											  AND HAT20.PERSON_NUMB = HPA60.PERSON_NUMB   
	 											  AND HAT20.DUTY_YYYYMM = HPA60.PAY_YYYYMM    
	 									   INNER JOIN HUM100T HUM WITH (NOLOCK)
	 											   ON HAT20.COMP_CODE   = HUM.COMP_CODE       
	 											  AND HAT20.PERSON_NUMB = HUM.PERSON_NUMB     
	 									   INNER JOIN HBS100T HBS10 WITH (NOLOCK)
	 											   ON HBS10.COMP_CODE   = HAT20.COMP_CODE     
	 											  AND HBS10.DUTY_CODE   = HAT20.DUTY_CODE     
	 											  AND HBS10.PAY_CODE    = HUM.PAY_CODE        
	 									   LEFT  JOIN HPA600T HPA60_MAX WITH (NOLOCK)
	 											   ON HPA60_MAX.COMP_CODE   = HPA60.COMP_CODE
	 											  AND HPA60_MAX.PERSON_NUMB = HPA60.PERSON_NUMB
	 											  AND HPA60_MAX.PAY_YYYYMM  = LEFT(@YYYYMM,6) 
	 											  AND HPA60_MAX.SUPP_TYPE  = '1'
	 					 WHERE HPA60.COMP_CODE    = #{S_COMP_CODE}           
	 					   AND uniLITE.fnCheckCompDivAuth(HPA60.COMP_CODE, HPA60.DIV_CODE, #{S_USER_ID}) = 'Y'
	 					   AND HAT20.DUTY_YYYYMM &gt;= CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)                        
	 					   AND HAT20.DUTY_YYYYMM &lt;= LEFT(@YYYYMM,6)                        
	 					   AND HPA60.SUPP_TYPE = '1' 
	            
						<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
							AND HPA60_MAX.DIV_CODE = #{DIV_CODE} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_FROM)">				  	
							AND HPA60_MAX.DEPT_CODE &gt;=  #{DEPT_CODE_FROM}
						</if>
						<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_TO)">
							AND HPA60_MAX.DEPT_CODE &lt;=  #{DEPT_CODE_TO}
						</if>
	
						<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">         
							AND HPA60.PERSON_NUMB = #{PERSON_NUMB} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(NAME)">         
							AND HUM.NAME = #{NAME} 
						</if>
	                          
						<if test="@foren.Ognl@isNotEmpty(PAY_PROV_FLAG)">         
							AND HPA60_MAX.PAY_PROV_FLAG = #{PAY_PROV_FLAG} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">         
							AND HPA60_MAX.PAY_GUBUN = #{PAY_GUBUN} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(rdoSelect2)">         
							AND HPA60_MAX.PAY_GUBUN2 = #{rdoSelect2} 
						</if>
	            
	 					 GROUP BY HAT20.COMP_CODE, HPA60_MAX.DEPT_CODE, HPA60_MAX.DEPT_NAME, HPA60_MAX.POST_CODE, HUM.NAME, HPA60.PERSON_NUMB, HPA60_MAX.SECT_CODE) A
	 					 ORDER BY DEPT_CODE, POST_CODE, NAME, PERSON_NUMB ASC 
			</if> 					 
		</if>
		
		<if test="rdoSelect == &quot;X&quot;">		
			<if test="@foren.Ognl@isNotEmpty(ALLOW_CD)">
			DECLARE @YYYYMM NVARCHAR(10)
	
			SET @YYYYMM = #{CURR_DATE} 
			SET @YYYYMM = REPLACE(@YYYYMM, '.', '') + '01'
	
			--hpa850skr.CHpa850SKr SetHpa850[fnHpa850nQ] X 
				SELECT DEPT_NAME    
					 , DEPT_CODE    
					 , POST_NAME    
					 , NAME         
					 , PERSON_NUMB  
					 , CODE_NAME    
					 , DED_CODE     
					 , BASE_MONTH AS MONTH_0
					 , MONTH_1      
					 , MONTH_2      
					 , MONTH_3      
					 , MONTH_4      
					 , MONTH_5      
					 , MONTH_6      
					 , MONTH_7      
					 , MONTH_8      
					 , MONTH_9      
					 , MONTH_10     
					 , MONTH_11     
				  FROM (SELECT HPA60.PERSON_NUMB                                    
							 , HUM.NAME                                             
							 , HPA60_MAX.SECT_CODE
							 , HPA60_MAX.DEPT_CODE AS DEPT_CODE
							 , HPA60_MAX.DEPT_NAME AS DEPT_NAME
							 , (SELECT CODE_NAME                                    
								  FROM BSA100T                                      
								 WHERE COMP_CODE = HPA40.COMP_CODE                  
								   AND MAIN_CODE = 'H034'                           
								   AND SUB_CODE  = HPA40.DED_CODE) AS CODE_NAME     
							 , HPA60_MAX.POST_CODE                                        
							 , (SELECT CODE_NAME                                    
								  FROM BSA100T                                      
								 WHERE COMP_CODE = HPA40.COMP_CODE                  
								   AND MAIN_CODE = 'H005'                           
								   AND SUB_CODE  = HPA60_MAX.POST_CODE) AS POST_NAME      
							 , HPA40.DED_CODE AS DED_CODE                           
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN LEFT(@YYYYMM,6)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS BASE_MONTH                              
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-1,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_1                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-2,@YYYYMM), 112)  
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_2                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-3,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_3                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-4,@YYYYMM), 112) 
															   THEN DED_AMOUNT_I    
															   ELSE 0               
								   END) AS MONTH_4                                  
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-5,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
								   END) AS MONTH_5                                  
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-6,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_6                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-7,@YYYYMM), 112) 
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_7                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-8,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_8                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-9,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_9                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-10,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_10                                
							 , SUM(CASE HPA40.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)
															  THEN DED_AMOUNT_I     
															  ELSE 0                
									END) AS MONTH_11                                
						  FROM HPA600T HPA60 WITH (NOLOCK)
										   INNER JOIN HPA400T HPA40 WITH (NOLOCK)
												   ON HPA40.COMP_CODE   = HPA60.COMP_CODE    
												  AND HPA40.PERSON_NUMB = HPA60.PERSON_NUMB  
												  AND HPA40.PAY_YYYYMM  = HPA60.PAY_YYYYMM   
												  AND HPA40.SUPP_TYPE   = HPA60.SUPP_TYPE    
										   INNER JOIN HUM100T HUM WITH (NOLOCK)
												   ON HPA40.COMP_CODE   = HUM.COMP_CODE      
												  AND HPA40.PERSON_NUMB = HUM.PERSON_NUMB    
										   LEFT  JOIN HPA600T HPA60_MAX WITH (NOLOCK)
												   ON HPA60_MAX.COMP_CODE   = HPA60.COMP_CODE
												  AND HPA60_MAX.PERSON_NUMB = HPA60.PERSON_NUMB
												  AND HPA60_MAX.PAY_YYYYMM  = LEFT(@YYYYMM,6)
												  AND HPA60_MAX.SUPP_TYPE  = '1'
						 WHERE HPA60.COMP_CODE   = #{S_COMP_CODE}
						   AND uniLITE.fnCheckCompDivAuth(HPA60.COMP_CODE, HPA60.DIV_CODE, #{S_USER_ID}) = 'Y'
						   AND HPA40.SUPP_TYPE   = '1'                                       
						   AND HPA40.PAY_YYYYMM &gt;= CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)                    
						   AND HPA40.PAY_YYYYMM &lt;= LEFT(@YYYYMM,6)                     
	        
						<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
							AND HPA60_MAX.DIV_CODE = #{DIV_CODE} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_FROM)">				  	
							AND HPA60_MAX.DEPT_CODE &gt;=  #{DEPT_CODE_FROM}
						</if>
						<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_TO)">
							AND HPA60_MAX.DEPT_CODE &lt;=  #{DEPT_CODE_TO}
						</if>
	
						<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">         
							AND HPA60.PERSON_NUMB = #{PERSON_NUMB} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(NAME)">         
							AND HUM.NAME = #{NAME} 
						</if>
	   					   AND HPA40.DED_CODE = #{ALLOW_CD}
	            
						<if test="@foren.Ognl@isNotEmpty(PAY_PROV_FLAG)">         
							AND HPA60_MAX.PAY_PROV_FLAG = #{PAY_PROV_FLAG} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">         
							AND HPA60_MAX.PAY_GUBUN = #{PAY_GUBUN} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(rdoSelect2)">         
							AND HPA60_MAX.PAY_GUBUN2 = #{rdoSelect2} 
						</if>
						 GROUP BY HPA40.COMP_CODE, HPA60_MAX.DEPT_CODE, HPA60_MAX.DEPT_NAME, HPA60_MAX.POST_CODE, HUM.NAME, HPA60.PERSON_NUMB, HPA60_MAX.SECT_CODE, HPA40.DED_CODE) A 
						 ORDER BY DEPT_CODE, POST_CODE, NAME, PERSON_NUMB, DED_CODE ASC 
			</if>
	
			<if test="@foren.Ognl@isEmpty(ALLOW_CD)">
			DECLARE @YYYYMM NVARCHAR(10)
	
			SET @YYYYMM = #{CURR_DATE} 
			SET @YYYYMM = REPLACE(@YYYYMM, '.', '') + '01'
	
			--hpa850skr.CHpa850SKr SetHpa850[fnHpa850nQ] X 
				SELECT DEPT_NAME    
					 , DEPT_CODE    
					 , POST_NAME    
					 , NAME         
					 , PERSON_NUMB  
					 , '합계' AS CODE_NAME     
					 , '100'  AS DED_CODE      
					 , BASE_MONTH AS MONTH_0
					 , MONTH_1      
					 , MONTH_2      
					 , MONTH_3      
					 , MONTH_4      
					 , MONTH_5      
					 , MONTH_6      
					 , MONTH_7      
					 , MONTH_8      
					 , MONTH_9      
					 , MONTH_10     
					 , MONTH_11     
				  FROM (SELECT HPA60.PERSON_NUMB                                    
							 , HUM.NAME                                             
							 , HPA60_MAX.SECT_CODE
							 , HPA60_MAX.DEPT_CODE AS DEPT_CODE
							 , HPA60_MAX.DEPT_NAME AS DEPT_NAME
							 , HPA60_MAX.POST_CODE                                        
							 , (SELECT CODE_NAME                                    
								  FROM BSA100T                                      
								 WHERE COMP_CODE = HPA40.COMP_CODE                  
								   AND MAIN_CODE = 'H005'                           
								   AND SUB_CODE  = HPA60_MAX.POST_CODE) AS POST_NAME      
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN LEFT(@YYYYMM,6)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS BASE_MONTH                              
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-1,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_1                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-2,@YYYYMM), 112)  
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_2                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-3,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_3                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-4,@YYYYMM), 112) 
															   THEN DED_AMOUNT_I    
															   ELSE 0               
								   END) AS MONTH_4                                  
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-5,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
								   END) AS MONTH_5                                  
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-6,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_6                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-7,@YYYYMM), 112) 
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_7                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-8,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_8                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-9,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_9                                 
							 , SUM(CASE HPA40.PAY_YYYYMM  WHEN CONVERT(NVARCHAR(6), DATEADD(m,-10,@YYYYMM), 112)
															   THEN DED_AMOUNT_I    
															   ELSE 0               
									END) AS MONTH_10                                
							 , SUM(CASE HPA40.PAY_YYYYMM WHEN CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)
															  THEN DED_AMOUNT_I     
															  ELSE 0                
									END) AS MONTH_11                                
						  FROM HPA600T HPA60 WITH (NOLOCK)
										   INNER JOIN HPA400T HPA40 WITH (NOLOCK)
												   ON HPA40.COMP_CODE   = HPA60.COMP_CODE    
												  AND HPA40.PERSON_NUMB = HPA60.PERSON_NUMB  
												  AND HPA40.PAY_YYYYMM  = HPA60.PAY_YYYYMM   
												  AND HPA40.SUPP_TYPE   = HPA60.SUPP_TYPE    
										   INNER JOIN HUM100T HUM WITH (NOLOCK)
												   ON HPA40.COMP_CODE   = HUM.COMP_CODE      
												  AND HPA40.PERSON_NUMB = HUM.PERSON_NUMB    
										   LEFT  JOIN HPA600T HPA60_MAX WITH (NOLOCK)
												   ON HPA60_MAX.COMP_CODE   = HPA60.COMP_CODE
												  AND HPA60_MAX.PERSON_NUMB = HPA60.PERSON_NUMB
												  AND HPA60_MAX.PAY_YYYYMM  = LEFT(@YYYYMM,6)
												  AND HPA60_MAX.SUPP_TYPE  = '1'
						 WHERE HPA60.COMP_CODE   = #{S_COMP_CODE}
						   AND uniLITE.fnCheckCompDivAuth(HPA60.COMP_CODE, HPA60.DIV_CODE, #{S_USER_ID}) = 'Y'
						   AND HPA40.SUPP_TYPE   = '1'                                       
						   AND HPA40.PAY_YYYYMM &gt;= CONVERT(NVARCHAR(6), DATEADD(m,-11,@YYYYMM), 112)                    
						   AND HPA40.PAY_YYYYMM &lt;= LEFT(@YYYYMM,6)                     
	        
						<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
							AND HPA60_MAX.DIV_CODE = #{DIV_CODE} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_FROM)">				  	
							AND HPA60_MAX.DEPT_CODE &gt;=  #{DEPT_CODE_FROM}
						</if>
						<if test="@foren.Ognl@isNotEmpty(DEPT_CODE_TO)">
							AND HPA60_MAX.DEPT_CODE &lt;=  #{DEPT_CODE_TO}
						</if>
	
						<if test="@foren.Ognl@isNotEmpty(PERSON_NUMB)">         
							AND HPA60.PERSON_NUMB = #{PERSON_NUMB} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(NAME)">         
							AND HUM.NAME = #{NAME} 
						</if>
	            
						<if test="@foren.Ognl@isNotEmpty(PAY_PROV_FLAG)">         
							AND HPA60_MAX.PAY_PROV_FLAG = #{PAY_PROV_FLAG} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(PAY_GUBUN)">         
							AND HPA60_MAX.PAY_GUBUN = #{PAY_GUBUN} 
						</if>
						<if test="@foren.Ognl@isNotEmpty(rdoSelect2)">         
							AND HPA60_MAX.PAY_GUBUN2 = #{rdoSelect2} 
						</if>
	            
						 GROUP BY HPA40.COMP_CODE, HPA60_MAX.DEPT_CODE, HPA60_MAX.DEPT_NAME, HPA60_MAX.POST_CODE, HUM.NAME, HPA60.PERSON_NUMB, HPA60_MAX.SECT_CODE) A 
						 ORDER BY DEPT_CODE, POST_CODE, NAME, PERSON_NUMB ASC 
			</if>
		</if>
	</select>
</mapper>