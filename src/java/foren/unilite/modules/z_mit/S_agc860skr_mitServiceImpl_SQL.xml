<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="s_agc860skr_mitServiceImpl">

	<select id="s_agc860skr_mitServiceImpl.selectList1" parameterType="Map" resultType="rMap">
		BEGIN
		    SET NOCOUNT ON
		    SET ARITHABORT ON 

		    DECLARE @CompCode       NVARCHAR(08)   /* 법인코드            */
		          , @DivCode        NVARCHAR(08)   /* 사업장코드          */
		          , @DateMonth      NVARCHAR(06)   /* 조회월            */
		          , @SaleDateFr     NVARCHAR(08)    /* 조회시작일          */
		          , @SaleDateTo     NVARCHAR(08)    /* 조회종료일          */
		
		    SET @CompCode    = #{S_COMP_CODE}
		    SET @DivCode     = #{DIV_CODE}
		    SET @DateMonth   = #{DATE_MONTH}
		
		    SET @SaleDateFr = LEFT(@DateMonth,4) + '0101'
		    SET @SaleDateTo = @DateMonth + '31'
		
		    /*
		    TYPE_FLAG
		    '0010' 국내-상품
		    '0019' 소계
		    '0020' 해외-상품
		    '0029' 소계
		    '0090' 합계(상품)
		    '1010' 국내-제품 
		    '1019' 소계
		    '1020' 국내-제품 
		    '1029' 소계
		    '1090' 합계(제품)
		    '1510' 국내-기타
		    '1520' 해외-기타
		    '1990' 계(국내)
		    '2990' 계(해외)
		    '9990' 총합계
		    */
		
		    /* 임시 테이블 선언 */
		    IF EXISTS (SELECT TOP 1 1 FROM tempdb..sysobjects WHERE id = OBJECT_ID('tempdb..#OMEGAPLUS202009221216'))
		       DROP TABLE #OMEGAPLUS202009221216
		
		    CREATE TABLE #OMEGAPLUS202009221216
		        ( TYPE_FLAG             NVARCHAR(04)
		        , SALE_GUBUN            NVARCHAR(20)
		        , ITEM_ACCOUNT_NAME     NVARCHAR(20)
		        , ITEM_LEVEL_NAME       NVARCHAR(20)
		        , SALE_Q        NUMERIC(30,6), SALE_I       NUMERIC(30,6)
		        , SALE_Q_01     NUMERIC(30,6), SALE_I_01    NUMERIC(30,6)
		        , SALE_Q_02     NUMERIC(30,6), SALE_I_02    NUMERIC(30,6)
		        , SALE_Q_03     NUMERIC(30,6), SALE_I_03    NUMERIC(30,6)
		        , SALE_Q_04     NUMERIC(30,6), SALE_I_04    NUMERIC(30,6)
		        , SALE_Q_05     NUMERIC(30,6), SALE_I_05    NUMERIC(30,6)
		        , SALE_Q_06     NUMERIC(30,6), SALE_I_06    NUMERIC(30,6)
		        , SALE_Q_07     NUMERIC(30,6), SALE_I_07    NUMERIC(30,6)
		        , SALE_Q_08     NUMERIC(30,6), SALE_I_08    NUMERIC(30,6)
		        , SALE_Q_09     NUMERIC(30,6), SALE_I_09    NUMERIC(30,6)
		        , SALE_Q_10     NUMERIC(30,6), SALE_I_10    NUMERIC(30,6)
		        , SALE_Q_11     NUMERIC(30,6), SALE_I_11    NUMERIC(30,6)
		        , SALE_Q_12     NUMERIC(30,6), SALE_I_12    NUMERIC(30,6) )
		
		    -- 데이터 조회(품목군별)
		    INSERT INTO #OMEGAPLUS202009221216
		    SELECT (CASE WHEN A.ITEM_ACCOUNT_NAME = '상품' AND A.SALE_GUBUN = '국내' THEN '0010'
		                 WHEN A.ITEM_ACCOUNT_NAME = '상품' AND A.SALE_GUBUN = '해외' THEN '0020'
		                 WHEN A.ITEM_ACCOUNT_NAME = '제품' AND A.SALE_GUBUN = '국내' THEN '1010'
		                 WHEN A.ITEM_ACCOUNT_NAME = '제품' AND A.SALE_GUBUN = '해외' THEN '1020'
		                 WHEN A.ITEM_ACCOUNT_NAME = '기타' AND A.SALE_GUBUN = '국내' THEN '1510'
		                 WHEN A.ITEM_ACCOUNT_NAME = '기타' AND A.SALE_GUBUN = '해외' THEN '1520'
		                                                                             ELSE ''
		             END) AS TYPE_FLAG
		         , A.SALE_GUBUN
		         , A.ITEM_ACCOUNT_NAME
		         , A.ITEM_LEVEL_NAME
		         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
		         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
		         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
		         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
		         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
		         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
		         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
		         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
		         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
		         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
		         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
		         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
		         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
		      FROM (SELECT CASE WHEN A.NATION_CODE = '1' THEN '국내'
		                                                 ELSE '해외'
		                    END AS SALE_GUBUN
		                 , CASE WHEN C2.ITEM_ACCOUNT IN ('00','40','50','60') THEN '상품'
		                        WHEN C2.ITEM_ACCOUNT IN ('10','20','99')      THEN '제품'
		                                                                      ELSE ''
		                    END AS ITEM_ACCOUNT_NAME
		                 , CASE WHEN C2.ITEM_ACCOUNT IN ('00')           THEN ISNULL(L2.LEVEL_NAME,'')
		                        WHEN C2.ITEM_ACCOUNT IN ('40','50','60') THEN (CASE WHEN ISNULL(L2.LEVEL_NAME,'') = ''
		                                                                            THEN ISNULL(L1.LEVEL_NAME,'')
		                                                                            ELSE ISNULL(L2.LEVEL_NAME,'')
		                                                                        END)
		                        WHEN C2.ITEM_ACCOUNT IN ('10','20','99') THEN ISNULL(L1.LEVEL_NAME,'')
		                                                                 ELSE ''
		                    END ITEM_LEVEL_NAME
		               --, C1.ITEM_LEVEL1
		               --, C1.ITEM_LEVEL2
		               --, A.ITEM_CODE
		                 , A.SALE_Q
		                 , A.SALE_LOC_AMT_I AS SALE_I
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '01' THEN A.SALE_Q         ELSE 0 END SALE_Q_01
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '01' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_01
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '02' THEN A.SALE_Q         ELSE 0 END SALE_Q_02
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '02' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_02
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '03' THEN A.SALE_Q         ELSE 0 END SALE_Q_03
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '03' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_03
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '04' THEN A.SALE_Q         ELSE 0 END SALE_Q_04
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '04' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_04
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '05' THEN A.SALE_Q         ELSE 0 END SALE_Q_05
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '05' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_05
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '06' THEN A.SALE_Q         ELSE 0 END SALE_Q_06
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '06' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_06
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '07' THEN A.SALE_Q         ELSE 0 END SALE_Q_07
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '07' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_07
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '08' THEN A.SALE_Q         ELSE 0 END SALE_Q_08
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '08' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_08
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '09' THEN A.SALE_Q         ELSE 0 END SALE_Q_09
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '09' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_09
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '10' THEN A.SALE_Q         ELSE 0 END SALE_Q_10
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '10' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_10
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '11' THEN A.SALE_Q         ELSE 0 END SALE_Q_11
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '11' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_11
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '12' THEN A.SALE_Q         ELSE 0 END SALE_Q_12
		                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '12' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_12
		              FROM            SALES_V A  WITH (NOLOCK)
				           LEFT  JOIN BTR100T D1 WITH (NOLOCK) ON D1.COMP_CODE     = A.COMP_CODE
				                                              AND D1.SALE_DIV_CODE = A.DIV_CODE
				                                              AND D1.INOUT_NUM     = A.INOUT_NUM
				                                              AND D1.INOUT_SEQ     = A.INOUT_SEQ
				                                              AND D1.INOUT_TYPE    = A.INOUT_TYPE
		                   INNER JOIN BPR100T C1 WITH (NOLOCK) ON C1.COMP_CODE     = A.COMP_CODE
		                                                      AND C1.ITEM_CODE     = A.ITEM_CODE
		                   INNER JOIN BPR200T C2 WITH (NOLOCK) ON C2.COMP_CODE     = A.COMP_CODE
		                                                      AND C2.DIV_CODE      = A.DIV_CODE
		                                                      AND C2.ITEM_CODE     = A.ITEM_CODE
		                   LEFT  JOIN BPR000T L1 WITH (NOLOCK) ON L1.COMP_CODE     = C1.COMP_CODE
		                                                      AND L1.LEVEL1        = C1.ITEM_LEVEL1
		                                                      AND L1.LEVEL2        = '*'
		                                                      AND L1.LEVEL3        = '*'
		                   LEFT  JOIN BPR000T L2 WITH (NOLOCK) ON L2.COMP_CODE     = C1.COMP_CODE
		                                                      AND L2.LEVEL1        = C1.ITEM_LEVEL1
		                                                      AND L2.LEVEL2        = C1.ITEM_LEVEL2
		                                                      AND L2.LEVEL3        = '*'
		             WHERE A.COMP_CODE     = @CompCode   
		               AND A.DIV_CODE      = @DivCode    
		               AND A.SALE_DATE    &gt;= @SaleDateFr
		               AND A.SALE_DATE    &lt;= @SaleDateTo
		               AND C2.ITEM_ACCOUNT IN ('00','10','20','40','50','60','99')
		
		            UNION ALL
		
		            SELECT '국내'       AS SALE_GUBUN
		                 , '기타'       AS ITEM_ACCOUNT_NAME
		                 , '기타매출'   AS ITEM_LEVEL_NAME
		                 , 0            AS SALE_Q
		                 , 0            AS SALE_I
		                 , 0            AS SALE_Q_01
		                 , 0            AS SALE_I_01
		                 , 0            AS SALE_Q_02
		                 , 0            AS SALE_I_02
		                 , 0            AS SALE_Q_03
		                 , 0            AS SALE_I_03
		                 , 0            AS SALE_Q_04
		                 , 0            AS SALE_I_04
		                 , 0            AS SALE_Q_05
		                 , 0            AS SALE_I_05
		                 , 0            AS SALE_Q_06
		                 , 0            AS SALE_I_06
		                 , 0            AS SALE_Q_07
		                 , 0            AS SALE_I_07
		                 , 0            AS SALE_Q_08
		                 , 0            AS SALE_I_08
		                 , 0            AS SALE_Q_09
		                 , 0            AS SALE_I_09
		                 , 0            AS SALE_Q_10
		                 , 0            AS SALE_I_10
		                 , 0            AS SALE_Q_11
		                 , 0            AS SALE_I_11
		                 , 0            AS SALE_Q_12
		                 , 0            AS SALE_I_12
		
		            UNION ALL
		
		            SELECT '국내'       AS SALE_GUBUN
		                 , '기타'       AS ITEM_ACCOUNT_NAME
		                 , '기타매출'   AS ITEM_LEVEL_NAME
		                 , 0                                                      AS SALE_Q
		                 , A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) AS SALE_I
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '01' THEN 0                                                      ELSE 0 END SALE_Q_01
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '01' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_01
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '02' THEN 0                                                      ELSE 0 END SALE_Q_02
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '02' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_02
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '03' THEN 0                                                      ELSE 0 END SALE_Q_03
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '03' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_03
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '04' THEN 0                                                      ELSE 0 END SALE_Q_04
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '04' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_04
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '05' THEN 0                                                      ELSE 0 END SALE_Q_05
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '05' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_05
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '06' THEN 0                                                      ELSE 0 END SALE_Q_06
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '06' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_06
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '07' THEN 0                                                      ELSE 0 END SALE_Q_07
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '07' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_07
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '08' THEN 0                                                      ELSE 0 END SALE_Q_08
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '08' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_08
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '09' THEN 0                                                      ELSE 0 END SALE_Q_09
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '09' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_09
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '10' THEN 0                                                      ELSE 0 END SALE_Q_10
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '10' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_10
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '11' THEN 0                                                      ELSE 0 END SALE_Q_11
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '11' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_11
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '12' THEN 0                                                      ELSE 0 END SALE_Q_12
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '12' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_12
		              FROM AGJ210T A WITH (NOLOCK)
		             WHERE A.COMP_CODE = @CompCode
		               AND A.DIV_CODE  = @DivCode
		               AND A.AC_DATE  &gt;= @SaleDateFr
		               AND A.AC_DATE  &lt;= @SaleDateTo
			           AND (A.MOD_DIVI IS NULL OR A.MOD_DIVI = '')
		               AND (CASE WHEN AC_CODE1 = 'Z17' AND AC_DATA1 = '01' THEN 'Y'
		                         WHEN AC_CODE2 = 'Z17' AND AC_DATA2 = '01' THEN 'Y'
		                         WHEN AC_CODE3 = 'Z17' AND AC_DATA3 = '01' THEN 'Y'
		                         WHEN AC_CODE4 = 'Z17' AND AC_DATA4 = '01' THEN 'Y'
		                         WHEN AC_CODE5 = 'Z17' AND AC_DATA5 = '01' THEN 'Y'
		                         WHEN AC_CODE6 = 'Z17' AND AC_DATA6 = '01' THEN 'Y'
		                                                                   ELSE 'N'
		                     END) = 'Y'
		
		            UNION ALL
		
		            SELECT '해외'       AS SALE_GUBUN
		                 , '기타'       AS ITEM_ACCOUNT_NAME
		                 , '기타매출'   AS ITEM_LEVEL_NAME
		                 , 0            AS SALE_Q
		                 , 0            AS SALE_I
		                 , 0            AS SALE_Q_01
		                 , 0            AS SALE_I_01
		                 , 0            AS SALE_Q_02
		                 , 0            AS SALE_I_02
		                 , 0            AS SALE_Q_03
		                 , 0            AS SALE_I_03
		                 , 0            AS SALE_Q_04
		                 , 0            AS SALE_I_04
		                 , 0            AS SALE_Q_05
		                 , 0            AS SALE_I_05
		                 , 0            AS SALE_Q_06
		                 , 0            AS SALE_I_06
		                 , 0            AS SALE_Q_07
		                 , 0            AS SALE_I_07
		                 , 0            AS SALE_Q_08
		                 , 0            AS SALE_I_08
		                 , 0            AS SALE_Q_09
		                 , 0            AS SALE_I_09
		                 , 0            AS SALE_Q_10
		                 , 0            AS SALE_I_10
		                 , 0            AS SALE_Q_11
		                 , 0            AS SALE_I_11
		                 , 0            AS SALE_Q_12
		                 , 0            AS SALE_I_12
		
		            UNION ALL
		
		            SELECT '해외'       AS SALE_GUBUN
		                 , '기타'       AS ITEM_ACCOUNT_NAME
		                 , '기타매출'   AS ITEM_LEVEL_NAME
		                 , 0                                                      AS SALE_Q
		                 , A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) AS SALE_I
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '01' THEN 0                                                      ELSE 0 END SALE_Q_01
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '01' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_01
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '02' THEN 0                                                      ELSE 0 END SALE_Q_02
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '02' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_02
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '03' THEN 0                                                      ELSE 0 END SALE_Q_03
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '03' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_03
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '04' THEN 0                                                      ELSE 0 END SALE_Q_04
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '04' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_04
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '05' THEN 0                                                      ELSE 0 END SALE_Q_05
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '05' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_05
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '06' THEN 0                                                      ELSE 0 END SALE_Q_06
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '06' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_06
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '07' THEN 0                                                      ELSE 0 END SALE_Q_07
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '07' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_07
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '08' THEN 0                                                      ELSE 0 END SALE_Q_08
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '08' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_08
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '09' THEN 0                                                      ELSE 0 END SALE_Q_09
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '09' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_09
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '10' THEN 0                                                      ELSE 0 END SALE_Q_10
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '10' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_10
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '11' THEN 0                                                      ELSE 0 END SALE_Q_11
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '11' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_11
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '12' THEN 0                                                      ELSE 0 END SALE_Q_12
		                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '12' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_12
		              FROM AGJ210T A WITH (NOLOCK)
		             WHERE A.COMP_CODE = @CompCode
		               AND A.DIV_CODE  = @DivCode
		               AND A.AC_DATE  &gt;= @SaleDateFr
		               AND A.AC_DATE  &lt;= @SaleDateTo
			           AND (A.MOD_DIVI IS NULL OR A.MOD_DIVI = '')
		               AND (CASE WHEN AC_CODE1 = 'Z17' AND AC_DATA1 = '02' THEN 'Y'
		                         WHEN AC_CODE2 = 'Z17' AND AC_DATA2 = '02' THEN 'Y'
		                         WHEN AC_CODE3 = 'Z17' AND AC_DATA3 = '02' THEN 'Y'
		                         WHEN AC_CODE4 = 'Z17' AND AC_DATA4 = '02' THEN 'Y'
		                         WHEN AC_CODE5 = 'Z17' AND AC_DATA5 = '02' THEN 'Y'
		                         WHEN AC_CODE6 = 'Z17' AND AC_DATA6 = '02' THEN 'Y'
		                                                                   ELSE 'N'
		                     END) = 'Y'
		           ) A
		     GROUP BY A.SALE_GUBUN, A.ITEM_ACCOUNT_NAME, A.ITEM_LEVEL_NAME
		
		    -- 소계
		    INSERT INTO #OMEGAPLUS202009221216
		    SELECT CASE WHEN A.TYPE_FLAG = '0010' THEN '0019'
		                WHEN A.TYPE_FLAG = '0020' THEN '0029'
		                WHEN A.TYPE_FLAG = '1010' THEN '1019'
		                WHEN A.TYPE_FLAG = '1020' THEN '1029'
		                                          ELSE ''
		            END AS TYPE_FLAG
		         , '소계' AS SALE_GUBUN
		         , ''     AS ITEM_ACCOUNT_NAME
		         , ''     AS ITEM_LEVEL_NAME
		         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
		         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
		         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
		         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
		         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
		         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
		         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
		         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
		         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
		         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
		         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
		         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
		         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
		      FROM #OMEGAPLUS202009221216 A
		     WHERE A.TYPE_FLAG IN ('0010','0020','1010','1020')
		     GROUP BY A.TYPE_FLAG
		
		    -- 합계(상품,제품)             
		    INSERT INTO #OMEGAPLUS202009221216
		    SELECT '0090' AS TYPE_FLAG
		         , '합계(상품)' AS SALE_GUBUN
		         , ''           AS ITEM_ACCOUNT_NAME
		         , ''           AS ITEM_LEVEL_NAME
		         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
		         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
		         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
		         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
		         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
		         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
		         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
		         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
		         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
		         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
		         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
		         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
		         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
		      FROM #OMEGAPLUS202009221216 A
		     WHERE A.TYPE_FLAG IN ('0019','0029')
		
		    INSERT INTO #OMEGAPLUS202009221216
		    SELECT '1090' AS TYPE_FLAG
		         , '합계(제품)' AS SALE_GUBUN
		         , ''           AS ITEM_ACCOUNT_NAME
		         , ''           AS ITEM_LEVEL_NAME
		         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
		         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
		         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
		         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
		         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
		         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
		         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
		         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
		         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
		         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
		         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
		         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
		         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
		      FROM #OMEGAPLUS202009221216 A
		     WHERE A.TYPE_FLAG IN ('1019','1029')
		
		    -- 계(국내,해외)
		    INSERT INTO #OMEGAPLUS202009221216
		    SELECT '1990' AS TYPE_FLAG
		         , '계(국내)' AS SALE_GUBUN
		         , ''         AS ITEM_ACCOUNT_NAME
		         , ''         AS ITEM_LEVEL_NAME
		         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
		         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
		         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
		         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
		         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
		         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
		         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
		         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
		         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
		         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
		         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
		         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
		         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
		      FROM #OMEGAPLUS202009221216 A
		     WHERE A.TYPE_FLAG IN ('0010','1010','1510')
		
		    INSERT INTO #OMEGAPLUS202009221216
		    SELECT '2990' AS TYPE_FLAG
		         , '계(해외)' AS SALE_GUBUN
		         , ''         AS ITEM_ACCOUNT_NAME
		         , ''         AS ITEM_LEVEL_NAME
		         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
		         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
		         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
		         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
		         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
		         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
		         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
		         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
		         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
		         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
		         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
		         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
		         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
		      FROM #OMEGAPLUS202009221216 A
		     WHERE A.TYPE_FLAG IN ('0020','1020','1520')
		
		    -- 총합계
		    INSERT INTO #OMEGAPLUS202009221216
		    SELECT '9990' AS TYPE_FLAG
		         , '총합계' AS SALE_GUBUN
		         , ''       AS ITEM_ACCOUNT_NAME
		         , ''       AS ITEM_LEVEL_NAME
		         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
		         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
		         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
		         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
		         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
		         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
		         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
		         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
		         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
		         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
		         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
		         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
		         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
		      FROM #OMEGAPLUS202009221216 A
		     WHERE A.TYPE_FLAG IN ('1990','2990')
		
		    -- 조회
		    SELECT A.TYPE_FLAG
		         , A.SALE_GUBUN
		         , A.ITEM_ACCOUNT_NAME
		         , A.ITEM_LEVEL_NAME
		         , A.SALE_Q   , A.SALE_I
		         , A.SALE_Q_01, A.SALE_I_01
		         , A.SALE_Q_02, A.SALE_I_02
		         , A.SALE_Q_03, A.SALE_I_03
		         , A.SALE_Q_04, A.SALE_I_04
		         , A.SALE_Q_05, A.SALE_I_05
		         , A.SALE_Q_06, A.SALE_I_06
		         , A.SALE_Q_07, A.SALE_I_07
		         , A.SALE_Q_08, A.SALE_I_08
		         , A.SALE_Q_09, A.SALE_I_09
		         , A.SALE_Q_10, A.SALE_I_10
		         , A.SALE_Q_11, A.SALE_I_11
		         , A.SALE_Q_12, A.SALE_I_12
		      FROM #OMEGAPLUS202009221216 A
		     ORDER BY A.TYPE_FLAG, A.ITEM_LEVEL_NAME

		    SET NOCOUNT OFF
		    SET ARITHABORT OFF
		END
	</select>
	<select id="s_agc860skr_mitServiceImpl.selectList2" parameterType="Map" resultType="rMap">
		BEGIN
		    SET NOCOUNT ON
		    SET ARITHABORT ON 

		    DECLARE @CompCode       NVARCHAR(08)   /* 법인코드            */
		          , @DivCode        NVARCHAR(08)   /* 사업장코드          */
		          , @DateMonth      NVARCHAR(06)   /* 조회월            */
		          , @SaleDateFr     NVARCHAR(08)    /* 조회시작일          */
		          , @SaleDateTo     NVARCHAR(08)    /* 조회종료일          */
				  
				SET @CompCode    = #{S_COMP_CODE}
			    SET @DivCode     = #{DIV_CODE}
			    SET @DateMonth   = #{DATE_MONTH}  
		        SET @SaleDateFr = LEFT(@DateMonth,4) + '0101'
			    SET @SaleDateTo = @DateMonth + '31'
			
			    /*
			    TYPE_FLAG
			    'A010' 국내
			    'A090' 소계
			    'A120' 남아메리카
			    'A190' 소계
			    .....
			
			    'A620' 유럽
			    'A690' 소계
			    'A999' 합계
			
			    'ZE10' 기타 국내
			    'ZE20' 기타 해외
			
			    'ZZ19' 계(국내)
			    'ZZ29' 계(해외)
			
			    'ZZ99' 총합계
			    */
			
			    /* 임시 테이블 선언 */
			    IF EXISTS (SELECT TOP 1 1 FROM tempdb..sysobjects WHERE id = OBJECT_ID('tempdb..#OMEGAPLUS202009221312'))
			       DROP TABLE #OMEGAPLUS202009221312
			
			    CREATE TABLE #OMEGAPLUS202009221312
			        ( TYPE_FLAG             NVARCHAR(04)
			        , CONTINENT             NVARCHAR(20)
			        , NATION_NAME           NVARCHAR(100)
			        , SALE_Q        NUMERIC(30,6), SALE_I       NUMERIC(30,6)
			        , SALE_Q_01     NUMERIC(30,6), SALE_I_01    NUMERIC(30,6)
			        , SALE_Q_02     NUMERIC(30,6), SALE_I_02    NUMERIC(30,6)
			        , SALE_Q_03     NUMERIC(30,6), SALE_I_03    NUMERIC(30,6)
			        , SALE_Q_04     NUMERIC(30,6), SALE_I_04    NUMERIC(30,6)
			        , SALE_Q_05     NUMERIC(30,6), SALE_I_05    NUMERIC(30,6)
			        , SALE_Q_06     NUMERIC(30,6), SALE_I_06    NUMERIC(30,6)
			        , SALE_Q_07     NUMERIC(30,6), SALE_I_07    NUMERIC(30,6)
			        , SALE_Q_08     NUMERIC(30,6), SALE_I_08    NUMERIC(30,6)
			        , SALE_Q_09     NUMERIC(30,6), SALE_I_09    NUMERIC(30,6)
			        , SALE_Q_10     NUMERIC(30,6), SALE_I_10    NUMERIC(30,6)
			        , SALE_Q_11     NUMERIC(30,6), SALE_I_11    NUMERIC(30,6)
			        , SALE_Q_12     NUMERIC(30,6), SALE_I_12    NUMERIC(30,6) )
			
			    -- 데이터 조회(대륙별)
			    INSERT INTO #OMEGAPLUS202009221312
			    SELECT CASE WHEN A.CONTINENT_CODE = 'A3' AND A.NATION_CODE = 'KR' THEN 'A0' + '10'              -- 아시아/대한민국은 국내로 분류
			                WHEN A.CONTINENT_CODE = ''                            THEN 'A9' + '20'              -- 대륙값이 없는 경우 AZ로 분류
			                WHEN A.CONTINENT_CODE = 'ZE' AND A.NATION_CODE = '10' THEN A.CONTINENT_CODE + '10'  -- 기타매출 국내
			                WHEN A.CONTINENT_CODE = 'ZE' AND A.NATION_CODE = '20' THEN A.CONTINENT_CODE + '20'  -- 기타매출 해외
			                                                                      ELSE A.CONTINENT_CODE + '20'  -- 나머지는 대륙코드로 분류
			            END AS TYPE_FLAG
			         , CASE WHEN A.CONTINENT_CODE = 'A3' AND A.NATION_CODE = 'KR' THEN '국내'                   -- 아시아/대한민국은 국내
			                WHEN A.CONTINENT_CODE = ''                            THEN ''                       -- 대륙값이 없는 경우 공백
			                WHEN A.CONTINENT_CODE = 'ZE' AND A.NATION_CODE = '10' THEN '기타'                   -- 기타매출 국내
			                WHEN A.CONTINENT_CODE = 'ZE' AND A.NATION_CODE = '20' THEN '기타'                   -- 기타매출 해외
			                                                                      ELSE A.CONTINENT              -- 나머지는 대륙명
			            END AS CONTINENT
			         , CASE WHEN A.CONTINENT_CODE = 'A3' AND A.NATION_CODE = 'KR' THEN '국내'                   -- 아시아/대한민국은 국내
			                WHEN A.CONTINENT_CODE = ''                            THEN A.NATION_NAME            -- 대륙값이 없는 경우 국가명
			                WHEN A.CONTINENT_CODE = 'ZE' AND A.NATION_CODE = '10' THEN A.NATION_NAME            -- 기타매출 국내
			                WHEN A.CONTINENT_CODE = 'ZE' AND A.NATION_CODE = '20' THEN A.NATION_NAME            -- 기타매출 해외
			                                                                      ELSE A.NATION_NAME            -- 나머지는 국가명
			            END AS NATION_NAME
			         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
			         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
			         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
			         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
			         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
			         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
			         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
			         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
			         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
			         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
			         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
			         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
			         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
			      FROM (SELECT ISNULL(B3.SUB_CODE ,'') AS CONTINENT_CODE
			                 , ISNULL(B3.CODE_NAME,'') AS CONTINENT
			                 , ISNULL(B2.SUB_CODE ,'') AS NATION_CODE
			                 , ISNULL(B2.CODE_NAME,'') AS NATION_NAME
						     , A.SALE_Q
			                 , A.SALE_LOC_AMT_I AS SALE_I
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '01' THEN A.SALE_Q         ELSE 0 END SALE_Q_01
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '01' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_01
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '02' THEN A.SALE_Q         ELSE 0 END SALE_Q_02
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '02' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_02
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '03' THEN A.SALE_Q         ELSE 0 END SALE_Q_03
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '03' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_03
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '04' THEN A.SALE_Q         ELSE 0 END SALE_Q_04
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '04' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_04
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '05' THEN A.SALE_Q         ELSE 0 END SALE_Q_05
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '05' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_05
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '06' THEN A.SALE_Q         ELSE 0 END SALE_Q_06
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '06' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_06
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '07' THEN A.SALE_Q         ELSE 0 END SALE_Q_07
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '07' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_07
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '08' THEN A.SALE_Q         ELSE 0 END SALE_Q_08
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '08' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_08
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '09' THEN A.SALE_Q         ELSE 0 END SALE_Q_09
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '09' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_09
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '10' THEN A.SALE_Q         ELSE 0 END SALE_Q_10
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '10' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_10
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '11' THEN A.SALE_Q         ELSE 0 END SALE_Q_11
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '11' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_11
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '12' THEN A.SALE_Q         ELSE 0 END SALE_Q_12
			                 , CASE WHEN SUBSTRING(A.SALE_DATE,5,2) = '12' THEN A.SALE_LOC_AMT_I ELSE 0 END SALE_I_12
			              FROM            SALES_V A  WITH (NOLOCK)
					           LEFT  JOIN BTR100T D1 WITH (NOLOCK) ON D1.COMP_CODE     = A.COMP_CODE
					                                              AND D1.SALE_DIV_CODE = A.DIV_CODE
					                                              AND D1.INOUT_NUM     = A.INOUT_NUM
					                                              AND D1.INOUT_SEQ     = A.INOUT_SEQ
					                                              AND D1.INOUT_TYPE    = A.INOUT_TYPE
			                   INNER JOIN BPR100T C1 WITH (NOLOCK) ON C1.COMP_CODE     = A.COMP_CODE
			                                                      AND C1.ITEM_CODE     = A.ITEM_CODE
			                   INNER JOIN BPR200T C2 WITH (NOLOCK) ON C2.COMP_CODE     = A.COMP_CODE
			                                                      AND C2.DIV_CODE      = A.DIV_CODE
			                                                      AND C2.ITEM_CODE     = A.ITEM_CODE
			                   LEFT  JOIN BCM100T C  WITH (NOLOCK) ON C.COMP_CODE      = A.COMP_CODE
			                                                      AND C.CUSTOM_CODE    = A.SALE_CUSTOM_CODE
			                   LEFT  JOIN BSA100T B2 WITH (NOLOCK) ON B2.COMP_CODE     = C.COMP_CODE
			                                                      AND B2.MAIN_CODE     = 'B012'
			                                                      AND B2.SUB_CODE      = C.NATION_CODE
			                   LEFT  JOIN BSA100T B3 WITH (NOLOCK) ON B3.COMP_CODE     = B2.COMP_CODE
			                                                      AND B3.MAIN_CODE     = 'B707'
			                                                      AND B3.SUB_CODE      = B2.REF_CODE3
			             WHERE A.COMP_CODE     = @CompCode   
			               AND A.DIV_CODE      = @DivCode    
			               AND A.SALE_DATE    &gt;= @SaleDateFr
			               AND A.SALE_DATE    &lt;= @SaleDateTo
			               AND C2.ITEM_ACCOUNT IN ('00','10','20','40','50','60','99')
			
			            UNION ALL
			
			            SELECT 'ZE'         AS CONTINENT_CODE
			                 , '기타'       AS CONTINENT
			                 , '10'         AS NATION_CODE
			                 , '국내'       AS NATION_NAME
			                 , 0            AS SALE_Q
			                 , 0            AS SALE_I
			                 , 0            AS SALE_Q_01
			                 , 0            AS SALE_I_01
			                 , 0            AS SALE_Q_02
			                 , 0            AS SALE_I_02
			                 , 0            AS SALE_Q_03
			                 , 0            AS SALE_I_03
			                 , 0            AS SALE_Q_04
			                 , 0            AS SALE_I_04
			                 , 0            AS SALE_Q_05
			                 , 0            AS SALE_I_05
			                 , 0            AS SALE_Q_06
			                 , 0            AS SALE_I_06
			                 , 0            AS SALE_Q_07
			                 , 0            AS SALE_I_07
			                 , 0            AS SALE_Q_08
			                 , 0            AS SALE_I_08
			                 , 0            AS SALE_Q_09
			                 , 0            AS SALE_I_09
			                 , 0            AS SALE_Q_10
			                 , 0            AS SALE_I_10
			                 , 0            AS SALE_Q_11
			                 , 0            AS SALE_I_11
			                 , 0            AS SALE_Q_12
			                 , 0            AS SALE_I_12
			
			            UNION ALL
			
			            SELECT 'ZE'         AS CONTINENT_CODE
			                 , '기타'       AS CONTINENT
			                 , '10'         AS NATION_CODE
			                 , '국내'       AS NATION_NAME
		                     , 0                                                      AS SALE_Q
		                     , A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) AS SALE_I
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '01' THEN 0                                                      ELSE 0 END SALE_Q_01
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '01' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_01
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '02' THEN 0                                                      ELSE 0 END SALE_Q_02
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '02' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_02
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '03' THEN 0                                                      ELSE 0 END SALE_Q_03
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '03' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_03
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '04' THEN 0                                                      ELSE 0 END SALE_Q_04
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '04' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_04
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '05' THEN 0                                                      ELSE 0 END SALE_Q_05
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '05' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_05
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '06' THEN 0                                                      ELSE 0 END SALE_Q_06
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '06' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_06
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '07' THEN 0                                                      ELSE 0 END SALE_Q_07
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '07' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_07
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '08' THEN 0                                                      ELSE 0 END SALE_Q_08
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '08' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_08
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '09' THEN 0                                                      ELSE 0 END SALE_Q_09
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '09' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_09
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '10' THEN 0                                                      ELSE 0 END SALE_Q_10
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '10' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_10
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '11' THEN 0                                                      ELSE 0 END SALE_Q_11
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '11' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_11
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '12' THEN 0                                                      ELSE 0 END SALE_Q_12
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '12' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_12
			              FROM AGJ210T A WITH (NOLOCK)
			             WHERE A.COMP_CODE = @CompCode
			               AND A.DIV_CODE  = @DivCode
			               AND A.AC_DATE  &gt;= @SaleDateFr
			               AND A.AC_DATE  &lt;= @SaleDateTo
			               AND (A.MOD_DIVI IS NULL OR A.MOD_DIVI = '')
			               AND (CASE WHEN AC_CODE1 = 'Z17' AND AC_DATA1 = '01' THEN 'Y'
			                         WHEN AC_CODE2 = 'Z17' AND AC_DATA2 = '01' THEN 'Y'
			                         WHEN AC_CODE3 = 'Z17' AND AC_DATA3 = '01' THEN 'Y'
			                         WHEN AC_CODE4 = 'Z17' AND AC_DATA4 = '01' THEN 'Y'
			                         WHEN AC_CODE5 = 'Z17' AND AC_DATA5 = '01' THEN 'Y'
			                         WHEN AC_CODE6 = 'Z17' AND AC_DATA6 = '01' THEN 'Y'
			                                                                   ELSE 'N'
			                     END) = 'Y'
			
			            UNION ALL
			
			            SELECT 'ZE'         AS CONTINENT_CODE
			                 , '기타'       AS CONTINENT
			                 , '20'         AS NATION_CODE
			                 , '해외'       AS NATION_NAME
			                 , 0            AS SALE_Q
			                 , 0            AS SALE_I
			                 , 0            AS SALE_Q_01
			                 , 0            AS SALE_I_01
			                 , 0            AS SALE_Q_02
			                 , 0            AS SALE_I_02
			                 , 0            AS SALE_Q_03
			                 , 0            AS SALE_I_03
			                 , 0            AS SALE_Q_04
			                 , 0            AS SALE_I_04
			                 , 0            AS SALE_Q_05
			                 , 0            AS SALE_I_05
			                 , 0            AS SALE_Q_06
			                 , 0            AS SALE_I_06
			                 , 0            AS SALE_Q_07
			                 , 0            AS SALE_I_07
			                 , 0            AS SALE_Q_08
			                 , 0            AS SALE_I_08
			                 , 0            AS SALE_Q_09
			                 , 0            AS SALE_I_09
			                 , 0            AS SALE_Q_10
			                 , 0            AS SALE_I_10
			                 , 0            AS SALE_Q_11
			                 , 0            AS SALE_I_11
			                 , 0            AS SALE_Q_12
			                 , 0            AS SALE_I_12
			
			            UNION ALL
			
			            SELECT 'ZE'         AS CONTINENT_CODE
			                 , '기타'       AS CONTINENT
			                 , '20'         AS NATION_CODE
			                 , '해외'       AS NATION_NAME
		                     , 0                                                      AS SALE_Q
		                     , A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) AS SALE_I
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '01' THEN 0                                                      ELSE 0 END SALE_Q_01
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '01' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_01
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '02' THEN 0                                                      ELSE 0 END SALE_Q_02
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '02' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_02
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '03' THEN 0                                                      ELSE 0 END SALE_Q_03
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '03' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_03
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '04' THEN 0                                                      ELSE 0 END SALE_Q_04
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '04' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_04
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '05' THEN 0                                                      ELSE 0 END SALE_Q_05
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '05' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_05
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '06' THEN 0                                                      ELSE 0 END SALE_Q_06
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '06' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_06
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '07' THEN 0                                                      ELSE 0 END SALE_Q_07
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '07' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_07
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '08' THEN 0                                                      ELSE 0 END SALE_Q_08
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '08' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_08
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '09' THEN 0                                                      ELSE 0 END SALE_Q_09
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '09' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_09
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '10' THEN 0                                                      ELSE 0 END SALE_Q_10
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '10' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_10
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '11' THEN 0                                                      ELSE 0 END SALE_Q_11
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '11' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_11
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '12' THEN 0                                                      ELSE 0 END SALE_Q_12
			                 , CASE WHEN SUBSTRING(A.AC_DATE,5,2) = '12' THEN A.AMT_I * (CASE WHEN A.DR_CR = '1' THEN -1 ELSE 1 END) ELSE 0 END SALE_I_12
			              FROM AGJ210T A WITH (NOLOCK)
			             WHERE A.COMP_CODE = @CompCode
			               AND A.DIV_CODE  = @DivCode
			               AND A.AC_DATE  &gt;= @SaleDateFr
			               AND A.AC_DATE  &lt;= @SaleDateTo
			               AND (A.MOD_DIVI IS NULL OR A.MOD_DIVI = '')
			               AND (CASE WHEN AC_CODE1 = 'Z17' AND AC_DATA1 = '02' THEN 'Y'
			                         WHEN AC_CODE2 = 'Z17' AND AC_DATA2 = '02' THEN 'Y'
			                         WHEN AC_CODE3 = 'Z17' AND AC_DATA3 = '02' THEN 'Y'
			                         WHEN AC_CODE4 = 'Z17' AND AC_DATA4 = '02' THEN 'Y'
			                         WHEN AC_CODE5 = 'Z17' AND AC_DATA5 = '02' THEN 'Y'
			                         WHEN AC_CODE6 = 'Z17' AND AC_DATA6 = '02' THEN 'Y'
			                                                                   ELSE 'N'
			                     END) = 'Y'
			           ) A
			     GROUP BY A.CONTINENT_CODE, A.CONTINENT, A.NATION_CODE, A.NATION_NAME
			
			    -- 소계
			    INSERT INTO #OMEGAPLUS202009221312
			    SELECT LEFT(A.TYPE_FLAG,2) + '90' AS TYPE_FLAG
			         , '소계' AS CONTINENT
			         , ''     AS NATION_NAME
			         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
			         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
			         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
			         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
			         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
			         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
			         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
			         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
			         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
			         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
			         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
			         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
			         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
			      FROM #OMEGAPLUS202009221312 A
			     WHERE A.TYPE_FLAG NOT IN ('ZE10','ZE20')
			     GROUP BY LEFT(A.TYPE_FLAG,2)
			
			    -- 합계
			    INSERT INTO #OMEGAPLUS202009221312
			    SELECT 'A999' AS TYPE_FLAG
			         , '합계' AS CONTINENT
			         , ''     AS NATION_NAME
			         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
			         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
			         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
			         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
			         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
			         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
			         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
			         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
			         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
			         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
			         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
			         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
			         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
			      FROM #OMEGAPLUS202009221312 A
			     WHERE RIGHT(A.TYPE_FLAG,2) = '90'
			
			    -- 합계(국내/해외)
			    INSERT INTO #OMEGAPLUS202009221312
			    SELECT 'ZZ19' AS TYPE_FLAG
			         , '계(국내)' AS CONTINENT
			         , '' AS NATION_NAME
			         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
			         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
			         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
			         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
			         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
			         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
			         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
			         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
			         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
			         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
			         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
			         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
			         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
			      FROM #OMEGAPLUS202009221312 A
			     WHERE RIGHT(A.TYPE_FLAG,2) = '10'
			
			    INSERT INTO #OMEGAPLUS202009221312
			    SELECT 'ZZ29' AS TYPE_FLAG
			         , '계(해외)' AS CONTINENT
			         , '' AS NATION_NAME
			         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
			         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
			         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
			         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
			         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
			         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
			         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
			         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
			         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
			         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
			         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
			         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
			         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
			       FROM #OMEGAPLUS202009221312 A
			     WHERE RIGHT(A.TYPE_FLAG,2) = '20'
			
			    -- 총합계
			    INSERT INTO #OMEGAPLUS202009221312
			    SELECT 'ZZ99' AS TYPE_FLAG
			         , '총합계' AS CONTINENT
			         , ''       AS NATION_NAME
			         , SUM(A.SALE_Q)    AS SALE_Q   , SUM(A.SALE_I)    AS SALE_I
			         , SUM(A.SALE_Q_01) AS SALE_Q_01, SUM(A.SALE_I_01) AS SALE_I_01
			         , SUM(A.SALE_Q_02) AS SALE_Q_02, SUM(A.SALE_I_02) AS SALE_I_02
			         , SUM(A.SALE_Q_03) AS SALE_Q_03, SUM(A.SALE_I_03) AS SALE_I_03
			         , SUM(A.SALE_Q_04) AS SALE_Q_04, SUM(A.SALE_I_04) AS SALE_I_04
			         , SUM(A.SALE_Q_05) AS SALE_Q_05, SUM(A.SALE_I_05) AS SALE_I_05
			         , SUM(A.SALE_Q_06) AS SALE_Q_06, SUM(A.SALE_I_06) AS SALE_I_06
			         , SUM(A.SALE_Q_07) AS SALE_Q_07, SUM(A.SALE_I_07) AS SALE_I_07
			         , SUM(A.SALE_Q_08) AS SALE_Q_08, SUM(A.SALE_I_08) AS SALE_I_08
			         , SUM(A.SALE_Q_09) AS SALE_Q_09, SUM(A.SALE_I_09) AS SALE_I_09
			         , SUM(A.SALE_Q_10) AS SALE_Q_10, SUM(A.SALE_I_10) AS SALE_I_10
			         , SUM(A.SALE_Q_11) AS SALE_Q_11, SUM(A.SALE_I_11) AS SALE_I_11
			         , SUM(A.SALE_Q_12) AS SALE_Q_12, SUM(A.SALE_I_12) AS SALE_I_12
			       FROM #OMEGAPLUS202009221312 A
			      WHERE A.TYPE_FLAG IN ('ZZ19','ZZ29')
			
			    -- 조회
			    SELECT A.TYPE_FLAG
			         , A.CONTINENT
			         , A.NATION_NAME
			         , A.SALE_Q   , A.SALE_I
			         , A.SALE_Q_01, A.SALE_I_01
			         , A.SALE_Q_02, A.SALE_I_02
			         , A.SALE_Q_03, A.SALE_I_03
			         , A.SALE_Q_04, A.SALE_I_04
			         , A.SALE_Q_05, A.SALE_I_05
			         , A.SALE_Q_06, A.SALE_I_06
			         , A.SALE_Q_07, A.SALE_I_07
			         , A.SALE_Q_08, A.SALE_I_08
			         , A.SALE_Q_09, A.SALE_I_09
			         , A.SALE_Q_10, A.SALE_I_10
			         , A.SALE_Q_11, A.SALE_I_11
			         , A.SALE_Q_12, A.SALE_I_12
			      FROM #OMEGAPLUS202009221312 A
			     ORDER BY A.TYPE_FLAG, A.NATION_NAME

		    SET NOCOUNT OFF
		    SET ARITHABORT OFF
		END
	</select>
</mapper>