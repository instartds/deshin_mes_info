<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="agb180skrService">
	
	<select id="미출력 A 조건" parameterType="Map" resultType="rMap">
	sSqlA = 
                              AND (( B.BOOK_CODE1 = #{MANAGE_CODE}
    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                         
                              AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}
 	</if>
 	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
                              AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}
 	</if>                          
                                )
    
                               OR ( B.BOOK_CODE2 = #{MANAGE_CODE}
    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                         
                              AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}
 	</if>
 	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
                              AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}
 	</if>
                               ))
    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
							<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
							 #{item}
							</foreach>									
  	</if>
	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
	  						  AND ACCNT &gt;= #{ACCNT_CODE_FR}
  	</if>
	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
	  						  AND ACCNT &lt;= #{ACCNT_CODE_TO}
	</if>
                              AND B.AC_DATE &gt;= #{START_DATE}
                              AND B.AC_DATE &lt;  #{FR_DATE}
		
	</select>
	
	
	
	
	<select id="미출력 B 조건 " parameterType="Map" resultType="rMap">
		
		
		sSqlB = 
                              AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                          
                              AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}
    	</if>
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
    						  AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}
    	</if>
                              )
    
    
                              OR (B.BOOK_CODE2 = #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
                              AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}
        </if>
        <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
        					  AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}
        </if>
                              ))

    	<if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
	  	</if>
    	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">

                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
	  	</if>

	  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
	  	 
                              AND ACCNT &lt;= #{ACCNT_CODE_TO}
	  	 </if>
	  	 
                              AND B.AC_DATE &gt;= #{FR_DATE}
                              AND B.AC_DATE &lt;= #{TO_DATE}
	  	
	
	</select>

	<select id="출력 A 조건" parameterType="Map" resultType="rMap">
		sSqlA = 
			          AND (( B.BOOK_CODE1 = #{MANAGE_CODE}                                 
			    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
			          AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                              
			    </if>
			    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
			          AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
			    </if>
			              )                                                                                   
			           OR ( B.BOOK_CODE2 = #{MANAGE_CODE}     
			    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                        
			          AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR} 
			    </if>                              
			    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
			          AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
			    </if>
			              ))                                                                                  
			    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
	  	 		</if>
	  	 		
	  	 		
	  	 		<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">

                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
			  	</if>
			  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
			  	 
		                      AND ACCNT &lt;= #{ACCNT_CODE_TO}
			  	</if>
		                      AND B.AC_DATE &gt;= #{START_DATE}
		                      AND B.AC_DATE &lt;= #{FR_DATE}
							  AND B.INPUT_PATH != 'A1'
		
	</select>
	
	<select id="출력 B 조건" parameterType="Map" resultType="rMap">
		
		
		 sSqlB = 
          AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                
          AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                          
          </if>
          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
          AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
          </if>
              )                                                                                   
           OR (B.BOOK_CODE2 = #{ACCNT_CODE_TO}    
          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                   
          AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}                               
          </if>
          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
          AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
          </if>
              ))
          <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
 		  </if>                                                                                      
    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
          AND ACCNT &gt;= #{ACCNT_CODE_FR}                                       
    	  </if>
    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
          AND ACCNT &lt;= #{ACCNT_CODE_TO}                                          
    	  </if>
          AND B.AC_DATE &gt;= #{FR_DATE}                                  
          AND B.AC_DATE &lt;= #{TO_DATE}                                      
          AND B.INPUT_PATH != 'A1'                           
	</select>
	
	<select id="출력 C 조건" parameterType="Map" resultType="rMap">
		 			  AND (( B.BOOK_CODE1 = #{MANAGE_CODE}                                 
			    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
			          AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                              
			    </if>
			    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
			          AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
			    </if>
			              )                                                                                   
			           OR ( B.BOOK_CODE2 = #{MANAGE_CODE}     
			    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                        
			          AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR} 
			    </if>                              
			    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
			          AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
			    </if>
			              ))                                                                                  
			    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
	  	 		</if>
	  	 		
	  	 		
	  	 		<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">

                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
			  	</if>
			  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
			  	 
		                      AND ACCNT &lt;= #{ACCNT_CODE_TO}
			  	</if>
							  AND B.INPUT_PATH = 'A1'                                                                   
					          AND B.AC_DATE BETWEEN #{FR_DATE} AND #{TO_DATE}
	</select>
	
	
	
	
	
	
	<select id="agb180skrService.selectList" parameterType="Map" resultType="rMap">
		<if test="SUM == &quot;1&quot;">
		SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
    
		    SELECT '1' AS GRP                                                                               
		
		         , A.PEND_CD                                                                                
		         , A.PEND_NAME                                                                              
		         , A.ACCNT                                                                                  
		         , A.ACCNT_NAME                                                                             
		         , SUM(ISNULL(A.WAL_AMT_I, 0)) AS WAL_AMT_I                                                 
		         , SUM(ISNULL(A.DR_AMT_I, 0))  AS DR_AMT_I                                                  
		         , SUM(ISNULL(A.CR_AMT_I, 0))  AS CR_AMT_I                                                  
		         , SUM(ISNULL(A.JAN_AMT_I, 0)) AS JAN_AMT_I                                                 
		      FROM (SELECT ISNULL(CASE WHEN (ISNULL(B.BOOK_CODE1, '') = #{MANAGE_CODE}
		      
		      <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		                                AND ISNULL(B.BOOK_DATA1,'') 		&gt;= #{DYNAMIC_CODE_FR}
		      </if>
			  <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		                                AND ISNULL(B.BOOK_DATA1,'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		      </if>
		                         ) THEN ISNULL(B.BOOK_DATA1,'')                                  
		    
		    
		    
		                               WHEN (ISNULL(B.BOOK_CODE2,'') = #{MANAGE_CODE} 
		      <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		                                AND ISNULL(B.BOOK_DATA2,'') 		&gt;= #{DYNAMIC_CODE_FR}
		      </if>
			  <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		                                AND ISNULL(B.BOOK_DATA2,'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		      </if>                         
		                                    ) THEN ISNULL(B.BOOK_DATA2,'')                                  
		                           END, '') AS PEND_CD                                                      
		    
		 
		                 , ISNULL(CASE WHEN (ISNULL(B.BOOK_CODE1, '') = #{MANAGE_CODE} 
		     <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		                                AND ISNULL(B.BOOK_DATA1,'') 		&gt;= #{DYNAMIC_CODE_FR}
		     </if>
			 <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		                                AND ISNULL(B.BOOK_DATA1,'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		     </if>            
		                                   ) THEN (SELECT AC_NAME                                         
		                                             FROM ABA200TV  WITH (NOLOCK)                                        
		                                            WHERE COMP_CODE = #{S_COMP_CODE}
		                                              AND AC_CODE   = ISNULL(B.BOOK_CODE1,'')               
		                                              AND AC_DATA   = ISNULL(B.BOOK_DATA1,''))              
		                                WHEN (ISNULL(B.BOOK_CODE2, '') = #{MANAGE_CODE} 
		     <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		                                AND ISNULL(B.BOOK_DATA2,'') 		&gt;= #{DYNAMIC_CODE_FR}
		     </if>
			 <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		                                AND ISNULL(B.BOOK_DATA2,'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		     </if>                          
		                                   ) THEN (SELECT AC_NAME                                           
		                                             FROM ABA200TV  WITH (NOLOCK)                                          
		                                            WHERE COMP_CODE = #{S_COMP_CODE}
		                                              AND AC_CODE   = ISNULL(B.BOOK_CODE2,'')                 
		                                              AND AC_DATA   = ISNULL(B.BOOK_DATA2,''))                
		                           END, '') AS PEND_NAME                                                    
		                 , A.ACCNT                                                                          
		                 <if test="ACCOUNT_NAME == &quot;0&quot;">                                                                 
		                 , A.ACCNT_NAME   AS ACCNT_NAME 
		                 </if>
		                 <if test="ACCOUNT_NAME == &quot;1&quot;">
		                 , A.ACCNT_NAME2   AS ACCNT_NAME 	
		                 </if>
		                 <if test="ACCOUNT_NAME == &quot;2&quot;">
		                 , A.ACCNT_NAME3   AS ACCNT_NAME 	
		                 </if>                     
		                 , ISNULL((SELECT CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_FOR_AMT_I, 0)) - SUM(ISNULL(B.CR_FOR_AMT_I, 0))
		                                                  WHEN '2' THEN SUM(ISNULL(B.CR_FOR_AMT_I, 0)) - SUM(ISNULL(B.DR_FOR_AMT_I, 0)) 
		                                   END                                                               
		                             FROM ABA400T  WITH (NOLOCK)                                                           
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    AND (( B.BOOK_CODE1 = #{MANAGE_CODE}
    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                         
                              AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}
 	</if>
 	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
                              AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}
 	</if>                          
                                )
    
                               OR ( B.BOOK_CODE2 = #{MANAGE_CODE}
    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                         
                              AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}
 	</if>
 	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
                              AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}
 	</if>
                               ))
    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
							<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
							 #{item}
							</foreach>									
  	</if>
	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
	  						  AND ACCNT &gt;= #{ACCNT_CODE_FR}
  	</if>
	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
	  						  AND ACCNT &lt;= #{ACCNT_CODE_TO}
	</if>
                              AND B.AC_DATE &gt;= #{START_DATE}
                              AND B.AC_DATE &lt;  #{FR_DATE}
		                         ), 0) AS WAL_FOR_AMT_I                                                     
		                 , ISNULL((SELECT CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_AMT_I, 0)) - SUM(ISNULL(B.CR_AMT_I, 0)) 
		                                                  WHEN '2' THEN SUM(ISNULL(B.CR_AMT_I, 0)) - SUM(ISNULL(B.DR_AMT_I, 0)) 
		                                   END                                                               
		                             FROM ABA400T  WITH (NOLOCK)                                                           
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    AND (( B.BOOK_CODE1 = #{MANAGE_CODE}
    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                         
                              AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}
 	</if>
 	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
                              AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}
 	</if>                          
                                )
    
                               OR ( B.BOOK_CODE2 = #{MANAGE_CODE}
    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                         
                              AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}
 	</if>
 	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
                              AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}
 	</if>
                               ))
    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
							<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
							 #{item}
							</foreach>									
  	</if>
	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
	  						  AND ACCNT &gt;= #{ACCNT_CODE_FR}
  	</if>
	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
	  						  AND ACCNT &lt;= #{ACCNT_CODE_TO}
	</if>
                              AND B.AC_DATE &gt;= #{START_DATE}
                              AND B.AC_DATE &lt;  #{FR_DATE}
		                          ), 0) AS WAL_AMT_I                                                        
		                 , ISNULL((SELECT SUM(ISNULL(B.DR_FOR_AMT_I, 0))                                    
		                             FROM ABA400T  WITH (NOLOCK)                                                           
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                          
                              AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}
    	</if>
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
    						  AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}
    	</if>
                              )
    
    
                              OR (B.BOOK_CODE2 = #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
                              AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}
        </if>
        <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
        					  AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}
        </if>
                              ))

    	<if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
	  	</if>
    	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">

                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
	  	</if>

	  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
	  	 
                              AND ACCNT &lt;= #{ACCNT_CODE_TO}
	  	 </if>
	  	 
                              AND B.AC_DATE &gt;= #{FR_DATE}
                              AND B.AC_DATE &lt;= #{TO_DATE}
		                         ), 0) AS DR_FOR_AMT_I                                                      
		                 , ISNULL((SELECT SUM(ISNULL(B.DR_AMT_I, 0))                                        
		                             FROM ABA400T  WITH (NOLOCK)                                                           
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                          
                              AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}
    	</if>
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
    						  AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}
    	</if>
                              )
    
    
                              OR (B.BOOK_CODE2 = #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
                              AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}
        </if>
        <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
        					  AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}
        </if>
                              ))

    	<if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
	  	</if>
    	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">

                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
	  	</if>

	  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
	  	 
                              AND ACCNT &lt;= #{ACCNT_CODE_TO}
	  	 </if>
	  	 
                              AND B.AC_DATE &gt;= #{FR_DATE}
                              AND B.AC_DATE &lt;= #{TO_DATE}
		                          ), 0) AS DR_AMT_I                                                         
		                 , ISNULL((SELECT SUM(ISNULL(B.CR_FOR_AMT_I, 0))                                    
		                             FROM ABA400T  WITH (NOLOCK)                                                           
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                          
                              AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}
    	</if>
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
    						  AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}
    	</if>
                              )
    
    
                              OR (B.BOOK_CODE2 = #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
                              AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}
        </if>
        <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
        					  AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}
        </if>
                              ))

    	<if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
	  	</if>
    	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">

                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
	  	</if>

	  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
	  	 
                              AND ACCNT &lt;= #{ACCNT_CODE_TO}
	  	 </if>
	  	 
                              AND B.AC_DATE &gt;= #{FR_DATE}
                              AND B.AC_DATE &lt;= #{TO_DATE}
		                          ), 0) AS CR_FOR_AMT_I                                                     
		                 , ISNULL((SELECT SUM(ISNULL(B.CR_AMT_I, 0))                                        
		                             FROM ABA400T  WITH (NOLOCK)                                                           
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                          
                              AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}
    	</if>
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
    						  AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}
    	</if>
                              )
    
    
                              OR (B.BOOK_CODE2 = #{MANAGE_CODE}
    	<if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
                              AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}
        </if>
        <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
        					  AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}
        </if>
                              ))

    	<if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
	  	</if>
    	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">

                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
	  	</if>

	  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
	  	 
                              AND ACCNT &lt;= #{ACCNT_CODE_TO}
	  	 </if>
	  	 
                              AND B.AC_DATE &gt;= #{FR_DATE}
                              AND B.AC_DATE &lt;= #{TO_DATE}
		                         ), 0) AS CR_AMT_I                                                          
		                 , ISNULL((CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_FOR_AMT_I, 0)) - SUM(ISNULL(B.CR_FOR_AMT_I, 0)) 
		                                           WHEN '2' THEN SUM(ISNULL(B.CR_FOR_AMT_I, 0)) - SUM(ISNULL(B.DR_FOR_AMT_I, 0)) 
		                            END), 0) AS JAN_FOR_AMT_I                                                
		                 , ISNULL((CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_AMT_I, 0)) - SUM(ISNULL(B.CR_AMT_I, 0)) 
		                                           WHEN '2' THEN SUM(ISNULL(B.CR_AMT_I, 0)) - SUM(ISNULL(B.DR_AMT_I, 0)) 
		                            END), 0) AS JAN_AMT_I                                                    
		              FROM ABA400T A  WITH (NOLOCK)                                                                          -- 20041108 agb200t -> agb200tv khy
		                           LEFT OUTER JOIN AGB200TV B   WITH (NOLOCK)                                              
		                                        ON B.COMP_CODE = #{S_COMP_CODE}
		                                       AND B.ACCNT     = A.ACCNT                                        
		                           LEFT OUTER JOIN BOR120T C   WITH (NOLOCK)                                               
		                                        ON C.COMP_CODE = #{S_COMP_CODE}
		                                       AND B.DIV_CODE  = C.DIV_CODE                                  
		             WHERE A.COMP_CODE = #{S_COMP_CODE}
		               AND B.ACCNT IS NOT NULL                                                              
		    
		               AND (( B.BOOK_CODE1 = #{MANAGE_CODE}                              
		    
		      <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
                       AND ISNULL(B.BOOK_DATA1,'') &gt;= #{DYNAMIC_CODE_FR}
		      </if>
		      <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
                       AND ISNULL(B.BOOK_DATA1,'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		      </if>
		                   )                                                                                
		                OR (B.BOOK_CODE2 = #{MANAGE_CODE}  
		                
		      <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
                       AND ISNULL(B.BOOK_DATA2,'') &gt;= #{DYNAMIC_CODE_FR}
		      </if>
		      <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
                       AND ISNULL(B.BOOK_DATA2,'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		      </if>                                        
		                   ))                                                                               
		      <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
	  		  </if>
			  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
                       AND B.ACCNT &gt;= #{ACCNT_CODE_FR}
	  	 	  </if>
	  	 	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
                       AND B.ACCNT &lt;= #{ACCNT_CODE_TO}
	  	 	  </if>
		               AND B.AC_DATE &gt;= #{START_DATE}                                     
		               AND B.AC_DATE &lt;= #{TO_DATE}                                     
		             GROUP BY A.ACCNT, A.ACCNT_NAME
	             		 <if test="ACCOUNT_NAME == &quot;0&quot;">                                                                 
		                 , A.ACCNT_NAME   
		                 </if>
		                 <if test="ACCOUNT_NAME == &quot;1&quot;">
		                 , A.ACCNT_NAME2   
		                 </if>
		                 <if test="ACCOUNT_NAME == &quot;2&quot;">
		                 , A.ACCNT_NAME3   
		                 </if>
		                 , B.DIV_CODE, C.DIV_NAME, B.ACCNT, B.JAN_DIVI, B.AC_DATE                        
		                 , B.BOOK_DATA1, B.BOOK_DATA2, B.BOOK_CODE1, B.BOOK_CODE2                        
		           ) A                                                                                      
		     WHERE ISNULL(A.PEND_CD, '') != ''                                                              
		     GROUP BY A.PEND_CD, A.PEND_NAME, A.ACCNT, A.ACCNT_NAME                                         
		    HAVING SUM(WAL_AMT_I) != 0                                                            
		        OR SUM(DR_AMT_I)  != 0                                                            
		        OR SUM(CR_AMT_I)  != 0                                                            
		        OR SUM(JAN_AMT_I) != 0                                                            
		     ORDER BY A.PEND_CD, A.PEND_NAME, A.ACCNT                                                       
		 

		</if>
		
		
		
		
		
		
		
		
		
		
		
		
		<if test="SUM == &quot;2&quot;">
		--UArpt04Krv.Cagb180SKR [fnCreateSql2] query3  *****  거래합계 출력일 경우          *****                                                               
		    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
		    SELECT '1' AS GRP                                                                               
		         , A.PEND_CD                                                                                
		         , A.PEND_NAME                                                                              
		         , A.ACCNT                                                                                  
		         , A.ACCNT_NAME                                                                             
		         , SUM(ISNULL(A.WAL_AMT_I, 0)) AS WAL_AMT_I                                                 
		         , SUM(ISNULL(A.BUSI_AMT_I,0)) AS BUSI_AMT_I                                                
		         , SUM(ISNULL(A.DR_AMT_I, 0))  AS DR_AMT_I                                                  
		         , SUM(ISNULL(A.CR_AMT_I, 0))  AS CR_AMT_I                                                  
		         , SUM(ISNULL(A.JAN_AMT_I, 0)) AS JAN_AMT_I                                                 
		      FROM (SELECT ISNULL(CASE WHEN (ISNULL(B.BOOK_CODE1, '') = #{MANAGE_CODE}  
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		                                AND ISNULL(B.BOOK_DATA1, '') >= #{DYNAMIC_CODE_FR}
		    </if>
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		                                AND ISNULL(B.BOOK_DATA1, 'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		    </if>
		                                  ) THEN ISNULL(B.BOOK_DATA1, '')                                   
		                               WHEN (ISNULL(B.BOOK_CODE2, '') = #{MANAGE_CODE}     
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		                                AND ISNULL(B.BOOK_DATA2, '') >= #{DYNAMIC_CODE_FR}
		    </if>
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		                                AND ISNULL(B.BOOK_DATA2,'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		    </if>
		                                  ) THEN ISNULL(B.BOOK_DATA2, '')                                   
		                          END, '') AS PEND_CD                                                       
		    
		                 , ISNULL(CASE WHEN (ISNULL(B.BOOK_CODE1, '') = #{MANAGE_CODE}   
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		                                AND ISNULL(B.BOOK_DATA1, '') >= #{DYNAMIC_CODE_FR}
		    </if>
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		                                AND ISNULL(B.BOOK_DATA1, 'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		    </if>
		                                    ) THEN (SELECT AC_NAME                                          
		                                              FROM ABA200TV  WITH (NOLOCK)                                         
		                                             WHERE COMP_CODE = #{S_COMP_CODE}
		                                               AND AC_CODE   = ISNULL(B.BOOK_CODE1, '') 
		                                               AND AC_DATA   = ISNULL(B.BOOK_DATA1, ''))
		                               WHEN (ISNULL(B.BOOK_CODE2, '') = #{MANAGE_CODE}
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		                                AND ISNULL(B.BOOK_DATA2, '') &gt;= #{DYNAMIC_CODE_FR}
		    </if>
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		                                AND ISNULL(B.BOOK_DATA2, 'ZZZZZZZZ') &lt;= #{DYNAMIC_CODE_TO}
		    </if>
		                                    ) THEN (SELECT AC_NAME                                          
		                                              FROM ABA200TV   WITH (NOLOCK)                                        
		                                             WHERE COMP_CODE = #{S_COMP_CODE}
		                                               AND AC_CODE   = ISNULL(B.BOOK_CODE2, '')               
		                                               AND AC_DATA   = ISNULL(B.BOOK_DATA2, ''))              
		                            End,'') AS PEND_NAME                                                    
		    
		                 , A.ACCNT                                                                          
		                 <if test="ACCOUNT_NAME == &quot;0&quot;">                                                                 
		                 , A.ACCNT_NAME   AS ACCNT_NAME 
		                 </if>
		                 <if test="ACCOUNT_NAME == &quot;1&quot;">
		                 , A.ACCNT_NAME2   AS ACCNT_NAME 	
		                 </if>
		                 <if test="ACCOUNT_NAME == &quot;2&quot;">
		                 , A.ACCNT_NAME3   AS ACCNT_NAME 	
		                 </if>                  
		                 , ISNULL((SELECT CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_FOR_AMT_I, 0)) - SUM(ISNULL(B.CR_FOR_AMT_I, 0))
		                                                  WHEN '2' THEN SUM(ISNULL(B.CR_FOR_AMT_I, 0)) - SUM(ISNULL(B.DR_FOR_AMT_I, 0))
		                                  END                                                               
		                             FROM ABA400T   WITH (NOLOCK)
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                     
		    -- sSqlA /* 출력 A 조건이 들어가야함 */
		    						  AND (( B.BOOK_CODE1 = #{MANAGE_CODE}                                 
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
						          	  AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                              
						    </if>
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
						          	  AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
						    </if>
					              )                                                                                   
						           OR ( B.BOOK_CODE2 = #{MANAGE_CODE}     
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                        
						          	  AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR} 
						    </if>                              
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
						          	  AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
						    </if>
					              ))                                                                                  
						    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
				        			  AND     B.DIV_CODE IN
									<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
									 #{item}
									</foreach>									
				  	 		</if>	  	 		
				  	 		<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
		                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
						  	</if>
						  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)"> 
				                      AND ACCNT &lt;= #{ACCNT_CODE_TO}
						  	</if>
				                      AND B.AC_DATE &gt;= #{START_DATE}
				                      AND B.AC_DATE &lt;= #{FR_DATE}
									  AND B.INPUT_PATH != 'A1'
		    	---- 출력 A 조건 끝 -----
		    
		    
		                          ), 0) AS WAL_FOR_AMT_I                                                    
		                 , ISNULL((SELECT CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_AMT_I, 0)) - SUM(ISNULL(B.CR_AMT_I, 0)) 
		                                                  WHEN '2' THEN SUM(ISNULL(B.CR_AMT_I, 0)) - SUM(ISNULL(B.DR_AMT_I, 0)) 
		                                  END                                                               
		                             FROM ABA400T   WITH (NOLOCK)                                                          
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    -- sSqlA /* 출력 A 조건 */
		    						  AND (( B.BOOK_CODE1 = #{MANAGE_CODE}                                 
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
						          	  AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                              
						    </if>
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
						          	  AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
						    </if>
					              )                                                                                   
						           OR ( B.BOOK_CODE2 = #{MANAGE_CODE}     
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                        
						          	  AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR} 
						    </if>                              
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
						          	  AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
						    </if>
					              ))                                                                                  
						    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
				        			  AND     B.DIV_CODE IN
									<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
									 #{item}
									</foreach>									
				  	 		</if>	  	 		
				  	 		<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
		                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
						  	</if>
						  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)"> 
				                      AND ACCNT &lt;= #{ACCNT_CODE_TO}
						  	</if>
				                      AND B.AC_DATE &gt;= #{START_DATE}
				                      AND B.AC_DATE &lt;= #{FR_DATE}
									  AND B.INPUT_PATH != 'A1'
		    	---- 출력 A 조건 끝 -----
		                          ), 0) AS WAL_AMT_I                                                        
		                 , ISNULL((SELECT SUM(ISNULL(B.DR_FOR_AMT_I, 0))                                    
		                             FROM ABA400T   WITH (NOLOCK)                                                          
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		        -- sSqlB /* 출력 B 조건이 들어가야함 */
							         AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                
					          	  	 AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                          
					          </if>
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
					          		 AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
					          </if>
					              	)                                                                                   
				           		OR (B.BOOK_CODE2 = #{MANAGE_CODE}    
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                   
					          		 AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}                               
					          </if>
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
					          		 AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
					          </if>
					              ))
					          <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
			        				 AND     B.DIV_CODE IN
										<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
										 #{item}
										</foreach>									
					 		  </if>                                                                                      
					    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
					          		 AND ACCNT &gt;= #{ACCNT_CODE_FR}                                       
					    	  </if>
					    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
					          		 AND ACCNT &lt;= #{ACCNT_CODE_TO}                                          
					    	  </if>
					          		 AND B.AC_DATE &gt;= #{FR_DATE}                                  
					          		 AND B.AC_DATE &lt;= #{TO_DATE}                                      
					          		 AND B.INPUT_PATH != 'A1' 
         				 --- 출력 B 조건 끝 ----
		                          ), 0) AS DR_FOR_AMT_I                                                     
		                 , ISNULL((SELECT CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_AMT_I, 0)) - SUM(ISNULL(B.CR_AMT_I, 0)) 
		                                                  WHEN '2' THEN SUM(ISNULL(B.CR_AMT_I, 0)) - SUM(ISNULL(B.DR_AMT_I, 0)) 
		                                  END                                                               
		                             FROM ABA400T   WITH (NOLOCK)                                                          
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		       -- sSqlC /* 출력 C 조건*/
		    						  AND (( B.BOOK_CODE1 = #{MANAGE_CODE}                                 
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
						          	  AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                              
						    </if>
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
						          	  AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
						    </if>
						              )                                                                                   
						           OR ( B.BOOK_CODE2 = #{MANAGE_CODE}     
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                        
						          	  AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR} 
						    </if>                              
						    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
						          	  AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
						    </if>
						              ))                                                                                  
						    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
			        				  AND     B.DIV_CODE IN
								<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
								 #{item}
								</foreach>									
				  	 		</if>	  	 		
				  	 		<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
			
		                              AND ACCNT &gt;= #{ACCNT_CODE_FR}
						  	</if>
						  	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
				                      AND ACCNT &lt;= #{ACCNT_CODE_TO}
						  	</if>
									  AND B.INPUT_PATH = 'A1'                                                                   
							          AND B.AC_DATE BETWEEN #{FR_DATE} AND #{TO_DATE}
					          
					    --- 출력 C 조건 끝      
					          
		                          ), 0) AS BUSI_AMT_I                                                       
		                 , ISNULL((SELECT SUM(ISNULL(B.DR_AMT_I, 0))                                        
		                             FROM ABA400T  WITH (NOLOCK)                                                           
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    -- sSqlB /* 출력 B 조건이 들어가야함 */
							         AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                
					          	  	 AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                          
					          </if>
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
					          		 AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
					          </if>
					              	)                                                                                   
				           		OR (B.BOOK_CODE2 = #{MANAGE_CODE}    
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                   
					          		 AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}                               
					          </if>
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
					          		 AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
					          </if>
					              ))
					          <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
			        				 AND     B.DIV_CODE IN
										<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
										 #{item}
										</foreach>									
					 		  </if>                                                                                      
					    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
					          		 AND ACCNT &gt;= #{ACCNT_CODE_FR}                                       
					    	  </if>
					    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
					          		 AND ACCNT &lt;= #{ACCNT_CODE_TO}                                          
					    	  </if>
					          		 AND B.AC_DATE &gt;= #{FR_DATE}                                  
					          		 AND B.AC_DATE &lt;= #{TO_DATE}                                      
					          		 AND B.INPUT_PATH != 'A1' 
         				 --- 출력 B 조건 끝 ----
		                          ), 0) AS DR_AMT_I                                                         
		                 , ISNULL((SELECT SUM(ISNULL(B.CR_FOR_AMT_I, 0))                                    
		                             FROM ABA400T  WITH (NOLOCK)                                                           
		                            WHERE COMP_CODE = #{S_COMP_CODE}
		                              AND ACCNT     = B.ACCNT                                                   
		    -- sSqlB /* 출력 B 조건이 들어가야함 */
							         AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                
					          	  	 AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                          
					          </if>
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
					          		 AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
					          </if>
					              	)                                                                                   
				           		OR (B.BOOK_CODE2 = #{MANAGE_CODE}    
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                   
					          		 AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}                               
					          </if>
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
					          		 AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
					          </if>
					              ))
					          <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
			        				 AND     B.DIV_CODE IN
										<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
										 #{item}
										</foreach>									
					 		  </if>                                                                                      
					    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
					          		 AND ACCNT &gt;= #{ACCNT_CODE_FR}                                       
					    	  </if>
					    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
					          		 AND ACCNT &lt;= #{ACCNT_CODE_TO}                                          
					    	  </if>
					          		 AND B.AC_DATE &gt;= #{FR_DATE}                                  
					          		 AND B.AC_DATE &lt;= #{TO_DATE}                                      
					          		 AND B.INPUT_PATH != 'A1' 
         				 --- 출력 B 조건 끝 ----
		                          ), 0) AS CR_FOR_AMT_I                                                     
		                 , ISNULL(( SELECT SUM(ISNULL(B.CR_AMT_I, 0))                                       
		                              FROM ABA400T   WITH (NOLOCK)                                                         
		                             WHERE COMP_CODE = #{S_COMP_CODE}
		                               AND ACCNT     = B.ACCNT                                                  
		    -- sSqlB /* 출력 B 조건이 들어가야함 */
							         AND (( B.BOOK_CODE1 =  #{MANAGE_CODE}
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                
					          	  	 AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                          
					          </if>
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
					          		 AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                               
					          </if>
					              	)                                                                                   
				           		OR (B.BOOK_CODE2 = #{MANAGE_CODE}   
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">                                   
					          		 AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}                               
					          </if>
					          <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
					          		 AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                               
					          </if>
					              ))
					          <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
			        				 AND     B.DIV_CODE IN
										<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
										 #{item}
										</foreach>									
					 		  </if>                                                                                      
					    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">
					          		 AND ACCNT &gt;= #{ACCNT_CODE_FR}                                       
					    	  </if>
					    	  <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">
					          		 AND ACCNT &lt;= #{ACCNT_CODE_TO}                                          
					    	  </if>
					          		 AND B.AC_DATE &gt;= #{FR_DATE}                                  
					          		 AND B.AC_DATE &lt;= #{TO_DATE}                                      
					          		 AND B.INPUT_PATH != 'A1' 
         				 --- 출력 B 조건 끝 ----
		                          ), 0) AS CR_AMT_I                                                         
		                 , ISNULL((CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_FOR_AMT_I, 0)) - SUM(ISNULL(B.CR_FOR_AMT_I, 0)) 
		                                           WHEN '2' THEN SUM(ISNULL(B.CR_FOR_AMT_I, 0)) - SUM(ISNULL(B.DR_FOR_AMT_I, 0)) 
		                           END                                                                      
		                          ), 0) AS JAN_FOR_AMT_I                                                    
		                 , ISNULL((CASE B.JAN_DIVI WHEN '1' THEN SUM(ISNULL(B.DR_AMT_I, 0)) - SUM(ISNULL(B.CR_AMT_I, 0)) 
		                                           WHEN '2' THEN SUM(ISNULL(B.CR_AMT_I, 0)) - SUM(ISNULL(B.DR_AMT_I, 0)) 
		                           END                                                                      
		                          ), 0) AS JAN_AMT_I                                                        
		              FROM ABA400T A  WITH (NOLOCK)       																	-- 20041108 agb200t 에서 agb200tv 으로 변경 khy
		                           LEFT OUTER JOIN AGB200TV B  WITH (NOLOCK)                                               
		                                        ON B.COMP_CODE = #{S_COMP_CODE}
		                                       AND B.ACCNT     = A.ACCNT                                        
		                           LEFT OUTER JOIN BOR120T C  WITH (NOLOCK)                                                
		                                        ON C.COMP_CODE = #{S_COMP_CODE}
		                                       AND B.DIV_CODE  = C.DIV_CODE                                  
		             WHERE A.COMP_CODE = #{S_COMP_CODE}
		               AND B.ACCNT IS NOT NULL                                                              
		   
		               AND ((B.BOOK_CODE1 = #{MANAGE_CODE}                               
		    
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		               AND B.BOOK_DATA1 &gt;= #{DYNAMIC_CODE_FR}                     
		    </if>
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		               AND B.BOOK_DATA1 &lt;= #{DYNAMIC_CODE_TO}                            
		    </if>
		                   )                                                                                
		    
		                OR (B.BOOK_CODE2 = #{MANAGE_CODE}                                
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_FR)">
		               AND B.BOOK_DATA2 &gt;= #{DYNAMIC_CODE_FR}                            
		    </if>
		    <if test="@foren.Ognl@isNotEmpty(DYNAMIC_CODE_TO)">
		               AND B.BOOK_DATA2 &lt;= #{DYNAMIC_CODE_TO}                            
		    </if>
		                   ))                                                                               
		    
		    <if test="@foren.Ognl@isNotEmpty(ACCNT_DIV_CODE)">					
	        				  AND     B.DIV_CODE IN
					<foreach collection="ACCNT_DIV_CODE" item="item" separator="," close=")" open="(">
					 #{item}
					</foreach>									
 		   </if>
 		   <if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_FR)">

                       AND B.ACCNT &gt;= #{ACCNT_CODE_FR}
	  	 	</if>
	  	 	<if test="@foren.Ognl@isNotEmpty(ACCNT_CODE_TO)">

		               AND B.ACCNT &lt;= #{ACCNT_CODE_TO}                                    
	  	 	</if>
	  	 			   AND B.AC_DATE &gt;= #{START_DATE}                                
		               AND B.AC_DATE &lt;= #{TO_DATE}                       
		             GROUP BY A.ACCNT, A.ACCNT_NAME      
		             
		             <if test="ACCOUNT_NAME == &quot;0&quot;">                                                                 
	                 , A.ACCNT_NAME   
	                 </if>
	                 <if test="ACCOUNT_NAME == &quot;1&quot;">
	                 , A.ACCNT_NAME2  	
	                 </if>
	                 <if test="ACCOUNT_NAME == &quot;2&quot;">
	                 , A.ACCNT_NAME3   
	                 </if>
		             
		                   
		                    , B.DIV_CODE, C.DIV_NAME, B.ACCNT, B.JAN_DIVI, B.AC_DATE                        
		                    , B.BOOK_DATA1, B.BOOK_DATA2, B.BOOK_CODE1, B.BOOK_CODE2, B.INPUT_PATH          
		           ) A                                                                                      
		     WHERE ISNULL(A.PEND_CD,'') != ''                                                               
		     GROUP BY A.PEND_CD,A.PEND_NAME,A.ACCNT, A.ACCNT_NAME 	 
									     			                                          
		    HAVING SUM(WAL_AMT_I) != 0                                                            
		        OR SUM(DR_AMT_I)  != 0                                                             
		        OR SUM(CR_AMT_I)  != 0                                                             
		        OR SUM(JAN_AMT_I) != 0                                                            
		     ORDER BY A.PEND_CD, A.PEND_NAME, A.ACCNT                                                       
		</if>			
	</select>
		
	
	<select id="agb180skrService.roundingMethod" parameterType="Map" resultType="rMap">
		SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
		SELECT AMT_POINT 
		  FROM ABA100T  WITH (NOLOCK)
		 WHERE COMP_CODE = #{S_COMP_CODE}
	</select>	
	
	
	<select id="agb180skrService.fnAgb180Init" parameterType="Map" resultType="rMap">
		SELECT *
	      FROM BSA310T WITH (NOLOCK)
	     WHERE COMP_CODE = #{S_COMP_CODE}
	       AND (USER_ID  = #{S_USER_ID} OR USER_ID = '$')
	       AND (PGM_ID   = #{PGM_ID} OR PGM_ID  = '$')
	</select>
	
</mapper>