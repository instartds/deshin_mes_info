<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ssa450rkrvServiceImpl">
	<select id="ssa450rkrvServiceImpl.printList" parameterType="Map" resultType="rMap">
	 BEGIN
	 	<if test="sPrintFlag=='ITEM'">
	 		<choose>
	 			<when test="TRADE_OUT == &quot;T&quot; ">
					<!-- 품목별(ONLY SALES) -->
					 SELECT
					        '' AS SALE_PRSN1
					        ,'' AS SALE_CUSTOM_CODE
					        ,'' AS CUSTOM_NAME
					        ,'' AS BILL_TYPE
					        ,'' AS SALE_DATE
					        ,'' AS INOUT_TYPE_DETAIL,
					        G.ITEM_CODE,
					        uniLITE.fnItemName(#{S_USER_ID},G.ITEM_CODE) as ITEM_NAME,
					        G.SPEC, G.SALE_UNIT,
					        G.TRANS_RATE,
					        G.SALE_DATE1 AS SALE_DATE1,
					        G.SALE_Q, G.SALE_CUSTOM_CODE1, G.CUSTOM_NAME1,
					        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'S007'  --출고유형
					            AND SUB_CODE = G.INOUT_TYPE_DETAIL ) AS INOUT_TYPE_DETAIL1,
					        G.SALE_Q1, G.SALE_P, G.MONEY_UNIT, G.EXCHG_RATE_O,G.SALE_LOC_AMT_I,
					        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'B059'  --과세여부
					            AND SUB_CODE = G.TAX_TYPE ) AS TAX_TYPE,
					        G.TAX_AMT_O,
					        G.SUM_SALE_AMT,
					        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'S002'  --판매유형
					            AND SUB_CODE = G.ORDER_TYPE ) AS ORDER_TYPE,
					        (SELECT DIV_NAME FROM BOR120T WHERE DIV_CODE = G.DIV_CODE) AS DIV_CODE,
					        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'S010'  --영업담당
					            AND SUB_CODE = G.SALE_PRSN ) AS SALE_PRSN,
					        G.MANAGE_CUSTOM, G.MANAGE_CUSTOM_NM,
					        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'S056'  --지역
					            AND SUB_CODE = G.AREA_TYPE ) AS AREA_TYPE,
					        (SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'S055' --고객구분
					            AND SUB_CODE = G.AGENT_TYPE ) AS AGENT_TYPE,
					        G.PROJECT_NO, G.PUB_NUM, G.EX_NUM, G.BILL_NUM, G.ORDER_NUM,
					        G.DISCOUNT_RATE, G.PRICE_YN, G.GUBUN , G.SORT
					 FROM    (
					    SELECT  /** (영업) 매출현황(고객별) **/
					            A.SALE_PRSN            AS SALE_PRSN1,
					            A.SALE_CUSTOM_CODE,
					            uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) as CUSTOM_NAME,
					            A.BILL_TYPE,
					            A.SALE_DATE AS SALE_DATE,
					            B.INOUT_TYPE_DETAIL,
					            B.ITEM_CODE,
					            uniLITE.fnItemName(#{S_USER_ID},D.ITEM_CODE) as ITEM_NAME,
					            D.SPEC,
					            B.SALE_UNIT,
					            B.TRANS_RATE,
					            A.SALE_DATE AS SALE_DATE1,
					            B.SALE_Q,
					            A.SALE_CUSTOM_CODE     AS SALE_CUSTOM_CODE1,
					            uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) as CUSTOM_NAME1,
					            B.INOUT_TYPE_DETAIL    AS INOUT_TYPE_DETAIL1,
					            B.SALE_Q               AS SALE_Q1,
					            B.SALE_P,
					            A.MONEY_UNIT,          /*(화폐단위)*/
					            A.EXCHG_RATE_O,        /*(환율)*/
					            B.SALE_LOC_AMT_I,
					            B.TAX_TYPE,
					            B.TAX_AMT_O,
					            ISNULL(B.SALE_LOC_AMT_I,0) + ISNULL(B.TAX_AMT_O,0) AS SUM_SALE_AMT,
					            A.ORDER_TYPE,
					            A.DIV_CODE,
					            A.SALE_PRSN,
					            C.MANAGE_CUSTOM,
					            uniLITE.fnCustName(#{S_USER_ID}, M.CUSTOM_CODE) as MANAGE_CUSTOM_NM,
					            C.AREA_TYPE,
					            C.AGENT_TYPE,
					            B.PROJECT_NO,
					            B.PUB_NUM,
					             (CASE WHEN A.BILL_TYPE  = '10' OR  A.BILL_TYPE  = '50'  THEN  /*(과세/영세매출인 경우)*/
					                  (SELECT   DISTINCT   CAST(Y.EX_NUM AS NVARCHAR(10)) AS EX_NUM
					                               FROM    SSA110T X
					                               LEFT OUTER JOIN STB100T Y ON X.PUB_NUM = Y.PUB_NUM
					                   WHERE Y.PUB_NUM = B.PUB_NUM)
					            ELSE /*(과세매출이 아닌 경우)*/
					                  CAST(A.EX_NUM AS NVARCHAR(10))
					            END)
					            AS EX_NUM,
					            B.BILL_NUM,
					            B.ORDER_NUM
					            ,ISNULL(B.DISCOUNT_RATE,0) AS DISCOUNT_RATE        --할인율
					            ,(SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'S003'
					                        AND SUB_CODE = B.PRICE_YN) AS PRICE_YN    --단가구분
					            ,CAST('SALES_DATA ONLY' AS NVARCHAR(25))             AS GUBUN
					            ,B.BILL_NUM + CAST(B.BILL_SEQ AS VARCHAR(8)) AS SORT
					            , H.ITEM_GROUP
					    FROM  SSA100T A
					            INNER JOIN SSA110T B ON A.DIV_CODE = B.DIV_CODE AND A.BILL_NUM =B.BILL_NUM  AND A.COMP_CODE=B.COMP_CODE  AND A.COMP_CODE=#{S_COMP_CODE}
					            INNER JOIN BPR100T E ON B.ITEM_CODE = E.ITEM_CODE  AND A.BILL_NUM =B.BILL_NUM  AND B.COMP_CODE=E.COMP_CODE  AND B.COMP_CODE=#{S_COMP_CODE}
					            INNER JOIN BCM100T C ON A.SALE_CUSTOM_CODE = C.CUSTOM_CODE AND  A.COMP_CODE = C.COMP_CODE  AND A.COMP_CODE=#{S_COMP_CODE}
					            INNER JOIN BPR100T D ON B.ITEM_CODE = D.ITEM_CODE AND  B.COMP_CODE =D.COMP_CODE  AND B.COMP_CODE=#{S_COMP_CODE}
					            LEFT OUTER JOIN BCM100T M ON C.MANAGE_CUSTOM = M.CUSTOM_CODE AND  C.COMP_CODE =M.COMP_CODE  AND C.COMP_CODE=#{S_COMP_CODE}
					            LEFT OUTER JOIN BPR100T H ON E.ITEM_GROUP = H.ITEM_CODE AND  E.COMP_CODE =H.COMP_CODE  AND E.COMP_CODE=#{S_COMP_CODE}
					    Union
					       SELECT  /**(무역)국내매출**/
					             A.EXPORT_NM                 AS SALE_PRSN1,
					             A.APPLICANT          AS SALE_CUSTOM_CODE,                /*(고객코드)*/
					             uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) as CUSTOM_NAME,
					             '' AS BILL_TYPE,            /*(매출유형:NULL)*/
					             A.ACCEPT_DATE AS SALE_DATE,/*(양도일 = 매출일)*/
					             '10' AS INOUT_TYPE_DETAIL,  /*(출고유형)*/
					             B.ITEM_CODE,                /*(품목코드)*/
					             uniLITE.fnItemName(#{S_USER_ID},D.ITEM_CODE) as ITEM_NAME,
					             B.STANDARD,                 /*(규격)*/
					             B.UNIT,                     /*(단위)*/
					             B.TRANS_RATE,               /*(입수)*/
					             A.ACCEPT_DATE AS SALE_DATE1,
					             B.QTY,                      /*(매출량)*/
					             A.APPLICANT                 AS SALE_CUSTOM_CODE1,
					             uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) as CUSTOM_NAME1,
					             '10'                        AS INOUT_TYPE_DETAIL1,
					             B.QTY                       AS SALE_Q1,
					             B.PRICE,                    /*(단가)*/
					             A.AMT_UNIT,                 /*(화폐단위)*/
					             B.EXCHANGE_RATE,            /*(환율)*/
					             B.ACCEPT_AMT_WON,           /*(매출액)*/
					             '2' AS TAX_TYPE,            /*(과세여부:면세)*/
					             0   AS TAX_AMT_O,           /*(세액)*/
					            ISNULL(B.ACCEPT_AMT_WON,0) AS SUM_SALE_AMT,
					            '20' AS ORDER_TYPE,          /*(판매유형:S002 : 20 LLC)*/
					             A.DIV_CODE,                 /*(사업장)*/
					             A.EXPORT_NM,                /*(영업담당)*/
					             C.MANAGE_CUSTOM,            /*(집계거래처)*/
					             uniLITE.fnCustName(#{S_USER_ID}, E.CUSTOM_CODE) as MANAGE_CUSTOM_NM,
					             C.AREA_TYPE,                /*(지역)*/
					             C.AGENT_TYPE,               /*(고객분류)*/
					             A.PROJECT_NO,               /*(관리번호)*/
					             '' AS PUB_NUM,              /*(계산서번호:NULL)*/
					             A.EX_NUM,                   /*(전표번호)*/
					             A.ACCEPT_NO,                /*(인수증번호=매출번호)*/
					             B.SO_SER_NO                 /*(SO번호 = 수주번호)*/
					            ,0 AS DISCOUNT_RATE        --할인율
					            ,(SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'S003'
					                        AND SUB_CODE = '2') AS PRICE_YN    --단가구분(진단가)
					             ,CAST('TRADE_IN_DATA' AS NVARCHAR(25))  AS GUBUN
					             ,B.ACCEPT_NO + CAST(B.ACCEPT_SEQ AS VARCHAR(8)) AS SORT
					            , D.ITEM_GROUP
					        FROM TEC120T A
					             INNER JOIN TEC130T B ON A.ACCEPT_NO = B.ACCEPT_NO AND A.COMP_CODE =B.COMP_CODE AND A.COMP_CODE =#{S_COMP_CODE}
					             INNER JOIN BCM100T C ON A.APPLICANT = C.CUSTOM_CODE AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE =#{S_COMP_CODE}
					             INNER JOIN BPR100T D ON B.ITEM_CODE = D.ITEM_CODE AND B.COMP_CODE = D.COMP_CODE AND B.COMP_CODE =#{S_COMP_CODE}
					             LEFT OUTER JOIN BCM100T E ON C.MANAGE_CUSTOM = E.CUSTOM_CODE AND C.COMP_CODE = E.COMP_CODE AND C.COMP_CODE =#{S_COMP_CODE}
					             LEFT OUTER JOIN BPR100T H ON D.ITEM_GROUP = H.ITEM_CODE AND D.COMP_CODE = H.COMP_CODE AND D.COMP_CODE =#{S_COMP_CODE}
					    Union
					        SELECT  /*(무역)해외매출*/
					             C.EXPORT_NM                 AS SALE_PRSN1,
					             C.IMPORTER     AS SALE_CUSTOM_CODE,                 /*(고객코드)*/
					             uniLITE.fnCustName(#{S_USER_ID}, D.CUSTOM_CODE) as CUSTOM_NAME,
					             '' AS BILL_TYPE,            /*(매출유형:NULL)*/
					             A.BL_DATE AS SALE_DATE,    /*(BL발행일=매출일)*/
					             '10' AS INOUT_TYPE_DETAIL,   /*(출고유형)*/
					             B.ITEM_CODE,                /*(품목코드)*/
					             uniLITE.fnItemName(#{S_USER_ID},E.ITEM_CODE) as ITEM_NAME,
					             B.STANDARD AS SPEC,         /*(규격)*/
					             B.UNIT     AS SALE_UNIT,    /*(단위)*/
					             G.TRANS_RATE,               /*(LCAMEND에서 찻수가 가장 큰 것의 변환계수 리턴*/
					             A.BL_DATE AS SALE_DATE1,    /*(BL발행일=매출일)*/
					             B.QTY,                      /*(매출량)*/
					             C.IMPORTER                  AS SALE_CUSTOM_CODE1,
					             uniLITE.fnCustName(#{S_USER_ID}, D.CUSTOM_CODE) as CUSTOM_NAME1,
					             '10'                        AS INOUT_TYPE_DETAIL1,
					             B.QTY                       AS SALE_Q1,
					             B.PRICE,                    /*(단가)*/
					             A.AMT_UNIT,                 /*(화폐단위)*/
					             A.EXCHANGE_RATE,            /*(환율)*/
					             B.BL_AMT_WON,               /*(매출액)*/
					             '2' AS TAX_TYPE,            /*(과세여부:면세)*/
					             0 AS TAX_AMT_O,             /*(세액)*/
					            ISNULL(B.BL_AMT_WON,0) AS SUM_SALE_AMT,
					             B.PAY_METHODE     AS ORDER_TYPE,              /*(매출구분)*/
					             A.DIV_CODE,                 /*(사업장)*/
					             C.EXPORT_NM,                /*(영업담당)*/
					             D.MANAGE_CUSTOM,            /*(집계거래처)*/
					             uniLITE.fnCustName(#{S_USER_ID}, F.CUSTOM_CODE) as MANAGE_CUSTOM_NM,
					             D.AREA_TYPE,                /*(지역)*/
					             D.AGENT_TYPE,               /*(고객분류)*/
					             A.PROJECT_NO,               /*(관리번호)*/
					             '' AS PUB_NUM,              /*(계산서번호:NULL)*/
					             A.EX_NUM,                   /*(전표번호)*/
					             A.BL_SER_NO,                /*(인수증번호=매출번호)*/
					             B.SO_SER_NO                 /*(SO번호 = 수주번호)*/
					            ,0 AS DISCOUNT_RATE        --할인율
					            ,(SELECT CODE_NAME FROM BSA100T WHERE MAIN_CODE = 'S003'
					                        AND SUB_CODE = '2') AS PRICE_YN    --단가구분(진단가)
					            ,CAST('TRADE_OUT_DATA' AS NVARCHAR(25))  AS GUBUN
					            , B.BL_SER_NO + CAST(B.BL_SEQ AS VARCHAR(8)) AS SORT
					            , E.ITEM_GROUP
					        FROM TED100T A
					             INNER JOIN TED110T B ON A.BL_SER_NO = B.BL_SER_NO AND B.COMP_CODE = A.COMP_CODE AND B.COMP_CODE =#{S_COMP_CODE}
					             INNER JOIN TEA100T C ON A.SO_SER_NO = C.SO_SER_NO AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE =#{S_COMP_CODE}
					             INNER JOIN BCM100T D ON C.IMPORTER = D.CUSTOM_CODE AND C.COMP_CODE = D.COMP_CODE AND C.COMP_CODE =#{S_COMP_CODE}
					             INNER JOIN BPR100T E ON B.ITEM_CODE = E.ITEM_CODE AND B.COMP_CODE = E.COMP_CODE AND B.COMP_CODE =#{S_COMP_CODE}
					             LEFT OUTER JOIN BCM100T F ON D.MANAGE_CUSTOM = F.CUSTOM_CODE AND D.COMP_CODE = F.COMP_CODE AND D.COMP_CODE =#{S_COMP_CODE}
					             LEFT OUTER JOIN BPR100T H ON E.ITEM_GROUP = H.ITEM_CODE AND E.COMP_CODE = H.COMP_CODE AND E.COMP_CODE =#{S_COMP_CODE}
					             INNER JOIN TEA110T G ON A.SO_SER_NO = G.SO_SER_NO AND B.SO_SER = G.SO_SER AND A.COMP_CODE = G.COMP_CODE AND A.COMP_CODE =#{S_COMP_CODE}
					 ) G
					 INNER JOIN BPR100T L ON G.ITEM_CODE = L.ITEM_CODE
					 LEFT OUTER JOIN BPR100T M ON L.ITEM_GROUP = M.ITEM_CODE AND L.COMP_CODE = M.COMP_CODE AND L.COMP_CODE =#{S_COMP_CODE}
					 WHERE G.SALE_CUSTOM_CODE IS NOT NULL
					 <if test="@foren.Ognl@isNotEmpty(SALE_PRSN)">
						AND G.SALE_PRSN =#{SALE_PRSN}
					 </if>
					<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
					 AND G.DIV_CODE=#{DIV_CODE}
					 </if>
					 
					 
					 <if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
					 AND G.SALE_CUSTOM_CODE = #{CUSTOM_CODE}					/* 거래처코드  */
					 </if>
					 <if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isEmpty(CUSTOM_NAME)">
					 AND G.SALE_CUSTOM_CODE LIKE  #{CUSTOM_CODE} + '%'			/* 거래처코드  */
					 </if>
					 <if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME) and @foren.Ognl@isEmpty(CUSTOM_CODE)">
					 AND G.CUSTOM_NAME LIKE '%' + #{CUSTOM_NAME} + '%'	/* 거래처명  */
					 </if>

					 <if test="@foren.Ognl@isNotEmpty(FR_DATE)">
						AND G.SALE_DATE &gt;= #{FR_DATE}
					 </if>
					 <if test="@foren.Ognl@isNotEmpty(TO_DATE)">
						AND G.SALE_DATE &lt;= #{TO_DATE}
					 </if>
					 <if test="@foren.Ognl@isNotEmpty(PROJECT_NO)">
						AND G.PROJECT_NO = #{PROJECT_NO}
					 </if>
					 <if test="@foren.Ognl@isNotEmpty(BILL_TYPE)">
						AND G.BILL_TYPE =#{BILL_TYPE}
					 </if>
					 <if test="@foren.Ognl@isNotEmpty(AGENT_TYPE)">
						AND G.AGENT_TYPE =#{AGENT_TYPE}
					 </if>
					 <if test="@foren.Ognl@isNotEmpty(AREA_TYPE)">
						AND G.AREA_TYPE =#{AREA_TYPE}
					 </if>
					 <if test="@foren.Ognl@isNotEmpty(ORDER_TYPE)">
						AND G.ORDER_TYPE =#{ORDER_TYPE}
					</if>
					<if test="@foren.Ognl@isNotEmpty(INOUT_TYPE_DETAIL)">
						AND G.INOUT_TYPE_DETAIL =#{INOUT_TYPE_DETAIL}
					</if>
					<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL1)">
						AND L.ITEM_LEVEL1    = #{ITEM_LEVEL1}
					</if>
					<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL2)">
						AND L.ITEM_LEVEL2    = #{ITEM_LEVEL2}
					</if>
					<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL3)">
						AND L.ITEM_LEVEL3    = #{ITEM_LEVEL3}
					</if>
					
					<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME)">
						AND G.MANAGE_CUSTOM = #{MANAGE_CUSTOM}					/* 집계거래처코드  */
					</if>
					<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isEmpty(MANAGE_CUSTOM_NAME)">
						AND G.MANAGE_CUSTOM LIKE  #{MANAGE_CUSTOM} + '%'			/* 집계거래처코드  */
					</if>
					<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME) and @foren.Ognl@isEmpty(MANAGE_CUSTOM)">
						AND G.MANAGE_CUSTOM_NM LIKE '%' + #{MANAGE_CUSTOM_NAME} + '%'	/* 집계거래처명  */
					</if>

					<if test="@foren.Ognl@isNotEmpty(FR_ORDER_QTY)">
						AND G.SALE_Q &gt;#{FR_ORDER_QTY}
					</if>
					<if test="@foren.Ognl@isNotEmpty(TO_ORDER_QTY)">
						AND G.SALE_Q &lt;#{TO_ORDER_QTY}
					</if>
					<if test="@foren.Ognl@isNotEmpty(ITEM_GROUP_CODE)">
						AND G.ITEM_GROUP   =  #{ITEM_GROUP_CODE}
					</if>
					    ORDER BY G.ITEM_CODE, G.sort
	 			</when>
	 			<when test="TRADE_OUT == &quot;S&quot;">

	 				SELECT    SALE_CUSTOM_CODE, CUSTOM_NAME, BILL_TYPE, SALE_DATE, INOUT_TYPE_DETAIL, ITEM_CODE,
					                ITEM_NAME, SPEC, SALE_UNIT, TRANS_RATE,  SALE_Q,
					                SALE_Q1, SALE_P, MONEY_UNIT, EXCHG_RATE_O, SALE_LOC_AMT_I, TAX_TYPE,
					                TAX_AMT_O, SUM_SALE_AMT, ORDER_TYPE, DIV_CODE, SALE_PRSN, MANAGE_CUSTOM, MANAGE_CUSTOM_NM,
					                AREA_TYPE, AGENT_TYPE, PROJECT_NO, PUB_NUM, EX_NUM, BILL_NUM, ORDER_NUM, DISCOUNT_RATE,
					                PRICE_YN, GUBUN, SORT
					FROM      (SELECT
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S024') AND (SUB_CODE = A.BILL_TYPE)) AS BILL_TYPE,
					                                 B.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, D.ITEM_CODE) AS ITEM_NAME,
					                                 D.SPEC, B.SALE_UNIT, B.TRANS_RATE, A.SALE_DATE AS SALE_DATE, B.SALE_Q,
					                                 A.SALE_CUSTOM_CODE AS SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE)
					                                 AS CUSTOM_NAME,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = B.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL,
					                                 B.SALE_Q AS SALE_Q1, B.SALE_P, A.MONEY_UNIT, A.EXCHG_RATE_O, B.SALE_LOC_AMT_I,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B059') AND (SUB_CODE = B.TAX_TYPE)) AS TAX_TYPE, B.TAX_AMT_O,
					                                 ISNULL(B.SALE_LOC_AMT_I, 0) + ISNULL(B.TAX_AMT_O, 0) AS SUM_SALE_AMT,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S002') AND (SUB_CODE = A.ORDER_TYPE)) AS ORDER_TYPE,
					                                     (SELECT   DIV_NAME
					                                      FROM      BOR120T
					                                      WHERE   (DIV_CODE = A.DIV_CODE)) AS DIV_CODE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S010') AND (SUB_CODE = A.SALE_PRSN)) AS SALE_PRSN, C.MANAGE_CUSTOM,
					                                 uniLITE.fnCustName(#{S_USER_ID},C.CUSTOM_CODE) AS MANAGE_CUSTOM_NM,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B056') AND (SUB_CODE = C.AREA_TYPE)) AS AREA_TYPE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B055') AND (SUB_CODE = C.AGENT_TYPE)) AS AGENT_TYPE, B.PROJECT_NO,
					                                 B.PUB_NUM, (CASE WHEN A.BILL_TYPE = '10' OR
					                                 A.BILL_TYPE = '50' THEN
					                                     (SELECT DISTINCT CAST(Y.EX_NUM AS NVARCHAR(10)) AS EX_NUM
					                                      FROM      SSA110T X LEFT OUTER JOIN
					                                                      STB100T Y ON X.PUB_NUM = Y.PUB_NUM
					                                      WHERE   Y.PUB_NUM = B.PUB_NUM AND Y.DIV_CODE = X.DIV_CODE)
					                                 ELSE CAST(A.EX_NUM AS NVARCHAR(10)) END) AS EX_NUM, B.BILL_NUM, B.ORDER_NUM,
					                                 ISNULL(B.DISCOUNT_RATE, 0) AS DISCOUNT_RATE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = B.PRICE_YN)) AS PRICE_YN,
					                                 CAST('SALE ONLY' AS NVARCHAR(25)) AS GUBUN, B.BILL_NUM + CAST(B.BILL_SEQ AS VARCHAR(8))
					                                 AS SORT
					                 FROM      SSA100T AS A INNER JOIN SSA110T AS B ON A.DIV_CODE = B.DIV_CODE AND A.BILL_NUM = B.BILL_NUM  AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE =#{S_COMP_CODE}
					                                 INNER JOIN BCM100T AS C ON A.SALE_CUSTOM_CODE = C.CUSTOM_CODE AND A.COMP_CODE =C.COMP_CODE AND A.COMP_CODE =#{S_COMP_CODE}
					                                 INNER JOIN BPR100T AS D ON B.ITEM_CODE = D.ITEM_CODE AND B.COMP_CODE = D.COMP_CODE AND B.COMP_CODE = #{S_COMP_CODE}
					                                 LEFT OUTER JOIN BCM100T AS M ON C.MANAGE_CUSTOM = M.CUSTOM_CODE  AND C.COMP_CODE = M.COMP_CODE AND  C.COMP_CODE=#{S_COMP_CODE
					                                 LEFT OUTER JOIN  BPR100T AS N ON D.ITEM_GROUP = N.ITEM_CODE AND D.COMP_CODE = N.COMP_CODE AND D.COMP_CODE=#{S_COMP_CODE}

					                 WHERE   B.BILL_NUM IS NOT NULL
					                  			<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
					                  				AND A.DIV_CODE=#{DIV_CODE}
					                  			</if>
					                 	     	<if test="@foren.Ognl@isNotEmpty(SALE_PRSN)">
													AND A.SALE_PRSN =#{SALE_PRSN}
												</if>
												
												<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
												AND A.SALE_CUSTOM_CODE = #{CUSTOM_CODE}					/* 거래처코드  */
												</if>
												<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isEmpty(CUSTOM_NAME)">
												AND A.SALE_CUSTOM_CODE LIKE  #{CUSTOM_CODE} + '%'			/* 거래처코드  */
												</if>
												<if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME) and @foren.Ognl@isEmpty(CUSTOM_CODE)">
												AND C.CUSTOM_NAME LIKE '%' + #{CUSTOM_NAME} + '%'	/* 거래처명  */
												</if>

												<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
													AND B.ITEM_CODE   = #{ITEM_CODE}						/* 품목코드  */
												</if>
												<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
													AND B.ITEM_CODE   LIKE #{ITEM_CODE} + '%'			/* 품목코드  */
												</if>
												<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
													AND D.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
												</if>
												
												<if test="@foren.Ognl@isNotEmpty(FR_DATE)">
													AND A.SALE_DATE &gt;= #{FR_DATE}
												</if>
												<if test="@foren.Ognl@isNotEmpty(TO_DATE)">
													AND A.SALE_DATE &lt;= #{TO_DATE}
												</if>
												<if test="@foren.Ognl@isNotEmpty(PROJECT_NO)">
													AND B.PROJECT_NO LIKE #{PROJECT_NO}+'%'
												</if>
												<if test="@foren.Ognl@isNotEmpty(BILL_TYPE)">
													AND A.BILL_TYPE =#{BILL_TYPE}
												</if>
												<if test="@foren.Ognl@isNotEmpty(AGENT_TYPE)">
													AND C.AGENT_TYPE =#{AGENT_TYPE}
												</if>
												<if test="@foren.Ognl@isNotEmpty(AREA_TYPE)">
													AND C.AREA_TYPE =#{AREA_TYPE}
												</if>
												<if test="@foren.Ognl@isNotEmpty(ORDER_TYPE)">
													AND A.ORDER_TYPE =#{ORDER_TYPE}
												</if>
												<if test="@foren.Ognl@isNotEmpty(INOUT_TYPE_DETAIL)">
													AND B.INOUT_TYPE_DETAIL =#{INOUT_TYPE_DETAIL}
												</if>
												<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL1)">
													AND D.ITEM_LEVEL1    = #{ITEM_LEVEL1}
												</if>
												<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL2)">
													AND D.ITEM_LEVEL2    = #{ITEM_LEVEL2}
												</if>
												<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL3)">
													AND D.ITEM_LEVEL3    = #{ITEM_LEVEL3}
												</if>
												
												<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME)">
													AND C.MANAGE_CUSTOM = #{MANAGE_CUSTOM}					/* 집계거래처코드  */
												</if>
												<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isEmpty(MANAGE_CUSTOM_NAME)">
													AND C.MANAGE_CUSTOM LIKE  #{MANAGE_CUSTOM} + '%'			/* 집계거래처코드  */
												</if>
												<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME) and @foren.Ognl@isEmpty(MANAGE_CUSTOM)">
													AND M.CUSTOM_NAME LIKE '%' + #{MANAGE_CUSTOM_NAME} + '%'	/* 집계거래처명  */
												</if>
												
												<if test="@foren.Ognl@isNotEmpty(ITEM_GROUP_CODE)">
													AND D.ITEM_GROUP   =  #{ITEM_GROUP_CODE}
												</if>
												<if test="@foren.Ognl@isNotEmpty(FR_ORDER_QTY)">
													AND B.SALE_Q &gt;#{FR_ORDER_QTY}
												</if>
												<if test="@foren.Ognl@isNotEmpty(TO_ORDER_QTY)">
													AND B.SALE_Q &lt;#{TO_ORDER_QTY}
												</if>
											) AS X
										<choose>
											<when test="SALE_YN == &quot;Y&quot;">
												WHERE X.EX_NUM IS NOT NULL
											</when>
											<when test="SALE_YN == &quot;N&quot;">
												WHERE EX_NUM IS  NULL
											</when>
										</choose>
						ORDER BY ITEM_CODE, SORT
	 			</when>
	 		</choose>
	 	</if>
	 	<if test="sPrintFlag=='CUSTOM'">
	 		<choose>
	 			<when test="TRADE_OUT == &quot;T&quot; ">
	 				/*고객별(ONLY SALES)*/
					SELECT   G.SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID}, G.SALE_CUSTOM_CODE) AS CUSTOM_NAME,
					                    (SELECT   CODE_NAME
					                     FROM      BSA100T
					                     WHERE   (MAIN_CODE = 'S024') AND (SUB_CODE = G.BILL_TYPE)) AS BILL_TYPE, G.SALE_DATE,
					                    (SELECT   CODE_NAME
					                     FROM      BSA100T
					                     WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = G.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL,
					                G.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, G.ITEM_CODE) AS ITEM_NAME, G.SPEC, G.SALE_UNIT,
					                G.TRANS_RATE, G.SALE_DATE1, G.SALE_Q, G.SALE_CUSTOM_CODE1, G.CUSTOM_NAME1,
					                    (SELECT   CODE_NAME
					                     FROM      BSA100T
					                     WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = G.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL1,
					                G.SALE_Q1, G.SALE_P, G.MONEY_UNIT, G.EXCHG_RATE_O, G.SALE_LOC_AMT_I,
					                    (SELECT   CODE_NAME
					                     FROM      BSA100T
					                     WHERE   (MAIN_CODE = 'B059') AND (SUB_CODE = G.TAX_TYPE)) AS TAX_TYPE, G.TAX_AMT_O, G.SUM_SALE_AMT,
					                    (SELECT   CODE_NAME
					                     FROM      BSA100T
					                     WHERE   (MAIN_CODE = 'S002') AND (SUB_CODE = G.ORDER_TYPE)) AS ORDER_TYPE,
					                    (SELECT   DIV_NAME
					                     FROM      BOR120T
					                     WHERE   (DIV_CODE = G.DIV_CODE)) AS DIV_CODE,
					                    (SELECT   CODE_NAME
					                     FROM      BSA100T
					                     WHERE   (MAIN_CODE = 'S010') AND (SUB_CODE = G.SALE_PRSN)) AS SALE_PRSN, G.MANAGE_CUSTOM,
					                G.MANAGE_CUSTOM_NM,
					                    (SELECT   CODE_NAME
					                     FROM      BSA100T
					                     WHERE   (MAIN_CODE = 'S056') AND (SUB_CODE = G.AREA_TYPE)) AS AREA_TYPE,
					                    (SELECT   CODE_NAME
					                     FROM      BSA100T
					                     WHERE   (MAIN_CODE = 'S055') AND (SUB_CODE = G.AGENT_TYPE)) AS AGENT_TYPE, G.PROJECT_NO,
					                G.PUB_NUM, G.EX_NUM, G.BILL_NUM, G.ORDER_NUM, G.DISCOUNT_RATE, G.PRICE_YN, G.GUBUN, G.SORT
					FROM      (SELECT   A.SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) AS CUSTOM_NAME,
					                                 A.BILL_TYPE, A.SALE_DATE, B.INOUT_TYPE_DETAIL, B.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID},
					                                 D.ITEM_CODE) AS ITEM_NAME, D.SPEC, B.SALE_UNIT, B.TRANS_RATE, A.SALE_DATE AS SALE_DATE1,
					                                 B.SALE_Q, A.SALE_CUSTOM_CODE AS SALE_CUSTOM_CODE1, uniLITE.fnCustName(#{S_USER_ID},
					                                 C.CUSTOM_CODE) AS CUSTOM_NAME1, B.INOUT_TYPE_DETAIL AS INOUT_TYPE_DETAIL1,
					                                 B.SALE_Q AS SALE_Q1, B.SALE_P, A.MONEY_UNIT, A.EXCHG_RATE_O, B.SALE_LOC_AMT_I, B.TAX_TYPE,
					                                 B.TAX_AMT_O, ISNULL(B.SALE_LOC_AMT_I, 0) + ISNULL(B.TAX_AMT_O, 0) AS SUM_SALE_AMT,
					                                 A.ORDER_TYPE, A.DIV_CODE, A.SALE_PRSN, C.MANAGE_CUSTOM, uniLITE.fnCustName(#{S_USER_ID},
					                                 C.CUSTOM_CODE) AS MANAGE_CUSTOM_NM, C.AREA_TYPE, C.AGENT_TYPE, B.PROJECT_NO,
					                                 B.PUB_NUM, (CASE WHEN A.BILL_TYPE = '10' OR
					                                 A.BILL_TYPE = '50' THEN
					                                     (SELECT DISTINCT CAST(Y.EX_NUM AS NVARCHAR(10)) AS EX_NUM
					                                      FROM      SSA110T X LEFT OUTER JOIN
					                                                      STB100T Y ON X.PUB_NUM = Y.PUB_NUM
					                                      WHERE   Y.PUB_NUM = B.PUB_NUM) ELSE CAST(A.EX_NUM AS NVARCHAR(10)) END) AS EX_NUM,
					                                 B.BILL_NUM, B.ORDER_NUM, ISNULL(B.DISCOUNT_RATE, 0) AS DISCOUNT_RATE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = B.PRICE_YN)) AS PRICE_YN,
					                                 CAST('SALES_DATA ONLY' AS NVARCHAR(25)) AS GUBUN, B.BILL_NUM + CAST(B.BILL_SEQ AS VARCHAR(8))
					                                 AS SORT, H.ITEM_GROUP
					                 FROM      SSA100T AS A INNER JOIN
					                                 SSA110T AS B ON A.DIV_CODE = B.DIV_CODE AND A.BILL_NUM = B.BILL_NUM  AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BPR100T AS E ON B.ITEM_CODE = E.ITEM_CODE AND B.COMP_CODE = E.COMP_CODE AND B.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BCM100T AS C ON A.SALE_CUSTOM_CODE = C.CUSTOM_CODE  AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BPR100T AS D ON B.ITEM_CODE = D.ITEM_CODE  AND D.COMP_CODE = B.COMP_CODE AND B.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BCM100T AS M ON C.MANAGE_CUSTOM = M.CUSTOM_CODE  AND M.COMP_CODE = C.COMP_CODE AND M.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BPR100T AS H ON E.ITEM_GROUP = H.ITEM_CODE AND E.COMP_CODE = H.COMP_CODE AND E.COMP_CODE=#{S_COMP_CODE}
					                 UNION
					                 SELECT   A.APPLICANT AS SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE)
					                                 AS CUSTOM_NAME, '' AS BILL_TYPE, A.ACCEPT_DATE AS SALE_DATE, '10' AS INOUT_TYPE_DETAIL,
					                                 B.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, D.ITEM_CODE) AS ITEM_NAME, B.STANDARD, B.UNIT,
					                                 B.TRANS_RATE, A.ACCEPT_DATE AS SALE_DATE1, B.QTY, A.APPLICANT AS SALE_CUSTOM_CODE1,
					                                 uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) AS CUSTOM_NAME1, '10' AS INOUT_TYPE_DETAIL1,
					                                 B.QTY AS SALE_Q1, B.PRICE, A.AMT_UNIT, B.EXCHANGE_RATE, B.ACCEPT_AMT_WON, '2' AS TAX_TYPE,
					                                 0 AS TAX_AMT_O, ISNULL(B.ACCEPT_AMT_WON, 0) AS SUM_SALE_AMT, '20' AS ORDER_TYPE, A.DIV_CODE,
					                                 A.EXPORT_NM, C.MANAGE_CUSTOM, uniLITE.fnCustName(#{S_USER_ID}, E.CUSTOM_CODE)
					                                 AS MANAGE_CUSTOM_NM, C.AREA_TYPE, C.AGENT_TYPE, A.PROJECT_NO, '' AS PUB_NUM, A.EX_NUM,
					                                 A.ACCEPT_NO, B.SO_SER_NO, 0 AS DISCOUNT_RATE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = '2')) AS PRICE_YN,
					                                 CAST('TRADE_IN_DATA' AS NVARCHAR(25)) AS GUBUN,
					                                 B.ACCEPT_NO + CAST(B.ACCEPT_SEQ AS VARCHAR(8)) AS SORT, D.ITEM_GROUP
					                 FROM      TEC120T AS A INNER JOIN TEC130T AS B ON A.ACCEPT_NO = B.ACCEPT_NO  AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BCM100T AS C ON A.APPLICANT = C.CUSTOM_CODE AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BPR100T AS D ON B.ITEM_CODE = D.ITEM_CODE AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BCM100T AS E ON C.MANAGE_CUSTOM = E.CUSTOM_CODE AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BPR100T AS H ON D.ITEM_GROUP = H.ITEM_CODE AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                 UNION
					                 SELECT   C.IMPORTER AS SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID}, D.CUSTOM_CODE)
					                                 AS CUSTOM_NAME, '' AS BILL_TYPE, A.BL_DATE AS SALE_DATE, '10' AS INOUT_TYPE_DETAIL,
					                                 B.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, E.ITEM_CODE) AS ITEM_NAME, B.STANDARD AS SPEC,
					                                 B.UNIT AS SALE_UNIT, G.TRANS_RATE, A.BL_DATE AS SALE_DATE1, B.QTY,
					                                 C.IMPORTER AS SALE_CUSTOM_CODE1, uniLITE.fnCustName(#{S_USER_ID}, D.CUSTOM_CODE)
					                                 AS CUSTOM_NAME1, '10' AS INOUT_TYPE_DETAIL1, B.QTY AS SALE_Q1, B.PRICE, A.AMT_UNIT,
					                                 A.EXCHANGE_RATE, B.BL_AMT_WON, '2' AS TAX_TYPE, 0 AS TAX_AMT_O, ISNULL(B.BL_AMT_WON, 0)
					                                 AS SUM_SALE_AMT, B.PAY_METHODE AS ORDER_TYPE, A.DIV_CODE, C.EXPORT_NM,
					                                 D.MANAGE_CUSTOM, uniLITE.fnCustName(#{S_USER_ID}, F.CUSTOM_CODE) AS MANAGE_CUSTOM_NM,
					                                 D.AREA_TYPE, D.AGENT_TYPE, A.PROJECT_NO, '' AS PUB_NUM, A.EX_NUM, A.BL_SER_NO, B.SO_SER_NO,
					                                 0 AS DISCOUNT_RATE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = '2')) AS PRICE_YN,
					                                 CAST('TRADE_OUT_DATA' AS NVARCHAR(25)) AS GUBUN, B.BL_SER_NO + CAST(B.BL_SEQ AS VARCHAR(8))
					                                 AS SORT, E.ITEM_GROUP
					                 FROM      TED100T AS A INNER JOIN TED110T AS B ON A.BL_SER_NO = B.BL_SER_NO AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN TEA100T AS C ON A.SO_SER_NO = C.SO_SER_NO  AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BCM100T AS D ON C.IMPORTER = D.CUSTOM_CODE AND C.COMP_CODE = D.COMP_CODE AND C.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BPR100T AS E ON B.ITEM_CODE = E.ITEM_CODE AND B.COMP_CODE = E.COMP_CODE AND B.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BCM100T AS F ON D.MANAGE_CUSTOM = F.CUSTOM_CODE AND F.COMP_CODE = D.COMP_CODE AND F.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BPR100T AS H ON E.ITEM_GROUP = H.ITEM_CODE AND E.COMP_CODE = H.COMP_CODE AND E.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN TEA110T AS G ON A.SO_SER_NO = G.SO_SER_NO AND B.SO_SER = G.SO_SER) AS G
					                                 INNER JOIN BPR100T AS L ON G.ITEM_CODE = L.ITEM_CODE
					                				 LEFT OUTER JOIN BPR100T AS M ON L.ITEM_GROUP = M.ITEM_CODE AND M.COMP_CODE = L.COMP_CODE AND M.COMP_CODE=#{S_COMP_CODE}
									WHERE   G.SALE_CUSTOM_CODE IS NOT NULL
									<if test="@foren.Ognl@isNotEmpty(SALE_PRSN)">
										AND G.SALE_PRSN =#{SALE_PRSN}
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
									 AND G.DIV_CODE=#{DIV_CODE}
									 </if>
									 
									 <if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
									 AND G.SALE_CUSTOM_CODE = #{CUSTOM_CODE}					/* 거래처코드  */
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isEmpty(CUSTOM_NAME)">
									 AND G.SALE_CUSTOM_CODE LIKE  #{CUSTOM_CODE} + '%'			/* 거래처코드  */
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME) and @foren.Ognl@isEmpty(CUSTOM_CODE)">
									 AND G.CUSTOM_NAME LIKE '%' + #{CUSTOM_NAME} + '%'	/* 거래처명  */
									 </if>

									 <if test="@foren.Ognl@isNotEmpty(FR_DATE)">
										AND G.SALE_DATE &gt;= #{FR_DATE}
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(TO_DATE)">
										AND G.SALE_DATE &lt;= #{TO_DATE}
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(PROJECT_NO)">
										AND G.PROJECT_NO = #{PROJECT_NO}
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(BILL_TYPE)">
										AND G.BILL_TYPE =#{BILL_TYPE}
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(AGENT_TYPE)">
										AND G.AGENT_TYPE =#{AGENT_TYPE}
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(AREA_TYPE)">
										AND G.AREA_TYPE =#{AREA_TYPE}
									 </if>
									 <if test="@foren.Ognl@isNotEmpty(ORDER_TYPE)">
										AND G.ORDER_TYPE =#{ORDER_TYPE}
									</if>
									<if test="@foren.Ognl@isNotEmpty(INOUT_TYPE_DETAIL)">
										AND G.INOUT_TYPE_DETAIL =#{INOUT_TYPE_DETAIL}
									</if>
									<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL1)">
										AND L.ITEM_LEVEL1    = #{ITEM_LEVEL1}
									</if>
									<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL2)">
										AND L.ITEM_LEVEL2    = #{ITEM_LEVEL2}
									</if>
									<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL3)">
										AND L.ITEM_LEVEL3    = #{ITEM_LEVEL3}
									</if>
									
									<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME)">
										AND G.MANAGE_CUSTOM = #{MANAGE_CUSTOM}					/* 집계거래처코드  */
									</if>
									<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isEmpty(MANAGE_CUSTOM_NAME)">
										AND G.MANAGE_CUSTOM LIKE  #{MANAGE_CUSTOM} + '%'			/* 집계거래처코드  */
									</if>
									<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME) and @foren.Ognl@isEmpty(MANAGE_CUSTOM)">
										AND G.MANAGE_CUSTOM_NM LIKE '%' + #{MANAGE_CUSTOM_NAME} + '%'	/* 집계거래처명  */
									</if>

									<if test="@foren.Ognl@isNotEmpty(FR_ORDER_QTY)">
										AND G.SALE_Q &gt;#{FR_ORDER_QTY}
									</if>
									<if test="@foren.Ognl@isNotEmpty(TO_ORDER_QTY)">
										AND G.SALE_Q &lt;#{TO_ORDER_QTY}
									</if>
									<if test="@foren.Ognl@isNotEmpty(ITEM_GROUP_CODE)">
										AND G.ITEM_GROUP   =  #{ITEM_GROUP_CODE}
									</if>
						ORDER BY G.SALE_CUSTOM_CODE, G.sort
	 			</when>
	 			<when test="TRADE_OUT == &quot;S&quot; ">
	 				SELECT    SALE_CUSTOM_CODE1, CUSTOM_NAME1, BILL_TYPE, SALE_DATE, INOUT_TYPE_DETAIL, ITEM_CODE,
					                ITEM_NAME, SPEC, SALE_UNIT, TRANS_RATE, SALE_DATE1, SALE_Q,
					                INOUT_TYPE_DETAIL1, SALE_Q1, SALE_P, MONEY_UNIT, EXCHG_RATE_O, SALE_LOC_AMT_I, TAX_TYPE,
					                TAX_AMT_O, SUM_SALE_AMT, ORDER_TYPE, DIV_CODE, SALE_PRSN, MANAGE_CUSTOM, MANAGE_CUSTOM_NM,
					                AREA_TYPE, AGENT_TYPE, PROJECT_NO, PUB_NUM, EX_NUM, BILL_NUM, ORDER_NUM, DISCOUNT_RATE,
					                PRICE_YN, GUBUN, SORT
					FROM      (SELECT    A.SALE_CUSTOM_CODE AS SALE_CUSTOM_CODE1,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S024') AND (SUB_CODE = A.BILL_TYPE)) AS BILL_TYPE, A.SALE_DATE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = B.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL,
					                                 B.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, D.ITEM_CODE) AS ITEM_NAME, D.SPEC, B.SALE_UNIT,
					                                 B.TRANS_RATE, A.SALE_DATE AS SALE_DATE1, B.SALE_Q,
					                                uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE)
					                                 AS CUSTOM_NAME1,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = B.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL1,
					                                 B.SALE_Q AS SALE_Q1, B.SALE_P, A.MONEY_UNIT, A.EXCHG_RATE_O, B.SALE_LOC_AMT_I,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B059') AND (SUB_CODE = B.TAX_TYPE)) AS TAX_TYPE, B.TAX_AMT_O,
					                                 ISNULL(B.SALE_LOC_AMT_I, 0) + ISNULL(B.TAX_AMT_O, 0) AS SUM_SALE_AMT,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S002') AND (SUB_CODE = A.ORDER_TYPE)) AS ORDER_TYPE,
					                                     (SELECT   DIV_NAME
					                                      FROM      BOR120T
					                                      WHERE   (DIV_CODE = A.DIV_CODE)) AS DIV_CODE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S010') AND (SUB_CODE = A.SALE_PRSN)) AS SALE_PRSN, C.MANAGE_CUSTOM,
					                                 uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) AS MANAGE_CUSTOM_NM,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B056') AND (SUB_CODE = C.AREA_TYPE)) AS AREA_TYPE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B055') AND (SUB_CODE = C.AGENT_TYPE)) AS AGENT_TYPE, B.PROJECT_NO,
					                                 B.PUB_NUM, (CASE WHEN A.BILL_TYPE = '10' OR
					                                 A.BILL_TYPE = '50' THEN
					                                     (SELECT DISTINCT CAST(Y.EX_NUM AS NVARCHAR(10)) AS EX_NUM
					                                      FROM      SSA110T X LEFT OUTER JOIN
					                                                      STB100T Y ON X.PUB_NUM = Y.PUB_NUM
					                                      WHERE   Y.PUB_NUM = B.PUB_NUM AND Y.DIV_CODE = X.DIV_CODE)
					                                 ELSE CAST(A.EX_NUM AS NVARCHAR(10)) END) AS EX_NUM, B.BILL_NUM, B.ORDER_NUM,
					                                 ISNULL(B.DISCOUNT_RATE, 0) AS DISCOUNT_RATE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = B.PRICE_YN)) AS PRICE_YN,
					                                 CAST('SALE ONLY' AS NVARCHAR(25)) AS GUBUN, B.BILL_NUM + CAST(B.BILL_SEQ AS VARCHAR(8))
					                                 AS SORT
					                 FROM      SSA100T AS A INNER JOIN
					                                 SSA110T AS B ON A.DIV_CODE = B.DIV_CODE AND A.BILL_NUM = B.BILL_NUM  AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BCM100T AS C ON A.SALE_CUSTOM_CODE = C.CUSTOM_CODE  AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BPR100T AS D ON B.ITEM_CODE = D.ITEM_CODE AND D.COMP_CODE = B.COMP_CODE AND B.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BCM100T AS M ON C.MANAGE_CUSTOM = M.CUSTOM_CODE AND M.COMP_CODE = C.COMP_CODE AND M.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN  BPR100T AS N ON D.ITEM_GROUP = N.ITEM_CODE AND N.COMP_CODE = D.COMP_CODE AND N.COMP_CODE=#{S_COMP_CODE}
					                 WHERE   B.BILL_NUM IS NOT NULL
					                 		<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
					                 			AND A.DIV_CODE=#{DIV_CODE}
					                 		</if>
											<if test="@foren.Ognl@isNotEmpty(SALE_PRSN)">
												AND A.SALE_PRSN =#{SALE_PRSN}
											</if>
											
											<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
											AND A.SALE_CUSTOM_CODE = #{CUSTOM_CODE}					/* 거래처코드  */
											</if>
											<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isEmpty(CUSTOM_NAME)">
											AND A.SALE_CUSTOM_CODE LIKE  #{CUSTOM_CODE} + '%'			/* 거래처코드  */
											</if>
											<if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME) and @foren.Ognl@isEmpty(CUSTOM_CODE)">
											AND C.CUSTOM_NAME LIKE '%' + #{CUSTOM_NAME} + '%'	/* 거래처명  */
											</if>
											
											<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
												AND B.ITEM_CODE   = #{ITEM_CODE}						/* 품목코드  */
											</if>
											<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
												AND B.ITEM_CODE   LIKE #{ITEM_CODE} + '%'			/* 품목코드  */
											</if>
											<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
												AND D.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
											</if>
											
											<if test="@foren.Ognl@isNotEmpty(FR_DATE)">
												AND A.SALE_DATE &gt;= #{FR_DATE}
											</if>
											<if test="@foren.Ognl@isNotEmpty(TO_DATE)">
												AND A.SALE_DATE &lt;= #{TO_DATE}
											</if>
											<if test="@foren.Ognl@isNotEmpty(PROJECT_NO)">
												AND B.PROJECT_NO LIKE #{PROJECT_NO}+'%'
											</if>
											<if test="@foren.Ognl@isNotEmpty(BILL_TYPE)">
												AND A.BILL_TYPE =#{BILL_TYPE}
											</if>
											<if test="@foren.Ognl@isNotEmpty(AGENT_TYPE)">
												AND C.AGENT_TYPE =#{AGENT_TYPE}
											</if>
											<if test="@foren.Ognl@isNotEmpty(AREA_TYPE)">
												AND C.AREA_TYPE =#{AREA_TYPE}
											</if>
											<if test="@foren.Ognl@isNotEmpty(ORDER_TYPE)">
												AND A.ORDER_TYPE =#{ORDER_TYPE}
											</if>
											<if test="@foren.Ognl@isNotEmpty(INOUT_TYPE_DETAIL)">
												AND B.INOUT_TYPE_DETAIL =#{INOUT_TYPE_DETAIL}
											</if>
											<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL1)">
												AND D.ITEM_LEVEL1    = #{ITEM_LEVEL1}
											</if>
											<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL2)">
												AND D.ITEM_LEVEL2    = #{ITEM_LEVEL2}
											</if>
											<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL3)">
												AND D.ITEM_LEVEL3    = #{ITEM_LEVEL3}
											</if>
											
											<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME)">
											AND C.MANAGE_CUSTOM = #{MANAGE_CUSTOM}					/* 집계거래처코드  */
											</if>
											<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isEmpty(MANAGE_CUSTOM_NAME)">
											AND C.MANAGE_CUSTOM LIKE  #{MANAGE_CUSTOM} + '%'			/* 집계거래처코드  */
											</if>
											<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME) and @foren.Ognl@isEmpty(MANAGE_CUSTOM)">
											AND M.CUSTOM_NAME LIKE '%' + #{MANAGE_CUSTOM_NAME} + '%'	/* 집계거래처명  */
											</if>

											<if test="@foren.Ognl@isNotEmpty(ITEM_GROUP_CODE)">
												AND D.ITEM_GROUP   =  #{ITEM_GROUP_CODE}
											</if>
											<if test="@foren.Ognl@isNotEmpty(FR_ORDER_QTY)">
												AND B.SALE_Q &gt;#{FR_ORDER_QTY}
											</if>
											<if test="@foren.Ognl@isNotEmpty(TO_ORDER_QTY)">
												AND B.SALE_Q &lt;#{TO_ORDER_QTY}
											</if>
										) AS X
									<choose>
										<when test="SALE_YN == &quot;Y&quot;">
											WHERE X.EX_NUM IS NOT NULL
										</when>
										<when test="SALE_YN == &quot;N&quot;">
											WHERE EX_NUM IS  NULL
										</when>
									</choose>
					ORDER BY SALE_CUSTOM_CODE1, sort
	 			</when>
	 		</choose>

	 	</if>
	 	<if test="sPrintFlag=='PRSN'">
	 		<choose>
	 			<when test="TRADE_OUT == &quot;T&quot; ">
	 				/*영업담당별(ONLY SALES)*/
						SELECT    G.SALE_CUSTOM_CODE,
						                uniLITE.fnCustName(#{S_USER_ID}, G.SALE_CUSTOM_CODE) AS CUSTOM_NAME,
						                    (SELECT   CODE_NAME
						                     FROM      BSA100T
						                     WHERE   (MAIN_CODE = 'S024') AND (SUB_CODE = G.BILL_TYPE)) AS BILL_TYPE, G.SALE_DATE,
						                    (SELECT   CODE_NAME
						                     FROM      BSA100T
						                     WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = G.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL,
						                G.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, G.ITEM_CODE) AS ITEM_NAME, G.SPEC, G.SALE_UNIT, G.TRANS_RATE,
						                G.SALE_DATE1, G.SALE_Q, G.SALE_CUSTOM_CODE1, G.CUSTOM_NAME1,
						                    (SELECT   CODE_NAME
						                     FROM      BSA100T
						                     WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = G.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL1,
						                G.SALE_Q1, G.SALE_P, G.MONEY_UNIT, G.EXCHG_RATE_O, G.SALE_LOC_AMT_I,
						                    (SELECT   CODE_NAME
						                     FROM      BSA100T
						                     WHERE   (MAIN_CODE = 'B059') AND (SUB_CODE = G.TAX_TYPE)) AS TAX_TYPE, G.TAX_AMT_O, G.SUM_SALE_AMT,
						                    (SELECT   CODE_NAME
						                     FROM      BSA100T
						                     WHERE   (MAIN_CODE = 'S002') AND (SUB_CODE = G.ORDER_TYPE)) AS ORDER_TYPE,
						                    (SELECT   DIV_NAME
						                     FROM      BOR120T
						                     WHERE   (DIV_CODE = G.DIV_CODE)) AS DIV_CODE,
						                    (SELECT   CODE_NAME
						                     FROM      BSA100T
						                     WHERE   (MAIN_CODE = 'S010') AND (SUB_CODE = G.SALE_PRSN)) AS SALE_PRSN, G.MANAGE_CUSTOM,
						                G.MANAGE_CUSTOM_NM,
						                    (SELECT   CODE_NAME
						                     FROM      BSA100T
						                     WHERE   (MAIN_CODE = 'S056') AND (SUB_CODE = G.AREA_TYPE)) AS AREA_TYPE,
						                    (SELECT   CODE_NAME
						                     FROM      BSA100T
						                     WHERE   (MAIN_CODE = 'S055') AND (SUB_CODE = G.AGENT_TYPE)) AS AGENT_TYPE, G.PROJECT_NO,
						                G.PUB_NUM, G.EX_NUM, G.BILL_NUM, G.ORDER_NUM, G.DISCOUNT_RATE, G.PRICE_YN, G.GUBUN, G.SORT
						FROM      (SELECT    A.SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE)
						                                 AS CUSTOM_NAME, A.BILL_TYPE, A.SALE_DATE, B.INOUT_TYPE_DETAIL, B.ITEM_CODE,
						                                 uniLITE.fnItemName(#{S_USER_ID}, D.ITEM_CODE) AS ITEM_NAME, D.SPEC, B.SALE_UNIT, B.TRANS_RATE,
						                                 A.SALE_DATE AS SALE_DATE1, B.SALE_Q, A.SALE_CUSTOM_CODE AS SALE_CUSTOM_CODE1,
						                                 uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) AS CUSTOM_NAME1,
						                                 B.INOUT_TYPE_DETAIL AS INOUT_TYPE_DETAIL1, B.SALE_Q AS SALE_Q1, B.SALE_P, A.MONEY_UNIT,
						                                 A.EXCHG_RATE_O, B.SALE_LOC_AMT_I, B.TAX_TYPE, B.TAX_AMT_O, ISNULL(B.SALE_LOC_AMT_I, 0)
						                                 + ISNULL(B.TAX_AMT_O, 0) AS SUM_SALE_AMT, A.ORDER_TYPE, A.DIV_CODE, A.SALE_PRSN,
						                                 C.MANAGE_CUSTOM, uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) AS MANAGE_CUSTOM_NM,
						                                 C.AREA_TYPE, C.AGENT_TYPE, B.PROJECT_NO, B.PUB_NUM, (CASE WHEN A.BILL_TYPE = '10' OR
						                                 A.BILL_TYPE = '50' THEN
						                                     (SELECT DISTINCT CAST(Y.EX_NUM AS NVARCHAR(10)) AS EX_NUM
						                                      FROM      SSA110T X LEFT OUTER JOIN
						                                                      STB100T Y ON X.PUB_NUM = Y.PUB_NUM
						                                      WHERE   Y.PUB_NUM = B.PUB_NUM) ELSE CAST(A.EX_NUM AS NVARCHAR(10)) END) AS EX_NUM,
						                                 B.BILL_NUM, B.ORDER_NUM, ISNULL(B.DISCOUNT_RATE, 0) AS DISCOUNT_RATE,
						                                     (SELECT   CODE_NAME
						                                      FROM      BSA100T
						                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = B.PRICE_YN)) AS PRICE_YN,
						                                 CAST('SALES_DATA ONLY' AS NVARCHAR(25)) AS GUBUN, B.BILL_NUM + CAST(B.BILL_SEQ AS VARCHAR(8))
						                                 AS SORT, H.ITEM_GROUP
						                 FROM      SSA100T AS A INNER JOIN
						                                 SSA110T AS B ON A.DIV_CODE = B.DIV_CODE AND A.BILL_NUM = B.BILL_NUM AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN BPR100T AS E ON B.ITEM_CODE = E.ITEM_CODE  AND E.COMP_CODE = B.COMP_CODE AND B.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN BCM100T AS C ON A.SALE_CUSTOM_CODE = C.CUSTOM_CODE AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN BPR100T AS D ON B.ITEM_CODE = D.ITEM_CODE AND B.COMP_CODE = D.COMP_CODE AND B.COMP_CODE=#{S_COMP_CODE}
						                                 LEFT OUTER JOIN BCM100T AS M ON C.MANAGE_CUSTOM = M.CUSTOM_CODE AND M.COMP_CODE = C.COMP_CODE AND M.COMP_CODE=#{S_COMP_CODE}
						                                 LEFT OUTER JOIN BPR100T AS H ON E.ITEM_GROUP = H.ITEM_CODE AND H.COMP_CODE = E.COMP_CODE AND H.COMP_CODE=#{S_COMP_CODE}
						                 UNION
						                 SELECT    A.APPLICANT AS SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID},
						                                 C.CUSTOM_CODE) AS CUSTOM_NAME, '' AS BILL_TYPE, A.ACCEPT_DATE AS SALE_DATE,
						                                 '10' AS INOUT_TYPE_DETAIL, B.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, D.ITEM_CODE) AS ITEM_NAME,
						                                 B.STANDARD, B.UNIT, B.TRANS_RATE, A.ACCEPT_DATE AS SALE_DATE1, B.QTY,
						                                 A.APPLICANT AS SALE_CUSTOM_CODE1, uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE)
						                                 AS CUSTOM_NAME1, '10' AS INOUT_TYPE_DETAIL1, B.QTY AS SALE_Q1, B.PRICE, A.AMT_UNIT,
						                                 B.EXCHANGE_RATE, B.ACCEPT_AMT_WON, '2' AS TAX_TYPE, 0 AS TAX_AMT_O,
						                                 ISNULL(B.ACCEPT_AMT_WON, 0) AS SUM_SALE_AMT, '20' AS ORDER_TYPE, A.DIV_CODE, A.EXPORT_NM,
						                                 C.MANAGE_CUSTOM, uniLITE.fnCustName(#{S_USER_ID}, E.CUSTOM_CODE) AS MANAGE_CUSTOM_NM,
						                                 C.AREA_TYPE, C.AGENT_TYPE, A.PROJECT_NO, '' AS PUB_NUM, A.EX_NUM, A.ACCEPT_NO, B.SO_SER_NO,
						                                 0 AS DISCOUNT_RATE,
						                                     (SELECT   CODE_NAME
						                                      FROM      BSA100T
						                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = '2')) AS PRICE_YN,
						                                 CAST('TRADE_IN_DATA' AS NVARCHAR(25)) AS GUBUN,
						                                 B.ACCEPT_NO + CAST(B.ACCEPT_SEQ AS VARCHAR(8)) AS SORT, D.ITEM_GROUP
						                 FROM      TEC120T AS A INNER JOIN TEC130T AS B ON A.ACCEPT_NO = B.ACCEPT_NO  AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN BCM100T AS C ON A.APPLICANT = C.CUSTOM_CODE AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN BPR100T AS D ON B.ITEM_CODE = D.ITEM_CODE AND D.COMP_CODE = B.COMP_CODE AND D.COMP_CODE=#{S_COMP_CODE}
						                                 LEFT OUTER JOIN BCM100T AS E ON C.MANAGE_CUSTOM = E.CUSTOM_CODE AND E.COMP_CODE = C.COMP_CODE AND E.COMP_CODE=#{S_COMP_CODE}
						                                 LEFT OUTER JOIN BPR100T AS H ON D.ITEM_GROUP = H.ITEM_CODE AND H.COMP_CODE = D.COMP_CODE AND H.COMP_CODE=#{S_COMP_CODE}

						                 UNION
						                 SELECT    C.IMPORTER AS SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID},
						                                 D.CUSTOM_CODE) AS CUSTOM_NAME, '' AS BILL_TYPE, A.BL_DATE AS SALE_DATE,
						                                 '10' AS INOUT_TYPE_DETAIL, B.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, E.ITEM_CODE) AS ITEM_NAME,
						                                 B.STANDARD AS SPEC, B.UNIT AS SALE_UNIT, G.TRANS_RATE, A.BL_DATE AS SALE_DATE1, B.QTY,
						                                 C.IMPORTER AS SALE_CUSTOM_CODE1, uniLITE.fnCustName(#{S_USER_ID}, D.CUSTOM_CODE)
						                                 AS CUSTOM_NAME1, '10' AS INOUT_TYPE_DETAIL1, B.QTY AS SALE_Q1, B.PRICE, A.AMT_UNIT,
						                                 A.EXCHANGE_RATE, B.BL_AMT_WON, '2' AS TAX_TYPE, 0 AS TAX_AMT_O, ISNULL(B.BL_AMT_WON, 0)
						                                 AS SUM_SALE_AMT, B.PAY_METHODE AS ORDER_TYPE, A.DIV_CODE, C.EXPORT_NM,
						                                 D.MANAGE_CUSTOM, uniLITE.fnCustName(#{S_USER_ID}, F.CUSTOM_CODE) AS MANAGE_CUSTOM_NM,
						                                 D.AREA_TYPE, D.AGENT_TYPE, A.PROJECT_NO, '' AS PUB_NUM, A.EX_NUM, A.BL_SER_NO, B.SO_SER_NO,
						                                 0 AS DISCOUNT_RATE,
						                                     (SELECT   CODE_NAME
						                                      FROM      BSA100T
						                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = '2')) AS PRICE_YN,
						                                 CAST('TRADE_OUT_DATA' AS NVARCHAR(25)) AS GUBUN, B.BL_SER_NO + CAST(B.BL_SEQ AS VARCHAR(8))
						                                 AS SORT, E.ITEM_GROUP
						                 FROM      TED100T AS A INNER JOIN TED110T AS B ON A.BL_SER_NO = B.BL_SER_NO AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN TEA100T AS C ON A.SO_SER_NO = C.SO_SER_NO  AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN BCM100T AS D ON C.IMPORTER = D.CUSTOM_CODE AND C.COMP_CODE = C.COMP_CODE AND C.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN BPR100T AS E ON B.ITEM_CODE = E.ITEM_CODE  AND E.COMP_CODE = B.COMP_CODE AND E.COMP_CODE=#{S_COMP_CODE}
						                                 LEFT OUTER JOIN BCM100T AS F ON D.MANAGE_CUSTOM = F.CUSTOM_CODE AND D.COMP_CODE = F.COMP_CODE AND D.COMP_CODE=#{S_COMP_CODE}
						                                 LEFT OUTER JOIN BPR100T AS H ON E.ITEM_GROUP = H.ITEM_CODE AND H.COMP_CODE = E.COMP_CODE AND H.COMP_CODE=#{S_COMP_CODE}
						                                 INNER JOIN TEA110T AS G ON A.SO_SER_NO = G.SO_SER_NO AND B.SO_SER = G.SO_SER) AS G
						                                 INNER JOIN BPR100T AS L ON G.ITEM_CODE = L.ITEM_CODE
						                				 LEFT OUTER JOIN  BPR100T AS M ON L.ITEM_GROUP = M.ITEM_CODE
										WHERE   G.SALE_CUSTOM_CODE IS NOT NULL
										<if test="@foren.Ognl@isNotEmpty(SALE_PRSN)">
											AND G.SALE_PRSN =#{SALE_PRSN}
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
										 AND G.DIV_CODE=#{DIV_CODE}
										 </if>
										 
										 <if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
										 AND G.SALE_CUSTOM_CODE = #{CUSTOM_CODE}					/* 거래처코드  */
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isEmpty(CUSTOM_NAME)">
										 AND G.SALE_CUSTOM_CODE LIKE  #{CUSTOM_CODE} + '%'			/* 거래처코드  */
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME) and @foren.Ognl@isEmpty(CUSTOM_CODE)">
										 AND G.CUSTOM_NAME LIKE '%' + #{CUSTOM_NAME} + '%'	/* 거래처명  */
										 </if>

										 <if test="@foren.Ognl@isNotEmpty(FR_DATE)">
											AND G.SALE_DATE &gt;= #{FR_DATE}
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(TO_DATE)">
											AND G.SALE_DATE &lt;= #{TO_DATE}
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(PROJECT_NO)">
											AND G.PROJECT_NO = #{PROJECT_NO}
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(BILL_TYPE)">
											AND G.BILL_TYPE =#{BILL_TYPE}
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(AGENT_TYPE)">
											AND G.AGENT_TYPE =#{AGENT_TYPE}
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(AREA_TYPE)">
											AND G.AREA_TYPE =#{AREA_TYPE}
										 </if>
										 <if test="@foren.Ognl@isNotEmpty(ORDER_TYPE)">
											AND G.ORDER_TYPE =#{ORDER_TYPE}
										</if>
										<if test="@foren.Ognl@isNotEmpty(INOUT_TYPE_DETAIL)">
											AND G.INOUT_TYPE_DETAIL =#{INOUT_TYPE_DETAIL}
										</if>
										<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL1)">
											AND L.ITEM_LEVEL1    = #{ITEM_LEVEL1}
										</if>
										<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL2)">
											AND L.ITEM_LEVEL2    = #{ITEM_LEVEL2}
										</if>
										<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL3)">
											AND L.ITEM_LEVEL3    = #{ITEM_LEVEL3}
										</if>
										
										<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME)">
											AND G.MANAGE_CUSTOM = #{MANAGE_CUSTOM}					/* 집계거래처코드  */
										</if>
										<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isEmpty(MANAGE_CUSTOM_NAME)">
											AND G.MANAGE_CUSTOM LIKE  #{MANAGE_CUSTOM} + '%'			/* 집계거래처코드  */
										</if>
										<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME) and @foren.Ognl@isEmpty(MANAGE_CUSTOM)">
											AND G.MANAGE_CUSTOM_NM LIKE '%' + #{MANAGE_CUSTOM_NAME} + '%'	/* 집계거래처명  */
										</if>

										<if test="@foren.Ognl@isNotEmpty(FR_ORDER_QTY)">
											AND G.SALE_Q &gt;#{FR_ORDER_QTY}
										</if>
										<if test="@foren.Ognl@isNotEmpty(TO_ORDER_QTY)">
											AND G.SALE_Q &lt;#{TO_ORDER_QTY}
										</if>
										<if test="@foren.Ognl@isNotEmpty(ITEM_GROUP_CODE)">
											AND G.ITEM_GROUP   =  #{ITEM_GROUP_CODE}
										</if>
						ORDER BY SALE_PRSN, G.SORT
	 			</when>
	 			<when test="TRADE_OUT == &quot;S&quot; ">
	 				SELECT    SALE_CUSTOM_CODE, CUSTOM_NAME, BILL_TYPE, SALE_DATE, INOUT_TYPE_DETAIL, ITEM_CODE,
					                ITEM_NAME, SPEC, SALE_UNIT, TRANS_RATE, SALE_DATE1, SALE_Q, SALE_CUSTOM_CODE1, CUSTOM_NAME1,
					                INOUT_TYPE_DETAIL1, SALE_Q1, SALE_P, MONEY_UNIT, EXCHG_RATE_O, SALE_LOC_AMT_I, TAX_TYPE,
					                TAX_AMT_O, SUM_SALE_AMT, ORDER_TYPE, DIV_CODE, SALE_PRSN, MANAGE_CUSTOM, MANAGE_CUSTOM_NM,
					                AREA_TYPE, AGENT_TYPE, PROJECT_NO, PUB_NUM, EX_NUM, BILL_NUM, ORDER_NUM, DISCOUNT_RATE,
					                PRICE_YN, GUBUN, SORT
					FROM      (SELECT   A.SALE_CUSTOM_CODE, uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE)
					                                 AS CUSTOM_NAME,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S024') AND (SUB_CODE = A.BILL_TYPE)) AS BILL_TYPE, A.SALE_DATE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = B.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL,
					                                 B.ITEM_CODE, uniLITE.fnItemName(#{S_USER_ID}, D.ITEM_CODE) AS ITEM_NAME, D.SPEC, B.SALE_UNIT,
					                                 B.TRANS_RATE, A.SALE_DATE AS SALE_DATE1, B.SALE_Q,
					                                 A.SALE_CUSTOM_CODE AS SALE_CUSTOM_CODE1, uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE)
					                                 AS CUSTOM_NAME1,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S007') AND (SUB_CODE = B.INOUT_TYPE_DETAIL)) AS INOUT_TYPE_DETAIL1,
					                                 B.SALE_Q AS SALE_Q1, B.SALE_P, A.MONEY_UNIT, A.EXCHG_RATE_O, B.SALE_LOC_AMT_I,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B059') AND (SUB_CODE = B.TAX_TYPE)) AS TAX_TYPE, B.TAX_AMT_O,
					                                 ISNULL(B.SALE_LOC_AMT_I, 0) + ISNULL(B.TAX_AMT_O, 0) AS SUM_SALE_AMT,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S002') AND (SUB_CODE = A.ORDER_TYPE)) AS ORDER_TYPE,
					                                     (SELECT   DIV_NAME
					                                      FROM      BOR120T
					                                      WHERE   (DIV_CODE = A.DIV_CODE)) AS DIV_CODE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S010') AND (SUB_CODE = A.SALE_PRSN)) AS SALE_PRSN, C.MANAGE_CUSTOM,
					                                 uniLITE.fnCustName(#{S_USER_ID}, C.CUSTOM_CODE) AS MANAGE_CUSTOM_NM,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B056') AND (SUB_CODE = C.AREA_TYPE)) AS AREA_TYPE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'B055') AND (SUB_CODE = C.AGENT_TYPE)) AS AGENT_TYPE, B.PROJECT_NO,
					                                 B.PUB_NUM, (CASE WHEN A.BILL_TYPE = '10' OR
					                                 A.BILL_TYPE = '50' THEN
					                                     (SELECT DISTINCT CAST(Y.EX_NUM AS NVARCHAR(10)) AS EX_NUM
					                                      FROM      SSA110T X LEFT OUTER JOIN
					                                                      STB100T Y ON X.PUB_NUM = Y.PUB_NUM
					                                      WHERE   Y.PUB_NUM = B.PUB_NUM AND Y.DIV_CODE = X.DIV_CODE)
					                                 ELSE CAST(A.EX_NUM AS NVARCHAR(10)) END) AS EX_NUM, B.BILL_NUM, B.ORDER_NUM,
					                                 ISNULL(B.DISCOUNT_RATE, 0) AS DISCOUNT_RATE,
					                                     (SELECT   CODE_NAME
					                                      FROM      BSA100T
					                                      WHERE   (MAIN_CODE = 'S003') AND (SUB_CODE = B.PRICE_YN)) AS PRICE_YN,
					                                 CAST('SALE ONLY' AS NVARCHAR(25)) AS GUBUN, B.BILL_NUM + CAST(B.BILL_SEQ AS VARCHAR(8))
					                                 AS SORT
					                 FROM      SSA100T AS A INNER JOIN
					                                 SSA110T AS B ON A.DIV_CODE = B.DIV_CODE AND A.BILL_NUM = B.BILL_NUM  AND A.COMP_CODE = B.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BCM100T AS C ON A.SALE_CUSTOM_CODE = C.CUSTOM_CODE AND A.COMP_CODE = C.COMP_CODE AND A.COMP_CODE=#{S_COMP_CODE}
					                                 INNER JOIN BPR100T AS D ON B.ITEM_CODE = D.ITEM_CODE AND D.COMP_CODE = B.COMP_CODE AND B.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BCM100T AS M ON C.MANAGE_CUSTOM = M.CUSTOM_CODE AND C.COMP_CODE = M.COMP_CODE AND C.COMP_CODE=#{S_COMP_CODE}
					                                 LEFT OUTER JOIN BPR100T AS N ON D.ITEM_GROUP = N.ITEM_CODE AND D.COMP_CODE = N.COMP_CODE AND D.COMP_CODE=#{S_COMP_CODE}
					                 WHERE   B.BILL_NUM IS NOT NULL
					                 				<if test="@foren.Ognl@isNotEmpty(DIV_CODE)">
					                 				AND A.DIV_CODE = #{DIV_CODE}
					                 				</if>
													<if test="@foren.Ognl@isNotEmpty(SALE_PRSN)">
														AND A.SALE_PRSN =#{SALE_PRSN}
													</if>
													
													<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isNotEmpty(CUSTOM_NAME)">
													AND A.SALE_CUSTOM_CODE = #{CUSTOM_CODE}					/* 거래처코드  */
													</if>
													<if test="@foren.Ognl@isNotEmpty(CUSTOM_CODE) and @foren.Ognl@isEmpty(CUSTOM_NAME)">
													AND A.SALE_CUSTOM_CODE LIKE  #{CUSTOM_CODE} + '%'			/* 거래처코드  */
													</if>
													<if test="@foren.Ognl@isNotEmpty(CUSTOM_NAME) and @foren.Ognl@isEmpty(CUSTOM_CODE)">
													AND C.CUSTOM_NAME LIKE '%' + #{CUSTOM_NAME} + '%'	/* 거래처명  */
													</if>

													<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isNotEmpty(ITEM_NAME)">
														AND B.ITEM_CODE   = #{ITEM_CODE}						/* 품목코드  */
													</if>
													<if test="@foren.Ognl@isNotEmpty(ITEM_CODE) and @foren.Ognl@isEmpty(ITEM_NAME)">
														AND B.ITEM_CODE   LIKE #{ITEM_CODE} + '%'			/* 품목코드  */
													</if>
													<if test="@foren.Ognl@isNotEmpty(ITEM_NAME) and @foren.Ognl@isEmpty(ITEM_CODE)">
														AND D.ITEM_NAME   LIKE '%' + #{ITEM_NAME} + '%'		/* 품목명  */
													</if>

													<if test="@foren.Ognl@isNotEmpty(FR_DATE)">
														AND A.SALE_DATE &gt;= #{FR_DATE}
													</if>
													<if test="@foren.Ognl@isNotEmpty(TO_DATE)">
														AND A.SALE_DATE &lt;= #{TO_DATE}
													</if>
													<if test="@foren.Ognl@isNotEmpty(PROJECT_NO)">
														AND B.PROJECT_NO LIKE #{PROJECT_NO}+'%'
													</if>
													<if test="@foren.Ognl@isNotEmpty(BILL_TYPE)">
														AND A.BILL_TYPE =#{BILL_TYPE}
													</if>
													<if test="@foren.Ognl@isNotEmpty(AGENT_TYPE)">
														AND C.AGENT_TYPE =#{AGENT_TYPE}
													</if>
													<if test="@foren.Ognl@isNotEmpty(AREA_TYPE)">
														AND C.AREA_TYPE =#{AREA_TYPE}
													</if>
													<if test="@foren.Ognl@isNotEmpty(ORDER_TYPE)">
														AND A.ORDER_TYPE =#{ORDER_TYPE}
													</if>
													<if test="@foren.Ognl@isNotEmpty(INOUT_TYPE_DETAIL)">
														AND B.INOUT_TYPE_DETAIL =#{INOUT_TYPE_DETAIL}
													</if>
													<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL1)">
														AND D.ITEM_LEVEL1    = #{ITEM_LEVEL1}
													</if>
													<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL2)">
														AND D.ITEM_LEVEL2    = #{ITEM_LEVEL2}
													</if>
													<if test="@foren.Ognl@isNotEmpty(ITEM_LEVEL3)">
														AND D.ITEM_LEVEL3    = #{ITEM_LEVEL3}
													</if>
													
													<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME)">
														AND C.MANAGE_CUSTOM = #{MANAGE_CUSTOM}					/* 집계거래처코드  */
													</if>
													<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM) and @foren.Ognl@isEmpty(MANAGE_CUSTOM_NAME)">
														AND C.MANAGE_CUSTOM LIKE  #{MANAGE_CUSTOM} + '%'			/* 집계거래처코드  */
													</if>
													<if test="@foren.Ognl@isNotEmpty(MANAGE_CUSTOM_NAME) and @foren.Ognl@isEmpty(MANAGE_CUSTOM)">
														AND M.CUSTOM_NAME LIKE '%' + #{MANAGE_CUSTOM_NAME} + '%'	/* 집계거래처명  */
													</if>

													<if test="@foren.Ognl@isNotEmpty(ITEM_GROUP_CODE)">
														AND D.ITEM_GROUP   =  #{ITEM_GROUP_CODE}
													</if>
													<if test="@foren.Ognl@isNotEmpty(FR_ORDER_QTY)">
														AND B.SALE_Q &gt;#{FR_ORDER_QTY}
													</if>
													<if test="@foren.Ognl@isNotEmpty(TO_ORDER_QTY)">
														AND B.SALE_Q &lt;#{TO_ORDER_QTY}
													</if>
									 ) AS X
									 <choose>
										<when test="SALE_YN == &quot;Y&quot;">
											WHERE X.EX_NUM IS NOT NULL
										</when>
										<when test="SALE_YN == &quot;N&quot;">
											WHERE EX_NUM IS  NULL
										</when>
								</choose>
					ORDER BY SALE_PRSN, SORT
	 			</when>
	 		</choose>

	 	</if>
	 END
	</select>
</mapper>